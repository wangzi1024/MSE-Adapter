2024-01-30 11:07:13:INFO:Start running cmcm...
2024-01-30 11:07:13:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (4096, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': '01ai/Yi-6B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3, 3]. response: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 't_lstm_hidden_size': 128, 't_mlp_hidden_size': 256, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 't_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 't_lstm_dropout': 0.0, 'a_encoder_heads': 5, 'v_encoder_heads': 4, 'a_encoder_layers': 6, 'v_encoder_layers': 6, 'post_fusion_dim': 128, 'post_text_dim': 64, 'post_audio_dim': 64, 'post_video_dim': 64, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-01-30 11:07:13:INFO:Find gpu: 2, with memory: 381026304 left!
2024-01-30 11:07:13:INFO:Let's use the GPU 1 !
2024-01-30 11:07:13:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:07:14:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706584034 HTTP/1.1" 200 191
2024-01-30 11:07:14:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-30 11:07:14:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:07:14:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo?Revision=master&FilePath=config.json HTTP/1.1" 200 605
2024-01-30 11:07:14:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:07:15:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo?Revision=master&FilePath=configuration.json HTTP/1.1" 200 49
2024-01-30 11:07:15:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:07:15:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo?Revision=master&FilePath=generation_config.json HTTP/1.1" 200 132
2024-01-30 11:07:15:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:07:16:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo?Revision=master&FilePath=LICENSE HTTP/1.1" 200 17412
2024-01-30 11:07:16:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:07:16:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo?Revision=master&FilePath=md5 HTTP/1.1" 200 184
2024-01-30 11:07:16:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:07:16:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo?Revision=master&FilePath=README.md HTTP/1.1" 200 51409
2024-01-30 11:07:16:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:07:17:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo?Revision=master&FilePath=tokenizer.json HTTP/1.1" 200 3560486
2024-01-30 11:07:17:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:07:17:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo?Revision=master&FilePath=tokenizer.model HTTP/1.1" 200 1033105
2024-01-30 11:07:17:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:07:18:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo?Revision=master&FilePath=tokenizer_config.json HTTP/1.1" 200 320
2024-01-30 11:07:18:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:07:18:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo?Revision=master&FilePath=Yi.svg HTTP/1.1" 200 980
2024-01-30 11:07:19:INFO:train samples: (1284,)
2024-01-30 11:07:19:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:07:19:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706584039 HTTP/1.1" 200 191
2024-01-30 11:07:19:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-30 11:07:20:INFO:valid samples: (229,)
2024-01-30 11:07:20:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:07:20:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706584040 HTTP/1.1" 200 191
2024-01-30 11:07:21:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-30 11:07:21:INFO:test samples: (686,)
2024-01-30 11:07:21:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:07:21:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706584041 HTTP/1.1" 200 191
2024-01-30 11:07:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-30 11:07:22:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:07:22:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:07:22:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:07:22:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:07:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo?Revision=master&FilePath=pytorch_model-00001-of-00002.bin HTTP/1.1" 200 167772160
2024-01-30 11:07:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo?Revision=master&FilePath=pytorch_model-00001-of-00002.bin HTTP/1.1" 200 167772160
2024-01-30 11:07:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo?Revision=master&FilePath=pytorch_model-00001-of-00002.bin HTTP/1.1" 200 167772160
2024-01-30 11:07:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo?Revision=master&FilePath=pytorch_model-00001-of-00002.bin HTTP/1.1" 200 167772160
2024-01-30 11:07:28:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:07:28:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo?Revision=master&FilePath=pytorch_model-00001-of-00002.bin HTTP/1.1" 200 167772160
2024-01-30 11:07:28:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:07:29:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:07:29:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo?Revision=master&FilePath=pytorch_model-00001-of-00002.bin HTTP/1.1" 200 167772160
2024-01-30 11:07:29:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo?Revision=master&FilePath=pytorch_model-00001-of-00002.bin HTTP/1.1" 200 167772160
2024-01-30 11:07:34:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:07:34:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo?Revision=master&FilePath=pytorch_model-00001-of-00002.bin HTTP/1.1" 200 167772160
2024-01-30 11:07:39:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:07:39:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo?Revision=master&FilePath=pytorch_model-00001-of-00002.bin HTTP/1.1" 200 167772160
2024-01-30 11:07:41:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:07:41:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:07:41:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo?Revision=master&FilePath=pytorch_model-00001-of-00002.bin HTTP/1.1" 200 167772160
2024-01-30 11:07:41:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo?Revision=master&FilePath=pytorch_model-00001-of-00002.bin HTTP/1.1" 200 167772160
2024-01-30 11:07:47:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:07:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo?Revision=master&FilePath=pytorch_model-00001-of-00002.bin HTTP/1.1" 200 167772160
2024-01-30 11:07:48:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:07:49:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo?Revision=master&FilePath=pytorch_model-00001-of-00002.bin HTTP/1.1" 200 167772160
2024-01-30 11:07:53:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:07:53:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo?Revision=master&FilePath=pytorch_model-00001-of-00002.bin HTTP/1.1" 200 167772160
2024-01-30 11:07:55:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:07:56:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo?Revision=master&FilePath=pytorch_model-00001-of-00002.bin HTTP/1.1" 200 167772160
2024-01-30 11:07:57:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:07:57:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo?Revision=master&FilePath=pytorch_model-00001-of-00002.bin HTTP/1.1" 200 167772160
2024-01-30 11:07:58:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:07:58:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo?Revision=master&FilePath=pytorch_model-00001-of-00002.bin HTTP/1.1" 200 167772160
2024-01-30 11:08:04:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:08:04:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo?Revision=master&FilePath=pytorch_model-00001-of-00002.bin HTTP/1.1" 200 167772160
2024-01-30 11:08:04:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:08:04:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo?Revision=master&FilePath=pytorch_model-00001-of-00002.bin HTTP/1.1" 200 167772160
2024-01-30 11:08:07:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:08:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo?Revision=master&FilePath=pytorch_model-00001-of-00002.bin HTTP/1.1" 200 167772160
2024-01-30 11:08:10:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:08:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo?Revision=master&FilePath=pytorch_model-00001-of-00002.bin HTTP/1.1" 200 167772160
2024-01-30 11:08:11:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:08:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo?Revision=master&FilePath=pytorch_model-00001-of-00002.bin HTTP/1.1" 200 167772160
2024-01-30 11:08:12:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:08:13:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo?Revision=master&FilePath=pytorch_model-00001-of-00002.bin HTTP/1.1" 200 167772160
2024-01-30 11:08:14:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:08:14:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo?Revision=master&FilePath=pytorch_model-00001-of-00002.bin HTTP/1.1" 200 167772160
2024-01-30 11:08:17:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:08:17:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo?Revision=master&FilePath=pytorch_model-00001-of-00002.bin HTTP/1.1" 200 167772160
2024-01-30 11:08:23:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:08:23:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo?Revision=master&FilePath=pytorch_model-00001-of-00002.bin HTTP/1.1" 200 167772160
2024-01-30 11:08:25:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:08:25:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo?Revision=master&FilePath=pytorch_model-00001-of-00002.bin HTTP/1.1" 200 167772160
2024-01-30 11:08:28:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:08:28:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo?Revision=master&FilePath=pytorch_model-00001-of-00002.bin HTTP/1.1" 200 167772160
2024-01-30 11:08:31:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:08:32:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo?Revision=master&FilePath=pytorch_model-00001-of-00002.bin HTTP/1.1" 200 167772160
2024-01-30 11:08:33:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:08:33:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:08:33:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo?Revision=master&FilePath=pytorch_model-00001-of-00002.bin HTTP/1.1" 200 167772160
2024-01-30 11:08:33:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo?Revision=master&FilePath=pytorch_model-00001-of-00002.bin HTTP/1.1" 200 167772160
2024-01-30 11:08:36:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:08:37:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo?Revision=master&FilePath=pytorch_model-00001-of-00002.bin HTTP/1.1" 200 167772160
2024-01-30 11:08:39:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:08:39:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo?Revision=master&FilePath=pytorch_model-00001-of-00002.bin HTTP/1.1" 200 167772160
2024-01-30 11:08:41:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:08:41:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo?Revision=master&FilePath=pytorch_model-00001-of-00002.bin HTTP/1.1" 200 167772160
2024-01-30 11:08:42:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:08:42:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:08:43:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo?Revision=master&FilePath=pytorch_model-00001-of-00002.bin HTTP/1.1" 200 167772160
2024-01-30 11:08:43:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo?Revision=master&FilePath=pytorch_model-00001-of-00002.bin HTTP/1.1" 200 167772160
2024-01-30 11:08:46:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:08:46:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo?Revision=master&FilePath=pytorch_model-00001-of-00002.bin HTTP/1.1" 200 167772160
2024-01-30 11:08:48:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:08:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo?Revision=master&FilePath=pytorch_model-00001-of-00002.bin HTTP/1.1" 200 167772160
2024-01-30 11:08:48:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:08:49:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo?Revision=master&FilePath=pytorch_model-00001-of-00002.bin HTTP/1.1" 200 167772160
2024-01-30 11:08:53:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:08:54:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo?Revision=master&FilePath=pytorch_model-00001-of-00002.bin HTTP/1.1" 200 167772160
2024-01-30 11:08:54:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:08:54:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo?Revision=master&FilePath=pytorch_model-00001-of-00002.bin HTTP/1.1" 200 167772160
2024-01-30 11:08:59:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:08:59:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo?Revision=master&FilePath=pytorch_model-00001-of-00002.bin HTTP/1.1" 200 167772160
2024-01-30 11:09:00:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:09:01:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo?Revision=master&FilePath=pytorch_model-00001-of-00002.bin HTTP/1.1" 200 167772160
2024-01-30 11:09:01:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:09:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo?Revision=master&FilePath=pytorch_model-00001-of-00002.bin HTTP/1.1" 200 167772160
2024-01-30 11:09:07:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:09:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo?Revision=master&FilePath=pytorch_model-00001-of-00002.bin HTTP/1.1" 200 167772160
2024-01-30 11:09:08:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:09:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo?Revision=master&FilePath=pytorch_model-00001-of-00002.bin HTTP/1.1" 200 167772160
2024-01-30 11:09:08:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:09:08:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:09:09:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo?Revision=master&FilePath=pytorch_model-00001-of-00002.bin HTTP/1.1" 200 167772160
2024-01-30 11:09:09:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo?Revision=master&FilePath=pytorch_model-00001-of-00002.bin HTTP/1.1" 200 167772160
2024-01-30 11:09:14:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:09:14:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:09:14:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo?Revision=master&FilePath=pytorch_model-00001-of-00002.bin HTTP/1.1" 200 167772160
2024-01-30 11:09:14:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo?Revision=master&FilePath=pytorch_model-00001-of-00002.bin HTTP/1.1" 200 167772160
2024-01-30 11:09:18:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:09:18:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo?Revision=master&FilePath=pytorch_model-00001-of-00002.bin HTTP/1.1" 200 167772160
2024-01-30 11:09:18:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:09:18:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo?Revision=master&FilePath=pytorch_model-00001-of-00002.bin HTTP/1.1" 200 167772160
2024-01-30 11:09:19:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:09:20:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo?Revision=master&FilePath=pytorch_model-00001-of-00002.bin HTTP/1.1" 200 167772160
2024-01-30 11:09:20:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:09:21:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo?Revision=master&FilePath=pytorch_model-00001-of-00002.bin HTTP/1.1" 200 167772160
2024-01-30 11:09:24:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:09:24:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo?Revision=master&FilePath=pytorch_model-00001-of-00002.bin HTTP/1.1" 200 167772160
2024-01-30 11:09:26:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:09:26:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo?Revision=master&FilePath=pytorch_model-00001-of-00002.bin HTTP/1.1" 200 167772160
2024-01-30 11:09:27:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:09:27:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo?Revision=master&FilePath=pytorch_model-00001-of-00002.bin HTTP/1.1" 200 167772160
2024-01-30 11:09:30:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:09:30:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo?Revision=master&FilePath=pytorch_model-00001-of-00002.bin HTTP/1.1" 200 167772160
2024-01-30 11:09:33:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:09:33:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo?Revision=master&FilePath=pytorch_model-00001-of-00002.bin HTTP/1.1" 200 167772160
2024-01-30 11:09:34:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:09:34:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo?Revision=master&FilePath=pytorch_model-00001-of-00002.bin HTTP/1.1" 200 44568227
2024-01-30 11:09:59:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:09:59:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:09:59:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:09:59:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:09:59:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo?Revision=master&FilePath=pytorch_model-00002-of-00002.bin HTTP/1.1" 200 167772160
2024-01-30 11:09:59:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo?Revision=master&FilePath=pytorch_model-00002-of-00002.bin HTTP/1.1" 200 167772160
2024-01-30 11:09:59:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo?Revision=master&FilePath=pytorch_model-00002-of-00002.bin HTTP/1.1" 200 167772160
2024-01-30 11:09:59:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo?Revision=master&FilePath=pytorch_model-00002-of-00002.bin HTTP/1.1" 200 167772160
2024-01-30 11:10:04:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:10:04:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo?Revision=master&FilePath=pytorch_model-00002-of-00002.bin HTTP/1.1" 200 167772160
2024-01-30 11:10:07:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:10:07:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo?Revision=master&FilePath=pytorch_model-00002-of-00002.bin HTTP/1.1" 200 167772160
2024-01-30 11:10:07:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:10:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo?Revision=master&FilePath=pytorch_model-00002-of-00002.bin HTTP/1.1" 200 167772160
2024-01-30 11:10:12:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:10:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo?Revision=master&FilePath=pytorch_model-00002-of-00002.bin HTTP/1.1" 200 167772160
2024-01-30 11:10:17:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:10:17:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo?Revision=master&FilePath=pytorch_model-00002-of-00002.bin HTTP/1.1" 200 167772160
2024-01-30 11:10:17:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:10:18:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo?Revision=master&FilePath=pytorch_model-00002-of-00002.bin HTTP/1.1" 200 167772160
2024-01-30 11:10:21:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:10:21:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo?Revision=master&FilePath=pytorch_model-00002-of-00002.bin HTTP/1.1" 200 167772160
2024-01-30 11:10:22:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:10:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo?Revision=master&FilePath=pytorch_model-00002-of-00002.bin HTTP/1.1" 200 167772160
2024-01-30 11:10:23:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:10:23:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo?Revision=master&FilePath=pytorch_model-00002-of-00002.bin HTTP/1.1" 200 165779477
2024-01-30 11:10:33:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:10:33:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo?Revision=master&FilePath=pytorch_model.bin.index.json HTTP/1.1" 200 23950
2024-01-30 11:10:41:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:10:42:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706584242 HTTP/1.1" 200 191
2024-01-30 11:10:42:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-30 11:10:44:INFO:trainable params: 2590732 || all params: 6063626252 || trainable%: 0.04272578639136085
2024-01-30 11:10:44:INFO:Init labels...
2024-01-30 11:10:44:INFO:Start training...
2024-01-30 11:11:29:INFO:TRAIN-(cmcm) (1/1/1)>> loss: 6.3549
2024-01-30 11:12:14:INFO:TRAIN-(cmcm) (2/2/1)>> loss: 4.7509
2024-01-30 11:12:58:INFO:TRAIN-(cmcm) (3/3/1)>> loss: 2.0946
2024-01-30 11:13:43:INFO:TRAIN-(cmcm) (4/4/1)>> loss: 1.8848
2024-01-30 11:14:31:INFO:TRAIN-(cmcm) (5/5/1)>> loss: 1.7952
2024-01-30 11:15:19:INFO:TRAIN-(cmcm) (6/6/1)>> loss: 1.8122
2024-01-30 11:16:04:INFO:TRAIN-(cmcm) (7/7/1)>> loss: 1.7672
2024-01-30 11:16:49:INFO:TRAIN-(cmcm) (8/8/1)>> loss: 1.7326
2024-01-30 11:17:33:INFO:TRAIN-(cmcm) (9/9/1)>> loss: 1.7370
2024-01-30 11:18:17:INFO:TRAIN-(cmcm) (10/10/1)>> loss: 1.7382
2024-01-30 11:19:17:INFO:Start running cmcm...
2024-01-30 11:19:17:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (4096, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': '01ai/Yi-6B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3, 3]. response: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 't_lstm_hidden_size': 128, 't_mlp_hidden_size': 256, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 't_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 't_lstm_dropout': 0.0, 'a_encoder_heads': 5, 'v_encoder_heads': 4, 'a_encoder_layers': 6, 'v_encoder_layers': 6, 'post_fusion_dim': 128, 'post_text_dim': 64, 'post_audio_dim': 64, 'post_video_dim': 64, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-01-30 11:19:17:INFO:Find gpu: 2, with memory: 381026304 left!
2024-01-30 11:19:17:INFO:Let's use the GPU 1 !
2024-01-30 11:19:17:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:19:17:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706584757 HTTP/1.1" 200 191
2024-01-30 11:19:18:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-30 11:19:18:INFO:train samples: (1284,)
2024-01-30 11:19:18:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:19:19:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706584759 HTTP/1.1" 200 191
2024-01-30 11:19:19:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-30 11:19:19:INFO:valid samples: (229,)
2024-01-30 11:19:19:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:19:20:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706584760 HTTP/1.1" 200 191
2024-01-30 11:19:20:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-30 11:19:20:INFO:test samples: (686,)
2024-01-30 11:19:20:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:19:21:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706584761 HTTP/1.1" 200 191
2024-01-30 11:19:21:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-30 11:19:29:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:19:29:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706584769 HTTP/1.1" 200 191
2024-01-30 11:19:29:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-30 11:19:31:INFO:trainable params: 2590732 || all params: 6063626252 || trainable%: 0.04272578639136085
2024-01-30 11:19:32:INFO:Init labels...
2024-01-30 11:19:32:INFO:Start training...
2024-01-30 11:20:22:INFO:TRAIN-(cmcm) (1/1/1)>> loss: 6.3549
2024-01-30 11:21:11:INFO:TRAIN-(cmcm) (2/2/1)>> loss: 4.7509
2024-01-30 11:22:00:INFO:TRAIN-(cmcm) (3/3/1)>> loss: 2.0946
2024-01-30 11:22:48:INFO:TRAIN-(cmcm) (4/4/1)>> loss: 1.8848
2024-01-30 11:23:37:INFO:TRAIN-(cmcm) (5/5/1)>> loss: 1.7952
2024-01-30 11:24:25:INFO:TRAIN-(cmcm) (6/6/1)>> loss: 1.8122
2024-01-30 11:25:11:INFO:TRAIN-(cmcm) (7/7/1)>> loss: 1.7672
2024-01-30 11:25:59:INFO:TRAIN-(cmcm) (8/8/1)>> loss: 1.7326
2024-01-30 11:26:49:INFO:TRAIN-(cmcm) (9/9/1)>> loss: 1.7370
2024-01-30 11:27:37:INFO:TRAIN-(cmcm) (10/10/1)>> loss: 1.7382
2024-01-30 11:29:55:INFO:Start running cmcm...
2024-01-30 11:29:55:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (4096, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': '01ai/Yi-6B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3, 3]. response: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 't_lstm_hidden_size': 128, 't_mlp_hidden_size': 256, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 't_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 't_lstm_dropout': 0.0, 'a_encoder_heads': 5, 'v_encoder_heads': 4, 'a_encoder_layers': 6, 'v_encoder_layers': 6, 'post_fusion_dim': 128, 'post_text_dim': 64, 'post_audio_dim': 64, 'post_video_dim': 64, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-01-30 11:29:55:INFO:Find gpu: 2, with memory: 381026304 left!
2024-01-30 11:29:55:INFO:Let's use the GPU 1 !
2024-01-30 11:29:55:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:29:56:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706585396 HTTP/1.1" 200 191
2024-01-30 11:29:56:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-30 11:40:19:INFO:Start running cmcm...
2024-01-30 11:40:19:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (4096, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': '01ai/Yi-6B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3, 3]. response: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 't_lstm_hidden_size': 128, 't_mlp_hidden_size': 256, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 't_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 't_lstm_dropout': 0.0, 'a_encoder_heads': 5, 'v_encoder_heads': 4, 'a_encoder_layers': 6, 'v_encoder_layers': 6, 'post_fusion_dim': 128, 'post_text_dim': 64, 'post_audio_dim': 64, 'post_video_dim': 64, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-01-30 11:40:19:INFO:Find gpu: 2, with memory: 381026304 left!
2024-01-30 11:40:19:INFO:Let's use the GPU 1 !
2024-01-30 11:40:19:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:40:20:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706586020 HTTP/1.1" 200 191
2024-01-30 11:40:20:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-30 11:41:09:INFO:Start running cmcm...
2024-01-30 11:41:09:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (4096, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': '01ai/Yi-6B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3, 3]. response: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 't_lstm_hidden_size': 128, 't_mlp_hidden_size': 256, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 't_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 't_lstm_dropout': 0.0, 'a_encoder_heads': 5, 'v_encoder_heads': 4, 'a_encoder_layers': 6, 'v_encoder_layers': 6, 'post_fusion_dim': 128, 'post_text_dim': 64, 'post_audio_dim': 64, 'post_video_dim': 64, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-01-30 11:41:09:INFO:Find gpu: 2, with memory: 381026304 left!
2024-01-30 11:41:09:INFO:Let's use the GPU 1 !
2024-01-30 11:41:09:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:41:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706586070 HTTP/1.1" 200 191
2024-01-30 11:41:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-30 11:41:10:INFO:train samples: (1284,)
2024-01-30 11:41:11:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:41:11:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706586071 HTTP/1.1" 200 191
2024-01-30 11:41:11:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-30 11:41:11:INFO:valid samples: (229,)
2024-01-30 11:41:12:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:41:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706586072 HTTP/1.1" 200 191
2024-01-30 11:41:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-30 11:41:13:INFO:test samples: (686,)
2024-01-30 11:41:13:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:41:13:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706586073 HTTP/1.1" 200 191
2024-01-30 11:41:13:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-30 11:41:21:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:41:21:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706586081 HTTP/1.1" 200 191
2024-01-30 11:41:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-30 11:41:24:INFO:trainable params: 2590732 || all params: 6063626252 || trainable%: 0.04272578639136085
2024-01-30 11:41:25:INFO:Init labels...
2024-01-30 11:41:25:INFO:Start training...
2024-01-30 11:42:12:INFO:TRAIN-(cmcm) (1/1/1)>> loss: 7.2591
2024-01-30 11:42:59:INFO:TRAIN-(cmcm) (2/2/1)>> loss: 5.3890
2024-01-30 11:43:48:INFO:TRAIN-(cmcm) (3/3/1)>> loss: 2.1009
2024-01-30 11:44:36:INFO:TRAIN-(cmcm) (4/4/1)>> loss: 1.8432
2024-01-30 11:45:24:INFO:TRAIN-(cmcm) (5/5/1)>> loss: 1.7929
2024-01-30 11:47:05:INFO:Start running cmcm...
2024-01-30 11:47:05:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (4096, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': '01ai/Yi-6B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3, 3]. response: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 't_lstm_hidden_size': 128, 't_mlp_hidden_size': 256, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 't_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 't_lstm_dropout': 0.0, 'a_encoder_heads': 5, 'v_encoder_heads': 4, 'a_encoder_layers': 6, 'v_encoder_layers': 6, 'post_fusion_dim': 128, 'post_text_dim': 64, 'post_audio_dim': 64, 'post_video_dim': 64, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-01-30 11:47:05:INFO:Find gpu: 2, with memory: 381026304 left!
2024-01-30 11:47:05:INFO:Let's use the GPU 1 !
2024-01-30 11:47:06:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:47:06:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706586426 HTTP/1.1" 200 191
2024-01-30 11:47:06:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-30 11:47:07:INFO:train samples: (1284,)
2024-01-30 11:47:07:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:47:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706586428 HTTP/1.1" 200 191
2024-01-30 11:47:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-30 11:47:08:INFO:valid samples: (229,)
2024-01-30 11:47:09:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:47:09:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706586429 HTTP/1.1" 200 191
2024-01-30 11:47:09:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-30 11:47:10:INFO:test samples: (686,)
2024-01-30 11:47:10:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:47:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706586430 HTTP/1.1" 200 191
2024-01-30 11:47:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-30 11:47:18:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:47:19:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706586439 HTTP/1.1" 200 191
2024-01-30 11:47:19:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-30 11:47:21:INFO:trainable params: 2590732 || all params: 6063626252 || trainable%: 0.04272578639136085
2024-01-30 11:47:22:INFO:Init labels...
2024-01-30 11:47:22:INFO:Start training...
2024-01-30 11:48:12:INFO:TRAIN-(cmcm) (1/1/1)>> loss: 6.3549
2024-01-30 11:49:00:INFO:TRAIN-(cmcm) (2/2/1)>> loss: 4.7509
2024-01-30 11:49:47:INFO:TRAIN-(cmcm) (3/3/1)>> loss: 2.0946
2024-01-30 11:50:33:INFO:TRAIN-(cmcm) (4/4/1)>> loss: 1.8848
2024-01-30 11:51:22:INFO:TRAIN-(cmcm) (5/5/1)>> loss: 1.7952
2024-01-30 11:53:41:INFO:Start running cmcm...
2024-01-30 11:53:41:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (4096, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': '01ai/Yi-6B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3, 3]. response: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 't_lstm_hidden_size': 128, 't_mlp_hidden_size': 256, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 't_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 't_lstm_dropout': 0.0, 'a_encoder_heads': 5, 'v_encoder_heads': 4, 'a_encoder_layers': 6, 'v_encoder_layers': 6, 'post_fusion_dim': 128, 'post_text_dim': 64, 'post_audio_dim': 64, 'post_video_dim': 64, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-01-30 11:53:41:INFO:Find gpu: 2, with memory: 381026304 left!
2024-01-30 11:53:41:INFO:Let's use the GPU 1 !
2024-01-30 11:53:42:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:53:42:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706586822 HTTP/1.1" 200 191
2024-01-30 11:53:48:INFO:Start running cmcm...
2024-01-30 11:53:48:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (4096, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': '01ai/Yi-6B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3, 3]. response: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 't_lstm_hidden_size': 128, 't_mlp_hidden_size': 256, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 't_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 't_lstm_dropout': 0.0, 'a_encoder_heads': 5, 'v_encoder_heads': 4, 'a_encoder_layers': 6, 'v_encoder_layers': 6, 'post_fusion_dim': 128, 'post_text_dim': 64, 'post_audio_dim': 64, 'post_video_dim': 64, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-01-30 11:53:48:INFO:Find gpu: 2, with memory: 381026304 left!
2024-01-30 11:53:48:INFO:Let's use the GPU 1 !
2024-01-30 11:53:48:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:53:49:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706586829 HTTP/1.1" 200 191
2024-01-30 11:53:49:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-30 11:53:50:INFO:train samples: (1284,)
2024-01-30 11:53:50:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:53:50:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706586830 HTTP/1.1" 200 191
2024-01-30 11:53:51:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-30 11:53:51:INFO:valid samples: (229,)
2024-01-30 11:53:51:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:53:52:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706586832 HTTP/1.1" 200 191
2024-01-30 11:53:52:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-30 11:53:52:INFO:test samples: (686,)
2024-01-30 11:53:52:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:53:53:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706586833 HTTP/1.1" 200 191
2024-01-30 11:53:53:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-30 11:54:01:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 11:54:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706586842 HTTP/1.1" 200 191
2024-01-30 11:54:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-30 11:54:05:INFO:trainable params: 2590732 || all params: 6063626252 || trainable%: 0.04272578639136085
2024-01-30 11:54:06:INFO:Init labels...
2024-01-30 11:54:06:INFO:Start training...
2024-01-30 11:54:54:INFO:TRAIN-(cmcm) (1/1/1)>> loss: 7.2591
2024-01-30 11:55:41:INFO:TRAIN-(cmcm) (2/2/1)>> loss: 5.3890
2024-01-30 11:56:30:INFO:TRAIN-(cmcm) (3/3/1)>> loss: 2.1009
2024-01-30 11:57:17:INFO:TRAIN-(cmcm) (4/4/1)>> loss: 1.8432
2024-01-30 11:58:07:INFO:TRAIN-(cmcm) (5/5/1)>> loss: 1.7929
2024-01-30 11:58:57:INFO:TRAIN-(cmcm) (6/6/1)>> loss: 1.7050
2024-01-30 11:59:47:INFO:TRAIN-(cmcm) (7/7/1)>> loss: 1.6693
2024-01-30 12:00:36:INFO:TRAIN-(cmcm) (8/8/1)>> loss: 1.6714
2024-01-30 12:01:25:INFO:TRAIN-(cmcm) (9/9/1)>> loss: 1.6473
2024-01-30 12:02:11:INFO:TRAIN-(cmcm) (10/10/1)>> loss: 1.6296
2024-01-30 12:06:03:INFO:Start running cmcm...
2024-01-30 12:06:03:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (4096, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': '01ai/Yi-6B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3, 3]. response: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 't_lstm_hidden_size': 128, 't_mlp_hidden_size': 256, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 't_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 't_lstm_dropout': 0.0, 'a_encoder_heads': 5, 'v_encoder_heads': 4, 'a_encoder_layers': 6, 'v_encoder_layers': 6, 'post_fusion_dim': 128, 'post_text_dim': 64, 'post_audio_dim': 64, 'post_video_dim': 64, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-01-30 12:06:03:INFO:Find gpu: 2, with memory: 381026304 left!
2024-01-30 12:06:03:INFO:Let's use the GPU 1 !
2024-01-30 12:06:03:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 12:06:03:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706587564 HTTP/1.1" 200 191
2024-01-30 12:06:04:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-30 12:06:04:INFO:train samples: (1284,)
2024-01-30 12:06:04:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 12:06:05:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706587565 HTTP/1.1" 200 191
2024-01-30 12:06:05:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-30 12:06:05:INFO:valid samples: (229,)
2024-01-30 12:06:06:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 12:06:06:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706587566 HTTP/1.1" 200 191
2024-01-30 12:06:06:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-30 12:06:06:INFO:test samples: (686,)
2024-01-30 12:06:07:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 12:06:07:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706587567 HTTP/1.1" 200 191
2024-01-30 12:06:07:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-30 12:06:15:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 12:06:15:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706587575 HTTP/1.1" 200 191
2024-01-30 12:06:15:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-30 12:06:18:INFO:trainable params: 2590732 || all params: 6063626252 || trainable%: 0.04272578639136085
2024-01-30 12:06:19:INFO:Init labels...
2024-01-30 12:06:19:INFO:Start training...
2024-01-30 12:07:10:INFO:TRAIN-(cmcm) (1/1/1)>> loss: 7.2591
2024-01-30 12:07:59:INFO:TRAIN-(cmcm) (2/2/1)>> loss: 5.3890
2024-01-30 12:08:49:INFO:TRAIN-(cmcm) (3/3/1)>> loss: 2.1009
2024-01-30 12:09:38:INFO:TRAIN-(cmcm) (4/4/1)>> loss: 1.8432
2024-01-30 12:10:27:INFO:TRAIN-(cmcm) (5/5/1)>> loss: 1.7929
2024-01-30 12:11:44:INFO:Start running cmcm...
2024-01-30 12:11:44:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (4096, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': '01ai/Yi-6B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3, 3]. response: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 't_lstm_hidden_size': 128, 't_mlp_hidden_size': 256, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 't_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 't_lstm_dropout': 0.0, 'a_encoder_heads': 5, 'v_encoder_heads': 4, 'a_encoder_layers': 6, 'v_encoder_layers': 6, 'post_fusion_dim': 128, 'post_text_dim': 64, 'post_audio_dim': 64, 'post_video_dim': 64, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-01-30 12:11:44:INFO:Find gpu: 2, with memory: 381026304 left!
2024-01-30 12:11:44:INFO:Let's use the GPU 1 !
2024-01-30 12:11:45:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 12:11:45:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706587905 HTTP/1.1" 200 191
2024-01-30 12:11:45:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-30 12:11:46:INFO:train samples: (1284,)
2024-01-30 12:11:46:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 12:11:46:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706587907 HTTP/1.1" 200 191
2024-01-30 12:11:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-30 12:11:47:INFO:valid samples: (229,)
2024-01-30 12:11:47:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 12:11:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706587908 HTTP/1.1" 200 191
2024-01-30 12:11:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-30 12:11:48:INFO:test samples: (686,)
2024-01-30 12:11:48:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 12:11:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706587909 HTTP/1.1" 200 191
2024-01-30 12:11:49:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-30 12:11:56:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 12:11:57:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706587917 HTTP/1.1" 200 191
2024-01-30 12:11:57:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-30 12:12:00:INFO:trainable params: 2590732 || all params: 6063626252 || trainable%: 0.04272578639136085
2024-01-30 12:12:01:INFO:Init labels...
2024-01-30 12:12:01:INFO:Start training...
2024-01-30 12:12:50:INFO:TRAIN-(cmcm) (1/1/1)>> loss: 7.2591
2024-01-30 12:13:40:INFO:TRAIN-(cmcm) (2/2/1)>> loss: 5.3890
2024-01-30 12:14:30:INFO:TRAIN-(cmcm) (3/3/1)>> loss: 2.1009
2024-01-30 12:15:21:INFO:TRAIN-(cmcm) (4/4/1)>> loss: 1.8432
2024-01-30 12:16:10:INFO:TRAIN-(cmcm) (5/5/1)>> loss: 1.7929
2024-01-30 12:17:29:INFO:Start running cmcm...
2024-01-30 12:17:29:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (4096, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': '01ai/Yi-6B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3, 3]. response: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 't_lstm_hidden_size': 128, 't_mlp_hidden_size': 256, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 't_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 't_lstm_dropout': 0.0, 'a_encoder_heads': 5, 'v_encoder_heads': 4, 'a_encoder_layers': 6, 'v_encoder_layers': 6, 'post_fusion_dim': 128, 'post_text_dim': 64, 'post_audio_dim': 64, 'post_video_dim': 64, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-01-30 12:17:29:INFO:Find gpu: 2, with memory: 381026304 left!
2024-01-30 12:17:29:INFO:Let's use the GPU 1 !
2024-01-30 12:17:30:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 12:17:30:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706588250 HTTP/1.1" 200 191
2024-01-30 12:17:30:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-30 12:17:31:INFO:train samples: (1284,)
2024-01-30 12:17:31:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 12:17:31:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706588252 HTTP/1.1" 200 191
2024-01-30 12:17:32:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-30 12:17:32:INFO:valid samples: (229,)
2024-01-30 12:17:32:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 12:17:32:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706588253 HTTP/1.1" 200 191
2024-01-30 12:17:33:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-30 12:17:33:INFO:test samples: (686,)
2024-01-30 12:17:33:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 12:17:42:INFO:Start running cmcm...
2024-01-30 12:17:42:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (4096, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': '01ai/Yi-6B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3, 3]. response: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 't_lstm_hidden_size': 128, 't_mlp_hidden_size': 256, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 't_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 't_lstm_dropout': 0.0, 'a_encoder_heads': 5, 'v_encoder_heads': 4, 'a_encoder_layers': 6, 'v_encoder_layers': 6, 'post_fusion_dim': 128, 'post_text_dim': 64, 'post_audio_dim': 64, 'post_video_dim': 64, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-01-30 12:17:42:INFO:Find gpu: 2, with memory: 381026304 left!
2024-01-30 12:17:42:INFO:Let's use the GPU 1 !
2024-01-30 12:17:42:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 12:17:42:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706588262 HTTP/1.1" 200 191
2024-01-30 12:17:43:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-30 12:17:43:INFO:train samples: (1284,)
2024-01-30 12:17:43:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 12:17:44:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706588264 HTTP/1.1" 200 191
2024-01-30 12:17:44:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-30 12:17:44:INFO:valid samples: (229,)
2024-01-30 12:17:45:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 12:17:45:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706588265 HTTP/1.1" 200 191
2024-01-30 12:17:45:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-30 12:17:46:INFO:test samples: (686,)
2024-01-30 12:17:46:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 12:17:46:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706588266 HTTP/1.1" 200 191
2024-01-30 12:17:46:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-30 12:17:55:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 12:17:56:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706588276 HTTP/1.1" 200 191
2024-01-30 12:17:56:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-30 12:17:59:INFO:trainable params: 2590732 || all params: 6063626252 || trainable%: 0.04272578639136085
2024-01-30 12:17:59:INFO:Init labels...
2024-01-30 12:17:59:INFO:Start training...
2024-01-30 12:18:48:INFO:TRAIN-(cmcm) (1/1/1)>> loss: 7.2591
2024-01-30 12:18:55:INFO:VAL-(cmcm) >>
2024-01-30 12:18:55:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4259  Non0_F1_score: 0.2544  Mult_acc_5: 0.2140  Mult_acc_7: 0.2140  MAE: 1.4370  Corr: nan 
2024-01-30 12:19:01:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-01-30 12:19:49:INFO:TRAIN-(cmcm) (1/2/1)>> loss: 5.4099
2024-01-30 12:19:58:INFO:VAL-(cmcm) >>
2024-01-30 12:19:58:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4259  Non0_F1_score: 0.3166  Mult_acc_5: 0.1790  Mult_acc_7: 0.1790  MAE: 147.7124  Corr: -0.0685 
2024-01-30 12:20:46:INFO:TRAIN-(cmcm) (2/3/1)>> loss: 2.1640
2024-01-30 12:20:54:INFO:VAL-(cmcm) >>
2024-01-30 12:20:54:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4458  Non0_acc_2: 0.4259  Non0_F1_score: 0.2624  Mult_acc_5: 0.2096  Mult_acc_7: 0.2096  MAE: 2.3130  Corr: 0.0192 
2024-01-30 12:21:41:INFO:TRAIN-(cmcm) (3/4/1)>> loss: 1.8162
2024-01-30 12:21:49:INFO:VAL-(cmcm) >>
2024-01-30 12:21:49:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4444  Non0_F1_score: 0.3077  Mult_acc_5: 0.2271  Mult_acc_7: 0.2271  MAE: 1.4262  Corr: 0.0337 
2024-01-30 12:21:54:INFO:Saving checkpoint at epoch 4 to results/models/cmcm-mosi-regression.pth.
2024-01-30 12:22:43:INFO:TRAIN-(cmcm) (1/5/1)>> loss: 1.7760
2024-01-30 12:22:51:INFO:VAL-(cmcm) >>
2024-01-30 12:22:51:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4167  Non0_F1_score: 0.2505  Mult_acc_5: 0.2096  Mult_acc_7: 0.2096  MAE: 1.4807  Corr: -0.0365 
2024-01-30 12:23:37:INFO:TRAIN-(cmcm) (2/6/1)>> loss: 1.7197
2024-01-30 12:23:45:INFO:VAL-(cmcm) >>
2024-01-30 12:23:45:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4259  Non0_F1_score: 0.2544  Mult_acc_5: 0.2140  Mult_acc_7: 0.2140  MAE: 1.4370  Corr: nan 
2024-01-30 12:24:32:INFO:TRAIN-(cmcm) (3/7/1)>> loss: 1.6864
2024-01-30 12:24:40:INFO:VAL-(cmcm) >>
2024-01-30 12:24:40:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4556  Non0_acc_2: 0.4120  Non0_F1_score: 0.2637  Mult_acc_5: 0.2096  Mult_acc_7: 0.2096  MAE: 1.4737  Corr: -0.0782 
2024-01-30 12:25:27:INFO:TRAIN-(cmcm) (4/8/1)>> loss: 1.6639
2024-01-30 12:25:34:INFO:VAL-(cmcm) >>
2024-01-30 12:25:34:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4213  Non0_F1_score: 0.2604  Mult_acc_5: 0.2096  Mult_acc_7: 0.2096  MAE: 1.4895  Corr: -0.1000 
2024-01-30 12:26:21:INFO:TRAIN-(cmcm) (5/9/1)>> loss: 1.6547
2024-01-30 12:26:29:INFO:VAL-(cmcm) >>
2024-01-30 12:26:29:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4213  Non0_F1_score: 0.2753  Mult_acc_5: 0.2227  Mult_acc_7: 0.2227  MAE: 1.4798  Corr: -0.1166 
2024-01-30 12:27:17:INFO:TRAIN-(cmcm) (6/10/1)>> loss: 1.6403
2024-01-30 12:27:25:INFO:VAL-(cmcm) >>
2024-01-30 12:27:25:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4352  Non0_F1_score: 0.2743  Mult_acc_5: 0.2183  Mult_acc_7: 0.2183  MAE: 1.4309  Corr: 0.0445 
2024-01-30 12:28:12:INFO:TRAIN-(cmcm) (7/11/1)>> loss: 1.6366
2024-01-30 12:28:20:INFO:VAL-(cmcm) >>
2024-01-30 12:28:20:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4398  Non0_F1_score: 0.3119  Mult_acc_5: 0.2183  Mult_acc_7: 0.2096  MAE: 1.6715  Corr: -0.0337 
2024-01-30 12:29:09:INFO:TRAIN-(cmcm) (8/12/1)>> loss: 1.6090
2024-01-30 12:29:17:INFO:VAL-(cmcm) >>
2024-01-30 12:29:17:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4352  Non0_F1_score: 0.2892  Mult_acc_5: 0.2183  Mult_acc_7: 0.2183  MAE: 1.4362  Corr: 0.0242 
2024-01-30 12:30:04:INFO:TRAIN-(cmcm) (9/13/1)>> loss: 1.6031
2024-01-30 12:30:12:INFO:VAL-(cmcm) >>
2024-01-30 12:30:12:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4259  Non0_F1_score: 0.2544  Mult_acc_5: 0.2140  Mult_acc_7: 0.2140  MAE: 1.4370  Corr: nan 
2024-01-30 12:30:57:INFO:TRAIN-(cmcm) (10/14/1)>> loss: 1.6105
2024-01-30 12:31:05:INFO:VAL-(cmcm) >>
2024-01-30 12:31:05:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4259  Non0_F1_score: 0.2544  Mult_acc_5: 0.2140  Mult_acc_7: 0.2140  MAE: 1.4370  Corr: nan 
2024-01-30 12:31:29:INFO:TEST-(cmcm) >>
2024-01-30 12:31:29:INFO:M: >>  Has0_acc_2: 0.4475  Has0_F1_score: 0.2767  Non0_acc_2: 0.5808  Non0_F1_score: 0.4429  Mult_acc_5: 0.1589  Mult_acc_7: 0.1589  MAE: 1.4166  Corr: 0.0372 
2024-01-30 12:31:29:INFO:Results are added to results/results/mosi-regression-30.csv...
2024-01-30 12:31:29:INFO:Start running cmcm...
2024-01-30 12:31:29:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [2], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (4096, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': '01ai/Yi-6B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3, 3]. response: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 't_lstm_hidden_size': 128, 't_mlp_hidden_size': 256, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 't_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 't_lstm_dropout': 0.0, 'a_encoder_heads': 5, 'v_encoder_heads': 4, 'a_encoder_layers': 6, 'v_encoder_layers': 6, 'post_fusion_dim': 128, 'post_text_dim': 64, 'post_audio_dim': 64, 'post_video_dim': 64, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 2222}>
2024-01-30 12:31:29:INFO:Let's use the GPU 1 !
2024-01-30 12:31:29:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 12:31:30:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706589090 HTTP/1.1" 200 191
2024-01-30 12:31:30:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-30 12:31:30:INFO:train samples: (1284,)
2024-01-30 12:31:30:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 12:31:31:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706589091 HTTP/1.1" 200 191
2024-01-30 12:31:31:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-30 12:31:31:INFO:valid samples: (229,)
2024-01-30 12:31:31:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 12:31:32:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706589092 HTTP/1.1" 200 191
2024-01-30 12:31:32:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-30 12:31:32:INFO:test samples: (686,)
2024-01-30 12:31:32:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 12:31:33:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706589093 HTTP/1.1" 200 191
2024-01-30 12:31:33:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-30 12:31:40:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 12:31:41:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706589101 HTTP/1.1" 200 191
2024-01-30 12:31:41:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-30 12:31:43:INFO:trainable params: 2590732 || all params: 6063626252 || trainable%: 0.04272578639136085
2024-01-30 12:31:43:INFO:Init labels...
2024-01-30 12:31:43:INFO:Start training...
2024-01-30 12:32:28:INFO:TRAIN-(cmcm) (1/1/2)>> loss: 7.1583
2024-01-30 12:32:36:INFO:VAL-(cmcm) >>
2024-01-30 12:32:36:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4259  Non0_F1_score: 0.2544  Mult_acc_5: 0.2140  Mult_acc_7: 0.2140  MAE: 1.4370  Corr: nan 
2024-01-30 12:32:41:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-01-30 12:33:28:INFO:TRAIN-(cmcm) (1/2/2)>> loss: 4.1927
2024-01-30 12:33:36:INFO:VAL-(cmcm) >>
2024-01-30 12:33:36:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4306  Non0_F1_score: 0.3896  Mult_acc_5: 0.2227  Mult_acc_7: 0.2183  MAE: 1.6069  Corr: -0.0389 
2024-01-30 12:34:20:INFO:TRAIN-(cmcm) (2/3/2)>> loss: 2.0951
2024-01-30 12:34:29:INFO:VAL-(cmcm) >>
2024-01-30 12:34:29:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5509  Non0_F1_score: 0.5425  Mult_acc_5: 0.2445  Mult_acc_7: 0.2271  MAE: 1.5842  Corr: -0.0216 
2024-01-30 12:35:15:INFO:TRAIN-(cmcm) (3/4/2)>> loss: 1.8916
2024-01-30 12:35:23:INFO:VAL-(cmcm) >>
2024-01-30 12:35:23:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5417  Non0_F1_score: 0.4592  Mult_acc_5: 0.2358  Mult_acc_7: 0.2052  MAE: 2.4098  Corr: -0.0647 
2024-01-30 12:36:08:INFO:TRAIN-(cmcm) (4/5/2)>> loss: 1.8407
2024-01-30 12:36:16:INFO:VAL-(cmcm) >>
2024-01-30 12:36:16:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5463  Non0_F1_score: 0.4997  Mult_acc_5: 0.1747  Mult_acc_7: 0.1659  MAE: 6.1414  Corr: 0.0439 
2024-01-30 12:37:04:INFO:TRAIN-(cmcm) (5/6/2)>> loss: 1.8033
2024-01-30 12:37:11:INFO:VAL-(cmcm) >>
2024-01-30 12:37:11:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5509  Non0_F1_score: 0.5184  Mult_acc_5: 0.2314  Mult_acc_7: 0.1834  MAE: 7.9084  Corr: 0.0400 
2024-01-30 12:37:57:INFO:TRAIN-(cmcm) (6/7/2)>> loss: 1.7807
2024-01-30 12:38:05:INFO:VAL-(cmcm) >>
2024-01-30 12:38:05:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5185  Non0_F1_score: 0.5036  Mult_acc_5: 0.2009  Mult_acc_7: 0.1921  MAE: 1.7292  Corr: -0.0068 
2024-01-30 12:38:51:INFO:TRAIN-(cmcm) (7/8/2)>> loss: 1.7559
2024-01-30 12:38:59:INFO:VAL-(cmcm) >>
2024-01-30 12:38:59:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4444  Non0_F1_score: 0.4352  Mult_acc_5: 0.1965  Mult_acc_7: 0.1790  MAE: 2.1204  Corr: -0.0615 
2024-01-30 12:39:45:INFO:TRAIN-(cmcm) (8/9/2)>> loss: 1.7389
2024-01-30 12:39:53:INFO:VAL-(cmcm) >>
2024-01-30 12:39:53:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4861  Non0_F1_score: 0.4769  Mult_acc_5: 0.1965  Mult_acc_7: 0.1878  MAE: 2.3842  Corr: 0.0174 
2024-01-30 12:40:39:INFO:TRAIN-(cmcm) (9/10/2)>> loss: 1.7174
2024-01-30 12:40:47:INFO:VAL-(cmcm) >>
2024-01-30 12:40:47:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4861  Non0_F1_score: 0.4830  Mult_acc_5: 0.1659  Mult_acc_7: 0.1572  MAE: 2.5375  Corr: 0.0547 
2024-01-30 12:41:33:INFO:TRAIN-(cmcm) (10/11/2)>> loss: 1.7015
2024-01-30 12:41:41:INFO:VAL-(cmcm) >>
2024-01-30 12:41:41:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4907  Non0_F1_score: 0.4555  Mult_acc_5: 0.2314  Mult_acc_7: 0.2227  MAE: 5.8938  Corr: 0.0443 
2024-01-30 12:42:04:INFO:TEST-(cmcm) >>
2024-01-30 12:42:04:INFO:M: >>  Has0_acc_2: 0.4475  Has0_F1_score: 0.2767  Non0_acc_2: 0.5777  Non0_F1_score: 0.4231  Mult_acc_5: 0.1545  Mult_acc_7: 0.1545  MAE: 1.4174  Corr: nan 
2024-01-30 12:42:05:INFO:Results are added to results/results/mosi-regression-30.csv...
2024-01-30 12:42:05:INFO:Start running cmcm...
2024-01-30 12:42:05:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [2], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (4096, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': '01ai/Yi-6B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3, 3]. response: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 't_lstm_hidden_size': 128, 't_mlp_hidden_size': 256, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 't_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 't_lstm_dropout': 0.0, 'a_encoder_heads': 5, 'v_encoder_heads': 4, 'a_encoder_layers': 6, 'v_encoder_layers': 6, 'post_fusion_dim': 128, 'post_text_dim': 64, 'post_audio_dim': 64, 'post_video_dim': 64, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 3333}>
2024-01-30 12:42:05:INFO:Let's use the GPU 1 !
2024-01-30 12:42:05:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 12:42:05:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706589725 HTTP/1.1" 200 191
2024-01-30 12:42:05:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-30 12:42:06:INFO:train samples: (1284,)
2024-01-30 12:42:06:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 12:42:06:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706589726 HTTP/1.1" 200 191
2024-01-30 12:42:07:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-30 12:42:07:INFO:valid samples: (229,)
2024-01-30 12:42:07:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 12:42:07:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706589727 HTTP/1.1" 200 191
2024-01-30 12:42:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-30 12:42:08:INFO:test samples: (686,)
2024-01-30 12:42:08:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 12:42:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706589729 HTTP/1.1" 200 191
2024-01-30 12:42:09:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-30 12:42:16:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 12:42:17:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706589737 HTTP/1.1" 200 191
2024-01-30 12:42:17:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-30 12:42:19:INFO:trainable params: 2590732 || all params: 6063626252 || trainable%: 0.04272578639136085
2024-01-30 12:42:19:INFO:Init labels...
2024-01-30 12:42:19:INFO:Start training...
2024-01-30 12:43:04:INFO:TRAIN-(cmcm) (1/1/3)>> loss: 7.1391
2024-01-30 12:43:12:INFO:VAL-(cmcm) >>
2024-01-30 12:43:12:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4259  Non0_F1_score: 0.2544  Mult_acc_5: 0.2140  Mult_acc_7: 0.2140  MAE: 1.4370  Corr: nan 
2024-01-30 12:43:18:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-01-30 12:44:06:INFO:TRAIN-(cmcm) (1/2/3)>> loss: 6.8669
2024-01-30 12:44:14:INFO:VAL-(cmcm) >>
2024-01-30 12:44:14:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4259  Non0_F1_score: 0.2544  Mult_acc_5: 0.2140  Mult_acc_7: 0.2140  MAE: 1.4370  Corr: nan 
2024-01-30 12:45:01:INFO:TRAIN-(cmcm) (2/3/3)>> loss: 3.3968
2024-01-30 12:45:08:INFO:VAL-(cmcm) >>
2024-01-30 12:45:08:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4722  Non0_F1_score: 0.4604  Mult_acc_5: 0.2489  Mult_acc_7: 0.1747  MAE: 98.9111  Corr: 0.0759 
2024-01-30 12:45:56:INFO:TRAIN-(cmcm) (3/4/3)>> loss: 1.9516
2024-01-30 12:46:04:INFO:VAL-(cmcm) >>
2024-01-30 12:46:04:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5463  Non0_F1_score: 0.5440  Mult_acc_5: 0.3013  Mult_acc_7: 0.2314  MAE: 178.8646  Corr: -0.1139 
2024-01-30 12:46:50:INFO:TRAIN-(cmcm) (4/5/3)>> loss: 1.8244
2024-01-30 12:46:58:INFO:VAL-(cmcm) >>
2024-01-30 12:46:58:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5324  Non0_F1_score: 0.5205  Mult_acc_5: 0.2751  Mult_acc_7: 0.1747  MAE: 1168.3229  Corr: 0.0680 
2024-01-30 12:47:46:INFO:TRAIN-(cmcm) (5/6/3)>> loss: 1.7853
2024-01-30 12:47:53:INFO:VAL-(cmcm) >>
2024-01-30 12:47:53:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5556  Non0_F1_score: 0.5577  Mult_acc_5: 0.2795  Mult_acc_7: 0.2096  MAE: 2.7657  Corr: 0.0924 
2024-01-30 12:48:40:INFO:TRAIN-(cmcm) (6/7/3)>> loss: 1.7638
2024-01-30 12:48:48:INFO:VAL-(cmcm) >>
2024-01-30 12:48:48:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5185  Non0_F1_score: 0.5152  Mult_acc_5: 0.2664  Mult_acc_7: 0.1878  MAE: 2.7654  Corr: 0.0755 
2024-01-30 12:49:32:INFO:TRAIN-(cmcm) (7/8/3)>> loss: 1.7440
2024-01-30 12:49:40:INFO:VAL-(cmcm) >>
2024-01-30 12:49:40:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.6065  Non0_F1_score: 0.5646  Mult_acc_5: 0.3144  Mult_acc_7: 0.2183  MAE: 100.8461  Corr: 0.0760 
2024-01-30 12:50:26:INFO:TRAIN-(cmcm) (8/9/3)>> loss: 1.7094
2024-01-30 12:50:34:INFO:VAL-(cmcm) >>
2024-01-30 12:50:34:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5787  Non0_F1_score: 0.5553  Mult_acc_5: 0.3057  Mult_acc_7: 0.1878  MAE: 198.4518  Corr: 0.1076 
2024-01-30 12:51:20:INFO:TRAIN-(cmcm) (9/10/3)>> loss: 1.6991
2024-01-30 12:51:28:INFO:VAL-(cmcm) >>
2024-01-30 12:51:28:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5509  Non0_F1_score: 0.5518  Mult_acc_5: 0.2969  Mult_acc_7: 0.2183  MAE: 3.1645  Corr: 0.0670 
2024-01-30 12:52:14:INFO:TRAIN-(cmcm) (10/11/3)>> loss: 1.6879
2024-01-30 12:52:22:INFO:VAL-(cmcm) >>
2024-01-30 12:52:22:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5602  Non0_F1_score: 0.5610  Mult_acc_5: 0.2707  Mult_acc_7: 0.2052  MAE: 1.8568  Corr: 0.0171 
2024-01-30 12:52:45:INFO:TEST-(cmcm) >>
2024-01-30 12:52:45:INFO:M: >>  Has0_acc_2: 0.4475  Has0_F1_score: 0.2767  Non0_acc_2: 0.5793  Non0_F1_score: 0.4266  Mult_acc_5: 0.1501  Mult_acc_7: 0.1501  MAE: 33.8133  Corr: 0.0076 
2024-01-30 12:52:46:INFO:Results are added to results/results/mosi-regression-30.csv...
2024-01-30 12:52:46:INFO:Start running cmcm...
2024-01-30 12:52:46:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [2], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (4096, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': '01ai/Yi-6B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3, 3]. response: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 't_lstm_hidden_size': 128, 't_mlp_hidden_size': 256, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 't_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 't_lstm_dropout': 0.0, 'a_encoder_heads': 5, 'v_encoder_heads': 4, 'a_encoder_layers': 6, 'v_encoder_layers': 6, 'post_fusion_dim': 128, 'post_text_dim': 64, 'post_audio_dim': 64, 'post_video_dim': 64, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 4444}>
2024-01-30 12:52:46:INFO:Let's use the GPU 1 !
2024-01-30 12:52:46:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 12:52:46:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706590366 HTTP/1.1" 200 191
2024-01-30 12:52:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-30 12:52:47:INFO:train samples: (1284,)
2024-01-30 12:52:47:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 12:52:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706590368 HTTP/1.1" 200 191
2024-01-30 12:52:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-30 12:52:48:INFO:valid samples: (229,)
2024-01-30 12:52:48:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 12:52:49:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706590369 HTTP/1.1" 200 191
2024-01-30 12:52:49:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-30 12:52:49:INFO:test samples: (686,)
2024-01-30 12:52:49:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 12:52:50:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706590370 HTTP/1.1" 200 191
2024-01-30 12:52:50:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-30 12:52:58:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 12:52:59:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706590379 HTTP/1.1" 200 191
2024-01-30 12:52:59:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-30 12:53:01:INFO:trainable params: 2590732 || all params: 6063626252 || trainable%: 0.04272578639136085
2024-01-30 12:53:01:INFO:Init labels...
2024-01-30 12:53:01:INFO:Start training...
2024-01-30 12:53:47:INFO:TRAIN-(cmcm) (1/1/4)>> loss: 7.1337
2024-01-30 12:53:56:INFO:VAL-(cmcm) >>
2024-01-30 12:53:56:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4306  Non0_F1_score: 0.2645  Mult_acc_5: 0.2140  Mult_acc_7: 0.2140  MAE: 1.4781  Corr: 0.0197 
2024-01-30 12:54:01:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-01-30 12:54:50:INFO:TRAIN-(cmcm) (1/2/4)>> loss: 5.0196
2024-01-30 12:54:57:INFO:VAL-(cmcm) >>
2024-01-30 12:54:57:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4352  Non0_F1_score: 0.3332  Mult_acc_5: 0.2227  Mult_acc_7: 0.2096  MAE: 389.5582  Corr: -0.0268 
2024-01-30 12:55:45:INFO:TRAIN-(cmcm) (2/3/4)>> loss: 2.2067
2024-01-30 12:55:53:INFO:VAL-(cmcm) >>
2024-01-30 12:55:53:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4458  Non0_acc_2: 0.4769  Non0_F1_score: 0.4772  Mult_acc_5: 0.2489  Mult_acc_7: 0.1921  MAE: 2554.2896  Corr: 0.0274 
2024-01-30 12:56:41:INFO:TRAIN-(cmcm) (3/4/4)>> loss: 1.8139
2024-01-30 12:56:49:INFO:VAL-(cmcm) >>
2024-01-30 12:56:49:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.4438  Non0_acc_2: 0.5000  Non0_F1_score: 0.5012  Mult_acc_5: 0.2489  Mult_acc_7: 0.1965  MAE: 619.8081  Corr: 0.0006 
2024-01-30 12:57:36:INFO:TRAIN-(cmcm) (4/5/4)>> loss: 1.7739
2024-01-30 12:57:44:INFO:VAL-(cmcm) >>
2024-01-30 12:57:44:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4491  Non0_F1_score: 0.3997  Mult_acc_5: 0.2402  Mult_acc_7: 0.2227  MAE: 372.2003  Corr: -0.1279 
2024-01-30 12:58:32:INFO:TRAIN-(cmcm) (5/6/4)>> loss: 1.7343
2024-01-30 12:58:39:INFO:VAL-(cmcm) >>
2024-01-30 12:58:39:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5185  Non0_F1_score: 0.5178  Mult_acc_5: 0.2795  Mult_acc_7: 0.2183  MAE: 293.7071  Corr: -0.0351 
2024-01-30 12:59:28:INFO:TRAIN-(cmcm) (6/7/4)>> loss: 1.6981
2024-01-30 12:59:35:INFO:VAL-(cmcm) >>
2024-01-30 12:59:35:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4352  Non0_F1_score: 0.3276  Mult_acc_5: 0.2183  Mult_acc_7: 0.2140  MAE: 98.5011  Corr: -0.1008 
2024-01-30 13:00:21:INFO:TRAIN-(cmcm) (7/8/4)>> loss: 1.6884
2024-01-30 13:00:30:INFO:VAL-(cmcm) >>
2024-01-30 13:00:30:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4213  Non0_F1_score: 0.3196  Mult_acc_5: 0.2183  Mult_acc_7: 0.2140  MAE: 1.4822  Corr: -0.0260 
2024-01-30 13:01:14:INFO:TRAIN-(cmcm) (8/9/4)>> loss: 1.6548
2024-01-30 13:01:22:INFO:VAL-(cmcm) >>
2024-01-30 13:01:22:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4306  Non0_F1_score: 0.2645  Mult_acc_5: 0.2183  Mult_acc_7: 0.2140  MAE: 1.4283  Corr: 0.1000 
2024-01-30 13:01:28:INFO:Saving checkpoint at epoch 9 to results/models/cmcm-mosi-regression.pth.
2024-01-30 13:02:17:INFO:TRAIN-(cmcm) (1/10/4)>> loss: 1.6047
2024-01-30 13:02:25:INFO:VAL-(cmcm) >>
2024-01-30 13:02:25:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4259  Non0_F1_score: 0.2624  Mult_acc_5: 0.2140  Mult_acc_7: 0.2140  MAE: 1.4517  Corr: -0.0346 
2024-01-30 13:03:12:INFO:TRAIN-(cmcm) (2/11/4)>> loss: 1.5908
2024-01-30 13:03:20:INFO:VAL-(cmcm) >>
2024-01-30 13:03:20:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4398  Non0_F1_score: 0.2914  Mult_acc_5: 0.2183  Mult_acc_7: 0.2096  MAE: 89.0763  Corr: 0.0840 
2024-01-30 13:04:08:INFO:TRAIN-(cmcm) (3/12/4)>> loss: 1.5863
2024-01-30 13:04:16:INFO:VAL-(cmcm) >>
2024-01-30 13:04:16:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4259  Non0_F1_score: 0.2701  Mult_acc_5: 0.2183  Mult_acc_7: 0.2183  MAE: 1.4507  Corr: -0.0290 
2024-01-30 13:05:04:INFO:TRAIN-(cmcm) (4/13/4)>> loss: 1.5524
2024-01-30 13:05:12:INFO:VAL-(cmcm) >>
2024-01-30 13:05:12:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4398  Non0_F1_score: 0.2841  Mult_acc_5: 0.2183  Mult_acc_7: 0.2183  MAE: 1.4343  Corr: 0.0855 
2024-01-30 13:05:59:INFO:TRAIN-(cmcm) (5/14/4)>> loss: 1.5576
2024-01-30 13:06:07:INFO:VAL-(cmcm) >>
2024-01-30 13:06:07:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4259  Non0_F1_score: 0.2544  Mult_acc_5: 0.2140  Mult_acc_7: 0.2140  MAE: 1.4370  Corr: nan 
2024-01-30 13:06:54:INFO:TRAIN-(cmcm) (6/15/4)>> loss: 1.5311
2024-01-30 13:07:02:INFO:VAL-(cmcm) >>
2024-01-30 13:07:02:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4306  Non0_F1_score: 0.2645  Mult_acc_5: 0.2140  Mult_acc_7: 0.2096  MAE: 89.2963  Corr: 0.0839 
2024-01-30 13:07:49:INFO:TRAIN-(cmcm) (7/16/4)>> loss: 1.5263
2024-01-30 13:07:57:INFO:VAL-(cmcm) >>
2024-01-30 13:07:57:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4259  Non0_F1_score: 0.2544  Mult_acc_5: 0.2140  Mult_acc_7: 0.2140  MAE: 1.4370  Corr: nan 
2024-01-30 13:08:43:INFO:TRAIN-(cmcm) (8/17/4)>> loss: 1.5264
2024-01-30 13:08:51:INFO:VAL-(cmcm) >>
2024-01-30 13:08:51:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4306  Non0_F1_score: 0.2645  Mult_acc_5: 0.2183  Mult_acc_7: 0.2183  MAE: 1.4327  Corr: 0.0277 
2024-01-30 13:09:39:INFO:TRAIN-(cmcm) (9/18/4)>> loss: 1.5079
2024-01-30 13:09:47:INFO:VAL-(cmcm) >>
2024-01-30 13:09:47:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4259  Non0_F1_score: 0.2544  Mult_acc_5: 0.2140  Mult_acc_7: 0.2140  MAE: 1.4370  Corr: nan 
2024-01-30 13:10:35:INFO:TRAIN-(cmcm) (10/19/4)>> loss: 1.4943
2024-01-30 13:10:43:INFO:VAL-(cmcm) >>
2024-01-30 13:10:43:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.4417  Non0_acc_2: 0.4398  Non0_F1_score: 0.2914  Mult_acc_5: 0.2052  Mult_acc_7: 0.2052  MAE: 1.4610  Corr: -0.0152 
2024-01-30 13:11:06:INFO:TEST-(cmcm) >>
2024-01-30 13:11:06:INFO:M: >>  Has0_acc_2: 0.4490  Has0_F1_score: 0.2874  Non0_acc_2: 0.5762  Non0_F1_score: 0.4278  Mult_acc_5: 0.1574  Mult_acc_7: 0.1574  MAE: 1.4242  Corr: 0.0320 
2024-01-30 13:11:06:INFO:Results are added to results/results/mosi-regression-30.csv...
2024-01-30 13:11:06:INFO:Start running cmcm...
2024-01-30 13:11:06:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [2], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (4096, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': '01ai/Yi-6B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3, 3]. response: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 't_lstm_hidden_size': 128, 't_mlp_hidden_size': 256, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 't_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 't_lstm_dropout': 0.0, 'a_encoder_heads': 5, 'v_encoder_heads': 4, 'a_encoder_layers': 6, 'v_encoder_layers': 6, 'post_fusion_dim': 128, 'post_text_dim': 64, 'post_audio_dim': 64, 'post_video_dim': 64, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 5555}>
2024-01-30 13:11:06:INFO:Let's use the GPU 1 !
2024-01-30 13:11:07:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 13:11:07:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706591467 HTTP/1.1" 200 191
2024-01-30 13:11:07:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-30 13:11:08:INFO:train samples: (1284,)
2024-01-30 13:11:08:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 13:11:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706591468 HTTP/1.1" 200 191
2024-01-30 13:11:09:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-30 13:11:09:INFO:valid samples: (229,)
2024-01-30 13:11:09:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 13:11:09:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706591469 HTTP/1.1" 200 191
2024-01-30 13:11:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-30 13:11:10:INFO:test samples: (686,)
2024-01-30 13:11:10:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 13:11:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706591470 HTTP/1.1" 200 191
2024-01-30 13:11:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-30 13:11:19:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 13:11:19:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706591479 HTTP/1.1" 200 191
2024-01-30 13:11:20:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-30 13:11:22:INFO:trainable params: 2590732 || all params: 6063626252 || trainable%: 0.04272578639136085
2024-01-30 13:11:22:INFO:Init labels...
2024-01-30 13:11:22:INFO:Start training...
2024-01-30 13:12:10:INFO:TRAIN-(cmcm) (1/1/5)>> loss: 7.1797
2024-01-30 13:12:18:INFO:VAL-(cmcm) >>
2024-01-30 13:12:18:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4259  Non0_F1_score: 0.2544  Mult_acc_5: 0.2140  Mult_acc_7: 0.2140  MAE: 1.4370  Corr: nan 
2024-01-30 13:12:23:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-01-30 13:13:11:INFO:TRAIN-(cmcm) (1/2/5)>> loss: 5.9881
2024-01-30 13:13:19:INFO:VAL-(cmcm) >>
2024-01-30 13:13:19:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4742  Non0_acc_2: 0.4444  Non0_F1_score: 0.4118  Mult_acc_5: 0.2489  Mult_acc_7: 0.1921  MAE: 1453.3491  Corr: 0.0549 
2024-01-30 13:14:06:INFO:TRAIN-(cmcm) (2/3/5)>> loss: 2.4098
2024-01-30 13:14:14:INFO:VAL-(cmcm) >>
2024-01-30 13:14:14:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4556  Non0_acc_2: 0.4444  Non0_F1_score: 0.3775  Mult_acc_5: 0.2402  Mult_acc_7: 0.2052  MAE: 1046.2030  Corr: -0.0161 
2024-01-30 13:15:02:INFO:TRAIN-(cmcm) (3/4/5)>> loss: 1.8444
2024-01-30 13:15:10:INFO:VAL-(cmcm) >>
2024-01-30 13:15:10:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4577  Non0_acc_2: 0.4444  Non0_F1_score: 0.3208  Mult_acc_5: 0.2227  Mult_acc_7: 0.2227  MAE: 11.0720  Corr: 0.0010 
2024-01-30 13:15:59:INFO:TRAIN-(cmcm) (4/5/5)>> loss: 1.7677
2024-01-30 13:16:06:INFO:VAL-(cmcm) >>
2024-01-30 13:16:06:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4306  Non0_F1_score: 0.2797  Mult_acc_5: 0.2140  Mult_acc_7: 0.2140  MAE: 1.4397  Corr: 0.0316 
2024-01-30 13:16:55:INFO:TRAIN-(cmcm) (5/6/5)>> loss: 1.7411
2024-01-30 13:17:03:INFO:VAL-(cmcm) >>
2024-01-30 13:17:03:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4352  Non0_F1_score: 0.2819  Mult_acc_5: 0.2227  Mult_acc_7: 0.2227  MAE: 1.4301  Corr: 0.0559 
2024-01-30 13:17:08:INFO:Saving checkpoint at epoch 6 to results/models/cmcm-mosi-regression.pth.
2024-01-30 13:17:57:INFO:TRAIN-(cmcm) (1/7/5)>> loss: 1.7207
2024-01-30 13:18:05:INFO:VAL-(cmcm) >>
2024-01-30 13:18:05:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4444  Non0_F1_score: 0.3144  Mult_acc_5: 0.2183  Mult_acc_7: 0.2140  MAE: 88.7711  Corr: 0.0599 
2024-01-30 13:18:52:INFO:TRAIN-(cmcm) (2/8/5)>> loss: 1.7001
2024-01-30 13:19:00:INFO:VAL-(cmcm) >>
2024-01-30 13:19:00:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4491  Non0_F1_score: 0.3295  Mult_acc_5: 0.2227  Mult_acc_7: 0.2227  MAE: 195.5122  Corr: -0.0461 
2024-01-30 13:19:48:INFO:TRAIN-(cmcm) (3/9/5)>> loss: 1.6833
2024-01-30 13:19:55:INFO:VAL-(cmcm) >>
2024-01-30 13:19:55:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4630  Non0_F1_score: 0.4622  Mult_acc_5: 0.2314  Mult_acc_7: 0.1747  MAE: 3286.7112  Corr: -0.0281 
2024-01-30 13:20:42:INFO:TRAIN-(cmcm) (4/10/5)>> loss: 1.6725
2024-01-30 13:20:50:INFO:VAL-(cmcm) >>
2024-01-30 13:20:50:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4630  Non0_F1_score: 0.3854  Mult_acc_5: 0.2227  Mult_acc_7: 0.2096  MAE: 1376.8737  Corr: 0.0137 
2024-01-30 13:21:37:INFO:TRAIN-(cmcm) (5/11/5)>> loss: 1.6519
2024-01-30 13:21:45:INFO:VAL-(cmcm) >>
2024-01-30 13:21:45:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4907  Non0_F1_score: 0.4608  Mult_acc_5: 0.2271  Mult_acc_7: 0.1790  MAE: 3382.9260  Corr: -0.0074 
2024-01-30 13:22:32:INFO:TRAIN-(cmcm) (6/12/5)>> loss: 1.6218
2024-01-30 13:22:40:INFO:VAL-(cmcm) >>
2024-01-30 13:22:40:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5093  Non0_F1_score: 0.5085  Mult_acc_5: 0.2576  Mult_acc_7: 0.1659  MAE: 7996.8022  Corr: 0.0393 
2024-01-30 13:23:27:INFO:TRAIN-(cmcm) (7/13/5)>> loss: 1.6120
2024-01-30 13:23:35:INFO:VAL-(cmcm) >>
2024-01-30 13:23:35:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5093  Non0_F1_score: 0.4997  Mult_acc_5: 0.2576  Mult_acc_7: 0.1747  MAE: 6430.4463  Corr: 0.0849 
2024-01-30 13:24:22:INFO:TRAIN-(cmcm) (8/14/5)>> loss: 1.5870
2024-01-30 13:24:29:INFO:VAL-(cmcm) >>
2024-01-30 13:24:29:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4907  Non0_F1_score: 0.4932  Mult_acc_5: 0.2402  Mult_acc_7: 0.1310  MAE: 9828.2402  Corr: -0.0627 
2024-01-30 13:25:17:INFO:TRAIN-(cmcm) (9/15/5)>> loss: 1.5783
2024-01-30 13:25:25:INFO:VAL-(cmcm) >>
2024-01-30 13:25:25:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5370  Non0_F1_score: 0.5370  Mult_acc_5: 0.2664  Mult_acc_7: 0.1616  MAE: 7859.8638  Corr: 0.0932 
2024-01-30 13:26:13:INFO:TRAIN-(cmcm) (10/16/5)>> loss: 1.5731
2024-01-30 13:26:20:INFO:VAL-(cmcm) >>
2024-01-30 13:26:20:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4954  Non0_F1_score: 0.4832  Mult_acc_5: 0.2533  Mult_acc_7: 0.1747  MAE: 5842.8677  Corr: 0.0156 
2024-01-30 13:26:44:INFO:TEST-(cmcm) >>
2024-01-30 13:26:44:INFO:M: >>  Has0_acc_2: 0.4475  Has0_F1_score: 0.2767  Non0_acc_2: 0.5701  Non0_F1_score: 0.4374  Mult_acc_5: 0.1560  Mult_acc_7: 0.1545  MAE: 66.3030  Corr: 0.0105 
2024-01-30 13:26:44:INFO:Results are added to results/results/mosi-regression-30.csv...
2024-01-30 13:26:44:INFO:Start running cmcm...
2024-01-30 13:26:44:INFO:<Storage{'is_tune': False, 'train_mode': 'classification', 'modelName': 'cmcm', 'datasetName': 'cherma', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [2], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/CHERMA0723', 'seq_lens': (78, 543, 16), 'feature_dims': (4096, 1024, 2048), 'train_samples': 16326, 'num_classes': 3, 'language': 'cn', 'KeyEval': 'weight_F1', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'shakechen/Llama-2-7b-hf', 'task_specific_prompt': '<:0, :1, :2, :3, :4, :5, :6>: ', 'max_new_tokens': 2, 'pseudo_tokens': 4, 'label_index_mapping': {'': 0, '': 1, '': 2, '': 3, '': 4, '': 5, '': 6}, 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 16, 't_lstm_hidden_size': 256, 't_mlp_hidden_size': 256, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 't_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 't_bert_dropout': 0.1, 'a_encoder_heads': 3, 'v_encoder_heads': 1, 'a_encoder_layers': 2, 'v_encoder_layers': 2, 'post_fusion_dim': 128, 'post_text_dim': 48, 'post_audio_dim': 48, 'post_video_dim': 48, 'post_fusion_dropout': 0.1, 'post_text_dropout': 0.1, 'post_audio_dropout': 0.0, 'post_video_dropout': 0.0, 'warm_up_epochs': 30, 'update_epochs': 1, 'early_stop': 8, 'gamma': 0, 'H': 1.0, 'seed': 1111}>
2024-01-30 13:26:44:INFO:Let's use the GPU 1 !
2024-01-30 13:29:28:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-30 13:29:28:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/shakechen/Llama-2-7b-hf/revisions?EndTime=1706592568 HTTP/1.1" 200 191
2024-01-30 13:29:28:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/shakechen/Llama-2-7b-hf/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 14:58:35:INFO:Start running cmcm...
2024-01-31 14:58:35:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (4096, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': '01ai/Yi-6B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3, 3]. response: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 't_lstm_hidden_size': 128, 't_mlp_hidden_size': 256, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 't_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 't_lstm_dropout': 0.0, 'a_encoder_heads': 5, 'v_encoder_heads': 4, 'a_encoder_layers': 6, 'v_encoder_layers': 6, 'post_fusion_dim': 128, 'post_text_dim': 64, 'post_audio_dim': 64, 'post_video_dim': 64, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-01-31 14:58:35:INFO:Find gpu: 2, with memory: 381026304 left!
2024-01-31 14:58:35:INFO:Let's use the GPU 1 !
2024-01-31 14:58:35:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 14:58:36:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706684316 HTTP/1.1" 200 191
2024-01-31 14:58:36:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 14:58:36:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 14:58:36:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo?Revision=master&FilePath=README.md HTTP/1.1" 200 51439
2024-01-31 14:58:37:INFO:train samples: (1284,)
2024-01-31 14:58:37:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 14:58:37:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706684318 HTTP/1.1" 200 191
2024-01-31 14:58:38:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 14:58:38:INFO:valid samples: (229,)
2024-01-31 14:58:38:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 14:58:39:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706684319 HTTP/1.1" 200 191
2024-01-31 14:58:39:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 14:58:39:INFO:test samples: (686,)
2024-01-31 14:58:39:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 14:58:40:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706684320 HTTP/1.1" 200 191
2024-01-31 14:58:40:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 14:58:49:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 14:58:49:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706684329 HTTP/1.1" 200 191
2024-01-31 14:58:50:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 14:58:53:INFO:trainable params: 2590732 || all params: 6063626252 || trainable%: 0.04272578639136085
2024-01-31 14:58:54:INFO:Init labels...
2024-01-31 14:58:54:INFO:Start training...
2024-01-31 14:59:43:INFO:TRAIN-(cmcm) (1/1/1)>> loss: 7.2591
2024-01-31 15:17:31:INFO:Start running cmcm...
2024-01-31 15:17:31:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (4096, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': '01ai/Yi-6B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3, 3]. response: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 't_lstm_hidden_size': 128, 't_mlp_hidden_size': 256, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 't_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 't_lstm_dropout': 0.0, 'a_encoder_heads': 5, 'v_encoder_heads': 4, 'a_encoder_layers': 6, 'v_encoder_layers': 6, 'post_fusion_dim': 128, 'post_text_dim': 64, 'post_audio_dim': 64, 'post_video_dim': 64, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-01-31 15:17:31:INFO:Find gpu: 2, with memory: 381026304 left!
2024-01-31 15:17:31:INFO:Let's use the GPU 1 !
2024-01-31 15:17:31:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 15:17:31:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706685451 HTTP/1.1" 200 191
2024-01-31 15:17:32:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 15:17:32:INFO:train samples: (1284,)
2024-01-31 15:17:33:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 15:17:33:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706685453 HTTP/1.1" 200 191
2024-01-31 15:17:33:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 15:17:33:INFO:valid samples: (229,)
2024-01-31 15:17:34:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 15:17:34:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706685454 HTTP/1.1" 200 191
2024-01-31 15:17:34:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 15:17:34:INFO:test samples: (686,)
2024-01-31 15:17:34:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 15:17:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706685455 HTTP/1.1" 200 191
2024-01-31 15:17:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 15:17:43:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 15:17:43:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706685464 HTTP/1.1" 200 191
2024-01-31 15:17:44:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 15:17:46:INFO:trainable params: 2590732 || all params: 6063626252 || trainable%: 0.04272578639136085
2024-01-31 15:17:47:INFO:Init labels...
2024-01-31 15:17:47:INFO:Start training...
2024-01-31 15:18:36:INFO:TRAIN-(cmcm) (1/1/1)>> loss: 7.2591
2024-01-31 15:18:49:INFO:Start running cmcm...
2024-01-31 15:18:49:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (4096, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': '01ai/Yi-6B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3, 3]. response: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 't_lstm_hidden_size': 128, 't_mlp_hidden_size': 256, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 't_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 't_lstm_dropout': 0.0, 'a_encoder_heads': 5, 'v_encoder_heads': 4, 'a_encoder_layers': 6, 'v_encoder_layers': 6, 'post_fusion_dim': 128, 'post_text_dim': 64, 'post_audio_dim': 64, 'post_video_dim': 64, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-01-31 15:18:49:INFO:Find gpu: 2, with memory: 381026304 left!
2024-01-31 15:18:49:INFO:Let's use the GPU 1 !
2024-01-31 15:18:49:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 15:18:50:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706685530 HTTP/1.1" 200 191
2024-01-31 15:18:50:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 15:18:50:INFO:train samples: (1284,)
2024-01-31 15:18:51:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 15:18:51:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706685531 HTTP/1.1" 200 191
2024-01-31 15:18:51:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 15:18:51:INFO:valid samples: (229,)
2024-01-31 15:18:52:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 15:18:52:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706685532 HTTP/1.1" 200 191
2024-01-31 15:18:52:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 15:18:53:INFO:test samples: (686,)
2024-01-31 15:18:53:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 15:18:53:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706685533 HTTP/1.1" 200 191
2024-01-31 15:18:53:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 15:19:01:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 15:19:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706685542 HTTP/1.1" 200 191
2024-01-31 15:19:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 15:19:05:INFO:trainable params: 2590732 || all params: 6063626252 || trainable%: 0.04272578639136085
2024-01-31 15:19:06:INFO:Init labels...
2024-01-31 15:19:06:INFO:Start training...
2024-01-31 15:19:56:INFO:TRAIN-(cmcm) (1/1/1)>> loss: 7.2591
2024-01-31 15:26:30:INFO:Start running cmcm...
2024-01-31 15:26:30:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (4096, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': '01ai/Yi-6B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3, 3]. response: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 't_lstm_hidden_size': 128, 't_mlp_hidden_size': 256, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 't_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 't_lstm_dropout': 0.0, 'a_encoder_heads': 5, 'v_encoder_heads': 4, 'a_encoder_layers': 6, 'v_encoder_layers': 6, 'post_fusion_dim': 128, 'post_text_dim': 64, 'post_audio_dim': 64, 'post_video_dim': 64, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-01-31 15:26:30:INFO:Find gpu: 2, with memory: 381026304 left!
2024-01-31 15:26:30:INFO:Let's use the GPU 1 !
2024-01-31 15:26:30:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 15:26:30:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706685990 HTTP/1.1" 200 191
2024-01-31 15:26:30:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 15:26:31:INFO:train samples: (1284,)
2024-01-31 15:26:31:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 15:26:31:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706685992 HTTP/1.1" 200 191
2024-01-31 15:26:32:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 15:26:32:INFO:valid samples: (229,)
2024-01-31 15:26:32:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 15:26:32:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706685993 HTTP/1.1" 200 191
2024-01-31 15:26:33:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 15:26:33:INFO:test samples: (686,)
2024-01-31 15:26:33:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 15:26:33:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706685994 HTTP/1.1" 200 191
2024-01-31 15:26:34:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 15:26:42:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 15:26:42:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706686002 HTTP/1.1" 200 191
2024-01-31 15:26:42:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 15:26:45:INFO:trainable params: 2590732 || all params: 6063626252 || trainable%: 0.04272578639136085
2024-01-31 15:26:45:INFO:Init labels...
2024-01-31 15:26:45:INFO:Start training...
2024-01-31 15:27:37:INFO:Start running cmcm...
2024-01-31 15:27:37:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (4096, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': '01ai/Yi-6B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3, 3]. response: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 't_lstm_hidden_size': 128, 't_mlp_hidden_size': 256, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 't_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 't_lstm_dropout': 0.0, 'a_encoder_heads': 5, 'v_encoder_heads': 4, 'a_encoder_layers': 6, 'v_encoder_layers': 6, 'post_fusion_dim': 128, 'post_text_dim': 64, 'post_audio_dim': 64, 'post_video_dim': 64, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-01-31 15:27:37:INFO:Find gpu: 2, with memory: 381026304 left!
2024-01-31 15:27:37:INFO:Let's use the GPU 1 !
2024-01-31 15:27:37:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 15:27:37:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706686058 HTTP/1.1" 200 191
2024-01-31 15:27:38:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 15:27:38:INFO:train samples: (1284,)
2024-01-31 15:27:39:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 15:27:39:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706686059 HTTP/1.1" 200 191
2024-01-31 15:27:39:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 15:27:40:INFO:valid samples: (229,)
2024-01-31 15:27:40:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 15:27:40:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706686060 HTTP/1.1" 200 191
2024-01-31 15:27:40:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 15:27:41:INFO:test samples: (686,)
2024-01-31 15:27:41:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 15:27:41:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706686061 HTTP/1.1" 200 191
2024-01-31 15:27:41:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 15:27:50:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 15:27:50:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706686070 HTTP/1.1" 200 191
2024-01-31 15:27:51:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 15:27:53:INFO:trainable params: 2590732 || all params: 6063626252 || trainable%: 0.04272578639136085
2024-01-31 15:27:54:INFO:Init labels...
2024-01-31 15:27:54:INFO:Start training...
2024-01-31 15:28:44:INFO:TRAIN-(cmcm) (1/1/1)>> loss: 6.5244
2024-01-31 15:29:32:INFO:TRAIN-(cmcm) (2/2/1)>> loss: 4.0671
2024-01-31 15:30:20:INFO:TRAIN-(cmcm) (3/3/1)>> loss: 2.0153
2024-01-31 15:31:08:INFO:TRAIN-(cmcm) (4/4/1)>> loss: 1.8766
2024-01-31 15:31:55:INFO:TRAIN-(cmcm) (5/5/1)>> loss: 1.8409
2024-01-31 15:33:04:INFO:Start running cmcm...
2024-01-31 15:33:04:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (4096, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': '01ai/Yi-6B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3, 3]. response: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 't_lstm_hidden_size': 128, 't_mlp_hidden_size': 256, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 't_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 't_lstm_dropout': 0.0, 'a_encoder_heads': 5, 'v_encoder_heads': 4, 'a_encoder_layers': 6, 'v_encoder_layers': 6, 'post_fusion_dim': 128, 'post_text_dim': 64, 'post_audio_dim': 64, 'post_video_dim': 64, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-01-31 15:33:04:INFO:Find gpu: 2, with memory: 381026304 left!
2024-01-31 15:33:04:INFO:Let's use the GPU 1 !
2024-01-31 15:33:05:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 15:33:05:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706686385 HTTP/1.1" 200 191
2024-01-31 15:33:05:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 15:33:06:INFO:train samples: (1284,)
2024-01-31 15:33:06:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 15:33:06:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706686387 HTTP/1.1" 200 191
2024-01-31 15:33:07:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 15:33:07:INFO:valid samples: (229,)
2024-01-31 15:33:07:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 15:33:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706686388 HTTP/1.1" 200 191
2024-01-31 15:33:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 15:33:08:INFO:test samples: (686,)
2024-01-31 15:33:08:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 15:33:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706686389 HTTP/1.1" 200 191
2024-01-31 15:33:09:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 15:33:17:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 15:33:17:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706686397 HTTP/1.1" 200 191
2024-01-31 15:33:17:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 15:33:20:INFO:trainable params: 2590732 || all params: 6063626252 || trainable%: 0.04272578639136085
2024-01-31 15:33:21:INFO:Init labels...
2024-01-31 15:33:21:INFO:Start training...
2024-01-31 15:34:10:INFO:TRAIN-(cmcm) (1/1/1)>> loss: 6.5244
2024-01-31 15:34:59:INFO:TRAIN-(cmcm) (2/2/1)>> loss: 4.0671
2024-01-31 15:35:48:INFO:TRAIN-(cmcm) (3/3/1)>> loss: 2.0153
2024-01-31 15:36:36:INFO:TRAIN-(cmcm) (4/4/1)>> loss: 1.8766
2024-01-31 15:37:25:INFO:TRAIN-(cmcm) (5/5/1)>> loss: 1.8409
2024-01-31 15:38:14:INFO:TRAIN-(cmcm) (6/6/1)>> loss: 1.8414
2024-01-31 15:39:02:INFO:TRAIN-(cmcm) (7/7/1)>> loss: 1.7950
2024-01-31 15:39:51:INFO:TRAIN-(cmcm) (8/8/1)>> loss: 1.7666
2024-01-31 15:40:40:INFO:TRAIN-(cmcm) (9/9/1)>> loss: 1.7755
2024-01-31 15:41:28:INFO:TRAIN-(cmcm) (10/10/1)>> loss: 1.7730
2024-01-31 15:42:29:INFO:Start running cmcm...
2024-01-31 15:42:29:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (4096, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': '01ai/Yi-6B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3, 3]. response: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 8, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 't_lstm_hidden_size': 128, 't_mlp_hidden_size': 256, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 't_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 't_lstm_dropout': 0.0, 'a_encoder_heads': 5, 'v_encoder_heads': 4, 'a_encoder_layers': 6, 'v_encoder_layers': 6, 'post_fusion_dim': 128, 'post_text_dim': 64, 'post_audio_dim': 64, 'post_video_dim': 64, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-01-31 15:42:29:INFO:Find gpu: 2, with memory: 381026304 left!
2024-01-31 15:42:29:INFO:Let's use the GPU 1 !
2024-01-31 15:42:29:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 15:42:29:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706686949 HTTP/1.1" 200 191
2024-01-31 15:42:30:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 15:42:30:INFO:train samples: (1284,)
2024-01-31 15:42:31:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 15:42:31:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706686951 HTTP/1.1" 200 191
2024-01-31 15:42:31:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 15:42:31:INFO:valid samples: (229,)
2024-01-31 15:42:32:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 15:42:32:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706686952 HTTP/1.1" 200 191
2024-01-31 15:42:32:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 15:42:33:INFO:test samples: (686,)
2024-01-31 15:42:33:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 15:42:33:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706686953 HTTP/1.1" 200 191
2024-01-31 15:42:34:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 15:42:42:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 15:42:42:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706686962 HTTP/1.1" 200 191
2024-01-31 15:42:42:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 15:42:45:INFO:trainable params: 2590732 || all params: 6063626252 || trainable%: 0.04272578639136085
2024-01-31 15:42:46:INFO:Init labels...
2024-01-31 15:42:46:INFO:Start training...
2024-01-31 15:43:36:INFO:TRAIN-(cmcm) (1/1/1)>> loss: 4.8711
2024-01-31 15:44:25:INFO:TRAIN-(cmcm) (2/2/1)>> loss: 2.0327
2024-01-31 15:45:15:INFO:TRAIN-(cmcm) (3/3/1)>> loss: 1.8815
2024-01-31 15:46:02:INFO:TRAIN-(cmcm) (4/4/1)>> loss: 1.7692
2024-01-31 15:46:51:INFO:TRAIN-(cmcm) (5/5/1)>> loss: 1.6384
2024-01-31 15:47:40:INFO:TRAIN-(cmcm) (6/6/1)>> loss: 1.6689
2024-01-31 15:48:29:INFO:TRAIN-(cmcm) (7/7/1)>> loss: 1.6335
2024-01-31 15:49:17:INFO:TRAIN-(cmcm) (8/8/1)>> loss: 1.5724
2024-01-31 15:50:06:INFO:TRAIN-(cmcm) (9/9/1)>> loss: 1.5808
2024-01-31 15:50:55:INFO:TRAIN-(cmcm) (10/10/1)>> loss: 1.5855
2024-01-31 15:54:13:INFO:Start running cmcm...
2024-01-31 15:54:13:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (4096, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': '01ai/Yi-6B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3, 3]. response: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 8, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 't_lstm_hidden_size': 128, 't_mlp_hidden_size': 256, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 't_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 't_lstm_dropout': 0.0, 'a_encoder_heads': 5, 'v_encoder_heads': 4, 'a_encoder_layers': 6, 'v_encoder_layers': 6, 'post_fusion_dim': 128, 'post_text_dim': 64, 'post_audio_dim': 64, 'post_video_dim': 64, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-01-31 15:54:13:INFO:Find gpu: 2, with memory: 381026304 left!
2024-01-31 15:54:13:INFO:Let's use the GPU 1 !
2024-01-31 15:54:13:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 15:54:13:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706687653 HTTP/1.1" 200 191
2024-01-31 15:54:14:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 15:54:14:INFO:train samples: (1284,)
2024-01-31 15:54:14:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 15:54:15:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706687655 HTTP/1.1" 200 191
2024-01-31 15:54:15:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 15:54:15:INFO:valid samples: (229,)
2024-01-31 15:54:16:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 15:54:16:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706687656 HTTP/1.1" 200 191
2024-01-31 15:54:16:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 15:54:17:INFO:test samples: (686,)
2024-01-31 15:54:17:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 15:54:17:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706687657 HTTP/1.1" 200 191
2024-01-31 15:54:17:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 15:54:25:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 15:54:26:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706687666 HTTP/1.1" 200 191
2024-01-31 15:54:26:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 15:54:28:INFO:trainable params: 2590732 || all params: 6063626252 || trainable%: 0.04272578639136085
2024-01-31 15:54:29:INFO:Init labels...
2024-01-31 15:54:29:INFO:Start training...
2024-01-31 15:55:18:INFO:TRAIN-(cmcm) (1/1/1)>> loss: 3.3551
2024-01-31 15:56:06:INFO:TRAIN-(cmcm) (2/2/1)>> loss: 1.7336
2024-01-31 15:56:54:INFO:TRAIN-(cmcm) (3/3/1)>> loss: 1.6538
2024-01-31 15:57:43:INFO:TRAIN-(cmcm) (4/4/1)>> loss: 1.5992
2024-01-31 15:58:32:INFO:TRAIN-(cmcm) (5/5/1)>> loss: 1.5425
2024-01-31 15:59:22:INFO:TRAIN-(cmcm) (6/6/1)>> loss: 1.5589
2024-01-31 16:00:10:INFO:TRAIN-(cmcm) (7/7/1)>> loss: 1.5363
2024-01-31 16:00:58:INFO:TRAIN-(cmcm) (8/8/1)>> loss: 1.4970
2024-01-31 16:01:47:INFO:TRAIN-(cmcm) (9/9/1)>> loss: 1.5036
2024-01-31 16:02:36:INFO:TRAIN-(cmcm) (10/10/1)>> loss: 1.5072
2024-01-31 16:04:43:INFO:Start running cmcm...
2024-01-31 16:04:43:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'simsv2', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/SIMS_V2/ch-simsv2s.pkl', 'seq_lens': (50, 925, 232), 'feature_dims': (4096, 25, 177), 'train_samples': 2722, 'num_classes': 3, 'language': 'cn', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': '01ai/Yi-6B', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'task_specific_prompt': '[-1, 1]: ', 'batch_size': 8, 'learning_rate': 0.005, 'a_lstm_hidden_size': 16, 'v_lstm_hidden_size': 32, 't_lstm_hidden_size': 128, 't_mlp_hidden_size': 256, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 't_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 't_lstm_dropout': 0.0, 'a_encoder_heads': 5, 'v_encoder_heads': 3, 'a_encoder_layers': 2, 'v_encoder_layers': 2, 'post_fusion_dim': 128, 'post_text_dim': 128, 'post_audio_dim': 128, 'post_video_dim': 128, 'warm_up_epochs': 30, 'update_epochs': 1, 'early_stop': 10, 'gamma': 1, 'H': 1.0, 'seed': 1111}>
2024-01-31 16:04:43:INFO:Find gpu: 2, with memory: 381026304 left!
2024-01-31 16:04:43:INFO:Let's use the GPU 1 !
2024-01-31 16:04:44:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 16:04:45:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706688285 HTTP/1.1" 200 191
2024-01-31 16:04:45:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 16:04:46:INFO:train samples: (2722,)
2024-01-31 16:04:48:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 16:04:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706688288 HTTP/1.1" 200 191
2024-01-31 16:04:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 16:04:49:INFO:valid samples: (647,)
2024-01-31 16:04:50:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 16:04:50:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706688291 HTTP/1.1" 200 191
2024-01-31 16:04:51:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 16:04:51:INFO:test samples: (1034,)
2024-01-31 16:04:52:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 16:04:52:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706688292 HTTP/1.1" 200 191
2024-01-31 16:04:52:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 16:05:01:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 16:05:01:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706688301 HTTP/1.1" 200 191
2024-01-31 16:05:01:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 16:05:04:INFO:trainable params: 2604492 || all params: 6063640012 || trainable%: 0.042952615835466584
2024-01-31 16:05:05:INFO:Init labels...
2024-01-31 16:05:05:INFO:Start training...
2024-01-31 16:06:59:INFO:TRAIN-(cmcm) (1/1/1)>> loss: 2.1191
2024-01-31 16:08:52:INFO:TRAIN-(cmcm) (2/2/1)>> loss: 1.4095
2024-01-31 16:10:43:INFO:TRAIN-(cmcm) (3/3/1)>> loss: 1.3665
2024-01-31 16:12:29:INFO:TRAIN-(cmcm) (4/4/1)>> loss: 1.3322
2024-01-31 16:14:23:INFO:TRAIN-(cmcm) (5/5/1)>> loss: 1.3030
2024-01-31 16:16:17:INFO:TRAIN-(cmcm) (6/6/1)>> loss: 1.2680
2024-01-31 16:18:11:INFO:TRAIN-(cmcm) (7/7/1)>> loss: 1.2145
2024-01-31 16:19:59:INFO:TRAIN-(cmcm) (8/8/1)>> loss: 1.1828
2024-01-31 16:21:51:INFO:TRAIN-(cmcm) (9/9/1)>> loss: 1.1520
2024-01-31 16:23:45:INFO:TRAIN-(cmcm) (10/10/1)>> loss: 1.0986
2024-01-31 16:26:41:INFO:Start running cmcm...
2024-01-31 16:26:41:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (4096, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': '01ai/Yi-6B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3, 3]. response: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 8, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 't_lstm_hidden_size': 128, 't_mlp_hidden_size': 256, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 't_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 't_lstm_dropout': 0.0, 'a_encoder_heads': 5, 'v_encoder_heads': 4, 'a_encoder_layers': 6, 'v_encoder_layers': 6, 'post_fusion_dim': 128, 'post_text_dim': 64, 'post_audio_dim': 64, 'post_video_dim': 64, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-01-31 16:26:41:INFO:Find gpu: 2, with memory: 381026304 left!
2024-01-31 16:26:41:INFO:Let's use the GPU 1 !
2024-01-31 16:26:42:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 16:26:42:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706689602 HTTP/1.1" 200 191
2024-01-31 16:26:42:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 16:26:43:INFO:train samples: (1284,)
2024-01-31 16:26:43:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 16:26:43:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706689603 HTTP/1.1" 200 191
2024-01-31 16:26:43:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 16:26:44:INFO:valid samples: (229,)
2024-01-31 16:26:44:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 16:26:44:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706689604 HTTP/1.1" 200 191
2024-01-31 16:26:45:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 16:26:45:INFO:test samples: (686,)
2024-01-31 16:26:45:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 16:26:45:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706689606 HTTP/1.1" 200 191
2024-01-31 16:26:46:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 16:26:54:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 16:26:54:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706689614 HTTP/1.1" 200 191
2024-01-31 16:26:55:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 16:26:59:INFO:trainable params: 2590732 || all params: 6063626252 || trainable%: 0.04272578639136085
2024-01-31 16:26:59:INFO:Init labels...
2024-01-31 16:26:59:INFO:Start training...
2024-01-31 16:27:50:INFO:TRAIN-(cmcm) (1/1/1)>> loss: 3.4578
2024-01-31 16:28:39:INFO:TRAIN-(cmcm) (2/2/1)>> loss: 1.9117
2024-01-31 16:29:29:INFO:TRAIN-(cmcm) (3/3/1)>> loss: 1.6784
2024-01-31 16:30:18:INFO:TRAIN-(cmcm) (4/4/1)>> loss: 1.6212
2024-01-31 16:31:09:INFO:TRAIN-(cmcm) (5/5/1)>> loss: 1.5590
2024-01-31 16:31:59:INFO:TRAIN-(cmcm) (6/6/1)>> loss: 1.6709
2024-01-31 16:32:50:INFO:TRAIN-(cmcm) (7/7/1)>> loss: 1.5399
2024-01-31 16:33:39:INFO:TRAIN-(cmcm) (8/8/1)>> loss: 1.5102
2024-01-31 16:34:29:INFO:TRAIN-(cmcm) (9/9/1)>> loss: 1.5119
2024-01-31 16:35:19:INFO:TRAIN-(cmcm) (10/10/1)>> loss: 1.5132
2024-01-31 16:38:15:INFO:Start running cmcm...
2024-01-31 16:38:15:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (4096, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': '01ai/Yi-6B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3, 3]. response: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 8, 'learning_rate': 0.05, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 't_lstm_hidden_size': 128, 't_mlp_hidden_size': 256, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 't_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 't_lstm_dropout': 0.0, 'a_encoder_heads': 5, 'v_encoder_heads': 4, 'a_encoder_layers': 6, 'v_encoder_layers': 6, 'post_fusion_dim': 128, 'post_text_dim': 64, 'post_audio_dim': 64, 'post_video_dim': 64, 'warm_up_epochs': 10, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-01-31 16:38:15:INFO:Find gpu: 2, with memory: 381026304 left!
2024-01-31 16:38:15:INFO:Let's use the GPU 1 !
2024-01-31 16:38:16:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 16:38:16:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706690296 HTTP/1.1" 200 191
2024-01-31 16:38:16:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 16:38:17:INFO:train samples: (1284,)
2024-01-31 16:38:17:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 16:38:17:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706690298 HTTP/1.1" 200 191
2024-01-31 16:38:18:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 16:38:18:INFO:valid samples: (229,)
2024-01-31 16:38:18:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 16:38:18:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706690299 HTTP/1.1" 200 191
2024-01-31 16:38:19:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 16:38:19:INFO:test samples: (686,)
2024-01-31 16:38:19:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 16:38:19:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706690300 HTTP/1.1" 200 191
2024-01-31 16:38:20:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 16:38:27:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 16:38:28:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706690308 HTTP/1.1" 200 191
2024-01-31 16:38:28:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 16:38:36:INFO:trainable params: 2590732 || all params: 6063626252 || trainable%: 0.04272578639136085
2024-01-31 16:38:36:INFO:Init labels...
2024-01-31 16:38:36:INFO:Start training...
2024-01-31 16:39:23:INFO:TRAIN-(cmcm) (1/1/1)>> loss: 2.7706
2024-01-31 16:40:09:INFO:TRAIN-(cmcm) (2/2/1)>> loss: nan
2024-01-31 16:40:58:INFO:TRAIN-(cmcm) (3/3/1)>> loss: nan
2024-01-31 16:41:11:INFO:Start running cmcm...
2024-01-31 16:41:11:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (4096, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': '01ai/Yi-6B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3, 3]. response: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 8, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 't_lstm_hidden_size': 128, 't_mlp_hidden_size': 256, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 't_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 't_lstm_dropout': 0.0, 'a_encoder_heads': 5, 'v_encoder_heads': 4, 'a_encoder_layers': 6, 'v_encoder_layers': 6, 'post_fusion_dim': 128, 'post_text_dim': 64, 'post_audio_dim': 64, 'post_video_dim': 64, 'warm_up_epochs': 10, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-01-31 16:41:11:INFO:Find gpu: 2, with memory: 381026304 left!
2024-01-31 16:41:11:INFO:Let's use the GPU 1 !
2024-01-31 16:41:11:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 16:41:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706690472 HTTP/1.1" 200 191
2024-01-31 16:41:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 16:41:12:INFO:train samples: (1284,)
2024-01-31 16:41:13:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 16:41:13:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706690473 HTTP/1.1" 200 191
2024-01-31 16:41:13:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 16:41:13:INFO:valid samples: (229,)
2024-01-31 16:41:14:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 16:41:14:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706690474 HTTP/1.1" 200 191
2024-01-31 16:41:14:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 16:41:15:INFO:test samples: (686,)
2024-01-31 16:41:15:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 16:41:15:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706690475 HTTP/1.1" 200 191
2024-01-31 16:41:16:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 16:41:24:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 16:41:24:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706690484 HTTP/1.1" 200 191
2024-01-31 16:41:24:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 16:41:28:INFO:trainable params: 2590732 || all params: 6063626252 || trainable%: 0.04272578639136085
2024-01-31 16:41:28:INFO:Init labels...
2024-01-31 16:41:28:INFO:Start training...
2024-01-31 16:42:18:INFO:TRAIN-(cmcm) (1/1/1)>> loss: 3.0948
2024-01-31 16:43:10:INFO:TRAIN-(cmcm) (2/2/1)>> loss: 1.7219
2024-01-31 16:43:59:INFO:TRAIN-(cmcm) (3/3/1)>> loss: 1.6030
2024-01-31 16:44:47:INFO:TRAIN-(cmcm) (4/4/1)>> loss: 1.5830
2024-01-31 16:45:37:INFO:TRAIN-(cmcm) (5/5/1)>> loss: 1.5160
2024-01-31 16:46:27:INFO:TRAIN-(cmcm) (6/6/1)>> loss: 1.5290
2024-01-31 16:47:17:INFO:TRAIN-(cmcm) (7/7/1)>> loss: 1.4895
2024-01-31 16:48:06:INFO:TRAIN-(cmcm) (8/8/1)>> loss: 1.4541
2024-01-31 16:48:57:INFO:TRAIN-(cmcm) (9/9/1)>> loss: 1.4429
2024-01-31 16:49:47:INFO:TRAIN-(cmcm) (10/10/1)>> loss: 1.4292
2024-01-31 16:51:53:INFO:Start running cmcm...
2024-01-31 16:51:53:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (4096, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': '01ai/Yi-6B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3, 3]. response: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 8, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 't_lstm_hidden_size': 128, 't_mlp_hidden_size': 256, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 't_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 't_lstm_dropout': 0.0, 'a_encoder_heads': 5, 'v_encoder_heads': 4, 'a_encoder_layers': 6, 'v_encoder_layers': 6, 'post_fusion_dim': 128, 'post_text_dim': 64, 'post_audio_dim': 64, 'post_video_dim': 64, 'warm_up_epochs': 10, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-01-31 16:51:53:INFO:Find gpu: 2, with memory: 381026304 left!
2024-01-31 16:51:53:INFO:Let's use the GPU 1 !
2024-01-31 16:51:54:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 16:51:54:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706691114 HTTP/1.1" 200 191
2024-01-31 16:51:54:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 16:51:55:INFO:train samples: (1284,)
2024-01-31 16:51:55:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 16:51:55:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706691116 HTTP/1.1" 200 191
2024-01-31 16:51:56:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 16:51:56:INFO:valid samples: (229,)
2024-01-31 16:51:56:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 16:51:56:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706691117 HTTP/1.1" 200 191
2024-01-31 16:51:57:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 16:51:57:INFO:test samples: (686,)
2024-01-31 16:51:57:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 16:51:57:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706691118 HTTP/1.1" 200 191
2024-01-31 16:51:58:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 16:52:06:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 16:52:07:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706691127 HTTP/1.1" 200 191
2024-01-31 16:52:07:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 16:52:11:INFO:trainable params: 2590732 || all params: 6063626252 || trainable%: 0.04272578639136085
2024-01-31 16:52:11:INFO:Init labels...
2024-01-31 16:52:11:INFO:Start training...
2024-01-31 16:52:59:INFO:TRAIN-(cmcm) (1/1/1)>> loss: 3.0948
2024-01-31 16:54:38:INFO:Start running cmcm...
2024-01-31 16:54:38:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (4096, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': '01ai/Yi-6B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3, 3]. response: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 8, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 't_lstm_hidden_size': 128, 't_mlp_hidden_size': 256, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 't_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 't_lstm_dropout': 0.0, 'a_encoder_heads': 5, 'v_encoder_heads': 4, 'a_encoder_layers': 6, 'v_encoder_layers': 6, 'post_fusion_dim': 128, 'post_text_dim': 64, 'post_audio_dim': 64, 'post_video_dim': 64, 'warm_up_epochs': 10, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-01-31 16:54:38:INFO:Find gpu: 2, with memory: 381026304 left!
2024-01-31 16:54:38:INFO:Let's use the GPU 1 !
2024-01-31 16:54:38:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 16:54:39:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706691279 HTTP/1.1" 200 191
2024-01-31 16:54:39:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 16:54:39:INFO:train samples: (1284,)
2024-01-31 16:54:40:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 16:54:40:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706691280 HTTP/1.1" 200 191
2024-01-31 16:54:40:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 16:54:41:INFO:valid samples: (229,)
2024-01-31 16:54:41:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 16:54:41:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706691281 HTTP/1.1" 200 191
2024-01-31 16:54:42:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 16:54:42:INFO:test samples: (686,)
2024-01-31 16:54:42:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 16:54:42:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706691283 HTTP/1.1" 200 191
2024-01-31 16:54:43:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 16:54:52:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 16:54:52:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706691292 HTTP/1.1" 200 191
2024-01-31 16:54:53:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 16:54:57:INFO:trainable params: 2590732 || all params: 6063626252 || trainable%: 0.04272578639136085
2024-01-31 16:54:57:INFO:Init labels...
2024-01-31 16:54:57:INFO:Start training...
2024-01-31 16:55:45:INFO:TRAIN-(cmcm) (1/1/1)>> loss: 3.0948
2024-01-31 16:56:32:INFO:TRAIN-(cmcm) (2/2/1)>> loss: 1.7219
2024-01-31 16:57:18:INFO:TRAIN-(cmcm) (3/3/1)>> loss: 1.6030
2024-01-31 16:57:25:INFO:VAL-(cmcm) >>
2024-01-31 16:57:25:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4259  Non0_F1_score: 0.2544  Mult_acc_5: 0.2140  Mult_acc_7: 0.2140  MAE: 1.4370  Corr: nan 
2024-01-31 16:57:31:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-mosi-regression.pth.
2024-01-31 16:58:20:INFO:TRAIN-(cmcm) (1/4/1)>> loss: 1.5420
2024-01-31 16:58:27:INFO:VAL-(cmcm) >>
2024-01-31 16:58:27:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4259  Non0_F1_score: 0.2544  Mult_acc_5: 0.2140  Mult_acc_7: 0.2140  MAE: 1.4370  Corr: nan 
2024-01-31 16:59:15:INFO:TRAIN-(cmcm) (2/5/1)>> loss: 1.5567
2024-01-31 16:59:22:INFO:VAL-(cmcm) >>
2024-01-31 16:59:22:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4259  Non0_F1_score: 0.2544  Mult_acc_5: 0.2140  Mult_acc_7: 0.2140  MAE: 1.4370  Corr: nan 
2024-01-31 17:00:09:INFO:TRAIN-(cmcm) (3/6/1)>> loss: 1.5074
2024-01-31 17:00:16:INFO:VAL-(cmcm) >>
2024-01-31 17:00:16:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4213  Non0_F1_score: 0.2525  Mult_acc_5: 0.2096  Mult_acc_7: 0.2096  MAE: 1.4414  Corr: -0.0225 
2024-01-31 17:01:04:INFO:TRAIN-(cmcm) (4/7/1)>> loss: 1.4857
2024-01-31 17:01:11:INFO:VAL-(cmcm) >>
2024-01-31 17:01:11:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4259  Non0_F1_score: 0.2544  Mult_acc_5: 0.2140  Mult_acc_7: 0.2140  MAE: 1.4370  Corr: nan 
2024-01-31 17:01:58:INFO:TRAIN-(cmcm) (5/8/1)>> loss: 1.4601
2024-01-31 17:02:05:INFO:VAL-(cmcm) >>
2024-01-31 17:02:05:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4259  Non0_F1_score: 0.2701  Mult_acc_5: 0.2009  Mult_acc_7: 0.2009  MAE: 10.2475  Corr: -0.0124 
2024-01-31 17:02:51:INFO:TRAIN-(cmcm) (6/9/1)>> loss: 1.4406
2024-01-31 17:02:59:INFO:VAL-(cmcm) >>
2024-01-31 17:02:59:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4259  Non0_F1_score: 0.2624  Mult_acc_5: 0.2096  Mult_acc_7: 0.2096  MAE: 10.2423  Corr: -0.0124 
2024-01-31 17:03:46:INFO:TRAIN-(cmcm) (7/10/1)>> loss: 1.4229
2024-01-31 17:03:53:INFO:VAL-(cmcm) >>
2024-01-31 17:03:53:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4306  Non0_F1_score: 0.2722  Mult_acc_5: 0.2052  Mult_acc_7: 0.2052  MAE: 19.0423  Corr: -0.0233 
2024-01-31 17:04:41:INFO:TRAIN-(cmcm) (8/11/1)>> loss: 1.4196
2024-01-31 17:04:48:INFO:VAL-(cmcm) >>
2024-01-31 17:04:48:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4306  Non0_F1_score: 0.2722  Mult_acc_5: 0.2052  Mult_acc_7: 0.2052  MAE: 10.2432  Corr: -0.0124 
2024-01-31 17:05:33:INFO:TRAIN-(cmcm) (9/12/1)>> loss: 1.4263
2024-01-31 17:05:40:INFO:VAL-(cmcm) >>
2024-01-31 17:05:40:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4167  Non0_F1_score: 0.2505  Mult_acc_5: 0.2009  Mult_acc_7: 0.2009  MAE: 19.0484  Corr: -0.0233 
2024-01-31 17:06:26:INFO:TRAIN-(cmcm) (10/13/1)>> loss: 1.4565
2024-01-31 17:06:33:INFO:VAL-(cmcm) >>
2024-01-31 17:06:33:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4491  Non0_F1_score: 0.3031  Mult_acc_5: 0.2227  Mult_acc_7: 0.2140  MAE: 1.4449  Corr: 0.1111 
2024-01-31 17:06:54:INFO:TEST-(cmcm) >>
2024-01-31 17:06:54:INFO:M: >>  Has0_acc_2: 0.4475  Has0_F1_score: 0.2767  Non0_acc_2: 0.5808  Non0_F1_score: 0.4300  Mult_acc_5: 0.1560  Mult_acc_7: 0.1560  MAE: 1.4168  Corr: 0.0482 
2024-01-31 17:06:55:INFO:Results are added to results/results/mosi-regression-10.csv...
2024-01-31 17:06:55:INFO:Start running cmcm...
2024-01-31 17:06:55:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [2], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (4096, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': '01ai/Yi-6B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3, 3]. response: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 8, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 't_lstm_hidden_size': 128, 't_mlp_hidden_size': 256, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 't_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 't_lstm_dropout': 0.0, 'a_encoder_heads': 5, 'v_encoder_heads': 4, 'a_encoder_layers': 6, 'v_encoder_layers': 6, 'post_fusion_dim': 128, 'post_text_dim': 64, 'post_audio_dim': 64, 'post_video_dim': 64, 'warm_up_epochs': 10, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 2222}>
2024-01-31 17:06:55:INFO:Let's use the GPU 1 !
2024-01-31 17:06:55:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 17:06:56:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706692016 HTTP/1.1" 200 191
2024-01-31 17:06:56:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 17:06:56:INFO:train samples: (1284,)
2024-01-31 17:06:56:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 17:06:57:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706692017 HTTP/1.1" 200 191
2024-01-31 17:06:57:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 17:06:57:INFO:valid samples: (229,)
2024-01-31 17:06:57:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 17:06:58:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706692018 HTTP/1.1" 200 191
2024-01-31 17:06:58:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 17:06:58:INFO:test samples: (686,)
2024-01-31 17:06:58:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 17:07:27:INFO:Start running cmcm...
2024-01-31 17:07:27:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosei', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSEI/Processed/unaligned_50.pkl', 'seq_lens': (50, 500, 375), 'feature_dims': (4096, 74, 35), 'train_samples': 16326, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': '01ai/Yi-6B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3, 3]. response: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 64, 'v_lstm_hidden_size': 32, 't_lstm_hidden_size': 128, 't_mlp_hidden_size': 256, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 't_lstm_layers': 1, 'text_out': 768, 'audio_out': 74, 'video_out': 35, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 't_lstm_dropout': 0.0, 't_bert_dropout': 0.1, 'a_encoder_heads': 2, 'v_encoder_heads': 5, 'a_encoder_layers': 2, 'v_encoder_layers': 2, 'post_fusion_dim': 256, 'post_text_dim': 128, 'post_audio_dim': 128, 'post_video_dim': 128, 'warm_up_epochs': 10, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-01-31 17:07:27:INFO:Find gpu: 2, with memory: 381026304 left!
2024-01-31 17:07:27:INFO:Let's use the GPU 1 !
2024-01-31 17:07:42:INFO:Start running cmcm...
2024-01-31 17:07:42:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosei', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSEI/Processed/unaligned_50.pkl', 'seq_lens': (50, 500, 375), 'feature_dims': (4096, 74, 35), 'train_samples': 16326, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': '01ai/Yi-6B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3, 3]. response: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 8, 'learning_rate': 5e-05, 'a_lstm_hidden_size': 64, 'v_lstm_hidden_size': 32, 't_lstm_hidden_size': 128, 't_mlp_hidden_size': 256, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 't_lstm_layers': 1, 'text_out': 768, 'audio_out': 74, 'video_out': 35, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 't_lstm_dropout': 0.0, 't_bert_dropout': 0.1, 'a_encoder_heads': 2, 'v_encoder_heads': 5, 'a_encoder_layers': 2, 'v_encoder_layers': 2, 'post_fusion_dim': 256, 'post_text_dim': 128, 'post_audio_dim': 128, 'post_video_dim': 128, 'warm_up_epochs': 10, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-01-31 17:07:42:INFO:Find gpu: 2, with memory: 381026304 left!
2024-01-31 17:07:42:INFO:Let's use the GPU 1 !
2024-01-31 17:07:49:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 17:07:49:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706692069 HTTP/1.1" 200 191
2024-01-31 17:07:49:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 17:07:56:INFO:train samples: (16326,)
2024-01-31 17:08:03:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 17:08:03:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706692083 HTTP/1.1" 200 191
2024-01-31 17:08:04:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 17:08:04:INFO:valid samples: (1871,)
2024-01-31 17:08:11:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 17:08:11:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706692091 HTTP/1.1" 200 191
2024-01-31 17:08:11:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 17:08:13:INFO:test samples: (4659,)
2024-01-31 17:08:13:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 17:08:14:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706692094 HTTP/1.1" 200 191
2024-01-31 17:08:14:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 17:08:22:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 17:08:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706692103 HTTP/1.1" 200 191
2024-01-31 17:08:23:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 17:08:26:INFO:trainable params: 2631692 || all params: 6063667212 || trainable%: 0.04340099659149962
2024-01-31 17:08:26:INFO:Init labels...
2024-01-31 17:08:26:INFO:Start training...
2024-01-31 17:19:06:INFO:TRAIN-(cmcm) (1/1/1)>> loss: 2.7714
2024-01-31 17:21:01:INFO:Start running cmcm...
2024-01-31 17:21:01:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (4096, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': '01ai/Yi-6B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3, 3]. response: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 8, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 't_lstm_hidden_size': 128, 't_mlp_hidden_size': 256, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 't_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 't_lstm_dropout': 0.0, 'a_encoder_heads': 5, 'v_encoder_heads': 4, 'a_encoder_layers': 6, 'v_encoder_layers': 6, 'post_fusion_dim': 128, 'post_text_dim': 64, 'post_audio_dim': 64, 'post_video_dim': 64, 'warm_up_epochs': 10, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-01-31 17:21:01:INFO:Find gpu: 2, with memory: 381026304 left!
2024-01-31 17:21:01:INFO:Let's use the GPU 1 !
2024-01-31 17:21:01:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 17:21:01:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706692862 HTTP/1.1" 200 191
2024-01-31 17:21:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 17:21:02:INFO:train samples: (1284,)
2024-01-31 17:21:02:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 17:21:03:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706692863 HTTP/1.1" 200 191
2024-01-31 17:21:03:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 17:21:03:INFO:valid samples: (229,)
2024-01-31 17:21:04:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 17:21:04:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706692864 HTTP/1.1" 200 191
2024-01-31 17:21:04:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 17:21:05:INFO:test samples: (686,)
2024-01-31 17:21:05:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 17:21:05:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706692865 HTTP/1.1" 200 191
2024-01-31 17:21:05:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 17:21:13:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 17:21:14:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706692874 HTTP/1.1" 200 191
2024-01-31 17:21:14:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 17:21:18:INFO:trainable params: 2590732 || all params: 6063626252 || trainable%: 0.04272578639136085
2024-01-31 17:21:18:INFO:Init labels...
2024-01-31 17:21:18:INFO:Start training...
2024-01-31 17:29:00:INFO:Start running cmcm...
2024-01-31 17:29:00:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (4096, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': '01ai/Yi-6B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3, 3]. response: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 8, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 't_lstm_hidden_size': 128, 't_mlp_hidden_size': 256, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 't_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 't_lstm_dropout': 0.0, 'a_encoder_heads': 5, 'v_encoder_heads': 4, 'a_encoder_layers': 6, 'v_encoder_layers': 6, 'post_fusion_dim': 128, 'post_text_dim': 64, 'post_audio_dim': 64, 'post_video_dim': 64, 'warm_up_epochs': 10, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-01-31 17:29:00:INFO:Find gpu: 2, with memory: 381026304 left!
2024-01-31 17:29:00:INFO:Let's use the GPU 1 !
2024-01-31 17:29:00:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 17:29:00:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706693340 HTTP/1.1" 200 191
2024-01-31 17:29:00:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 17:29:01:INFO:train samples: (1284,)
2024-01-31 17:29:02:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 17:29:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706693342 HTTP/1.1" 200 191
2024-01-31 17:29:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 17:29:02:INFO:valid samples: (229,)
2024-01-31 17:29:03:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 17:29:03:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706693343 HTTP/1.1" 200 191
2024-01-31 17:29:03:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 17:29:04:INFO:test samples: (686,)
2024-01-31 17:29:04:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 17:29:04:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706693344 HTTP/1.1" 200 191
2024-01-31 17:29:04:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 17:29:15:INFO:Start running cmcm...
2024-01-31 17:29:15:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (4096, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': '01ai/Yi-6B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3, 3]. response: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 8, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 't_lstm_hidden_size': 128, 't_mlp_hidden_size': 256, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 't_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 't_lstm_dropout': 0.0, 'a_encoder_heads': 5, 'v_encoder_heads': 4, 'a_encoder_layers': 6, 'v_encoder_layers': 6, 'post_fusion_dim': 128, 'post_text_dim': 64, 'post_audio_dim': 64, 'post_video_dim': 64, 'warm_up_epochs': 10, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-01-31 17:29:15:INFO:Find gpu: 2, with memory: 381026304 left!
2024-01-31 17:29:15:INFO:Let's use the GPU 1 !
2024-01-31 17:29:16:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 17:29:16:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706693356 HTTP/1.1" 200 191
2024-01-31 17:29:16:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 17:29:17:INFO:train samples: (1284,)
2024-01-31 17:29:17:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 17:29:18:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706693358 HTTP/1.1" 200 191
2024-01-31 17:29:18:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 17:29:18:INFO:valid samples: (229,)
2024-01-31 17:29:19:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 17:29:19:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706693359 HTTP/1.1" 200 191
2024-01-31 17:29:19:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 17:29:20:INFO:test samples: (686,)
2024-01-31 17:29:20:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 17:29:20:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706693360 HTTP/1.1" 200 191
2024-01-31 17:29:20:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 17:29:28:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 17:29:29:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706693369 HTTP/1.1" 200 191
2024-01-31 17:29:29:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 17:29:34:INFO:trainable params: 2590732 || all params: 6063626252 || trainable%: 0.04272578639136085
2024-01-31 17:29:34:INFO:Init labels...
2024-01-31 17:29:34:INFO:Start training...
2024-01-31 17:31:30:INFO:Start running cmcm...
2024-01-31 17:31:30:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (4096, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': '01ai/Yi-6B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3, 3]. response: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 8, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 't_lstm_hidden_size': 128, 't_mlp_hidden_size': 256, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 't_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 't_lstm_dropout': 0.0, 'a_encoder_heads': 5, 'v_encoder_heads': 4, 'a_encoder_layers': 6, 'v_encoder_layers': 6, 'post_fusion_dim': 128, 'post_text_dim': 64, 'post_audio_dim': 64, 'post_video_dim': 64, 'warm_up_epochs': 10, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-01-31 17:31:30:INFO:Find gpu: 2, with memory: 381026304 left!
2024-01-31 17:31:30:INFO:Let's use the GPU 1 !
2024-01-31 17:31:30:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 17:31:31:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706693491 HTTP/1.1" 200 191
2024-01-31 17:31:31:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 17:31:32:INFO:train samples: (1284,)
2024-01-31 17:31:32:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 17:31:32:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706693493 HTTP/1.1" 200 191
2024-01-31 17:31:33:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 17:31:33:INFO:valid samples: (229,)
2024-01-31 17:31:33:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 17:31:34:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706693494 HTTP/1.1" 200 191
2024-01-31 17:31:34:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 17:31:35:INFO:test samples: (686,)
2024-01-31 17:31:35:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 17:31:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706693495 HTTP/1.1" 200 191
2024-01-31 17:31:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 17:31:43:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 17:31:44:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706693504 HTTP/1.1" 200 191
2024-01-31 17:31:44:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 17:31:47:INFO:trainable params: 2590732 || all params: 6063626252 || trainable%: 0.04272578639136085
2024-01-31 17:31:47:INFO:Init labels...
2024-01-31 17:31:47:INFO:Start training...
2024-01-31 17:32:34:INFO:Start running cmcm...
2024-01-31 17:32:34:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (4096, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': '01ai/Yi-6B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3, 3]. response: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 8, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 't_lstm_hidden_size': 128, 't_mlp_hidden_size': 256, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 't_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 't_lstm_dropout': 0.0, 'a_encoder_heads': 5, 'v_encoder_heads': 4, 'a_encoder_layers': 6, 'v_encoder_layers': 6, 'post_fusion_dim': 128, 'post_text_dim': 64, 'post_audio_dim': 64, 'post_video_dim': 64, 'warm_up_epochs': 10, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-01-31 17:32:34:INFO:Find gpu: 2, with memory: 381026304 left!
2024-01-31 17:32:34:INFO:Let's use the GPU 1 !
2024-01-31 17:32:34:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 17:32:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706693555 HTTP/1.1" 200 191
2024-01-31 17:32:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 17:32:35:INFO:train samples: (1284,)
2024-01-31 17:32:36:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 17:32:36:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706693556 HTTP/1.1" 200 191
2024-01-31 17:32:36:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 17:32:37:INFO:valid samples: (229,)
2024-01-31 17:32:37:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 17:32:37:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706693558 HTTP/1.1" 200 191
2024-01-31 17:32:38:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 17:32:38:INFO:test samples: (686,)
2024-01-31 17:32:38:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 17:32:39:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706693559 HTTP/1.1" 200 191
2024-01-31 17:32:39:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 17:32:47:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 17:32:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706693567 HTTP/1.1" 200 191
2024-01-31 17:32:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 17:32:52:INFO:trainable params: 2590732 || all params: 6063626252 || trainable%: 0.04272578639136085
2024-01-31 17:32:52:INFO:Init labels...
2024-01-31 17:32:52:INFO:Start training...
2024-01-31 17:40:34:INFO:Start running cmcm...
2024-01-31 17:40:34:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (4096, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': '01ai/Yi-6B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3, 3]. response: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 8, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 't_lstm_hidden_size': 128, 't_mlp_hidden_size': 256, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 't_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 't_lstm_dropout': 0.0, 'a_encoder_heads': 5, 'v_encoder_heads': 4, 'a_encoder_layers': 6, 'v_encoder_layers': 6, 'post_fusion_dim': 128, 'post_text_dim': 64, 'post_audio_dim': 64, 'post_video_dim': 64, 'warm_up_epochs': 10, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-01-31 17:40:34:INFO:Find gpu: 2, with memory: 381026304 left!
2024-01-31 17:40:34:INFO:Let's use the GPU 1 !
2024-01-31 17:40:35:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 17:40:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706694035 HTTP/1.1" 200 191
2024-01-31 17:40:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 17:40:36:INFO:train samples: (1284,)
2024-01-31 17:40:36:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 17:40:36:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706694037 HTTP/1.1" 200 191
2024-01-31 17:40:37:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 17:40:37:INFO:valid samples: (229,)
2024-01-31 17:40:37:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 17:40:37:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706694038 HTTP/1.1" 200 191
2024-01-31 17:40:38:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 17:40:38:INFO:test samples: (686,)
2024-01-31 17:40:38:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 17:40:38:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706694039 HTTP/1.1" 200 191
2024-01-31 17:40:39:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 17:40:47:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 17:40:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706694047 HTTP/1.1" 200 191
2024-01-31 17:40:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 17:40:51:INFO:trainable params: 2590732 || all params: 6063626252 || trainable%: 0.04272578639136085
2024-01-31 17:40:51:INFO:Init labels...
2024-01-31 17:40:51:INFO:Start training...
2024-01-31 17:41:54:INFO:Start running cmcm...
2024-01-31 17:41:54:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (4096, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': '01ai/Yi-6B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3, 3]. response: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 8, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 't_lstm_hidden_size': 128, 't_mlp_hidden_size': 256, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 't_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 't_lstm_dropout': 0.0, 'a_encoder_heads': 5, 'v_encoder_heads': 4, 'a_encoder_layers': 6, 'v_encoder_layers': 6, 'post_fusion_dim': 128, 'post_text_dim': 64, 'post_audio_dim': 64, 'post_video_dim': 64, 'warm_up_epochs': 10, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-01-31 17:41:55:INFO:Find gpu: 2, with memory: 381026304 left!
2024-01-31 17:41:55:INFO:Let's use the GPU 1 !
2024-01-31 17:41:55:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 17:41:55:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706694115 HTTP/1.1" 200 191
2024-01-31 17:41:55:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 17:41:56:INFO:train samples: (1284,)
2024-01-31 17:41:56:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 17:41:57:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706694117 HTTP/1.1" 200 191
2024-01-31 17:41:57:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 17:41:57:INFO:valid samples: (229,)
2024-01-31 17:41:57:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 17:41:58:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706694118 HTTP/1.1" 200 191
2024-01-31 17:41:58:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 17:41:58:INFO:test samples: (686,)
2024-01-31 17:41:58:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 17:41:59:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706694119 HTTP/1.1" 200 191
2024-01-31 17:41:59:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 17:42:07:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 17:42:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706694128 HTTP/1.1" 200 191
2024-01-31 17:42:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 17:42:11:INFO:trainable params: 2590732 || all params: 6063626252 || trainable%: 0.04272578639136085
2024-01-31 17:42:11:INFO:Init labels...
2024-01-31 17:42:11:INFO:Start training...
2024-01-31 17:44:16:INFO:Start running cmcm...
2024-01-31 17:44:16:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'simsv2', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/SIMS_V2/ch-simsv2s.pkl', 'seq_lens': (50, 925, 232), 'feature_dims': (4096, 25, 177), 'train_samples': 2722, 'num_classes': 3, 'language': 'cn', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': '01ai/Yi-6B', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'task_specific_prompt': '[-1, 1]: ', 'batch_size': 8, 'learning_rate': 0.005, 'a_lstm_hidden_size': 16, 'v_lstm_hidden_size': 32, 't_lstm_hidden_size': 128, 't_mlp_hidden_size': 256, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 't_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 't_lstm_dropout': 0.0, 'a_encoder_heads': 5, 'v_encoder_heads': 3, 'a_encoder_layers': 2, 'v_encoder_layers': 2, 'post_fusion_dim': 128, 'post_text_dim': 128, 'post_audio_dim': 128, 'post_video_dim': 128, 'warm_up_epochs': 10, 'update_epochs': 1, 'early_stop': 10, 'gamma': 1, 'H': 1.0, 'seed': 1111}>
2024-01-31 17:44:16:INFO:Find gpu: 2, with memory: 381026304 left!
2024-01-31 17:44:16:INFO:Let's use the GPU 1 !
2024-01-31 17:44:18:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 17:44:18:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706694258 HTTP/1.1" 200 191
2024-01-31 17:44:19:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 17:44:19:INFO:train samples: (2722,)
2024-01-31 17:44:21:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 17:44:21:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706694262 HTTP/1.1" 200 191
2024-01-31 17:44:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 17:44:22:INFO:valid samples: (647,)
2024-01-31 17:44:24:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 17:44:24:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706694264 HTTP/1.1" 200 191
2024-01-31 17:44:24:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 17:44:25:INFO:test samples: (1034,)
2024-01-31 17:44:25:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 17:44:25:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706694265 HTTP/1.1" 200 191
2024-01-31 17:44:25:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 17:44:33:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 17:44:33:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706694274 HTTP/1.1" 200 191
2024-01-31 17:44:34:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 17:44:37:INFO:trainable params: 2604492 || all params: 6063640012 || trainable%: 0.042952615835466584
2024-01-31 17:44:37:INFO:Init labels...
2024-01-31 17:44:37:INFO:Start training...
2024-01-31 17:46:21:INFO:TRAIN-(cmcm) (1/1/1)>> loss: 2.0168
2024-01-31 17:46:41:INFO:VAL-(cmcm) >>
2024-01-31 17:46:41:INFO:M: >>  Mult_acc_2: 0.6136  Mult_acc_2_weak: 0.6706  Mult_acc_3: 0.1005  Mult_acc_5: 0.0958  F1_score: 0.4737  MAE: 0.5431  Corr: 0.0461  R_squre: -0.0383 
2024-01-31 17:46:47:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-simsv2-regression.pth.
2024-01-31 17:48:38:INFO:TRAIN-(cmcm) (1/2/1)>> loss: 1.2854
2024-01-31 17:48:59:INFO:VAL-(cmcm) >>
2024-01-31 17:48:59:INFO:M: >>  Mult_acc_2: 0.6445  Mult_acc_2_weak: 0.6863  Mult_acc_3: 0.1376  Mult_acc_5: 0.1144  F1_score: 0.5484  MAE: 0.5304  Corr: 0.2084  R_squre: -0.0076 
2024-01-31 17:49:04:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-simsv2-regression.pth.
2024-01-31 17:50:54:INFO:TRAIN-(cmcm) (1/3/1)>> loss: 1.2327
2024-01-31 17:51:15:INFO:VAL-(cmcm) >>
2024-01-31 17:51:15:INFO:M: >>  Mult_acc_2: 0.6260  Mult_acc_2_weak: 0.5922  Mult_acc_3: 0.3215  Mult_acc_5: 0.1314  F1_score: 0.6301  MAE: 0.7524  Corr: 0.2844  R_squre: -1.2939 
2024-01-31 17:53:19:INFO:Start running cmcm...
2024-01-31 17:53:19:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'simsv2', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/SIMS_V2/ch-simsv2s.pkl', 'seq_lens': (50, 925, 232), 'feature_dims': (4096, 25, 177), 'train_samples': 2722, 'num_classes': 3, 'language': 'cn', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': '01ai/Yi-6B', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'task_specific_prompt': '[-1, 1]: ', 'batch_size': 8, 'learning_rate': 0.005, 'a_lstm_hidden_size': 16, 'v_lstm_hidden_size': 32, 't_lstm_hidden_size': 128, 't_mlp_hidden_size': 256, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 't_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 't_lstm_dropout': 0.0, 'a_encoder_heads': 5, 'v_encoder_heads': 3, 'a_encoder_layers': 2, 'v_encoder_layers': 2, 'post_fusion_dim': 128, 'post_text_dim': 128, 'post_audio_dim': 128, 'post_video_dim': 128, 'warm_up_epochs': 10, 'update_epochs': 1, 'early_stop': 10, 'gamma': 1, 'H': 1.0, 'seed': 1111}>
2024-01-31 17:53:19:INFO:Find gpu: 2, with memory: 381026304 left!
2024-01-31 17:53:19:INFO:Let's use the GPU 1 !
2024-01-31 17:53:21:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 17:53:21:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706694801 HTTP/1.1" 200 191
2024-01-31 17:53:21:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 17:53:22:INFO:train samples: (2722,)
2024-01-31 17:53:24:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 17:53:24:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706694804 HTTP/1.1" 200 191
2024-01-31 17:53:24:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 17:53:25:INFO:valid samples: (647,)
2024-01-31 17:53:26:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 17:53:27:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706694807 HTTP/1.1" 200 191
2024-01-31 17:53:27:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 17:53:27:INFO:test samples: (1034,)
2024-01-31 17:53:27:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 17:53:28:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706694808 HTTP/1.1" 200 191
2024-01-31 17:53:28:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 17:53:36:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 17:53:36:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706694816 HTTP/1.1" 200 191
2024-01-31 17:53:37:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 17:53:40:INFO:trainable params: 2604492 || all params: 6063640012 || trainable%: 0.042952615835466584
2024-01-31 17:53:40:INFO:Init labels...
2024-01-31 17:53:40:INFO:Start training...
2024-01-31 17:55:27:INFO:TRAIN-(cmcm) (1/1/1)>> loss: 2.0168
2024-01-31 17:55:47:INFO:VAL-(cmcm) >>
2024-01-31 17:55:48:INFO:M: >>  Mult_acc_2: 0.6136  Mult_acc_2_weak: 0.6706  Mult_acc_3: 0.1005  Mult_acc_5: 0.0958  F1_score: 0.4737  MAE: 0.5431  Corr: 0.0461  R_squre: -0.0383 
2024-01-31 17:55:53:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-simsv2-regression.pth.
2024-01-31 17:57:41:INFO:TRAIN-(cmcm) (1/2/1)>> loss: 1.2854
2024-01-31 17:58:02:INFO:VAL-(cmcm) >>
2024-01-31 17:58:02:INFO:M: >>  Mult_acc_2: 0.6445  Mult_acc_2_weak: 0.6863  Mult_acc_3: 0.1376  Mult_acc_5: 0.1144  F1_score: 0.5484  MAE: 0.5304  Corr: 0.2084  R_squre: -0.0076 
2024-01-31 17:58:07:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-simsv2-regression.pth.
2024-01-31 17:59:54:INFO:TRAIN-(cmcm) (1/3/1)>> loss: 1.2327
2024-01-31 18:00:14:INFO:VAL-(cmcm) >>
2024-01-31 18:00:14:INFO:M: >>  Mult_acc_2: 0.6260  Mult_acc_2_weak: 0.5922  Mult_acc_3: 0.3215  Mult_acc_5: 0.1314  F1_score: 0.6301  MAE: 0.7524  Corr: 0.2844  R_squre: -1.2939 
2024-01-31 18:01:59:INFO:TRAIN-(cmcm) (2/4/1)>> loss: 1.2027
2024-01-31 18:02:19:INFO:VAL-(cmcm) >>
2024-01-31 18:02:19:INFO:M: >>  Mult_acc_2: 0.7017  Mult_acc_2_weak: 0.6706  Mult_acc_3: 0.2689  Mult_acc_5: 0.1607  F1_score: 0.6858  MAE: 0.5713  Corr: 0.3416  R_squre: -0.3332 
2024-01-31 18:04:07:INFO:TRAIN-(cmcm) (3/5/1)>> loss: 1.1945
2024-01-31 18:04:28:INFO:VAL-(cmcm) >>
2024-01-31 18:04:28:INFO:M: >>  Mult_acc_2: 0.6708  Mult_acc_2_weak: 0.6902  Mult_acc_3: 0.2210  Mult_acc_5: 0.1499  F1_score: 0.6351  MAE: 0.5626  Corr: 0.2402  R_squre: -0.2684 
2024-01-31 18:06:16:INFO:TRAIN-(cmcm) (4/6/1)>> loss: 1.1716
2024-01-31 18:06:36:INFO:VAL-(cmcm) >>
2024-01-31 18:06:36:INFO:M: >>  Mult_acc_2: 0.6136  Mult_acc_2_weak: 0.6549  Mult_acc_3: 0.2287  Mult_acc_5: 0.1345  F1_score: 0.5690  MAE: 0.6026  Corr: 0.1792  R_squre: -0.4189 
2024-01-31 18:08:23:INFO:TRAIN-(cmcm) (5/7/1)>> loss: 1.1474
2024-01-31 18:08:43:INFO:VAL-(cmcm) >>
2024-01-31 18:08:43:INFO:M: >>  Mult_acc_2: 0.6167  Mult_acc_2_weak: 0.6706  Mult_acc_3: 0.1530  Mult_acc_5: 0.1128  F1_score: 0.5067  MAE: 0.5774  Corr: 0.0961  R_squre: -0.2388 
2024-01-31 18:10:30:INFO:TRAIN-(cmcm) (6/8/1)>> loss: 1.1183
2024-01-31 18:10:50:INFO:VAL-(cmcm) >>
2024-01-31 18:10:50:INFO:M: >>  Mult_acc_2: 0.6244  Mult_acc_2_weak: 0.6706  Mult_acc_3: 0.2148  Mult_acc_5: 0.1530  F1_score: 0.5090  MAE: 0.5368  Corr: 0.2432  R_squre: -0.0998 
2024-01-31 18:12:35:INFO:TRAIN-(cmcm) (7/9/1)>> loss: 1.1012
2024-01-31 18:12:55:INFO:VAL-(cmcm) >>
2024-01-31 18:12:55:INFO:M: >>  Mult_acc_2: 0.6213  Mult_acc_2_weak: 0.6510  Mult_acc_3: 0.2705  Mult_acc_5: 0.1808  F1_score: 0.5528  MAE: 0.5488  Corr: 0.2581  R_squre: -0.2202 
2024-01-31 18:14:42:INFO:TRAIN-(cmcm) (8/10/1)>> loss: 1.0814
2024-01-31 18:15:02:INFO:VAL-(cmcm) >>
2024-01-31 18:15:02:INFO:M: >>  Mult_acc_2: 0.6399  Mult_acc_2_weak: 0.6706  Mult_acc_3: 0.2674  Mult_acc_5: 0.1762  F1_score: 0.5689  MAE: 0.5450  Corr: 0.2816  R_squre: -0.1969 
2024-01-31 18:16:46:INFO:TRAIN-(cmcm) (9/11/1)>> loss: 1.0843
2024-01-31 18:17:06:INFO:VAL-(cmcm) >>
2024-01-31 18:17:06:INFO:M: >>  Mult_acc_2: 0.6213  Mult_acc_2_weak: 0.6549  Mult_acc_3: 0.3246  Mult_acc_5: 0.2009  F1_score: 0.5917  MAE: 0.5804  Corr: 0.2654  R_squre: -0.4297 
2024-01-31 18:19:31:INFO:Start running cmcm...
2024-01-31 18:19:31:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'simsv2', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/SIMS_V2/ch-simsv2s.pkl', 'seq_lens': (50, 925, 232), 'feature_dims': (4096, 25, 177), 'train_samples': 2722, 'num_classes': 3, 'language': 'cn', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': '01ai/Yi-6B', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'task_specific_prompt': '[-1, 1]: ', 'batch_size': 8, 'learning_rate': 0.005, 'a_lstm_hidden_size': 16, 'v_lstm_hidden_size': 32, 't_lstm_hidden_size': 128, 't_mlp_hidden_size': 256, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 't_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 't_lstm_dropout': 0.0, 'a_encoder_heads': 5, 'v_encoder_heads': 3, 'a_encoder_layers': 2, 'v_encoder_layers': 2, 'post_fusion_dim': 128, 'post_text_dim': 128, 'post_audio_dim': 128, 'post_video_dim': 128, 'warm_up_epochs': 10, 'update_epochs': 1, 'early_stop': 10, 'gamma': 1, 'H': 1.0, 'seed': 1111}>
2024-01-31 18:19:31:INFO:Find gpu: 2, with memory: 381026304 left!
2024-01-31 18:19:31:INFO:Let's use the GPU 1 !
2024-01-31 18:19:32:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 18:19:32:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706696373 HTTP/1.1" 200 191
2024-01-31 18:19:33:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 18:19:33:INFO:train samples: (2722,)
2024-01-31 18:19:35:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 18:19:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706696376 HTTP/1.1" 200 191
2024-01-31 18:19:36:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 18:19:36:INFO:valid samples: (647,)
2024-01-31 18:19:38:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 18:19:38:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706696378 HTTP/1.1" 200 191
2024-01-31 18:19:38:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 18:19:39:INFO:test samples: (1034,)
2024-01-31 18:19:39:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 18:19:39:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706696379 HTTP/1.1" 200 191
2024-01-31 18:19:39:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 18:19:47:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 18:19:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706696388 HTTP/1.1" 200 191
2024-01-31 18:19:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 18:19:51:INFO:trainable params: 2604492 || all params: 6063640012 || trainable%: 0.042952615835466584
2024-01-31 18:19:51:INFO:Init labels...
2024-01-31 18:19:51:INFO:Start training...
2024-01-31 18:23:53:INFO:Start running cmcm...
2024-01-31 18:23:53:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'simsv2', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/SIMS_V2/ch-simsv2s.pkl', 'seq_lens': (50, 925, 232), 'feature_dims': (4096, 25, 177), 'train_samples': 2722, 'num_classes': 3, 'language': 'cn', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': '01ai/Yi-6B', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'task_specific_prompt': '[-1, 1]: ', 'batch_size': 8, 'learning_rate': 0.005, 'a_lstm_hidden_size': 16, 'v_lstm_hidden_size': 32, 't_lstm_hidden_size': 128, 't_mlp_hidden_size': 256, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 't_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 't_lstm_dropout': 0.0, 'a_encoder_heads': 5, 'v_encoder_heads': 3, 'a_encoder_layers': 2, 'v_encoder_layers': 2, 'post_fusion_dim': 128, 'post_text_dim': 128, 'post_audio_dim': 128, 'post_video_dim': 128, 'warm_up_epochs': 10, 'update_epochs': 1, 'early_stop': 10, 'gamma': 1, 'H': 1.0, 'seed': 1111}>
2024-01-31 18:23:53:INFO:Find gpu: 2, with memory: 381026304 left!
2024-01-31 18:23:53:INFO:Let's use the GPU 1 !
2024-01-31 18:23:54:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 18:23:55:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706696635 HTTP/1.1" 200 191
2024-01-31 18:23:55:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 18:23:56:INFO:train samples: (2722,)
2024-01-31 18:23:58:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 18:23:58:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706696638 HTTP/1.1" 200 191
2024-01-31 18:23:58:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 18:23:59:INFO:valid samples: (647,)
2024-01-31 18:24:00:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 18:24:01:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706696641 HTTP/1.1" 200 191
2024-01-31 18:24:01:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 18:24:01:INFO:test samples: (1034,)
2024-01-31 18:24:02:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 18:24:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706696642 HTTP/1.1" 200 191
2024-01-31 18:24:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 18:24:10:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 18:24:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706696650 HTTP/1.1" 200 191
2024-01-31 18:24:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 18:24:14:INFO:trainable params: 2604492 || all params: 6063640012 || trainable%: 0.042952615835466584
2024-01-31 18:24:14:INFO:Init labels...
2024-01-31 18:24:14:INFO:Start training...
2024-01-31 18:26:02:INFO:TRAIN-(cmcm) (1/1/1)>> loss: 1.8350
2024-01-31 18:26:23:INFO:VAL-(cmcm) >>
2024-01-31 18:26:23:INFO:M: >>  Mult_acc_2: 0.6121  Mult_acc_2_weak: 0.6745  Mult_acc_3: 0.0958  Mult_acc_5: 0.0958  F1_score: 0.4648  MAE: 0.5400  Corr: nan  R_squre: -0.0213 
2024-01-31 18:26:29:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-simsv2-regression.pth.
2024-01-31 18:28:18:INFO:TRAIN-(cmcm) (1/2/1)>> loss: 1.1123
2024-01-31 18:28:27:INFO:VAL-(cmcm) >>
2024-01-31 18:28:27:INFO:M: >>  Mult_acc_2: 0.6121  Mult_acc_2_weak: 0.6745  Mult_acc_3: 0.0958  Mult_acc_5: 0.0958  F1_score: 0.4648  MAE: 0.5400  Corr: nan  R_squre: -0.0213 
2024-01-31 18:30:16:INFO:TRAIN-(cmcm) (2/3/1)>> loss: 1.0614
2024-01-31 18:30:25:INFO:VAL-(cmcm) >>
2024-01-31 18:30:25:INFO:M: >>  Mult_acc_2: 0.6121  Mult_acc_2_weak: 0.6745  Mult_acc_3: 0.0958  Mult_acc_5: 0.0958  F1_score: 0.4648  MAE: 0.5400  Corr: nan  R_squre: -0.0213 
2024-01-31 18:32:11:INFO:TRAIN-(cmcm) (3/4/1)>> loss: 1.0343
2024-01-31 18:32:21:INFO:VAL-(cmcm) >>
2024-01-31 18:32:21:INFO:M: >>  Mult_acc_2: 0.6121  Mult_acc_2_weak: 0.6745  Mult_acc_3: 0.0958  Mult_acc_5: 0.0958  F1_score: 0.4648  MAE: 0.5400  Corr: nan  R_squre: -0.0213 
2024-01-31 18:34:06:INFO:TRAIN-(cmcm) (4/5/1)>> loss: 1.0102
2024-01-31 18:34:56:INFO:Start running cmcm...
2024-01-31 18:34:56:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'simsv2', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/SIMS_V2/ch-simsv2s.pkl', 'seq_lens': (50, 925, 232), 'feature_dims': (4096, 25, 177), 'train_samples': 2722, 'num_classes': 3, 'language': 'cn', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': '01ai/Yi-6B', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'task_specific_prompt': '[-1, 1]: ', 'batch_size': 8, 'learning_rate': 0.005, 'a_lstm_hidden_size': 16, 'v_lstm_hidden_size': 32, 't_lstm_hidden_size': 128, 't_mlp_hidden_size': 256, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 't_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 't_lstm_dropout': 0.0, 'a_encoder_heads': 5, 'v_encoder_heads': 3, 'a_encoder_layers': 2, 'v_encoder_layers': 2, 'post_fusion_dim': 128, 'post_text_dim': 128, 'post_audio_dim': 128, 'post_video_dim': 128, 'warm_up_epochs': 10, 'update_epochs': 8, 'early_stop': 10, 'gamma': 1, 'H': 1.0, 'seed': 1111}>
2024-01-31 18:34:56:INFO:Find gpu: 0, with memory: 381026304 left!
2024-01-31 18:34:56:INFO:Let's use the GPU 1 !
2024-01-31 18:34:58:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 18:34:58:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706697299 HTTP/1.1" 200 191
2024-01-31 18:34:59:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 18:35:00:INFO:train samples: (2722,)
2024-01-31 18:35:01:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 18:35:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706697302 HTTP/1.1" 200 191
2024-01-31 18:35:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 18:35:02:INFO:valid samples: (647,)
2024-01-31 18:35:04:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 18:35:04:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706697304 HTTP/1.1" 200 191
2024-01-31 18:35:04:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 18:35:05:INFO:test samples: (1034,)
2024-01-31 18:35:05:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 18:35:05:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706697305 HTTP/1.1" 200 191
2024-01-31 18:35:06:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 18:35:13:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 18:35:14:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/revisions?EndTime=1706697314 HTTP/1.1" 200 191
2024-01-31 18:35:14:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/01ai/Yi-6B/repo/files?Revision=master&Recursive=True HTTP/1.1" 200 None
2024-01-31 18:35:17:INFO:trainable params: 2604492 || all params: 6063640012 || trainable%: 0.042952615835466584
2024-01-31 18:35:17:INFO:Init labels...
2024-01-31 18:35:17:INFO:Start training...
2024-01-31 18:37:06:INFO:TRAIN-(cmcm) (1/1/1)>> loss: 4.5876
2024-01-31 18:37:26:INFO:VAL-(cmcm) >>
2024-01-31 18:37:26:INFO:M: >>  Mult_acc_2: 0.6105  Mult_acc_2_weak: 0.6706  Mult_acc_3: 0.1020  Mult_acc_5: 0.1005  F1_score: 0.4640  MAE: 0.5422  Corr: -0.0398  R_squre: -0.0328 
2024-01-31 18:37:32:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-simsv2-regression.pth.
2024-01-31 18:39:24:INFO:TRAIN-(cmcm) (1/2/1)>> loss: 1.6663
2024-01-31 18:39:44:INFO:VAL-(cmcm) >>
2024-01-31 18:39:44:INFO:M: >>  Mult_acc_2: 0.6121  Mult_acc_2_weak: 0.6745  Mult_acc_3: 0.0958  Mult_acc_5: 0.0958  F1_score: 0.4648  MAE: 0.5400  Corr: nan  R_squre: -0.0213 
2024-01-31 18:39:50:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-simsv2-regression.pth.
2024-01-31 18:41:43:INFO:TRAIN-(cmcm) (1/3/1)>> loss: 1.4707
2024-01-31 18:42:03:INFO:VAL-(cmcm) >>
2024-01-31 18:42:03:INFO:M: >>  Mult_acc_2: 0.6121  Mult_acc_2_weak: 0.6706  Mult_acc_3: 0.1020  Mult_acc_5: 0.0974  F1_score: 0.4756  MAE: 0.5456  Corr: 0.0210  R_squre: -0.0536 
2024-01-31 18:43:44:INFO:Start running cmcm...
2024-01-31 18:43:44:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'simsv2', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/SIMS_V2/ch-simsv2s.pkl', 'seq_lens': (50, 925, 232), 'feature_dims': (4096, 25, 177), 'train_samples': 2722, 'num_classes': 3, 'language': 'cn', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-7B', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'task_specific_prompt': '[-1, 1]: ', 'batch_size': 8, 'learning_rate': 0.005, 'a_lstm_hidden_size': 16, 'v_lstm_hidden_size': 32, 't_lstm_hidden_size': 128, 't_mlp_hidden_size': 256, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 't_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 't_lstm_dropout': 0.0, 'a_encoder_heads': 5, 'v_encoder_heads': 3, 'a_encoder_layers': 2, 'v_encoder_layers': 2, 'post_fusion_dim': 128, 'post_text_dim': 128, 'post_audio_dim': 128, 'post_video_dim': 128, 'warm_up_epochs': 10, 'update_epochs': 1, 'early_stop': 10, 'gamma': 1, 'H': 1.0, 'seed': 1111}>
2024-01-31 18:43:44:INFO:Find gpu: 0, with memory: 381026304 left!
2024-01-31 18:43:44:INFO:Let's use the GPU 1 !
2024-01-31 18:43:46:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 18:43:46:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-7B/revisions?EndTime=1706697826 HTTP/1.1" 200 909
2024-01-31 18:43:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-7B/revisions?EndTime=1701705600 HTTP/1.1" 200 909
2024-01-31 18:43:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-7B/repo/files?Revision=v1.1.8&Recursive=True HTTP/1.1" 200 None
2024-01-31 18:43:47:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 18:43:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-7B/repo?Revision=v1.1.8&FilePath=cache_autogptq_cuda_256.cpp HTTP/1.1" 200 8404
2024-01-31 18:43:47:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 18:43:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-7B/repo?Revision=v1.1.8&FilePath=cache_autogptq_cuda_kernel_256.cu HTTP/1.1" 200 51991
2024-01-31 18:43:48:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 18:43:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-7B/repo?Revision=v1.1.8&FilePath=config.json HTTP/1.1" 200 910
2024-01-31 18:43:48:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 18:43:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-7B/repo?Revision=v1.1.8&FilePath=configuration.json HTTP/1.1" 200 88
2024-01-31 18:43:48:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 18:43:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-7B/repo?Revision=v1.1.8&FilePath=configuration_qwen.py HTTP/1.1" 200 2345
2024-01-31 18:43:48:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 18:43:49:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-7B/repo?Revision=v1.1.8&FilePath=cpp_kernels.py HTTP/1.1" 200 1924
2024-01-31 18:43:49:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 18:43:49:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-7B/repo?Revision=v1.1.8&FilePath=generation_config.json HTTP/1.1" 200 222
2024-01-31 18:43:49:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 18:43:49:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-7B/repo?Revision=v1.1.8&FilePath=LICENSE.md HTTP/1.1" 200 6896
2024-01-31 18:43:49:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 18:43:50:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-7B/repo?Revision=v1.1.8&FilePath=modeling_qwen.py HTTP/1.1" 200 55820
2024-01-31 18:43:50:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 18:43:50:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-7B/repo?Revision=v1.1.8&FilePath=NOTICE.md HTTP/1.1" 200 2703
2024-01-31 18:43:50:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 18:43:50:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-7B/repo?Revision=v1.1.8&FilePath=qwen.tiktoken HTTP/1.1" 200 2561218
2024-01-31 18:43:51:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 18:43:51:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-7B/repo?Revision=v1.1.8&FilePath=qwen_generation_utils.py HTTP/1.1" 200 14604
2024-01-31 18:43:51:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 18:43:52:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-7B/repo?Revision=v1.1.8&FilePath=README.md HTTP/1.1" 200 21295
2024-01-31 18:43:52:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 18:43:52:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-7B/repo?Revision=v1.1.8&FilePath=tokenization_qwen.py HTTP/1.1" 200 9618
2024-01-31 18:43:52:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 18:43:52:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-7B/repo?Revision=v1.1.8&FilePath=tokenizer_config.json HTTP/1.1" 200 173
2024-01-31 18:44:28:INFO:Start running cmcm...
2024-01-31 18:44:28:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'simsv2', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/SIMS_V2/ch-simsv2s.pkl', 'seq_lens': (50, 925, 232), 'feature_dims': (4096, 25, 177), 'train_samples': 2722, 'num_classes': 3, 'language': 'cn', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-7B', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'task_specific_prompt': '[-1, 1]: ', 'batch_size': 8, 'learning_rate': 0.005, 'a_lstm_hidden_size': 16, 'v_lstm_hidden_size': 32, 't_lstm_hidden_size': 128, 't_mlp_hidden_size': 256, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 't_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 't_lstm_dropout': 0.0, 'a_encoder_heads': 5, 'v_encoder_heads': 3, 'a_encoder_layers': 2, 'v_encoder_layers': 2, 'post_fusion_dim': 128, 'post_text_dim': 128, 'post_audio_dim': 128, 'post_video_dim': 128, 'warm_up_epochs': 10, 'update_epochs': 1, 'early_stop': 10, 'gamma': 1, 'H': 1.0, 'seed': 1111}>
2024-01-31 18:44:28:INFO:Find gpu: 0, with memory: 381026304 left!
2024-01-31 18:44:28:INFO:Let's use the GPU 1 !
2024-01-31 18:44:29:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 18:44:30:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-7B/revisions?EndTime=1706697870 HTTP/1.1" 200 909
2024-01-31 18:44:30:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-7B/revisions?EndTime=1701705600 HTTP/1.1" 200 909
2024-01-31 18:44:30:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-7B/repo/files?Revision=v1.1.8&Recursive=True HTTP/1.1" 200 None
2024-01-31 18:45:45:INFO:Start running cmcm...
2024-01-31 18:45:45:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'simsv2', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/SIMS_V2/ch-simsv2s.pkl', 'seq_lens': (50, 925, 232), 'feature_dims': (4096, 25, 177), 'train_samples': 2722, 'num_classes': 3, 'language': 'cn', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-7B', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'task_specific_prompt': '[-1, 1]: ', 'batch_size': 8, 'learning_rate': 0.005, 'a_lstm_hidden_size': 16, 'v_lstm_hidden_size': 32, 't_lstm_hidden_size': 128, 't_mlp_hidden_size': 256, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 't_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 't_lstm_dropout': 0.0, 'a_encoder_heads': 5, 'v_encoder_heads': 3, 'a_encoder_layers': 2, 'v_encoder_layers': 2, 'post_fusion_dim': 128, 'post_text_dim': 128, 'post_audio_dim': 128, 'post_video_dim': 128, 'warm_up_epochs': 10, 'update_epochs': 1, 'early_stop': 10, 'gamma': 1, 'H': 1.0, 'seed': 1111}>
2024-01-31 18:45:45:INFO:Find gpu: 0, with memory: 381026304 left!
2024-01-31 18:45:45:INFO:Let's use the GPU 1 !
2024-01-31 18:45:47:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 18:45:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-7B/revisions?EndTime=1706697948 HTTP/1.1" 200 909
2024-01-31 18:45:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-7B/revisions?EndTime=1701705600 HTTP/1.1" 200 909
2024-01-31 18:45:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-7B/repo/files?Revision=v1.1.8&Recursive=True HTTP/1.1" 200 None
2024-01-31 18:46:55:INFO:Start running cmcm...
2024-01-31 18:46:55:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'simsv2', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/SIMS_V2/ch-simsv2s.pkl', 'seq_lens': (50, 925, 232), 'feature_dims': (4096, 25, 177), 'train_samples': 2722, 'num_classes': 3, 'language': 'cn', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-7B', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'task_specific_prompt': '[-1, 1]: ', 'batch_size': 8, 'learning_rate': 0.005, 'a_lstm_hidden_size': 16, 'v_lstm_hidden_size': 32, 't_lstm_hidden_size': 128, 't_mlp_hidden_size': 256, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 't_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 't_lstm_dropout': 0.0, 'a_encoder_heads': 5, 'v_encoder_heads': 3, 'a_encoder_layers': 2, 'v_encoder_layers': 2, 'post_fusion_dim': 128, 'post_text_dim': 128, 'post_audio_dim': 128, 'post_video_dim': 128, 'warm_up_epochs': 10, 'update_epochs': 1, 'early_stop': 10, 'gamma': 1, 'H': 1.0, 'seed': 1111}>
2024-01-31 18:46:55:INFO:Find gpu: 0, with memory: 381026304 left!
2024-01-31 18:46:55:INFO:Let's use the GPU 1 !
2024-01-31 18:46:56:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 18:46:56:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-7B/revisions?EndTime=1706698017 HTTP/1.1" 200 909
2024-01-31 18:46:57:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-7B/revisions?EndTime=1701705600 HTTP/1.1" 200 909
2024-01-31 18:46:57:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-7B/repo/files?Revision=v1.1.8&Recursive=True HTTP/1.1" 200 None
2024-01-31 18:47:55:INFO:Start running cmcm...
2024-01-31 18:47:55:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'simsv2', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/SIMS_V2/ch-simsv2s.pkl', 'seq_lens': (50, 925, 232), 'feature_dims': (4096, 25, 177), 'train_samples': 2722, 'num_classes': 3, 'language': 'cn', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-7B', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'task_specific_prompt': '[-1, 1]: ', 'batch_size': 8, 'learning_rate': 0.005, 'a_lstm_hidden_size': 16, 'v_lstm_hidden_size': 32, 't_lstm_hidden_size': 128, 't_mlp_hidden_size': 256, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 't_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 't_lstm_dropout': 0.0, 'a_encoder_heads': 5, 'v_encoder_heads': 3, 'a_encoder_layers': 2, 'v_encoder_layers': 2, 'post_fusion_dim': 128, 'post_text_dim': 128, 'post_audio_dim': 128, 'post_video_dim': 128, 'warm_up_epochs': 10, 'update_epochs': 1, 'early_stop': 10, 'gamma': 1, 'H': 1.0, 'seed': 1111}>
2024-01-31 18:47:55:INFO:Find gpu: 0, with memory: 381026304 left!
2024-01-31 18:47:55:INFO:Let's use the GPU 1 !
2024-01-31 18:47:56:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 18:47:57:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-7B/revisions?EndTime=1706698077 HTTP/1.1" 200 909
2024-01-31 18:47:57:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-7B/revisions?EndTime=1701705600 HTTP/1.1" 200 909
2024-01-31 18:47:57:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-7B/repo/files?Revision=v1.1.8&Recursive=True HTTP/1.1" 200 None
2024-01-31 18:49:00:INFO:Start running cmcm...
2024-01-31 18:49:00:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'simsv2', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/SIMS_V2/ch-simsv2s.pkl', 'seq_lens': (50, 925, 232), 'feature_dims': (4096, 25, 177), 'train_samples': 2722, 'num_classes': 3, 'language': 'cn', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-7B', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'task_specific_prompt': '[-1, 1]: ', 'batch_size': 8, 'learning_rate': 0.005, 'a_lstm_hidden_size': 16, 'v_lstm_hidden_size': 32, 't_lstm_hidden_size': 128, 't_mlp_hidden_size': 256, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 't_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 't_lstm_dropout': 0.0, 'a_encoder_heads': 5, 'v_encoder_heads': 3, 'a_encoder_layers': 2, 'v_encoder_layers': 2, 'post_fusion_dim': 128, 'post_text_dim': 128, 'post_audio_dim': 128, 'post_video_dim': 128, 'warm_up_epochs': 10, 'update_epochs': 1, 'early_stop': 10, 'gamma': 1, 'H': 1.0, 'seed': 1111}>
2024-01-31 18:49:00:INFO:Find gpu: 0, with memory: 381026304 left!
2024-01-31 18:49:00:INFO:Let's use the GPU 1 !
2024-01-31 18:49:02:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 18:49:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-7B/revisions?EndTime=1706698142 HTTP/1.1" 200 909
2024-01-31 18:49:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-7B/revisions?EndTime=1701705600 HTTP/1.1" 200 909
2024-01-31 18:49:03:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-7B/repo/files?Revision=v1.1.8&Recursive=True HTTP/1.1" 200 None
2024-01-31 18:50:21:INFO:Start running cmcm...
2024-01-31 18:50:21:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'simsv2', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/SIMS_V2/ch-simsv2s.pkl', 'seq_lens': (50, 925, 232), 'feature_dims': (4096, 25, 177), 'train_samples': 2722, 'num_classes': 3, 'language': 'cn', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-7B', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'task_specific_prompt': '[-1, 1]: ', 'batch_size': 8, 'learning_rate': 0.005, 'a_lstm_hidden_size': 16, 'v_lstm_hidden_size': 32, 't_lstm_hidden_size': 128, 't_mlp_hidden_size': 256, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 't_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 't_lstm_dropout': 0.0, 'a_encoder_heads': 5, 'v_encoder_heads': 3, 'a_encoder_layers': 2, 'v_encoder_layers': 2, 'post_fusion_dim': 128, 'post_text_dim': 128, 'post_audio_dim': 128, 'post_video_dim': 128, 'warm_up_epochs': 10, 'update_epochs': 1, 'early_stop': 10, 'gamma': 1, 'H': 1.0, 'seed': 1111}>
2024-01-31 18:50:21:INFO:Find gpu: 0, with memory: 381026304 left!
2024-01-31 18:50:21:INFO:Let's use the GPU 1 !
2024-01-31 18:50:23:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-01-31 18:50:23:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-7B/revisions?EndTime=1706698223 HTTP/1.1" 200 909
2024-01-31 18:50:23:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-7B/revisions?EndTime=1701705600 HTTP/1.1" 200 909
2024-01-31 18:50:24:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-7B/repo/files?Revision=v1.1.8&Recursive=True HTTP/1.1" 200 None
2024-06-11 12:50:08:INFO:Start running cmcm...
2024-06-11 12:50:08:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-06-11 12:50:08:INFO:Find gpu: 1, with memory: 378273792 left!
2024-06-11 12:50:08:INFO:Let's use the GPU 1 !
2024-06-11 12:50:08:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 12:50:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718081409 HTTP/1.1" 200 235
2024-06-11 12:50:09:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 12:50:09:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 12:50:09:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 12:50:09:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=cache_autogptq_cuda_256.cpp HTTP/1.1" 200 8404
2024-06-11 12:50:09:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 12:50:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=cache_autogptq_cuda_kernel_256.cu HTTP/1.1" 200 51991
2024-06-11 12:50:10:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 12:50:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=assets/cli_demo.gif HTTP/1.1" 200 249464
2024-06-11 12:50:10:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 12:50:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=assets/code_interpreter_showcase_001.jpg HTTP/1.1" 200 138442
2024-06-11 12:50:11:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 12:50:11:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=config.json HTTP/1.1" 200 910
2024-06-11 12:50:11:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 12:50:11:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=configuration.json HTTP/1.1" 200 88
2024-06-11 12:50:11:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 12:50:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=configuration_qwen.py HTTP/1.1" 200 2345
2024-06-11 12:50:12:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 12:50:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=cpp_kernels.py HTTP/1.1" 200 1924
2024-06-11 12:50:12:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 12:50:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=generation_config.json HTTP/1.1" 200 222
2024-06-11 12:50:12:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 12:50:13:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=assets/hfagent_chat_1.png HTTP/1.1" 200 1708738
2024-06-11 12:50:13:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 12:50:13:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=assets/hfagent_chat_2.png HTTP/1.1" 200 1927640
2024-06-11 12:50:14:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 12:50:14:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=assets/hfagent_run.png HTTP/1.1" 200 2770957
2024-06-11 12:50:14:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 12:50:15:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=LICENSE.md HTTP/1.1" 200 7282
2024-06-11 12:50:15:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 12:50:15:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=assets/logo.jpg HTTP/1.1" 200 82693
2024-06-11 12:50:15:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 12:50:15:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=assets/logoqwen.jpg HTTP/1.1" 200 82693
2024-06-11 12:50:15:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 12:50:16:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=modeling_qwen.py HTTP/1.1" 200 55618
2024-06-11 12:50:16:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 12:50:16:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=NOTICE.md HTTP/1.1" 200 15311
2024-06-11 12:50:16:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 12:50:17:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=assets/openai_api.gif HTTP/1.1" 200 242414
2024-06-11 12:50:17:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 12:50:17:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=assets/performance.png HTTP/1.1" 200 118491
2024-06-11 12:50:17:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 12:50:18:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=qwen.tiktoken HTTP/1.1" 200 2561218
2024-06-11 12:50:18:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 12:50:18:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=assets/qwen_72b_needle_in_a_haystack.png HTTP/1.1" 200 484091
2024-06-11 12:50:19:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 12:50:19:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=qwen_generation_utils.py HTTP/1.1" 200 14604
2024-06-11 12:50:19:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 12:50:19:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=assets/qwen_tokenizer.png HTTP/1.1" 200 80947
2024-06-11 12:50:20:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 12:50:20:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=assets/qwen_tokenizer_old.png HTTP/1.1" 200 47558
2024-06-11 12:50:20:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 12:50:20:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=assets/radar_14b.jpg HTTP/1.1" 200 1032407
2024-06-11 12:50:21:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 12:50:21:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=assets/radar_72b.jpg HTTP/1.1" 200 209533
2024-06-11 12:50:21:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 12:50:21:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=assets/radar_72b.pdf HTTP/1.1" 200 19908
2024-06-11 12:50:22:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 12:50:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=assets/react_showcase_001.png HTTP/1.1" 200 309444
2024-06-11 12:50:22:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 12:50:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=assets/react_showcase_002.png HTTP/1.1" 200 629511
2024-06-11 12:50:23:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 12:50:23:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=assets/react_tutorial_001.png HTTP/1.1" 200 384709
2024-06-11 12:50:23:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 12:50:23:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=assets/react_tutorial_002.png HTTP/1.1" 200 455206
2024-06-11 12:50:24:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 12:50:24:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=README.md HTTP/1.1" 200 18594
2024-06-11 12:50:24:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 12:50:24:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=assets/system_prompt_behavior_setting.png HTTP/1.1" 200 404974
2024-06-11 12:50:25:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 12:50:25:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=assets/system_prompt_behavior_setting_en.png HTTP/1.1" 200 179839
2024-06-11 12:50:25:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 12:50:25:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=assets/system_prompt_language_style.png HTTP/1.1" 200 186122
2024-06-11 12:50:25:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 12:50:26:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=assets/system_prompt_language_style_en.png HTTP/1.1" 200 843517
2024-06-11 12:50:26:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 12:50:26:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=assets/system_prompt_role_play.png HTTP/1.1" 200 436597
2024-06-11 12:50:27:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 12:50:27:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=assets/system_prompt_role_play_en.png HTTP/1.1" 200 443108
2024-06-11 12:50:27:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 12:50:28:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=assets/system_prompt_task_setting.png HTTP/1.1" 200 476693
2024-06-11 12:50:28:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 12:50:28:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=assets/system_prompt_task_setting_en.png HTTP/1.1" 200 413015
2024-06-11 12:50:28:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 12:50:29:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=tokenization_qwen.py HTTP/1.1" 200 9618
2024-06-11 12:50:29:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 12:50:29:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=assets/tokenizer.pdf HTTP/1.1" 200 412800
2024-06-11 12:50:29:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 12:50:30:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=assets/tokenizer.png HTTP/1.1" 200 80947
2024-06-11 12:50:30:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 12:50:30:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=tokenizer_config.json HTTP/1.1" 200 173
2024-06-11 12:50:30:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 12:50:30:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=assets/tokenizer_old.pdf HTTP/1.1" 200 42912
2024-06-11 12:50:30:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 12:50:31:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=assets/tokenizer_old.png HTTP/1.1" 200 236005
2024-06-11 12:50:31:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 12:50:31:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=assets/wanx_colorful_black.png HTTP/1.1" 200 1326970
2024-06-11 12:50:31:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 12:50:32:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=assets/web_demo.gif HTTP/1.1" 200 680110
2024-06-11 12:50:32:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 12:50:32:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=assets/wechat.png HTTP/1.1" 200 413332
2024-06-11 12:50:34:INFO:train samples: (1284,)
2024-06-11 12:50:34:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 12:50:34:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718081435 HTTP/1.1" 200 235
2024-06-11 12:50:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 12:50:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 12:50:36:INFO:valid samples: (229,)
2024-06-11 12:50:36:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 12:50:36:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718081437 HTTP/1.1" 200 235
2024-06-11 12:50:37:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 12:50:37:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 12:50:38:INFO:test samples: (686,)
2024-06-11 12:50:38:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 12:50:38:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718081438 HTTP/1.1" 200 235
2024-06-11 12:50:38:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 12:50:39:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 12:50:39:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 12:50:40:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718081440 HTTP/1.1" 200 235
2024-06-11 12:50:40:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 12:50:40:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 12:50:40:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 12:50:40:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 12:50:40:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 12:50:40:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 12:50:41:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=model-00001-of-00002.safetensors HTTP/1.1" 200 167772160
2024-06-11 12:50:41:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=model-00001-of-00002.safetensors HTTP/1.1" 200 167772160
2024-06-11 12:50:41:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=model-00001-of-00002.safetensors HTTP/1.1" 200 167772160
2024-06-11 12:50:41:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=model-00001-of-00002.safetensors HTTP/1.1" 200 167772160
2024-06-11 12:50:45:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 12:50:46:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=model-00001-of-00002.safetensors HTTP/1.1" 200 167772160
2024-06-11 12:50:50:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 12:50:50:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 12:50:50:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=model-00001-of-00002.safetensors HTTP/1.1" 200 167772160
2024-06-11 12:50:50:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=model-00001-of-00002.safetensors HTTP/1.1" 200 167772160
2024-06-11 12:50:51:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 12:50:51:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=model-00001-of-00002.safetensors HTTP/1.1" 200 167772160
2024-06-11 12:50:54:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 12:50:55:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=model-00001-of-00002.safetensors HTTP/1.1" 200 167772160
2024-06-11 12:50:58:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 12:50:58:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=model-00001-of-00002.safetensors HTTP/1.1" 200 167772160
2024-06-11 12:50:58:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 12:50:59:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=model-00001-of-00002.safetensors HTTP/1.1" 200 167772160
2024-06-11 12:50:59:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 12:50:59:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=model-00001-of-00002.safetensors HTTP/1.1" 200 167772160
2024-06-11 12:51:03:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 12:51:03:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=model-00001-of-00002.safetensors HTTP/1.1" 200 25993088
2024-06-11 12:51:14:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 12:51:14:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 12:51:14:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 12:51:14:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 12:51:14:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=model-00002-of-00002.safetensors HTTP/1.1" 200 167772160
2024-06-11 12:51:14:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=model-00002-of-00002.safetensors HTTP/1.1" 200 167772160
2024-06-11 12:51:14:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=model-00002-of-00002.safetensors HTTP/1.1" 200 167772160
2024-06-11 12:51:14:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=model-00002-of-00002.safetensors HTTP/1.1" 200 167772160
2024-06-11 12:51:20:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 12:51:21:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 12:51:21:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=model-00002-of-00002.safetensors HTTP/1.1" 200 167772160
2024-06-11 12:51:21:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 12:51:21:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=model-00002-of-00002.safetensors HTTP/1.1" 200 167772160
2024-06-11 12:51:21:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=model-00002-of-00002.safetensors HTTP/1.1" 200 167772160
2024-06-11 12:51:23:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 12:51:24:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=model-00002-of-00002.safetensors HTTP/1.1" 200 167772160
2024-06-11 12:51:25:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 12:51:25:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=model-00002-of-00002.safetensors HTTP/1.1" 200 167772160
2024-06-11 12:51:29:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 12:51:29:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=model-00002-of-00002.safetensors HTTP/1.1" 200 124469824
2024-06-11 12:51:34:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 12:51:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=model.safetensors.index.json HTTP/1.1" 200 14706
2024-06-11 12:51:35:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-11 12:51:35:WARNING:Try importing flash-attention for faster inference...
2024-06-11 12:51:35:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-11 12:51:35:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-11 12:51:35:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-11 12:51:38:INFO:trainable params: 1310284 || all params: 1838138956 || trainable%: 0.07128318540461856
2024-06-11 12:51:38:INFO:Init labels...
2024-06-11 12:51:38:INFO:Start training...
2024-06-11 12:51:53:INFO:TRAIN-(cmcm) (1/1/1)>> loss: 1.8845
2024-06-11 12:52:41:INFO:Start running cmcm...
2024-06-11 12:52:41:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-06-11 12:52:41:INFO:Find gpu: 1, with memory: 378273792 left!
2024-06-11 12:52:41:INFO:Let's use the GPU 1 !
2024-06-11 12:52:41:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 12:52:42:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718081562 HTTP/1.1" 200 235
2024-06-11 12:52:42:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 12:52:42:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 12:52:43:INFO:train samples: (1284,)
2024-06-11 12:52:43:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 12:52:44:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718081564 HTTP/1.1" 200 235
2024-06-11 12:52:44:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 12:52:44:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 12:52:45:INFO:valid samples: (229,)
2024-06-11 12:52:45:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 12:52:46:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718081566 HTTP/1.1" 200 235
2024-06-11 12:52:46:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 12:52:46:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 12:52:47:INFO:test samples: (686,)
2024-06-11 12:52:47:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 12:52:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718081567 HTTP/1.1" 200 235
2024-06-11 12:52:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 12:52:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 12:52:48:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 12:52:49:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718081569 HTTP/1.1" 200 235
2024-06-11 12:52:49:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 12:52:49:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 12:52:49:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-11 12:52:49:WARNING:Try importing flash-attention for faster inference...
2024-06-11 12:52:49:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-11 12:52:49:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-11 12:52:49:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-11 12:52:52:INFO:trainable params: 1310284 || all params: 1838138956 || trainable%: 0.07128318540461856
2024-06-11 12:52:52:INFO:Init labels...
2024-06-11 12:52:52:INFO:Start training...
2024-06-11 12:53:07:INFO:TRAIN-(cmcm) (1/1/1)>> loss: 1.8845
2024-06-11 13:04:16:INFO:Start running cmcm...
2024-06-11 13:04:16:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-06-11 13:04:16:INFO:Find gpu: 1, with memory: 378273792 left!
2024-06-11 13:04:16:INFO:Let's use the GPU 1 !
2024-06-11 13:09:09:INFO:Start running cmcm...
2024-06-11 13:09:09:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-06-11 13:09:09:INFO:Find gpu: 1, with memory: 378273792 left!
2024-06-11 13:09:09:INFO:Let's use the GPU 1 !
2024-06-11 13:09:09:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 13:09:09:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718082550 HTTP/1.1" 200 235
2024-06-11 13:09:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 13:09:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 13:09:11:INFO:train samples: (1284,)
2024-06-11 13:09:11:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 13:09:11:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718082551 HTTP/1.1" 200 235
2024-06-11 13:09:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 13:09:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 13:09:12:INFO:valid samples: (229,)
2024-06-11 13:09:13:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 13:09:13:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718082553 HTTP/1.1" 200 235
2024-06-11 13:09:13:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 13:09:14:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 13:09:14:INFO:test samples: (686,)
2024-06-11 13:09:14:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 13:09:15:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718082555 HTTP/1.1" 200 235
2024-06-11 13:09:15:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 13:09:15:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 13:09:16:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 13:09:16:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718082556 HTTP/1.1" 200 235
2024-06-11 13:09:16:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 13:09:17:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 13:09:17:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-11 13:09:17:WARNING:Try importing flash-attention for faster inference...
2024-06-11 13:09:17:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-11 13:09:17:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-11 13:09:17:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-11 13:09:20:INFO:trainable params: 1310284 || all params: 1838138956 || trainable%: 0.07128318540461856
2024-06-11 13:09:20:INFO:Init labels...
2024-06-11 13:09:20:INFO:Start training...
2024-06-11 13:09:35:INFO:TRAIN-(cmcm) (1/1/1)>> loss: 1.8845
2024-06-11 13:09:37:INFO:VAL-(cmcm) >>
2024-06-11 13:09:37:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4767  Non0_acc_2: 0.5833  Non0_F1_score: 0.5191  Mult_acc_5: 0.1921  Mult_acc_7: 0.1528  MAE: 1.6320  Corr: 0.1348 
2024-06-11 13:09:39:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-11 13:09:55:INFO:TRAIN-(cmcm) (1/2/1)>> loss: 0.9272
2024-06-11 13:09:57:INFO:VAL-(cmcm) >>
2024-06-11 13:09:57:INFO:M: >>  Has0_acc_2: 0.6332  Has0_F1_score: 0.6009  Non0_acc_2: 0.6296  Non0_F1_score: 0.5943  Mult_acc_5: 0.1921  Mult_acc_7: 0.1790  MAE: 1.4970  Corr: 0.2294 
2024-06-11 13:09:58:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-11 13:10:13:INFO:TRAIN-(cmcm) (1/3/1)>> loss: 0.8910
2024-06-11 13:10:16:INFO:VAL-(cmcm) >>
2024-06-11 13:10:16:INFO:M: >>  Has0_acc_2: 0.6681  Has0_F1_score: 0.6579  Non0_acc_2: 0.6759  Non0_F1_score: 0.6646  Mult_acc_5: 0.2664  Mult_acc_7: 0.2314  MAE: 1.3114  Corr: 0.3639 
2024-06-11 13:10:17:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-mosi-regression.pth.
2024-06-11 13:10:32:INFO:TRAIN-(cmcm) (1/4/1)>> loss: 0.8625
2024-06-11 13:10:34:INFO:VAL-(cmcm) >>
2024-06-11 13:10:34:INFO:M: >>  Has0_acc_2: 0.7205  Has0_F1_score: 0.7200  Non0_acc_2: 0.7315  Non0_F1_score: 0.7296  Mult_acc_5: 0.3843  Mult_acc_7: 0.2707  MAE: 1.2739  Corr: 0.4655 
2024-06-11 13:10:35:INFO:Saving checkpoint at epoch 4 to results/models/cmcm-mosi-regression.pth.
2024-06-11 13:10:51:INFO:TRAIN-(cmcm) (1/5/1)>> loss: 0.8351
2024-06-11 13:10:53:INFO:VAL-(cmcm) >>
2024-06-11 13:10:53:INFO:M: >>  Has0_acc_2: 0.6943  Has0_F1_score: 0.6907  Non0_acc_2: 0.7176  Non0_F1_score: 0.7125  Mult_acc_5: 0.2795  Mult_acc_7: 0.2402  MAE: 1.1778  Corr: 0.5212 
2024-06-11 13:10:54:INFO:Saving checkpoint at epoch 5 to results/models/cmcm-mosi-regression.pth.
2024-06-11 13:11:09:INFO:TRAIN-(cmcm) (1/6/1)>> loss: 0.8039
2024-06-11 13:11:12:INFO:VAL-(cmcm) >>
2024-06-11 13:11:12:INFO:M: >>  Has0_acc_2: 0.7031  Has0_F1_score: 0.7049  Non0_acc_2: 0.6806  Non0_F1_score: 0.6718  Mult_acc_5: 0.2969  Mult_acc_7: 0.2402  MAE: 1.1787  Corr: 0.5792 
2024-06-11 13:11:27:INFO:TRAIN-(cmcm) (2/7/1)>> loss: 0.8015
2024-06-11 13:11:29:INFO:VAL-(cmcm) >>
2024-06-11 13:11:29:INFO:M: >>  Has0_acc_2: 0.7074  Has0_F1_score: 0.6990  Non0_acc_2: 0.7222  Non0_F1_score: 0.7147  Mult_acc_5: 0.3712  Mult_acc_7: 0.3144  MAE: 1.0651  Corr: 0.5915 
2024-06-11 13:11:30:INFO:Saving checkpoint at epoch 7 to results/models/cmcm-mosi-regression.pth.
2024-06-11 13:11:45:INFO:TRAIN-(cmcm) (1/8/1)>> loss: 0.7861
2024-06-11 13:11:48:INFO:VAL-(cmcm) >>
2024-06-11 13:11:48:INFO:M: >>  Has0_acc_2: 0.7598  Has0_F1_score: 0.7581  Non0_acc_2: 0.7593  Non0_F1_score: 0.7575  Mult_acc_5: 0.4017  Mult_acc_7: 0.3100  MAE: 1.0768  Corr: 0.6103 
2024-06-11 13:12:02:INFO:TRAIN-(cmcm) (2/9/1)>> loss: 0.7804
2024-06-11 13:12:05:INFO:VAL-(cmcm) >>
2024-06-11 13:12:05:INFO:M: >>  Has0_acc_2: 0.7511  Has0_F1_score: 0.7480  Non0_acc_2: 0.7778  Non0_F1_score: 0.7771  Mult_acc_5: 0.3799  Mult_acc_7: 0.3231  MAE: 1.0193  Corr: 0.6169 
2024-06-11 13:12:06:INFO:Saving checkpoint at epoch 9 to results/models/cmcm-mosi-regression.pth.
2024-06-11 13:12:21:INFO:TRAIN-(cmcm) (1/10/1)>> loss: 0.7667
2024-06-11 13:12:23:INFO:VAL-(cmcm) >>
2024-06-11 13:12:23:INFO:M: >>  Has0_acc_2: 0.7511  Has0_F1_score: 0.7529  Non0_acc_2: 0.7778  Non0_F1_score: 0.7789  Mult_acc_5: 0.4279  Mult_acc_7: 0.3275  MAE: 1.0341  Corr: 0.6211 
2024-06-11 13:12:38:INFO:TRAIN-(cmcm) (2/11/1)>> loss: 0.7499
2024-06-11 13:12:41:INFO:VAL-(cmcm) >>
2024-06-11 13:12:41:INFO:M: >>  Has0_acc_2: 0.7336  Has0_F1_score: 0.7329  Non0_acc_2: 0.7222  Non0_F1_score: 0.7229  Mult_acc_5: 0.4017  Mult_acc_7: 0.3275  MAE: 1.0171  Corr: 0.6170 
2024-06-11 13:12:42:INFO:Saving checkpoint at epoch 11 to results/models/cmcm-mosi-regression.pth.
2024-06-11 13:12:57:INFO:TRAIN-(cmcm) (1/12/1)>> loss: 0.7454
2024-06-11 13:12:59:INFO:VAL-(cmcm) >>
2024-06-11 13:12:59:INFO:M: >>  Has0_acc_2: 0.7773  Has0_F1_score: 0.7775  Non0_acc_2: 0.7731  Non0_F1_score: 0.7744  Mult_acc_5: 0.4105  Mult_acc_7: 0.3231  MAE: 1.0101  Corr: 0.6404 
2024-06-11 13:13:00:INFO:Saving checkpoint at epoch 12 to results/models/cmcm-mosi-regression.pth.
2024-06-11 13:13:15:INFO:TRAIN-(cmcm) (1/13/1)>> loss: 0.7309
2024-06-11 13:13:18:INFO:VAL-(cmcm) >>
2024-06-11 13:13:18:INFO:M: >>  Has0_acc_2: 0.7249  Has0_F1_score: 0.7256  Non0_acc_2: 0.7269  Non0_F1_score: 0.7247  Mult_acc_5: 0.3930  Mult_acc_7: 0.3144  MAE: 1.0721  Corr: 0.5790 
2024-06-11 13:13:33:INFO:TRAIN-(cmcm) (2/14/1)>> loss: 0.7241
2024-06-11 13:13:35:INFO:VAL-(cmcm) >>
2024-06-11 13:13:35:INFO:M: >>  Has0_acc_2: 0.7380  Has0_F1_score: 0.7384  Non0_acc_2: 0.8009  Non0_F1_score: 0.8018  Mult_acc_5: 0.4498  Mult_acc_7: 0.3450  MAE: 0.9669  Corr: 0.6533 
2024-06-11 13:13:36:INFO:Saving checkpoint at epoch 14 to results/models/cmcm-mosi-regression.pth.
2024-06-11 13:13:51:INFO:TRAIN-(cmcm) (1/15/1)>> loss: 0.7172
2024-06-11 13:13:54:INFO:VAL-(cmcm) >>
2024-06-11 13:13:54:INFO:M: >>  Has0_acc_2: 0.7293  Has0_F1_score: 0.7105  Non0_acc_2: 0.7269  Non0_F1_score: 0.7071  Mult_acc_5: 0.4323  Mult_acc_7: 0.3275  MAE: 1.0717  Corr: 0.5636 
2024-06-11 13:14:09:INFO:TRAIN-(cmcm) (2/16/1)>> loss: 0.7024
2024-06-11 13:14:11:INFO:VAL-(cmcm) >>
2024-06-11 13:14:11:INFO:M: >>  Has0_acc_2: 0.7424  Has0_F1_score: 0.7448  Non0_acc_2: 0.7546  Non0_F1_score: 0.7551  Mult_acc_5: 0.4236  Mult_acc_7: 0.3319  MAE: 1.0507  Corr: 0.6181 
2024-06-11 13:14:26:INFO:TRAIN-(cmcm) (3/17/1)>> loss: 0.7046
2024-06-11 13:14:28:INFO:VAL-(cmcm) >>
2024-06-11 13:14:28:INFO:M: >>  Has0_acc_2: 0.7074  Has0_F1_score: 0.6880  Non0_acc_2: 0.7269  Non0_F1_score: 0.7156  Mult_acc_5: 0.3668  Mult_acc_7: 0.2795  MAE: 1.1092  Corr: 0.5821 
2024-06-11 13:14:43:INFO:TRAIN-(cmcm) (4/18/1)>> loss: 0.7026
2024-06-11 13:14:46:INFO:VAL-(cmcm) >>
2024-06-11 13:14:46:INFO:M: >>  Has0_acc_2: 0.7686  Has0_F1_score: 0.7691  Non0_acc_2: 0.7778  Non0_F1_score: 0.7774  Mult_acc_5: 0.4498  Mult_acc_7: 0.3406  MAE: 0.9948  Corr: 0.6299 
2024-06-11 13:15:00:INFO:TRAIN-(cmcm) (5/19/1)>> loss: 0.6591
2024-06-11 13:15:03:INFO:VAL-(cmcm) >>
2024-06-11 13:15:03:INFO:M: >>  Has0_acc_2: 0.7991  Has0_F1_score: 0.7991  Non0_acc_2: 0.7824  Non0_F1_score: 0.7830  Mult_acc_5: 0.4105  Mult_acc_7: 0.3144  MAE: 1.0009  Corr: 0.6291 
2024-06-11 13:15:17:INFO:TRAIN-(cmcm) (6/20/1)>> loss: 0.6515
2024-06-11 13:15:20:INFO:VAL-(cmcm) >>
2024-06-11 13:15:20:INFO:M: >>  Has0_acc_2: 0.7991  Has0_F1_score: 0.7991  Non0_acc_2: 0.7917  Non0_F1_score: 0.7923  Mult_acc_5: 0.4454  Mult_acc_7: 0.3581  MAE: 0.9699  Corr: 0.6443 
2024-06-11 13:15:35:INFO:TRAIN-(cmcm) (7/21/1)>> loss: 0.6408
2024-06-11 13:15:37:INFO:VAL-(cmcm) >>
2024-06-11 13:15:37:INFO:M: >>  Has0_acc_2: 0.7686  Has0_F1_score: 0.7704  Non0_acc_2: 0.7778  Non0_F1_score: 0.7771  Mult_acc_5: 0.4585  Mult_acc_7: 0.3581  MAE: 0.9756  Corr: 0.6506 
2024-06-11 13:15:52:INFO:TRAIN-(cmcm) (8/22/1)>> loss: 0.6291
2024-06-11 13:15:54:INFO:VAL-(cmcm) >>
2024-06-11 13:15:54:INFO:M: >>  Has0_acc_2: 0.7467  Has0_F1_score: 0.7357  Non0_acc_2: 0.8009  Non0_F1_score: 0.8020  Mult_acc_5: 0.4279  Mult_acc_7: 0.3493  MAE: 1.0049  Corr: 0.6208 
2024-06-11 13:16:09:INFO:TRAIN-(cmcm) (9/23/1)>> loss: 0.6074
2024-06-11 13:16:12:INFO:VAL-(cmcm) >>
2024-06-11 13:16:12:INFO:M: >>  Has0_acc_2: 0.7555  Has0_F1_score: 0.7479  Non0_acc_2: 0.7731  Non0_F1_score: 0.7736  Mult_acc_5: 0.4323  Mult_acc_7: 0.3406  MAE: 1.0084  Corr: 0.6191 
2024-06-11 13:16:26:INFO:TRAIN-(cmcm) (10/24/1)>> loss: 0.5879
2024-06-11 13:16:29:INFO:VAL-(cmcm) >>
2024-06-11 13:16:29:INFO:M: >>  Has0_acc_2: 0.7642  Has0_F1_score: 0.7638  Non0_acc_2: 0.7639  Non0_F1_score: 0.7640  Mult_acc_5: 0.4017  Mult_acc_7: 0.3057  MAE: 1.0573  Corr: 0.6028 
2024-06-11 13:16:36:INFO:TEST-(cmcm) >>
2024-06-11 13:16:36:INFO:M: >>  Has0_acc_2: 0.7566  Has0_F1_score: 0.7567  Non0_acc_2: 0.7774  Non0_F1_score: 0.7770  Mult_acc_5: 0.4038  Mult_acc_7: 0.3367  MAE: 0.9915  Corr: 0.6158 
2024-06-11 13:16:37:INFO:Results are added to results/results/mosi-regression-30.csv...
2024-06-11 13:16:37:INFO:Start running cmcm...
2024-06-11 13:16:37:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 2222}>
2024-06-11 13:16:37:INFO:Let's use the GPU 1 !
2024-06-11 13:16:37:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 13:16:37:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718082997 HTTP/1.1" 200 235
2024-06-11 13:16:37:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 13:16:38:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 13:16:38:INFO:train samples: (1284,)
2024-06-11 13:16:38:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 13:16:39:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718082999 HTTP/1.1" 200 235
2024-06-11 13:16:39:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 13:16:39:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 13:16:40:INFO:valid samples: (229,)
2024-06-11 13:16:40:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 13:16:40:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718083001 HTTP/1.1" 200 235
2024-06-11 13:16:41:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 13:16:41:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 13:16:42:INFO:test samples: (686,)
2024-06-11 13:16:42:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 13:16:42:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718083002 HTTP/1.1" 200 235
2024-06-11 13:16:42:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 13:16:43:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 13:16:43:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 13:16:43:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718083003 HTTP/1.1" 200 235
2024-06-11 13:16:43:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 13:16:44:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 13:16:44:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-11 13:16:44:WARNING:Try importing flash-attention for faster inference...
2024-06-11 13:16:44:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-11 13:16:44:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-11 13:16:44:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-11 13:16:45:INFO:trainable params: 1310284 || all params: 1838138956 || trainable%: 0.07128318540461856
2024-06-11 13:16:45:INFO:Init labels...
2024-06-11 13:16:45:INFO:Start training...
2024-06-11 13:17:00:INFO:TRAIN-(cmcm) (1/1/2)>> loss: 2.2926
2024-06-11 13:17:03:INFO:VAL-(cmcm) >>
2024-06-11 13:17:03:INFO:M: >>  Has0_acc_2: 0.5240  Has0_F1_score: 0.5205  Non0_acc_2: 0.5278  Non0_F1_score: 0.5244  Mult_acc_5: 0.2227  Mult_acc_7: 0.1790  MAE: 1.7174  Corr: 0.0583 
2024-06-11 13:17:04:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-11 13:17:19:INFO:TRAIN-(cmcm) (1/2/2)>> loss: 0.9163
2024-06-11 13:17:21:INFO:VAL-(cmcm) >>
2024-06-11 13:17:21:INFO:M: >>  Has0_acc_2: 0.4541  Has0_F1_score: 0.3518  Non0_acc_2: 0.4861  Non0_F1_score: 0.3856  Mult_acc_5: 0.1310  Mult_acc_7: 0.1266  MAE: 1.7951  Corr: 0.1972 
2024-06-11 13:17:36:INFO:TRAIN-(cmcm) (2/3/2)>> loss: 0.9023
2024-06-11 13:17:38:INFO:VAL-(cmcm) >>
2024-06-11 13:17:39:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5146  Non0_acc_2: 0.5509  Non0_F1_score: 0.5156  Mult_acc_5: 0.2402  Mult_acc_7: 0.1878  MAE: 1.6333  Corr: 0.0027 
2024-06-11 13:17:39:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-mosi-regression.pth.
2024-06-11 13:17:54:INFO:TRAIN-(cmcm) (1/4/2)>> loss: 0.8816
2024-06-11 13:17:57:INFO:VAL-(cmcm) >>
2024-06-11 13:17:57:INFO:M: >>  Has0_acc_2: 0.5633  Has0_F1_score: 0.5672  Non0_acc_2: 0.5602  Non0_F1_score: 0.5624  Mult_acc_5: 0.2271  Mult_acc_7: 0.1921  MAE: 1.6366  Corr: 0.0758 
2024-06-11 13:18:12:INFO:TRAIN-(cmcm) (2/5/2)>> loss: 0.8718
2024-06-11 13:18:14:INFO:VAL-(cmcm) >>
2024-06-11 13:18:14:INFO:M: >>  Has0_acc_2: 0.5459  Has0_F1_score: 0.5194  Non0_acc_2: 0.5370  Non0_F1_score: 0.5075  Mult_acc_5: 0.1616  Mult_acc_7: 0.1616  MAE: 1.6191  Corr: -0.0051 
2024-06-11 13:18:15:INFO:Saving checkpoint at epoch 5 to results/models/cmcm-mosi-regression.pth.
2024-06-11 13:18:30:INFO:TRAIN-(cmcm) (1/6/2)>> loss: 0.8632
2024-06-11 13:18:33:INFO:VAL-(cmcm) >>
2024-06-11 13:18:33:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.5071  Non0_acc_2: 0.5602  Non0_F1_score: 0.4810  Mult_acc_5: 0.1965  Mult_acc_7: 0.1790  MAE: 1.5453  Corr: -0.0116 
2024-06-11 13:18:33:INFO:Saving checkpoint at epoch 6 to results/models/cmcm-mosi-regression.pth.
2024-06-11 13:18:48:INFO:TRAIN-(cmcm) (1/7/2)>> loss: 0.8598
2024-06-11 13:18:51:INFO:VAL-(cmcm) >>
2024-06-11 13:18:51:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5753  Non0_acc_2: 0.5833  Non0_F1_score: 0.5671  Mult_acc_5: 0.2795  Mult_acc_7: 0.2183  MAE: 1.5961  Corr: 0.1139 
2024-06-11 13:19:06:INFO:TRAIN-(cmcm) (2/8/2)>> loss: 0.8566
2024-06-11 13:19:08:INFO:VAL-(cmcm) >>
2024-06-11 13:19:08:INFO:M: >>  Has0_acc_2: 0.6157  Has0_F1_score: 0.6124  Non0_acc_2: 0.6204  Non0_F1_score: 0.6159  Mult_acc_5: 0.2969  Mult_acc_7: 0.2314  MAE: 1.4804  Corr: 0.1817 
2024-06-11 13:19:09:INFO:Saving checkpoint at epoch 8 to results/models/cmcm-mosi-regression.pth.
2024-06-11 13:19:24:INFO:TRAIN-(cmcm) (1/9/2)>> loss: 0.8471
2024-06-11 13:19:27:INFO:VAL-(cmcm) >>
2024-06-11 13:19:27:INFO:M: >>  Has0_acc_2: 0.4585  Has0_F1_score: 0.3437  Non0_acc_2: 0.4861  Non0_F1_score: 0.3746  Mult_acc_5: 0.1747  Mult_acc_7: 0.1528  MAE: 1.7791  Corr: 0.1469 
2024-06-11 13:19:41:INFO:TRAIN-(cmcm) (2/10/2)>> loss: 0.8407
2024-06-11 13:19:44:INFO:VAL-(cmcm) >>
2024-06-11 13:19:44:INFO:M: >>  Has0_acc_2: 0.6201  Has0_F1_score: 0.5675  Non0_acc_2: 0.6111  Non0_F1_score: 0.5549  Mult_acc_5: 0.3057  Mult_acc_7: 0.2358  MAE: 1.5656  Corr: 0.1549 
2024-06-11 13:19:58:INFO:TRAIN-(cmcm) (3/11/2)>> loss: 0.8310
2024-06-11 13:20:01:INFO:VAL-(cmcm) >>
2024-06-11 13:20:01:INFO:M: >>  Has0_acc_2: 0.6812  Has0_F1_score: 0.6582  Non0_acc_2: 0.6713  Non0_F1_score: 0.6475  Mult_acc_5: 0.3668  Mult_acc_7: 0.2751  MAE: 1.4756  Corr: 0.2896 
2024-06-11 13:20:02:INFO:Saving checkpoint at epoch 11 to results/models/cmcm-mosi-regression.pth.
2024-06-11 13:20:17:INFO:TRAIN-(cmcm) (1/12/2)>> loss: 0.8240
2024-06-11 13:20:19:INFO:VAL-(cmcm) >>
2024-06-11 13:20:19:INFO:M: >>  Has0_acc_2: 0.6900  Has0_F1_score: 0.6897  Non0_acc_2: 0.6944  Non0_F1_score: 0.6929  Mult_acc_5: 0.3188  Mult_acc_7: 0.2489  MAE: 1.2101  Corr: 0.4345 
2024-06-11 13:20:20:INFO:Saving checkpoint at epoch 12 to results/models/cmcm-mosi-regression.pth.
2024-06-11 13:20:35:INFO:TRAIN-(cmcm) (1/13/2)>> loss: 0.8067
2024-06-11 13:20:38:INFO:VAL-(cmcm) >>
2024-06-11 13:20:38:INFO:M: >>  Has0_acc_2: 0.6769  Has0_F1_score: 0.6462  Non0_acc_2: 0.6852  Non0_F1_score: 0.6614  Mult_acc_5: 0.3406  Mult_acc_7: 0.2489  MAE: 1.3961  Corr: 0.3687 
2024-06-11 13:20:53:INFO:TRAIN-(cmcm) (2/14/2)>> loss: 0.8067
2024-06-11 13:20:55:INFO:VAL-(cmcm) >>
2024-06-11 13:20:55:INFO:M: >>  Has0_acc_2: 0.6769  Has0_F1_score: 0.6505  Non0_acc_2: 0.6667  Non0_F1_score: 0.6394  Mult_acc_5: 0.3057  Mult_acc_7: 0.2664  MAE: 1.3529  Corr: 0.3839 
2024-06-11 13:21:10:INFO:TRAIN-(cmcm) (3/15/2)>> loss: 0.7930
2024-06-11 13:21:12:INFO:VAL-(cmcm) >>
2024-06-11 13:21:12:INFO:M: >>  Has0_acc_2: 0.6201  Has0_F1_score: 0.6080  Non0_acc_2: 0.6250  Non0_F1_score: 0.6073  Mult_acc_5: 0.2489  Mult_acc_7: 0.2096  MAE: 1.3250  Corr: 0.4210 
2024-06-11 13:21:27:INFO:TRAIN-(cmcm) (4/16/2)>> loss: 0.7842
2024-06-11 13:21:29:INFO:VAL-(cmcm) >>
2024-06-11 13:21:29:INFO:M: >>  Has0_acc_2: 0.6812  Has0_F1_score: 0.6781  Non0_acc_2: 0.6852  Non0_F1_score: 0.6852  Mult_acc_5: 0.3755  Mult_acc_7: 0.2926  MAE: 1.2014  Corr: 0.4303 
2024-06-11 13:21:30:INFO:Saving checkpoint at epoch 16 to results/models/cmcm-mosi-regression.pth.
2024-06-11 13:21:45:INFO:TRAIN-(cmcm) (1/17/2)>> loss: 0.7748
2024-06-11 13:21:48:INFO:VAL-(cmcm) >>
2024-06-11 13:21:48:INFO:M: >>  Has0_acc_2: 0.6856  Has0_F1_score: 0.6877  Non0_acc_2: 0.7037  Non0_F1_score: 0.7044  Mult_acc_5: 0.3624  Mult_acc_7: 0.2926  MAE: 1.1612  Corr: 0.4853 
2024-06-11 13:21:49:INFO:Saving checkpoint at epoch 17 to results/models/cmcm-mosi-regression.pth.
2024-06-11 13:22:04:INFO:TRAIN-(cmcm) (1/18/2)>> loss: 0.7724
2024-06-11 13:22:06:INFO:VAL-(cmcm) >>
2024-06-11 13:22:06:INFO:M: >>  Has0_acc_2: 0.6856  Has0_F1_score: 0.6803  Non0_acc_2: 0.5648  Non0_F1_score: 0.5298  Mult_acc_5: 0.3188  Mult_acc_7: 0.2751  MAE: 1.2402  Corr: 0.4147 
2024-06-11 13:22:21:INFO:TRAIN-(cmcm) (2/19/2)>> loss: 0.7504
2024-06-11 13:22:23:INFO:VAL-(cmcm) >>
2024-06-11 13:22:23:INFO:M: >>  Has0_acc_2: 0.6812  Has0_F1_score: 0.6832  Non0_acc_2: 0.5972  Non0_F1_score: 0.5817  Mult_acc_5: 0.3581  Mult_acc_7: 0.3013  MAE: 1.2218  Corr: 0.4476 
2024-06-11 13:22:38:INFO:TRAIN-(cmcm) (3/20/2)>> loss: 0.7557
2024-06-11 13:22:41:INFO:VAL-(cmcm) >>
2024-06-11 13:22:41:INFO:M: >>  Has0_acc_2: 0.6856  Has0_F1_score: 0.6850  Non0_acc_2: 0.6852  Non0_F1_score: 0.6856  Mult_acc_5: 0.4192  Mult_acc_7: 0.3188  MAE: 1.1996  Corr: 0.4474 
2024-06-11 13:22:55:INFO:TRAIN-(cmcm) (4/21/2)>> loss: 0.7356
2024-06-11 13:22:58:INFO:VAL-(cmcm) >>
2024-06-11 13:22:58:INFO:M: >>  Has0_acc_2: 0.6681  Has0_F1_score: 0.6692  Non0_acc_2: 0.6759  Non0_F1_score: 0.6777  Mult_acc_5: 0.3886  Mult_acc_7: 0.3057  MAE: 1.1970  Corr: 0.4396 
2024-06-11 13:23:12:INFO:TRAIN-(cmcm) (5/22/2)>> loss: 0.7253
2024-06-11 13:23:15:INFO:VAL-(cmcm) >>
2024-06-11 13:23:15:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5794  Non0_acc_2: 0.6250  Non0_F1_score: 0.6120  Mult_acc_5: 0.3057  Mult_acc_7: 0.2140  MAE: 1.4900  Corr: 0.4104 
2024-06-11 13:23:30:INFO:TRAIN-(cmcm) (6/23/2)>> loss: 0.7153
2024-06-11 13:23:32:INFO:VAL-(cmcm) >>
2024-06-11 13:23:32:INFO:M: >>  Has0_acc_2: 0.6856  Has0_F1_score: 0.6793  Non0_acc_2: 0.6944  Non0_F1_score: 0.6872  Mult_acc_5: 0.3755  Mult_acc_7: 0.2926  MAE: 1.2525  Corr: 0.4137 
2024-06-11 13:23:47:INFO:TRAIN-(cmcm) (7/24/2)>> loss: 0.7064
2024-06-11 13:23:49:INFO:VAL-(cmcm) >>
2024-06-11 13:23:49:INFO:M: >>  Has0_acc_2: 0.6812  Has0_F1_score: 0.6822  Non0_acc_2: 0.7037  Non0_F1_score: 0.7033  Mult_acc_5: 0.3799  Mult_acc_7: 0.2838  MAE: 1.2590  Corr: 0.4989 
2024-06-11 13:24:04:INFO:TRAIN-(cmcm) (8/25/2)>> loss: 0.6927
2024-06-11 13:24:06:INFO:VAL-(cmcm) >>
2024-06-11 13:24:07:INFO:M: >>  Has0_acc_2: 0.6769  Has0_F1_score: 0.6733  Non0_acc_2: 0.6852  Non0_F1_score: 0.6815  Mult_acc_5: 0.4105  Mult_acc_7: 0.3319  MAE: 1.2405  Corr: 0.4064 
2024-06-11 13:24:21:INFO:TRAIN-(cmcm) (9/26/2)>> loss: 0.6823
2024-06-11 13:24:24:INFO:VAL-(cmcm) >>
2024-06-11 13:24:24:INFO:M: >>  Has0_acc_2: 0.6638  Has0_F1_score: 0.6670  Non0_acc_2: 0.7083  Non0_F1_score: 0.7096  Mult_acc_5: 0.3755  Mult_acc_7: 0.2926  MAE: 1.2331  Corr: 0.4507 
2024-06-11 13:24:38:INFO:TRAIN-(cmcm) (10/27/2)>> loss: 0.6733
2024-06-11 13:24:41:INFO:VAL-(cmcm) >>
2024-06-11 13:24:41:INFO:M: >>  Has0_acc_2: 0.6769  Has0_F1_score: 0.6769  Non0_acc_2: 0.7222  Non0_F1_score: 0.7226  Mult_acc_5: 0.4279  Mult_acc_7: 0.3450  MAE: 1.1672  Corr: 0.4655 
2024-06-11 13:24:48:INFO:TEST-(cmcm) >>
2024-06-11 13:24:48:INFO:M: >>  Has0_acc_2: 0.7070  Has0_F1_score: 0.7077  Non0_acc_2: 0.7439  Non0_F1_score: 0.7396  Mult_acc_5: 0.3222  Mult_acc_7: 0.2886  MAE: 1.1600  Corr: 0.5253 
2024-06-11 13:24:49:INFO:Results are added to results/results/mosi-regression-30.csv...
2024-06-11 13:24:49:INFO:Start running cmcm...
2024-06-11 13:24:49:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 3333}>
2024-06-11 13:24:49:INFO:Let's use the GPU 1 !
2024-06-11 13:24:49:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 13:24:49:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718083489 HTTP/1.1" 200 235
2024-06-11 13:24:49:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 13:24:50:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 13:24:50:INFO:train samples: (1284,)
2024-06-11 13:24:51:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 13:24:51:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718083491 HTTP/1.1" 200 235
2024-06-11 13:24:51:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 13:24:52:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 13:24:52:INFO:valid samples: (229,)
2024-06-11 13:24:52:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 13:24:52:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718083493 HTTP/1.1" 200 235
2024-06-11 13:24:53:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 13:24:53:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 13:24:54:INFO:test samples: (686,)
2024-06-11 13:24:54:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 13:24:54:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718083494 HTTP/1.1" 200 235
2024-06-11 13:24:54:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 13:24:55:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 13:24:55:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 13:24:56:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718083496 HTTP/1.1" 200 235
2024-06-11 13:24:56:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 13:24:56:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 13:24:56:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-11 13:24:56:WARNING:Try importing flash-attention for faster inference...
2024-06-11 13:24:56:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-11 13:24:56:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-11 13:24:56:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-11 13:24:58:INFO:trainable params: 1310284 || all params: 1838138956 || trainable%: 0.07128318540461856
2024-06-11 13:24:58:INFO:Init labels...
2024-06-11 13:24:58:INFO:Start training...
2024-06-11 13:25:13:INFO:TRAIN-(cmcm) (1/1/3)>> loss: 2.7764
2024-06-11 13:25:15:INFO:VAL-(cmcm) >>
2024-06-11 13:25:15:INFO:M: >>  Has0_acc_2: 0.4454  Has0_F1_score: 0.4366  Non0_acc_2: 0.4676  Non0_F1_score: 0.4263  Mult_acc_5: 0.1310  Mult_acc_7: 0.1223  MAE: 2.1017  Corr: -0.0386 
2024-06-11 13:25:16:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-11 13:25:31:INFO:TRAIN-(cmcm) (1/2/3)>> loss: 0.9588
2024-06-11 13:25:34:INFO:VAL-(cmcm) >>
2024-06-11 13:25:34:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.4897  Non0_acc_2: 0.5000  Non0_F1_score: 0.4953  Mult_acc_5: 0.2183  Mult_acc_7: 0.2183  MAE: 1.5344  Corr: -0.0225 
2024-06-11 13:25:35:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-11 13:25:50:INFO:TRAIN-(cmcm) (1/3/3)>> loss: 0.9120
2024-06-11 13:25:52:INFO:VAL-(cmcm) >>
2024-06-11 13:25:52:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5741  Non0_F1_score: 0.4187  Mult_acc_5: 0.2926  Mult_acc_7: 0.2140  MAE: 1.7145  Corr: -0.0337 
2024-06-11 13:26:07:INFO:TRAIN-(cmcm) (2/4/3)>> loss: 0.8905
2024-06-11 13:26:09:INFO:VAL-(cmcm) >>
2024-06-11 13:26:09:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5189  Non0_acc_2: 0.5278  Non0_F1_score: 0.4977  Mult_acc_5: 0.1790  Mult_acc_7: 0.1747  MAE: 1.5392  Corr: -0.0317 
2024-06-11 13:26:24:INFO:TRAIN-(cmcm) (3/5/3)>> loss: 0.8867
2024-06-11 13:26:27:INFO:VAL-(cmcm) >>
2024-06-11 13:26:27:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5439  Non0_acc_2: 0.5370  Non0_F1_score: 0.5227  Mult_acc_5: 0.2183  Mult_acc_7: 0.2052  MAE: 1.4822  Corr: 0.0449 
2024-06-11 13:26:27:INFO:Saving checkpoint at epoch 5 to results/models/cmcm-mosi-regression.pth.
2024-06-11 13:26:43:INFO:TRAIN-(cmcm) (1/6/3)>> loss: 0.8840
2024-06-11 13:26:45:INFO:VAL-(cmcm) >>
2024-06-11 13:26:45:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4917  Non0_acc_2: 0.5787  Non0_F1_score: 0.4649  Mult_acc_5: 0.2620  Mult_acc_7: 0.2009  MAE: 1.6328  Corr: 0.0090 
2024-06-11 13:27:00:INFO:TRAIN-(cmcm) (2/7/3)>> loss: 0.8754
2024-06-11 13:27:02:INFO:VAL-(cmcm) >>
2024-06-11 13:27:02:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.5099  Non0_acc_2: 0.5602  Non0_F1_score: 0.4902  Mult_acc_5: 0.2096  Mult_acc_7: 0.1921  MAE: 1.6135  Corr: -0.0302 
2024-06-11 13:27:17:INFO:TRAIN-(cmcm) (3/8/3)>> loss: 0.8662
2024-06-11 13:27:20:INFO:VAL-(cmcm) >>
2024-06-11 13:27:20:INFO:M: >>  Has0_acc_2: 0.5633  Has0_F1_score: 0.4926  Non0_acc_2: 0.5463  Non0_F1_score: 0.4718  Mult_acc_5: 0.2795  Mult_acc_7: 0.1965  MAE: 1.7416  Corr: -0.0401 
2024-06-11 13:27:34:INFO:TRAIN-(cmcm) (4/9/3)>> loss: 0.8588
2024-06-11 13:27:37:INFO:VAL-(cmcm) >>
2024-06-11 13:27:37:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.4920  Non0_acc_2: 0.4769  Non0_F1_score: 0.4772  Mult_acc_5: 0.2358  Mult_acc_7: 0.1921  MAE: 1.5800  Corr: 0.0209 
2024-06-11 13:27:51:INFO:TRAIN-(cmcm) (5/10/3)>> loss: 0.8572
2024-06-11 13:27:54:INFO:VAL-(cmcm) >>
2024-06-11 13:27:54:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5741  Non0_F1_score: 0.4187  Mult_acc_5: 0.2402  Mult_acc_7: 0.1965  MAE: 1.6953  Corr: -0.0555 
2024-06-11 13:28:09:INFO:TRAIN-(cmcm) (6/11/3)>> loss: 0.8530
2024-06-11 13:28:11:INFO:VAL-(cmcm) >>
2024-06-11 13:28:11:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.5099  Non0_acc_2: 0.5602  Non0_F1_score: 0.4902  Mult_acc_5: 0.2489  Mult_acc_7: 0.1703  MAE: 1.6944  Corr: 0.0442 
2024-06-11 13:28:26:INFO:TRAIN-(cmcm) (7/12/3)>> loss: 0.8529
2024-06-11 13:28:28:INFO:VAL-(cmcm) >>
2024-06-11 13:28:28:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5081  Non0_acc_2: 0.5787  Non0_F1_score: 0.5339  Mult_acc_5: 0.2402  Mult_acc_7: 0.1703  MAE: 1.5961  Corr: 0.0172 
2024-06-11 13:28:43:INFO:TRAIN-(cmcm) (8/13/3)>> loss: 0.8474
2024-06-11 13:28:46:INFO:VAL-(cmcm) >>
2024-06-11 13:28:46:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.5292  Non0_acc_2: 0.5787  Non0_F1_score: 0.5074  Mult_acc_5: 0.2664  Mult_acc_7: 0.1921  MAE: 1.7883  Corr: -0.0003 
2024-06-11 13:29:00:INFO:TRAIN-(cmcm) (9/14/3)>> loss: 0.8403
2024-06-11 13:29:03:INFO:VAL-(cmcm) >>
2024-06-11 13:29:03:INFO:M: >>  Has0_acc_2: 0.6157  Has0_F1_score: 0.5222  Non0_acc_2: 0.5880  Non0_F1_score: 0.5044  Mult_acc_5: 0.3013  Mult_acc_7: 0.2183  MAE: 1.7547  Corr: 0.0450 
2024-06-11 13:29:17:INFO:TRAIN-(cmcm) (10/15/3)>> loss: 0.8417
2024-06-11 13:29:20:INFO:VAL-(cmcm) >>
2024-06-11 13:29:20:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5261  Non0_acc_2: 0.5602  Non0_F1_score: 0.5256  Mult_acc_5: 0.2445  Mult_acc_7: 0.2052  MAE: 1.6237  Corr: 0.0306 
2024-06-11 13:29:27:INFO:TEST-(cmcm) >>
2024-06-11 13:29:27:INFO:M: >>  Has0_acc_2: 0.5335  Has0_F1_score: 0.5051  Non0_acc_2: 0.5351  Non0_F1_score: 0.5275  Mult_acc_5: 0.2216  Mult_acc_7: 0.2187  MAE: 1.5111  Corr: 0.0952 
2024-06-11 13:29:28:INFO:Results are added to results/results/mosi-regression-30.csv...
2024-06-11 13:29:28:INFO:Start running cmcm...
2024-06-11 13:29:28:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 4444}>
2024-06-11 13:29:28:INFO:Let's use the GPU 1 !
2024-06-11 13:29:28:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 13:29:28:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718083768 HTTP/1.1" 200 235
2024-06-11 13:29:28:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 13:29:29:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 13:29:30:INFO:train samples: (1284,)
2024-06-11 13:29:30:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 13:29:30:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718083770 HTTP/1.1" 200 235
2024-06-11 13:29:30:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 13:29:31:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 13:29:31:INFO:valid samples: (229,)
2024-06-11 13:29:31:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 13:29:32:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718083772 HTTP/1.1" 200 235
2024-06-11 13:29:32:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 13:29:32:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 13:29:33:INFO:test samples: (686,)
2024-06-11 13:29:33:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 13:29:33:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718083773 HTTP/1.1" 200 235
2024-06-11 13:29:33:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 13:29:34:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 13:29:34:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 13:29:34:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718083775 HTTP/1.1" 200 235
2024-06-11 13:29:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 13:29:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 13:29:35:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-11 13:29:35:WARNING:Try importing flash-attention for faster inference...
2024-06-11 13:29:35:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-11 13:29:35:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-11 13:29:35:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-11 13:29:36:INFO:trainable params: 1310284 || all params: 1838138956 || trainable%: 0.07128318540461856
2024-06-11 13:29:36:INFO:Init labels...
2024-06-11 13:29:36:INFO:Start training...
2024-06-11 13:29:51:INFO:TRAIN-(cmcm) (1/1/4)>> loss: 4.2273
2024-06-11 13:29:54:INFO:VAL-(cmcm) >>
2024-06-11 13:29:54:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4259  Non0_F1_score: 0.2544  Mult_acc_5: 0.2140  Mult_acc_7: 0.2140  MAE: 1.4370  Corr: nan 
2024-06-11 13:29:54:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-11 13:30:09:INFO:TRAIN-(cmcm) (1/2/4)>> loss: 1.5321
2024-06-11 13:30:11:INFO:VAL-(cmcm) >>
2024-06-11 13:30:11:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5741  Non0_F1_score: 0.4346  Mult_acc_5: 0.1703  Mult_acc_7: 0.1703  MAE: 1.4790  Corr: 0.0300 
2024-06-11 13:30:26:INFO:TRAIN-(cmcm) (2/3/4)>> loss: 0.9265
2024-06-11 13:30:29:INFO:VAL-(cmcm) >>
2024-06-11 13:30:29:INFO:M: >>  Has0_acc_2: 0.5066  Has0_F1_score: 0.5001  Non0_acc_2: 0.5231  Non0_F1_score: 0.5159  Mult_acc_5: 0.2314  Mult_acc_7: 0.1747  MAE: 1.8865  Corr: 0.0513 
2024-06-11 13:30:43:INFO:TRAIN-(cmcm) (3/4/4)>> loss: 0.8936
2024-06-11 13:30:46:INFO:VAL-(cmcm) >>
2024-06-11 13:30:46:INFO:M: >>  Has0_acc_2: 0.5590  Has0_F1_score: 0.4980  Non0_acc_2: 0.5417  Non0_F1_score: 0.4775  Mult_acc_5: 0.1790  Mult_acc_7: 0.1703  MAE: 1.7493  Corr: -0.0785 
2024-06-11 13:31:00:INFO:TRAIN-(cmcm) (4/5/4)>> loss: 0.8828
2024-06-11 13:31:03:INFO:VAL-(cmcm) >>
2024-06-11 13:31:03:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.5352  Non0_acc_2: 0.5787  Non0_F1_score: 0.5235  Mult_acc_5: 0.3100  Mult_acc_7: 0.2358  MAE: 1.6795  Corr: 0.0514 
2024-06-11 13:31:18:INFO:TRAIN-(cmcm) (5/6/4)>> loss: 0.8749
2024-06-11 13:31:20:INFO:VAL-(cmcm) >>
2024-06-11 13:31:20:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4855  Non0_acc_2: 0.5787  Non0_F1_score: 0.4584  Mult_acc_5: 0.2576  Mult_acc_7: 0.2271  MAE: 1.5130  Corr: 0.0181 
2024-06-11 13:31:35:INFO:TRAIN-(cmcm) (6/7/4)>> loss: 0.8657
2024-06-11 13:31:37:INFO:VAL-(cmcm) >>
2024-06-11 13:31:37:INFO:M: >>  Has0_acc_2: 0.5502  Has0_F1_score: 0.5541  Non0_acc_2: 0.5556  Non0_F1_score: 0.5574  Mult_acc_5: 0.2489  Mult_acc_7: 0.1747  MAE: 1.8065  Corr: 0.0420 
2024-06-11 13:31:52:INFO:TRAIN-(cmcm) (7/8/4)>> loss: 0.8551
2024-06-11 13:31:55:INFO:VAL-(cmcm) >>
2024-06-11 13:31:55:INFO:M: >>  Has0_acc_2: 0.5371  Has0_F1_score: 0.5382  Non0_acc_2: 0.5463  Non0_F1_score: 0.5456  Mult_acc_5: 0.2576  Mult_acc_7: 0.2096  MAE: 1.6241  Corr: 0.0838 
2024-06-11 13:32:09:INFO:TRAIN-(cmcm) (8/9/4)>> loss: 0.8497
2024-06-11 13:32:12:INFO:VAL-(cmcm) >>
2024-06-11 13:32:12:INFO:M: >>  Has0_acc_2: 0.6507  Has0_F1_score: 0.6175  Non0_acc_2: 0.6157  Non0_F1_score: 0.5999  Mult_acc_5: 0.3057  Mult_acc_7: 0.2533  MAE: 1.4506  Corr: 0.1289 
2024-06-11 13:32:27:INFO:TRAIN-(cmcm) (9/10/4)>> loss: 0.8366
2024-06-11 13:32:29:INFO:VAL-(cmcm) >>
2024-06-11 13:32:29:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5494  Non0_acc_2: 0.5648  Non0_F1_score: 0.5395  Mult_acc_5: 0.2795  Mult_acc_7: 0.2096  MAE: 1.6931  Corr: 0.0491 
2024-06-11 13:32:44:INFO:TRAIN-(cmcm) (10/11/4)>> loss: 0.8389
2024-06-11 13:32:46:INFO:VAL-(cmcm) >>
2024-06-11 13:32:46:INFO:M: >>  Has0_acc_2: 0.6419  Has0_F1_score: 0.6323  Non0_acc_2: 0.6435  Non0_F1_score: 0.6345  Mult_acc_5: 0.2969  Mult_acc_7: 0.2227  MAE: 1.5407  Corr: 0.1912 
2024-06-11 13:32:54:INFO:TEST-(cmcm) >>
2024-06-11 13:32:54:INFO:M: >>  Has0_acc_2: 0.4475  Has0_F1_score: 0.2767  Non0_acc_2: 0.5777  Non0_F1_score: 0.4231  Mult_acc_5: 0.1545  Mult_acc_7: 0.1545  MAE: 1.4174  Corr: nan 
2024-06-11 13:32:54:INFO:Results are added to results/results/mosi-regression-30.csv...
2024-06-11 13:32:54:INFO:Start running cmcm...
2024-06-11 13:32:54:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 5555}>
2024-06-11 13:32:54:INFO:Let's use the GPU 1 !
2024-06-11 13:32:54:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 13:32:54:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718083975 HTTP/1.1" 200 235
2024-06-11 13:32:55:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 13:32:55:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 13:32:56:INFO:train samples: (1284,)
2024-06-11 13:32:56:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 13:32:56:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718083976 HTTP/1.1" 200 235
2024-06-11 13:32:56:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 13:32:57:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 13:32:57:INFO:valid samples: (229,)
2024-06-11 13:32:57:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 13:32:57:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718083978 HTTP/1.1" 200 235
2024-06-11 13:32:58:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 13:32:58:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 13:32:59:INFO:test samples: (686,)
2024-06-11 13:32:59:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 13:32:59:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718083979 HTTP/1.1" 200 235
2024-06-11 13:32:59:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 13:33:00:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 13:33:00:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 13:33:00:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718083981 HTTP/1.1" 200 235
2024-06-11 13:33:01:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 13:33:01:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 13:33:01:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-11 13:33:01:WARNING:Try importing flash-attention for faster inference...
2024-06-11 13:33:01:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-11 13:33:01:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-11 13:33:01:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-11 13:33:02:INFO:trainable params: 1310284 || all params: 1838138956 || trainable%: 0.07128318540461856
2024-06-11 13:33:02:INFO:Init labels...
2024-06-11 13:33:02:INFO:Start training...
2024-06-11 13:33:17:INFO:TRAIN-(cmcm) (1/1/5)>> loss: 1.8915
2024-06-11 13:33:19:INFO:VAL-(cmcm) >>
2024-06-11 13:33:19:INFO:M: >>  Has0_acc_2: 0.4017  Has0_F1_score: 0.2451  Non0_acc_2: 0.4213  Non0_F1_score: 0.2604  Mult_acc_5: 0.1834  Mult_acc_7: 0.1834  MAE: 1.6126  Corr: -0.0673 
2024-06-11 13:33:20:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-11 13:33:35:INFO:TRAIN-(cmcm) (1/2/5)>> loss: 0.9600
2024-06-11 13:33:37:INFO:VAL-(cmcm) >>
2024-06-11 13:33:37:INFO:M: >>  Has0_acc_2: 0.4017  Has0_F1_score: 0.2521  Non0_acc_2: 0.4259  Non0_F1_score: 0.2775  Mult_acc_5: 0.1354  Mult_acc_7: 0.1354  MAE: 1.8659  Corr: -0.1586 
2024-06-11 13:33:52:INFO:TRAIN-(cmcm) (2/3/5)>> loss: 0.9210
2024-06-11 13:33:54:INFO:VAL-(cmcm) >>
2024-06-11 13:33:54:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4630  Non0_acc_2: 0.5741  Non0_F1_score: 0.4346  Mult_acc_5: 0.2489  Mult_acc_7: 0.2227  MAE: 1.6074  Corr: 0.0482 
2024-06-11 13:33:55:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-mosi-regression.pth.
2024-06-11 13:34:10:INFO:TRAIN-(cmcm) (1/4/5)>> loss: 0.8806
2024-06-11 13:34:12:INFO:VAL-(cmcm) >>
2024-06-11 13:34:12:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.4943  Non0_acc_2: 0.5833  Non0_F1_score: 0.4676  Mult_acc_5: 0.2140  Mult_acc_7: 0.1834  MAE: 1.6305  Corr: 0.0417 
2024-06-11 13:34:27:INFO:TRAIN-(cmcm) (2/5/5)>> loss: 0.8683
2024-06-11 13:34:29:INFO:VAL-(cmcm) >>
2024-06-11 13:34:29:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4767  Non0_acc_2: 0.5741  Non0_F1_score: 0.4491  Mult_acc_5: 0.1790  Mult_acc_7: 0.1790  MAE: 1.4589  Corr: 0.0492 
2024-06-11 13:34:30:INFO:Saving checkpoint at epoch 5 to results/models/cmcm-mosi-regression.pth.
2024-06-11 13:34:45:INFO:TRAIN-(cmcm) (1/6/5)>> loss: 0.8683
2024-06-11 13:34:47:INFO:VAL-(cmcm) >>
2024-06-11 13:34:47:INFO:M: >>  Has0_acc_2: 0.5633  Has0_F1_score: 0.5423  Non0_acc_2: 0.5509  Non0_F1_score: 0.5282  Mult_acc_5: 0.2926  Mult_acc_7: 0.2140  MAE: 1.7140  Corr: 0.0238 
2024-06-11 13:35:02:INFO:TRAIN-(cmcm) (2/7/5)>> loss: 0.8641
2024-06-11 13:35:04:INFO:VAL-(cmcm) >>
2024-06-11 13:35:04:INFO:M: >>  Has0_acc_2: 0.4847  Has0_F1_score: 0.4851  Non0_acc_2: 0.5000  Non0_F1_score: 0.4993  Mult_acc_5: 0.2271  Mult_acc_7: 0.1616  MAE: 1.7529  Corr: 0.0022 
2024-06-11 13:35:19:INFO:TRAIN-(cmcm) (3/8/5)>> loss: 0.8611
2024-06-11 13:35:22:INFO:VAL-(cmcm) >>
2024-06-11 13:35:22:INFO:M: >>  Has0_acc_2: 0.5153  Has0_F1_score: 0.5153  Non0_acc_2: 0.5231  Non0_F1_score: 0.5213  Mult_acc_5: 0.2707  Mult_acc_7: 0.2140  MAE: 1.5977  Corr: 0.0722 
2024-06-11 13:35:36:INFO:TRAIN-(cmcm) (4/9/5)>> loss: 0.8618
2024-06-11 13:35:39:INFO:VAL-(cmcm) >>
2024-06-11 13:35:39:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.5178  Non0_acc_2: 0.5556  Non0_F1_score: 0.4954  Mult_acc_5: 0.2882  Mult_acc_7: 0.2096  MAE: 1.7582  Corr: -0.0143 
2024-06-11 13:35:53:INFO:TRAIN-(cmcm) (5/10/5)>> loss: 0.8560
2024-06-11 13:35:56:INFO:VAL-(cmcm) >>
2024-06-11 13:35:56:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5042  Non0_acc_2: 0.5602  Non0_F1_score: 0.4810  Mult_acc_5: 0.2969  Mult_acc_7: 0.2183  MAE: 1.7092  Corr: -0.0246 
2024-06-11 13:36:11:INFO:TRAIN-(cmcm) (6/11/5)>> loss: 0.8502
2024-06-11 13:36:13:INFO:VAL-(cmcm) >>
2024-06-11 13:36:13:INFO:M: >>  Has0_acc_2: 0.5153  Has0_F1_score: 0.5199  Non0_acc_2: 0.5231  Non0_F1_score: 0.5255  Mult_acc_5: 0.2445  Mult_acc_7: 0.1747  MAE: 1.7079  Corr: 0.0855 
2024-06-11 13:36:28:INFO:TRAIN-(cmcm) (7/12/5)>> loss: 0.8512
2024-06-11 13:36:30:INFO:VAL-(cmcm) >>
2024-06-11 13:36:30:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4791  Non0_acc_2: 0.5741  Non0_F1_score: 0.4491  Mult_acc_5: 0.2751  Mult_acc_7: 0.2052  MAE: 1.6852  Corr: 0.0395 
2024-06-11 13:36:45:INFO:TRAIN-(cmcm) (8/13/5)>> loss: 0.8473
2024-06-11 13:36:47:INFO:VAL-(cmcm) >>
2024-06-11 13:36:47:INFO:M: >>  Has0_acc_2: 0.5197  Has0_F1_score: 0.5242  Non0_acc_2: 0.5278  Non0_F1_score: 0.5300  Mult_acc_5: 0.2620  Mult_acc_7: 0.1921  MAE: 1.6870  Corr: 0.0725 
2024-06-11 13:37:02:INFO:TRAIN-(cmcm) (9/14/5)>> loss: 0.8439
2024-06-11 13:37:05:INFO:VAL-(cmcm) >>
2024-06-11 13:37:05:INFO:M: >>  Has0_acc_2: 0.5590  Has0_F1_score: 0.5609  Non0_acc_2: 0.5787  Non0_F1_score: 0.5795  Mult_acc_5: 0.2838  Mult_acc_7: 0.2096  MAE: 1.7267  Corr: 0.1546 
2024-06-11 13:37:19:INFO:TRAIN-(cmcm) (10/15/5)>> loss: 0.8434
2024-06-11 13:37:22:INFO:VAL-(cmcm) >>
2024-06-11 13:37:22:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.5669  Non0_acc_2: 0.5880  Non0_F1_score: 0.5581  Mult_acc_5: 0.3362  Mult_acc_7: 0.2664  MAE: 1.5507  Corr: 0.1478 
2024-06-11 13:37:29:INFO:TEST-(cmcm) >>
2024-06-11 13:37:29:INFO:M: >>  Has0_acc_2: 0.4810  Has0_F1_score: 0.3644  Non0_acc_2: 0.4573  Non0_F1_score: 0.3418  Mult_acc_5: 0.1851  Mult_acc_7: 0.1851  MAE: 1.6379  Corr: 0.1108 
2024-06-11 13:37:30:INFO:Results are added to results/results/mosi-regression-30.csv...
2024-06-11 14:06:46:INFO:Start running cmcm...
2024-06-11 14:06:46:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-06-11 14:06:46:INFO:Find gpu: 1, with memory: 378273792 left!
2024-06-11 14:06:46:INFO:Let's use the GPU 1 !
2024-06-11 14:06:46:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 14:06:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718086007 HTTP/1.1" 200 235
2024-06-11 14:06:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 14:06:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 14:06:49:INFO:train samples: (1284,)
2024-06-11 14:06:49:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 14:06:49:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718086010 HTTP/1.1" 200 235
2024-06-11 14:06:50:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 14:06:50:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 14:06:51:INFO:valid samples: (229,)
2024-06-11 14:06:51:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 14:06:52:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718086012 HTTP/1.1" 200 235
2024-06-11 14:06:52:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 14:06:52:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 14:06:53:INFO:test samples: (686,)
2024-06-11 14:06:53:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 14:06:53:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718086013 HTTP/1.1" 200 235
2024-06-11 14:06:53:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 14:06:54:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 14:06:54:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 14:06:55:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718086015 HTTP/1.1" 200 235
2024-06-11 14:06:55:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 14:06:55:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 14:06:55:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-11 14:06:55:WARNING:Try importing flash-attention for faster inference...
2024-06-11 14:06:55:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-11 14:06:55:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-11 14:06:55:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-11 14:06:58:INFO:trainable params: 1310284 || all params: 1838138956 || trainable%: 0.07128318540461856
2024-06-11 14:06:58:INFO:Init labels...
2024-06-11 14:06:58:INFO:Start training...
2024-06-11 14:07:13:INFO:TRAIN-(cmcm) (1/1/1)>> loss: 2.9528
2024-06-11 14:07:15:INFO:VAL-(cmcm) >>
2024-06-11 14:07:15:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5315  Non0_acc_2: 0.5463  Non0_F1_score: 0.5148  Mult_acc_5: 0.1790  Mult_acc_7: 0.1790  MAE: 1.4973  Corr: 0.0028 
2024-06-11 14:07:17:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-11 14:07:32:INFO:TRAIN-(cmcm) (1/2/1)>> loss: 1.0199
2024-06-11 14:07:35:INFO:VAL-(cmcm) >>
2024-06-11 14:07:35:INFO:M: >>  Has0_acc_2: 0.5109  Has0_F1_score: 0.5128  Non0_acc_2: 0.5185  Non0_F1_score: 0.5185  Mult_acc_5: 0.2664  Mult_acc_7: 0.2052  MAE: 1.8494  Corr: 0.0432 
2024-06-11 14:07:50:INFO:TRAIN-(cmcm) (2/3/1)>> loss: 0.9270
2024-06-11 14:07:52:INFO:VAL-(cmcm) >>
2024-06-11 14:07:52:INFO:M: >>  Has0_acc_2: 0.5459  Has0_F1_score: 0.5144  Non0_acc_2: 0.5370  Non0_F1_score: 0.5049  Mult_acc_5: 0.2052  Mult_acc_7: 0.1747  MAE: 1.6069  Corr: -0.0139 
2024-06-11 14:08:07:INFO:TRAIN-(cmcm) (3/4/1)>> loss: 0.9068
2024-06-11 14:08:09:INFO:VAL-(cmcm) >>
2024-06-11 14:08:09:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.5292  Non0_acc_2: 0.5787  Non0_F1_score: 0.5117  Mult_acc_5: 0.1878  Mult_acc_7: 0.1659  MAE: 1.6411  Corr: 0.0011 
2024-06-11 14:08:24:INFO:TRAIN-(cmcm) (4/5/1)>> loss: 0.9022
2024-06-11 14:08:26:INFO:VAL-(cmcm) >>
2024-06-11 14:08:26:INFO:M: >>  Has0_acc_2: 0.5459  Has0_F1_score: 0.5499  Non0_acc_2: 0.5463  Non0_F1_score: 0.5485  Mult_acc_5: 0.2751  Mult_acc_7: 0.2052  MAE: 1.7023  Corr: 0.1000 
2024-06-11 14:08:41:INFO:TRAIN-(cmcm) (5/6/1)>> loss: 0.8785
2024-06-11 14:08:43:INFO:VAL-(cmcm) >>
2024-06-11 14:08:43:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5721  Non0_acc_2: 0.5648  Non0_F1_score: 0.5634  Mult_acc_5: 0.2096  Mult_acc_7: 0.1921  MAE: 1.5877  Corr: 0.1367 
2024-06-11 14:08:58:INFO:TRAIN-(cmcm) (6/7/1)>> loss: 0.8701
2024-06-11 14:09:01:INFO:VAL-(cmcm) >>
2024-06-11 14:09:01:INFO:M: >>  Has0_acc_2: 0.5590  Has0_F1_score: 0.5534  Non0_acc_2: 0.5509  Non0_F1_score: 0.5472  Mult_acc_5: 0.2707  Mult_acc_7: 0.1965  MAE: 1.5271  Corr: 0.1237 
2024-06-11 14:09:15:INFO:TRAIN-(cmcm) (7/8/1)>> loss: 0.8710
2024-06-11 14:09:18:INFO:VAL-(cmcm) >>
2024-06-11 14:09:18:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5129  Non0_acc_2: 0.5694  Non0_F1_score: 0.5010  Mult_acc_5: 0.2969  Mult_acc_7: 0.2183  MAE: 1.7145  Corr: -0.0168 
2024-06-11 14:09:32:INFO:TRAIN-(cmcm) (8/9/1)>> loss: 0.8692
2024-06-11 14:09:35:INFO:VAL-(cmcm) >>
2024-06-11 14:09:35:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.5363  Non0_acc_2: 0.5880  Non0_F1_score: 0.5182  Mult_acc_5: 0.2838  Mult_acc_7: 0.2052  MAE: 1.7293  Corr: 0.0593 
2024-06-11 14:09:49:INFO:TRAIN-(cmcm) (9/10/1)>> loss: 0.8604
2024-06-11 14:09:52:INFO:VAL-(cmcm) >>
2024-06-11 14:09:52:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5669  Non0_acc_2: 0.5833  Non0_F1_score: 0.5568  Mult_acc_5: 0.2533  Mult_acc_7: 0.1965  MAE: 1.6966  Corr: 0.0574 
2024-06-11 14:10:07:INFO:TRAIN-(cmcm) (10/11/1)>> loss: 0.8556
2024-06-11 14:10:09:INFO:VAL-(cmcm) >>
2024-06-11 14:10:09:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5754  Non0_acc_2: 0.5000  Non0_F1_score: 0.4567  Mult_acc_5: 0.2576  Mult_acc_7: 0.2314  MAE: 1.4672  Corr: 0.1596 
2024-06-11 14:10:10:INFO:Saving checkpoint at epoch 11 to results/models/cmcm-mosi-regression.pth.
2024-06-11 14:10:25:INFO:TRAIN-(cmcm) (1/12/1)>> loss: 0.8532
2024-06-11 14:10:27:INFO:VAL-(cmcm) >>
2024-06-11 14:10:27:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.5512  Non0_acc_2: 0.5833  Non0_F1_score: 0.5340  Mult_acc_5: 0.2533  Mult_acc_7: 0.1790  MAE: 1.6961  Corr: 0.0674 
2024-06-11 14:10:42:INFO:TRAIN-(cmcm) (2/13/1)>> loss: 0.8442
2024-06-11 14:10:45:INFO:VAL-(cmcm) >>
2024-06-11 14:10:45:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.5201  Non0_acc_2: 0.5463  Non0_F1_score: 0.5463  Mult_acc_5: 0.2533  Mult_acc_7: 0.1921  MAE: 1.5516  Corr: 0.0720 
2024-06-11 14:10:59:INFO:TRAIN-(cmcm) (3/14/1)>> loss: 0.8462
2024-06-11 14:11:02:INFO:VAL-(cmcm) >>
2024-06-11 14:11:02:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.5859  Non0_acc_2: 0.5926  Non0_F1_score: 0.5784  Mult_acc_5: 0.2751  Mult_acc_7: 0.2009  MAE: 1.5582  Corr: 0.1256 
2024-06-11 14:11:16:INFO:TRAIN-(cmcm) (4/15/1)>> loss: 0.8351
2024-06-11 14:11:19:INFO:VAL-(cmcm) >>
2024-06-11 14:11:19:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.5394  Non0_acc_2: 0.6019  Non0_F1_score: 0.5579  Mult_acc_5: 0.3144  Mult_acc_7: 0.2533  MAE: 1.5100  Corr: 0.1153 
2024-06-11 14:11:34:INFO:TRAIN-(cmcm) (5/16/1)>> loss: 0.8268
2024-06-11 14:11:37:INFO:VAL-(cmcm) >>
2024-06-11 14:11:37:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.6147  Non0_acc_2: 0.6157  Non0_F1_score: 0.6179  Mult_acc_5: 0.3275  Mult_acc_7: 0.2445  MAE: 1.4966  Corr: 0.2535 
2024-06-11 14:11:51:INFO:TRAIN-(cmcm) (6/17/1)>> loss: 0.8258
2024-06-11 14:11:54:INFO:VAL-(cmcm) >>
2024-06-11 14:11:54:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.5249  Non0_acc_2: 0.6065  Non0_F1_score: 0.5780  Mult_acc_5: 0.2707  Mult_acc_7: 0.2096  MAE: 1.4979  Corr: 0.1624 
2024-06-11 14:12:08:INFO:TRAIN-(cmcm) (7/18/1)>> loss: 0.8120
2024-06-11 14:12:11:INFO:VAL-(cmcm) >>
2024-06-11 14:12:11:INFO:M: >>  Has0_acc_2: 0.6419  Has0_F1_score: 0.6453  Non0_acc_2: 0.6435  Non0_F1_score: 0.6454  Mult_acc_5: 0.3144  Mult_acc_7: 0.2314  MAE: 1.4625  Corr: 0.3298 
2024-06-11 14:12:12:INFO:Saving checkpoint at epoch 18 to results/models/cmcm-mosi-regression.pth.
2024-06-11 14:12:27:INFO:TRAIN-(cmcm) (1/19/1)>> loss: 0.8065
2024-06-11 14:12:29:INFO:VAL-(cmcm) >>
2024-06-11 14:12:29:INFO:M: >>  Has0_acc_2: 0.6245  Has0_F1_score: 0.6082  Non0_acc_2: 0.6111  Non0_F1_score: 0.6065  Mult_acc_5: 0.3100  Mult_acc_7: 0.2271  MAE: 1.4285  Corr: 0.2845 
2024-06-11 14:12:30:INFO:Saving checkpoint at epoch 19 to results/models/cmcm-mosi-regression.pth.
2024-06-11 14:12:45:INFO:TRAIN-(cmcm) (1/20/1)>> loss: 0.8002
2024-06-11 14:12:48:INFO:VAL-(cmcm) >>
2024-06-11 14:12:48:INFO:M: >>  Has0_acc_2: 0.6245  Has0_F1_score: 0.6254  Non0_acc_2: 0.6389  Non0_F1_score: 0.6371  Mult_acc_5: 0.3188  Mult_acc_7: 0.2445  MAE: 1.4079  Corr: 0.2964 
2024-06-11 14:12:49:INFO:Saving checkpoint at epoch 20 to results/models/cmcm-mosi-regression.pth.
2024-06-11 14:13:04:INFO:TRAIN-(cmcm) (1/21/1)>> loss: 0.7934
2024-06-11 14:13:06:INFO:VAL-(cmcm) >>
2024-06-11 14:13:06:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.6019  Non0_acc_2: 0.6019  Non0_F1_score: 0.5929  Mult_acc_5: 0.3188  Mult_acc_7: 0.2533  MAE: 1.3612  Corr: 0.3797 
2024-06-11 14:13:07:INFO:Saving checkpoint at epoch 21 to results/models/cmcm-mosi-regression.pth.
2024-06-11 14:13:22:INFO:TRAIN-(cmcm) (1/22/1)>> loss: 0.7765
2024-06-11 14:13:25:INFO:VAL-(cmcm) >>
2024-06-11 14:13:25:INFO:M: >>  Has0_acc_2: 0.6376  Has0_F1_score: 0.6044  Non0_acc_2: 0.6250  Non0_F1_score: 0.5955  Mult_acc_5: 0.3013  Mult_acc_7: 0.2227  MAE: 1.4564  Corr: 0.2422 
2024-06-11 14:13:39:INFO:TRAIN-(cmcm) (2/23/1)>> loss: 0.7675
2024-06-11 14:13:42:INFO:VAL-(cmcm) >>
2024-06-11 14:13:42:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.6150  Non0_acc_2: 0.5972  Non0_F1_score: 0.5956  Mult_acc_5: 0.3100  Mult_acc_7: 0.2445  MAE: 1.4494  Corr: 0.2759 
2024-06-11 14:13:57:INFO:TRAIN-(cmcm) (3/24/1)>> loss: 0.7579
2024-06-11 14:13:59:INFO:VAL-(cmcm) >>
2024-06-11 14:13:59:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.6011  Non0_acc_2: 0.6343  Non0_F1_score: 0.6305  Mult_acc_5: 0.3537  Mult_acc_7: 0.2707  MAE: 1.4468  Corr: 0.3083 
2024-06-11 14:14:14:INFO:TRAIN-(cmcm) (4/25/1)>> loss: 0.7501
2024-06-11 14:14:16:INFO:VAL-(cmcm) >>
2024-06-11 14:14:16:INFO:M: >>  Has0_acc_2: 0.6157  Has0_F1_score: 0.6179  Non0_acc_2: 0.6296  Non0_F1_score: 0.6309  Mult_acc_5: 0.3188  Mult_acc_7: 0.2358  MAE: 1.4499  Corr: 0.2430 
2024-06-11 14:14:31:INFO:TRAIN-(cmcm) (5/26/1)>> loss: 0.7383
2024-06-11 14:14:34:INFO:VAL-(cmcm) >>
2024-06-11 14:14:34:INFO:M: >>  Has0_acc_2: 0.6288  Has0_F1_score: 0.6270  Non0_acc_2: 0.6389  Non0_F1_score: 0.6398  Mult_acc_5: 0.3362  Mult_acc_7: 0.2576  MAE: 1.3763  Corr: 0.2913 
2024-06-11 14:14:48:INFO:TRAIN-(cmcm) (6/27/1)>> loss: 0.7315
2024-06-11 14:14:51:INFO:VAL-(cmcm) >>
2024-06-11 14:14:51:INFO:M: >>  Has0_acc_2: 0.6245  Has0_F1_score: 0.6129  Non0_acc_2: 0.6435  Non0_F1_score: 0.6379  Mult_acc_5: 0.3362  Mult_acc_7: 0.2489  MAE: 1.3996  Corr: 0.2856 
2024-06-11 14:15:06:INFO:TRAIN-(cmcm) (7/28/1)>> loss: 0.7231
2024-06-11 14:15:08:INFO:VAL-(cmcm) >>
2024-06-11 14:15:08:INFO:M: >>  Has0_acc_2: 0.6288  Has0_F1_score: 0.6261  Non0_acc_2: 0.6296  Non0_F1_score: 0.6296  Mult_acc_5: 0.3231  Mult_acc_7: 0.2402  MAE: 1.3913  Corr: 0.2845 
2024-06-11 14:15:23:INFO:TRAIN-(cmcm) (8/29/1)>> loss: 0.7200
2024-06-11 14:15:25:INFO:VAL-(cmcm) >>
2024-06-11 14:15:25:INFO:M: >>  Has0_acc_2: 0.6288  Has0_F1_score: 0.6231  Non0_acc_2: 0.6528  Non0_F1_score: 0.6507  Mult_acc_5: 0.3581  Mult_acc_7: 0.2707  MAE: 1.3547  Corr: 0.3087 
2024-06-11 14:15:26:INFO:Saving checkpoint at epoch 29 to results/models/cmcm-mosi-regression.pth.
2024-06-11 14:15:41:INFO:TRAIN-(cmcm) (1/30/1)>> loss: 0.7155
2024-06-11 14:15:44:INFO:VAL-(cmcm) >>
2024-06-11 14:15:44:INFO:M: >>  Has0_acc_2: 0.6288  Has0_F1_score: 0.6220  Non0_acc_2: 0.6528  Non0_F1_score: 0.6499  Mult_acc_5: 0.3537  Mult_acc_7: 0.2707  MAE: 1.3695  Corr: 0.3004 
2024-06-11 14:15:58:INFO:TRAIN-(cmcm) (2/31/1)>> loss: 0.7164
2024-06-11 14:16:01:INFO:VAL-(cmcm) >>
2024-06-11 14:16:01:INFO:M: >>  Has0_acc_2: 0.6245  Has0_F1_score: 0.6169  Non0_acc_2: 0.6481  Non0_F1_score: 0.6449  Mult_acc_5: 0.3624  Mult_acc_7: 0.2751  MAE: 1.3756  Corr: 0.2980 
2024-06-11 14:16:16:INFO:TRAIN-(cmcm) (3/32/1)>> loss: 0.7166
2024-06-11 14:16:18:INFO:VAL-(cmcm) >>
2024-06-11 14:16:18:INFO:M: >>  Has0_acc_2: 0.6419  Has0_F1_score: 0.6431  Non0_acc_2: 0.6528  Non0_F1_score: 0.6543  Mult_acc_5: 0.3493  Mult_acc_7: 0.2707  MAE: 1.3433  Corr: 0.3144 
2024-06-11 14:16:19:INFO:Saving checkpoint at epoch 32 to results/models/cmcm-mosi-regression.pth.
2024-06-11 14:16:34:INFO:TRAIN-(cmcm) (1/33/1)>> loss: 0.7228
2024-06-11 14:16:36:INFO:VAL-(cmcm) >>
2024-06-11 14:16:36:INFO:M: >>  Has0_acc_2: 0.6463  Has0_F1_score: 0.6453  Non0_acc_2: 0.6574  Non0_F1_score: 0.6574  Mult_acc_5: 0.3406  Mult_acc_7: 0.2576  MAE: 1.3918  Corr: 0.3054 
2024-06-11 14:16:51:INFO:TRAIN-(cmcm) (2/34/1)>> loss: 0.7246
2024-06-11 14:16:54:INFO:VAL-(cmcm) >>
2024-06-11 14:16:54:INFO:M: >>  Has0_acc_2: 0.6288  Has0_F1_score: 0.6312  Non0_acc_2: 0.6389  Non0_F1_score: 0.6406  Mult_acc_5: 0.3450  Mult_acc_7: 0.2795  MAE: 1.3892  Corr: 0.2692 
2024-06-11 14:17:08:INFO:TRAIN-(cmcm) (3/35/1)>> loss: 0.7254
2024-06-11 14:17:11:INFO:VAL-(cmcm) >>
2024-06-11 14:17:11:INFO:M: >>  Has0_acc_2: 0.6638  Has0_F1_score: 0.6634  Non0_acc_2: 0.6667  Non0_F1_score: 0.6678  Mult_acc_5: 0.3362  Mult_acc_7: 0.2707  MAE: 1.3191  Corr: 0.3484 
2024-06-11 14:17:12:INFO:Saving checkpoint at epoch 35 to results/models/cmcm-mosi-regression.pth.
2024-06-11 14:17:27:INFO:TRAIN-(cmcm) (1/36/1)>> loss: 0.7317
2024-06-11 14:17:29:INFO:VAL-(cmcm) >>
2024-06-11 14:17:29:INFO:M: >>  Has0_acc_2: 0.6463  Has0_F1_score: 0.6497  Non0_acc_2: 0.6528  Non0_F1_score: 0.6546  Mult_acc_5: 0.3493  Mult_acc_7: 0.2795  MAE: 1.3202  Corr: 0.3196 
2024-06-11 14:17:44:INFO:TRAIN-(cmcm) (2/37/1)>> loss: 0.7360
2024-06-11 14:17:47:INFO:VAL-(cmcm) >>
2024-06-11 14:17:47:INFO:M: >>  Has0_acc_2: 0.6201  Has0_F1_score: 0.6235  Non0_acc_2: 0.6250  Non0_F1_score: 0.6252  Mult_acc_5: 0.3319  Mult_acc_7: 0.2620  MAE: 1.4861  Corr: 0.2734 
2024-06-11 14:18:01:INFO:TRAIN-(cmcm) (3/38/1)>> loss: 0.7348
2024-06-11 14:18:04:INFO:VAL-(cmcm) >>
2024-06-11 14:18:04:INFO:M: >>  Has0_acc_2: 0.6550  Has0_F1_score: 0.6487  Non0_acc_2: 0.6435  Non0_F1_score: 0.6451  Mult_acc_5: 0.3450  Mult_acc_7: 0.2664  MAE: 1.3739  Corr: 0.2947 
2024-06-11 14:18:18:INFO:TRAIN-(cmcm) (4/39/1)>> loss: 0.7466
2024-06-11 14:18:21:INFO:VAL-(cmcm) >>
2024-06-11 14:18:21:INFO:M: >>  Has0_acc_2: 0.6332  Has0_F1_score: 0.6357  Non0_acc_2: 0.6343  Non0_F1_score: 0.6305  Mult_acc_5: 0.3013  Mult_acc_7: 0.2489  MAE: 1.2752  Corr: 0.3785 
2024-06-11 14:18:22:INFO:Saving checkpoint at epoch 39 to results/models/cmcm-mosi-regression.pth.
2024-06-11 14:18:37:INFO:TRAIN-(cmcm) (1/40/1)>> loss: 0.7565
2024-06-11 14:18:39:INFO:VAL-(cmcm) >>
2024-06-11 14:18:39:INFO:M: >>  Has0_acc_2: 0.6245  Has0_F1_score: 0.6200  Non0_acc_2: 0.6204  Non0_F1_score: 0.6106  Mult_acc_5: 0.3144  Mult_acc_7: 0.2533  MAE: 1.4331  Corr: 0.3167 
2024-06-11 14:18:54:INFO:TRAIN-(cmcm) (2/41/1)>> loss: 0.7584
2024-06-11 14:18:57:INFO:VAL-(cmcm) >>
2024-06-11 14:18:57:INFO:M: >>  Has0_acc_2: 0.6376  Has0_F1_score: 0.6396  Non0_acc_2: 0.6296  Non0_F1_score: 0.6235  Mult_acc_5: 0.3231  Mult_acc_7: 0.2795  MAE: 1.3427  Corr: 0.3296 
2024-06-11 14:19:11:INFO:TRAIN-(cmcm) (3/42/1)>> loss: 0.7724
2024-06-11 14:19:14:INFO:VAL-(cmcm) >>
2024-06-11 14:19:14:INFO:M: >>  Has0_acc_2: 0.6201  Has0_F1_score: 0.5771  Non0_acc_2: 0.6481  Non0_F1_score: 0.6257  Mult_acc_5: 0.3013  Mult_acc_7: 0.2533  MAE: 1.4079  Corr: 0.2287 
2024-06-11 14:19:29:INFO:TRAIN-(cmcm) (4/43/1)>> loss: 0.7662
2024-06-11 14:19:32:INFO:VAL-(cmcm) >>
2024-06-11 14:19:32:INFO:M: >>  Has0_acc_2: 0.6332  Has0_F1_score: 0.6233  Non0_acc_2: 0.6481  Non0_F1_score: 0.6476  Mult_acc_5: 0.2795  Mult_acc_7: 0.2533  MAE: 1.2641  Corr: 0.3628 
2024-06-11 14:19:32:INFO:Saving checkpoint at epoch 43 to results/models/cmcm-mosi-regression.pth.
2024-06-11 14:19:47:INFO:TRAIN-(cmcm) (1/44/1)>> loss: 0.7659
2024-06-11 14:19:50:INFO:VAL-(cmcm) >>
2024-06-11 14:19:50:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.6029  Non0_acc_2: 0.6389  Non0_F1_score: 0.6284  Mult_acc_5: 0.3319  Mult_acc_7: 0.2707  MAE: 1.3813  Corr: 0.3198 
2024-06-11 14:20:05:INFO:TRAIN-(cmcm) (2/45/1)>> loss: 0.7779
2024-06-11 14:20:07:INFO:VAL-(cmcm) >>
2024-06-11 14:20:07:INFO:M: >>  Has0_acc_2: 0.6376  Has0_F1_score: 0.6297  Non0_acc_2: 0.6389  Non0_F1_score: 0.6291  Mult_acc_5: 0.2926  Mult_acc_7: 0.2314  MAE: 1.3996  Corr: 0.3263 
2024-06-11 14:20:22:INFO:TRAIN-(cmcm) (3/46/1)>> loss: 0.7661
2024-06-11 14:20:24:INFO:VAL-(cmcm) >>
2024-06-11 14:20:24:INFO:M: >>  Has0_acc_2: 0.6157  Has0_F1_score: 0.5793  Non0_acc_2: 0.5972  Non0_F1_score: 0.5602  Mult_acc_5: 0.3231  Mult_acc_7: 0.2358  MAE: 1.4839  Corr: 0.2286 
2024-06-11 14:20:39:INFO:TRAIN-(cmcm) (4/47/1)>> loss: 0.7764
2024-06-11 14:20:42:INFO:VAL-(cmcm) >>
2024-06-11 14:20:42:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.4880  Non0_acc_2: 0.5926  Non0_F1_score: 0.5124  Mult_acc_5: 0.3231  Mult_acc_7: 0.2271  MAE: 1.5704  Corr: 0.2210 
2024-06-11 14:20:56:INFO:TRAIN-(cmcm) (5/48/1)>> loss: 0.7741
2024-06-11 14:20:59:INFO:VAL-(cmcm) >>
2024-06-11 14:20:59:INFO:M: >>  Has0_acc_2: 0.6550  Has0_F1_score: 0.6573  Non0_acc_2: 0.6574  Non0_F1_score: 0.6543  Mult_acc_5: 0.3319  Mult_acc_7: 0.2664  MAE: 1.3747  Corr: 0.4038 
2024-06-11 14:21:13:INFO:TRAIN-(cmcm) (6/49/1)>> loss: 0.7763
2024-06-11 14:21:16:INFO:VAL-(cmcm) >>
2024-06-11 14:21:16:INFO:M: >>  Has0_acc_2: 0.6376  Has0_F1_score: 0.6114  Non0_acc_2: 0.6343  Non0_F1_score: 0.6192  Mult_acc_5: 0.3057  Mult_acc_7: 0.2489  MAE: 1.4608  Corr: 0.1886 
2024-06-11 14:21:31:INFO:TRAIN-(cmcm) (7/50/1)>> loss: 0.7637
2024-06-11 14:21:33:INFO:VAL-(cmcm) >>
2024-06-11 14:21:33:INFO:M: >>  Has0_acc_2: 0.6725  Has0_F1_score: 0.6756  Non0_acc_2: 0.6204  Non0_F1_score: 0.6141  Mult_acc_5: 0.2882  Mult_acc_7: 0.2751  MAE: 1.2804  Corr: 0.3911 
2024-06-11 14:21:48:INFO:TRAIN-(cmcm) (8/51/1)>> loss: 0.7759
2024-06-11 14:21:50:INFO:VAL-(cmcm) >>
2024-06-11 14:21:50:INFO:M: >>  Has0_acc_2: 0.6638  Has0_F1_score: 0.6628  Non0_acc_2: 0.6667  Non0_F1_score: 0.6662  Mult_acc_5: 0.3581  Mult_acc_7: 0.2882  MAE: 1.2743  Corr: 0.3868 
2024-06-11 14:22:05:INFO:TRAIN-(cmcm) (9/52/1)>> loss: 0.7691
2024-06-11 14:22:08:INFO:VAL-(cmcm) >>
2024-06-11 14:22:08:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.5409  Non0_acc_2: 0.5880  Non0_F1_score: 0.5265  Mult_acc_5: 0.3144  Mult_acc_7: 0.2183  MAE: 1.6909  Corr: 0.1487 
2024-06-11 14:22:22:INFO:TRAIN-(cmcm) (10/53/1)>> loss: 0.7520
2024-06-11 14:22:25:INFO:VAL-(cmcm) >>
2024-06-11 14:22:25:INFO:M: >>  Has0_acc_2: 0.6419  Has0_F1_score: 0.6347  Non0_acc_2: 0.6481  Non0_F1_score: 0.6410  Mult_acc_5: 0.3057  Mult_acc_7: 0.2271  MAE: 1.3359  Corr: 0.3293 
2024-06-11 14:22:32:INFO:TEST-(cmcm) >>
2024-06-11 14:22:32:INFO:M: >>  Has0_acc_2: 0.6035  Has0_F1_score: 0.6009  Non0_acc_2: 0.6052  Non0_F1_score: 0.6076  Mult_acc_5: 0.2566  Mult_acc_7: 0.2405  MAE: 1.3367  Corr: 0.2777 
2024-06-11 14:22:33:INFO:Results are added to results/results/mosi-regression-30.csv...
2024-06-11 14:22:33:INFO:Start running cmcm...
2024-06-11 14:22:33:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 2222}>
2024-06-11 14:22:33:INFO:Let's use the GPU 1 !
2024-06-11 14:22:33:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 14:22:33:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718086953 HTTP/1.1" 200 235
2024-06-11 14:22:33:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 14:22:34:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 14:22:34:INFO:train samples: (1284,)
2024-06-11 14:22:35:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 14:22:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718086955 HTTP/1.1" 200 235
2024-06-11 14:22:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 14:22:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 14:22:36:INFO:valid samples: (229,)
2024-06-11 14:22:36:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 14:22:36:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718086957 HTTP/1.1" 200 235
2024-06-11 14:22:36:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 14:22:37:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 14:22:37:INFO:test samples: (686,)
2024-06-11 14:22:37:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 14:22:38:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718086958 HTTP/1.1" 200 235
2024-06-11 14:22:38:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 14:22:38:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 14:22:39:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 14:22:39:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718086959 HTTP/1.1" 200 235
2024-06-11 14:22:39:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 14:22:40:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 14:22:40:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-11 14:22:40:WARNING:Try importing flash-attention for faster inference...
2024-06-11 14:22:40:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-11 14:22:40:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-11 14:22:40:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-11 14:22:41:INFO:trainable params: 1310284 || all params: 1838138956 || trainable%: 0.07128318540461856
2024-06-11 14:22:41:INFO:Init labels...
2024-06-11 14:22:41:INFO:Start training...
2024-06-11 14:22:55:INFO:TRAIN-(cmcm) (1/1/2)>> loss: 3.8062
2024-06-11 14:22:58:INFO:VAL-(cmcm) >>
2024-06-11 14:22:58:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.4438  Non0_acc_2: 0.5556  Non0_F1_score: 0.5132  Mult_acc_5: 0.2795  Mult_acc_7: 0.1528  MAE: 2.2285  Corr: 0.0414 
2024-06-11 14:23:00:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-11 14:23:15:INFO:TRAIN-(cmcm) (1/2/2)>> loss: 1.1498
2024-06-11 14:23:18:INFO:VAL-(cmcm) >>
2024-06-11 14:23:18:INFO:M: >>  Has0_acc_2: 0.5633  Has0_F1_score: 0.5674  Non0_acc_2: 0.5556  Non0_F1_score: 0.5580  Mult_acc_5: 0.1965  Mult_acc_7: 0.1878  MAE: 1.5846  Corr: 0.0747 
2024-06-11 14:23:19:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-11 14:23:34:INFO:TRAIN-(cmcm) (1/3/2)>> loss: 0.9695
2024-06-11 14:23:36:INFO:VAL-(cmcm) >>
2024-06-11 14:23:36:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.5086  Non0_acc_2: 0.5833  Non0_F1_score: 0.4856  Mult_acc_5: 0.3231  Mult_acc_7: 0.2402  MAE: 1.6782  Corr: 0.0534 
2024-06-11 14:23:51:INFO:TRAIN-(cmcm) (2/4/2)>> loss: 0.8945
2024-06-11 14:23:53:INFO:VAL-(cmcm) >>
2024-06-11 14:23:53:INFO:M: >>  Has0_acc_2: 0.5633  Has0_F1_score: 0.5647  Non0_acc_2: 0.5509  Non0_F1_score: 0.5522  Mult_acc_5: 0.1834  Mult_acc_7: 0.1834  MAE: 1.5401  Corr: 0.0355 
2024-06-11 14:23:54:INFO:Saving checkpoint at epoch 4 to results/models/cmcm-mosi-regression.pth.
2024-06-11 14:24:09:INFO:TRAIN-(cmcm) (1/5/2)>> loss: 0.8820
2024-06-11 14:24:12:INFO:VAL-(cmcm) >>
2024-06-11 14:24:12:INFO:M: >>  Has0_acc_2: 0.5415  Has0_F1_score: 0.5459  Non0_acc_2: 0.5370  Non0_F1_score: 0.5396  Mult_acc_5: 0.2489  Mult_acc_7: 0.1878  MAE: 1.7451  Corr: 0.0632 
2024-06-11 14:24:26:INFO:TRAIN-(cmcm) (2/6/2)>> loss: 0.8690
2024-06-11 14:24:29:INFO:VAL-(cmcm) >>
2024-06-11 14:24:29:INFO:M: >>  Has0_acc_2: 0.5502  Has0_F1_score: 0.5252  Non0_acc_2: 0.5370  Non0_F1_score: 0.5101  Mult_acc_5: 0.2664  Mult_acc_7: 0.1834  MAE: 1.7568  Corr: -0.0030 
2024-06-11 14:24:44:INFO:TRAIN-(cmcm) (3/7/2)>> loss: 0.8655
2024-06-11 14:24:46:INFO:VAL-(cmcm) >>
2024-06-11 14:24:46:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.5240  Non0_acc_2: 0.5741  Non0_F1_score: 0.5084  Mult_acc_5: 0.1965  Mult_acc_7: 0.1921  MAE: 1.6315  Corr: 0.0344 
2024-06-11 14:25:01:INFO:TRAIN-(cmcm) (4/8/2)>> loss: 0.8612
2024-06-11 14:25:03:INFO:VAL-(cmcm) >>
2024-06-11 14:25:03:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5724  Non0_acc_2: 0.5694  Non0_F1_score: 0.5684  Mult_acc_5: 0.2489  Mult_acc_7: 0.1790  MAE: 1.6298  Corr: 0.0908 
2024-06-11 14:25:18:INFO:TRAIN-(cmcm) (5/9/2)>> loss: 0.8604
2024-06-11 14:25:21:INFO:VAL-(cmcm) >>
2024-06-11 14:25:21:INFO:M: >>  Has0_acc_2: 0.4934  Has0_F1_score: 0.4556  Non0_acc_2: 0.5000  Non0_F1_score: 0.4567  Mult_acc_5: 0.1747  Mult_acc_7: 0.1485  MAE: 1.7992  Corr: 0.0677 
2024-06-11 14:25:35:INFO:TRAIN-(cmcm) (6/10/2)>> loss: 0.8618
2024-06-11 14:25:38:INFO:VAL-(cmcm) >>
2024-06-11 14:25:38:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4978  Non0_acc_2: 0.5694  Non0_F1_score: 0.4713  Mult_acc_5: 0.2271  Mult_acc_7: 0.1878  MAE: 1.5909  Corr: 0.0503 
2024-06-11 14:25:53:INFO:TRAIN-(cmcm) (7/11/2)>> loss: 0.8546
2024-06-11 14:25:55:INFO:VAL-(cmcm) >>
2024-06-11 14:25:55:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5109  Non0_acc_2: 0.5556  Non0_F1_score: 0.4913  Mult_acc_5: 0.2926  Mult_acc_7: 0.2140  MAE: 1.7739  Corr: 0.0306 
2024-06-11 14:26:10:INFO:TRAIN-(cmcm) (8/12/2)>> loss: 0.8490
2024-06-11 14:26:12:INFO:VAL-(cmcm) >>
2024-06-11 14:26:12:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.5658  Non0_acc_2: 0.5370  Non0_F1_score: 0.5382  Mult_acc_5: 0.2533  Mult_acc_7: 0.2052  MAE: 1.5110  Corr: 0.0998 
2024-06-11 14:26:13:INFO:Saving checkpoint at epoch 12 to results/models/cmcm-mosi-regression.pth.
2024-06-11 14:26:28:INFO:TRAIN-(cmcm) (1/13/2)>> loss: 0.8472
2024-06-11 14:26:31:INFO:VAL-(cmcm) >>
2024-06-11 14:26:31:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.4562  Non0_acc_2: 0.5602  Non0_F1_score: 0.4275  Mult_acc_5: 0.2882  Mult_acc_7: 0.2140  MAE: 1.7957  Corr: -0.0805 
2024-06-11 14:26:45:INFO:TRAIN-(cmcm) (2/14/2)>> loss: 0.8420
2024-06-11 14:26:48:INFO:VAL-(cmcm) >>
2024-06-11 14:26:48:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.4843  Non0_acc_2: 0.5556  Non0_F1_score: 0.4627  Mult_acc_5: 0.2489  Mult_acc_7: 0.2009  MAE: 1.6708  Corr: 0.0049 
2024-06-11 14:27:03:INFO:TRAIN-(cmcm) (3/15/2)>> loss: 0.8428
2024-06-11 14:27:05:INFO:VAL-(cmcm) >>
2024-06-11 14:27:05:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5372  Non0_acc_2: 0.5602  Non0_F1_score: 0.5380  Mult_acc_5: 0.2358  Mult_acc_7: 0.1834  MAE: 1.6180  Corr: 0.0372 
2024-06-11 14:27:20:INFO:TRAIN-(cmcm) (4/16/2)>> loss: 0.8380
2024-06-11 14:27:22:INFO:VAL-(cmcm) >>
2024-06-11 14:27:22:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5175  Non0_acc_2: 0.5648  Non0_F1_score: 0.5019  Mult_acc_5: 0.2882  Mult_acc_7: 0.2096  MAE: 1.6713  Corr: 0.0036 
2024-06-11 14:27:37:INFO:TRAIN-(cmcm) (5/17/2)>> loss: 0.8333
2024-06-11 14:27:40:INFO:VAL-(cmcm) >>
2024-06-11 14:27:40:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5282  Non0_acc_2: 0.5787  Non0_F1_score: 0.5632  Mult_acc_5: 0.3057  Mult_acc_7: 0.2358  MAE: 1.5883  Corr: 0.0896 
2024-06-11 14:27:54:INFO:TRAIN-(cmcm) (6/18/2)>> loss: 0.8278
2024-06-11 14:27:57:INFO:VAL-(cmcm) >>
2024-06-11 14:27:57:INFO:M: >>  Has0_acc_2: 0.6288  Has0_F1_score: 0.6195  Non0_acc_2: 0.4676  Non0_F1_score: 0.3838  Mult_acc_5: 0.1965  Mult_acc_7: 0.1878  MAE: 1.4453  Corr: 0.1248 
2024-06-11 14:27:58:INFO:Saving checkpoint at epoch 18 to results/models/cmcm-mosi-regression.pth.
2024-06-11 14:28:13:INFO:TRAIN-(cmcm) (1/19/2)>> loss: 0.8171
2024-06-11 14:28:16:INFO:VAL-(cmcm) >>
2024-06-11 14:28:16:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.6016  Non0_acc_2: 0.5417  Non0_F1_score: 0.5425  Mult_acc_5: 0.2620  Mult_acc_7: 0.2052  MAE: 1.5311  Corr: 0.1150 
2024-06-11 14:28:30:INFO:TRAIN-(cmcm) (2/20/2)>> loss: 0.8189
2024-06-11 14:28:33:INFO:VAL-(cmcm) >>
2024-06-11 14:28:33:INFO:M: >>  Has0_acc_2: 0.6201  Has0_F1_score: 0.6238  Non0_acc_2: 0.6111  Non0_F1_score: 0.6067  Mult_acc_5: 0.3013  Mult_acc_7: 0.2533  MAE: 1.4660  Corr: 0.2561 
2024-06-11 14:28:47:INFO:TRAIN-(cmcm) (3/21/2)>> loss: 0.8096
2024-06-11 14:28:50:INFO:VAL-(cmcm) >>
2024-06-11 14:28:50:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5042  Non0_acc_2: 0.5509  Non0_F1_score: 0.5522  Mult_acc_5: 0.2227  Mult_acc_7: 0.1834  MAE: 1.4905  Corr: 0.0952 
2024-06-11 14:29:05:INFO:TRAIN-(cmcm) (4/22/2)>> loss: 0.8004
2024-06-11 14:29:07:INFO:VAL-(cmcm) >>
2024-06-11 14:29:07:INFO:M: >>  Has0_acc_2: 0.5633  Has0_F1_score: 0.5603  Non0_acc_2: 0.5787  Non0_F1_score: 0.5723  Mult_acc_5: 0.2838  Mult_acc_7: 0.2314  MAE: 1.6621  Corr: 0.2112 
2024-06-11 14:29:22:INFO:TRAIN-(cmcm) (5/23/2)>> loss: 0.7924
2024-06-11 14:29:24:INFO:VAL-(cmcm) >>
2024-06-11 14:29:24:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.5383  Non0_acc_2: 0.6065  Non0_F1_score: 0.5549  Mult_acc_5: 0.3057  Mult_acc_7: 0.2358  MAE: 1.5713  Corr: 0.1768 
2024-06-11 14:29:39:INFO:TRAIN-(cmcm) (6/24/2)>> loss: 0.7889
2024-06-11 14:29:42:INFO:VAL-(cmcm) >>
2024-06-11 14:29:42:INFO:M: >>  Has0_acc_2: 0.6376  Has0_F1_score: 0.6411  Non0_acc_2: 0.6296  Non0_F1_score: 0.6315  Mult_acc_5: 0.3144  Mult_acc_7: 0.2533  MAE: 1.5206  Corr: 0.2563 
2024-06-11 14:29:56:INFO:TRAIN-(cmcm) (7/25/2)>> loss: 0.7786
2024-06-11 14:29:59:INFO:VAL-(cmcm) >>
2024-06-11 14:29:59:INFO:M: >>  Has0_acc_2: 0.6332  Has0_F1_score: 0.6357  Non0_acc_2: 0.6204  Non0_F1_score: 0.6223  Mult_acc_5: 0.2882  Mult_acc_7: 0.2358  MAE: 1.5044  Corr: 0.2395 
2024-06-11 14:30:13:INFO:TRAIN-(cmcm) (8/26/2)>> loss: 0.7729
2024-06-11 14:30:16:INFO:VAL-(cmcm) >>
2024-06-11 14:30:16:INFO:M: >>  Has0_acc_2: 0.6376  Has0_F1_score: 0.6407  Non0_acc_2: 0.6204  Non0_F1_score: 0.6222  Mult_acc_5: 0.3057  Mult_acc_7: 0.2533  MAE: 1.4582  Corr: 0.2544 
2024-06-11 14:30:31:INFO:TRAIN-(cmcm) (9/27/2)>> loss: 0.7674
2024-06-11 14:30:33:INFO:VAL-(cmcm) >>
2024-06-11 14:30:33:INFO:M: >>  Has0_acc_2: 0.6463  Has0_F1_score: 0.6361  Non0_acc_2: 0.6296  Non0_F1_score: 0.6253  Mult_acc_5: 0.2707  Mult_acc_7: 0.2140  MAE: 1.4726  Corr: 0.2229 
2024-06-11 14:30:48:INFO:TRAIN-(cmcm) (10/28/2)>> loss: 0.7640
2024-06-11 14:30:50:INFO:VAL-(cmcm) >>
2024-06-11 14:30:50:INFO:M: >>  Has0_acc_2: 0.6463  Has0_F1_score: 0.6481  Non0_acc_2: 0.6296  Non0_F1_score: 0.6316  Mult_acc_5: 0.2707  Mult_acc_7: 0.2183  MAE: 1.4669  Corr: 0.2342 
2024-06-11 14:30:58:INFO:TEST-(cmcm) >>
2024-06-11 14:30:58:INFO:M: >>  Has0_acc_2: 0.5714  Has0_F1_score: 0.5668  Non0_acc_2: 0.5427  Non0_F1_score: 0.4779  Mult_acc_5: 0.1837  Mult_acc_7: 0.1822  MAE: 1.4522  Corr: 0.0164 
2024-06-11 14:30:58:INFO:Results are added to results/results/mosi-regression-30.csv...
2024-06-11 14:30:58:INFO:Start running cmcm...
2024-06-11 14:30:58:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 3333}>
2024-06-11 14:30:58:INFO:Let's use the GPU 1 !
2024-06-11 14:30:58:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 14:30:59:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718087459 HTTP/1.1" 200 235
2024-06-11 14:30:59:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 14:30:59:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 14:31:00:INFO:train samples: (1284,)
2024-06-11 14:31:00:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 14:31:00:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718087461 HTTP/1.1" 200 235
2024-06-11 14:31:00:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 14:31:01:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 14:31:01:INFO:valid samples: (229,)
2024-06-11 14:31:01:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 14:31:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718087462 HTTP/1.1" 200 235
2024-06-11 14:31:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 14:31:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 14:31:03:INFO:test samples: (686,)
2024-06-11 14:31:03:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 14:31:03:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718087463 HTTP/1.1" 200 235
2024-06-11 14:31:03:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 14:31:04:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 14:31:04:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 14:31:05:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718087465 HTTP/1.1" 200 235
2024-06-11 14:31:05:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 14:31:05:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 14:31:05:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-11 14:31:05:WARNING:Try importing flash-attention for faster inference...
2024-06-11 14:31:05:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-11 14:31:05:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-11 14:31:05:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-11 14:31:06:INFO:trainable params: 1310284 || all params: 1838138956 || trainable%: 0.07128318540461856
2024-06-11 14:31:06:INFO:Init labels...
2024-06-11 14:31:06:INFO:Start training...
2024-06-11 14:31:21:INFO:TRAIN-(cmcm) (1/1/3)>> loss: 4.1900
2024-06-11 14:31:24:INFO:VAL-(cmcm) >>
2024-06-11 14:31:24:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4259  Non0_F1_score: 0.2544  Mult_acc_5: 0.2140  Mult_acc_7: 0.2140  MAE: 1.4370  Corr: nan 
2024-06-11 14:31:24:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-11 14:31:39:INFO:TRAIN-(cmcm) (1/2/3)>> loss: 2.1072
2024-06-11 14:31:42:INFO:VAL-(cmcm) >>
2024-06-11 14:31:42:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4607  Non0_acc_2: 0.5741  Non0_F1_score: 0.4420  Mult_acc_5: 0.2096  Mult_acc_7: 0.2052  MAE: 1.4366  Corr: 0.0615 
2024-06-11 14:31:43:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-11 14:31:58:INFO:TRAIN-(cmcm) (1/3/3)>> loss: 0.9779
2024-06-11 14:32:00:INFO:VAL-(cmcm) >>
2024-06-11 14:32:00:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5634  Non0_acc_2: 0.5787  Non0_F1_score: 0.5507  Mult_acc_5: 0.2402  Mult_acc_7: 0.2052  MAE: 1.5309  Corr: 0.1947 
2024-06-11 14:32:15:INFO:TRAIN-(cmcm) (2/4/3)>> loss: 0.9077
2024-06-11 14:32:17:INFO:VAL-(cmcm) >>
2024-06-11 14:32:18:INFO:M: >>  Has0_acc_2: 0.5240  Has0_F1_score: 0.5287  Non0_acc_2: 0.4815  Non0_F1_score: 0.4582  Mult_acc_5: 0.2402  Mult_acc_7: 0.2227  MAE: 1.6193  Corr: 0.0686 
2024-06-11 14:32:32:INFO:TRAIN-(cmcm) (3/5/3)>> loss: 0.8915
2024-06-11 14:32:35:INFO:VAL-(cmcm) >>
2024-06-11 14:32:35:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4767  Non0_acc_2: 0.5185  Non0_F1_score: 0.5128  Mult_acc_5: 0.2183  Mult_acc_7: 0.2183  MAE: 1.4440  Corr: -0.0108 
2024-06-11 14:32:49:INFO:TRAIN-(cmcm) (4/6/3)>> loss: 0.8743
2024-06-11 14:32:52:INFO:VAL-(cmcm) >>
2024-06-11 14:32:52:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.5240  Non0_acc_2: 0.5741  Non0_F1_score: 0.5125  Mult_acc_5: 0.2271  Mult_acc_7: 0.1878  MAE: 1.6309  Corr: 0.0232 
2024-06-11 14:33:07:INFO:TRAIN-(cmcm) (5/7/3)>> loss: 0.8741
2024-06-11 14:33:09:INFO:VAL-(cmcm) >>
2024-06-11 14:33:09:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4742  Non0_acc_2: 0.5741  Non0_F1_score: 0.4902  Mult_acc_5: 0.2271  Mult_acc_7: 0.2227  MAE: 1.5065  Corr: 0.0338 
2024-06-11 14:33:24:INFO:TRAIN-(cmcm) (6/8/3)>> loss: 0.8657
2024-06-11 14:33:26:INFO:VAL-(cmcm) >>
2024-06-11 14:33:26:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.5655  Non0_acc_2: 0.5787  Non0_F1_score: 0.5456  Mult_acc_5: 0.2969  Mult_acc_7: 0.2183  MAE: 1.5961  Corr: 0.1379 
2024-06-11 14:33:41:INFO:TRAIN-(cmcm) (7/9/3)>> loss: 0.8653
2024-06-11 14:33:44:INFO:VAL-(cmcm) >>
2024-06-11 14:33:44:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5189  Non0_acc_2: 0.5648  Non0_F1_score: 0.4934  Mult_acc_5: 0.2838  Mult_acc_7: 0.2140  MAE: 1.6507  Corr: 0.0493 
2024-06-11 14:33:58:INFO:TRAIN-(cmcm) (8/10/3)>> loss: 0.8576
2024-06-11 14:34:01:INFO:VAL-(cmcm) >>
2024-06-11 14:34:01:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.4815  Non0_acc_2: 0.5509  Non0_F1_score: 0.4881  Mult_acc_5: 0.2795  Mult_acc_7: 0.2271  MAE: 1.5162  Corr: 0.0566 
2024-06-11 14:34:15:INFO:TRAIN-(cmcm) (9/11/3)>> loss: 0.8564
2024-06-11 14:34:18:INFO:VAL-(cmcm) >>
2024-06-11 14:34:18:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.5240  Non0_acc_2: 0.5741  Non0_F1_score: 0.5164  Mult_acc_5: 0.2227  Mult_acc_7: 0.1921  MAE: 1.5293  Corr: 0.0843 
2024-06-11 14:34:33:INFO:TRAIN-(cmcm) (10/12/3)>> loss: 0.8538
2024-06-11 14:34:35:INFO:VAL-(cmcm) >>
2024-06-11 14:34:35:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.5978  Non0_acc_2: 0.5926  Non0_F1_score: 0.5830  Mult_acc_5: 0.2489  Mult_acc_7: 0.2183  MAE: 1.5385  Corr: 0.1659 
2024-06-11 14:34:43:INFO:TEST-(cmcm) >>
2024-06-11 14:34:43:INFO:M: >>  Has0_acc_2: 0.4606  Has0_F1_score: 0.3164  Non0_acc_2: 0.4360  Non0_F1_score: 0.2943  Mult_acc_5: 0.1764  Mult_acc_7: 0.1706  MAE: 1.5854  Corr: 0.0153 
2024-06-11 14:34:43:INFO:Results are added to results/results/mosi-regression-30.csv...
2024-06-11 14:34:43:INFO:Start running cmcm...
2024-06-11 14:34:43:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 4444}>
2024-06-11 14:34:43:INFO:Let's use the GPU 1 !
2024-06-11 14:34:43:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 14:34:43:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718087684 HTTP/1.1" 200 235
2024-06-11 14:34:44:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 14:34:44:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 14:34:45:INFO:train samples: (1284,)
2024-06-11 14:34:45:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 14:34:45:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718087685 HTTP/1.1" 200 235
2024-06-11 14:34:45:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 14:34:46:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 14:34:46:INFO:valid samples: (229,)
2024-06-11 14:34:46:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 14:34:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718087687 HTTP/1.1" 200 235
2024-06-11 14:34:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 14:34:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 14:34:48:INFO:test samples: (686,)
2024-06-11 14:34:48:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 14:34:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718087688 HTTP/1.1" 200 235
2024-06-11 14:34:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 14:34:49:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 14:34:49:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 14:34:49:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718087690 HTTP/1.1" 200 235
2024-06-11 14:34:50:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 14:34:50:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 14:34:50:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-11 14:34:50:WARNING:Try importing flash-attention for faster inference...
2024-06-11 14:34:50:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-11 14:34:50:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-11 14:34:50:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-11 14:34:51:INFO:trainable params: 1310284 || all params: 1838138956 || trainable%: 0.07128318540461856
2024-06-11 14:34:51:INFO:Init labels...
2024-06-11 14:34:51:INFO:Start training...
2024-06-11 14:35:06:INFO:TRAIN-(cmcm) (1/1/4)>> loss: 3.3800
2024-06-11 14:35:08:INFO:VAL-(cmcm) >>
2024-06-11 14:35:08:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5370  Non0_F1_score: 0.5303  Mult_acc_5: 0.1703  Mult_acc_7: 0.1703  MAE: 1.4715  Corr: -0.0008 
2024-06-11 14:35:09:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-11 14:35:24:INFO:TRAIN-(cmcm) (1/2/4)>> loss: 1.0793
2024-06-11 14:35:26:INFO:VAL-(cmcm) >>
2024-06-11 14:35:26:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.4438  Non0_acc_2: 0.5880  Non0_F1_score: 0.4703  Mult_acc_5: 0.1965  Mult_acc_7: 0.1834  MAE: 1.4720  Corr: 0.0427 
2024-06-11 14:35:41:INFO:TRAIN-(cmcm) (2/3/4)>> loss: 1.0226
2024-06-11 14:35:44:INFO:VAL-(cmcm) >>
2024-06-11 14:35:44:INFO:M: >>  Has0_acc_2: 0.5590  Has0_F1_score: 0.5462  Non0_acc_2: 0.5648  Non0_F1_score: 0.5514  Mult_acc_5: 0.2533  Mult_acc_7: 0.2140  MAE: 1.6440  Corr: 0.0247 
2024-06-11 14:35:58:INFO:TRAIN-(cmcm) (3/4/4)>> loss: 0.9731
2024-06-11 14:36:01:INFO:VAL-(cmcm) >>
2024-06-11 14:36:01:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5100  Non0_acc_2: 0.5833  Non0_F1_score: 0.5013  Mult_acc_5: 0.2227  Mult_acc_7: 0.1747  MAE: 1.5848  Corr: 0.0503 
2024-06-11 14:36:15:INFO:TRAIN-(cmcm) (4/5/4)>> loss: 1.2048
2024-06-11 14:36:18:INFO:VAL-(cmcm) >>
2024-06-11 14:36:18:INFO:M: >>  Has0_acc_2: 0.4760  Has0_F1_score: 0.4423  Non0_acc_2: 0.4861  Non0_F1_score: 0.4400  Mult_acc_5: 0.1659  Mult_acc_7: 0.1659  MAE: 1.6122  Corr: 0.0714 
2024-06-11 14:36:33:INFO:TRAIN-(cmcm) (5/6/4)>> loss: 0.9913
2024-06-11 14:36:35:INFO:VAL-(cmcm) >>
2024-06-11 14:36:35:INFO:M: >>  Has0_acc_2: 0.5590  Has0_F1_score: 0.4939  Non0_acc_2: 0.4861  Non0_F1_score: 0.4783  Mult_acc_5: 0.1790  Mult_acc_7: 0.1790  MAE: 1.5196  Corr: -0.0352 
2024-06-11 14:36:50:INFO:TRAIN-(cmcm) (6/7/4)>> loss: 0.9571
2024-06-11 14:36:52:INFO:VAL-(cmcm) >>
2024-06-11 14:36:52:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.5626  Non0_acc_2: 0.5648  Non0_F1_score: 0.5497  Mult_acc_5: 0.1878  Mult_acc_7: 0.1878  MAE: 1.5698  Corr: 0.0485 
2024-06-11 14:37:07:INFO:TRAIN-(cmcm) (7/8/4)>> loss: 0.9346
2024-06-11 14:37:10:INFO:VAL-(cmcm) >>
2024-06-11 14:37:10:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5895  Non0_acc_2: 0.5741  Non0_F1_score: 0.5734  Mult_acc_5: 0.1616  Mult_acc_7: 0.1616  MAE: 1.5641  Corr: 0.0816 
2024-06-11 14:37:24:INFO:TRAIN-(cmcm) (8/9/4)>> loss: 0.9088
2024-06-11 14:37:27:INFO:VAL-(cmcm) >>
2024-06-11 14:37:27:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5003  Non0_acc_2: 0.5463  Non0_F1_score: 0.4764  Mult_acc_5: 0.2227  Mult_acc_7: 0.1834  MAE: 1.5545  Corr: -0.0216 
2024-06-11 14:37:42:INFO:TRAIN-(cmcm) (9/10/4)>> loss: 0.8926
2024-06-11 14:37:44:INFO:VAL-(cmcm) >>
2024-06-11 14:37:44:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5934  Non0_acc_2: 0.5926  Non0_F1_score: 0.5947  Mult_acc_5: 0.2533  Mult_acc_7: 0.2140  MAE: 1.5966  Corr: 0.1672 
2024-06-11 14:37:59:INFO:TRAIN-(cmcm) (10/11/4)>> loss: 0.8861
2024-06-11 14:38:01:INFO:VAL-(cmcm) >>
2024-06-11 14:38:01:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4978  Non0_acc_2: 0.5741  Non0_F1_score: 0.4742  Mult_acc_5: 0.2882  Mult_acc_7: 0.2052  MAE: 1.6341  Corr: 0.0668 
2024-06-11 14:38:09:INFO:TEST-(cmcm) >>
2024-06-11 14:38:09:INFO:M: >>  Has0_acc_2: 0.4504  Has0_F1_score: 0.2831  Non0_acc_2: 0.4741  Non0_F1_score: 0.4613  Mult_acc_5: 0.1676  Mult_acc_7: 0.1676  MAE: 1.6427  Corr: 0.0013 
2024-06-11 14:38:09:INFO:Results are added to results/results/mosi-regression-30.csv...
2024-06-11 14:38:09:INFO:Start running cmcm...
2024-06-11 14:38:09:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 5555}>
2024-06-11 14:38:09:INFO:Let's use the GPU 1 !
2024-06-11 14:38:09:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 14:38:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718087890 HTTP/1.1" 200 235
2024-06-11 14:38:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 14:38:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 14:38:11:INFO:train samples: (1284,)
2024-06-11 14:38:11:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 14:38:11:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718087892 HTTP/1.1" 200 235
2024-06-11 14:38:11:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 14:38:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 14:38:12:INFO:valid samples: (229,)
2024-06-11 14:38:12:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 14:38:13:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718087893 HTTP/1.1" 200 235
2024-06-11 14:38:13:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 14:38:13:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 14:38:14:INFO:test samples: (686,)
2024-06-11 14:38:14:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 14:38:14:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718087894 HTTP/1.1" 200 235
2024-06-11 14:38:14:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 14:38:15:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 14:38:15:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 14:38:15:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718087896 HTTP/1.1" 200 235
2024-06-11 14:38:16:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 14:38:16:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 14:38:16:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-11 14:38:16:WARNING:Try importing flash-attention for faster inference...
2024-06-11 14:38:16:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-11 14:38:16:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-11 14:38:16:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-11 14:38:17:INFO:trainable params: 1310284 || all params: 1838138956 || trainable%: 0.07128318540461856
2024-06-11 14:38:17:INFO:Init labels...
2024-06-11 14:38:17:INFO:Start training...
2024-06-11 14:38:32:INFO:TRAIN-(cmcm) (1/1/5)>> loss: 2.8712
2024-06-11 14:38:35:INFO:VAL-(cmcm) >>
2024-06-11 14:38:35:INFO:M: >>  Has0_acc_2: 0.4498  Has0_F1_score: 0.4312  Non0_acc_2: 0.4537  Non0_F1_score: 0.4188  Mult_acc_5: 0.1659  Mult_acc_7: 0.1572  MAE: 1.5881  Corr: -0.0608 
2024-06-11 14:38:35:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-11 14:38:50:INFO:TRAIN-(cmcm) (1/2/5)>> loss: 1.0136
2024-06-11 14:38:53:INFO:VAL-(cmcm) >>
2024-06-11 14:38:53:INFO:M: >>  Has0_acc_2: 0.5371  Has0_F1_score: 0.5320  Non0_acc_2: 0.5463  Non0_F1_score: 0.5421  Mult_acc_5: 0.2096  Mult_acc_7: 0.1572  MAE: 1.6926  Corr: 0.0003 
2024-06-11 14:39:07:INFO:TRAIN-(cmcm) (2/3/5)>> loss: 0.9554
2024-06-11 14:39:10:INFO:VAL-(cmcm) >>
2024-06-11 14:39:10:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4830  Non0_acc_2: 0.5741  Non0_F1_score: 0.4622  Mult_acc_5: 0.2271  Mult_acc_7: 0.1921  MAE: 1.5973  Corr: 0.0671 
2024-06-11 14:39:24:INFO:TRAIN-(cmcm) (3/4/5)>> loss: 0.9043
2024-06-11 14:39:27:INFO:VAL-(cmcm) >>
2024-06-11 14:39:27:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.4674  Non0_acc_2: 0.5787  Non0_F1_score: 0.4649  Mult_acc_5: 0.1965  Mult_acc_7: 0.1659  MAE: 1.5261  Corr: 0.1076 
2024-06-11 14:39:27:INFO:Saving checkpoint at epoch 4 to results/models/cmcm-mosi-regression.pth.
2024-06-11 14:39:42:INFO:TRAIN-(cmcm) (1/5/5)>> loss: 0.8831
2024-06-11 14:39:45:INFO:VAL-(cmcm) >>
2024-06-11 14:39:45:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4723  Non0_acc_2: 0.5787  Non0_F1_score: 0.5370  Mult_acc_5: 0.2445  Mult_acc_7: 0.1965  MAE: 1.4664  Corr: 0.0923 
2024-06-11 14:39:45:INFO:Saving checkpoint at epoch 5 to results/models/cmcm-mosi-regression.pth.
2024-06-11 14:40:00:INFO:TRAIN-(cmcm) (1/6/5)>> loss: 0.8712
2024-06-11 14:40:03:INFO:VAL-(cmcm) >>
2024-06-11 14:40:03:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.5406  Non0_acc_2: 0.5648  Non0_F1_score: 0.5263  Mult_acc_5: 0.2795  Mult_acc_7: 0.2096  MAE: 1.6446  Corr: 0.0552 
2024-06-11 14:40:17:INFO:TRAIN-(cmcm) (2/7/5)>> loss: 0.8641
2024-06-11 14:40:20:INFO:VAL-(cmcm) >>
2024-06-11 14:40:20:INFO:M: >>  Has0_acc_2: 0.6201  Has0_F1_score: 0.6225  Non0_acc_2: 0.6296  Non0_F1_score: 0.6301  Mult_acc_5: 0.2926  Mult_acc_7: 0.2227  MAE: 1.4555  Corr: 0.2054 
2024-06-11 14:40:20:INFO:Saving checkpoint at epoch 7 to results/models/cmcm-mosi-regression.pth.
2024-06-11 14:40:36:INFO:TRAIN-(cmcm) (1/8/5)>> loss: 0.8573
2024-06-11 14:40:38:INFO:VAL-(cmcm) >>
2024-06-11 14:40:38:INFO:M: >>  Has0_acc_2: 0.5415  Has0_F1_score: 0.5153  Non0_acc_2: 0.5648  Non0_F1_score: 0.5392  Mult_acc_5: 0.1878  Mult_acc_7: 0.1266  MAE: 1.7057  Corr: 0.2282 
2024-06-11 14:40:53:INFO:TRAIN-(cmcm) (2/9/5)>> loss: 0.8401
2024-06-11 14:40:55:INFO:VAL-(cmcm) >>
2024-06-11 14:40:55:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.6140  Non0_acc_2: 0.6250  Non0_F1_score: 0.6261  Mult_acc_5: 0.2489  Mult_acc_7: 0.2096  MAE: 1.4603  Corr: 0.2845 
2024-06-11 14:41:10:INFO:TRAIN-(cmcm) (3/10/5)>> loss: 0.8284
2024-06-11 14:41:13:INFO:VAL-(cmcm) >>
2024-06-11 14:41:13:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.5606  Non0_acc_2: 0.5833  Non0_F1_score: 0.5406  Mult_acc_5: 0.2795  Mult_acc_7: 0.2314  MAE: 1.5114  Corr: 0.1530 
2024-06-11 14:41:27:INFO:TRAIN-(cmcm) (4/11/5)>> loss: 0.8294
2024-06-11 14:41:30:INFO:VAL-(cmcm) >>
2024-06-11 14:41:30:INFO:M: >>  Has0_acc_2: 0.6638  Has0_F1_score: 0.6670  Non0_acc_2: 0.6806  Non0_F1_score: 0.6823  Mult_acc_5: 0.2882  Mult_acc_7: 0.2402  MAE: 1.3464  Corr: 0.3994 
2024-06-11 14:41:30:INFO:Saving checkpoint at epoch 11 to results/models/cmcm-mosi-regression.pth.
2024-06-11 14:41:46:INFO:TRAIN-(cmcm) (1/12/5)>> loss: 0.8174
2024-06-11 14:41:49:INFO:VAL-(cmcm) >>
2024-06-11 14:41:49:INFO:M: >>  Has0_acc_2: 0.6507  Has0_F1_score: 0.6097  Non0_acc_2: 0.6389  Non0_F1_score: 0.5991  Mult_acc_5: 0.3057  Mult_acc_7: 0.2402  MAE: 1.4455  Corr: 0.2694 
2024-06-11 14:42:04:INFO:TRAIN-(cmcm) (2/13/5)>> loss: 0.8070
2024-06-11 14:42:06:INFO:VAL-(cmcm) >>
2024-06-11 14:42:06:INFO:M: >>  Has0_acc_2: 0.6638  Has0_F1_score: 0.6665  Non0_acc_2: 0.6806  Non0_F1_score: 0.6818  Mult_acc_5: 0.2926  Mult_acc_7: 0.2009  MAE: 1.3429  Corr: 0.4556 
2024-06-11 14:42:06:INFO:Saving checkpoint at epoch 13 to results/models/cmcm-mosi-regression.pth.
2024-06-11 14:42:21:INFO:TRAIN-(cmcm) (1/14/5)>> loss: 0.8047
2024-06-11 14:42:24:INFO:VAL-(cmcm) >>
2024-06-11 14:42:24:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.6013  Non0_acc_2: 0.6389  Non0_F1_score: 0.6329  Mult_acc_5: 0.3362  Mult_acc_7: 0.2445  MAE: 1.4835  Corr: 0.4022 
2024-06-11 14:42:38:INFO:TRAIN-(cmcm) (2/15/5)>> loss: 0.7905
2024-06-11 14:42:41:INFO:VAL-(cmcm) >>
2024-06-11 14:42:41:INFO:M: >>  Has0_acc_2: 0.6463  Has0_F1_score: 0.6140  Non0_acc_2: 0.6389  Non0_F1_score: 0.6116  Mult_acc_5: 0.3188  Mult_acc_7: 0.2402  MAE: 1.3931  Corr: 0.3232 
2024-06-11 14:42:55:INFO:TRAIN-(cmcm) (3/16/5)>> loss: 0.7841
2024-06-11 14:42:58:INFO:VAL-(cmcm) >>
2024-06-11 14:42:58:INFO:M: >>  Has0_acc_2: 0.6594  Has0_F1_score: 0.6547  Non0_acc_2: 0.6713  Non0_F1_score: 0.6715  Mult_acc_5: 0.2882  Mult_acc_7: 0.2445  MAE: 1.2538  Corr: 0.4326 
2024-06-11 14:42:58:INFO:Saving checkpoint at epoch 16 to results/models/cmcm-mosi-regression.pth.
2024-06-11 14:43:13:INFO:TRAIN-(cmcm) (1/17/5)>> loss: 0.7740
2024-06-11 14:43:16:INFO:VAL-(cmcm) >>
2024-06-11 14:43:16:INFO:M: >>  Has0_acc_2: 0.6550  Has0_F1_score: 0.6537  Non0_acc_2: 0.6667  Non0_F1_score: 0.6602  Mult_acc_5: 0.2882  Mult_acc_7: 0.2140  MAE: 1.2787  Corr: 0.4787 
2024-06-11 14:43:31:INFO:TRAIN-(cmcm) (2/18/5)>> loss: 0.7747
2024-06-11 14:43:33:INFO:VAL-(cmcm) >>
2024-06-11 14:43:33:INFO:M: >>  Has0_acc_2: 0.6419  Has0_F1_score: 0.6436  Non0_acc_2: 0.6620  Non0_F1_score: 0.6623  Mult_acc_5: 0.3319  Mult_acc_7: 0.2402  MAE: 1.3686  Corr: 0.4055 
2024-06-11 14:43:48:INFO:TRAIN-(cmcm) (3/19/5)>> loss: 0.7604
2024-06-11 14:43:50:INFO:VAL-(cmcm) >>
2024-06-11 14:43:50:INFO:M: >>  Has0_acc_2: 0.6594  Has0_F1_score: 0.6605  Non0_acc_2: 0.6481  Non0_F1_score: 0.6490  Mult_acc_5: 0.3188  Mult_acc_7: 0.2402  MAE: 1.2826  Corr: 0.4271 
2024-06-11 14:44:05:INFO:TRAIN-(cmcm) (4/20/5)>> loss: 0.7520
2024-06-11 14:44:07:INFO:VAL-(cmcm) >>
2024-06-11 14:44:07:INFO:M: >>  Has0_acc_2: 0.6594  Has0_F1_score: 0.6396  Non0_acc_2: 0.6620  Non0_F1_score: 0.6466  Mult_acc_5: 0.3493  Mult_acc_7: 0.2402  MAE: 1.2774  Corr: 0.4491 
2024-06-11 14:44:22:INFO:TRAIN-(cmcm) (5/21/5)>> loss: 0.7429
2024-06-11 14:44:25:INFO:VAL-(cmcm) >>
2024-06-11 14:44:25:INFO:M: >>  Has0_acc_2: 0.6550  Has0_F1_score: 0.6573  Non0_acc_2: 0.6713  Non0_F1_score: 0.6715  Mult_acc_5: 0.3624  Mult_acc_7: 0.2707  MAE: 1.2839  Corr: 0.4824 
2024-06-11 14:44:39:INFO:TRAIN-(cmcm) (6/22/5)>> loss: 0.7368
2024-06-11 14:44:42:INFO:VAL-(cmcm) >>
2024-06-11 14:44:42:INFO:M: >>  Has0_acc_2: 0.6507  Has0_F1_score: 0.6285  Non0_acc_2: 0.6944  Non0_F1_score: 0.6892  Mult_acc_5: 0.3668  Mult_acc_7: 0.2795  MAE: 1.2337  Corr: 0.4298 
2024-06-11 14:44:42:INFO:Saving checkpoint at epoch 22 to results/models/cmcm-mosi-regression.pth.
2024-06-11 14:44:57:INFO:TRAIN-(cmcm) (1/23/5)>> loss: 0.7293
2024-06-11 14:45:00:INFO:VAL-(cmcm) >>
2024-06-11 14:45:00:INFO:M: >>  Has0_acc_2: 0.6638  Has0_F1_score: 0.6640  Non0_acc_2: 0.6250  Non0_F1_score: 0.6252  Mult_acc_5: 0.3188  Mult_acc_7: 0.2489  MAE: 1.2437  Corr: 0.4306 
2024-06-11 14:45:15:INFO:TRAIN-(cmcm) (2/24/5)>> loss: 0.7209
2024-06-11 14:45:17:INFO:VAL-(cmcm) >>
2024-06-11 14:45:17:INFO:M: >>  Has0_acc_2: 0.6463  Has0_F1_score: 0.6494  Non0_acc_2: 0.6296  Non0_F1_score: 0.6291  Mult_acc_5: 0.3319  Mult_acc_7: 0.2489  MAE: 1.2747  Corr: 0.4386 
2024-06-11 14:45:32:INFO:TRAIN-(cmcm) (3/25/5)>> loss: 0.7147
2024-06-11 14:45:34:INFO:VAL-(cmcm) >>
2024-06-11 14:45:34:INFO:M: >>  Has0_acc_2: 0.6507  Has0_F1_score: 0.6437  Non0_acc_2: 0.6435  Non0_F1_score: 0.6433  Mult_acc_5: 0.3668  Mult_acc_7: 0.2751  MAE: 1.2538  Corr: 0.4469 
2024-06-11 14:45:49:INFO:TRAIN-(cmcm) (4/26/5)>> loss: 0.7035
2024-06-11 14:45:51:INFO:VAL-(cmcm) >>
2024-06-11 14:45:51:INFO:M: >>  Has0_acc_2: 0.6681  Has0_F1_score: 0.6661  Non0_acc_2: 0.6713  Non0_F1_score: 0.6715  Mult_acc_5: 0.3362  Mult_acc_7: 0.2533  MAE: 1.2398  Corr: 0.4477 
2024-06-11 14:46:06:INFO:TRAIN-(cmcm) (5/27/5)>> loss: 0.6969
2024-06-11 14:46:08:INFO:VAL-(cmcm) >>
2024-06-11 14:46:08:INFO:M: >>  Has0_acc_2: 0.6725  Has0_F1_score: 0.6722  Non0_acc_2: 0.6620  Non0_F1_score: 0.6638  Mult_acc_5: 0.3450  Mult_acc_7: 0.2576  MAE: 1.2267  Corr: 0.4585 
2024-06-11 14:46:09:INFO:Saving checkpoint at epoch 27 to results/models/cmcm-mosi-regression.pth.
2024-06-11 14:46:24:INFO:TRAIN-(cmcm) (1/28/5)>> loss: 0.6938
2024-06-11 14:46:26:INFO:VAL-(cmcm) >>
2024-06-11 14:46:26:INFO:M: >>  Has0_acc_2: 0.6681  Has0_F1_score: 0.6668  Non0_acc_2: 0.6667  Non0_F1_score: 0.6681  Mult_acc_5: 0.3319  Mult_acc_7: 0.2489  MAE: 1.2302  Corr: 0.4558 
2024-06-11 14:46:41:INFO:TRAIN-(cmcm) (2/29/5)>> loss: 0.6897
2024-06-11 14:46:43:INFO:VAL-(cmcm) >>
2024-06-11 14:46:43:INFO:M: >>  Has0_acc_2: 0.6769  Has0_F1_score: 0.6783  Non0_acc_2: 0.6620  Non0_F1_score: 0.6639  Mult_acc_5: 0.3362  Mult_acc_7: 0.2489  MAE: 1.2215  Corr: 0.4694 
2024-06-11 14:46:44:INFO:Saving checkpoint at epoch 29 to results/models/cmcm-mosi-regression.pth.
2024-06-11 14:46:58:INFO:TRAIN-(cmcm) (1/30/5)>> loss: 0.6901
2024-06-11 14:47:01:INFO:VAL-(cmcm) >>
2024-06-11 14:47:01:INFO:M: >>  Has0_acc_2: 0.6725  Has0_F1_score: 0.6742  Non0_acc_2: 0.6528  Non0_F1_score: 0.6546  Mult_acc_5: 0.3406  Mult_acc_7: 0.2576  MAE: 1.2267  Corr: 0.4659 
2024-06-11 14:47:16:INFO:TRAIN-(cmcm) (2/31/5)>> loss: 0.6893
2024-06-11 14:47:18:INFO:VAL-(cmcm) >>
2024-06-11 14:47:18:INFO:M: >>  Has0_acc_2: 0.6725  Has0_F1_score: 0.6742  Non0_acc_2: 0.6528  Non0_F1_score: 0.6546  Mult_acc_5: 0.3406  Mult_acc_7: 0.2576  MAE: 1.2232  Corr: 0.4664 
2024-06-11 14:47:33:INFO:TRAIN-(cmcm) (3/32/5)>> loss: 0.6906
2024-06-11 14:47:35:INFO:VAL-(cmcm) >>
2024-06-11 14:47:35:INFO:M: >>  Has0_acc_2: 0.6638  Has0_F1_score: 0.6628  Non0_acc_2: 0.6528  Non0_F1_score: 0.6545  Mult_acc_5: 0.3406  Mult_acc_7: 0.2576  MAE: 1.2398  Corr: 0.4483 
2024-06-11 14:47:50:INFO:TRAIN-(cmcm) (4/33/5)>> loss: 0.6915
2024-06-11 14:47:52:INFO:VAL-(cmcm) >>
2024-06-11 14:47:52:INFO:M: >>  Has0_acc_2: 0.6681  Has0_F1_score: 0.6700  Non0_acc_2: 0.6574  Non0_F1_score: 0.6590  Mult_acc_5: 0.3362  Mult_acc_7: 0.2533  MAE: 1.2354  Corr: 0.4607 
2024-06-11 14:48:08:INFO:TRAIN-(cmcm) (5/34/5)>> loss: 0.6947
2024-06-11 14:48:10:INFO:VAL-(cmcm) >>
2024-06-11 14:48:10:INFO:M: >>  Has0_acc_2: 0.6769  Has0_F1_score: 0.6783  Non0_acc_2: 0.6852  Non0_F1_score: 0.6867  Mult_acc_5: 0.3450  Mult_acc_7: 0.2620  MAE: 1.2276  Corr: 0.4652 
2024-06-11 14:48:25:INFO:TRAIN-(cmcm) (6/35/5)>> loss: 0.6954
2024-06-11 14:48:27:INFO:VAL-(cmcm) >>
2024-06-11 14:48:27:INFO:M: >>  Has0_acc_2: 0.6812  Has0_F1_score: 0.6803  Non0_acc_2: 0.6759  Non0_F1_score: 0.6775  Mult_acc_5: 0.3406  Mult_acc_7: 0.2576  MAE: 1.2189  Corr: 0.4654 
2024-06-11 14:48:28:INFO:Saving checkpoint at epoch 35 to results/models/cmcm-mosi-regression.pth.
2024-06-11 14:48:43:INFO:TRAIN-(cmcm) (1/36/5)>> loss: 0.6995
2024-06-11 14:48:45:INFO:VAL-(cmcm) >>
2024-06-11 14:48:45:INFO:M: >>  Has0_acc_2: 0.6725  Has0_F1_score: 0.6733  Non0_acc_2: 0.6806  Non0_F1_score: 0.6823  Mult_acc_5: 0.3537  Mult_acc_7: 0.2664  MAE: 1.2354  Corr: 0.4634 
2024-06-11 14:49:00:INFO:TRAIN-(cmcm) (2/37/5)>> loss: 0.7042
2024-06-11 14:49:02:INFO:VAL-(cmcm) >>
2024-06-11 14:49:02:INFO:M: >>  Has0_acc_2: 0.6681  Has0_F1_score: 0.6700  Non0_acc_2: 0.6620  Non0_F1_score: 0.6639  Mult_acc_5: 0.3362  Mult_acc_7: 0.2489  MAE: 1.2232  Corr: 0.4661 
2024-06-11 14:49:17:INFO:TRAIN-(cmcm) (3/38/5)>> loss: 0.7065
2024-06-11 14:49:20:INFO:VAL-(cmcm) >>
2024-06-11 14:49:20:INFO:M: >>  Has0_acc_2: 0.6550  Has0_F1_score: 0.6580  Non0_acc_2: 0.6528  Non0_F1_score: 0.6546  Mult_acc_5: 0.3144  Mult_acc_7: 0.2271  MAE: 1.2651  Corr: 0.4609 
2024-06-11 14:49:34:INFO:TRAIN-(cmcm) (4/39/5)>> loss: 0.7164
2024-06-11 14:49:37:INFO:VAL-(cmcm) >>
2024-06-11 14:49:37:INFO:M: >>  Has0_acc_2: 0.6900  Has0_F1_score: 0.6912  Non0_acc_2: 0.5972  Non0_F1_score: 0.5900  Mult_acc_5: 0.2707  Mult_acc_7: 0.1965  MAE: 1.2717  Corr: 0.4442 
2024-06-11 14:49:51:INFO:TRAIN-(cmcm) (5/40/5)>> loss: 0.7160
2024-06-11 14:49:54:INFO:VAL-(cmcm) >>
2024-06-11 14:49:54:INFO:M: >>  Has0_acc_2: 0.6419  Has0_F1_score: 0.6447  Non0_acc_2: 0.6620  Non0_F1_score: 0.6627  Mult_acc_5: 0.3188  Mult_acc_7: 0.2183  MAE: 1.3966  Corr: 0.4222 
2024-06-11 14:50:09:INFO:TRAIN-(cmcm) (6/41/5)>> loss: 0.7269
2024-06-11 14:50:11:INFO:VAL-(cmcm) >>
2024-06-11 14:50:11:INFO:M: >>  Has0_acc_2: 0.6507  Has0_F1_score: 0.6468  Non0_acc_2: 0.6481  Non0_F1_score: 0.6470  Mult_acc_5: 0.3406  Mult_acc_7: 0.2489  MAE: 1.2337  Corr: 0.4661 
2024-06-11 14:50:26:INFO:TRAIN-(cmcm) (7/42/5)>> loss: 0.7259
2024-06-11 14:50:28:INFO:VAL-(cmcm) >>
2024-06-11 14:50:28:INFO:M: >>  Has0_acc_2: 0.6725  Has0_F1_score: 0.6630  Non0_acc_2: 0.6759  Non0_F1_score: 0.6671  Mult_acc_5: 0.3057  Mult_acc_7: 0.2140  MAE: 1.2503  Corr: 0.4609 
2024-06-11 14:50:43:INFO:TRAIN-(cmcm) (8/43/5)>> loss: 0.7342
2024-06-11 14:50:46:INFO:VAL-(cmcm) >>
2024-06-11 14:50:46:INFO:M: >>  Has0_acc_2: 0.6507  Has0_F1_score: 0.6538  Non0_acc_2: 0.6250  Non0_F1_score: 0.6147  Mult_acc_5: 0.2795  Mult_acc_7: 0.1965  MAE: 1.3162  Corr: 0.4397 
2024-06-11 14:51:00:INFO:TRAIN-(cmcm) (9/44/5)>> loss: 0.7381
2024-06-11 14:51:03:INFO:VAL-(cmcm) >>
2024-06-11 14:51:03:INFO:M: >>  Has0_acc_2: 0.6463  Has0_F1_score: 0.6497  Non0_acc_2: 0.6713  Non0_F1_score: 0.6731  Mult_acc_5: 0.3188  Mult_acc_7: 0.2314  MAE: 1.3433  Corr: 0.4479 
2024-06-11 14:51:18:INFO:TRAIN-(cmcm) (10/45/5)>> loss: 0.7420
2024-06-11 14:51:20:INFO:VAL-(cmcm) >>
2024-06-11 14:51:20:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.5875  Non0_acc_2: 0.6019  Non0_F1_score: 0.5764  Mult_acc_5: 0.2314  Mult_acc_7: 0.1703  MAE: 1.5049  Corr: 0.4167 
2024-06-11 14:51:28:INFO:TEST-(cmcm) >>
2024-06-11 14:51:28:INFO:M: >>  Has0_acc_2: 0.6706  Has0_F1_score: 0.6715  Non0_acc_2: 0.6875  Non0_F1_score: 0.6880  Mult_acc_5: 0.3294  Mult_acc_7: 0.2872  MAE: 1.2416  Corr: 0.4174 
2024-06-11 14:51:28:INFO:Results are added to results/results/mosi-regression-30.csv...
2024-06-11 16:11:06:INFO:Start running cmcm...
2024-06-11 16:11:06:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-06-11 16:11:06:INFO:Find gpu: 1, with memory: 378273792 left!
2024-06-11 16:11:06:INFO:Let's use the GPU 1 !
2024-06-11 16:11:06:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 16:11:07:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718093467 HTTP/1.1" 200 235
2024-06-11 16:11:07:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 16:11:07:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 16:11:08:INFO:train samples: (1284,)
2024-06-11 16:11:08:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 16:11:09:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718093469 HTTP/1.1" 200 235
2024-06-11 16:11:09:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 16:11:09:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 16:11:10:INFO:valid samples: (229,)
2024-06-11 16:11:10:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 16:11:11:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718093471 HTTP/1.1" 200 235
2024-06-11 16:11:11:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 16:11:11:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 16:11:12:INFO:test samples: (686,)
2024-06-11 16:11:12:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 16:11:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718093472 HTTP/1.1" 200 235
2024-06-11 16:11:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 16:11:13:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 16:11:13:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 16:11:13:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718093474 HTTP/1.1" 200 235
2024-06-11 16:11:14:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 16:11:14:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 16:11:14:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-11 16:11:14:WARNING:Try importing flash-attention for faster inference...
2024-06-11 16:11:14:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-11 16:11:14:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-11 16:11:14:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-11 16:11:16:INFO:trainable params: 1310284 || all params: 1838138956 || trainable%: 0.07128318540461856
2024-06-11 16:11:16:INFO:Init labels...
2024-06-11 16:11:16:INFO:Start training...
2024-06-11 16:11:31:INFO:TRAIN-(cmcm) (1/1/1)>> loss: 1.8845
2024-06-11 16:11:34:INFO:VAL-(cmcm) >>
2024-06-11 16:11:34:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4767  Non0_acc_2: 0.5833  Non0_F1_score: 0.5191  Mult_acc_5: 0.1921  Mult_acc_7: 0.1528  MAE: 1.6320  Corr: 0.1348 
2024-06-11 16:11:36:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-11 16:11:51:INFO:TRAIN-(cmcm) (1/2/1)>> loss: 0.9272
2024-06-11 16:11:54:INFO:VAL-(cmcm) >>
2024-06-11 16:11:54:INFO:M: >>  Has0_acc_2: 0.6332  Has0_F1_score: 0.6009  Non0_acc_2: 0.6296  Non0_F1_score: 0.5943  Mult_acc_5: 0.1921  Mult_acc_7: 0.1790  MAE: 1.4970  Corr: 0.2294 
2024-06-11 16:11:54:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-11 16:12:09:INFO:TRAIN-(cmcm) (1/3/1)>> loss: 0.8910
2024-06-11 16:12:12:INFO:VAL-(cmcm) >>
2024-06-11 16:12:12:INFO:M: >>  Has0_acc_2: 0.6681  Has0_F1_score: 0.6579  Non0_acc_2: 0.6759  Non0_F1_score: 0.6646  Mult_acc_5: 0.2664  Mult_acc_7: 0.2314  MAE: 1.3114  Corr: 0.3639 
2024-06-11 16:12:13:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-mosi-regression.pth.
2024-06-11 16:12:28:INFO:TRAIN-(cmcm) (1/4/1)>> loss: 0.8625
2024-06-11 16:12:30:INFO:VAL-(cmcm) >>
2024-06-11 16:12:30:INFO:M: >>  Has0_acc_2: 0.7205  Has0_F1_score: 0.7200  Non0_acc_2: 0.7315  Non0_F1_score: 0.7296  Mult_acc_5: 0.3843  Mult_acc_7: 0.2707  MAE: 1.2739  Corr: 0.4655 
2024-06-11 16:12:31:INFO:Saving checkpoint at epoch 4 to results/models/cmcm-mosi-regression.pth.
2024-06-11 16:12:46:INFO:TRAIN-(cmcm) (1/5/1)>> loss: 0.8351
2024-06-11 16:12:49:INFO:VAL-(cmcm) >>
2024-06-11 16:12:49:INFO:M: >>  Has0_acc_2: 0.6943  Has0_F1_score: 0.6907  Non0_acc_2: 0.7176  Non0_F1_score: 0.7125  Mult_acc_5: 0.2795  Mult_acc_7: 0.2402  MAE: 1.1778  Corr: 0.5212 
2024-06-11 16:12:50:INFO:Saving checkpoint at epoch 5 to results/models/cmcm-mosi-regression.pth.
2024-06-11 16:13:05:INFO:TRAIN-(cmcm) (1/6/1)>> loss: 0.8039
2024-06-11 16:13:08:INFO:VAL-(cmcm) >>
2024-06-11 16:13:08:INFO:M: >>  Has0_acc_2: 0.7031  Has0_F1_score: 0.7049  Non0_acc_2: 0.6806  Non0_F1_score: 0.6718  Mult_acc_5: 0.2969  Mult_acc_7: 0.2402  MAE: 1.1787  Corr: 0.5792 
2024-06-11 16:13:22:INFO:TRAIN-(cmcm) (2/7/1)>> loss: 0.8015
2024-06-11 16:13:25:INFO:VAL-(cmcm) >>
2024-06-11 16:13:25:INFO:M: >>  Has0_acc_2: 0.7074  Has0_F1_score: 0.6990  Non0_acc_2: 0.7222  Non0_F1_score: 0.7147  Mult_acc_5: 0.3712  Mult_acc_7: 0.3144  MAE: 1.0651  Corr: 0.5915 
2024-06-11 16:13:26:INFO:Saving checkpoint at epoch 7 to results/models/cmcm-mosi-regression.pth.
2024-06-11 16:13:41:INFO:TRAIN-(cmcm) (1/8/1)>> loss: 0.7861
2024-06-11 16:13:43:INFO:VAL-(cmcm) >>
2024-06-11 16:13:43:INFO:M: >>  Has0_acc_2: 0.7598  Has0_F1_score: 0.7581  Non0_acc_2: 0.7593  Non0_F1_score: 0.7575  Mult_acc_5: 0.4017  Mult_acc_7: 0.3100  MAE: 1.0768  Corr: 0.6103 
2024-06-11 16:13:58:INFO:TRAIN-(cmcm) (2/9/1)>> loss: 0.7804
2024-06-11 16:14:00:INFO:VAL-(cmcm) >>
2024-06-11 16:14:00:INFO:M: >>  Has0_acc_2: 0.7511  Has0_F1_score: 0.7480  Non0_acc_2: 0.7778  Non0_F1_score: 0.7771  Mult_acc_5: 0.3799  Mult_acc_7: 0.3231  MAE: 1.0193  Corr: 0.6169 
2024-06-11 16:14:01:INFO:Saving checkpoint at epoch 9 to results/models/cmcm-mosi-regression.pth.
2024-06-11 16:14:16:INFO:TRAIN-(cmcm) (1/10/1)>> loss: 0.7667
2024-06-11 16:14:19:INFO:VAL-(cmcm) >>
2024-06-11 16:14:19:INFO:M: >>  Has0_acc_2: 0.7511  Has0_F1_score: 0.7529  Non0_acc_2: 0.7778  Non0_F1_score: 0.7789  Mult_acc_5: 0.4279  Mult_acc_7: 0.3275  MAE: 1.0341  Corr: 0.6211 
2024-06-11 16:14:33:INFO:TRAIN-(cmcm) (2/11/1)>> loss: 0.7499
2024-06-11 16:14:36:INFO:VAL-(cmcm) >>
2024-06-11 16:14:36:INFO:M: >>  Has0_acc_2: 0.7336  Has0_F1_score: 0.7329  Non0_acc_2: 0.7222  Non0_F1_score: 0.7229  Mult_acc_5: 0.4017  Mult_acc_7: 0.3275  MAE: 1.0171  Corr: 0.6170 
2024-06-11 16:14:37:INFO:Saving checkpoint at epoch 11 to results/models/cmcm-mosi-regression.pth.
2024-06-11 16:14:52:INFO:TRAIN-(cmcm) (1/12/1)>> loss: 0.7454
2024-06-11 16:14:54:INFO:VAL-(cmcm) >>
2024-06-11 16:14:54:INFO:M: >>  Has0_acc_2: 0.7773  Has0_F1_score: 0.7775  Non0_acc_2: 0.7731  Non0_F1_score: 0.7744  Mult_acc_5: 0.4105  Mult_acc_7: 0.3231  MAE: 1.0101  Corr: 0.6404 
2024-06-11 16:14:55:INFO:Saving checkpoint at epoch 12 to results/models/cmcm-mosi-regression.pth.
2024-06-11 16:15:10:INFO:TRAIN-(cmcm) (1/13/1)>> loss: 0.7309
2024-06-11 16:15:13:INFO:VAL-(cmcm) >>
2024-06-11 16:15:13:INFO:M: >>  Has0_acc_2: 0.7249  Has0_F1_score: 0.7256  Non0_acc_2: 0.7269  Non0_F1_score: 0.7247  Mult_acc_5: 0.3930  Mult_acc_7: 0.3144  MAE: 1.0721  Corr: 0.5790 
2024-06-11 16:15:27:INFO:TRAIN-(cmcm) (2/14/1)>> loss: 0.7241
2024-06-11 16:15:30:INFO:VAL-(cmcm) >>
2024-06-11 16:15:30:INFO:M: >>  Has0_acc_2: 0.7380  Has0_F1_score: 0.7384  Non0_acc_2: 0.8009  Non0_F1_score: 0.8018  Mult_acc_5: 0.4498  Mult_acc_7: 0.3450  MAE: 0.9669  Corr: 0.6533 
2024-06-11 16:15:31:INFO:Saving checkpoint at epoch 14 to results/models/cmcm-mosi-regression.pth.
2024-06-11 16:15:46:INFO:TRAIN-(cmcm) (1/15/1)>> loss: 0.7172
2024-06-11 16:15:48:INFO:VAL-(cmcm) >>
2024-06-11 16:15:48:INFO:M: >>  Has0_acc_2: 0.7293  Has0_F1_score: 0.7105  Non0_acc_2: 0.7269  Non0_F1_score: 0.7071  Mult_acc_5: 0.4323  Mult_acc_7: 0.3275  MAE: 1.0717  Corr: 0.5636 
2024-06-11 16:16:03:INFO:TRAIN-(cmcm) (2/16/1)>> loss: 0.7024
2024-06-11 16:16:06:INFO:VAL-(cmcm) >>
2024-06-11 16:16:06:INFO:M: >>  Has0_acc_2: 0.7424  Has0_F1_score: 0.7448  Non0_acc_2: 0.7546  Non0_F1_score: 0.7551  Mult_acc_5: 0.4236  Mult_acc_7: 0.3319  MAE: 1.0507  Corr: 0.6181 
2024-06-11 16:16:20:INFO:TRAIN-(cmcm) (3/17/1)>> loss: 0.7046
2024-06-11 16:16:23:INFO:VAL-(cmcm) >>
2024-06-11 16:16:23:INFO:M: >>  Has0_acc_2: 0.7074  Has0_F1_score: 0.6880  Non0_acc_2: 0.7269  Non0_F1_score: 0.7156  Mult_acc_5: 0.3668  Mult_acc_7: 0.2795  MAE: 1.1092  Corr: 0.5821 
2024-06-11 16:16:37:INFO:TRAIN-(cmcm) (4/18/1)>> loss: 0.7026
2024-06-11 16:16:40:INFO:VAL-(cmcm) >>
2024-06-11 16:16:40:INFO:M: >>  Has0_acc_2: 0.7686  Has0_F1_score: 0.7691  Non0_acc_2: 0.7778  Non0_F1_score: 0.7774  Mult_acc_5: 0.4498  Mult_acc_7: 0.3406  MAE: 0.9948  Corr: 0.6299 
2024-06-11 16:16:55:INFO:TRAIN-(cmcm) (5/19/1)>> loss: 0.6591
2024-06-11 16:16:57:INFO:VAL-(cmcm) >>
2024-06-11 16:16:57:INFO:M: >>  Has0_acc_2: 0.7991  Has0_F1_score: 0.7991  Non0_acc_2: 0.7824  Non0_F1_score: 0.7830  Mult_acc_5: 0.4105  Mult_acc_7: 0.3144  MAE: 1.0009  Corr: 0.6291 
2024-06-11 16:17:12:INFO:TRAIN-(cmcm) (6/20/1)>> loss: 0.6515
2024-06-11 16:17:14:INFO:VAL-(cmcm) >>
2024-06-11 16:17:14:INFO:M: >>  Has0_acc_2: 0.7991  Has0_F1_score: 0.7991  Non0_acc_2: 0.7917  Non0_F1_score: 0.7923  Mult_acc_5: 0.4454  Mult_acc_7: 0.3581  MAE: 0.9699  Corr: 0.6443 
2024-06-11 16:17:29:INFO:TRAIN-(cmcm) (7/21/1)>> loss: 0.6408
2024-06-11 16:17:32:INFO:VAL-(cmcm) >>
2024-06-11 16:17:32:INFO:M: >>  Has0_acc_2: 0.7686  Has0_F1_score: 0.7704  Non0_acc_2: 0.7778  Non0_F1_score: 0.7771  Mult_acc_5: 0.4585  Mult_acc_7: 0.3581  MAE: 0.9756  Corr: 0.6506 
2024-06-11 16:17:46:INFO:TRAIN-(cmcm) (8/22/1)>> loss: 0.6291
2024-06-11 16:17:49:INFO:VAL-(cmcm) >>
2024-06-11 16:17:49:INFO:M: >>  Has0_acc_2: 0.7467  Has0_F1_score: 0.7357  Non0_acc_2: 0.8009  Non0_F1_score: 0.8020  Mult_acc_5: 0.4279  Mult_acc_7: 0.3493  MAE: 1.0049  Corr: 0.6208 
2024-06-11 16:18:03:INFO:TRAIN-(cmcm) (9/23/1)>> loss: 0.6074
2024-06-11 16:18:06:INFO:VAL-(cmcm) >>
2024-06-11 16:18:06:INFO:M: >>  Has0_acc_2: 0.7555  Has0_F1_score: 0.7479  Non0_acc_2: 0.7731  Non0_F1_score: 0.7736  Mult_acc_5: 0.4323  Mult_acc_7: 0.3406  MAE: 1.0084  Corr: 0.6191 
2024-06-11 16:18:21:INFO:TRAIN-(cmcm) (10/24/1)>> loss: 0.5879
2024-06-11 16:18:23:INFO:VAL-(cmcm) >>
2024-06-11 16:18:23:INFO:M: >>  Has0_acc_2: 0.7642  Has0_F1_score: 0.7638  Non0_acc_2: 0.7639  Non0_F1_score: 0.7640  Mult_acc_5: 0.4017  Mult_acc_7: 0.3057  MAE: 1.0573  Corr: 0.6028 
2024-06-11 16:18:31:INFO:TEST-(cmcm) >>
2024-06-11 16:18:31:INFO:M: >>  Has0_acc_2: 0.7566  Has0_F1_score: 0.7567  Non0_acc_2: 0.7774  Non0_F1_score: 0.7770  Mult_acc_5: 0.4038  Mult_acc_7: 0.3367  MAE: 0.9915  Corr: 0.6158 
2024-06-11 16:18:31:INFO:Results are added to results/results/mosi-regression-30.csv...
2024-06-11 16:18:31:INFO:Start running cmcm...
2024-06-11 16:18:31:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 2222}>
2024-06-11 16:18:31:INFO:Let's use the GPU 1 !
2024-06-11 16:18:31:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 16:18:32:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718093912 HTTP/1.1" 200 235
2024-06-11 16:18:32:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 16:18:32:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 16:18:33:INFO:train samples: (1284,)
2024-06-11 16:18:33:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 16:18:33:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718093913 HTTP/1.1" 200 235
2024-06-11 16:18:33:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 16:18:34:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 16:18:34:INFO:valid samples: (229,)
2024-06-11 16:18:34:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 16:18:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718093915 HTTP/1.1" 200 235
2024-06-11 16:18:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 16:18:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 16:18:36:INFO:test samples: (686,)
2024-06-11 16:18:36:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 16:18:36:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718093916 HTTP/1.1" 200 235
2024-06-11 16:18:36:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 16:18:37:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 16:18:37:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 16:18:37:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718093918 HTTP/1.1" 200 235
2024-06-11 16:18:38:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 16:18:38:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 16:18:38:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-11 16:18:38:WARNING:Try importing flash-attention for faster inference...
2024-06-11 16:18:38:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-11 16:18:38:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-11 16:18:38:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-11 16:18:39:INFO:trainable params: 1310284 || all params: 1838138956 || trainable%: 0.07128318540461856
2024-06-11 16:18:39:INFO:Init labels...
2024-06-11 16:18:39:INFO:Start training...
2024-06-11 16:18:54:INFO:TRAIN-(cmcm) (1/1/2)>> loss: 2.2926
2024-06-11 16:18:57:INFO:VAL-(cmcm) >>
2024-06-11 16:18:57:INFO:M: >>  Has0_acc_2: 0.5240  Has0_F1_score: 0.5205  Non0_acc_2: 0.5278  Non0_F1_score: 0.5244  Mult_acc_5: 0.2227  Mult_acc_7: 0.1790  MAE: 1.7174  Corr: 0.0583 
2024-06-11 16:18:58:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-11 16:19:13:INFO:TRAIN-(cmcm) (1/2/2)>> loss: 0.9163
2024-06-11 16:19:15:INFO:VAL-(cmcm) >>
2024-06-11 16:19:15:INFO:M: >>  Has0_acc_2: 0.4541  Has0_F1_score: 0.3518  Non0_acc_2: 0.4861  Non0_F1_score: 0.3856  Mult_acc_5: 0.1310  Mult_acc_7: 0.1266  MAE: 1.7951  Corr: 0.1972 
2024-06-11 16:19:30:INFO:TRAIN-(cmcm) (2/3/2)>> loss: 0.9023
2024-06-11 16:19:33:INFO:VAL-(cmcm) >>
2024-06-11 16:19:33:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5146  Non0_acc_2: 0.5509  Non0_F1_score: 0.5156  Mult_acc_5: 0.2402  Mult_acc_7: 0.1878  MAE: 1.6333  Corr: 0.0027 
2024-06-11 16:19:34:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-mosi-regression.pth.
2024-06-11 16:19:49:INFO:TRAIN-(cmcm) (1/4/2)>> loss: 0.8816
2024-06-11 16:19:51:INFO:VAL-(cmcm) >>
2024-06-11 16:19:51:INFO:M: >>  Has0_acc_2: 0.5633  Has0_F1_score: 0.5672  Non0_acc_2: 0.5602  Non0_F1_score: 0.5624  Mult_acc_5: 0.2271  Mult_acc_7: 0.1921  MAE: 1.6366  Corr: 0.0758 
2024-06-11 16:20:06:INFO:TRAIN-(cmcm) (2/5/2)>> loss: 0.8718
2024-06-11 16:20:09:INFO:VAL-(cmcm) >>
2024-06-11 16:20:09:INFO:M: >>  Has0_acc_2: 0.5459  Has0_F1_score: 0.5194  Non0_acc_2: 0.5370  Non0_F1_score: 0.5075  Mult_acc_5: 0.1616  Mult_acc_7: 0.1616  MAE: 1.6191  Corr: -0.0051 
2024-06-11 16:20:10:INFO:Saving checkpoint at epoch 5 to results/models/cmcm-mosi-regression.pth.
2024-06-11 16:20:25:INFO:TRAIN-(cmcm) (1/6/2)>> loss: 0.8632
2024-06-11 16:20:27:INFO:VAL-(cmcm) >>
2024-06-11 16:20:27:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.5071  Non0_acc_2: 0.5602  Non0_F1_score: 0.4810  Mult_acc_5: 0.1965  Mult_acc_7: 0.1790  MAE: 1.5453  Corr: -0.0116 
2024-06-11 16:20:28:INFO:Saving checkpoint at epoch 6 to results/models/cmcm-mosi-regression.pth.
2024-06-11 16:20:43:INFO:TRAIN-(cmcm) (1/7/2)>> loss: 0.8598
2024-06-11 16:20:45:INFO:VAL-(cmcm) >>
2024-06-11 16:20:45:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5753  Non0_acc_2: 0.5833  Non0_F1_score: 0.5671  Mult_acc_5: 0.2795  Mult_acc_7: 0.2183  MAE: 1.5961  Corr: 0.1139 
2024-06-11 16:21:00:INFO:TRAIN-(cmcm) (2/8/2)>> loss: 0.8566
2024-06-11 16:21:03:INFO:VAL-(cmcm) >>
2024-06-11 16:21:03:INFO:M: >>  Has0_acc_2: 0.6157  Has0_F1_score: 0.6124  Non0_acc_2: 0.6204  Non0_F1_score: 0.6159  Mult_acc_5: 0.2969  Mult_acc_7: 0.2314  MAE: 1.4804  Corr: 0.1817 
2024-06-11 16:21:03:INFO:Saving checkpoint at epoch 8 to results/models/cmcm-mosi-regression.pth.
2024-06-11 16:21:18:INFO:TRAIN-(cmcm) (1/9/2)>> loss: 0.8471
2024-06-11 16:21:21:INFO:VAL-(cmcm) >>
2024-06-11 16:21:21:INFO:M: >>  Has0_acc_2: 0.4585  Has0_F1_score: 0.3437  Non0_acc_2: 0.4861  Non0_F1_score: 0.3746  Mult_acc_5: 0.1747  Mult_acc_7: 0.1528  MAE: 1.7791  Corr: 0.1469 
2024-06-11 16:21:36:INFO:TRAIN-(cmcm) (2/10/2)>> loss: 0.8407
2024-06-11 16:21:38:INFO:VAL-(cmcm) >>
2024-06-11 16:21:38:INFO:M: >>  Has0_acc_2: 0.6201  Has0_F1_score: 0.5675  Non0_acc_2: 0.6111  Non0_F1_score: 0.5549  Mult_acc_5: 0.3057  Mult_acc_7: 0.2358  MAE: 1.5656  Corr: 0.1549 
2024-06-11 16:21:53:INFO:TRAIN-(cmcm) (3/11/2)>> loss: 0.8310
2024-06-11 16:21:55:INFO:VAL-(cmcm) >>
2024-06-11 16:21:55:INFO:M: >>  Has0_acc_2: 0.6812  Has0_F1_score: 0.6582  Non0_acc_2: 0.6713  Non0_F1_score: 0.6475  Mult_acc_5: 0.3668  Mult_acc_7: 0.2751  MAE: 1.4756  Corr: 0.2896 
2024-06-11 16:21:56:INFO:Saving checkpoint at epoch 11 to results/models/cmcm-mosi-regression.pth.
2024-06-11 16:22:11:INFO:TRAIN-(cmcm) (1/12/2)>> loss: 0.8240
2024-06-11 16:22:14:INFO:VAL-(cmcm) >>
2024-06-11 16:22:14:INFO:M: >>  Has0_acc_2: 0.6900  Has0_F1_score: 0.6897  Non0_acc_2: 0.6944  Non0_F1_score: 0.6929  Mult_acc_5: 0.3188  Mult_acc_7: 0.2489  MAE: 1.2101  Corr: 0.4345 
2024-06-11 16:22:14:INFO:Saving checkpoint at epoch 12 to results/models/cmcm-mosi-regression.pth.
2024-06-11 16:22:30:INFO:TRAIN-(cmcm) (1/13/2)>> loss: 0.8067
2024-06-11 16:22:32:INFO:VAL-(cmcm) >>
2024-06-11 16:22:32:INFO:M: >>  Has0_acc_2: 0.6769  Has0_F1_score: 0.6462  Non0_acc_2: 0.6852  Non0_F1_score: 0.6614  Mult_acc_5: 0.3406  Mult_acc_7: 0.2489  MAE: 1.3961  Corr: 0.3687 
2024-06-11 16:22:47:INFO:TRAIN-(cmcm) (2/14/2)>> loss: 0.8067
2024-06-11 16:22:50:INFO:VAL-(cmcm) >>
2024-06-11 16:22:50:INFO:M: >>  Has0_acc_2: 0.6769  Has0_F1_score: 0.6505  Non0_acc_2: 0.6667  Non0_F1_score: 0.6394  Mult_acc_5: 0.3057  Mult_acc_7: 0.2664  MAE: 1.3529  Corr: 0.3839 
2024-06-11 16:23:04:INFO:TRAIN-(cmcm) (3/15/2)>> loss: 0.7930
2024-06-11 16:23:07:INFO:VAL-(cmcm) >>
2024-06-11 16:23:07:INFO:M: >>  Has0_acc_2: 0.6201  Has0_F1_score: 0.6080  Non0_acc_2: 0.6250  Non0_F1_score: 0.6073  Mult_acc_5: 0.2489  Mult_acc_7: 0.2096  MAE: 1.3250  Corr: 0.4210 
2024-06-11 16:23:21:INFO:TRAIN-(cmcm) (4/16/2)>> loss: 0.7842
2024-06-11 16:23:24:INFO:VAL-(cmcm) >>
2024-06-11 16:23:24:INFO:M: >>  Has0_acc_2: 0.6812  Has0_F1_score: 0.6781  Non0_acc_2: 0.6852  Non0_F1_score: 0.6852  Mult_acc_5: 0.3755  Mult_acc_7: 0.2926  MAE: 1.2014  Corr: 0.4303 
2024-06-11 16:23:25:INFO:Saving checkpoint at epoch 16 to results/models/cmcm-mosi-regression.pth.
2024-06-11 16:23:40:INFO:TRAIN-(cmcm) (1/17/2)>> loss: 0.7748
2024-06-11 16:23:43:INFO:VAL-(cmcm) >>
2024-06-11 16:23:43:INFO:M: >>  Has0_acc_2: 0.6856  Has0_F1_score: 0.6877  Non0_acc_2: 0.7037  Non0_F1_score: 0.7044  Mult_acc_5: 0.3624  Mult_acc_7: 0.2926  MAE: 1.1612  Corr: 0.4853 
2024-06-11 16:23:43:INFO:Saving checkpoint at epoch 17 to results/models/cmcm-mosi-regression.pth.
2024-06-11 16:23:58:INFO:TRAIN-(cmcm) (1/18/2)>> loss: 0.7724
2024-06-11 16:24:01:INFO:VAL-(cmcm) >>
2024-06-11 16:24:01:INFO:M: >>  Has0_acc_2: 0.6856  Has0_F1_score: 0.6803  Non0_acc_2: 0.5648  Non0_F1_score: 0.5298  Mult_acc_5: 0.3188  Mult_acc_7: 0.2751  MAE: 1.2402  Corr: 0.4147 
2024-06-11 16:24:16:INFO:TRAIN-(cmcm) (2/19/2)>> loss: 0.7504
2024-06-11 16:24:18:INFO:VAL-(cmcm) >>
2024-06-11 16:24:18:INFO:M: >>  Has0_acc_2: 0.6812  Has0_F1_score: 0.6832  Non0_acc_2: 0.5972  Non0_F1_score: 0.5817  Mult_acc_5: 0.3581  Mult_acc_7: 0.3013  MAE: 1.2218  Corr: 0.4476 
2024-06-11 16:24:33:INFO:TRAIN-(cmcm) (3/20/2)>> loss: 0.7557
2024-06-11 16:24:35:INFO:VAL-(cmcm) >>
2024-06-11 16:24:35:INFO:M: >>  Has0_acc_2: 0.6856  Has0_F1_score: 0.6850  Non0_acc_2: 0.6852  Non0_F1_score: 0.6856  Mult_acc_5: 0.4192  Mult_acc_7: 0.3188  MAE: 1.1996  Corr: 0.4474 
2024-06-11 16:24:50:INFO:TRAIN-(cmcm) (4/21/2)>> loss: 0.7356
2024-06-11 16:24:52:INFO:VAL-(cmcm) >>
2024-06-11 16:24:52:INFO:M: >>  Has0_acc_2: 0.6681  Has0_F1_score: 0.6692  Non0_acc_2: 0.6759  Non0_F1_score: 0.6777  Mult_acc_5: 0.3886  Mult_acc_7: 0.3057  MAE: 1.1970  Corr: 0.4396 
2024-06-11 16:25:07:INFO:TRAIN-(cmcm) (5/22/2)>> loss: 0.7253
2024-06-11 16:25:10:INFO:VAL-(cmcm) >>
2024-06-11 16:25:10:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5794  Non0_acc_2: 0.6250  Non0_F1_score: 0.6120  Mult_acc_5: 0.3057  Mult_acc_7: 0.2140  MAE: 1.4900  Corr: 0.4104 
2024-06-11 16:25:24:INFO:TRAIN-(cmcm) (6/23/2)>> loss: 0.7153
2024-06-11 16:25:27:INFO:VAL-(cmcm) >>
2024-06-11 16:25:27:INFO:M: >>  Has0_acc_2: 0.6856  Has0_F1_score: 0.6793  Non0_acc_2: 0.6944  Non0_F1_score: 0.6872  Mult_acc_5: 0.3755  Mult_acc_7: 0.2926  MAE: 1.2525  Corr: 0.4137 
2024-06-11 16:25:42:INFO:TRAIN-(cmcm) (7/24/2)>> loss: 0.7064
2024-06-11 16:25:44:INFO:VAL-(cmcm) >>
2024-06-11 16:25:44:INFO:M: >>  Has0_acc_2: 0.6812  Has0_F1_score: 0.6822  Non0_acc_2: 0.7037  Non0_F1_score: 0.7033  Mult_acc_5: 0.3799  Mult_acc_7: 0.2838  MAE: 1.2590  Corr: 0.4989 
2024-06-11 16:25:59:INFO:TRAIN-(cmcm) (8/25/2)>> loss: 0.6927
2024-06-11 16:26:01:INFO:VAL-(cmcm) >>
2024-06-11 16:26:01:INFO:M: >>  Has0_acc_2: 0.6769  Has0_F1_score: 0.6733  Non0_acc_2: 0.6852  Non0_F1_score: 0.6815  Mult_acc_5: 0.4105  Mult_acc_7: 0.3319  MAE: 1.2405  Corr: 0.4064 
2024-06-11 16:26:16:INFO:TRAIN-(cmcm) (9/26/2)>> loss: 0.6823
2024-06-11 16:26:18:INFO:VAL-(cmcm) >>
2024-06-11 16:26:19:INFO:M: >>  Has0_acc_2: 0.6638  Has0_F1_score: 0.6670  Non0_acc_2: 0.7083  Non0_F1_score: 0.7096  Mult_acc_5: 0.3755  Mult_acc_7: 0.2926  MAE: 1.2331  Corr: 0.4507 
2024-06-11 16:26:33:INFO:TRAIN-(cmcm) (10/27/2)>> loss: 0.6733
2024-06-11 16:26:36:INFO:VAL-(cmcm) >>
2024-06-11 16:26:36:INFO:M: >>  Has0_acc_2: 0.6769  Has0_F1_score: 0.6769  Non0_acc_2: 0.7222  Non0_F1_score: 0.7226  Mult_acc_5: 0.4279  Mult_acc_7: 0.3450  MAE: 1.1672  Corr: 0.4655 
2024-06-11 16:26:43:INFO:TEST-(cmcm) >>
2024-06-11 16:26:43:INFO:M: >>  Has0_acc_2: 0.7070  Has0_F1_score: 0.7077  Non0_acc_2: 0.7439  Non0_F1_score: 0.7396  Mult_acc_5: 0.3222  Mult_acc_7: 0.2886  MAE: 1.1600  Corr: 0.5253 
2024-06-11 16:26:43:INFO:Results are added to results/results/mosi-regression-30.csv...
2024-06-11 16:26:43:INFO:Start running cmcm...
2024-06-11 16:26:43:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 3333}>
2024-06-11 16:26:43:INFO:Let's use the GPU 1 !
2024-06-11 16:26:43:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 16:26:44:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718094404 HTTP/1.1" 200 235
2024-06-11 16:26:44:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 16:26:44:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 16:26:45:INFO:train samples: (1284,)
2024-06-11 16:26:45:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 16:26:46:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718094406 HTTP/1.1" 200 235
2024-06-11 16:26:46:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 16:26:46:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 16:26:47:INFO:valid samples: (229,)
2024-06-11 16:26:47:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 16:26:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718094407 HTTP/1.1" 200 235
2024-06-11 16:26:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 16:26:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 16:26:49:INFO:test samples: (686,)
2024-06-11 16:26:49:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 16:26:49:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718094409 HTTP/1.1" 200 235
2024-06-11 16:26:49:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 16:26:49:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 16:26:50:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 16:26:50:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718094410 HTTP/1.1" 200 235
2024-06-11 16:26:50:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 16:26:51:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 16:26:51:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-11 16:26:51:WARNING:Try importing flash-attention for faster inference...
2024-06-11 16:26:51:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-11 16:26:51:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-11 16:26:51:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-11 16:26:52:INFO:trainable params: 1310284 || all params: 1838138956 || trainable%: 0.07128318540461856
2024-06-11 16:26:52:INFO:Init labels...
2024-06-11 16:26:52:INFO:Start training...
2024-06-11 16:27:07:INFO:TRAIN-(cmcm) (1/1/3)>> loss: 2.7764
2024-06-11 16:27:10:INFO:VAL-(cmcm) >>
2024-06-11 16:27:10:INFO:M: >>  Has0_acc_2: 0.4454  Has0_F1_score: 0.4366  Non0_acc_2: 0.4676  Non0_F1_score: 0.4263  Mult_acc_5: 0.1310  Mult_acc_7: 0.1223  MAE: 2.1017  Corr: -0.0386 
2024-06-11 16:27:10:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-11 16:27:25:INFO:TRAIN-(cmcm) (1/2/3)>> loss: 0.9588
2024-06-11 16:27:28:INFO:VAL-(cmcm) >>
2024-06-11 16:27:28:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.4897  Non0_acc_2: 0.5000  Non0_F1_score: 0.4953  Mult_acc_5: 0.2183  Mult_acc_7: 0.2183  MAE: 1.5344  Corr: -0.0225 
2024-06-11 16:27:29:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-11 16:27:44:INFO:TRAIN-(cmcm) (1/3/3)>> loss: 0.9120
2024-06-11 16:27:46:INFO:VAL-(cmcm) >>
2024-06-11 16:27:46:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5741  Non0_F1_score: 0.4187  Mult_acc_5: 0.2926  Mult_acc_7: 0.2140  MAE: 1.7145  Corr: -0.0337 
2024-06-11 16:28:01:INFO:TRAIN-(cmcm) (2/4/3)>> loss: 0.8905
2024-06-11 16:28:03:INFO:VAL-(cmcm) >>
2024-06-11 16:28:03:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5189  Non0_acc_2: 0.5278  Non0_F1_score: 0.4977  Mult_acc_5: 0.1790  Mult_acc_7: 0.1747  MAE: 1.5392  Corr: -0.0317 
2024-06-11 16:28:18:INFO:TRAIN-(cmcm) (3/5/3)>> loss: 0.8867
2024-06-11 16:28:21:INFO:VAL-(cmcm) >>
2024-06-11 16:28:21:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5439  Non0_acc_2: 0.5370  Non0_F1_score: 0.5227  Mult_acc_5: 0.2183  Mult_acc_7: 0.2052  MAE: 1.4822  Corr: 0.0449 
2024-06-11 16:28:21:INFO:Saving checkpoint at epoch 5 to results/models/cmcm-mosi-regression.pth.
2024-06-11 16:28:36:INFO:TRAIN-(cmcm) (1/6/3)>> loss: 0.8840
2024-06-11 16:28:39:INFO:VAL-(cmcm) >>
2024-06-11 16:28:39:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4917  Non0_acc_2: 0.5787  Non0_F1_score: 0.4649  Mult_acc_5: 0.2620  Mult_acc_7: 0.2009  MAE: 1.6328  Corr: 0.0090 
2024-06-11 16:28:54:INFO:TRAIN-(cmcm) (2/7/3)>> loss: 0.8754
2024-06-11 16:28:56:INFO:VAL-(cmcm) >>
2024-06-11 16:28:56:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.5099  Non0_acc_2: 0.5602  Non0_F1_score: 0.4902  Mult_acc_5: 0.2096  Mult_acc_7: 0.1921  MAE: 1.6135  Corr: -0.0302 
2024-06-11 16:29:11:INFO:TRAIN-(cmcm) (3/8/3)>> loss: 0.8662
2024-06-11 16:29:13:INFO:VAL-(cmcm) >>
2024-06-11 16:29:13:INFO:M: >>  Has0_acc_2: 0.5633  Has0_F1_score: 0.4926  Non0_acc_2: 0.5463  Non0_F1_score: 0.4718  Mult_acc_5: 0.2795  Mult_acc_7: 0.1965  MAE: 1.7416  Corr: -0.0401 
2024-06-11 16:29:28:INFO:TRAIN-(cmcm) (4/9/3)>> loss: 0.8588
2024-06-11 16:29:31:INFO:VAL-(cmcm) >>
2024-06-11 16:29:31:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.4920  Non0_acc_2: 0.4769  Non0_F1_score: 0.4772  Mult_acc_5: 0.2358  Mult_acc_7: 0.1921  MAE: 1.5800  Corr: 0.0209 
2024-06-11 16:29:45:INFO:TRAIN-(cmcm) (5/10/3)>> loss: 0.8572
2024-06-11 16:29:48:INFO:VAL-(cmcm) >>
2024-06-11 16:29:48:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5741  Non0_F1_score: 0.4187  Mult_acc_5: 0.2402  Mult_acc_7: 0.1965  MAE: 1.6953  Corr: -0.0555 
2024-06-11 16:30:02:INFO:TRAIN-(cmcm) (6/11/3)>> loss: 0.8530
2024-06-11 16:30:05:INFO:VAL-(cmcm) >>
2024-06-11 16:30:05:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.5099  Non0_acc_2: 0.5602  Non0_F1_score: 0.4902  Mult_acc_5: 0.2489  Mult_acc_7: 0.1703  MAE: 1.6944  Corr: 0.0442 
2024-06-11 16:30:20:INFO:TRAIN-(cmcm) (7/12/3)>> loss: 0.8529
2024-06-11 16:30:22:INFO:VAL-(cmcm) >>
2024-06-11 16:30:22:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5081  Non0_acc_2: 0.5787  Non0_F1_score: 0.5339  Mult_acc_5: 0.2402  Mult_acc_7: 0.1703  MAE: 1.5961  Corr: 0.0172 
2024-06-11 16:30:37:INFO:TRAIN-(cmcm) (8/13/3)>> loss: 0.8474
2024-06-11 16:30:39:INFO:VAL-(cmcm) >>
2024-06-11 16:30:39:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.5292  Non0_acc_2: 0.5787  Non0_F1_score: 0.5074  Mult_acc_5: 0.2664  Mult_acc_7: 0.1921  MAE: 1.7883  Corr: -0.0003 
2024-06-11 16:30:54:INFO:TRAIN-(cmcm) (9/14/3)>> loss: 0.8403
2024-06-11 16:30:57:INFO:VAL-(cmcm) >>
2024-06-11 16:30:57:INFO:M: >>  Has0_acc_2: 0.6157  Has0_F1_score: 0.5222  Non0_acc_2: 0.5880  Non0_F1_score: 0.5044  Mult_acc_5: 0.3013  Mult_acc_7: 0.2183  MAE: 1.7547  Corr: 0.0450 
2024-06-11 16:31:11:INFO:TRAIN-(cmcm) (10/15/3)>> loss: 0.8417
2024-06-11 16:31:14:INFO:VAL-(cmcm) >>
2024-06-11 16:31:14:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5261  Non0_acc_2: 0.5602  Non0_F1_score: 0.5256  Mult_acc_5: 0.2445  Mult_acc_7: 0.2052  MAE: 1.6237  Corr: 0.0306 
2024-06-11 16:31:21:INFO:TEST-(cmcm) >>
2024-06-11 16:31:21:INFO:M: >>  Has0_acc_2: 0.5335  Has0_F1_score: 0.5051  Non0_acc_2: 0.5351  Non0_F1_score: 0.5275  Mult_acc_5: 0.2216  Mult_acc_7: 0.2187  MAE: 1.5111  Corr: 0.0952 
2024-06-11 16:31:22:INFO:Results are added to results/results/mosi-regression-30.csv...
2024-06-11 16:31:22:INFO:Start running cmcm...
2024-06-11 16:31:22:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 4444}>
2024-06-11 16:31:22:INFO:Let's use the GPU 1 !
2024-06-11 16:31:22:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 16:31:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718094682 HTTP/1.1" 200 235
2024-06-11 16:31:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 16:31:23:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 16:31:23:INFO:train samples: (1284,)
2024-06-11 16:31:23:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 16:31:24:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718094684 HTTP/1.1" 200 235
2024-06-11 16:31:24:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 16:31:24:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 16:31:25:INFO:valid samples: (229,)
2024-06-11 16:31:25:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 16:31:25:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718094685 HTTP/1.1" 200 235
2024-06-11 16:31:25:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 16:31:26:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 16:31:26:INFO:test samples: (686,)
2024-06-11 16:31:26:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 16:31:27:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718094687 HTTP/1.1" 200 235
2024-06-11 16:31:27:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 16:31:27:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 16:31:28:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 16:31:28:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718094688 HTTP/1.1" 200 235
2024-06-11 16:31:28:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 16:31:28:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 16:31:28:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-11 16:31:28:WARNING:Try importing flash-attention for faster inference...
2024-06-11 16:31:28:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-11 16:31:28:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-11 16:31:28:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-11 16:31:30:INFO:trainable params: 1310284 || all params: 1838138956 || trainable%: 0.07128318540461856
2024-06-11 16:31:30:INFO:Init labels...
2024-06-11 16:31:30:INFO:Start training...
2024-06-11 16:31:44:INFO:TRAIN-(cmcm) (1/1/4)>> loss: 4.2273
2024-06-11 16:31:47:INFO:VAL-(cmcm) >>
2024-06-11 16:31:47:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4259  Non0_F1_score: 0.2544  Mult_acc_5: 0.2140  Mult_acc_7: 0.2140  MAE: 1.4370  Corr: nan 
2024-06-11 16:31:47:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-11 16:32:02:INFO:TRAIN-(cmcm) (1/2/4)>> loss: 1.5321
2024-06-11 16:32:05:INFO:VAL-(cmcm) >>
2024-06-11 16:32:05:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5741  Non0_F1_score: 0.4346  Mult_acc_5: 0.1703  Mult_acc_7: 0.1703  MAE: 1.4790  Corr: 0.0300 
2024-06-11 16:32:20:INFO:TRAIN-(cmcm) (2/3/4)>> loss: 0.9265
2024-06-11 16:32:22:INFO:VAL-(cmcm) >>
2024-06-11 16:32:22:INFO:M: >>  Has0_acc_2: 0.5066  Has0_F1_score: 0.5001  Non0_acc_2: 0.5231  Non0_F1_score: 0.5159  Mult_acc_5: 0.2314  Mult_acc_7: 0.1747  MAE: 1.8865  Corr: 0.0513 
2024-06-11 16:32:37:INFO:TRAIN-(cmcm) (3/4/4)>> loss: 0.8936
2024-06-11 16:32:39:INFO:VAL-(cmcm) >>
2024-06-11 16:32:39:INFO:M: >>  Has0_acc_2: 0.5590  Has0_F1_score: 0.4980  Non0_acc_2: 0.5417  Non0_F1_score: 0.4775  Mult_acc_5: 0.1790  Mult_acc_7: 0.1703  MAE: 1.7493  Corr: -0.0785 
2024-06-11 16:32:54:INFO:TRAIN-(cmcm) (4/5/4)>> loss: 0.8828
2024-06-11 16:32:56:INFO:VAL-(cmcm) >>
2024-06-11 16:32:56:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.5352  Non0_acc_2: 0.5787  Non0_F1_score: 0.5235  Mult_acc_5: 0.3100  Mult_acc_7: 0.2358  MAE: 1.6795  Corr: 0.0514 
2024-06-11 16:33:11:INFO:TRAIN-(cmcm) (5/6/4)>> loss: 0.8749
2024-06-11 16:33:14:INFO:VAL-(cmcm) >>
2024-06-11 16:33:14:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4855  Non0_acc_2: 0.5787  Non0_F1_score: 0.4584  Mult_acc_5: 0.2576  Mult_acc_7: 0.2271  MAE: 1.5130  Corr: 0.0181 
2024-06-11 16:33:28:INFO:TRAIN-(cmcm) (6/7/4)>> loss: 0.8657
2024-06-11 16:33:31:INFO:VAL-(cmcm) >>
2024-06-11 16:33:31:INFO:M: >>  Has0_acc_2: 0.5502  Has0_F1_score: 0.5541  Non0_acc_2: 0.5556  Non0_F1_score: 0.5574  Mult_acc_5: 0.2489  Mult_acc_7: 0.1747  MAE: 1.8065  Corr: 0.0420 
2024-06-11 16:33:45:INFO:TRAIN-(cmcm) (7/8/4)>> loss: 0.8551
2024-06-11 16:33:48:INFO:VAL-(cmcm) >>
2024-06-11 16:33:48:INFO:M: >>  Has0_acc_2: 0.5371  Has0_F1_score: 0.5382  Non0_acc_2: 0.5463  Non0_F1_score: 0.5456  Mult_acc_5: 0.2576  Mult_acc_7: 0.2096  MAE: 1.6241  Corr: 0.0838 
2024-06-11 16:34:02:INFO:TRAIN-(cmcm) (8/9/4)>> loss: 0.8497
2024-06-11 16:34:05:INFO:VAL-(cmcm) >>
2024-06-11 16:34:05:INFO:M: >>  Has0_acc_2: 0.6507  Has0_F1_score: 0.6175  Non0_acc_2: 0.6157  Non0_F1_score: 0.5999  Mult_acc_5: 0.3057  Mult_acc_7: 0.2533  MAE: 1.4506  Corr: 0.1289 
2024-06-11 16:34:19:INFO:TRAIN-(cmcm) (9/10/4)>> loss: 0.8366
2024-06-11 16:34:22:INFO:VAL-(cmcm) >>
2024-06-11 16:34:22:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5494  Non0_acc_2: 0.5648  Non0_F1_score: 0.5395  Mult_acc_5: 0.2795  Mult_acc_7: 0.2096  MAE: 1.6931  Corr: 0.0491 
2024-06-11 16:34:37:INFO:TRAIN-(cmcm) (10/11/4)>> loss: 0.8389
2024-06-11 16:34:39:INFO:VAL-(cmcm) >>
2024-06-11 16:34:39:INFO:M: >>  Has0_acc_2: 0.6419  Has0_F1_score: 0.6323  Non0_acc_2: 0.6435  Non0_F1_score: 0.6345  Mult_acc_5: 0.2969  Mult_acc_7: 0.2227  MAE: 1.5407  Corr: 0.1912 
2024-06-11 16:34:46:INFO:TEST-(cmcm) >>
2024-06-11 16:34:46:INFO:M: >>  Has0_acc_2: 0.4475  Has0_F1_score: 0.2767  Non0_acc_2: 0.5777  Non0_F1_score: 0.4231  Mult_acc_5: 0.1545  Mult_acc_7: 0.1545  MAE: 1.4174  Corr: nan 
2024-06-11 16:34:47:INFO:Results are added to results/results/mosi-regression-30.csv...
2024-06-11 16:34:47:INFO:Start running cmcm...
2024-06-11 16:34:47:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 5555}>
2024-06-11 16:34:47:INFO:Let's use the GPU 1 !
2024-06-11 16:34:47:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 16:34:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718094887 HTTP/1.1" 200 235
2024-06-11 16:34:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 16:34:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 16:34:48:INFO:train samples: (1284,)
2024-06-11 16:34:48:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 16:34:49:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718094889 HTTP/1.1" 200 235
2024-06-11 16:34:49:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 16:34:49:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 16:34:50:INFO:valid samples: (229,)
2024-06-11 16:34:50:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 16:34:50:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718094890 HTTP/1.1" 200 235
2024-06-11 16:34:50:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 16:34:51:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 16:34:51:INFO:test samples: (686,)
2024-06-11 16:34:51:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 16:34:52:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718094892 HTTP/1.1" 200 235
2024-06-11 16:34:52:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 16:34:52:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 16:34:53:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 16:34:53:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718094893 HTTP/1.1" 200 235
2024-06-11 16:34:53:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 16:34:54:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 16:34:54:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-11 16:34:54:WARNING:Try importing flash-attention for faster inference...
2024-06-11 16:34:54:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-11 16:34:54:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-11 16:34:54:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-11 16:34:55:INFO:trainable params: 1310284 || all params: 1838138956 || trainable%: 0.07128318540461856
2024-06-11 16:34:55:INFO:Init labels...
2024-06-11 16:34:55:INFO:Start training...
2024-06-11 16:35:09:INFO:TRAIN-(cmcm) (1/1/5)>> loss: 1.8915
2024-06-11 16:35:12:INFO:VAL-(cmcm) >>
2024-06-11 16:35:12:INFO:M: >>  Has0_acc_2: 0.4017  Has0_F1_score: 0.2451  Non0_acc_2: 0.4213  Non0_F1_score: 0.2604  Mult_acc_5: 0.1834  Mult_acc_7: 0.1834  MAE: 1.6126  Corr: -0.0673 
2024-06-11 16:35:12:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-11 16:35:27:INFO:TRAIN-(cmcm) (1/2/5)>> loss: 0.9600
2024-06-11 16:35:30:INFO:VAL-(cmcm) >>
2024-06-11 16:35:30:INFO:M: >>  Has0_acc_2: 0.4017  Has0_F1_score: 0.2521  Non0_acc_2: 0.4259  Non0_F1_score: 0.2775  Mult_acc_5: 0.1354  Mult_acc_7: 0.1354  MAE: 1.8659  Corr: -0.1586 
2024-06-11 16:35:44:INFO:TRAIN-(cmcm) (2/3/5)>> loss: 0.9210
2024-06-11 16:35:47:INFO:VAL-(cmcm) >>
2024-06-11 16:35:47:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4630  Non0_acc_2: 0.5741  Non0_F1_score: 0.4346  Mult_acc_5: 0.2489  Mult_acc_7: 0.2227  MAE: 1.6074  Corr: 0.0482 
2024-06-11 16:35:47:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-mosi-regression.pth.
2024-06-11 16:36:02:INFO:TRAIN-(cmcm) (1/4/5)>> loss: 0.8806
2024-06-11 16:36:05:INFO:VAL-(cmcm) >>
2024-06-11 16:36:05:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.4943  Non0_acc_2: 0.5833  Non0_F1_score: 0.4676  Mult_acc_5: 0.2140  Mult_acc_7: 0.1834  MAE: 1.6305  Corr: 0.0417 
2024-06-11 16:36:19:INFO:TRAIN-(cmcm) (2/5/5)>> loss: 0.8683
2024-06-11 16:36:22:INFO:VAL-(cmcm) >>
2024-06-11 16:36:22:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4767  Non0_acc_2: 0.5741  Non0_F1_score: 0.4491  Mult_acc_5: 0.1790  Mult_acc_7: 0.1790  MAE: 1.4589  Corr: 0.0492 
2024-06-11 16:36:22:INFO:Saving checkpoint at epoch 5 to results/models/cmcm-mosi-regression.pth.
2024-06-11 16:36:37:INFO:TRAIN-(cmcm) (1/6/5)>> loss: 0.8683
2024-06-11 16:36:39:INFO:VAL-(cmcm) >>
2024-06-11 16:36:39:INFO:M: >>  Has0_acc_2: 0.5633  Has0_F1_score: 0.5423  Non0_acc_2: 0.5509  Non0_F1_score: 0.5282  Mult_acc_5: 0.2926  Mult_acc_7: 0.2140  MAE: 1.7140  Corr: 0.0238 
2024-06-11 16:36:54:INFO:TRAIN-(cmcm) (2/7/5)>> loss: 0.8641
2024-06-11 16:36:57:INFO:VAL-(cmcm) >>
2024-06-11 16:36:57:INFO:M: >>  Has0_acc_2: 0.4847  Has0_F1_score: 0.4851  Non0_acc_2: 0.5000  Non0_F1_score: 0.4993  Mult_acc_5: 0.2271  Mult_acc_7: 0.1616  MAE: 1.7529  Corr: 0.0022 
2024-06-11 16:37:11:INFO:TRAIN-(cmcm) (3/8/5)>> loss: 0.8611
2024-06-11 16:37:14:INFO:VAL-(cmcm) >>
2024-06-11 16:37:14:INFO:M: >>  Has0_acc_2: 0.5153  Has0_F1_score: 0.5153  Non0_acc_2: 0.5231  Non0_F1_score: 0.5213  Mult_acc_5: 0.2707  Mult_acc_7: 0.2140  MAE: 1.5977  Corr: 0.0722 
2024-06-11 16:37:28:INFO:TRAIN-(cmcm) (4/9/5)>> loss: 0.8618
2024-06-11 16:37:31:INFO:VAL-(cmcm) >>
2024-06-11 16:37:31:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.5178  Non0_acc_2: 0.5556  Non0_F1_score: 0.4954  Mult_acc_5: 0.2882  Mult_acc_7: 0.2096  MAE: 1.7582  Corr: -0.0143 
2024-06-11 16:37:45:INFO:TRAIN-(cmcm) (5/10/5)>> loss: 0.8560
2024-06-11 16:37:48:INFO:VAL-(cmcm) >>
2024-06-11 16:37:48:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5042  Non0_acc_2: 0.5602  Non0_F1_score: 0.4810  Mult_acc_5: 0.2969  Mult_acc_7: 0.2183  MAE: 1.7092  Corr: -0.0246 
2024-06-11 16:38:03:INFO:TRAIN-(cmcm) (6/11/5)>> loss: 0.8502
2024-06-11 16:38:05:INFO:VAL-(cmcm) >>
2024-06-11 16:38:05:INFO:M: >>  Has0_acc_2: 0.5153  Has0_F1_score: 0.5199  Non0_acc_2: 0.5231  Non0_F1_score: 0.5255  Mult_acc_5: 0.2445  Mult_acc_7: 0.1747  MAE: 1.7079  Corr: 0.0855 
2024-06-11 16:38:20:INFO:TRAIN-(cmcm) (7/12/5)>> loss: 0.8512
2024-06-11 16:38:22:INFO:VAL-(cmcm) >>
2024-06-11 16:38:22:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4791  Non0_acc_2: 0.5741  Non0_F1_score: 0.4491  Mult_acc_5: 0.2751  Mult_acc_7: 0.2052  MAE: 1.6852  Corr: 0.0395 
2024-06-11 16:38:37:INFO:TRAIN-(cmcm) (8/13/5)>> loss: 0.8473
2024-06-11 16:38:39:INFO:VAL-(cmcm) >>
2024-06-11 16:38:39:INFO:M: >>  Has0_acc_2: 0.5197  Has0_F1_score: 0.5242  Non0_acc_2: 0.5278  Non0_F1_score: 0.5300  Mult_acc_5: 0.2620  Mult_acc_7: 0.1921  MAE: 1.6870  Corr: 0.0725 
2024-06-11 16:38:54:INFO:TRAIN-(cmcm) (9/14/5)>> loss: 0.8439
2024-06-11 16:38:57:INFO:VAL-(cmcm) >>
2024-06-11 16:38:57:INFO:M: >>  Has0_acc_2: 0.5590  Has0_F1_score: 0.5609  Non0_acc_2: 0.5787  Non0_F1_score: 0.5795  Mult_acc_5: 0.2838  Mult_acc_7: 0.2096  MAE: 1.7267  Corr: 0.1546 
2024-06-11 16:39:11:INFO:TRAIN-(cmcm) (10/15/5)>> loss: 0.8434
2024-06-11 16:39:14:INFO:VAL-(cmcm) >>
2024-06-11 16:39:14:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.5669  Non0_acc_2: 0.5880  Non0_F1_score: 0.5581  Mult_acc_5: 0.3362  Mult_acc_7: 0.2664  MAE: 1.5507  Corr: 0.1478 
2024-06-11 16:39:21:INFO:TEST-(cmcm) >>
2024-06-11 16:39:21:INFO:M: >>  Has0_acc_2: 0.4810  Has0_F1_score: 0.3644  Non0_acc_2: 0.4573  Non0_F1_score: 0.3418  Mult_acc_5: 0.1851  Mult_acc_7: 0.1851  MAE: 1.6379  Corr: 0.1108 
2024-06-11 16:39:21:INFO:Results are added to results/results/mosi-regression-30.csv...
2024-06-11 16:39:21:INFO:Start running cmcm...
2024-06-11 16:39:21:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 40, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-06-11 16:39:21:INFO:Let's use the GPU 1 !
2024-06-11 16:39:21:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 16:39:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718095162 HTTP/1.1" 200 235
2024-06-11 16:39:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 16:39:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 16:39:23:INFO:train samples: (1284,)
2024-06-11 16:39:23:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 16:39:24:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718095164 HTTP/1.1" 200 235
2024-06-11 16:39:24:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 16:39:24:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 16:39:25:INFO:valid samples: (229,)
2024-06-11 16:39:25:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 16:39:25:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718095165 HTTP/1.1" 200 235
2024-06-11 16:39:25:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 16:39:26:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 16:39:26:INFO:test samples: (686,)
2024-06-11 16:39:26:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 16:39:27:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718095167 HTTP/1.1" 200 235
2024-06-11 16:39:27:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 16:39:27:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 16:39:28:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 16:39:28:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718095168 HTTP/1.1" 200 235
2024-06-11 16:39:28:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 16:39:28:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 16:39:29:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-11 16:39:29:WARNING:Try importing flash-attention for faster inference...
2024-06-11 16:39:29:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-11 16:39:29:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-11 16:39:29:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-11 16:39:30:INFO:trainable params: 1310284 || all params: 1838138956 || trainable%: 0.07128318540461856
2024-06-11 16:39:30:INFO:Init labels...
2024-06-11 16:39:30:INFO:Start training...
2024-06-11 16:39:44:INFO:TRAIN-(cmcm) (1/1/1)>> loss: 1.9472
2024-06-11 16:39:47:INFO:VAL-(cmcm) >>
2024-06-11 16:39:47:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5185  Non0_F1_score: 0.5116  Mult_acc_5: 0.1747  Mult_acc_7: 0.1747  MAE: 1.5392  Corr: -0.1113 
2024-06-11 16:39:47:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-11 16:40:02:INFO:TRAIN-(cmcm) (1/2/1)>> loss: 0.9532
2024-06-11 16:40:05:INFO:VAL-(cmcm) >>
2024-06-11 16:40:05:INFO:M: >>  Has0_acc_2: 0.5415  Has0_F1_score: 0.5402  Non0_acc_2: 0.5370  Non0_F1_score: 0.5337  Mult_acc_5: 0.1790  Mult_acc_7: 0.1441  MAE: 1.5820  Corr: 0.1437 
2024-06-11 16:40:19:INFO:TRAIN-(cmcm) (2/3/1)>> loss: 0.9160
2024-06-11 16:40:22:INFO:VAL-(cmcm) >>
2024-06-11 16:40:22:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.5005  Non0_acc_2: 0.5741  Non0_F1_score: 0.4742  Mult_acc_5: 0.1921  Mult_acc_7: 0.1790  MAE: 1.5813  Corr: 0.0122 
2024-06-11 16:40:36:INFO:TRAIN-(cmcm) (3/4/1)>> loss: 0.9016
2024-06-11 16:40:39:INFO:VAL-(cmcm) >>
2024-06-11 16:40:39:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.4951  Non0_acc_2: 0.5648  Non0_F1_score: 0.4684  Mult_acc_5: 0.1572  Mult_acc_7: 0.1572  MAE: 1.4999  Corr: -0.0063 
2024-06-11 16:40:39:INFO:Saving checkpoint at epoch 4 to results/models/cmcm-mosi-regression.pth.
2024-06-11 16:40:54:INFO:TRAIN-(cmcm) (1/5/1)>> loss: 0.8897
2024-06-11 16:40:57:INFO:VAL-(cmcm) >>
2024-06-11 16:40:57:INFO:M: >>  Has0_acc_2: 0.5459  Has0_F1_score: 0.5466  Non0_acc_2: 0.5463  Non0_F1_score: 0.5449  Mult_acc_5: 0.1834  Mult_acc_7: 0.1834  MAE: 1.6012  Corr: 0.0332 
2024-06-11 16:41:12:INFO:TRAIN-(cmcm) (2/6/1)>> loss: 0.8742
2024-06-11 16:41:14:INFO:VAL-(cmcm) >>
2024-06-11 16:41:14:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.5057  Non0_acc_2: 0.5370  Non0_F1_score: 0.4823  Mult_acc_5: 0.2096  Mult_acc_7: 0.1747  MAE: 1.5830  Corr: -0.0599 
2024-06-11 16:41:29:INFO:TRAIN-(cmcm) (3/7/1)>> loss: 0.8715
2024-06-11 16:41:31:INFO:VAL-(cmcm) >>
2024-06-11 16:41:31:INFO:M: >>  Has0_acc_2: 0.5590  Has0_F1_score: 0.5534  Non0_acc_2: 0.4259  Non0_F1_score: 0.2847  Mult_acc_5: 0.2009  Mult_acc_7: 0.2009  MAE: 1.5545  Corr: -0.0451 
2024-06-11 16:41:46:INFO:TRAIN-(cmcm) (4/8/1)>> loss: 0.8726
2024-06-11 16:41:48:INFO:VAL-(cmcm) >>
2024-06-11 16:41:48:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5042  Non0_acc_2: 0.5602  Non0_F1_score: 0.4902  Mult_acc_5: 0.2926  Mult_acc_7: 0.2183  MAE: 1.6926  Corr: -0.0174 
2024-06-11 16:42:03:INFO:TRAIN-(cmcm) (5/9/1)>> loss: 0.8704
2024-06-11 16:42:06:INFO:VAL-(cmcm) >>
2024-06-11 16:42:06:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.5733  Non0_acc_2: 0.5648  Non0_F1_score: 0.5607  Mult_acc_5: 0.2707  Mult_acc_7: 0.1834  MAE: 1.7040  Corr: 0.0915 
2024-06-11 16:42:21:INFO:TRAIN-(cmcm) (6/10/1)>> loss: 0.8673
2024-06-11 16:42:24:INFO:VAL-(cmcm) >>
2024-06-11 16:42:24:INFO:M: >>  Has0_acc_2: 0.5633  Has0_F1_score: 0.4926  Non0_acc_2: 0.5417  Non0_F1_score: 0.4688  Mult_acc_5: 0.2707  Mult_acc_7: 0.1921  MAE: 1.8140  Corr: -0.0790 
2024-06-11 16:42:40:INFO:TRAIN-(cmcm) (7/11/1)>> loss: 0.8560
2024-06-11 16:42:43:INFO:VAL-(cmcm) >>
2024-06-11 16:42:43:INFO:M: >>  Has0_acc_2: 0.6157  Has0_F1_score: 0.6134  Non0_acc_2: 0.5509  Non0_F1_score: 0.5415  Mult_acc_5: 0.2926  Mult_acc_7: 0.2445  MAE: 1.4603  Corr: 0.1632 
2024-06-11 16:42:44:INFO:Saving checkpoint at epoch 11 to results/models/cmcm-mosi-regression.pth.
2024-06-11 16:43:00:INFO:TRAIN-(cmcm) (1/12/1)>> loss: 0.8585
2024-06-11 16:43:03:INFO:VAL-(cmcm) >>
2024-06-11 16:43:03:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.4975  Non0_acc_2: 0.5602  Non0_F1_score: 0.4710  Mult_acc_5: 0.2751  Mult_acc_7: 0.1921  MAE: 1.7110  Corr: 0.0337 
2024-06-11 16:43:18:INFO:TRAIN-(cmcm) (2/13/1)>> loss: 0.8526
2024-06-11 16:43:21:INFO:VAL-(cmcm) >>
2024-06-11 16:43:21:INFO:M: >>  Has0_acc_2: 0.6245  Has0_F1_score: 0.6157  Non0_acc_2: 0.6157  Non0_F1_score: 0.6060  Mult_acc_5: 0.3188  Mult_acc_7: 0.2358  MAE: 1.5398  Corr: 0.1501 
2024-06-11 16:43:36:INFO:TRAIN-(cmcm) (3/14/1)>> loss: 0.8497
2024-06-11 16:43:39:INFO:VAL-(cmcm) >>
2024-06-11 16:43:39:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5919  Non0_acc_2: 0.5694  Non0_F1_score: 0.5697  Mult_acc_5: 0.2358  Mult_acc_7: 0.2096  MAE: 1.5340  Corr: 0.0851 
2024-06-11 16:43:55:INFO:TRAIN-(cmcm) (4/15/1)>> loss: 0.8433
2024-06-11 16:43:58:INFO:VAL-(cmcm) >>
2024-06-11 16:43:58:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.4730  Non0_acc_2: 0.5556  Non0_F1_score: 0.4513  Mult_acc_5: 0.2882  Mult_acc_7: 0.2052  MAE: 1.6769  Corr: 0.0130 
2024-06-11 16:44:14:INFO:TRAIN-(cmcm) (5/16/1)>> loss: 0.8352
2024-06-11 16:44:17:INFO:VAL-(cmcm) >>
2024-06-11 16:44:17:INFO:M: >>  Has0_acc_2: 0.6376  Has0_F1_score: 0.6385  Non0_acc_2: 0.6250  Non0_F1_score: 0.6253  Mult_acc_5: 0.3100  Mult_acc_7: 0.2358  MAE: 1.5114  Corr: 0.2384 
2024-06-11 16:44:33:INFO:TRAIN-(cmcm) (6/17/1)>> loss: 0.8373
2024-06-11 16:44:36:INFO:VAL-(cmcm) >>
2024-06-11 16:44:36:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4534  Non0_acc_2: 0.6204  Non0_F1_score: 0.6002  Mult_acc_5: 0.3057  Mult_acc_7: 0.2314  MAE: 1.4485  Corr: 0.1874 
2024-06-11 16:44:36:INFO:Saving checkpoint at epoch 17 to results/models/cmcm-mosi-regression.pth.
2024-06-11 16:44:52:INFO:TRAIN-(cmcm) (1/18/1)>> loss: 0.8283
2024-06-11 16:44:55:INFO:VAL-(cmcm) >>
2024-06-11 16:44:55:INFO:M: >>  Has0_acc_2: 0.6201  Has0_F1_score: 0.5879  Non0_acc_2: 0.6019  Non0_F1_score: 0.5693  Mult_acc_5: 0.3275  Mult_acc_7: 0.2576  MAE: 1.6346  Corr: 0.1775 
2024-06-11 16:45:10:INFO:TRAIN-(cmcm) (2/19/1)>> loss: 0.8246
2024-06-11 16:45:13:INFO:VAL-(cmcm) >>
2024-06-11 16:45:13:INFO:M: >>  Has0_acc_2: 0.6157  Has0_F1_score: 0.5496  Non0_acc_2: 0.6250  Non0_F1_score: 0.5851  Mult_acc_5: 0.3537  Mult_acc_7: 0.2751  MAE: 1.4948  Corr: 0.2486 
2024-06-11 16:45:28:INFO:TRAIN-(cmcm) (3/20/1)>> loss: 0.8232
2024-06-11 16:45:31:INFO:VAL-(cmcm) >>
2024-06-11 16:45:31:INFO:M: >>  Has0_acc_2: 0.6288  Has0_F1_score: 0.6020  Non0_acc_2: 0.6204  Non0_F1_score: 0.5983  Mult_acc_5: 0.3144  Mult_acc_7: 0.2576  MAE: 1.4887  Corr: 0.1781 
2024-06-11 16:45:47:INFO:TRAIN-(cmcm) (4/21/1)>> loss: 0.8150
2024-06-11 16:45:50:INFO:VAL-(cmcm) >>
2024-06-11 16:45:50:INFO:M: >>  Has0_acc_2: 0.6332  Has0_F1_score: 0.5808  Non0_acc_2: 0.6250  Non0_F1_score: 0.6112  Mult_acc_5: 0.3362  Mult_acc_7: 0.2795  MAE: 1.4651  Corr: 0.2013 
2024-06-11 16:46:06:INFO:TRAIN-(cmcm) (5/22/1)>> loss: 0.7992
2024-06-11 16:46:09:INFO:VAL-(cmcm) >>
2024-06-11 16:46:09:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5189  Non0_acc_2: 0.5880  Non0_F1_score: 0.5529  Mult_acc_5: 0.3100  Mult_acc_7: 0.2445  MAE: 1.5049  Corr: 0.1627 
2024-06-11 16:46:25:INFO:TRAIN-(cmcm) (6/23/1)>> loss: 0.8024
2024-06-11 16:46:27:INFO:VAL-(cmcm) >>
2024-06-11 16:46:27:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.5774  Non0_acc_2: 0.5880  Non0_F1_score: 0.5629  Mult_acc_5: 0.2795  Mult_acc_7: 0.2052  MAE: 1.6320  Corr: 0.1422 
2024-06-11 16:46:43:INFO:TRAIN-(cmcm) (7/24/1)>> loss: 0.7930
2024-06-11 16:46:46:INFO:VAL-(cmcm) >>
2024-06-11 16:46:46:INFO:M: >>  Has0_acc_2: 0.6201  Has0_F1_score: 0.6131  Non0_acc_2: 0.6343  Non0_F1_score: 0.6285  Mult_acc_5: 0.2795  Mult_acc_7: 0.2183  MAE: 1.4564  Corr: 0.2356 
2024-06-11 16:47:02:INFO:TRAIN-(cmcm) (8/25/1)>> loss: 0.7815
2024-06-11 16:47:05:INFO:VAL-(cmcm) >>
2024-06-11 16:47:05:INFO:M: >>  Has0_acc_2: 0.6419  Has0_F1_score: 0.6309  Non0_acc_2: 0.6389  Non0_F1_score: 0.6303  Mult_acc_5: 0.2795  Mult_acc_7: 0.2271  MAE: 1.4787  Corr: 0.2469 
2024-06-11 16:47:21:INFO:TRAIN-(cmcm) (9/26/1)>> loss: 0.7662
2024-06-11 16:47:24:INFO:VAL-(cmcm) >>
2024-06-11 16:47:24:INFO:M: >>  Has0_acc_2: 0.6288  Has0_F1_score: 0.5923  Non0_acc_2: 0.6065  Non0_F1_score: 0.5756  Mult_acc_5: 0.2795  Mult_acc_7: 0.2358  MAE: 1.5110  Corr: 0.1670 
2024-06-11 16:47:40:INFO:TRAIN-(cmcm) (10/27/1)>> loss: 0.7660
2024-06-11 16:47:43:INFO:VAL-(cmcm) >>
2024-06-11 16:47:43:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.5479  Non0_acc_2: 0.5880  Non0_F1_score: 0.5556  Mult_acc_5: 0.3100  Mult_acc_7: 0.2358  MAE: 1.5298  Corr: 0.1442 
2024-06-11 16:47:53:INFO:TEST-(cmcm) >>
2024-06-11 16:47:53:INFO:M: >>  Has0_acc_2: 0.4942  Has0_F1_score: 0.4137  Non0_acc_2: 0.5655  Non0_F1_score: 0.5664  Mult_acc_5: 0.2434  Mult_acc_7: 0.2245  MAE: 1.5528  Corr: 0.2007 
2024-06-11 16:47:53:INFO:Results are added to results/results/mosi-regression-40.csv...
2024-06-11 16:47:53:INFO:Start running cmcm...
2024-06-11 16:47:53:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 40, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 2222}>
2024-06-11 16:47:53:INFO:Let's use the GPU 1 !
2024-06-11 16:47:53:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 16:47:53:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718095674 HTTP/1.1" 200 235
2024-06-11 16:47:54:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 16:47:54:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 16:47:55:INFO:train samples: (1284,)
2024-06-11 16:47:55:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 16:47:55:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718095676 HTTP/1.1" 200 235
2024-06-11 16:47:56:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 16:47:56:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 16:47:57:INFO:valid samples: (229,)
2024-06-11 16:47:57:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 16:47:57:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718095677 HTTP/1.1" 200 235
2024-06-11 16:47:57:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 16:47:58:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 16:47:58:INFO:test samples: (686,)
2024-06-11 16:47:58:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 16:47:59:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718095679 HTTP/1.1" 200 235
2024-06-11 16:47:59:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 16:47:59:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 16:48:00:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 16:48:00:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718095680 HTTP/1.1" 200 235
2024-06-11 16:48:01:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 16:48:01:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 16:48:01:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-11 16:48:01:WARNING:Try importing flash-attention for faster inference...
2024-06-11 16:48:01:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-11 16:48:01:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-11 16:48:01:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-11 16:48:03:INFO:trainable params: 1310284 || all params: 1838138956 || trainable%: 0.07128318540461856
2024-06-11 16:48:03:INFO:Init labels...
2024-06-11 16:48:03:INFO:Start training...
2024-06-11 16:48:18:INFO:TRAIN-(cmcm) (1/1/2)>> loss: 2.4324
2024-06-11 16:48:21:INFO:VAL-(cmcm) >>
2024-06-11 16:48:21:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.4491  Non0_acc_2: 0.5602  Non0_F1_score: 0.4201  Mult_acc_5: 0.1921  Mult_acc_7: 0.1878  MAE: 1.5589  Corr: -0.0994 
2024-06-11 16:48:21:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-11 16:48:37:INFO:TRAIN-(cmcm) (1/2/2)>> loss: 0.9288
2024-06-11 16:48:40:INFO:VAL-(cmcm) >>
2024-06-11 16:48:40:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.5732  Non0_acc_2: 0.5787  Non0_F1_score: 0.5649  Mult_acc_5: 0.2707  Mult_acc_7: 0.2140  MAE: 1.5940  Corr: 0.0870 
2024-06-11 16:48:56:INFO:TRAIN-(cmcm) (2/3/2)>> loss: 0.8970
2024-06-11 16:48:59:INFO:VAL-(cmcm) >>
2024-06-11 16:48:59:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4458  Non0_acc_2: 0.5694  Non0_F1_score: 0.4166  Mult_acc_5: 0.1659  Mult_acc_7: 0.1659  MAE: 1.5835  Corr: -0.0374 
2024-06-11 16:49:16:INFO:TRAIN-(cmcm) (3/4/2)>> loss: 0.8827
2024-06-11 16:49:19:INFO:VAL-(cmcm) >>
2024-06-11 16:49:19:INFO:M: >>  Has0_acc_2: 0.4585  Has0_F1_score: 0.3867  Non0_acc_2: 0.4722  Non0_F1_score: 0.3960  Mult_acc_5: 0.1485  Mult_acc_7: 0.1485  MAE: 1.6733  Corr: 0.0977 
2024-06-11 16:49:36:INFO:TRAIN-(cmcm) (4/5/2)>> loss: 0.8748
2024-06-11 16:49:39:INFO:VAL-(cmcm) >>
2024-06-11 16:49:39:INFO:M: >>  Has0_acc_2: 0.5546  Has0_F1_score: 0.5310  Non0_acc_2: 0.5417  Non0_F1_score: 0.5162  Mult_acc_5: 0.1572  Mult_acc_7: 0.1528  MAE: 1.6418  Corr: -0.0163 
2024-06-11 16:49:56:INFO:TRAIN-(cmcm) (5/6/2)>> loss: 0.8618
2024-06-11 16:49:59:INFO:VAL-(cmcm) >>
2024-06-11 16:49:59:INFO:M: >>  Has0_acc_2: 0.5415  Has0_F1_score: 0.5205  Non0_acc_2: 0.5370  Non0_F1_score: 0.5125  Mult_acc_5: 0.2576  Mult_acc_7: 0.1747  MAE: 1.7983  Corr: -0.0058 
2024-06-11 16:50:16:INFO:TRAIN-(cmcm) (6/7/2)>> loss: 0.8651
2024-06-11 16:50:19:INFO:VAL-(cmcm) >>
2024-06-11 16:50:19:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.5673  Non0_acc_2: 0.5231  Non0_F1_score: 0.5257  Mult_acc_5: 0.2533  Mult_acc_7: 0.2052  MAE: 1.6254  Corr: 0.0505 
2024-06-11 16:50:35:INFO:TRAIN-(cmcm) (7/8/2)>> loss: 0.8606
2024-06-11 16:50:39:INFO:VAL-(cmcm) >>
2024-06-11 16:50:39:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5344  Non0_acc_2: 0.5602  Non0_F1_score: 0.5198  Mult_acc_5: 0.2882  Mult_acc_7: 0.2140  MAE: 1.7189  Corr: -0.0027 
2024-06-11 16:50:55:INFO:TRAIN-(cmcm) (8/9/2)>> loss: 0.8562
2024-06-11 16:50:58:INFO:VAL-(cmcm) >>
2024-06-11 16:50:59:INFO:M: >>  Has0_acc_2: 0.5371  Has0_F1_score: 0.5307  Non0_acc_2: 0.5417  Non0_F1_score: 0.5316  Mult_acc_5: 0.2445  Mult_acc_7: 0.2096  MAE: 1.6350  Corr: 0.0310 
2024-06-11 16:51:15:INFO:TRAIN-(cmcm) (9/10/2)>> loss: 0.8508
2024-06-11 16:51:18:INFO:VAL-(cmcm) >>
2024-06-11 16:51:18:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.4769  Non0_acc_2: 0.5880  Non0_F1_score: 0.4494  Mult_acc_5: 0.2664  Mult_acc_7: 0.2009  MAE: 1.6612  Corr: 0.0298 
2024-06-11 16:51:35:INFO:TRAIN-(cmcm) (10/11/2)>> loss: 0.8486
2024-06-11 16:51:38:INFO:VAL-(cmcm) >>
2024-06-11 16:51:38:INFO:M: >>  Has0_acc_2: 0.5590  Has0_F1_score: 0.5297  Non0_acc_2: 0.5509  Non0_F1_score: 0.5184  Mult_acc_5: 0.2664  Mult_acc_7: 0.1878  MAE: 1.8215  Corr: 0.0087 
2024-06-11 16:51:46:INFO:TEST-(cmcm) >>
2024-06-11 16:51:46:INFO:M: >>  Has0_acc_2: 0.4621  Has0_F1_score: 0.3342  Non0_acc_2: 0.4405  Non0_F1_score: 0.3163  Mult_acc_5: 0.1793  Mult_acc_7: 0.1691  MAE: 1.8071  Corr: 0.0353 
2024-06-11 16:51:47:INFO:Results are added to results/results/mosi-regression-40.csv...
2024-06-11 16:51:47:INFO:Start running cmcm...
2024-06-11 16:51:47:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 40, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 3333}>
2024-06-11 16:51:47:INFO:Let's use the GPU 1 !
2024-06-11 16:51:47:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 16:51:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718095907 HTTP/1.1" 200 235
2024-06-11 16:51:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 16:51:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 16:51:48:INFO:train samples: (1284,)
2024-06-11 16:51:48:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 16:51:49:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718095909 HTTP/1.1" 200 235
2024-06-11 16:51:49:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 16:51:49:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 16:51:50:INFO:valid samples: (229,)
2024-06-11 16:51:50:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 16:51:51:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718095911 HTTP/1.1" 200 235
2024-06-11 16:51:51:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 16:51:51:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 16:51:52:INFO:test samples: (686,)
2024-06-11 16:51:52:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 16:51:52:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718095912 HTTP/1.1" 200 235
2024-06-11 16:51:52:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 16:51:53:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 16:51:53:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 16:51:54:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718095914 HTTP/1.1" 200 235
2024-06-11 16:51:54:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 16:51:54:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 16:51:54:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-11 16:51:54:WARNING:Try importing flash-attention for faster inference...
2024-06-11 16:51:54:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-11 16:51:54:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-11 16:51:54:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-11 16:51:58:INFO:trainable params: 1310284 || all params: 1838138956 || trainable%: 0.07128318540461856
2024-06-11 16:51:58:INFO:Init labels...
2024-06-11 16:51:58:INFO:Start training...
2024-06-11 16:52:13:INFO:TRAIN-(cmcm) (1/1/3)>> loss: 2.9835
2024-06-11 16:52:16:INFO:VAL-(cmcm) >>
2024-06-11 16:52:16:INFO:M: >>  Has0_acc_2: 0.5546  Has0_F1_score: 0.5237  Non0_acc_2: 0.5370  Non0_F1_score: 0.5049  Mult_acc_5: 0.1921  Mult_acc_7: 0.1921  MAE: 1.6100  Corr: 0.0151 
2024-06-11 16:52:16:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-11 16:52:32:INFO:TRAIN-(cmcm) (1/2/3)>> loss: 0.9609
2024-06-11 16:52:35:INFO:VAL-(cmcm) >>
2024-06-11 16:52:35:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4458  Non0_acc_2: 0.5694  Non0_F1_score: 0.4166  Mult_acc_5: 0.2183  Mult_acc_7: 0.2096  MAE: 1.5187  Corr: 0.0070 
2024-06-11 16:52:35:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-11 16:52:51:INFO:TRAIN-(cmcm) (1/3/3)>> loss: 0.9099
2024-06-11 16:52:53:INFO:VAL-(cmcm) >>
2024-06-11 16:52:53:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.5433  Non0_acc_2: 0.5694  Non0_F1_score: 0.5328  Mult_acc_5: 0.2795  Mult_acc_7: 0.2052  MAE: 1.7009  Corr: 0.0555 
2024-06-11 16:53:09:INFO:TRAIN-(cmcm) (2/4/3)>> loss: 0.8932
2024-06-11 16:53:12:INFO:VAL-(cmcm) >>
2024-06-11 16:53:12:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.4880  Non0_acc_2: 0.5833  Non0_F1_score: 0.4610  Mult_acc_5: 0.2795  Mult_acc_7: 0.2183  MAE: 1.6468  Corr: 0.0048 
2024-06-11 16:53:27:INFO:TRAIN-(cmcm) (3/5/3)>> loss: 0.8902
2024-06-11 16:53:30:INFO:VAL-(cmcm) >>
2024-06-11 16:53:30:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.5137  Non0_acc_2: 0.5509  Non0_F1_score: 0.5031  Mult_acc_5: 0.2009  Mult_acc_7: 0.2009  MAE: 1.4702  Corr: 0.0333 
2024-06-11 16:53:30:INFO:Saving checkpoint at epoch 5 to results/models/cmcm-mosi-regression.pth.
2024-06-11 16:53:46:INFO:TRAIN-(cmcm) (1/6/3)>> loss: 0.8759
2024-06-11 16:53:48:INFO:VAL-(cmcm) >>
2024-06-11 16:53:48:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4652  Non0_acc_2: 0.5787  Non0_F1_score: 0.5029  Mult_acc_5: 0.2052  Mult_acc_7: 0.1965  MAE: 1.4580  Corr: 0.0567 
2024-06-11 16:53:49:INFO:Saving checkpoint at epoch 6 to results/models/cmcm-mosi-regression.pth.
2024-06-11 16:54:05:INFO:TRAIN-(cmcm) (1/7/3)>> loss: 0.8705
2024-06-11 16:54:07:INFO:VAL-(cmcm) >>
2024-06-11 16:54:07:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.5413  Non0_acc_2: 0.5648  Non0_F1_score: 0.5201  Mult_acc_5: 0.1659  Mult_acc_7: 0.1659  MAE: 1.5816  Corr: -0.0054 
2024-06-11 16:54:23:INFO:TRAIN-(cmcm) (2/8/3)>> loss: 0.8638
2024-06-11 16:54:25:INFO:VAL-(cmcm) >>
2024-06-11 16:54:25:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5271  Non0_acc_2: 0.5741  Non0_F1_score: 0.5084  Mult_acc_5: 0.2795  Mult_acc_7: 0.1965  MAE: 1.7306  Corr: 0.0211 
2024-06-11 16:54:41:INFO:TRAIN-(cmcm) (3/9/3)>> loss: 0.8597
2024-06-11 16:54:43:INFO:VAL-(cmcm) >>
2024-06-11 16:54:43:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.6065  Non0_F1_score: 0.5846  Mult_acc_5: 0.3406  Mult_acc_7: 0.2664  MAE: 1.5250  Corr: 0.1325 
2024-06-11 16:54:59:INFO:TRAIN-(cmcm) (4/10/3)>> loss: 0.8558
2024-06-11 16:55:01:INFO:VAL-(cmcm) >>
2024-06-11 16:55:01:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4700  Non0_acc_2: 0.5694  Non0_F1_score: 0.4396  Mult_acc_5: 0.2009  Mult_acc_7: 0.1965  MAE: 1.5695  Corr: 0.0149 
2024-06-11 16:55:16:INFO:TRAIN-(cmcm) (5/11/3)>> loss: 0.8588
2024-06-11 16:55:18:INFO:VAL-(cmcm) >>
2024-06-11 16:55:18:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5053  Non0_acc_2: 0.5648  Non0_F1_score: 0.4841  Mult_acc_5: 0.1528  Mult_acc_7: 0.1485  MAE: 1.6100  Corr: -0.0092 
2024-06-11 16:55:33:INFO:TRAIN-(cmcm) (6/12/3)>> loss: 0.8519
2024-06-11 16:55:35:INFO:VAL-(cmcm) >>
2024-06-11 16:55:35:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5053  Non0_acc_2: 0.5602  Non0_F1_score: 0.5134  Mult_acc_5: 0.2489  Mult_acc_7: 0.1878  MAE: 1.6446  Corr: 0.0206 
2024-06-11 16:55:50:INFO:TRAIN-(cmcm) (7/13/3)>> loss: 0.8466
2024-06-11 16:55:53:INFO:VAL-(cmcm) >>
2024-06-11 16:55:53:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.5187  Non0_acc_2: 0.5787  Non0_F1_score: 0.4932  Mult_acc_5: 0.2620  Mult_acc_7: 0.2052  MAE: 1.7931  Corr: 0.0201 
2024-06-11 16:56:07:INFO:TRAIN-(cmcm) (8/14/3)>> loss: 0.8450
2024-06-11 16:56:10:INFO:VAL-(cmcm) >>
2024-06-11 16:56:10:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.5788  Non0_acc_2: 0.5648  Non0_F1_score: 0.5642  Mult_acc_5: 0.1965  Mult_acc_7: 0.1747  MAE: 1.6405  Corr: 0.0618 
2024-06-11 16:56:24:INFO:TRAIN-(cmcm) (9/15/3)>> loss: 0.8461
2024-06-11 16:56:27:INFO:VAL-(cmcm) >>
2024-06-11 16:56:27:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5184  Non0_acc_2: 0.5602  Non0_F1_score: 0.5166  Mult_acc_5: 0.2926  Mult_acc_7: 0.2314  MAE: 1.4839  Corr: 0.1688 
2024-06-11 16:56:41:INFO:TRAIN-(cmcm) (10/16/3)>> loss: 0.8412
2024-06-11 16:56:44:INFO:VAL-(cmcm) >>
2024-06-11 16:56:44:INFO:M: >>  Has0_acc_2: 0.5459  Has0_F1_score: 0.5450  Non0_acc_2: 0.5556  Non0_F1_score: 0.5549  Mult_acc_5: 0.2576  Mult_acc_7: 0.1834  MAE: 1.7721  Corr: 0.0365 
2024-06-11 16:56:51:INFO:TEST-(cmcm) >>
2024-06-11 16:56:51:INFO:M: >>  Has0_acc_2: 0.4694  Has0_F1_score: 0.3360  Non0_acc_2: 0.4863  Non0_F1_score: 0.4483  Mult_acc_5: 0.1720  Mult_acc_7: 0.1691  MAE: 1.6487  Corr: 0.0701 
2024-06-11 16:56:51:INFO:Results are added to results/results/mosi-regression-40.csv...
2024-06-11 16:56:51:INFO:Start running cmcm...
2024-06-11 16:56:51:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 40, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 4444}>
2024-06-11 16:56:51:INFO:Let's use the GPU 1 !
2024-06-11 16:56:51:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 16:56:52:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718096212 HTTP/1.1" 200 235
2024-06-11 16:56:52:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 16:56:52:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 16:56:53:INFO:train samples: (1284,)
2024-06-11 16:56:53:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 16:56:53:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718096214 HTTP/1.1" 200 235
2024-06-11 16:56:54:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 16:56:54:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 16:56:55:INFO:valid samples: (229,)
2024-06-11 16:56:55:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 16:56:55:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718096215 HTTP/1.1" 200 235
2024-06-11 16:56:55:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 16:56:56:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 16:56:56:INFO:test samples: (686,)
2024-06-11 16:56:56:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 16:56:56:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718096217 HTTP/1.1" 200 235
2024-06-11 16:56:57:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 16:56:57:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 16:56:57:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 16:56:58:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718096218 HTTP/1.1" 200 235
2024-06-11 16:56:58:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 16:56:58:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 16:56:58:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-11 16:56:58:WARNING:Try importing flash-attention for faster inference...
2024-06-11 16:56:58:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-11 16:56:58:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-11 16:56:58:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-11 16:57:00:INFO:trainable params: 1310284 || all params: 1838138956 || trainable%: 0.07128318540461856
2024-06-11 16:57:00:INFO:Init labels...
2024-06-11 16:57:00:INFO:Start training...
2024-06-11 16:57:14:INFO:TRAIN-(cmcm) (1/1/4)>> loss: 2.3158
2024-06-11 16:57:17:INFO:VAL-(cmcm) >>
2024-06-11 16:57:17:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.4438  Non0_acc_2: 0.5787  Non0_F1_score: 0.4516  Mult_acc_5: 0.1834  Mult_acc_7: 0.1834  MAE: 1.4698  Corr: 0.0393 
2024-06-11 16:57:17:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-11 16:57:32:INFO:TRAIN-(cmcm) (1/2/4)>> loss: 1.6742
2024-06-11 16:57:34:INFO:VAL-(cmcm) >>
2024-06-11 16:57:34:INFO:M: >>  Has0_acc_2: 0.5415  Has0_F1_score: 0.4859  Non0_acc_2: 0.5185  Non0_F1_score: 0.5170  Mult_acc_5: 0.2096  Mult_acc_7: 0.2052  MAE: 1.4624  Corr: 0.0323 
2024-06-11 16:57:35:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-11 16:57:50:INFO:TRAIN-(cmcm) (1/3/4)>> loss: 1.0206
2024-06-11 16:57:52:INFO:VAL-(cmcm) >>
2024-06-11 16:57:52:INFO:M: >>  Has0_acc_2: 0.5590  Has0_F1_score: 0.4760  Non0_acc_2: 0.5324  Non0_F1_score: 0.4580  Mult_acc_5: 0.1703  Mult_acc_7: 0.1659  MAE: 1.5864  Corr: -0.0750 
2024-06-11 16:58:07:INFO:TRAIN-(cmcm) (2/4/4)>> loss: 0.9126
2024-06-11 16:58:09:INFO:VAL-(cmcm) >>
2024-06-11 16:58:09:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.4539  Non0_acc_2: 0.5509  Non0_F1_score: 0.4227  Mult_acc_5: 0.2795  Mult_acc_7: 0.2052  MAE: 1.7057  Corr: -0.1032 
2024-06-11 16:58:24:INFO:TRAIN-(cmcm) (3/5/4)>> loss: 0.8940
2024-06-11 16:58:26:INFO:VAL-(cmcm) >>
2024-06-11 16:58:26:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4630  Non0_acc_2: 0.5741  Non0_F1_score: 0.4346  Mult_acc_5: 0.2052  Mult_acc_7: 0.1747  MAE: 1.5108  Corr: 0.0444 
2024-06-11 16:58:41:INFO:TRAIN-(cmcm) (4/6/4)>> loss: 0.8780
2024-06-11 16:58:43:INFO:VAL-(cmcm) >>
2024-06-11 16:58:43:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4556  Non0_acc_2: 0.5231  Non0_F1_score: 0.4320  Mult_acc_5: 0.1747  Mult_acc_7: 0.1747  MAE: 1.5095  Corr: -0.0003 
2024-06-11 16:58:58:INFO:TRAIN-(cmcm) (5/7/4)>> loss: 0.8780
2024-06-11 16:59:00:INFO:VAL-(cmcm) >>
2024-06-11 16:59:00:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4805  Non0_acc_2: 0.5741  Non0_F1_score: 0.4558  Mult_acc_5: 0.2314  Mult_acc_7: 0.1790  MAE: 1.6349  Corr: 0.0183 
2024-06-11 16:59:15:INFO:TRAIN-(cmcm) (6/8/4)>> loss: 0.8596
2024-06-11 16:59:18:INFO:VAL-(cmcm) >>
2024-06-11 16:59:18:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.6046  Non0_acc_2: 0.6065  Non0_F1_score: 0.6023  Mult_acc_5: 0.2926  Mult_acc_7: 0.2183  MAE: 1.6036  Corr: 0.1738 
2024-06-11 16:59:32:INFO:TRAIN-(cmcm) (7/9/4)>> loss: 0.8576
2024-06-11 16:59:35:INFO:VAL-(cmcm) >>
2024-06-11 16:59:35:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.5403  Non0_acc_2: 0.5880  Non0_F1_score: 0.5303  Mult_acc_5: 0.2140  Mult_acc_7: 0.2009  MAE: 1.4803  Corr: 0.1083 
2024-06-11 16:59:49:INFO:TRAIN-(cmcm) (8/10/4)>> loss: 0.8493
2024-06-11 16:59:52:INFO:VAL-(cmcm) >>
2024-06-11 16:59:52:INFO:M: >>  Has0_acc_2: 0.5459  Has0_F1_score: 0.5469  Non0_acc_2: 0.5602  Non0_F1_score: 0.5599  Mult_acc_5: 0.2314  Mult_acc_7: 0.1790  MAE: 1.6926  Corr: 0.1269 
2024-06-11 17:00:06:INFO:TRAIN-(cmcm) (9/11/4)>> loss: 0.8490
2024-06-11 17:00:09:INFO:VAL-(cmcm) >>
2024-06-11 17:00:09:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.5680  Non0_acc_2: 0.5741  Non0_F1_score: 0.5445  Mult_acc_5: 0.2620  Mult_acc_7: 0.1878  MAE: 1.6560  Corr: 0.1123 
2024-06-11 17:00:23:INFO:TRAIN-(cmcm) (10/12/4)>> loss: 0.8459
2024-06-11 17:00:26:INFO:VAL-(cmcm) >>
2024-06-11 17:00:26:INFO:M: >>  Has0_acc_2: 0.6201  Has0_F1_score: 0.5398  Non0_acc_2: 0.5972  Non0_F1_score: 0.5445  Mult_acc_5: 0.2795  Mult_acc_7: 0.2096  MAE: 1.5095  Corr: 0.1571 
2024-06-11 17:00:33:INFO:TEST-(cmcm) >>
2024-06-11 17:00:33:INFO:M: >>  Has0_acc_2: 0.4563  Has0_F1_score: 0.3666  Non0_acc_2: 0.5091  Non0_F1_score: 0.5070  Mult_acc_5: 0.1676  Mult_acc_7: 0.1662  MAE: 1.5747  Corr: 0.0464 
2024-06-11 17:00:34:INFO:Results are added to results/results/mosi-regression-40.csv...
2024-06-11 17:00:34:INFO:Start running cmcm...
2024-06-11 17:00:34:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 40, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 5555}>
2024-06-11 17:00:34:INFO:Let's use the GPU 1 !
2024-06-11 17:00:34:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 17:00:34:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718096434 HTTP/1.1" 200 235
2024-06-11 17:00:34:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 17:00:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 17:00:35:INFO:train samples: (1284,)
2024-06-11 17:00:35:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 17:00:36:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718096436 HTTP/1.1" 200 235
2024-06-11 17:00:36:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 17:00:36:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 17:00:37:INFO:valid samples: (229,)
2024-06-11 17:00:37:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 17:00:37:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718096437 HTTP/1.1" 200 235
2024-06-11 17:00:37:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 17:00:38:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 17:00:38:INFO:test samples: (686,)
2024-06-11 17:00:38:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 17:00:39:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718096439 HTTP/1.1" 200 235
2024-06-11 17:00:39:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 17:00:39:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 17:00:40:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 17:00:40:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718096440 HTTP/1.1" 200 235
2024-06-11 17:00:40:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 17:00:40:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 17:00:41:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-11 17:00:41:WARNING:Try importing flash-attention for faster inference...
2024-06-11 17:00:41:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-11 17:00:41:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-11 17:00:41:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-11 17:00:42:INFO:trainable params: 1310284 || all params: 1838138956 || trainable%: 0.07128318540461856
2024-06-11 17:00:42:INFO:Init labels...
2024-06-11 17:00:42:INFO:Start training...
2024-06-11 17:00:56:INFO:TRAIN-(cmcm) (1/1/5)>> loss: 2.0402
2024-06-11 17:00:59:INFO:VAL-(cmcm) >>
2024-06-11 17:00:59:INFO:M: >>  Has0_acc_2: 0.4847  Has0_F1_score: 0.4541  Non0_acc_2: 0.4954  Non0_F1_score: 0.4618  Mult_acc_5: 0.2096  Mult_acc_7: 0.1659  MAE: 1.7986  Corr: 0.0751 
2024-06-11 17:00:59:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-11 17:01:14:INFO:TRAIN-(cmcm) (1/2/5)>> loss: 0.9931
2024-06-11 17:01:17:INFO:VAL-(cmcm) >>
2024-06-11 17:01:17:INFO:M: >>  Has0_acc_2: 0.5546  Has0_F1_score: 0.5560  Non0_acc_2: 0.5556  Non0_F1_score: 0.5549  Mult_acc_5: 0.2227  Mult_acc_7: 0.1965  MAE: 1.5768  Corr: 0.0837 
2024-06-11 17:01:17:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-11 17:01:32:INFO:TRAIN-(cmcm) (1/3/5)>> loss: 0.9620
2024-06-11 17:01:35:INFO:VAL-(cmcm) >>
2024-06-11 17:01:35:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4805  Non0_acc_2: 0.5741  Non0_F1_score: 0.4622  Mult_acc_5: 0.2227  Mult_acc_7: 0.2009  MAE: 1.6768  Corr: -0.0876 
2024-06-11 17:01:49:INFO:TRAIN-(cmcm) (2/4/5)>> loss: 0.9359
2024-06-11 17:01:52:INFO:VAL-(cmcm) >>
2024-06-11 17:01:52:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5741  Non0_F1_score: 0.4187  Mult_acc_5: 0.2052  Mult_acc_7: 0.2009  MAE: 1.4947  Corr: -0.0429 
2024-06-11 17:01:52:INFO:Saving checkpoint at epoch 4 to results/models/cmcm-mosi-regression.pth.
2024-06-11 17:02:07:INFO:TRAIN-(cmcm) (1/5/5)>> loss: 0.9092
2024-06-11 17:02:10:INFO:VAL-(cmcm) >>
2024-06-11 17:02:10:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4742  Non0_acc_2: 0.5694  Non0_F1_score: 0.4465  Mult_acc_5: 0.1747  Mult_acc_7: 0.1747  MAE: 1.4563  Corr: 0.0644 
2024-06-11 17:02:10:INFO:Saving checkpoint at epoch 5 to results/models/cmcm-mosi-regression.pth.
2024-06-11 17:02:25:INFO:TRAIN-(cmcm) (1/6/5)>> loss: 0.8897
2024-06-11 17:02:28:INFO:VAL-(cmcm) >>
2024-06-11 17:02:28:INFO:M: >>  Has0_acc_2: 0.5633  Has0_F1_score: 0.5249  Non0_acc_2: 0.5556  Non0_F1_score: 0.5132  Mult_acc_5: 0.2533  Mult_acc_7: 0.2140  MAE: 1.5991  Corr: -0.0060 
2024-06-11 17:02:42:INFO:TRAIN-(cmcm) (2/7/5)>> loss: 0.8787
2024-06-11 17:02:45:INFO:VAL-(cmcm) >>
2024-06-11 17:02:45:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5757  Non0_acc_2: 0.5833  Non0_F1_score: 0.5853  Mult_acc_5: 0.2576  Mult_acc_7: 0.1834  MAE: 1.5905  Corr: 0.1756 
2024-06-11 17:03:00:INFO:TRAIN-(cmcm) (3/8/5)>> loss: 0.8790
2024-06-11 17:03:02:INFO:VAL-(cmcm) >>
2024-06-11 17:03:02:INFO:M: >>  Has0_acc_2: 0.5109  Has0_F1_score: 0.4531  Non0_acc_2: 0.5370  Non0_F1_score: 0.4812  Mult_acc_5: 0.2445  Mult_acc_7: 0.1921  MAE: 1.8008  Corr: 0.2240 
2024-06-11 17:03:17:INFO:TRAIN-(cmcm) (4/9/5)>> loss: 0.8683
2024-06-11 17:03:19:INFO:VAL-(cmcm) >>
2024-06-11 17:03:19:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5850  Non0_acc_2: 0.5787  Non0_F1_score: 0.5810  Mult_acc_5: 0.2271  Mult_acc_7: 0.1659  MAE: 1.6218  Corr: 0.1521 
2024-06-11 17:03:34:INFO:TRAIN-(cmcm) (5/10/5)>> loss: 0.8712
2024-06-11 17:03:36:INFO:VAL-(cmcm) >>
2024-06-11 17:03:36:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5446  Non0_acc_2: 0.5741  Non0_F1_score: 0.5271  Mult_acc_5: 0.2358  Mult_acc_7: 0.1878  MAE: 1.6167  Corr: 0.0570 
2024-06-11 17:03:51:INFO:TRAIN-(cmcm) (6/11/5)>> loss: 0.8606
2024-06-11 17:03:53:INFO:VAL-(cmcm) >>
2024-06-11 17:03:53:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5761  Non0_acc_2: 0.5648  Non0_F1_score: 0.5672  Mult_acc_5: 0.2358  Mult_acc_7: 0.1790  MAE: 1.6918  Corr: 0.1051 
2024-06-11 17:04:08:INFO:TRAIN-(cmcm) (7/12/5)>> loss: 0.8540
2024-06-11 17:04:10:INFO:VAL-(cmcm) >>
2024-06-11 17:04:10:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.5058  Non0_acc_2: 0.5787  Non0_F1_score: 0.4827  Mult_acc_5: 0.2751  Mult_acc_7: 0.2140  MAE: 1.6656  Corr: 0.0509 
2024-06-11 17:04:25:INFO:TRAIN-(cmcm) (8/13/5)>> loss: 0.8559
2024-06-11 17:04:27:INFO:VAL-(cmcm) >>
2024-06-11 17:04:27:INFO:M: >>  Has0_acc_2: 0.6201  Has0_F1_score: 0.5140  Non0_acc_2: 0.5972  Non0_F1_score: 0.4884  Mult_acc_5: 0.3188  Mult_acc_7: 0.2489  MAE: 1.6293  Corr: 0.1796 
2024-06-11 17:04:42:INFO:TRAIN-(cmcm) (9/14/5)>> loss: 0.8475
2024-06-11 17:04:45:INFO:VAL-(cmcm) >>
2024-06-11 17:04:45:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.5620  Non0_acc_2: 0.5880  Non0_F1_score: 0.5817  Mult_acc_5: 0.2664  Mult_acc_7: 0.2052  MAE: 1.6603  Corr: 0.2392 
2024-06-11 17:04:59:INFO:TRAIN-(cmcm) (10/15/5)>> loss: 0.8446
2024-06-11 17:05:02:INFO:VAL-(cmcm) >>
2024-06-11 17:05:02:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.4897  Non0_acc_2: 0.5139  Non0_F1_score: 0.4584  Mult_acc_5: 0.2009  Mult_acc_7: 0.1790  MAE: 1.4943  Corr: 0.0915 
2024-06-11 17:05:09:INFO:TEST-(cmcm) >>
2024-06-11 17:05:09:INFO:M: >>  Has0_acc_2: 0.4898  Has0_F1_score: 0.3769  Non0_acc_2: 0.4665  Non0_F1_score: 0.3548  Mult_acc_5: 0.1749  Mult_acc_7: 0.1749  MAE: 1.5347  Corr: 0.1171 
2024-06-11 17:05:09:INFO:Results are added to results/results/mosi-regression-40.csv...
2024-06-11 17:05:09:INFO:Start running cmcm...
2024-06-11 17:05:09:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 50, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-06-11 17:05:09:INFO:Let's use the GPU 1 !
2024-06-11 17:05:09:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 17:05:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718096710 HTTP/1.1" 200 235
2024-06-11 17:05:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 17:05:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 17:05:11:INFO:train samples: (1284,)
2024-06-11 17:05:11:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 17:05:11:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718096711 HTTP/1.1" 200 235
2024-06-11 17:05:11:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 17:05:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 17:05:12:INFO:valid samples: (229,)
2024-06-11 17:05:13:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 17:05:13:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718096713 HTTP/1.1" 200 235
2024-06-11 17:05:13:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 17:05:13:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 17:05:14:INFO:test samples: (686,)
2024-06-11 17:05:14:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 17:05:14:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718096715 HTTP/1.1" 200 235
2024-06-11 17:05:14:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 17:05:15:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 17:05:15:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 17:05:16:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718096716 HTTP/1.1" 200 235
2024-06-11 17:05:16:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 17:05:16:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 17:05:16:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-11 17:05:16:WARNING:Try importing flash-attention for faster inference...
2024-06-11 17:05:16:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-11 17:05:16:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-11 17:05:16:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-11 17:05:17:INFO:trainable params: 1310284 || all params: 1838138956 || trainable%: 0.07128318540461856
2024-06-11 17:05:17:INFO:Init labels...
2024-06-11 17:05:17:INFO:Start training...
2024-06-11 17:05:32:INFO:TRAIN-(cmcm) (1/1/1)>> loss: 2.1118
2024-06-11 17:05:34:INFO:VAL-(cmcm) >>
2024-06-11 17:05:34:INFO:M: >>  Has0_acc_2: 0.5633  Has0_F1_score: 0.5482  Non0_acc_2: 0.5556  Non0_F1_score: 0.5382  Mult_acc_5: 0.2227  Mult_acc_7: 0.1834  MAE: 1.6678  Corr: 0.0093 
2024-06-11 17:05:35:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-11 17:05:50:INFO:TRAIN-(cmcm) (1/2/1)>> loss: 0.9547
2024-06-11 17:05:52:INFO:VAL-(cmcm) >>
2024-06-11 17:05:52:INFO:M: >>  Has0_acc_2: 0.5328  Has0_F1_score: 0.5323  Non0_acc_2: 0.5324  Non0_F1_score: 0.5296  Mult_acc_5: 0.2183  Mult_acc_7: 0.1572  MAE: 1.8630  Corr: -0.0197 
2024-06-11 17:06:07:INFO:TRAIN-(cmcm) (2/3/1)>> loss: 0.9170
2024-06-11 17:06:09:INFO:VAL-(cmcm) >>
2024-06-11 17:06:09:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4676  Non0_acc_2: 0.5648  Non0_F1_score: 0.4371  Mult_acc_5: 0.2445  Mult_acc_7: 0.2009  MAE: 1.5839  Corr: -0.0231 
2024-06-11 17:06:10:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-mosi-regression.pth.
2024-06-11 17:06:25:INFO:TRAIN-(cmcm) (1/4/1)>> loss: 0.8981
2024-06-11 17:06:27:INFO:VAL-(cmcm) >>
2024-06-11 17:06:27:INFO:M: >>  Has0_acc_2: 0.4629  Has0_F1_score: 0.4348  Non0_acc_2: 0.4815  Non0_F1_score: 0.4535  Mult_acc_5: 0.1485  Mult_acc_7: 0.1485  MAE: 1.7750  Corr: 0.0368 
2024-06-11 17:06:42:INFO:TRAIN-(cmcm) (2/5/1)>> loss: 0.9121
2024-06-11 17:06:45:INFO:VAL-(cmcm) >>
2024-06-11 17:06:45:INFO:M: >>  Has0_acc_2: 0.5590  Has0_F1_score: 0.5479  Non0_acc_2: 0.5602  Non0_F1_score: 0.5457  Mult_acc_5: 0.2096  Mult_acc_7: 0.2052  MAE: 1.5453  Corr: 0.0587 
2024-06-11 17:06:45:INFO:Saving checkpoint at epoch 5 to results/models/cmcm-mosi-regression.pth.
2024-06-11 17:07:00:INFO:TRAIN-(cmcm) (1/6/1)>> loss: 0.8899
2024-06-11 17:07:02:INFO:VAL-(cmcm) >>
2024-06-11 17:07:02:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5493  Non0_acc_2: 0.5509  Non0_F1_score: 0.5395  Mult_acc_5: 0.2358  Mult_acc_7: 0.2183  MAE: 1.5244  Corr: 0.0728 
2024-06-11 17:07:03:INFO:Saving checkpoint at epoch 6 to results/models/cmcm-mosi-regression.pth.
2024-06-11 17:07:18:INFO:TRAIN-(cmcm) (1/7/1)>> loss: 0.8730
2024-06-11 17:07:20:INFO:VAL-(cmcm) >>
2024-06-11 17:07:20:INFO:M: >>  Has0_acc_2: 0.5633  Has0_F1_score: 0.5444  Non0_acc_2: 0.5556  Non0_F1_score: 0.5556  Mult_acc_5: 0.2576  Mult_acc_7: 0.2271  MAE: 1.5253  Corr: 0.0686 
2024-06-11 17:07:35:INFO:TRAIN-(cmcm) (2/8/1)>> loss: 0.8801
2024-06-11 17:07:37:INFO:VAL-(cmcm) >>
2024-06-11 17:07:37:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5554  Non0_acc_2: 0.5602  Non0_F1_score: 0.5421  Mult_acc_5: 0.2009  Mult_acc_7: 0.1834  MAE: 1.6039  Corr: 0.0072 
2024-06-11 17:07:52:INFO:TRAIN-(cmcm) (3/9/1)>> loss: 0.8792
2024-06-11 17:07:55:INFO:VAL-(cmcm) >>
2024-06-11 17:07:55:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.4892  Non0_acc_2: 0.5463  Non0_F1_score: 0.4621  Mult_acc_5: 0.2882  Mult_acc_7: 0.2183  MAE: 1.7368  Corr: -0.0437 
2024-06-11 17:08:09:INFO:TRAIN-(cmcm) (4/10/1)>> loss: 0.8629
2024-06-11 17:08:12:INFO:VAL-(cmcm) >>
2024-06-11 17:08:12:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.5690  Non0_acc_2: 0.5926  Non0_F1_score: 0.5643  Mult_acc_5: 0.2882  Mult_acc_7: 0.2227  MAE: 1.5603  Corr: 0.0957 
2024-06-11 17:08:27:INFO:TRAIN-(cmcm) (5/11/1)>> loss: 0.8616
2024-06-11 17:08:30:INFO:VAL-(cmcm) >>
2024-06-11 17:08:30:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.4951  Non0_acc_2: 0.5463  Non0_F1_score: 0.5409  Mult_acc_5: 0.3100  Mult_acc_7: 0.2489  MAE: 1.4944  Corr: 0.0766 
2024-06-11 17:08:30:INFO:Saving checkpoint at epoch 11 to results/models/cmcm-mosi-regression.pth.
2024-06-11 17:08:45:INFO:TRAIN-(cmcm) (1/12/1)>> loss: 0.8533
2024-06-11 17:08:48:INFO:VAL-(cmcm) >>
2024-06-11 17:08:48:INFO:M: >>  Has0_acc_2: 0.6201  Has0_F1_score: 0.5351  Non0_acc_2: 0.6019  Non0_F1_score: 0.5137  Mult_acc_5: 0.3013  Mult_acc_7: 0.2271  MAE: 1.7084  Corr: 0.0933 
2024-06-11 17:09:02:INFO:TRAIN-(cmcm) (2/13/1)>> loss: 0.8494
2024-06-11 17:09:05:INFO:VAL-(cmcm) >>
2024-06-11 17:09:05:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.5997  Non0_acc_2: 0.6157  Non0_F1_score: 0.6149  Mult_acc_5: 0.3275  Mult_acc_7: 0.2445  MAE: 1.4809  Corr: 0.2238 
2024-06-11 17:09:05:INFO:Saving checkpoint at epoch 13 to results/models/cmcm-mosi-regression.pth.
2024-06-11 17:09:20:INFO:TRAIN-(cmcm) (1/14/1)>> loss: 0.8458
2024-06-11 17:09:23:INFO:VAL-(cmcm) >>
2024-06-11 17:09:23:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5952  Non0_acc_2: 0.6157  Non0_F1_score: 0.6155  Mult_acc_5: 0.2838  Mult_acc_7: 0.1965  MAE: 1.5187  Corr: 0.2658 
2024-06-11 17:09:37:INFO:TRAIN-(cmcm) (2/15/1)>> loss: 0.8375
2024-06-11 17:09:40:INFO:VAL-(cmcm) >>
2024-06-11 17:09:40:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.5059  Non0_acc_2: 0.5880  Non0_F1_score: 0.4885  Mult_acc_5: 0.3013  Mult_acc_7: 0.2358  MAE: 1.5183  Corr: 0.1749 
2024-06-11 17:09:54:INFO:TRAIN-(cmcm) (3/16/1)>> loss: 0.8254
2024-06-11 17:09:57:INFO:VAL-(cmcm) >>
2024-06-11 17:09:57:INFO:M: >>  Has0_acc_2: 0.5590  Has0_F1_score: 0.5432  Non0_acc_2: 0.5787  Non0_F1_score: 0.5607  Mult_acc_5: 0.2402  Mult_acc_7: 0.1921  MAE: 1.5245  Corr: 0.2717 
2024-06-11 17:10:12:INFO:TRAIN-(cmcm) (4/17/1)>> loss: 0.8252
2024-06-11 17:10:14:INFO:VAL-(cmcm) >>
2024-06-11 17:10:14:INFO:M: >>  Has0_acc_2: 0.6550  Has0_F1_score: 0.6497  Non0_acc_2: 0.6481  Non0_F1_score: 0.6486  Mult_acc_5: 0.3406  Mult_acc_7: 0.2489  MAE: 1.3263  Corr: 0.3844 
2024-06-11 17:10:14:INFO:Saving checkpoint at epoch 17 to results/models/cmcm-mosi-regression.pth.
2024-06-11 17:10:29:INFO:TRAIN-(cmcm) (1/18/1)>> loss: 0.8071
2024-06-11 17:10:32:INFO:VAL-(cmcm) >>
2024-06-11 17:10:32:INFO:M: >>  Has0_acc_2: 0.6681  Has0_F1_score: 0.6702  Non0_acc_2: 0.6898  Non0_F1_score: 0.6907  Mult_acc_5: 0.3231  Mult_acc_7: 0.2707  MAE: 1.2664  Corr: 0.4636 
2024-06-11 17:10:32:INFO:Saving checkpoint at epoch 18 to results/models/cmcm-mosi-regression.pth.
2024-06-11 17:10:48:INFO:TRAIN-(cmcm) (1/19/1)>> loss: 0.7861
2024-06-11 17:10:50:INFO:VAL-(cmcm) >>
2024-06-11 17:10:50:INFO:M: >>  Has0_acc_2: 0.6201  Has0_F1_score: 0.5528  Non0_acc_2: 0.6111  Non0_F1_score: 0.5585  Mult_acc_5: 0.3362  Mult_acc_7: 0.2402  MAE: 1.5669  Corr: 0.2069 
2024-06-11 17:11:05:INFO:TRAIN-(cmcm) (2/20/1)>> loss: 0.7981
2024-06-11 17:11:08:INFO:VAL-(cmcm) >>
2024-06-11 17:11:08:INFO:M: >>  Has0_acc_2: 0.6376  Has0_F1_score: 0.6387  Non0_acc_2: 0.6528  Non0_F1_score: 0.6520  Mult_acc_5: 0.3188  Mult_acc_7: 0.2576  MAE: 1.3280  Corr: 0.3752 
2024-06-11 17:11:22:INFO:TRAIN-(cmcm) (3/21/1)>> loss: 0.7769
2024-06-11 17:11:25:INFO:VAL-(cmcm) >>
2024-06-11 17:11:25:INFO:M: >>  Has0_acc_2: 0.6769  Has0_F1_score: 0.6714  Non0_acc_2: 0.6852  Non0_F1_score: 0.6815  Mult_acc_5: 0.3275  Mult_acc_7: 0.2445  MAE: 1.3747  Corr: 0.3842 
2024-06-11 17:11:40:INFO:TRAIN-(cmcm) (4/22/1)>> loss: 0.7647
2024-06-11 17:11:42:INFO:VAL-(cmcm) >>
2024-06-11 17:11:42:INFO:M: >>  Has0_acc_2: 0.6681  Has0_F1_score: 0.6411  Non0_acc_2: 0.6713  Non0_F1_score: 0.6618  Mult_acc_5: 0.3493  Mult_acc_7: 0.2664  MAE: 1.2969  Corr: 0.3985 
2024-06-11 17:11:57:INFO:TRAIN-(cmcm) (5/23/1)>> loss: 0.7547
2024-06-11 17:11:59:INFO:VAL-(cmcm) >>
2024-06-11 17:11:59:INFO:M: >>  Has0_acc_2: 0.6943  Has0_F1_score: 0.6849  Non0_acc_2: 0.6852  Non0_F1_score: 0.6777  Mult_acc_5: 0.3406  Mult_acc_7: 0.2533  MAE: 1.4171  Corr: 0.3668 
2024-06-11 17:12:14:INFO:TRAIN-(cmcm) (6/24/1)>> loss: 0.7522
2024-06-11 17:12:17:INFO:VAL-(cmcm) >>
2024-06-11 17:12:17:INFO:M: >>  Has0_acc_2: 0.6987  Has0_F1_score: 0.7016  Non0_acc_2: 0.6991  Non0_F1_score: 0.6999  Mult_acc_5: 0.3144  Mult_acc_7: 0.2445  MAE: 1.3188  Corr: 0.4415 
2024-06-11 17:12:31:INFO:TRAIN-(cmcm) (7/25/1)>> loss: 0.7344
2024-06-11 17:12:34:INFO:VAL-(cmcm) >>
2024-06-11 17:12:34:INFO:M: >>  Has0_acc_2: 0.6681  Has0_F1_score: 0.6615  Non0_acc_2: 0.6806  Non0_F1_score: 0.6764  Mult_acc_5: 0.3450  Mult_acc_7: 0.2707  MAE: 1.3595  Corr: 0.3559 
2024-06-11 17:12:49:INFO:TRAIN-(cmcm) (8/26/1)>> loss: 0.7242
2024-06-11 17:12:51:INFO:VAL-(cmcm) >>
2024-06-11 17:12:51:INFO:M: >>  Has0_acc_2: 0.6725  Has0_F1_score: 0.6379  Non0_acc_2: 0.6852  Non0_F1_score: 0.6729  Mult_acc_5: 0.3013  Mult_acc_7: 0.2445  MAE: 1.3341  Corr: 0.3534 
2024-06-11 17:13:06:INFO:TRAIN-(cmcm) (9/27/1)>> loss: 0.7144
2024-06-11 17:13:08:INFO:VAL-(cmcm) >>
2024-06-11 17:13:08:INFO:M: >>  Has0_acc_2: 0.6638  Has0_F1_score: 0.6514  Non0_acc_2: 0.6852  Non0_F1_score: 0.6788  Mult_acc_5: 0.3537  Mult_acc_7: 0.2795  MAE: 1.3170  Corr: 0.3660 
2024-06-11 17:13:23:INFO:TRAIN-(cmcm) (10/28/1)>> loss: 0.7163
2024-06-11 17:13:26:INFO:VAL-(cmcm) >>
2024-06-11 17:13:26:INFO:M: >>  Has0_acc_2: 0.6856  Has0_F1_score: 0.6844  Non0_acc_2: 0.6806  Non0_F1_score: 0.6823  Mult_acc_5: 0.3450  Mult_acc_7: 0.2838  MAE: 1.2525  Corr: 0.4316 
2024-06-11 17:13:26:INFO:Saving checkpoint at epoch 28 to results/models/cmcm-mosi-regression.pth.
2024-06-11 17:13:41:INFO:TRAIN-(cmcm) (1/29/1)>> loss: 0.7033
2024-06-11 17:13:44:INFO:VAL-(cmcm) >>
2024-06-11 17:13:44:INFO:M: >>  Has0_acc_2: 0.6594  Has0_F1_score: 0.6396  Non0_acc_2: 0.6713  Non0_F1_score: 0.6693  Mult_acc_5: 0.2838  Mult_acc_7: 0.2227  MAE: 1.2934  Corr: 0.3635 
2024-06-11 17:13:58:INFO:TRAIN-(cmcm) (2/30/1)>> loss: 0.6761
2024-06-11 17:14:01:INFO:VAL-(cmcm) >>
2024-06-11 17:14:01:INFO:M: >>  Has0_acc_2: 0.6681  Has0_F1_score: 0.6505  Non0_acc_2: 0.6806  Non0_F1_score: 0.6735  Mult_acc_5: 0.3144  Mult_acc_7: 0.2620  MAE: 1.2536  Corr: 0.3851 
2024-06-11 17:14:16:INFO:TRAIN-(cmcm) (3/31/1)>> loss: 0.6683
2024-06-11 17:14:18:INFO:VAL-(cmcm) >>
2024-06-11 17:14:18:INFO:M: >>  Has0_acc_2: 0.6812  Has0_F1_score: 0.6720  Non0_acc_2: 0.6852  Non0_F1_score: 0.6842  Mult_acc_5: 0.3362  Mult_acc_7: 0.2576  MAE: 1.3477  Corr: 0.3488 
2024-06-11 17:14:33:INFO:TRAIN-(cmcm) (4/32/1)>> loss: 0.6541
2024-06-11 17:14:35:INFO:VAL-(cmcm) >>
2024-06-11 17:14:35:INFO:M: >>  Has0_acc_2: 0.6943  Has0_F1_score: 0.6861  Non0_acc_2: 0.7083  Non0_F1_score: 0.7045  Mult_acc_5: 0.3362  Mult_acc_7: 0.2751  MAE: 1.3250  Corr: 0.3508 
2024-06-11 17:14:50:INFO:TRAIN-(cmcm) (5/33/1)>> loss: 0.6490
2024-06-11 17:14:53:INFO:VAL-(cmcm) >>
2024-06-11 17:14:53:INFO:M: >>  Has0_acc_2: 0.6987  Has0_F1_score: 0.6787  Non0_acc_2: 0.6713  Non0_F1_score: 0.6592  Mult_acc_5: 0.3275  Mult_acc_7: 0.2751  MAE: 1.3516  Corr: 0.3255 
2024-06-11 17:15:07:INFO:TRAIN-(cmcm) (6/34/1)>> loss: 0.6309
2024-06-11 17:15:10:INFO:VAL-(cmcm) >>
2024-06-11 17:15:10:INFO:M: >>  Has0_acc_2: 0.6812  Has0_F1_score: 0.6601  Non0_acc_2: 0.6852  Non0_F1_score: 0.6742  Mult_acc_5: 0.3624  Mult_acc_7: 0.2882  MAE: 1.3420  Corr: 0.3440 
2024-06-11 17:15:24:INFO:TRAIN-(cmcm) (7/35/1)>> loss: 0.6153
2024-06-11 17:15:27:INFO:VAL-(cmcm) >>
2024-06-11 17:15:27:INFO:M: >>  Has0_acc_2: 0.6725  Has0_F1_score: 0.6755  Non0_acc_2: 0.6713  Non0_F1_score: 0.6728  Mult_acc_5: 0.2838  Mult_acc_7: 0.2314  MAE: 1.3158  Corr: 0.4115 
2024-06-11 17:15:42:INFO:TRAIN-(cmcm) (8/36/1)>> loss: 0.6040
2024-06-11 17:15:44:INFO:VAL-(cmcm) >>
2024-06-11 17:15:44:INFO:M: >>  Has0_acc_2: 0.6638  Has0_F1_score: 0.6621  Non0_acc_2: 0.6528  Non0_F1_score: 0.6534  Mult_acc_5: 0.3362  Mult_acc_7: 0.2751  MAE: 1.3044  Corr: 0.3582 
2024-06-11 17:15:59:INFO:TRAIN-(cmcm) (9/37/1)>> loss: 0.5742
2024-06-11 17:16:01:INFO:VAL-(cmcm) >>
2024-06-11 17:16:01:INFO:M: >>  Has0_acc_2: 0.6812  Has0_F1_score: 0.6825  Non0_acc_2: 0.6713  Non0_F1_score: 0.6729  Mult_acc_5: 0.3624  Mult_acc_7: 0.3100  MAE: 1.3014  Corr: 0.3705 
2024-06-11 17:16:16:INFO:TRAIN-(cmcm) (10/38/1)>> loss: 0.5524
2024-06-11 17:16:18:INFO:VAL-(cmcm) >>
2024-06-11 17:16:18:INFO:M: >>  Has0_acc_2: 0.6856  Has0_F1_score: 0.6837  Non0_acc_2: 0.6667  Non0_F1_score: 0.6681  Mult_acc_5: 0.3362  Mult_acc_7: 0.2882  MAE: 1.2769  Corr: 0.3854 
2024-06-11 17:16:26:INFO:TEST-(cmcm) >>
2024-06-11 17:16:26:INFO:M: >>  Has0_acc_2: 0.6793  Has0_F1_score: 0.6798  Non0_acc_2: 0.7088  Non0_F1_score: 0.7066  Mult_acc_5: 0.3397  Mult_acc_7: 0.2988  MAE: 1.2207  Corr: 0.4255 
2024-06-11 17:16:26:INFO:Results are added to results/results/mosi-regression-50.csv...
2024-06-11 17:16:26:INFO:Start running cmcm...
2024-06-11 17:16:26:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 50, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 2222}>
2024-06-11 17:16:26:INFO:Let's use the GPU 1 !
2024-06-11 17:16:26:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 17:16:26:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718097387 HTTP/1.1" 200 235
2024-06-11 17:16:27:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 17:16:27:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 17:16:28:INFO:train samples: (1284,)
2024-06-11 17:16:28:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 17:16:28:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718097388 HTTP/1.1" 200 235
2024-06-11 17:16:28:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 17:16:29:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 17:16:29:INFO:valid samples: (229,)
2024-06-11 17:16:29:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 17:16:30:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718097390 HTTP/1.1" 200 235
2024-06-11 17:16:30:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 17:16:30:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 17:16:31:INFO:test samples: (686,)
2024-06-11 17:16:31:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 17:16:31:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718097391 HTTP/1.1" 200 235
2024-06-11 17:16:31:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 17:16:32:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 17:16:32:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 17:16:32:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718097393 HTTP/1.1" 200 235
2024-06-11 17:16:33:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 17:16:33:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 17:16:33:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-11 17:16:33:WARNING:Try importing flash-attention for faster inference...
2024-06-11 17:16:33:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-11 17:16:33:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-11 17:16:33:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-11 17:16:34:INFO:trainable params: 1310284 || all params: 1838138956 || trainable%: 0.07128318540461856
2024-06-11 17:16:34:INFO:Init labels...
2024-06-11 17:16:34:INFO:Start training...
2024-06-11 17:16:49:INFO:TRAIN-(cmcm) (1/1/2)>> loss: 2.5425
2024-06-11 17:16:52:INFO:VAL-(cmcm) >>
2024-06-11 17:16:52:INFO:M: >>  Has0_acc_2: 0.4847  Has0_F1_score: 0.4673  Non0_acc_2: 0.4954  Non0_F1_score: 0.4759  Mult_acc_5: 0.2096  Mult_acc_7: 0.1747  MAE: 1.8996  Corr: 0.0412 
2024-06-11 17:16:52:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-11 17:17:07:INFO:TRAIN-(cmcm) (1/2/2)>> loss: 0.9454
2024-06-11 17:17:10:INFO:VAL-(cmcm) >>
2024-06-11 17:17:10:INFO:M: >>  Has0_acc_2: 0.4847  Has0_F1_score: 0.4851  Non0_acc_2: 0.4954  Non0_F1_score: 0.4942  Mult_acc_5: 0.1616  Mult_acc_7: 0.1616  MAE: 1.7008  Corr: 0.0313 
2024-06-11 17:17:10:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-11 17:17:25:INFO:TRAIN-(cmcm) (1/3/2)>> loss: 0.8958
2024-06-11 17:17:28:INFO:VAL-(cmcm) >>
2024-06-11 17:17:28:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.4780  Non0_acc_2: 0.5648  Non0_F1_score: 0.4505  Mult_acc_5: 0.2445  Mult_acc_7: 0.1790  MAE: 1.7057  Corr: -0.0002 
2024-06-11 17:17:42:INFO:TRAIN-(cmcm) (2/4/2)>> loss: 0.8793
2024-06-11 17:17:45:INFO:VAL-(cmcm) >>
2024-06-11 17:17:45:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.5433  Non0_acc_2: 0.5648  Non0_F1_score: 0.5292  Mult_acc_5: 0.2227  Mult_acc_7: 0.2096  MAE: 1.5484  Corr: 0.0063 
2024-06-11 17:17:45:INFO:Saving checkpoint at epoch 4 to results/models/cmcm-mosi-regression.pth.
2024-06-11 17:18:00:INFO:TRAIN-(cmcm) (1/5/2)>> loss: 0.8814
2024-06-11 17:18:03:INFO:VAL-(cmcm) >>
2024-06-11 17:18:03:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4830  Non0_acc_2: 0.5741  Non0_F1_score: 0.4558  Mult_acc_5: 0.1616  Mult_acc_7: 0.1616  MAE: 1.5340  Corr: -0.0041 
2024-06-11 17:18:03:INFO:Saving checkpoint at epoch 5 to results/models/cmcm-mosi-regression.pth.
2024-06-11 17:18:18:INFO:TRAIN-(cmcm) (1/6/2)>> loss: 0.8701
2024-06-11 17:18:21:INFO:VAL-(cmcm) >>
2024-06-11 17:18:21:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.5201  Non0_acc_2: 0.5556  Non0_F1_score: 0.4913  Mult_acc_5: 0.2838  Mult_acc_7: 0.2052  MAE: 1.7791  Corr: -0.0372 
2024-06-11 17:18:36:INFO:TRAIN-(cmcm) (2/7/2)>> loss: 0.8618
2024-06-11 17:18:38:INFO:VAL-(cmcm) >>
2024-06-11 17:18:38:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5109  Non0_acc_2: 0.5556  Non0_F1_score: 0.4913  Mult_acc_5: 0.3144  Mult_acc_7: 0.2358  MAE: 1.7311  Corr: -0.0108 
2024-06-11 17:18:53:INFO:TRAIN-(cmcm) (3/8/2)>> loss: 0.8622
2024-06-11 17:18:55:INFO:VAL-(cmcm) >>
2024-06-11 17:18:55:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.4897  Non0_acc_2: 0.5648  Non0_F1_score: 0.4791  Mult_acc_5: 0.2183  Mult_acc_7: 0.1878  MAE: 1.5632  Corr: -0.0105 
2024-06-11 17:19:10:INFO:TRAIN-(cmcm) (4/9/2)>> loss: 0.8575
2024-06-11 17:19:13:INFO:VAL-(cmcm) >>
2024-06-11 17:19:13:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5895  Non0_acc_2: 0.5926  Non0_F1_score: 0.5905  Mult_acc_5: 0.2969  Mult_acc_7: 0.2227  MAE: 1.5411  Corr: 0.1673 
2024-06-11 17:19:27:INFO:TRAIN-(cmcm) (5/10/2)>> loss: 0.8545
2024-06-11 17:19:30:INFO:VAL-(cmcm) >>
2024-06-11 17:19:30:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.4438  Non0_acc_2: 0.5648  Non0_F1_score: 0.4440  Mult_acc_5: 0.3100  Mult_acc_7: 0.2314  MAE: 1.6964  Corr: 0.0432 
2024-06-11 17:19:44:INFO:TRAIN-(cmcm) (6/11/2)>> loss: 0.8514
2024-06-11 17:19:47:INFO:VAL-(cmcm) >>
2024-06-11 17:19:47:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.4534  Non0_acc_2: 0.5463  Non0_F1_score: 0.4271  Mult_acc_5: 0.2882  Mult_acc_7: 0.2096  MAE: 1.8158  Corr: -0.0930 
2024-06-11 17:20:02:INFO:TRAIN-(cmcm) (7/12/2)>> loss: 0.8493
2024-06-11 17:20:04:INFO:VAL-(cmcm) >>
2024-06-11 17:20:04:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.4842  Non0_acc_2: 0.5556  Non0_F1_score: 0.4680  Mult_acc_5: 0.2882  Mult_acc_7: 0.2096  MAE: 1.7184  Corr: -0.0194 
2024-06-11 17:20:19:INFO:TRAIN-(cmcm) (8/13/2)>> loss: 0.8453
2024-06-11 17:20:21:INFO:VAL-(cmcm) >>
2024-06-11 17:20:21:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5692  Non0_acc_2: 0.5787  Non0_F1_score: 0.5530  Mult_acc_5: 0.2751  Mult_acc_7: 0.1965  MAE: 1.7442  Corr: 0.0330 
2024-06-11 17:20:36:INFO:TRAIN-(cmcm) (9/14/2)>> loss: 0.8430
2024-06-11 17:20:38:INFO:VAL-(cmcm) >>
2024-06-11 17:20:38:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.5717  Non0_acc_2: 0.5741  Non0_F1_score: 0.5763  Mult_acc_5: 0.2664  Mult_acc_7: 0.2052  MAE: 1.5322  Corr: 0.1870 
2024-06-11 17:20:39:INFO:Saving checkpoint at epoch 14 to results/models/cmcm-mosi-regression.pth.
2024-06-11 17:20:54:INFO:TRAIN-(cmcm) (1/15/2)>> loss: 0.8436
2024-06-11 17:20:56:INFO:VAL-(cmcm) >>
2024-06-11 17:20:56:INFO:M: >>  Has0_acc_2: 0.6376  Has0_F1_score: 0.6379  Non0_acc_2: 0.6343  Non0_F1_score: 0.6340  Mult_acc_5: 0.3144  Mult_acc_7: 0.2402  MAE: 1.4250  Corr: 0.2444 
2024-06-11 17:20:57:INFO:Saving checkpoint at epoch 15 to results/models/cmcm-mosi-regression.pth.
2024-06-11 17:21:12:INFO:TRAIN-(cmcm) (1/16/2)>> loss: 0.8398
2024-06-11 17:21:14:INFO:VAL-(cmcm) >>
2024-06-11 17:21:14:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4923  Non0_acc_2: 0.5741  Non0_F1_score: 0.4742  Mult_acc_5: 0.2489  Mult_acc_7: 0.1878  MAE: 1.6189  Corr: 0.0006 
2024-06-11 17:21:29:INFO:TRAIN-(cmcm) (2/17/2)>> loss: 0.8301
2024-06-11 17:21:32:INFO:VAL-(cmcm) >>
2024-06-11 17:21:32:INFO:M: >>  Has0_acc_2: 0.6288  Has0_F1_score: 0.5630  Non0_acc_2: 0.6157  Non0_F1_score: 0.5546  Mult_acc_5: 0.2882  Mult_acc_7: 0.2271  MAE: 1.6280  Corr: 0.0867 
2024-06-11 17:21:46:INFO:TRAIN-(cmcm) (3/18/2)>> loss: 0.8338
2024-06-11 17:21:49:INFO:VAL-(cmcm) >>
2024-06-11 17:21:49:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.6090  Non0_acc_2: 0.4769  Non0_F1_score: 0.3690  Mult_acc_5: 0.2183  Mult_acc_7: 0.2096  MAE: 1.4248  Corr: 0.2181 
2024-06-11 17:21:50:INFO:Saving checkpoint at epoch 18 to results/models/cmcm-mosi-regression.pth.
2024-06-11 17:22:05:INFO:TRAIN-(cmcm) (1/19/2)>> loss: 0.8187
2024-06-11 17:22:07:INFO:VAL-(cmcm) >>
2024-06-11 17:22:07:INFO:M: >>  Has0_acc_2: 0.6332  Has0_F1_score: 0.5958  Non0_acc_2: 0.6204  Non0_F1_score: 0.6222  Mult_acc_5: 0.3362  Mult_acc_7: 0.2751  MAE: 1.4014  Corr: 0.2171 
2024-06-11 17:22:08:INFO:Saving checkpoint at epoch 19 to results/models/cmcm-mosi-regression.pth.
2024-06-11 17:22:23:INFO:TRAIN-(cmcm) (1/20/2)>> loss: 0.8170
2024-06-11 17:22:25:INFO:VAL-(cmcm) >>
2024-06-11 17:22:25:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.5715  Non0_acc_2: 0.5787  Non0_F1_score: 0.5665  Mult_acc_5: 0.2576  Mult_acc_7: 0.2140  MAE: 1.5418  Corr: 0.0703 
2024-06-11 17:22:40:INFO:TRAIN-(cmcm) (2/21/2)>> loss: 0.8080
2024-06-11 17:22:42:INFO:VAL-(cmcm) >>
2024-06-11 17:22:42:INFO:M: >>  Has0_acc_2: 0.6332  Has0_F1_score: 0.5534  Non0_acc_2: 0.6250  Non0_F1_score: 0.5822  Mult_acc_5: 0.2707  Mult_acc_7: 0.2402  MAE: 1.4280  Corr: 0.1836 
2024-06-11 17:22:57:INFO:TRAIN-(cmcm) (3/22/2)>> loss: 0.8035
2024-06-11 17:22:59:INFO:VAL-(cmcm) >>
2024-06-11 17:22:59:INFO:M: >>  Has0_acc_2: 0.6463  Has0_F1_score: 0.6483  Non0_acc_2: 0.6620  Non0_F1_score: 0.6627  Mult_acc_5: 0.3057  Mult_acc_7: 0.2314  MAE: 1.4424  Corr: 0.3622 
2024-06-11 17:23:14:INFO:TRAIN-(cmcm) (4/23/2)>> loss: 0.7887
2024-06-11 17:23:17:INFO:VAL-(cmcm) >>
2024-06-11 17:23:17:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4534  Non0_acc_2: 0.5741  Non0_F1_score: 0.4420  Mult_acc_5: 0.2838  Mult_acc_7: 0.2052  MAE: 1.7180  Corr: 0.0977 
2024-06-11 17:23:31:INFO:TRAIN-(cmcm) (5/24/2)>> loss: 0.7940
2024-06-11 17:23:34:INFO:VAL-(cmcm) >>
2024-06-11 17:23:34:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.5544  Non0_acc_2: 0.5833  Non0_F1_score: 0.5340  Mult_acc_5: 0.3188  Mult_acc_7: 0.2402  MAE: 1.6267  Corr: 0.1089 
2024-06-11 17:23:48:INFO:TRAIN-(cmcm) (6/25/2)>> loss: 0.7959
2024-06-11 17:23:51:INFO:VAL-(cmcm) >>
2024-06-11 17:23:51:INFO:M: >>  Has0_acc_2: 0.6201  Has0_F1_score: 0.5443  Non0_acc_2: 0.6065  Non0_F1_score: 0.5514  Mult_acc_5: 0.3581  Mult_acc_7: 0.2882  MAE: 1.4558  Corr: 0.2254 
2024-06-11 17:24:06:INFO:TRAIN-(cmcm) (7/26/2)>> loss: 0.7764
2024-06-11 17:24:08:INFO:VAL-(cmcm) >>
2024-06-11 17:24:08:INFO:M: >>  Has0_acc_2: 0.6856  Has0_F1_score: 0.6719  Non0_acc_2: 0.6806  Non0_F1_score: 0.6772  Mult_acc_5: 0.3319  Mult_acc_7: 0.2576  MAE: 1.3433  Corr: 0.3843 
2024-06-11 17:24:09:INFO:Saving checkpoint at epoch 26 to results/models/cmcm-mosi-regression.pth.
2024-06-11 17:24:24:INFO:TRAIN-(cmcm) (1/27/2)>> loss: 0.7620
2024-06-11 17:24:26:INFO:VAL-(cmcm) >>
2024-06-11 17:24:26:INFO:M: >>  Has0_acc_2: 0.6769  Has0_F1_score: 0.6656  Non0_acc_2: 0.6620  Non0_F1_score: 0.6585  Mult_acc_5: 0.3406  Mult_acc_7: 0.2576  MAE: 1.3184  Corr: 0.3759 
2024-06-11 17:24:27:INFO:Saving checkpoint at epoch 27 to results/models/cmcm-mosi-regression.pth.
2024-06-11 17:24:42:INFO:TRAIN-(cmcm) (1/28/2)>> loss: 0.7589
2024-06-11 17:24:44:INFO:VAL-(cmcm) >>
2024-06-11 17:24:44:INFO:M: >>  Has0_acc_2: 0.6507  Has0_F1_score: 0.6458  Non0_acc_2: 0.6574  Non0_F1_score: 0.6525  Mult_acc_5: 0.3406  Mult_acc_7: 0.2533  MAE: 1.4411  Corr: 0.3126 
2024-06-11 17:24:59:INFO:TRAIN-(cmcm) (2/29/2)>> loss: 0.7513
2024-06-11 17:25:02:INFO:VAL-(cmcm) >>
2024-06-11 17:25:02:INFO:M: >>  Has0_acc_2: 0.6638  Has0_F1_score: 0.6374  Non0_acc_2: 0.6343  Non0_F1_score: 0.6139  Mult_acc_5: 0.3319  Mult_acc_7: 0.2533  MAE: 1.4053  Corr: 0.3490 
2024-06-11 17:25:16:INFO:TRAIN-(cmcm) (3/30/2)>> loss: 0.7399
2024-06-11 17:25:19:INFO:VAL-(cmcm) >>
2024-06-11 17:25:19:INFO:M: >>  Has0_acc_2: 0.6463  Has0_F1_score: 0.6034  Non0_acc_2: 0.6157  Non0_F1_score: 0.6096  Mult_acc_5: 0.2882  Mult_acc_7: 0.2620  MAE: 1.3283  Corr: 0.2685 
2024-06-11 17:25:33:INFO:TRAIN-(cmcm) (4/31/2)>> loss: 0.7449
2024-06-11 17:25:36:INFO:VAL-(cmcm) >>
2024-06-11 17:25:36:INFO:M: >>  Has0_acc_2: 0.6812  Has0_F1_score: 0.6635  Non0_acc_2: 0.6389  Non0_F1_score: 0.6303  Mult_acc_5: 0.3493  Mult_acc_7: 0.2751  MAE: 1.3062  Corr: 0.3723 
2024-06-11 17:25:36:INFO:Saving checkpoint at epoch 31 to results/models/cmcm-mosi-regression.pth.
2024-06-11 17:25:51:INFO:TRAIN-(cmcm) (1/32/2)>> loss: 0.7178
2024-06-11 17:25:54:INFO:VAL-(cmcm) >>
2024-06-11 17:25:54:INFO:M: >>  Has0_acc_2: 0.6638  Has0_F1_score: 0.6634  Non0_acc_2: 0.6528  Non0_F1_score: 0.6525  Mult_acc_5: 0.3100  Mult_acc_7: 0.2533  MAE: 1.3733  Corr: 0.3547 
2024-06-11 17:26:09:INFO:TRAIN-(cmcm) (2/33/2)>> loss: 0.7068
2024-06-11 17:26:11:INFO:VAL-(cmcm) >>
2024-06-11 17:26:11:INFO:M: >>  Has0_acc_2: 0.6594  Has0_F1_score: 0.6358  Non0_acc_2: 0.6343  Non0_F1_score: 0.6304  Mult_acc_5: 0.3493  Mult_acc_7: 0.2838  MAE: 1.3104  Corr: 0.3464 
2024-06-11 17:26:26:INFO:TRAIN-(cmcm) (3/34/2)>> loss: 0.7044
2024-06-11 17:26:28:INFO:VAL-(cmcm) >>
2024-06-11 17:26:28:INFO:M: >>  Has0_acc_2: 0.6288  Has0_F1_score: 0.6082  Non0_acc_2: 0.5972  Non0_F1_score: 0.5948  Mult_acc_5: 0.3188  Mult_acc_7: 0.2576  MAE: 1.3296  Corr: 0.3360 
2024-06-11 17:26:43:INFO:TRAIN-(cmcm) (4/35/2)>> loss: 0.6781
2024-06-11 17:26:46:INFO:VAL-(cmcm) >>
2024-06-11 17:26:46:INFO:M: >>  Has0_acc_2: 0.6550  Has0_F1_score: 0.6301  Non0_acc_2: 0.6389  Non0_F1_score: 0.6326  Mult_acc_5: 0.2969  Mult_acc_7: 0.2402  MAE: 1.3672  Corr: 0.3298 
2024-06-11 17:27:00:INFO:TRAIN-(cmcm) (5/36/2)>> loss: 0.6696
2024-06-11 17:27:03:INFO:VAL-(cmcm) >>
2024-06-11 17:27:03:INFO:M: >>  Has0_acc_2: 0.6550  Has0_F1_score: 0.6525  Non0_acc_2: 0.6250  Non0_F1_score: 0.6269  Mult_acc_5: 0.3057  Mult_acc_7: 0.2489  MAE: 1.3768  Corr: 0.3293 
2024-06-11 17:27:17:INFO:TRAIN-(cmcm) (6/37/2)>> loss: 0.6530
2024-06-11 17:27:20:INFO:VAL-(cmcm) >>
2024-06-11 17:27:20:INFO:M: >>  Has0_acc_2: 0.6681  Has0_F1_score: 0.6451  Non0_acc_2: 0.6528  Non0_F1_score: 0.6451  Mult_acc_5: 0.3624  Mult_acc_7: 0.2926  MAE: 1.3929  Corr: 0.3386 
2024-06-11 17:27:34:INFO:TRAIN-(cmcm) (7/38/2)>> loss: 0.6357
2024-06-11 17:27:37:INFO:VAL-(cmcm) >>
2024-06-11 17:27:37:INFO:M: >>  Has0_acc_2: 0.6856  Has0_F1_score: 0.6747  Non0_acc_2: 0.6620  Non0_F1_score: 0.6613  Mult_acc_5: 0.3144  Mult_acc_7: 0.2795  MAE: 1.3501  Corr: 0.3358 
2024-06-11 17:27:52:INFO:TRAIN-(cmcm) (8/39/2)>> loss: 0.6197
2024-06-11 17:27:54:INFO:VAL-(cmcm) >>
2024-06-11 17:27:54:INFO:M: >>  Has0_acc_2: 0.6376  Has0_F1_score: 0.6044  Non0_acc_2: 0.6019  Non0_F1_score: 0.5910  Mult_acc_5: 0.3319  Mult_acc_7: 0.2838  MAE: 1.3270  Corr: 0.2889 
2024-06-11 17:28:09:INFO:TRAIN-(cmcm) (9/40/2)>> loss: 0.6044
2024-06-11 17:28:11:INFO:VAL-(cmcm) >>
2024-06-11 17:28:11:INFO:M: >>  Has0_acc_2: 0.6419  Has0_F1_score: 0.6264  Non0_acc_2: 0.6065  Non0_F1_score: 0.6041  Mult_acc_5: 0.3493  Mult_acc_7: 0.2882  MAE: 1.3680  Corr: 0.3248 
2024-06-11 17:28:26:INFO:TRAIN-(cmcm) (10/41/2)>> loss: 0.5869
2024-06-11 17:28:28:INFO:VAL-(cmcm) >>
2024-06-11 17:28:28:INFO:M: >>  Has0_acc_2: 0.6507  Has0_F1_score: 0.6437  Non0_acc_2: 0.6435  Non0_F1_score: 0.6421  Mult_acc_5: 0.3581  Mult_acc_7: 0.2838  MAE: 1.3362  Corr: 0.3552 
2024-06-11 17:28:36:INFO:TEST-(cmcm) >>
2024-06-11 17:28:36:INFO:M: >>  Has0_acc_2: 0.6020  Has0_F1_score: 0.5970  Non0_acc_2: 0.6113  Non0_F1_score: 0.6108  Mult_acc_5: 0.2580  Mult_acc_7: 0.2259  MAE: 1.4018  Corr: 0.2987 
2024-06-11 17:28:36:INFO:Results are added to results/results/mosi-regression-50.csv...
2024-06-11 17:28:36:INFO:Start running cmcm...
2024-06-11 17:28:36:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 50, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 3333}>
2024-06-11 17:28:36:INFO:Let's use the GPU 1 !
2024-06-11 17:28:36:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 17:28:37:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718098117 HTTP/1.1" 200 235
2024-06-11 17:28:37:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 17:28:37:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 17:28:38:INFO:train samples: (1284,)
2024-06-11 17:28:38:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 17:28:38:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718098119 HTTP/1.1" 200 235
2024-06-11 17:28:39:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 17:28:39:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 17:28:40:INFO:valid samples: (229,)
2024-06-11 17:28:40:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 17:28:40:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718098120 HTTP/1.1" 200 235
2024-06-11 17:28:40:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 17:28:41:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 17:28:41:INFO:test samples: (686,)
2024-06-11 17:28:41:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 17:28:42:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718098122 HTTP/1.1" 200 235
2024-06-11 17:28:42:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 17:28:42:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 17:28:43:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 17:28:43:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718098123 HTTP/1.1" 200 235
2024-06-11 17:28:43:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 17:28:44:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 17:28:44:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-11 17:28:44:WARNING:Try importing flash-attention for faster inference...
2024-06-11 17:28:44:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-11 17:28:44:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-11 17:28:44:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-11 17:28:45:INFO:trainable params: 1310284 || all params: 1838138956 || trainable%: 0.07128318540461856
2024-06-11 17:28:45:INFO:Init labels...
2024-06-11 17:28:45:INFO:Start training...
2024-06-11 17:29:00:INFO:TRAIN-(cmcm) (1/1/3)>> loss: 3.1521
2024-06-11 17:29:02:INFO:VAL-(cmcm) >>
2024-06-11 17:29:02:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.4968  Non0_acc_2: 0.5648  Non0_F1_score: 0.4568  Mult_acc_5: 0.1921  Mult_acc_7: 0.1747  MAE: 1.6370  Corr: -0.0956 
2024-06-11 17:29:03:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-11 17:29:18:INFO:TRAIN-(cmcm) (1/2/3)>> loss: 0.9753
2024-06-11 17:29:20:INFO:VAL-(cmcm) >>
2024-06-11 17:29:20:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.4947  Non0_acc_2: 0.5787  Non0_F1_score: 0.5198  Mult_acc_5: 0.1747  Mult_acc_7: 0.1747  MAE: 1.4894  Corr: -0.0009 
2024-06-11 17:29:21:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-11 17:29:36:INFO:TRAIN-(cmcm) (1/3/3)>> loss: 0.9165
2024-06-11 17:29:38:INFO:VAL-(cmcm) >>
2024-06-11 17:29:38:INFO:M: >>  Has0_acc_2: 0.5328  Has0_F1_score: 0.5372  Non0_acc_2: 0.5278  Non0_F1_score: 0.5302  Mult_acc_5: 0.1834  Mult_acc_7: 0.1659  MAE: 1.6021  Corr: 0.0492 
2024-06-11 17:29:53:INFO:TRAIN-(cmcm) (2/4/3)>> loss: 0.8979
2024-06-11 17:29:56:INFO:VAL-(cmcm) >>
2024-06-11 17:29:56:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.5642  Non0_acc_2: 0.5694  Non0_F1_score: 0.5477  Mult_acc_5: 0.2096  Mult_acc_7: 0.2052  MAE: 1.5589  Corr: 0.0282 
2024-06-11 17:30:11:INFO:TRAIN-(cmcm) (3/5/3)>> loss: 0.8990
2024-06-11 17:30:14:INFO:VAL-(cmcm) >>
2024-06-11 17:30:14:INFO:M: >>  Has0_acc_2: 0.6245  Has0_F1_score: 0.5045  Non0_acc_2: 0.5926  Non0_F1_score: 0.4794  Mult_acc_5: 0.2096  Mult_acc_7: 0.2096  MAE: 1.4143  Corr: 0.0881 
2024-06-11 17:30:14:INFO:Saving checkpoint at epoch 5 to results/models/cmcm-mosi-regression.pth.
2024-06-11 17:30:30:INFO:TRAIN-(cmcm) (1/6/3)>> loss: 0.8798
2024-06-11 17:30:32:INFO:VAL-(cmcm) >>
2024-06-11 17:30:32:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.5479  Non0_acc_2: 0.5648  Non0_F1_score: 0.5417  Mult_acc_5: 0.2489  Mult_acc_7: 0.1572  MAE: 1.7114  Corr: 0.0747 
2024-06-11 17:30:47:INFO:TRAIN-(cmcm) (2/7/3)>> loss: 0.8740
2024-06-11 17:30:49:INFO:VAL-(cmcm) >>
2024-06-11 17:30:50:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5564  Non0_acc_2: 0.5787  Non0_F1_score: 0.5613  Mult_acc_5: 0.1878  Mult_acc_7: 0.1572  MAE: 1.6170  Corr: 0.0319 
2024-06-11 17:31:04:INFO:TRAIN-(cmcm) (3/8/3)>> loss: 0.8682
2024-06-11 17:31:07:INFO:VAL-(cmcm) >>
2024-06-11 17:31:07:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.5032  Non0_acc_2: 0.5833  Non0_F1_score: 0.4799  Mult_acc_5: 0.2969  Mult_acc_7: 0.2140  MAE: 1.6931  Corr: 0.0333 
2024-06-11 17:31:21:INFO:TRAIN-(cmcm) (4/9/3)>> loss: 0.8616
2024-06-11 17:31:24:INFO:VAL-(cmcm) >>
2024-06-11 17:31:24:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.4840  Non0_acc_2: 0.5787  Non0_F1_score: 0.4711  Mult_acc_5: 0.2707  Mult_acc_7: 0.2227  MAE: 1.5279  Corr: 0.0314 
2024-06-11 17:31:39:INFO:TRAIN-(cmcm) (5/10/3)>> loss: 0.8639
2024-06-11 17:31:41:INFO:VAL-(cmcm) >>
2024-06-11 17:31:41:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5787  Non0_F1_score: 0.4291  Mult_acc_5: 0.2707  Mult_acc_7: 0.2358  MAE: 1.4506  Corr: 0.1028 
2024-06-11 17:31:56:INFO:TRAIN-(cmcm) (6/11/3)>> loss: 0.8558
2024-06-11 17:31:58:INFO:VAL-(cmcm) >>
2024-06-11 17:31:58:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5477  Non0_acc_2: 0.5880  Non0_F1_score: 0.5409  Mult_acc_5: 0.2227  Mult_acc_7: 0.1790  MAE: 1.5599  Corr: 0.1045 
2024-06-11 17:32:13:INFO:TRAIN-(cmcm) (7/12/3)>> loss: 0.8583
2024-06-11 17:32:15:INFO:VAL-(cmcm) >>
2024-06-11 17:32:15:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.4947  Non0_acc_2: 0.5926  Non0_F1_score: 0.5508  Mult_acc_5: 0.3493  Mult_acc_7: 0.2795  MAE: 1.5488  Corr: 0.0933 
2024-06-11 17:32:30:INFO:TRAIN-(cmcm) (8/13/3)>> loss: 0.8474
2024-06-11 17:32:33:INFO:VAL-(cmcm) >>
2024-06-11 17:32:33:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4866  Non0_acc_2: 0.5741  Non0_F1_score: 0.4622  Mult_acc_5: 0.3013  Mult_acc_7: 0.2227  MAE: 1.7791  Corr: 0.0663 
2024-06-11 17:32:47:INFO:TRAIN-(cmcm) (9/14/3)>> loss: 0.8472
2024-06-11 17:32:50:INFO:VAL-(cmcm) >>
2024-06-11 17:32:50:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.5005  Non0_acc_2: 0.6019  Non0_F1_score: 0.5030  Mult_acc_5: 0.3319  Mult_acc_7: 0.2489  MAE: 1.7071  Corr: 0.1419 
2024-06-11 17:33:04:INFO:TRAIN-(cmcm) (10/15/3)>> loss: 0.8443
2024-06-11 17:33:07:INFO:VAL-(cmcm) >>
2024-06-11 17:33:07:INFO:M: >>  Has0_acc_2: 0.6201  Has0_F1_score: 0.5351  Non0_acc_2: 0.5833  Non0_F1_score: 0.5269  Mult_acc_5: 0.2926  Mult_acc_7: 0.2227  MAE: 1.4846  Corr: 0.1553 
2024-06-11 17:33:14:INFO:TEST-(cmcm) >>
2024-06-11 17:33:14:INFO:M: >>  Has0_acc_2: 0.4621  Has0_F1_score: 0.3215  Non0_acc_2: 0.4360  Non0_F1_score: 0.3097  Mult_acc_5: 0.1662  Mult_acc_7: 0.1662  MAE: 1.4728  Corr: 0.0436 
2024-06-11 17:33:15:INFO:Results are added to results/results/mosi-regression-50.csv...
2024-06-11 17:33:15:INFO:Start running cmcm...
2024-06-11 17:33:15:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 50, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 4444}>
2024-06-11 17:33:15:INFO:Let's use the GPU 1 !
2024-06-11 17:33:15:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 17:33:15:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718098395 HTTP/1.1" 200 235
2024-06-11 17:33:15:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 17:33:16:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 17:33:16:INFO:train samples: (1284,)
2024-06-11 17:33:17:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 17:33:17:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718098397 HTTP/1.1" 200 235
2024-06-11 17:33:17:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 17:33:17:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 17:33:18:INFO:valid samples: (229,)
2024-06-11 17:33:18:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 17:33:18:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718098399 HTTP/1.1" 200 235
2024-06-11 17:33:19:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 17:33:19:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 17:33:20:INFO:test samples: (686,)
2024-06-11 17:33:20:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 17:33:20:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718098400 HTTP/1.1" 200 235
2024-06-11 17:33:20:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 17:33:21:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 17:33:21:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 17:33:21:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718098401 HTTP/1.1" 200 235
2024-06-11 17:33:21:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 17:33:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 17:33:22:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-11 17:33:22:WARNING:Try importing flash-attention for faster inference...
2024-06-11 17:33:22:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-11 17:33:22:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-11 17:33:22:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-11 17:33:23:INFO:trainable params: 1310284 || all params: 1838138956 || trainable%: 0.07128318540461856
2024-06-11 17:33:23:INFO:Init labels...
2024-06-11 17:33:23:INFO:Start training...
2024-06-11 17:33:38:INFO:TRAIN-(cmcm) (1/1/4)>> loss: 2.6357
2024-06-11 17:33:40:INFO:VAL-(cmcm) >>
2024-06-11 17:33:40:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.4730  Non0_acc_2: 0.5602  Non0_F1_score: 0.4540  Mult_acc_5: 0.1921  Mult_acc_7: 0.1616  MAE: 1.5590  Corr: -0.0587 
2024-06-11 17:33:41:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-11 17:33:56:INFO:TRAIN-(cmcm) (1/2/4)>> loss: 1.2513
2024-06-11 17:33:58:INFO:VAL-(cmcm) >>
2024-06-11 17:33:58:INFO:M: >>  Has0_acc_2: 0.5502  Has0_F1_score: 0.5389  Non0_acc_2: 0.5417  Non0_F1_score: 0.5316  Mult_acc_5: 0.1965  Mult_acc_7: 0.1965  MAE: 1.5353  Corr: -0.0072 
2024-06-11 17:33:59:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-11 17:34:14:INFO:TRAIN-(cmcm) (1/3/4)>> loss: 1.0213
2024-06-11 17:34:16:INFO:VAL-(cmcm) >>
2024-06-11 17:34:16:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.5099  Non0_acc_2: 0.5602  Non0_F1_score: 0.4902  Mult_acc_5: 0.2183  Mult_acc_7: 0.1485  MAE: 1.6079  Corr: 0.0189 
2024-06-11 17:34:31:INFO:TRAIN-(cmcm) (2/4/4)>> loss: 0.9044
2024-06-11 17:34:33:INFO:VAL-(cmcm) >>
2024-06-11 17:34:33:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.5187  Non0_acc_2: 0.5556  Non0_F1_score: 0.5401  Mult_acc_5: 0.2227  Mult_acc_7: 0.1747  MAE: 1.6468  Corr: 0.0304 
2024-06-11 17:34:48:INFO:TRAIN-(cmcm) (3/5/4)>> loss: 0.8782
2024-06-11 17:34:51:INFO:VAL-(cmcm) >>
2024-06-11 17:34:51:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.5509  Non0_acc_2: 0.5880  Non0_F1_score: 0.5303  Mult_acc_5: 0.2576  Mult_acc_7: 0.2358  MAE: 1.4359  Corr: 0.1391 
2024-06-11 17:34:51:INFO:Saving checkpoint at epoch 5 to results/models/cmcm-mosi-regression.pth.
2024-06-11 17:35:06:INFO:TRAIN-(cmcm) (1/6/4)>> loss: 0.8690
2024-06-11 17:35:09:INFO:VAL-(cmcm) >>
2024-06-11 17:35:09:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.4694  Non0_acc_2: 0.5648  Non0_F1_score: 0.5263  Mult_acc_5: 0.2838  Mult_acc_7: 0.2052  MAE: 1.6250  Corr: 0.0153 
2024-06-11 17:35:23:INFO:TRAIN-(cmcm) (2/7/4)>> loss: 0.8602
2024-06-11 17:35:26:INFO:VAL-(cmcm) >>
2024-06-11 17:35:26:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.5390  Non0_acc_2: 0.5556  Non0_F1_score: 0.5247  Mult_acc_5: 0.2664  Mult_acc_7: 0.1878  MAE: 1.6835  Corr: 0.0083 
2024-06-11 17:35:40:INFO:TRAIN-(cmcm) (3/8/4)>> loss: 0.8576
2024-06-11 17:35:43:INFO:VAL-(cmcm) >>
2024-06-11 17:35:43:INFO:M: >>  Has0_acc_2: 0.5284  Has0_F1_score: 0.5203  Non0_acc_2: 0.5417  Non0_F1_score: 0.5321  Mult_acc_5: 0.2271  Mult_acc_7: 0.1790  MAE: 1.6612  Corr: 0.0994 
2024-06-11 17:35:58:INFO:TRAIN-(cmcm) (4/9/4)>> loss: 0.8597
2024-06-11 17:36:00:INFO:VAL-(cmcm) >>
2024-06-11 17:36:00:INFO:M: >>  Has0_acc_2: 0.6769  Has0_F1_score: 0.6505  Non0_acc_2: 0.6574  Non0_F1_score: 0.6316  Mult_acc_5: 0.3362  Mult_acc_7: 0.2620  MAE: 1.4525  Corr: 0.2124 
2024-06-11 17:36:15:INFO:TRAIN-(cmcm) (5/10/4)>> loss: 0.8488
2024-06-11 17:36:17:INFO:VAL-(cmcm) >>
2024-06-11 17:36:17:INFO:M: >>  Has0_acc_2: 0.5459  Has0_F1_score: 0.5144  Non0_acc_2: 0.5324  Non0_F1_score: 0.4985  Mult_acc_5: 0.2838  Mult_acc_7: 0.2096  MAE: 1.7184  Corr: -0.0547 
2024-06-11 17:36:32:INFO:TRAIN-(cmcm) (6/11/4)>> loss: 0.8501
2024-06-11 17:36:34:INFO:VAL-(cmcm) >>
2024-06-11 17:36:34:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.5697  Non0_acc_2: 0.6065  Non0_F1_score: 0.5780  Mult_acc_5: 0.2795  Mult_acc_7: 0.2096  MAE: 1.5341  Corr: 0.1329 
2024-06-11 17:36:49:INFO:TRAIN-(cmcm) (7/12/4)>> loss: 0.8468
2024-06-11 17:36:52:INFO:VAL-(cmcm) >>
2024-06-11 17:36:52:INFO:M: >>  Has0_acc_2: 0.6376  Has0_F1_score: 0.6340  Non0_acc_2: 0.6111  Non0_F1_score: 0.6124  Mult_acc_5: 0.2620  Mult_acc_7: 0.2096  MAE: 1.4547  Corr: 0.2247 
2024-06-11 17:37:06:INFO:TRAIN-(cmcm) (8/13/4)>> loss: 0.8421
2024-06-11 17:37:09:INFO:VAL-(cmcm) >>
2024-06-11 17:37:09:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4830  Non0_acc_2: 0.5741  Non0_F1_score: 0.4558  Mult_acc_5: 0.2969  Mult_acc_7: 0.2140  MAE: 1.7398  Corr: 0.0108 
2024-06-11 17:37:23:INFO:TRAIN-(cmcm) (9/14/4)>> loss: 0.8366
2024-06-11 17:37:26:INFO:VAL-(cmcm) >>
2024-06-11 17:37:26:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4891  Non0_acc_2: 0.5787  Non0_F1_score: 0.4711  Mult_acc_5: 0.3100  Mult_acc_7: 0.2271  MAE: 1.6813  Corr: -0.0130 
2024-06-11 17:37:40:INFO:TRAIN-(cmcm) (10/15/4)>> loss: 0.8374
2024-06-11 17:37:43:INFO:VAL-(cmcm) >>
2024-06-11 17:37:43:INFO:M: >>  Has0_acc_2: 0.6332  Has0_F1_score: 0.6056  Non0_acc_2: 0.6250  Non0_F1_score: 0.5955  Mult_acc_5: 0.3013  Mult_acc_7: 0.2227  MAE: 1.5669  Corr: 0.1161 
2024-06-11 17:37:50:INFO:TEST-(cmcm) >>
2024-06-11 17:37:50:INFO:M: >>  Has0_acc_2: 0.5729  Has0_F1_score: 0.5632  Non0_acc_2: 0.5686  Non0_F1_score: 0.5603  Mult_acc_5: 0.2041  Mult_acc_7: 0.2026  MAE: 1.3850  Corr: 0.2159 
2024-06-11 17:37:51:INFO:Results are added to results/results/mosi-regression-50.csv...
2024-06-11 17:37:51:INFO:Start running cmcm...
2024-06-11 17:37:51:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 50, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 5555}>
2024-06-11 17:37:51:INFO:Let's use the GPU 1 !
2024-06-11 17:37:51:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 17:37:51:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718098671 HTTP/1.1" 200 235
2024-06-11 17:37:51:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 17:37:52:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 17:37:52:INFO:train samples: (1284,)
2024-06-11 17:37:52:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 17:37:53:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718098673 HTTP/1.1" 200 235
2024-06-11 17:37:53:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 17:37:53:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 17:37:54:INFO:valid samples: (229,)
2024-06-11 17:37:54:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 17:37:54:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718098674 HTTP/1.1" 200 235
2024-06-11 17:37:54:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 17:37:55:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 17:37:55:INFO:test samples: (686,)
2024-06-11 17:37:55:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 17:37:56:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718098676 HTTP/1.1" 200 235
2024-06-11 17:37:56:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 17:37:56:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 17:37:57:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 17:37:57:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718098677 HTTP/1.1" 200 235
2024-06-11 17:37:57:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 17:37:58:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 17:37:58:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-11 17:37:58:WARNING:Try importing flash-attention for faster inference...
2024-06-11 17:37:58:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-11 17:37:58:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-11 17:37:58:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-11 17:37:59:INFO:trainable params: 1310284 || all params: 1838138956 || trainable%: 0.07128318540461856
2024-06-11 17:37:59:INFO:Init labels...
2024-06-11 17:37:59:INFO:Start training...
2024-06-11 17:38:13:INFO:TRAIN-(cmcm) (1/1/5)>> loss: 1.9498
2024-06-11 17:38:16:INFO:VAL-(cmcm) >>
2024-06-11 17:38:16:INFO:M: >>  Has0_acc_2: 0.4454  Has0_F1_score: 0.3515  Non0_acc_2: 0.4630  Non0_F1_score: 0.3660  Mult_acc_5: 0.2096  Mult_acc_7: 0.2096  MAE: 1.5427  Corr: -0.0046 
2024-06-11 17:38:16:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-11 17:38:31:INFO:TRAIN-(cmcm) (1/2/5)>> loss: 0.9026
2024-06-11 17:38:34:INFO:VAL-(cmcm) >>
2024-06-11 17:38:34:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.5437  Non0_acc_2: 0.5556  Non0_F1_score: 0.5297  Mult_acc_5: 0.2052  Mult_acc_7: 0.2052  MAE: 1.5322  Corr: 0.0276 
2024-06-11 17:38:34:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-11 17:38:49:INFO:TRAIN-(cmcm) (1/3/5)>> loss: 0.8874
2024-06-11 17:38:52:INFO:VAL-(cmcm) >>
2024-06-11 17:38:52:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4676  Non0_acc_2: 0.5694  Non0_F1_score: 0.4396  Mult_acc_5: 0.3100  Mult_acc_7: 0.2271  MAE: 1.7468  Corr: -0.0004 
2024-06-11 17:39:07:INFO:TRAIN-(cmcm) (2/4/5)>> loss: 0.8758
2024-06-11 17:39:09:INFO:VAL-(cmcm) >>
2024-06-11 17:39:09:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5231  Non0_F1_score: 0.5117  Mult_acc_5: 0.1921  Mult_acc_7: 0.1921  MAE: 1.4139  Corr: 0.1003 
2024-06-11 17:39:10:INFO:Saving checkpoint at epoch 4 to results/models/cmcm-mosi-regression.pth.
2024-06-11 17:39:25:INFO:TRAIN-(cmcm) (1/5/5)>> loss: 0.8671
2024-06-11 17:39:27:INFO:VAL-(cmcm) >>
2024-06-11 17:39:27:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4767  Non0_acc_2: 0.5741  Non0_F1_score: 0.4491  Mult_acc_5: 0.1878  Mult_acc_7: 0.1878  MAE: 1.4868  Corr: 0.0175 
2024-06-11 17:39:42:INFO:TRAIN-(cmcm) (2/6/5)>> loss: 0.8583
2024-06-11 17:39:45:INFO:VAL-(cmcm) >>
2024-06-11 17:39:45:INFO:M: >>  Has0_acc_2: 0.6550  Has0_F1_score: 0.6559  Non0_acc_2: 0.6713  Non0_F1_score: 0.6700  Mult_acc_5: 0.3231  Mult_acc_7: 0.2358  MAE: 1.4612  Corr: 0.3185 
2024-06-11 17:40:00:INFO:TRAIN-(cmcm) (3/7/5)>> loss: 0.8506
2024-06-11 17:40:02:INFO:VAL-(cmcm) >>
2024-06-11 17:40:02:INFO:M: >>  Has0_acc_2: 0.7031  Has0_F1_score: 0.6807  Non0_acc_2: 0.6991  Non0_F1_score: 0.6773  Mult_acc_5: 0.2795  Mult_acc_7: 0.2620  MAE: 1.2031  Corr: 0.4752 
2024-06-11 17:40:03:INFO:Saving checkpoint at epoch 7 to results/models/cmcm-mosi-regression.pth.
2024-06-11 17:40:18:INFO:TRAIN-(cmcm) (1/8/5)>> loss: 0.8152
2024-06-11 17:40:20:INFO:VAL-(cmcm) >>
2024-06-11 17:40:20:INFO:M: >>  Has0_acc_2: 0.6725  Has0_F1_score: 0.6654  Non0_acc_2: 0.7037  Non0_F1_score: 0.6970  Mult_acc_5: 0.3493  Mult_acc_7: 0.2620  MAE: 1.3883  Corr: 0.4742 
2024-06-11 17:40:35:INFO:TRAIN-(cmcm) (2/9/5)>> loss: 0.7982
2024-06-11 17:40:37:INFO:VAL-(cmcm) >>
2024-06-11 17:40:37:INFO:M: >>  Has0_acc_2: 0.7205  Has0_F1_score: 0.7181  Non0_acc_2: 0.7083  Non0_F1_score: 0.7072  Mult_acc_5: 0.3188  Mult_acc_7: 0.2795  MAE: 1.1798  Corr: 0.5042 
2024-06-11 17:40:38:INFO:Saving checkpoint at epoch 9 to results/models/cmcm-mosi-regression.pth.
2024-06-11 17:40:53:INFO:TRAIN-(cmcm) (1/10/5)>> loss: 0.7813
2024-06-11 17:40:56:INFO:VAL-(cmcm) >>
2024-06-11 17:40:56:INFO:M: >>  Has0_acc_2: 0.7336  Has0_F1_score: 0.7303  Non0_acc_2: 0.7407  Non0_F1_score: 0.7363  Mult_acc_5: 0.3450  Mult_acc_7: 0.2576  MAE: 1.1892  Corr: 0.5148 
2024-06-11 17:41:10:INFO:TRAIN-(cmcm) (2/11/5)>> loss: 0.7837
2024-06-11 17:41:13:INFO:VAL-(cmcm) >>
2024-06-11 17:41:13:INFO:M: >>  Has0_acc_2: 0.7118  Has0_F1_score: 0.7104  Non0_acc_2: 0.7361  Non0_F1_score: 0.7340  Mult_acc_5: 0.2533  Mult_acc_7: 0.2183  MAE: 1.2542  Corr: 0.5221 
2024-06-11 17:41:28:INFO:TRAIN-(cmcm) (3/12/5)>> loss: 0.7692
2024-06-11 17:41:30:INFO:VAL-(cmcm) >>
2024-06-11 17:41:30:INFO:M: >>  Has0_acc_2: 0.7555  Has0_F1_score: 0.7578  Non0_acc_2: 0.7731  Non0_F1_score: 0.7744  Mult_acc_5: 0.3843  Mult_acc_7: 0.3144  MAE: 1.0420  Corr: 0.6064 
2024-06-11 17:41:31:INFO:Saving checkpoint at epoch 12 to results/models/cmcm-mosi-regression.pth.
2024-06-11 17:41:46:INFO:TRAIN-(cmcm) (1/13/5)>> loss: 0.7594
2024-06-11 17:41:48:INFO:VAL-(cmcm) >>
2024-06-11 17:41:48:INFO:M: >>  Has0_acc_2: 0.7205  Has0_F1_score: 0.7232  Non0_acc_2: 0.7454  Non0_F1_score: 0.7468  Mult_acc_5: 0.3930  Mult_acc_7: 0.3013  MAE: 1.1573  Corr: 0.5666 
2024-06-11 17:42:03:INFO:TRAIN-(cmcm) (2/14/5)>> loss: 0.7515
2024-06-11 17:42:05:INFO:VAL-(cmcm) >>
2024-06-11 17:42:05:INFO:M: >>  Has0_acc_2: 0.7249  Has0_F1_score: 0.7273  Non0_acc_2: 0.6991  Non0_F1_score: 0.6979  Mult_acc_5: 0.3493  Mult_acc_7: 0.2533  MAE: 1.2228  Corr: 0.5491 
2024-06-11 17:42:20:INFO:TRAIN-(cmcm) (3/15/5)>> loss: 0.7369
2024-06-11 17:42:23:INFO:VAL-(cmcm) >>
2024-06-11 17:42:23:INFO:M: >>  Has0_acc_2: 0.7293  Has0_F1_score: 0.7199  Non0_acc_2: 0.7222  Non0_F1_score: 0.7218  Mult_acc_5: 0.3799  Mult_acc_7: 0.3100  MAE: 1.1244  Corr: 0.5391 
2024-06-11 17:42:37:INFO:TRAIN-(cmcm) (4/16/5)>> loss: 0.7269
2024-06-11 17:42:40:INFO:VAL-(cmcm) >>
2024-06-11 17:42:40:INFO:M: >>  Has0_acc_2: 0.7642  Has0_F1_score: 0.7616  Non0_acc_2: 0.7731  Non0_F1_score: 0.7702  Mult_acc_5: 0.4279  Mult_acc_7: 0.3275  MAE: 1.0394  Corr: 0.6232 
2024-06-11 17:42:40:INFO:Saving checkpoint at epoch 16 to results/models/cmcm-mosi-regression.pth.
2024-06-11 17:42:55:INFO:TRAIN-(cmcm) (1/17/5)>> loss: 0.7092
2024-06-11 17:42:58:INFO:VAL-(cmcm) >>
2024-06-11 17:42:58:INFO:M: >>  Has0_acc_2: 0.7642  Has0_F1_score: 0.7665  Non0_acc_2: 0.7454  Non0_F1_score: 0.7455  Mult_acc_5: 0.3974  Mult_acc_7: 0.3144  MAE: 1.0161  Corr: 0.6479 
2024-06-11 17:42:58:INFO:Saving checkpoint at epoch 17 to results/models/cmcm-mosi-regression.pth.
2024-06-11 17:43:13:INFO:TRAIN-(cmcm) (1/18/5)>> loss: 0.7170
2024-06-11 17:43:16:INFO:VAL-(cmcm) >>
2024-06-11 17:43:16:INFO:M: >>  Has0_acc_2: 0.7424  Has0_F1_score: 0.7444  Non0_acc_2: 0.7685  Non0_F1_score: 0.7693  Mult_acc_5: 0.4148  Mult_acc_7: 0.3144  MAE: 1.1023  Corr: 0.6095 
2024-06-11 17:43:31:INFO:TRAIN-(cmcm) (2/19/5)>> loss: 0.7050
2024-06-11 17:43:33:INFO:VAL-(cmcm) >>
2024-06-11 17:43:33:INFO:M: >>  Has0_acc_2: 0.7424  Has0_F1_score: 0.7391  Non0_acc_2: 0.7222  Non0_F1_score: 0.7234  Mult_acc_5: 0.3974  Mult_acc_7: 0.3057  MAE: 1.0860  Corr: 0.5916 
2024-06-11 17:43:48:INFO:TRAIN-(cmcm) (3/20/5)>> loss: 0.7031
2024-06-11 17:43:50:INFO:VAL-(cmcm) >>
2024-06-11 17:43:50:INFO:M: >>  Has0_acc_2: 0.7249  Has0_F1_score: 0.7207  Non0_acc_2: 0.7361  Non0_F1_score: 0.7327  Mult_acc_5: 0.4192  Mult_acc_7: 0.3100  MAE: 1.1101  Corr: 0.5869 
2024-06-11 17:44:05:INFO:TRAIN-(cmcm) (4/21/5)>> loss: 0.6976
2024-06-11 17:44:07:INFO:VAL-(cmcm) >>
2024-06-11 17:44:07:INFO:M: >>  Has0_acc_2: 0.7467  Has0_F1_score: 0.7485  Non0_acc_2: 0.7685  Non0_F1_score: 0.7688  Mult_acc_5: 0.4236  Mult_acc_7: 0.3144  MAE: 1.0547  Corr: 0.6390 
2024-06-11 17:44:22:INFO:TRAIN-(cmcm) (5/22/5)>> loss: 0.6944
2024-06-11 17:44:25:INFO:VAL-(cmcm) >>
2024-06-11 17:44:25:INFO:M: >>  Has0_acc_2: 0.7467  Has0_F1_score: 0.7446  Non0_acc_2: 0.7315  Non0_F1_score: 0.7324  Mult_acc_5: 0.4236  Mult_acc_7: 0.3319  MAE: 1.0328  Corr: 0.6176 
2024-06-11 17:44:39:INFO:TRAIN-(cmcm) (6/23/5)>> loss: 0.6775
2024-06-11 17:44:42:INFO:VAL-(cmcm) >>
2024-06-11 17:44:42:INFO:M: >>  Has0_acc_2: 0.7467  Has0_F1_score: 0.7439  Non0_acc_2: 0.7500  Non0_F1_score: 0.7510  Mult_acc_5: 0.3974  Mult_acc_7: 0.3188  MAE: 1.0349  Corr: 0.6302 
2024-06-11 17:44:56:INFO:TRAIN-(cmcm) (7/24/5)>> loss: 0.6726
2024-06-11 17:44:59:INFO:VAL-(cmcm) >>
2024-06-11 17:44:59:INFO:M: >>  Has0_acc_2: 0.7205  Has0_F1_score: 0.7216  Non0_acc_2: 0.6667  Non0_F1_score: 0.6592  Mult_acc_5: 0.3668  Mult_acc_7: 0.2838  MAE: 1.1493  Corr: 0.5675 
2024-06-11 17:45:13:INFO:TRAIN-(cmcm) (8/25/5)>> loss: 0.6710
2024-06-11 17:45:16:INFO:VAL-(cmcm) >>
2024-06-11 17:45:16:INFO:M: >>  Has0_acc_2: 0.7555  Has0_F1_score: 0.7534  Non0_acc_2: 0.7454  Non0_F1_score: 0.7448  Mult_acc_5: 0.3974  Mult_acc_7: 0.2838  MAE: 1.0870  Corr: 0.6189 
2024-06-11 17:45:31:INFO:TRAIN-(cmcm) (9/26/5)>> loss: 0.6574
2024-06-11 17:45:33:INFO:VAL-(cmcm) >>
2024-06-11 17:45:33:INFO:M: >>  Has0_acc_2: 0.7424  Has0_F1_score: 0.7448  Non0_acc_2: 0.7407  Non0_F1_score: 0.7420  Mult_acc_5: 0.3581  Mult_acc_7: 0.2707  MAE: 1.0625  Corr: 0.6161 
2024-06-11 17:45:48:INFO:TRAIN-(cmcm) (10/27/5)>> loss: 0.6441
2024-06-11 17:45:50:INFO:VAL-(cmcm) >>
2024-06-11 17:45:50:INFO:M: >>  Has0_acc_2: 0.7424  Has0_F1_score: 0.7437  Non0_acc_2: 0.7407  Non0_F1_score: 0.7411  Mult_acc_5: 0.3886  Mult_acc_7: 0.3013  MAE: 1.0632  Corr: 0.6016 
2024-06-11 17:45:58:INFO:TEST-(cmcm) >>
2024-06-11 17:45:58:INFO:M: >>  Has0_acc_2: 0.7449  Has0_F1_score: 0.7431  Non0_acc_2: 0.7744  Non0_F1_score: 0.7664  Mult_acc_5: 0.3542  Mult_acc_7: 0.3061  MAE: 1.0204  Corr: 0.5945 
2024-06-11 17:45:58:INFO:Results are added to results/results/mosi-regression-50.csv...
2024-06-11 17:45:58:INFO:Start running cmcm...
2024-06-11 17:45:58:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 60, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-06-11 17:45:58:INFO:Let's use the GPU 1 !
2024-06-11 17:45:58:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 17:45:58:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718099159 HTTP/1.1" 200 235
2024-06-11 17:45:59:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 17:45:59:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 17:46:00:INFO:train samples: (1284,)
2024-06-11 17:46:00:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 17:46:00:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718099160 HTTP/1.1" 200 235
2024-06-11 17:46:00:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 17:46:01:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 17:46:01:INFO:valid samples: (229,)
2024-06-11 17:46:01:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 17:46:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718099162 HTTP/1.1" 200 235
2024-06-11 17:46:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 17:46:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 17:46:03:INFO:test samples: (686,)
2024-06-11 17:46:03:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 17:46:03:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718099163 HTTP/1.1" 200 235
2024-06-11 17:46:03:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 17:46:04:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 17:46:04:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 17:46:04:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718099165 HTTP/1.1" 200 235
2024-06-11 17:46:04:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 17:46:05:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 17:46:05:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-11 17:46:05:WARNING:Try importing flash-attention for faster inference...
2024-06-11 17:46:05:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-11 17:46:05:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-11 17:46:05:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-11 17:46:06:INFO:trainable params: 1310284 || all params: 1838138956 || trainable%: 0.07128318540461856
2024-06-11 17:46:06:INFO:Init labels...
2024-06-11 17:46:06:INFO:Start training...
2024-06-11 17:46:21:INFO:TRAIN-(cmcm) (1/1/1)>> loss: 2.1130
2024-06-11 17:46:23:INFO:VAL-(cmcm) >>
2024-06-11 17:46:23:INFO:M: >>  Has0_acc_2: 0.6201  Has0_F1_score: 0.5398  Non0_acc_2: 0.6065  Non0_F1_score: 0.5218  Mult_acc_5: 0.2969  Mult_acc_7: 0.1310  MAE: 2.0468  Corr: 0.1144 
2024-06-11 17:46:24:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-11 17:46:39:INFO:TRAIN-(cmcm) (1/2/1)>> loss: 0.9441
2024-06-11 17:46:41:INFO:VAL-(cmcm) >>
2024-06-11 17:46:41:INFO:M: >>  Has0_acc_2: 0.4978  Has0_F1_score: 0.5001  Non0_acc_2: 0.5046  Non0_F1_score: 0.5050  Mult_acc_5: 0.2402  Mult_acc_7: 0.1834  MAE: 1.8643  Corr: 0.0287 
2024-06-11 17:46:42:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-11 17:46:57:INFO:TRAIN-(cmcm) (1/3/1)>> loss: 0.9430
2024-06-11 17:46:59:INFO:VAL-(cmcm) >>
2024-06-11 17:46:59:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4950  Non0_acc_2: 0.5926  Non0_F1_score: 0.4970  Mult_acc_5: 0.2576  Mult_acc_7: 0.2052  MAE: 1.5739  Corr: 0.0866 
2024-06-11 17:47:00:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-mosi-regression.pth.
2024-06-11 17:47:15:INFO:TRAIN-(cmcm) (1/4/1)>> loss: 0.8969
2024-06-11 17:47:17:INFO:VAL-(cmcm) >>
2024-06-11 17:47:17:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5261  Non0_acc_2: 0.5787  Non0_F1_score: 0.5074  Mult_acc_5: 0.2009  Mult_acc_7: 0.1747  MAE: 1.5625  Corr: 0.0699 
2024-06-11 17:47:18:INFO:Saving checkpoint at epoch 4 to results/models/cmcm-mosi-regression.pth.
2024-06-11 17:47:33:INFO:TRAIN-(cmcm) (1/5/1)>> loss: 0.8803
2024-06-11 17:47:35:INFO:VAL-(cmcm) >>
2024-06-11 17:47:35:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5561  Non0_acc_2: 0.5741  Non0_F1_score: 0.5392  Mult_acc_5: 0.2882  Mult_acc_7: 0.2140  MAE: 1.7490  Corr: 0.0709 
2024-06-11 17:47:50:INFO:TRAIN-(cmcm) (2/6/1)>> loss: 0.8940
2024-06-11 17:47:53:INFO:VAL-(cmcm) >>
2024-06-11 17:47:53:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.5040  Non0_acc_2: 0.5370  Non0_F1_score: 0.4860  Mult_acc_5: 0.2096  Mult_acc_7: 0.1834  MAE: 1.6499  Corr: -0.0058 
2024-06-11 17:48:07:INFO:TRAIN-(cmcm) (3/7/1)>> loss: 0.8771
2024-06-11 17:48:10:INFO:VAL-(cmcm) >>
2024-06-11 17:48:10:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5541  Non0_acc_2: 0.4259  Non0_F1_score: 0.3331  Mult_acc_5: 0.2314  Mult_acc_7: 0.2227  MAE: 1.5165  Corr: -0.0032 
2024-06-11 17:48:10:INFO:Saving checkpoint at epoch 7 to results/models/cmcm-mosi-regression.pth.
2024-06-11 17:48:25:INFO:TRAIN-(cmcm) (1/8/1)>> loss: 0.8688
2024-06-11 17:48:28:INFO:VAL-(cmcm) >>
2024-06-11 17:48:28:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5209  Non0_acc_2: 0.5648  Non0_F1_score: 0.5019  Mult_acc_5: 0.2576  Mult_acc_7: 0.1834  MAE: 1.6573  Corr: 0.0089 
2024-06-11 17:48:43:INFO:TRAIN-(cmcm) (2/9/1)>> loss: 0.8651
2024-06-11 17:48:45:INFO:VAL-(cmcm) >>
2024-06-11 17:48:45:INFO:M: >>  Has0_acc_2: 0.5546  Has0_F1_score: 0.5395  Non0_acc_2: 0.5602  Non0_F1_score: 0.5414  Mult_acc_5: 0.2664  Mult_acc_7: 0.1965  MAE: 1.7017  Corr: 0.2182 
2024-06-11 17:49:00:INFO:TRAIN-(cmcm) (3/10/1)>> loss: 0.8628
2024-06-11 17:49:02:INFO:VAL-(cmcm) >>
2024-06-11 17:49:02:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.6016  Non0_acc_2: 0.6019  Non0_F1_score: 0.5910  Mult_acc_5: 0.3057  Mult_acc_7: 0.2314  MAE: 1.5298  Corr: 0.1584 
2024-06-11 17:49:17:INFO:TRAIN-(cmcm) (4/11/1)>> loss: 0.8561
2024-06-11 17:49:19:INFO:VAL-(cmcm) >>
2024-06-11 17:49:19:INFO:M: >>  Has0_acc_2: 0.6157  Has0_F1_score: 0.5707  Non0_acc_2: 0.4537  Non0_F1_score: 0.3496  Mult_acc_5: 0.2314  Mult_acc_7: 0.2271  MAE: 1.4646  Corr: 0.1293 
2024-06-11 17:49:20:INFO:Saving checkpoint at epoch 11 to results/models/cmcm-mosi-regression.pth.
2024-06-11 17:49:35:INFO:TRAIN-(cmcm) (1/12/1)>> loss: 0.8546
2024-06-11 17:49:37:INFO:VAL-(cmcm) >>
2024-06-11 17:49:37:INFO:M: >>  Has0_acc_2: 0.6594  Has0_F1_score: 0.6294  Non0_acc_2: 0.6389  Non0_F1_score: 0.6116  Mult_acc_5: 0.3231  Mult_acc_7: 0.2402  MAE: 1.5625  Corr: 0.2030 
2024-06-11 17:49:52:INFO:TRAIN-(cmcm) (2/13/1)>> loss: 0.8409
2024-06-11 17:49:55:INFO:VAL-(cmcm) >>
2024-06-11 17:49:55:INFO:M: >>  Has0_acc_2: 0.6638  Has0_F1_score: 0.6613  Non0_acc_2: 0.6574  Non0_F1_score: 0.6550  Mult_acc_5: 0.2969  Mult_acc_7: 0.2402  MAE: 1.3686  Corr: 0.2997 
2024-06-11 17:49:55:INFO:Saving checkpoint at epoch 13 to results/models/cmcm-mosi-regression.pth.
2024-06-11 17:50:10:INFO:TRAIN-(cmcm) (1/14/1)>> loss: 0.8407
2024-06-11 17:50:13:INFO:VAL-(cmcm) >>
2024-06-11 17:50:13:INFO:M: >>  Has0_acc_2: 0.6376  Has0_F1_score: 0.6340  Non0_acc_2: 0.6343  Non0_F1_score: 0.6304  Mult_acc_5: 0.3057  Mult_acc_7: 0.2052  MAE: 1.5228  Corr: 0.2561 
2024-06-11 17:50:27:INFO:TRAIN-(cmcm) (2/15/1)>> loss: 0.8192
2024-06-11 17:50:30:INFO:VAL-(cmcm) >>
2024-06-11 17:50:30:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4556  Non0_acc_2: 0.5741  Non0_F1_score: 0.4269  Mult_acc_5: 0.3231  Mult_acc_7: 0.2358  MAE: 1.6193  Corr: 0.1752 
2024-06-11 17:50:45:INFO:TRAIN-(cmcm) (3/16/1)>> loss: 0.8139
2024-06-11 17:50:47:INFO:VAL-(cmcm) >>
2024-06-11 17:50:47:INFO:M: >>  Has0_acc_2: 0.7293  Has0_F1_score: 0.7282  Non0_acc_2: 0.7222  Non0_F1_score: 0.7213  Mult_acc_5: 0.3930  Mult_acc_7: 0.2838  MAE: 1.3180  Corr: 0.4401 
2024-06-11 17:50:48:INFO:Saving checkpoint at epoch 16 to results/models/cmcm-mosi-regression.pth.
2024-06-11 17:51:03:INFO:TRAIN-(cmcm) (1/17/1)>> loss: 0.7999
2024-06-11 17:51:05:INFO:VAL-(cmcm) >>
2024-06-11 17:51:05:INFO:M: >>  Has0_acc_2: 0.7162  Has0_F1_score: 0.7100  Non0_acc_2: 0.6481  Non0_F1_score: 0.6501  Mult_acc_5: 0.3319  Mult_acc_7: 0.2576  MAE: 1.2595  Corr: 0.4334 
2024-06-11 17:51:06:INFO:Saving checkpoint at epoch 17 to results/models/cmcm-mosi-regression.pth.
2024-06-11 17:51:21:INFO:TRAIN-(cmcm) (1/18/1)>> loss: 0.7848
2024-06-11 17:51:23:INFO:VAL-(cmcm) >>
2024-06-11 17:51:23:INFO:M: >>  Has0_acc_2: 0.6987  Has0_F1_score: 0.7010  Non0_acc_2: 0.7083  Non0_F1_score: 0.7092  Mult_acc_5: 0.3886  Mult_acc_7: 0.3013  MAE: 1.3075  Corr: 0.4646 
2024-06-11 17:51:38:INFO:TRAIN-(cmcm) (2/19/1)>> loss: 0.7765
2024-06-11 17:51:41:INFO:VAL-(cmcm) >>
2024-06-11 17:51:41:INFO:M: >>  Has0_acc_2: 0.6769  Has0_F1_score: 0.6277  Non0_acc_2: 0.6713  Non0_F1_score: 0.6618  Mult_acc_5: 0.3537  Mult_acc_7: 0.2620  MAE: 1.3123  Corr: 0.4226 
2024-06-11 17:51:55:INFO:TRAIN-(cmcm) (3/20/1)>> loss: 0.7706
2024-06-11 17:51:58:INFO:VAL-(cmcm) >>
2024-06-11 17:51:58:INFO:M: >>  Has0_acc_2: 0.6943  Has0_F1_score: 0.6962  Non0_acc_2: 0.6852  Non0_F1_score: 0.6836  Mult_acc_5: 0.3537  Mult_acc_7: 0.2707  MAE: 1.2499  Corr: 0.4707 
2024-06-11 17:51:59:INFO:Saving checkpoint at epoch 20 to results/models/cmcm-mosi-regression.pth.
2024-06-11 17:52:14:INFO:TRAIN-(cmcm) (1/21/1)>> loss: 0.7448
2024-06-11 17:52:16:INFO:VAL-(cmcm) >>
2024-06-11 17:52:16:INFO:M: >>  Has0_acc_2: 0.7162  Has0_F1_score: 0.7178  Non0_acc_2: 0.6296  Non0_F1_score: 0.6146  Mult_acc_5: 0.3537  Mult_acc_7: 0.2576  MAE: 1.2398  Corr: 0.5038 
2024-06-11 17:52:17:INFO:Saving checkpoint at epoch 21 to results/models/cmcm-mosi-regression.pth.
2024-06-11 17:52:32:INFO:TRAIN-(cmcm) (1/22/1)>> loss: 0.7411
2024-06-11 17:52:34:INFO:VAL-(cmcm) >>
2024-06-11 17:52:34:INFO:M: >>  Has0_acc_2: 0.6638  Has0_F1_score: 0.6173  Non0_acc_2: 0.6713  Non0_F1_score: 0.6363  Mult_acc_5: 0.3188  Mult_acc_7: 0.2576  MAE: 1.3512  Corr: 0.3772 
2024-06-11 17:52:49:INFO:TRAIN-(cmcm) (2/23/1)>> loss: 0.7434
2024-06-11 17:52:51:INFO:VAL-(cmcm) >>
2024-06-11 17:52:51:INFO:M: >>  Has0_acc_2: 0.7729  Has0_F1_score: 0.7668  Non0_acc_2: 0.7361  Non0_F1_score: 0.7350  Mult_acc_5: 0.4192  Mult_acc_7: 0.3144  MAE: 1.0734  Corr: 0.5802 
2024-06-11 17:52:52:INFO:Saving checkpoint at epoch 23 to results/models/cmcm-mosi-regression.pth.
2024-06-11 17:53:07:INFO:TRAIN-(cmcm) (1/24/1)>> loss: 0.7243
2024-06-11 17:53:09:INFO:VAL-(cmcm) >>
2024-06-11 17:53:09:INFO:M: >>  Has0_acc_2: 0.7293  Has0_F1_score: 0.7317  Non0_acc_2: 0.6852  Non0_F1_score: 0.6847  Mult_acc_5: 0.4017  Mult_acc_7: 0.2882  MAE: 1.1271  Corr: 0.5747 
2024-06-11 17:53:24:INFO:TRAIN-(cmcm) (2/25/1)>> loss: 0.7173
2024-06-11 17:53:26:INFO:VAL-(cmcm) >>
2024-06-11 17:53:27:INFO:M: >>  Has0_acc_2: 0.7511  Has0_F1_score: 0.7465  Non0_acc_2: 0.7454  Non0_F1_score: 0.7433  Mult_acc_5: 0.3843  Mult_acc_7: 0.2882  MAE: 1.1189  Corr: 0.5727 
2024-06-11 17:53:41:INFO:TRAIN-(cmcm) (3/26/1)>> loss: 0.7001
2024-06-11 17:53:44:INFO:VAL-(cmcm) >>
2024-06-11 17:53:44:INFO:M: >>  Has0_acc_2: 0.7642  Has0_F1_score: 0.7646  Non0_acc_2: 0.7315  Non0_F1_score: 0.7329  Mult_acc_5: 0.3974  Mult_acc_7: 0.3362  MAE: 1.0982  Corr: 0.5323 
2024-06-11 17:53:58:INFO:TRAIN-(cmcm) (4/27/1)>> loss: 0.7024
2024-06-11 17:54:01:INFO:VAL-(cmcm) >>
2024-06-11 17:54:01:INFO:M: >>  Has0_acc_2: 0.7511  Has0_F1_score: 0.7498  Non0_acc_2: 0.7778  Non0_F1_score: 0.7778  Mult_acc_5: 0.3930  Mult_acc_7: 0.2664  MAE: 1.1545  Corr: 0.5640 
2024-06-11 17:54:16:INFO:TRAIN-(cmcm) (5/28/1)>> loss: 0.6854
2024-06-11 17:54:18:INFO:VAL-(cmcm) >>
2024-06-11 17:54:18:INFO:M: >>  Has0_acc_2: 0.7642  Has0_F1_score: 0.7587  Non0_acc_2: 0.7778  Non0_F1_score: 0.7739  Mult_acc_5: 0.3755  Mult_acc_7: 0.2838  MAE: 1.0708  Corr: 0.5841 
2024-06-11 17:54:19:INFO:Saving checkpoint at epoch 28 to results/models/cmcm-mosi-regression.pth.
2024-06-11 17:54:34:INFO:TRAIN-(cmcm) (1/29/1)>> loss: 0.6696
2024-06-11 17:54:36:INFO:VAL-(cmcm) >>
2024-06-11 17:54:36:INFO:M: >>  Has0_acc_2: 0.7642  Has0_F1_score: 0.7616  Non0_acc_2: 0.7176  Non0_F1_score: 0.7191  Mult_acc_5: 0.3843  Mult_acc_7: 0.3319  MAE: 1.0664  Corr: 0.5712 
2024-06-11 17:54:37:INFO:Saving checkpoint at epoch 29 to results/models/cmcm-mosi-regression.pth.
2024-06-11 17:54:52:INFO:TRAIN-(cmcm) (1/30/1)>> loss: 0.6749
2024-06-11 17:54:54:INFO:VAL-(cmcm) >>
2024-06-11 17:54:54:INFO:M: >>  Has0_acc_2: 0.7686  Has0_F1_score: 0.7580  Non0_acc_2: 0.7222  Non0_F1_score: 0.7189  Mult_acc_5: 0.3974  Mult_acc_7: 0.3362  MAE: 1.0951  Corr: 0.5210 
2024-06-11 17:55:09:INFO:TRAIN-(cmcm) (2/31/1)>> loss: 0.6593
2024-06-11 17:55:11:INFO:VAL-(cmcm) >>
2024-06-11 17:55:11:INFO:M: >>  Has0_acc_2: 0.7642  Has0_F1_score: 0.7569  Non0_acc_2: 0.7083  Non0_F1_score: 0.7094  Mult_acc_5: 0.3668  Mult_acc_7: 0.3188  MAE: 1.1484  Corr: 0.5093 
2024-06-11 17:55:26:INFO:TRAIN-(cmcm) (3/32/1)>> loss: 0.6551
2024-06-11 17:55:28:INFO:VAL-(cmcm) >>
2024-06-11 17:55:28:INFO:M: >>  Has0_acc_2: 0.7467  Has0_F1_score: 0.7475  Non0_acc_2: 0.7500  Non0_F1_score: 0.7503  Mult_acc_5: 0.4148  Mult_acc_7: 0.3100  MAE: 1.1215  Corr: 0.5648 
2024-06-11 17:55:43:INFO:TRAIN-(cmcm) (4/33/1)>> loss: 0.6451
2024-06-11 17:55:46:INFO:VAL-(cmcm) >>
2024-06-11 17:55:46:INFO:M: >>  Has0_acc_2: 0.7511  Has0_F1_score: 0.7448  Non0_acc_2: 0.7407  Non0_F1_score: 0.7355  Mult_acc_5: 0.3799  Mult_acc_7: 0.2795  MAE: 1.1366  Corr: 0.5231 
2024-06-11 17:56:00:INFO:TRAIN-(cmcm) (5/34/1)>> loss: 0.6429
2024-06-11 17:56:03:INFO:VAL-(cmcm) >>
2024-06-11 17:56:03:INFO:M: >>  Has0_acc_2: 0.7598  Has0_F1_score: 0.7591  Non0_acc_2: 0.7407  Non0_F1_score: 0.7411  Mult_acc_5: 0.3974  Mult_acc_7: 0.3100  MAE: 1.1453  Corr: 0.5446 
2024-06-11 17:56:17:INFO:TRAIN-(cmcm) (6/35/1)>> loss: 0.6133
2024-06-11 17:56:20:INFO:VAL-(cmcm) >>
2024-06-11 17:56:20:INFO:M: >>  Has0_acc_2: 0.7555  Has0_F1_score: 0.7545  Non0_acc_2: 0.7454  Non0_F1_score: 0.7452  Mult_acc_5: 0.3493  Mult_acc_7: 0.2926  MAE: 1.1302  Corr: 0.5132 
2024-06-11 17:56:34:INFO:TRAIN-(cmcm) (7/36/1)>> loss: 0.6149
2024-06-11 17:56:37:INFO:VAL-(cmcm) >>
2024-06-11 17:56:37:INFO:M: >>  Has0_acc_2: 0.7424  Has0_F1_score: 0.7437  Non0_acc_2: 0.7454  Non0_F1_score: 0.7463  Mult_acc_5: 0.4323  Mult_acc_7: 0.3275  MAE: 1.0983  Corr: 0.5566 
2024-06-11 17:56:52:INFO:TRAIN-(cmcm) (8/37/1)>> loss: 0.5920
2024-06-11 17:56:54:INFO:VAL-(cmcm) >>
2024-06-11 17:56:54:INFO:M: >>  Has0_acc_2: 0.7555  Has0_F1_score: 0.7555  Non0_acc_2: 0.7546  Non0_F1_score: 0.7545  Mult_acc_5: 0.4148  Mult_acc_7: 0.3275  MAE: 1.1349  Corr: 0.5610 
2024-06-11 17:57:09:INFO:TRAIN-(cmcm) (9/38/1)>> loss: 0.5736
2024-06-11 17:57:11:INFO:VAL-(cmcm) >>
2024-06-11 17:57:11:INFO:M: >>  Has0_acc_2: 0.7424  Has0_F1_score: 0.7267  Non0_acc_2: 0.7407  Non0_F1_score: 0.7327  Mult_acc_5: 0.3886  Mult_acc_7: 0.3144  MAE: 1.1497  Corr: 0.5054 
2024-06-11 17:57:26:INFO:TRAIN-(cmcm) (10/39/1)>> loss: 0.5597
2024-06-11 17:57:28:INFO:VAL-(cmcm) >>
2024-06-11 17:57:28:INFO:M: >>  Has0_acc_2: 0.7511  Has0_F1_score: 0.7521  Non0_acc_2: 0.7176  Non0_F1_score: 0.7191  Mult_acc_5: 0.3799  Mult_acc_7: 0.3013  MAE: 1.1389  Corr: 0.5213 
2024-06-11 17:57:36:INFO:TEST-(cmcm) >>
2024-06-11 17:57:36:INFO:M: >>  Has0_acc_2: 0.6808  Has0_F1_score: 0.6816  Non0_acc_2: 0.7012  Non0_F1_score: 0.7008  Mult_acc_5: 0.3338  Mult_acc_7: 0.3003  MAE: 1.1865  Corr: 0.4621 
2024-06-11 17:57:36:INFO:Results are added to results/results/mosi-regression-60.csv...
2024-06-11 17:57:36:INFO:Start running cmcm...
2024-06-11 17:57:36:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 60, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 2222}>
2024-06-11 17:57:36:INFO:Let's use the GPU 1 !
2024-06-11 17:57:36:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 17:57:37:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718099857 HTTP/1.1" 200 235
2024-06-11 17:57:37:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 17:57:37:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 17:57:38:INFO:train samples: (1284,)
2024-06-11 17:57:38:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 17:57:39:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718099859 HTTP/1.1" 200 235
2024-06-11 17:57:39:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 17:57:39:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 17:57:40:INFO:valid samples: (229,)
2024-06-11 17:57:40:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 17:57:40:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718099860 HTTP/1.1" 200 235
2024-06-11 17:57:40:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 17:57:41:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 17:57:41:INFO:test samples: (686,)
2024-06-11 17:57:41:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 17:57:42:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718099862 HTTP/1.1" 200 235
2024-06-11 17:57:42:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 17:57:42:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 17:57:43:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 17:57:43:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718099863 HTTP/1.1" 200 235
2024-06-11 17:57:43:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 17:57:44:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 17:57:44:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-11 17:57:44:WARNING:Try importing flash-attention for faster inference...
2024-06-11 17:57:44:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-11 17:57:44:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-11 17:57:44:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-11 17:57:45:INFO:trainable params: 1310284 || all params: 1838138956 || trainable%: 0.07128318540461856
2024-06-11 17:57:45:INFO:Init labels...
2024-06-11 17:57:45:INFO:Start training...
2024-06-11 17:57:59:INFO:TRAIN-(cmcm) (1/1/2)>> loss: 2.6457
2024-06-11 17:58:02:INFO:VAL-(cmcm) >>
2024-06-11 17:58:02:INFO:M: >>  Has0_acc_2: 0.5633  Has0_F1_score: 0.5086  Non0_acc_2: 0.4907  Non0_F1_score: 0.4793  Mult_acc_5: 0.2009  Mult_acc_7: 0.2009  MAE: 1.4528  Corr: -0.0135 
2024-06-11 17:58:03:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-11 17:58:18:INFO:TRAIN-(cmcm) (1/2/2)>> loss: 0.9868
2024-06-11 17:58:20:INFO:VAL-(cmcm) >>
2024-06-11 17:58:20:INFO:M: >>  Has0_acc_2: 0.5153  Has0_F1_score: 0.5178  Non0_acc_2: 0.5046  Non0_F1_score: 0.5056  Mult_acc_5: 0.1616  Mult_acc_7: 0.1572  MAE: 1.7529  Corr: -0.0290 
2024-06-11 17:58:35:INFO:TRAIN-(cmcm) (2/3/2)>> loss: 0.8922
2024-06-11 17:58:37:INFO:VAL-(cmcm) >>
2024-06-11 17:58:37:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5129  Non0_acc_2: 0.5648  Non0_F1_score: 0.4841  Mult_acc_5: 0.2969  Mult_acc_7: 0.2183  MAE: 1.7315  Corr: -0.0170 
2024-06-11 17:58:52:INFO:TRAIN-(cmcm) (3/4/2)>> loss: 0.8793
2024-06-11 17:58:54:INFO:VAL-(cmcm) >>
2024-06-11 17:58:54:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5252  Non0_acc_2: 0.5556  Non0_F1_score: 0.5065  Mult_acc_5: 0.1878  Mult_acc_7: 0.1703  MAE: 1.5619  Corr: 0.0255 
2024-06-11 17:59:09:INFO:TRAIN-(cmcm) (4/5/2)>> loss: 0.8716
2024-06-11 17:59:12:INFO:VAL-(cmcm) >>
2024-06-11 17:59:12:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.5434  Non0_acc_2: 0.4954  Non0_F1_score: 0.4976  Mult_acc_5: 0.2271  Mult_acc_7: 0.2271  MAE: 1.4777  Corr: -0.0024 
2024-06-11 17:59:26:INFO:TRAIN-(cmcm) (5/6/2)>> loss: 0.8657
2024-06-11 17:59:29:INFO:VAL-(cmcm) >>
2024-06-11 17:59:29:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.5116  Non0_acc_2: 0.5648  Non0_F1_score: 0.4888  Mult_acc_5: 0.1790  Mult_acc_7: 0.1703  MAE: 1.5322  Corr: -0.0274 
2024-06-11 17:59:44:INFO:TRAIN-(cmcm) (6/7/2)>> loss: 0.8657
2024-06-11 17:59:46:INFO:VAL-(cmcm) >>
2024-06-11 17:59:46:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4866  Non0_acc_2: 0.5741  Non0_F1_score: 0.5125  Mult_acc_5: 0.1747  Mult_acc_7: 0.1747  MAE: 1.4632  Corr: 0.0360 
2024-06-11 18:00:01:INFO:TRAIN-(cmcm) (7/8/2)>> loss: 0.8614
2024-06-11 18:00:03:INFO:VAL-(cmcm) >>
2024-06-11 18:00:03:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5923  Non0_acc_2: 0.5926  Non0_F1_score: 0.5936  Mult_acc_5: 0.2402  Mult_acc_7: 0.2140  MAE: 1.5052  Corr: 0.1375 
2024-06-11 18:00:18:INFO:TRAIN-(cmcm) (8/9/2)>> loss: 0.8551
2024-06-11 18:00:20:INFO:VAL-(cmcm) >>
2024-06-11 18:00:20:INFO:M: >>  Has0_acc_2: 0.5546  Has0_F1_score: 0.5281  Non0_acc_2: 0.5833  Non0_F1_score: 0.5588  Mult_acc_5: 0.2227  Mult_acc_7: 0.1659  MAE: 1.5533  Corr: 0.2950 
2024-06-11 18:00:35:INFO:TRAIN-(cmcm) (9/10/2)>> loss: 0.8473
2024-06-11 18:00:38:INFO:VAL-(cmcm) >>
2024-06-11 18:00:38:INFO:M: >>  Has0_acc_2: 0.6245  Has0_F1_score: 0.5381  Non0_acc_2: 0.5880  Non0_F1_score: 0.5728  Mult_acc_5: 0.2533  Mult_acc_7: 0.1834  MAE: 1.5411  Corr: 0.1158 
2024-06-11 18:00:52:INFO:TRAIN-(cmcm) (10/11/2)>> loss: 0.8357
2024-06-11 18:00:55:INFO:VAL-(cmcm) >>
2024-06-11 18:00:55:INFO:M: >>  Has0_acc_2: 0.6288  Has0_F1_score: 0.5923  Non0_acc_2: 0.6204  Non0_F1_score: 0.5814  Mult_acc_5: 0.3275  Mult_acc_7: 0.2445  MAE: 1.6529  Corr: 0.1635 
2024-06-11 18:01:02:INFO:TEST-(cmcm) >>
2024-06-11 18:01:02:INFO:M: >>  Has0_acc_2: 0.4913  Has0_F1_score: 0.4402  Non0_acc_2: 0.5122  Non0_F1_score: 0.4969  Mult_acc_5: 0.1531  Mult_acc_7: 0.1531  MAE: 1.4929  Corr: -0.0599 
2024-06-11 18:01:02:INFO:Results are added to results/results/mosi-regression-60.csv...
2024-06-11 18:01:02:INFO:Start running cmcm...
2024-06-11 18:01:02:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 60, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 3333}>
2024-06-11 18:01:02:INFO:Let's use the GPU 1 !
2024-06-11 18:01:02:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 18:01:03:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718100063 HTTP/1.1" 200 235
2024-06-11 18:01:03:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 18:01:03:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 18:01:04:INFO:train samples: (1284,)
2024-06-11 18:01:04:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 18:01:04:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718100065 HTTP/1.1" 200 235
2024-06-11 18:01:05:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 18:01:05:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 18:01:05:INFO:valid samples: (229,)
2024-06-11 18:01:06:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 18:01:06:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718100066 HTTP/1.1" 200 235
2024-06-11 18:01:06:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 18:01:06:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 18:01:07:INFO:test samples: (686,)
2024-06-11 18:01:07:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 18:01:07:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718100067 HTTP/1.1" 200 235
2024-06-11 18:01:07:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 18:01:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 18:01:08:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 18:01:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718100069 HTTP/1.1" 200 235
2024-06-11 18:01:09:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 18:01:09:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 18:01:09:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-11 18:01:09:WARNING:Try importing flash-attention for faster inference...
2024-06-11 18:01:09:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-11 18:01:09:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-11 18:01:09:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-11 18:01:10:INFO:trainable params: 1310284 || all params: 1838138956 || trainable%: 0.07128318540461856
2024-06-11 18:01:10:INFO:Init labels...
2024-06-11 18:01:10:INFO:Start training...
2024-06-11 18:01:25:INFO:TRAIN-(cmcm) (1/1/3)>> loss: 3.2701
2024-06-11 18:01:28:INFO:VAL-(cmcm) >>
2024-06-11 18:01:28:INFO:M: >>  Has0_acc_2: 0.5371  Has0_F1_score: 0.5382  Non0_acc_2: 0.5278  Non0_F1_score: 0.5235  Mult_acc_5: 0.2227  Mult_acc_7: 0.2096  MAE: 1.4777  Corr: 0.0097 
2024-06-11 18:01:28:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-11 18:01:43:INFO:TRAIN-(cmcm) (1/2/3)>> loss: 0.9839
2024-06-11 18:01:46:INFO:VAL-(cmcm) >>
2024-06-11 18:01:46:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.4924  Non0_acc_2: 0.5602  Non0_F1_score: 0.4656  Mult_acc_5: 0.1921  Mult_acc_7: 0.1921  MAE: 1.4659  Corr: -0.0395 
2024-06-11 18:01:46:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-11 18:02:01:INFO:TRAIN-(cmcm) (1/3/3)>> loss: 0.9028
2024-06-11 18:02:04:INFO:VAL-(cmcm) >>
2024-06-11 18:02:04:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5282  Non0_acc_2: 0.5648  Non0_F1_score: 0.5097  Mult_acc_5: 0.3013  Mult_acc_7: 0.2227  MAE: 1.7551  Corr: 0.0482 
2024-06-11 18:02:18:INFO:TRAIN-(cmcm) (2/4/3)>> loss: 0.8915
2024-06-11 18:02:21:INFO:VAL-(cmcm) >>
2024-06-11 18:02:21:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.5479  Non0_acc_2: 0.5509  Non0_F1_score: 0.5304  Mult_acc_5: 0.2358  Mult_acc_7: 0.2140  MAE: 1.6276  Corr: 0.0204 
2024-06-11 18:02:36:INFO:TRAIN-(cmcm) (3/5/3)>> loss: 0.8911
2024-06-11 18:02:38:INFO:VAL-(cmcm) >>
2024-06-11 18:02:38:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5509  Non0_F1_score: 0.5491  Mult_acc_5: 0.2183  Mult_acc_7: 0.2183  MAE: 1.4122  Corr: 0.0485 
2024-06-11 18:02:39:INFO:Saving checkpoint at epoch 5 to results/models/cmcm-mosi-regression.pth.
2024-06-11 18:02:54:INFO:TRAIN-(cmcm) (1/6/3)>> loss: 0.8787
2024-06-11 18:02:56:INFO:VAL-(cmcm) >>
2024-06-11 18:02:56:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4891  Non0_acc_2: 0.5741  Non0_F1_score: 0.4622  Mult_acc_5: 0.2445  Mult_acc_7: 0.1703  MAE: 1.6905  Corr: 0.0133 
2024-06-11 18:03:11:INFO:TRAIN-(cmcm) (2/7/3)>> loss: 0.8730
2024-06-11 18:03:13:INFO:VAL-(cmcm) >>
2024-06-11 18:03:13:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4855  Non0_acc_2: 0.5787  Non0_F1_score: 0.4584  Mult_acc_5: 0.1790  Mult_acc_7: 0.1790  MAE: 1.5095  Corr: 0.0105 
2024-06-11 18:03:28:INFO:TRAIN-(cmcm) (3/8/3)>> loss: 0.8621
2024-06-11 18:03:31:INFO:VAL-(cmcm) >>
2024-06-11 18:03:31:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.5500  Non0_acc_2: 0.5741  Non0_F1_score: 0.5364  Mult_acc_5: 0.2838  Mult_acc_7: 0.2140  MAE: 1.6280  Corr: 0.0667 
2024-06-11 18:03:45:INFO:TRAIN-(cmcm) (4/9/3)>> loss: 0.8580
2024-06-11 18:03:48:INFO:VAL-(cmcm) >>
2024-06-11 18:03:48:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.4897  Non0_acc_2: 0.5093  Non0_F1_score: 0.5118  Mult_acc_5: 0.2707  Mult_acc_7: 0.2227  MAE: 1.4966  Corr: 0.0358 
2024-06-11 18:04:02:INFO:TRAIN-(cmcm) (5/10/3)>> loss: 0.8530
2024-06-11 18:04:05:INFO:VAL-(cmcm) >>
2024-06-11 18:04:05:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.4769  Non0_acc_2: 0.5880  Non0_F1_score: 0.4494  Mult_acc_5: 0.2882  Mult_acc_7: 0.2140  MAE: 1.6031  Corr: 0.1031 
2024-06-11 18:04:20:INFO:TRAIN-(cmcm) (6/11/3)>> loss: 0.8521
2024-06-11 18:04:22:INFO:VAL-(cmcm) >>
2024-06-11 18:04:22:INFO:M: >>  Has0_acc_2: 0.6245  Has0_F1_score: 0.5559  Non0_acc_2: 0.6157  Non0_F1_score: 0.5777  Mult_acc_5: 0.2882  Mult_acc_7: 0.2140  MAE: 1.5795  Corr: 0.1155 
2024-06-11 18:04:37:INFO:TRAIN-(cmcm) (7/12/3)>> loss: 0.8535
2024-06-11 18:04:40:INFO:VAL-(cmcm) >>
2024-06-11 18:04:40:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.5680  Non0_acc_2: 0.5880  Non0_F1_score: 0.5556  Mult_acc_5: 0.2838  Mult_acc_7: 0.2052  MAE: 1.6437  Corr: 0.0798 
2024-06-11 18:04:54:INFO:TRAIN-(cmcm) (8/13/3)>> loss: 0.8438
2024-06-11 18:04:57:INFO:VAL-(cmcm) >>
2024-06-11 18:04:57:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.5194  Non0_acc_2: 0.5880  Non0_F1_score: 0.4940  Mult_acc_5: 0.2707  Mult_acc_7: 0.2052  MAE: 1.6481  Corr: 0.1513 
2024-06-11 18:05:11:INFO:TRAIN-(cmcm) (9/14/3)>> loss: 0.8423
2024-06-11 18:05:14:INFO:VAL-(cmcm) >>
2024-06-11 18:05:14:INFO:M: >>  Has0_acc_2: 0.6419  Has0_F1_score: 0.5908  Non0_acc_2: 0.6435  Non0_F1_score: 0.5903  Mult_acc_5: 0.3057  Mult_acc_7: 0.2227  MAE: 1.6162  Corr: 0.2156 
2024-06-11 18:05:29:INFO:TRAIN-(cmcm) (10/15/3)>> loss: 0.8389
2024-06-11 18:05:31:INFO:VAL-(cmcm) >>
2024-06-11 18:05:31:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.5472  Non0_acc_2: 0.5324  Non0_F1_score: 0.5189  Mult_acc_5: 0.2620  Mult_acc_7: 0.2140  MAE: 1.5298  Corr: 0.0990 
2024-06-11 18:05:39:INFO:TEST-(cmcm) >>
2024-06-11 18:05:39:INFO:M: >>  Has0_acc_2: 0.4475  Has0_F1_score: 0.2767  Non0_acc_2: 0.4619  Non0_F1_score: 0.4597  Mult_acc_5: 0.1560  Mult_acc_7: 0.1560  MAE: 1.5353  Corr: -0.0428 
2024-06-11 18:05:39:INFO:Results are added to results/results/mosi-regression-60.csv...
2024-06-11 18:05:39:INFO:Start running cmcm...
2024-06-11 18:05:39:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 60, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 4444}>
2024-06-11 18:05:39:INFO:Let's use the GPU 1 !
2024-06-11 18:05:39:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 18:05:39:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718100339 HTTP/1.1" 200 235
2024-06-11 18:05:39:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 18:05:40:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 18:05:41:INFO:train samples: (1284,)
2024-06-11 18:05:41:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 18:05:41:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718100341 HTTP/1.1" 200 235
2024-06-11 18:05:41:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 18:05:41:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 18:05:42:INFO:valid samples: (229,)
2024-06-11 18:05:42:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 18:05:42:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718100343 HTTP/1.1" 200 235
2024-06-11 18:05:43:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 18:05:43:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 18:05:44:INFO:test samples: (686,)
2024-06-11 18:05:44:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 18:05:44:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718100344 HTTP/1.1" 200 235
2024-06-11 18:05:44:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 18:05:44:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 18:05:45:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 18:05:45:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718100345 HTTP/1.1" 200 235
2024-06-11 18:05:45:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 18:05:46:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 18:05:46:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-11 18:05:46:WARNING:Try importing flash-attention for faster inference...
2024-06-11 18:05:46:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-11 18:05:46:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-11 18:05:46:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-11 18:05:47:INFO:trainable params: 1310284 || all params: 1838138956 || trainable%: 0.07128318540461856
2024-06-11 18:05:47:INFO:Init labels...
2024-06-11 18:05:47:INFO:Start training...
2024-06-11 18:06:02:INFO:TRAIN-(cmcm) (1/1/4)>> loss: 3.2438
2024-06-11 18:06:04:INFO:VAL-(cmcm) >>
2024-06-11 18:06:04:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.4769  Non0_acc_2: 0.5648  Non0_F1_score: 0.4627  Mult_acc_5: 0.1790  Mult_acc_7: 0.1790  MAE: 1.4733  Corr: 0.0075 
2024-06-11 18:06:05:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-11 18:06:20:INFO:TRAIN-(cmcm) (1/2/4)>> loss: 1.0706
2024-06-11 18:06:22:INFO:VAL-(cmcm) >>
2024-06-11 18:06:22:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.5292  Non0_acc_2: 0.5602  Non0_F1_score: 0.5532  Mult_acc_5: 0.1878  Mult_acc_7: 0.1878  MAE: 1.4536  Corr: 0.0166 
2024-06-11 18:06:23:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-11 18:06:38:INFO:TRAIN-(cmcm) (1/3/4)>> loss: 1.1024
2024-06-11 18:06:41:INFO:VAL-(cmcm) >>
2024-06-11 18:06:41:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.4815  Non0_acc_2: 0.5833  Non0_F1_score: 0.4676  Mult_acc_5: 0.1747  Mult_acc_7: 0.1747  MAE: 1.4676  Corr: 0.0052 
2024-06-11 18:06:55:INFO:TRAIN-(cmcm) (2/4/4)>> loss: 1.0081
2024-06-11 18:06:58:INFO:VAL-(cmcm) >>
2024-06-11 18:06:58:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.5153  Non0_acc_2: 0.5602  Non0_F1_score: 0.5099  Mult_acc_5: 0.1747  Mult_acc_7: 0.1747  MAE: 1.5039  Corr: 0.0400 
2024-06-11 18:07:13:INFO:TRAIN-(cmcm) (3/5/4)>> loss: 0.9530
2024-06-11 18:07:15:INFO:VAL-(cmcm) >>
2024-06-11 18:07:15:INFO:M: >>  Has0_acc_2: 0.5502  Has0_F1_score: 0.4796  Non0_acc_2: 0.5324  Non0_F1_score: 0.4580  Mult_acc_5: 0.2620  Mult_acc_7: 0.1834  MAE: 1.7354  Corr: -0.0446 
2024-06-11 18:07:30:INFO:TRAIN-(cmcm) (4/6/4)>> loss: 0.8998
2024-06-11 18:07:33:INFO:VAL-(cmcm) >>
2024-06-11 18:07:33:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4917  Non0_acc_2: 0.5787  Non0_F1_score: 0.4770  Mult_acc_5: 0.1747  Mult_acc_7: 0.1747  MAE: 1.5266  Corr: 0.0413 
2024-06-11 18:07:47:INFO:TRAIN-(cmcm) (5/7/4)>> loss: 0.8863
2024-06-11 18:07:50:INFO:VAL-(cmcm) >>
2024-06-11 18:07:50:INFO:M: >>  Has0_acc_2: 0.5546  Has0_F1_score: 0.5353  Non0_acc_2: 0.5463  Non0_F1_score: 0.5266  Mult_acc_5: 0.1834  Mult_acc_7: 0.1747  MAE: 1.6685  Corr: 0.0042 
2024-06-11 18:08:05:INFO:TRAIN-(cmcm) (6/8/4)>> loss: 0.8749
2024-06-11 18:08:07:INFO:VAL-(cmcm) >>
2024-06-11 18:08:07:INFO:M: >>  Has0_acc_2: 0.5459  Has0_F1_score: 0.5319  Non0_acc_2: 0.5370  Non0_F1_score: 0.5209  Mult_acc_5: 0.1834  Mult_acc_7: 0.1441  MAE: 1.8145  Corr: -0.0211 
2024-06-11 18:08:22:INFO:TRAIN-(cmcm) (7/9/4)>> loss: 0.8759
2024-06-11 18:08:24:INFO:VAL-(cmcm) >>
2024-06-11 18:08:24:INFO:M: >>  Has0_acc_2: 0.5633  Has0_F1_score: 0.4882  Non0_acc_2: 0.5509  Non0_F1_score: 0.4795  Mult_acc_5: 0.1921  Mult_acc_7: 0.1878  MAE: 1.6357  Corr: -0.0272 
2024-06-11 18:08:39:INFO:TRAIN-(cmcm) (8/10/4)>> loss: 0.8593
2024-06-11 18:08:42:INFO:VAL-(cmcm) >>
2024-06-11 18:08:42:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.5338  Non0_acc_2: 0.5509  Non0_F1_score: 0.5156  Mult_acc_5: 0.2751  Mult_acc_7: 0.2052  MAE: 1.7726  Corr: 0.0123 
2024-06-11 18:08:56:INFO:TRAIN-(cmcm) (9/11/4)>> loss: 0.8560
2024-06-11 18:08:59:INFO:VAL-(cmcm) >>
2024-06-11 18:08:59:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.5635  Non0_acc_2: 0.5880  Non0_F1_score: 0.5529  Mult_acc_5: 0.2795  Mult_acc_7: 0.2096  MAE: 1.5638  Corr: 0.1411 
2024-06-11 18:09:14:INFO:TRAIN-(cmcm) (10/12/4)>> loss: 0.8542
2024-06-11 18:09:16:INFO:VAL-(cmcm) >>
2024-06-11 18:09:16:INFO:M: >>  Has0_acc_2: 0.6638  Has0_F1_score: 0.6528  Non0_acc_2: 0.5880  Non0_F1_score: 0.5828  Mult_acc_5: 0.2795  Mult_acc_7: 0.2402  MAE: 1.3743  Corr: 0.2694 
2024-06-11 18:09:17:INFO:Saving checkpoint at epoch 12 to results/models/cmcm-mosi-regression.pth.
2024-06-11 18:09:32:INFO:TRAIN-(cmcm) (1/13/4)>> loss: 0.8495
2024-06-11 18:09:34:INFO:VAL-(cmcm) >>
2024-06-11 18:09:34:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4577  Non0_acc_2: 0.5741  Non0_F1_score: 0.4346  Mult_acc_5: 0.2882  Mult_acc_7: 0.2096  MAE: 1.7341  Corr: -0.0297 
2024-06-11 18:09:49:INFO:TRAIN-(cmcm) (2/14/4)>> loss: 0.8416
2024-06-11 18:09:51:INFO:VAL-(cmcm) >>
2024-06-11 18:09:51:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.4996  Non0_acc_2: 0.5556  Non0_F1_score: 0.4731  Mult_acc_5: 0.2009  Mult_acc_7: 0.1616  MAE: 1.6926  Corr: -0.0835 
2024-06-11 18:10:06:INFO:TRAIN-(cmcm) (3/15/4)>> loss: 0.8462
2024-06-11 18:10:09:INFO:VAL-(cmcm) >>
2024-06-11 18:10:09:INFO:M: >>  Has0_acc_2: 0.6245  Has0_F1_score: 0.6006  Non0_acc_2: 0.6157  Non0_F1_score: 0.5902  Mult_acc_5: 0.2751  Mult_acc_7: 0.2358  MAE: 1.5341  Corr: 0.0907 
2024-06-11 18:10:23:INFO:TRAIN-(cmcm) (4/16/4)>> loss: 0.8334
2024-06-11 18:10:26:INFO:VAL-(cmcm) >>
2024-06-11 18:10:26:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.4998  Non0_acc_2: 0.5926  Non0_F1_score: 0.5689  Mult_acc_5: 0.2620  Mult_acc_7: 0.2227  MAE: 1.6363  Corr: 0.0081 
2024-06-11 18:10:40:INFO:TRAIN-(cmcm) (5/17/4)>> loss: 0.8333
2024-06-11 18:10:43:INFO:VAL-(cmcm) >>
2024-06-11 18:10:43:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.5382  Non0_acc_2: 0.5694  Non0_F1_score: 0.5236  Mult_acc_5: 0.2052  Mult_acc_7: 0.1878  MAE: 1.5795  Corr: 0.0214 
2024-06-11 18:10:58:INFO:TRAIN-(cmcm) (6/18/4)>> loss: 0.8269
2024-06-11 18:11:00:INFO:VAL-(cmcm) >>
2024-06-11 18:11:00:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.4582  Non0_acc_2: 0.5509  Non0_F1_score: 0.4296  Mult_acc_5: 0.1790  Mult_acc_7: 0.1703  MAE: 1.6598  Corr: -0.0802 
2024-06-11 18:11:15:INFO:TRAIN-(cmcm) (7/19/4)>> loss: 0.8266
2024-06-11 18:11:17:INFO:VAL-(cmcm) >>
2024-06-11 18:11:17:INFO:M: >>  Has0_acc_2: 0.5546  Has0_F1_score: 0.4578  Non0_acc_2: 0.5463  Non0_F1_score: 0.4718  Mult_acc_5: 0.2969  Mult_acc_7: 0.2445  MAE: 1.7512  Corr: -0.1117 
2024-06-11 18:11:32:INFO:TRAIN-(cmcm) (8/20/4)>> loss: 0.8289
2024-06-11 18:11:34:INFO:VAL-(cmcm) >>
2024-06-11 18:11:34:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.5912  Non0_acc_2: 0.4769  Non0_F1_score: 0.3849  Mult_acc_5: 0.2009  Mult_acc_7: 0.1878  MAE: 1.5135  Corr: 0.1146 
2024-06-11 18:11:49:INFO:TRAIN-(cmcm) (9/21/4)>> loss: 0.8267
2024-06-11 18:11:51:INFO:VAL-(cmcm) >>
2024-06-11 18:11:51:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.4864  Non0_acc_2: 0.5463  Non0_F1_score: 0.4718  Mult_acc_5: 0.2620  Mult_acc_7: 0.2271  MAE: 1.6983  Corr: -0.0283 
2024-06-11 18:12:06:INFO:TRAIN-(cmcm) (10/22/4)>> loss: 0.8182
2024-06-11 18:12:09:INFO:VAL-(cmcm) >>
2024-06-11 18:12:09:INFO:M: >>  Has0_acc_2: 0.5633  Has0_F1_score: 0.5531  Non0_acc_2: 0.5694  Non0_F1_score: 0.5684  Mult_acc_5: 0.2314  Mult_acc_7: 0.2183  MAE: 1.5598  Corr: 0.0697 
2024-06-11 18:12:16:INFO:TEST-(cmcm) >>
2024-06-11 18:12:16:INFO:M: >>  Has0_acc_2: 0.6064  Has0_F1_score: 0.6074  Non0_acc_2: 0.6021  Non0_F1_score: 0.5586  Mult_acc_5: 0.2157  Mult_acc_7: 0.2055  MAE: 1.4058  Corr: 0.1786 
2024-06-11 18:12:16:INFO:Results are added to results/results/mosi-regression-60.csv...
2024-06-11 18:12:16:INFO:Start running cmcm...
2024-06-11 18:12:16:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 60, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 5555}>
2024-06-11 18:12:16:INFO:Let's use the GPU 1 !
2024-06-11 18:12:16:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 18:12:17:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718100737 HTTP/1.1" 200 235
2024-06-11 18:12:17:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 18:12:17:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 18:12:18:INFO:train samples: (1284,)
2024-06-11 18:12:18:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 18:12:18:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718100739 HTTP/1.1" 200 235
2024-06-11 18:12:18:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 18:12:19:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 18:12:19:INFO:valid samples: (229,)
2024-06-11 18:12:20:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 18:12:20:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718100740 HTTP/1.1" 200 235
2024-06-11 18:12:20:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 18:12:20:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 18:12:21:INFO:test samples: (686,)
2024-06-11 18:12:21:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 18:12:21:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718100741 HTTP/1.1" 200 235
2024-06-11 18:12:21:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 18:12:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 18:12:22:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 18:12:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718100743 HTTP/1.1" 200 235
2024-06-11 18:12:23:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 18:12:23:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 18:12:23:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-11 18:12:23:WARNING:Try importing flash-attention for faster inference...
2024-06-11 18:12:23:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-11 18:12:23:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-11 18:12:23:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-11 18:12:24:INFO:trainable params: 1310284 || all params: 1838138956 || trainable%: 0.07128318540461856
2024-06-11 18:12:24:INFO:Init labels...
2024-06-11 18:12:24:INFO:Start training...
2024-06-11 18:12:39:INFO:TRAIN-(cmcm) (1/1/5)>> loss: 2.1585
2024-06-11 18:12:42:INFO:VAL-(cmcm) >>
2024-06-11 18:12:42:INFO:M: >>  Has0_acc_2: 0.5240  Has0_F1_score: 0.5259  Non0_acc_2: 0.5278  Non0_F1_score: 0.5271  Mult_acc_5: 0.1747  Mult_acc_7: 0.1616  MAE: 1.7095  Corr: 0.0303 
2024-06-11 18:12:42:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-11 18:12:57:INFO:TRAIN-(cmcm) (1/2/5)>> loss: 0.9138
2024-06-11 18:13:00:INFO:VAL-(cmcm) >>
2024-06-11 18:13:00:INFO:M: >>  Has0_acc_2: 0.5197  Has0_F1_score: 0.5197  Non0_acc_2: 0.5278  Non0_F1_score: 0.5244  Mult_acc_5: 0.1528  Mult_acc_7: 0.1485  MAE: 1.6143  Corr: -0.0082 
2024-06-11 18:13:00:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-11 18:13:15:INFO:TRAIN-(cmcm) (1/3/5)>> loss: 0.9121
2024-06-11 18:13:18:INFO:VAL-(cmcm) >>
2024-06-11 18:13:18:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.4943  Non0_acc_2: 0.5833  Non0_F1_score: 0.4676  Mult_acc_5: 0.2096  Mult_acc_7: 0.1878  MAE: 1.5174  Corr: 0.0364 
2024-06-11 18:13:18:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-mosi-regression.pth.
2024-06-11 18:13:33:INFO:TRAIN-(cmcm) (1/4/5)>> loss: 0.9025
2024-06-11 18:13:36:INFO:VAL-(cmcm) >>
2024-06-11 18:13:36:INFO:M: >>  Has0_acc_2: 0.5590  Has0_F1_score: 0.5546  Non0_acc_2: 0.5463  Non0_F1_score: 0.5409  Mult_acc_5: 0.1965  Mult_acc_7: 0.1834  MAE: 1.5803  Corr: 0.0742 
2024-06-11 18:13:50:INFO:TRAIN-(cmcm) (2/5/5)>> loss: 0.8705
2024-06-11 18:13:53:INFO:VAL-(cmcm) >>
2024-06-11 18:13:53:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4791  Non0_acc_2: 0.5741  Non0_F1_score: 0.4797  Mult_acc_5: 0.1790  Mult_acc_7: 0.1790  MAE: 1.4667  Corr: 0.0095 
2024-06-11 18:13:53:INFO:Saving checkpoint at epoch 5 to results/models/cmcm-mosi-regression.pth.
2024-06-11 18:14:08:INFO:TRAIN-(cmcm) (1/6/5)>> loss: 0.8740
2024-06-11 18:14:11:INFO:VAL-(cmcm) >>
2024-06-11 18:14:11:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.5459  Non0_acc_2: 0.5463  Non0_F1_score: 0.5356  Mult_acc_5: 0.2314  Mult_acc_7: 0.2183  MAE: 1.4528  Corr: 0.0539 
2024-06-11 18:14:11:INFO:Saving checkpoint at epoch 6 to results/models/cmcm-mosi-regression.pth.
2024-06-11 18:14:26:INFO:TRAIN-(cmcm) (1/7/5)>> loss: 0.8680
2024-06-11 18:14:29:INFO:VAL-(cmcm) >>
2024-06-11 18:14:29:INFO:M: >>  Has0_acc_2: 0.5371  Has0_F1_score: 0.5382  Non0_acc_2: 0.5463  Non0_F1_score: 0.5456  Mult_acc_5: 0.2445  Mult_acc_7: 0.1921  MAE: 1.6446  Corr: 0.1287 
2024-06-11 18:14:43:INFO:TRAIN-(cmcm) (2/8/5)>> loss: 0.8630
2024-06-11 18:14:46:INFO:VAL-(cmcm) >>
2024-06-11 18:14:46:INFO:M: >>  Has0_acc_2: 0.4629  Has0_F1_score: 0.4297  Non0_acc_2: 0.4861  Non0_F1_score: 0.4546  Mult_acc_5: 0.1703  Mult_acc_7: 0.1659  MAE: 1.7210  Corr: 0.0340 
2024-06-11 18:15:01:INFO:TRAIN-(cmcm) (3/9/5)>> loss: 0.8629
2024-06-11 18:15:03:INFO:VAL-(cmcm) >>
2024-06-11 18:15:03:INFO:M: >>  Has0_acc_2: 0.5415  Has0_F1_score: 0.5370  Non0_acc_2: 0.5370  Non0_F1_score: 0.5396  Mult_acc_5: 0.2402  Mult_acc_7: 0.1921  MAE: 1.7178  Corr: 0.0014 
2024-06-11 18:15:18:INFO:TRAIN-(cmcm) (4/10/5)>> loss: 0.8504
2024-06-11 18:15:20:INFO:VAL-(cmcm) >>
2024-06-11 18:15:20:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.4755  Non0_acc_2: 0.5648  Non0_F1_score: 0.4505  Mult_acc_5: 0.3100  Mult_acc_7: 0.2314  MAE: 1.7328  Corr: 0.0430 
2024-06-11 18:15:35:INFO:TRAIN-(cmcm) (5/11/5)>> loss: 0.8459
2024-06-11 18:15:37:INFO:VAL-(cmcm) >>
2024-06-11 18:15:37:INFO:M: >>  Has0_acc_2: 0.6507  Has0_F1_score: 0.6500  Non0_acc_2: 0.6574  Non0_F1_score: 0.6550  Mult_acc_5: 0.3319  Mult_acc_7: 0.2576  MAE: 1.4333  Corr: 0.2502 
2024-06-11 18:15:38:INFO:Saving checkpoint at epoch 11 to results/models/cmcm-mosi-regression.pth.
2024-06-11 18:15:53:INFO:TRAIN-(cmcm) (1/12/5)>> loss: 0.8407
2024-06-11 18:15:55:INFO:VAL-(cmcm) >>
2024-06-11 18:15:55:INFO:M: >>  Has0_acc_2: 0.6157  Has0_F1_score: 0.5819  Non0_acc_2: 0.6065  Non0_F1_score: 0.5703  Mult_acc_5: 0.2882  Mult_acc_7: 0.2271  MAE: 1.5953  Corr: 0.1477 
2024-06-11 18:16:10:INFO:TRAIN-(cmcm) (2/13/5)>> loss: 0.8349
2024-06-11 18:16:12:INFO:VAL-(cmcm) >>
2024-06-11 18:16:12:INFO:M: >>  Has0_acc_2: 0.6725  Has0_F1_score: 0.6590  Non0_acc_2: 0.6111  Non0_F1_score: 0.6131  Mult_acc_5: 0.3362  Mult_acc_7: 0.2576  MAE: 1.3699  Corr: 0.3118 
2024-06-11 18:16:13:INFO:Saving checkpoint at epoch 13 to results/models/cmcm-mosi-regression.pth.
2024-06-11 18:16:28:INFO:TRAIN-(cmcm) (1/14/5)>> loss: 0.8356
2024-06-11 18:16:30:INFO:VAL-(cmcm) >>
2024-06-11 18:16:30:INFO:M: >>  Has0_acc_2: 0.5415  Has0_F1_score: 0.4920  Non0_acc_2: 0.5694  Non0_F1_score: 0.5222  Mult_acc_5: 0.2620  Mult_acc_7: 0.2096  MAE: 1.6359  Corr: 0.2942 
2024-06-11 18:16:45:INFO:TRAIN-(cmcm) (2/15/5)>> loss: 0.8200
2024-06-11 18:16:47:INFO:VAL-(cmcm) >>
2024-06-11 18:16:47:INFO:M: >>  Has0_acc_2: 0.6245  Has0_F1_score: 0.5559  Non0_acc_2: 0.6574  Non0_F1_score: 0.6375  Mult_acc_5: 0.2314  Mult_acc_7: 0.2140  MAE: 1.3676  Corr: 0.2695 
2024-06-11 18:16:48:INFO:Saving checkpoint at epoch 15 to results/models/cmcm-mosi-regression.pth.
2024-06-11 18:17:03:INFO:TRAIN-(cmcm) (1/16/5)>> loss: 0.8106
2024-06-11 18:17:06:INFO:VAL-(cmcm) >>
2024-06-11 18:17:06:INFO:M: >>  Has0_acc_2: 0.6681  Has0_F1_score: 0.6704  Non0_acc_2: 0.6574  Non0_F1_score: 0.6593  Mult_acc_5: 0.2707  Mult_acc_7: 0.2271  MAE: 1.3336  Corr: 0.3715 
2024-06-11 18:17:06:INFO:Saving checkpoint at epoch 16 to results/models/cmcm-mosi-regression.pth.
2024-06-11 18:17:21:INFO:TRAIN-(cmcm) (1/17/5)>> loss: 0.8048
2024-06-11 18:17:24:INFO:VAL-(cmcm) >>
2024-06-11 18:17:24:INFO:M: >>  Has0_acc_2: 0.6987  Has0_F1_score: 0.6999  Non0_acc_2: 0.6991  Non0_F1_score: 0.7000  Mult_acc_5: 0.3144  Mult_acc_7: 0.2707  MAE: 1.2322  Corr: 0.4367 
2024-06-11 18:17:24:INFO:Saving checkpoint at epoch 17 to results/models/cmcm-mosi-regression.pth.
2024-06-11 18:17:39:INFO:TRAIN-(cmcm) (1/18/5)>> loss: 0.8014
2024-06-11 18:17:41:INFO:VAL-(cmcm) >>
2024-06-11 18:17:41:INFO:M: >>  Has0_acc_2: 0.6900  Has0_F1_score: 0.6912  Non0_acc_2: 0.7130  Non0_F1_score: 0.7121  Mult_acc_5: 0.3930  Mult_acc_7: 0.2969  MAE: 1.2787  Corr: 0.4633 
2024-06-11 18:17:56:INFO:TRAIN-(cmcm) (2/19/5)>> loss: 0.7863
2024-06-11 18:17:59:INFO:VAL-(cmcm) >>
2024-06-11 18:17:59:INFO:M: >>  Has0_acc_2: 0.7031  Has0_F1_score: 0.6989  Non0_acc_2: 0.7130  Non0_F1_score: 0.7121  Mult_acc_5: 0.3668  Mult_acc_7: 0.2707  MAE: 1.1778  Corr: 0.5072 
2024-06-11 18:17:59:INFO:Saving checkpoint at epoch 19 to results/models/cmcm-mosi-regression.pth.
2024-06-11 18:18:14:INFO:TRAIN-(cmcm) (1/20/5)>> loss: 0.7797
2024-06-11 18:18:16:INFO:VAL-(cmcm) >>
2024-06-11 18:18:16:INFO:M: >>  Has0_acc_2: 0.7074  Has0_F1_score: 0.7101  Non0_acc_2: 0.7269  Non0_F1_score: 0.7282  Mult_acc_5: 0.3319  Mult_acc_7: 0.2402  MAE: 1.2398  Corr: 0.5047 
2024-06-11 18:18:31:INFO:TRAIN-(cmcm) (2/21/5)>> loss: 0.7644
2024-06-11 18:18:34:INFO:VAL-(cmcm) >>
2024-06-11 18:18:34:INFO:M: >>  Has0_acc_2: 0.7249  Has0_F1_score: 0.7198  Non0_acc_2: 0.7269  Non0_F1_score: 0.7225  Mult_acc_5: 0.3974  Mult_acc_7: 0.2926  MAE: 1.1663  Corr: 0.5086 
2024-06-11 18:18:34:INFO:Saving checkpoint at epoch 21 to results/models/cmcm-mosi-regression.pth.
2024-06-11 18:18:49:INFO:TRAIN-(cmcm) (1/22/5)>> loss: 0.7564
2024-06-11 18:18:52:INFO:VAL-(cmcm) >>
2024-06-11 18:18:52:INFO:M: >>  Has0_acc_2: 0.7205  Has0_F1_score: 0.7108  Non0_acc_2: 0.7407  Non0_F1_score: 0.7383  Mult_acc_5: 0.3624  Mult_acc_7: 0.3013  MAE: 1.1462  Corr: 0.4975 
2024-06-11 18:18:52:INFO:Saving checkpoint at epoch 22 to results/models/cmcm-mosi-regression.pth.
2024-06-11 18:19:07:INFO:TRAIN-(cmcm) (1/23/5)>> loss: 0.7503
2024-06-11 18:19:10:INFO:VAL-(cmcm) >>
2024-06-11 18:19:10:INFO:M: >>  Has0_acc_2: 0.7074  Has0_F1_score: 0.6941  Non0_acc_2: 0.7407  Non0_F1_score: 0.7346  Mult_acc_5: 0.3755  Mult_acc_7: 0.2882  MAE: 1.1445  Corr: 0.5090 
2024-06-11 18:19:10:INFO:Saving checkpoint at epoch 23 to results/models/cmcm-mosi-regression.pth.
2024-06-11 18:19:25:INFO:TRAIN-(cmcm) (1/24/5)>> loss: 0.7479
2024-06-11 18:19:28:INFO:VAL-(cmcm) >>
2024-06-11 18:19:28:INFO:M: >>  Has0_acc_2: 0.7118  Has0_F1_score: 0.7113  Non0_acc_2: 0.6528  Non0_F1_score: 0.6530  Mult_acc_5: 0.3712  Mult_acc_7: 0.2969  MAE: 1.1969  Corr: 0.4565 
2024-06-11 18:19:42:INFO:TRAIN-(cmcm) (2/25/5)>> loss: 0.7385
2024-06-11 18:19:45:INFO:VAL-(cmcm) >>
2024-06-11 18:19:45:INFO:M: >>  Has0_acc_2: 0.7205  Has0_F1_score: 0.7071  Non0_acc_2: 0.7269  Non0_F1_score: 0.7199  Mult_acc_5: 0.4236  Mult_acc_7: 0.3275  MAE: 1.1730  Corr: 0.5217 
2024-06-11 18:20:00:INFO:TRAIN-(cmcm) (3/26/5)>> loss: 0.7277
2024-06-11 18:20:02:INFO:VAL-(cmcm) >>
2024-06-11 18:20:02:INFO:M: >>  Has0_acc_2: 0.7293  Has0_F1_score: 0.7199  Non0_acc_2: 0.7269  Non0_F1_score: 0.7168  Mult_acc_5: 0.3493  Mult_acc_7: 0.2664  MAE: 1.1672  Corr: 0.5392 
2024-06-11 18:20:17:INFO:TRAIN-(cmcm) (4/27/5)>> loss: 0.7125
2024-06-11 18:20:19:INFO:VAL-(cmcm) >>
2024-06-11 18:20:19:INFO:M: >>  Has0_acc_2: 0.7380  Has0_F1_score: 0.7351  Non0_acc_2: 0.7407  Non0_F1_score: 0.7404  Mult_acc_5: 0.4367  Mult_acc_7: 0.3362  MAE: 1.1274  Corr: 0.5267 
2024-06-11 18:20:20:INFO:Saving checkpoint at epoch 27 to results/models/cmcm-mosi-regression.pth.
2024-06-11 18:20:35:INFO:TRAIN-(cmcm) (1/28/5)>> loss: 0.7089
2024-06-11 18:20:37:INFO:VAL-(cmcm) >>
2024-06-11 18:20:37:INFO:M: >>  Has0_acc_2: 0.7336  Has0_F1_score: 0.7356  Non0_acc_2: 0.6759  Non0_F1_score: 0.6749  Mult_acc_5: 0.3799  Mult_acc_7: 0.3013  MAE: 1.1651  Corr: 0.5150 
2024-06-11 18:20:52:INFO:TRAIN-(cmcm) (2/29/5)>> loss: 0.7015
2024-06-11 18:20:54:INFO:VAL-(cmcm) >>
2024-06-11 18:20:54:INFO:M: >>  Has0_acc_2: 0.6987  Has0_F1_score: 0.6876  Non0_acc_2: 0.7130  Non0_F1_score: 0.7088  Mult_acc_5: 0.3712  Mult_acc_7: 0.2795  MAE: 1.1628  Corr: 0.5207 
2024-06-11 18:21:09:INFO:TRAIN-(cmcm) (3/30/5)>> loss: 0.6895
2024-06-11 18:21:11:INFO:VAL-(cmcm) >>
2024-06-11 18:21:11:INFO:M: >>  Has0_acc_2: 0.7336  Has0_F1_score: 0.7356  Non0_acc_2: 0.6852  Non0_F1_score: 0.6859  Mult_acc_5: 0.3843  Mult_acc_7: 0.3144  MAE: 1.1261  Corr: 0.5261 
2024-06-11 18:21:12:INFO:Saving checkpoint at epoch 30 to results/models/cmcm-mosi-regression.pth.
2024-06-11 18:21:27:INFO:TRAIN-(cmcm) (1/31/5)>> loss: 0.6872
2024-06-11 18:21:29:INFO:VAL-(cmcm) >>
2024-06-11 18:21:29:INFO:M: >>  Has0_acc_2: 0.7249  Has0_F1_score: 0.7189  Non0_acc_2: 0.7269  Non0_F1_score: 0.7208  Mult_acc_5: 0.3843  Mult_acc_7: 0.2882  MAE: 1.1449  Corr: 0.5316 
2024-06-11 18:21:44:INFO:TRAIN-(cmcm) (2/32/5)>> loss: 0.6733
2024-06-11 18:21:46:INFO:VAL-(cmcm) >>
2024-06-11 18:21:46:INFO:M: >>  Has0_acc_2: 0.6856  Has0_F1_score: 0.6462  Non0_acc_2: 0.7130  Non0_F1_score: 0.6876  Mult_acc_5: 0.3886  Mult_acc_7: 0.3144  MAE: 1.1803  Corr: 0.5002 
2024-06-11 18:22:01:INFO:TRAIN-(cmcm) (3/33/5)>> loss: 0.6666
2024-06-11 18:22:03:INFO:VAL-(cmcm) >>
2024-06-11 18:22:03:INFO:M: >>  Has0_acc_2: 0.7205  Has0_F1_score: 0.6995  Non0_acc_2: 0.7083  Non0_F1_score: 0.6921  Mult_acc_5: 0.3624  Mult_acc_7: 0.2882  MAE: 1.1873  Corr: 0.5046 
2024-06-11 18:22:18:INFO:TRAIN-(cmcm) (4/34/5)>> loss: 0.6572
2024-06-11 18:22:21:INFO:VAL-(cmcm) >>
2024-06-11 18:22:21:INFO:M: >>  Has0_acc_2: 0.7162  Has0_F1_score: 0.7080  Non0_acc_2: 0.7269  Non0_F1_score: 0.7179  Mult_acc_5: 0.3886  Mult_acc_7: 0.2795  MAE: 1.2175  Corr: 0.5352 
2024-06-11 18:22:35:INFO:TRAIN-(cmcm) (5/35/5)>> loss: 0.6389
2024-06-11 18:22:38:INFO:VAL-(cmcm) >>
2024-06-11 18:22:38:INFO:M: >>  Has0_acc_2: 0.7162  Has0_F1_score: 0.6989  Non0_acc_2: 0.7176  Non0_F1_score: 0.7060  Mult_acc_5: 0.3712  Mult_acc_7: 0.2795  MAE: 1.2056  Corr: 0.4840 
2024-06-11 18:22:52:INFO:TRAIN-(cmcm) (6/36/5)>> loss: 0.6206
2024-06-11 18:22:55:INFO:VAL-(cmcm) >>
2024-06-11 18:22:55:INFO:M: >>  Has0_acc_2: 0.6943  Has0_F1_score: 0.6972  Non0_acc_2: 0.7083  Non0_F1_score: 0.7099  Mult_acc_5: 0.3537  Mult_acc_7: 0.2620  MAE: 1.2503  Corr: 0.4978 
2024-06-11 18:23:09:INFO:TRAIN-(cmcm) (7/37/5)>> loss: 0.6383
2024-06-11 18:23:12:INFO:VAL-(cmcm) >>
2024-06-11 18:23:12:INFO:M: >>  Has0_acc_2: 0.7336  Has0_F1_score: 0.7323  Non0_acc_2: 0.7407  Non0_F1_score: 0.7407  Mult_acc_5: 0.3668  Mult_acc_7: 0.3013  MAE: 1.1451  Corr: 0.5265 
2024-06-11 18:23:26:INFO:TRAIN-(cmcm) (8/38/5)>> loss: 0.6082
2024-06-11 18:23:29:INFO:VAL-(cmcm) >>
2024-06-11 18:23:29:INFO:M: >>  Has0_acc_2: 0.7074  Has0_F1_score: 0.7066  Non0_acc_2: 0.7083  Non0_F1_score: 0.7099  Mult_acc_5: 0.3930  Mult_acc_7: 0.3319  MAE: 1.1785  Corr: 0.4938 
2024-06-11 18:23:43:INFO:TRAIN-(cmcm) (9/39/5)>> loss: 0.6075
2024-06-11 18:23:46:INFO:VAL-(cmcm) >>
2024-06-11 18:23:46:INFO:M: >>  Has0_acc_2: 0.7424  Has0_F1_score: 0.7349  Non0_acc_2: 0.7130  Non0_F1_score: 0.7137  Mult_acc_5: 0.3668  Mult_acc_7: 0.2882  MAE: 1.1305  Corr: 0.5147 
2024-06-11 18:24:01:INFO:TRAIN-(cmcm) (10/40/5)>> loss: 0.6036
2024-06-11 18:24:03:INFO:VAL-(cmcm) >>
2024-06-11 18:24:03:INFO:M: >>  Has0_acc_2: 0.7511  Has0_F1_score: 0.7480  Non0_acc_2: 0.7593  Non0_F1_score: 0.7589  Mult_acc_5: 0.4148  Mult_acc_7: 0.3406  MAE: 1.0816  Corr: 0.5592 
2024-06-11 18:24:04:INFO:Saving checkpoint at epoch 40 to results/models/cmcm-mosi-regression.pth.
2024-06-11 18:24:19:INFO:TRAIN-(cmcm) (1/41/5)>> loss: 0.5881
2024-06-11 18:24:21:INFO:VAL-(cmcm) >>
2024-06-11 18:24:21:INFO:M: >>  Has0_acc_2: 0.7511  Has0_F1_score: 0.7457  Non0_acc_2: 0.7269  Non0_F1_score: 0.7246  Mult_acc_5: 0.3799  Mult_acc_7: 0.3188  MAE: 1.1162  Corr: 0.5435 
2024-06-11 18:24:36:INFO:TRAIN-(cmcm) (2/42/5)>> loss: 0.5661
2024-06-11 18:24:38:INFO:VAL-(cmcm) >>
2024-06-11 18:24:38:INFO:M: >>  Has0_acc_2: 0.7424  Has0_F1_score: 0.7306  Non0_acc_2: 0.7454  Non0_F1_score: 0.7398  Mult_acc_5: 0.3886  Mult_acc_7: 0.2969  MAE: 1.1611  Corr: 0.5248 
2024-06-11 18:24:53:INFO:TRAIN-(cmcm) (3/43/5)>> loss: 0.5502
2024-06-11 18:24:55:INFO:VAL-(cmcm) >>
2024-06-11 18:24:55:INFO:M: >>  Has0_acc_2: 0.7511  Has0_F1_score: 0.7439  Non0_acc_2: 0.7454  Non0_F1_score: 0.7455  Mult_acc_5: 0.4017  Mult_acc_7: 0.3362  MAE: 1.1091  Corr: 0.5537 
2024-06-11 18:25:10:INFO:TRAIN-(cmcm) (4/44/5)>> loss: 0.5395
2024-06-11 18:25:12:INFO:VAL-(cmcm) >>
2024-06-11 18:25:12:INFO:M: >>  Has0_acc_2: 0.7424  Has0_F1_score: 0.7398  Non0_acc_2: 0.7361  Non0_F1_score: 0.7363  Mult_acc_5: 0.3712  Mult_acc_7: 0.3144  MAE: 1.1213  Corr: 0.5373 
2024-06-11 18:25:27:INFO:TRAIN-(cmcm) (5/45/5)>> loss: 0.5272
2024-06-11 18:25:29:INFO:VAL-(cmcm) >>
2024-06-11 18:25:29:INFO:M: >>  Has0_acc_2: 0.7118  Has0_F1_score: 0.6901  Non0_acc_2: 0.7176  Non0_F1_score: 0.7019  Mult_acc_5: 0.3886  Mult_acc_7: 0.3231  MAE: 1.2030  Corr: 0.4974 
2024-06-11 18:25:44:INFO:TRAIN-(cmcm) (6/46/5)>> loss: 0.5123
2024-06-11 18:25:47:INFO:VAL-(cmcm) >>
2024-06-11 18:25:47:INFO:M: >>  Has0_acc_2: 0.7467  Has0_F1_score: 0.7417  Non0_acc_2: 0.7361  Non0_F1_score: 0.7350  Mult_acc_5: 0.4192  Mult_acc_7: 0.3450  MAE: 1.1253  Corr: 0.5424 
2024-06-11 18:26:01:INFO:TRAIN-(cmcm) (7/47/5)>> loss: 0.4996
2024-06-11 18:26:04:INFO:VAL-(cmcm) >>
2024-06-11 18:26:04:INFO:M: >>  Has0_acc_2: 0.7424  Has0_F1_score: 0.7398  Non0_acc_2: 0.7407  Non0_F1_score: 0.7404  Mult_acc_5: 0.3843  Mult_acc_7: 0.3144  MAE: 1.1170  Corr: 0.5367 
2024-06-11 18:26:18:INFO:TRAIN-(cmcm) (8/48/5)>> loss: 0.4810
2024-06-11 18:26:21:INFO:VAL-(cmcm) >>
2024-06-11 18:26:21:INFO:M: >>  Has0_acc_2: 0.7424  Has0_F1_score: 0.7416  Non0_acc_2: 0.7315  Non0_F1_score: 0.7324  Mult_acc_5: 0.4061  Mult_acc_7: 0.3188  MAE: 1.1608  Corr: 0.5311 
2024-06-11 18:26:35:INFO:TRAIN-(cmcm) (9/49/5)>> loss: 0.4593
2024-06-11 18:26:38:INFO:VAL-(cmcm) >>
2024-06-11 18:26:38:INFO:M: >>  Has0_acc_2: 0.7249  Has0_F1_score: 0.7222  Non0_acc_2: 0.7269  Non0_F1_score: 0.7270  Mult_acc_5: 0.3974  Mult_acc_7: 0.3275  MAE: 1.1017  Corr: 0.5561 
2024-06-11 18:26:53:INFO:TRAIN-(cmcm) (10/50/5)>> loss: 0.4465
2024-06-11 18:26:55:INFO:VAL-(cmcm) >>
2024-06-11 18:26:55:INFO:M: >>  Has0_acc_2: 0.7293  Has0_F1_score: 0.7255  Non0_acc_2: 0.7407  Non0_F1_score: 0.7377  Mult_acc_5: 0.4192  Mult_acc_7: 0.3406  MAE: 1.1183  Corr: 0.5536 
2024-06-11 18:27:02:INFO:TEST-(cmcm) >>
2024-06-11 18:27:02:INFO:M: >>  Has0_acc_2: 0.6778  Has0_F1_score: 0.6782  Non0_acc_2: 0.7073  Non0_F1_score: 0.7089  Mult_acc_5: 0.3455  Mult_acc_7: 0.3003  MAE: 1.2062  Corr: 0.4660 
2024-06-11 18:27:03:INFO:Results are added to results/results/mosi-regression-60.csv...
2024-06-11 18:27:03:INFO:Start running cmcm...
2024-06-11 18:27:03:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 70, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-06-11 18:27:03:INFO:Let's use the GPU 1 !
2024-06-11 18:27:03:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 18:27:03:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718101623 HTTP/1.1" 200 235
2024-06-11 18:27:03:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 18:27:04:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 18:27:05:INFO:train samples: (1284,)
2024-06-11 18:27:05:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 18:27:05:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718101625 HTTP/1.1" 200 235
2024-06-11 18:27:05:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 18:27:06:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 18:27:06:INFO:valid samples: (229,)
2024-06-11 18:27:06:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 18:27:07:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718101627 HTTP/1.1" 200 235
2024-06-11 18:27:07:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 18:27:07:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 18:27:08:INFO:test samples: (686,)
2024-06-11 18:27:08:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 18:27:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718101628 HTTP/1.1" 200 235
2024-06-11 18:27:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 18:27:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 18:27:09:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 18:27:09:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718101629 HTTP/1.1" 200 235
2024-06-11 18:27:09:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 18:27:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 18:27:10:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-11 18:27:10:WARNING:Try importing flash-attention for faster inference...
2024-06-11 18:27:10:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-11 18:27:10:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-11 18:27:10:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-11 18:27:11:INFO:trainable params: 1310284 || all params: 1838138956 || trainable%: 0.07128318540461856
2024-06-11 18:27:11:INFO:Init labels...
2024-06-11 18:27:11:INFO:Start training...
2024-06-11 18:27:26:INFO:TRAIN-(cmcm) (1/1/1)>> loss: 2.1082
2024-06-11 18:27:28:INFO:VAL-(cmcm) >>
2024-06-11 18:27:28:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.4764  Non0_acc_2: 0.5463  Non0_F1_score: 0.4569  Mult_acc_5: 0.1747  Mult_acc_7: 0.1616  MAE: 1.6407  Corr: -0.0505 
2024-06-11 18:27:29:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-11 18:27:44:INFO:TRAIN-(cmcm) (1/2/1)>> loss: 0.9519
2024-06-11 18:27:47:INFO:VAL-(cmcm) >>
2024-06-11 18:27:47:INFO:M: >>  Has0_acc_2: 0.5240  Has0_F1_score: 0.4922  Non0_acc_2: 0.5509  Non0_F1_score: 0.5210  Mult_acc_5: 0.2183  Mult_acc_7: 0.1878  MAE: 1.5988  Corr: 0.1728 
2024-06-11 18:27:47:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-11 18:28:02:INFO:TRAIN-(cmcm) (1/3/1)>> loss: 0.9128
2024-06-11 18:28:05:INFO:VAL-(cmcm) >>
2024-06-11 18:28:05:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4652  Non0_acc_2: 0.5741  Non0_F1_score: 0.4558  Mult_acc_5: 0.2183  Mult_acc_7: 0.1659  MAE: 1.6031  Corr: 0.0175 
2024-06-11 18:28:20:INFO:TRAIN-(cmcm) (2/4/1)>> loss: 0.8958
2024-06-11 18:28:22:INFO:VAL-(cmcm) >>
2024-06-11 18:28:22:INFO:M: >>  Has0_acc_2: 0.5197  Has0_F1_score: 0.5234  Non0_acc_2: 0.5231  Non0_F1_score: 0.5245  Mult_acc_5: 0.1921  Mult_acc_7: 0.1790  MAE: 1.8122  Corr: 0.0161 
2024-06-11 18:28:37:INFO:TRAIN-(cmcm) (3/5/1)>> loss: 0.8765
2024-06-11 18:28:39:INFO:VAL-(cmcm) >>
2024-06-11 18:28:39:INFO:M: >>  Has0_acc_2: 0.5415  Has0_F1_score: 0.5444  Non0_acc_2: 0.5417  Non0_F1_score: 0.5425  Mult_acc_5: 0.2664  Mult_acc_7: 0.2271  MAE: 1.6191  Corr: 0.0549 
2024-06-11 18:28:54:INFO:TRAIN-(cmcm) (4/6/1)>> loss: 0.8673
2024-06-11 18:28:56:INFO:VAL-(cmcm) >>
2024-06-11 18:28:56:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5053  Non0_acc_2: 0.5648  Non0_F1_score: 0.4791  Mult_acc_5: 0.2576  Mult_acc_7: 0.2271  MAE: 1.6545  Corr: 0.0053 
2024-06-11 18:29:11:INFO:TRAIN-(cmcm) (5/7/1)>> loss: 0.8623
2024-06-11 18:29:14:INFO:VAL-(cmcm) >>
2024-06-11 18:29:14:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5587  Non0_acc_2: 0.5602  Non0_F1_score: 0.5357  Mult_acc_5: 0.3144  Mult_acc_7: 0.2358  MAE: 1.5926  Corr: 0.0779 
2024-06-11 18:29:14:INFO:Saving checkpoint at epoch 7 to results/models/cmcm-mosi-regression.pth.
2024-06-11 18:29:29:INFO:TRAIN-(cmcm) (1/8/1)>> loss: 0.8652
2024-06-11 18:29:32:INFO:VAL-(cmcm) >>
2024-06-11 18:29:32:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.5576  Non0_acc_2: 0.5833  Non0_F1_score: 0.5340  Mult_acc_5: 0.2707  Mult_acc_7: 0.2314  MAE: 1.3768  Corr: 0.2104 
2024-06-11 18:29:32:INFO:Saving checkpoint at epoch 8 to results/models/cmcm-mosi-regression.pth.
2024-06-11 18:29:47:INFO:TRAIN-(cmcm) (1/9/1)>> loss: 0.8492
2024-06-11 18:29:50:INFO:VAL-(cmcm) >>
2024-06-11 18:29:50:INFO:M: >>  Has0_acc_2: 0.6419  Has0_F1_score: 0.6447  Non0_acc_2: 0.6528  Non0_F1_score: 0.6538  Mult_acc_5: 0.2751  Mult_acc_7: 0.2009  MAE: 1.4381  Corr: 0.3387 
2024-06-11 18:30:04:INFO:TRAIN-(cmcm) (2/10/1)>> loss: 0.8283
2024-06-11 18:30:07:INFO:VAL-(cmcm) >>
2024-06-11 18:30:07:INFO:M: >>  Has0_acc_2: 0.5546  Has0_F1_score: 0.5162  Non0_acc_2: 0.5602  Non0_F1_score: 0.5120  Mult_acc_5: 0.2140  Mult_acc_7: 0.1921  MAE: 1.4525  Corr: 0.3980 
2024-06-11 18:30:22:INFO:TRAIN-(cmcm) (3/11/1)>> loss: 0.8034
2024-06-11 18:30:24:INFO:VAL-(cmcm) >>
2024-06-11 18:30:24:INFO:M: >>  Has0_acc_2: 0.7118  Has0_F1_score: 0.7060  Non0_acc_2: 0.6435  Non0_F1_score: 0.6298  Mult_acc_5: 0.3537  Mult_acc_7: 0.2838  MAE: 1.1501  Corr: 0.5427 
2024-06-11 18:30:25:INFO:Saving checkpoint at epoch 11 to results/models/cmcm-mosi-regression.pth.
2024-06-11 18:30:40:INFO:TRAIN-(cmcm) (1/12/1)>> loss: 0.7909
2024-06-11 18:30:42:INFO:VAL-(cmcm) >>
2024-06-11 18:30:42:INFO:M: >>  Has0_acc_2: 0.7162  Has0_F1_score: 0.7173  Non0_acc_2: 0.7083  Non0_F1_score: 0.7066  Mult_acc_5: 0.3799  Mult_acc_7: 0.3144  MAE: 1.0913  Corr: 0.5696 
2024-06-11 18:30:43:INFO:Saving checkpoint at epoch 12 to results/models/cmcm-mosi-regression.pth.
2024-06-11 18:30:58:INFO:TRAIN-(cmcm) (1/13/1)>> loss: 0.7747
2024-06-11 18:31:00:INFO:VAL-(cmcm) >>
2024-06-11 18:31:00:INFO:M: >>  Has0_acc_2: 0.7293  Has0_F1_score: 0.7288  Non0_acc_2: 0.7176  Non0_F1_score: 0.7170  Mult_acc_5: 0.4192  Mult_acc_7: 0.3537  MAE: 1.0350  Corr: 0.5836 
2024-06-11 18:31:01:INFO:Saving checkpoint at epoch 13 to results/models/cmcm-mosi-regression.pth.
2024-06-11 18:31:16:INFO:TRAIN-(cmcm) (1/14/1)>> loss: 0.7639
2024-06-11 18:31:18:INFO:VAL-(cmcm) >>
2024-06-11 18:31:18:INFO:M: >>  Has0_acc_2: 0.7336  Has0_F1_score: 0.7343  Non0_acc_2: 0.7593  Non0_F1_score: 0.7593  Mult_acc_5: 0.4236  Mult_acc_7: 0.3319  MAE: 1.1005  Corr: 0.5754 
2024-06-11 18:31:33:INFO:TRAIN-(cmcm) (2/15/1)>> loss: 0.7487
2024-06-11 18:31:36:INFO:VAL-(cmcm) >>
2024-06-11 18:31:36:INFO:M: >>  Has0_acc_2: 0.7162  Has0_F1_score: 0.7109  Non0_acc_2: 0.7130  Non0_F1_score: 0.7080  Mult_acc_5: 0.4148  Mult_acc_7: 0.3319  MAE: 1.0900  Corr: 0.5608 
2024-06-11 18:31:51:INFO:TRAIN-(cmcm) (3/16/1)>> loss: 0.7392
2024-06-11 18:31:53:INFO:VAL-(cmcm) >>
2024-06-11 18:31:53:INFO:M: >>  Has0_acc_2: 0.6769  Has0_F1_score: 0.6781  Non0_acc_2: 0.6713  Non0_F1_score: 0.6694  Mult_acc_5: 0.3755  Mult_acc_7: 0.2795  MAE: 1.2464  Corr: 0.5313 
2024-06-11 18:32:08:INFO:TRAIN-(cmcm) (4/17/1)>> loss: 0.7459
2024-06-11 18:32:10:INFO:VAL-(cmcm) >>
2024-06-11 18:32:10:INFO:M: >>  Has0_acc_2: 0.7336  Has0_F1_score: 0.7353  Non0_acc_2: 0.7407  Non0_F1_score: 0.7407  Mult_acc_5: 0.4236  Mult_acc_7: 0.3275  MAE: 1.0309  Corr: 0.6031 
2024-06-11 18:32:11:INFO:Saving checkpoint at epoch 17 to results/models/cmcm-mosi-regression.pth.
2024-06-11 18:32:26:INFO:TRAIN-(cmcm) (1/18/1)>> loss: 0.7273
2024-06-11 18:32:29:INFO:VAL-(cmcm) >>
2024-06-11 18:32:29:INFO:M: >>  Has0_acc_2: 0.7293  Has0_F1_score: 0.7318  Non0_acc_2: 0.7593  Non0_F1_score: 0.7606  Mult_acc_5: 0.3843  Mult_acc_7: 0.2882  MAE: 1.1113  Corr: 0.5938 
2024-06-11 18:32:43:INFO:TRAIN-(cmcm) (2/19/1)>> loss: 0.7063
2024-06-11 18:32:46:INFO:VAL-(cmcm) >>
2024-06-11 18:32:46:INFO:M: >>  Has0_acc_2: 0.7598  Has0_F1_score: 0.7591  Non0_acc_2: 0.7407  Non0_F1_score: 0.7421  Mult_acc_5: 0.4629  Mult_acc_7: 0.3668  MAE: 0.9969  Corr: 0.6275 
2024-06-11 18:32:46:INFO:Saving checkpoint at epoch 19 to results/models/cmcm-mosi-regression.pth.
2024-06-11 18:33:01:INFO:TRAIN-(cmcm) (1/20/1)>> loss: 0.7147
2024-06-11 18:33:04:INFO:VAL-(cmcm) >>
2024-06-11 18:33:04:INFO:M: >>  Has0_acc_2: 0.6594  Has0_F1_score: 0.6597  Non0_acc_2: 0.6944  Non0_F1_score: 0.6935  Mult_acc_5: 0.4105  Mult_acc_7: 0.3100  MAE: 1.1909  Corr: 0.5127 
2024-06-11 18:33:18:INFO:TRAIN-(cmcm) (2/21/1)>> loss: 0.7060
2024-06-11 18:33:21:INFO:VAL-(cmcm) >>
2024-06-11 18:33:21:INFO:M: >>  Has0_acc_2: 0.7205  Has0_F1_score: 0.7232  Non0_acc_2: 0.6528  Non0_F1_score: 0.6444  Mult_acc_5: 0.3755  Mult_acc_7: 0.2969  MAE: 1.0855  Corr: 0.6052 
2024-06-11 18:33:35:INFO:TRAIN-(cmcm) (3/22/1)>> loss: 0.7106
2024-06-11 18:33:38:INFO:VAL-(cmcm) >>
2024-06-11 18:33:38:INFO:M: >>  Has0_acc_2: 0.7773  Has0_F1_score: 0.7725  Non0_acc_2: 0.7963  Non0_F1_score: 0.7934  Mult_acc_5: 0.4367  Mult_acc_7: 0.3406  MAE: 1.0289  Corr: 0.6295 
2024-06-11 18:33:53:INFO:TRAIN-(cmcm) (4/23/1)>> loss: 0.6976
2024-06-11 18:33:55:INFO:VAL-(cmcm) >>
2024-06-11 18:33:55:INFO:M: >>  Has0_acc_2: 0.7555  Has0_F1_score: 0.7566  Non0_acc_2: 0.7361  Non0_F1_score: 0.7369  Mult_acc_5: 0.4192  Mult_acc_7: 0.3275  MAE: 1.0402  Corr: 0.6051 
2024-06-11 18:34:10:INFO:TRAIN-(cmcm) (5/24/1)>> loss: 0.6809
2024-06-11 18:34:12:INFO:VAL-(cmcm) >>
2024-06-11 18:34:12:INFO:M: >>  Has0_acc_2: 0.7118  Has0_F1_score: 0.7141  Non0_acc_2: 0.6991  Non0_F1_score: 0.6973  Mult_acc_5: 0.3624  Mult_acc_7: 0.2707  MAE: 1.1328  Corr: 0.5960 
2024-06-11 18:34:27:INFO:TRAIN-(cmcm) (6/25/1)>> loss: 0.6764
2024-06-11 18:34:29:INFO:VAL-(cmcm) >>
2024-06-11 18:34:29:INFO:M: >>  Has0_acc_2: 0.7424  Has0_F1_score: 0.7446  Non0_acc_2: 0.7593  Non0_F1_score: 0.7603  Mult_acc_5: 0.3799  Mult_acc_7: 0.2882  MAE: 1.0603  Corr: 0.6095 
2024-06-11 18:34:44:INFO:TRAIN-(cmcm) (7/26/1)>> loss: 0.6636
2024-06-11 18:34:46:INFO:VAL-(cmcm) >>
2024-06-11 18:34:46:INFO:M: >>  Has0_acc_2: 0.7380  Has0_F1_score: 0.7395  Non0_acc_2: 0.6991  Non0_F1_score: 0.6967  Mult_acc_5: 0.4105  Mult_acc_7: 0.3275  MAE: 1.0694  Corr: 0.5829 
2024-06-11 18:35:01:INFO:TRAIN-(cmcm) (8/27/1)>> loss: 0.6604
2024-06-11 18:35:04:INFO:VAL-(cmcm) >>
2024-06-11 18:35:04:INFO:M: >>  Has0_acc_2: 0.7424  Has0_F1_score: 0.7446  Non0_acc_2: 0.7639  Non0_F1_score: 0.7648  Mult_acc_5: 0.4017  Mult_acc_7: 0.3057  MAE: 1.0791  Corr: 0.5883 
2024-06-11 18:35:18:INFO:TRAIN-(cmcm) (9/28/1)>> loss: 0.6540
2024-06-11 18:35:21:INFO:VAL-(cmcm) >>
2024-06-11 18:35:21:INFO:M: >>  Has0_acc_2: 0.7686  Has0_F1_score: 0.7700  Non0_acc_2: 0.7824  Non0_F1_score: 0.7834  Mult_acc_5: 0.4279  Mult_acc_7: 0.3537  MAE: 1.0337  Corr: 0.5943 
2024-06-11 18:35:36:INFO:TRAIN-(cmcm) (10/29/1)>> loss: 0.6387
2024-06-11 18:35:39:INFO:VAL-(cmcm) >>
2024-06-11 18:35:39:INFO:M: >>  Has0_acc_2: 0.7511  Has0_F1_score: 0.7480  Non0_acc_2: 0.7731  Non0_F1_score: 0.7713  Mult_acc_5: 0.4279  Mult_acc_7: 0.3493  MAE: 1.0437  Corr: 0.5898 
2024-06-11 18:35:46:INFO:TEST-(cmcm) >>
2024-06-11 18:35:46:INFO:M: >>  Has0_acc_2: 0.7041  Has0_F1_score: 0.7041  Non0_acc_2: 0.7530  Non0_F1_score: 0.7522  Mult_acc_5: 0.3848  Mult_acc_7: 0.3338  MAE: 1.0665  Corr: 0.5620 
2024-06-11 18:35:46:INFO:Results are added to results/results/mosi-regression-70.csv...
2024-06-11 18:35:46:INFO:Start running cmcm...
2024-06-11 18:35:46:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 70, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 2222}>
2024-06-11 18:35:46:INFO:Let's use the GPU 1 !
2024-06-11 18:35:46:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 18:35:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718102147 HTTP/1.1" 200 235
2024-06-11 18:35:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 18:35:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 18:35:48:INFO:train samples: (1284,)
2024-06-11 18:35:48:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 18:35:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718102148 HTTP/1.1" 200 235
2024-06-11 18:35:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 18:35:49:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 18:35:49:INFO:valid samples: (229,)
2024-06-11 18:35:49:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 18:35:50:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718102150 HTTP/1.1" 200 235
2024-06-11 18:35:50:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 18:35:50:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 18:35:51:INFO:test samples: (686,)
2024-06-11 18:35:51:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 18:35:51:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718102151 HTTP/1.1" 200 235
2024-06-11 18:35:52:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 18:35:52:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 18:35:52:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 18:35:53:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718102153 HTTP/1.1" 200 235
2024-06-11 18:35:53:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 18:35:53:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 18:35:53:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-11 18:35:53:WARNING:Try importing flash-attention for faster inference...
2024-06-11 18:35:53:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-11 18:35:53:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-11 18:35:53:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-11 18:35:54:INFO:trainable params: 1310284 || all params: 1838138956 || trainable%: 0.07128318540461856
2024-06-11 18:35:54:INFO:Init labels...
2024-06-11 18:35:54:INFO:Start training...
2024-06-11 18:36:09:INFO:TRAIN-(cmcm) (1/1/2)>> loss: 2.7310
2024-06-11 18:36:12:INFO:VAL-(cmcm) >>
2024-06-11 18:36:12:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4652  Non0_acc_2: 0.5787  Non0_F1_score: 0.4370  Mult_acc_5: 0.2838  Mult_acc_7: 0.2227  MAE: 1.7533  Corr: -0.0710 
2024-06-11 18:36:12:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-11 18:36:27:INFO:TRAIN-(cmcm) (1/2/2)>> loss: 0.9374
2024-06-11 18:36:30:INFO:VAL-(cmcm) >>
2024-06-11 18:36:30:INFO:M: >>  Has0_acc_2: 0.5284  Has0_F1_score: 0.5280  Non0_acc_2: 0.5417  Non0_F1_score: 0.5398  Mult_acc_5: 0.2183  Mult_acc_7: 0.1834  MAE: 1.6576  Corr: 0.0671 
2024-06-11 18:36:30:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-11 18:36:45:INFO:TRAIN-(cmcm) (1/3/2)>> loss: 0.9103
2024-06-11 18:36:48:INFO:VAL-(cmcm) >>
2024-06-11 18:36:48:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4891  Non0_acc_2: 0.5741  Non0_F1_score: 0.4622  Mult_acc_5: 0.1878  Mult_acc_7: 0.1747  MAE: 1.6017  Corr: -0.0171 
2024-06-11 18:36:48:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-mosi-regression.pth.
2024-06-11 18:37:03:INFO:TRAIN-(cmcm) (1/4/2)>> loss: 0.8896
2024-06-11 18:37:06:INFO:VAL-(cmcm) >>
2024-06-11 18:37:06:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5282  Non0_acc_2: 0.5648  Non0_F1_score: 0.5097  Mult_acc_5: 0.1965  Mult_acc_7: 0.1790  MAE: 1.6165  Corr: 0.0270 
2024-06-11 18:37:20:INFO:TRAIN-(cmcm) (2/5/2)>> loss: 0.8778
2024-06-11 18:37:23:INFO:VAL-(cmcm) >>
2024-06-11 18:37:23:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.4780  Non0_acc_2: 0.5694  Non0_F1_score: 0.4655  Mult_acc_5: 0.1747  Mult_acc_7: 0.1703  MAE: 1.4781  Corr: 0.0292 
2024-06-11 18:37:23:INFO:Saving checkpoint at epoch 5 to results/models/cmcm-mosi-regression.pth.
2024-06-11 18:37:38:INFO:TRAIN-(cmcm) (1/6/2)>> loss: 0.8676
2024-06-11 18:37:41:INFO:VAL-(cmcm) >>
2024-06-11 18:37:41:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5446  Non0_acc_2: 0.5741  Non0_F1_score: 0.5271  Mult_acc_5: 0.2664  Mult_acc_7: 0.1878  MAE: 1.6664  Corr: 0.0389 
2024-06-11 18:37:55:INFO:TRAIN-(cmcm) (2/7/2)>> loss: 0.8756
2024-06-11 18:37:58:INFO:VAL-(cmcm) >>
2024-06-11 18:37:58:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.5187  Non0_acc_2: 0.5509  Non0_F1_score: 0.4996  Mult_acc_5: 0.2052  Mult_acc_7: 0.1834  MAE: 1.6384  Corr: -0.0154 
2024-06-11 18:38:12:INFO:TRAIN-(cmcm) (3/8/2)>> loss: 0.8705
2024-06-11 18:38:15:INFO:VAL-(cmcm) >>
2024-06-11 18:38:15:INFO:M: >>  Has0_acc_2: 0.5240  Has0_F1_score: 0.5280  Non0_acc_2: 0.5324  Non0_F1_score: 0.5345  Mult_acc_5: 0.2096  Mult_acc_7: 0.2009  MAE: 1.5318  Corr: 0.0623 
2024-06-11 18:38:30:INFO:TRAIN-(cmcm) (4/9/2)>> loss: 0.8657
2024-06-11 18:38:32:INFO:VAL-(cmcm) >>
2024-06-11 18:38:32:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.5967  Non0_acc_2: 0.5972  Non0_F1_score: 0.5939  Mult_acc_5: 0.2838  Mult_acc_7: 0.2096  MAE: 1.5892  Corr: 0.1272 
2024-06-11 18:38:47:INFO:TRAIN-(cmcm) (5/10/2)>> loss: 0.8588
2024-06-11 18:38:49:INFO:VAL-(cmcm) >>
2024-06-11 18:38:49:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.4996  Non0_acc_2: 0.5602  Non0_F1_score: 0.4761  Mult_acc_5: 0.2882  Mult_acc_7: 0.2096  MAE: 1.7005  Corr: -0.0037 
2024-06-11 18:39:04:INFO:TRAIN-(cmcm) (6/11/2)>> loss: 0.8520
2024-06-11 18:39:06:INFO:VAL-(cmcm) >>
2024-06-11 18:39:06:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5302  Non0_acc_2: 0.5787  Non0_F1_score: 0.5158  Mult_acc_5: 0.2926  Mult_acc_7: 0.2096  MAE: 1.7844  Corr: 0.0335 
2024-06-11 18:39:21:INFO:TRAIN-(cmcm) (7/12/2)>> loss: 0.8497
2024-06-11 18:39:23:INFO:VAL-(cmcm) >>
2024-06-11 18:39:23:INFO:M: >>  Has0_acc_2: 0.6157  Has0_F1_score: 0.5793  Non0_acc_2: 0.5926  Non0_F1_score: 0.5566  Mult_acc_5: 0.3057  Mult_acc_7: 0.2445  MAE: 1.5975  Corr: 0.0680 
2024-06-11 18:39:38:INFO:TRAIN-(cmcm) (8/13/2)>> loss: 0.8399
2024-06-11 18:39:41:INFO:VAL-(cmcm) >>
2024-06-11 18:39:41:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5587  Non0_acc_2: 0.5787  Non0_F1_score: 0.5456  Mult_acc_5: 0.2882  Mult_acc_7: 0.2140  MAE: 1.7031  Corr: 0.0703 
2024-06-11 18:39:55:INFO:TRAIN-(cmcm) (9/14/2)>> loss: 0.8358
2024-06-11 18:39:58:INFO:VAL-(cmcm) >>
2024-06-11 18:39:58:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5189  Non0_acc_2: 0.5694  Non0_F1_score: 0.4966  Mult_acc_5: 0.2533  Mult_acc_7: 0.1878  MAE: 1.7599  Corr: 0.0213 
2024-06-11 18:40:12:INFO:TRAIN-(cmcm) (10/15/2)>> loss: 0.8323
2024-06-11 18:40:15:INFO:VAL-(cmcm) >>
2024-06-11 18:40:15:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.6029  Non0_acc_2: 0.6065  Non0_F1_score: 0.5965  Mult_acc_5: 0.2271  Mult_acc_7: 0.2052  MAE: 1.4846  Corr: 0.1434 
2024-06-11 18:40:22:INFO:TEST-(cmcm) >>
2024-06-11 18:40:22:INFO:M: >>  Has0_acc_2: 0.4898  Has0_F1_score: 0.3805  Non0_acc_2: 0.4588  Non0_F1_score: 0.3611  Mult_acc_5: 0.1924  Mult_acc_7: 0.1924  MAE: 1.6456  Corr: 0.1034 
2024-06-11 18:40:22:INFO:Results are added to results/results/mosi-regression-70.csv...
2024-06-11 18:40:22:INFO:Start running cmcm...
2024-06-11 18:40:22:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 70, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 3333}>
2024-06-11 18:40:22:INFO:Let's use the GPU 1 !
2024-06-11 18:40:22:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 18:40:23:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718102423 HTTP/1.1" 200 235
2024-06-11 18:40:23:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 18:40:23:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 18:40:24:INFO:train samples: (1284,)
2024-06-11 18:40:24:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 18:40:25:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718102425 HTTP/1.1" 200 235
2024-06-11 18:40:25:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 18:40:25:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 18:40:26:INFO:valid samples: (229,)
2024-06-11 18:40:26:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 18:40:26:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718102426 HTTP/1.1" 200 235
2024-06-11 18:40:26:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 18:40:27:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 18:40:27:INFO:test samples: (686,)
2024-06-11 18:40:27:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 18:40:28:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718102428 HTTP/1.1" 200 235
2024-06-11 18:40:28:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 18:40:28:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 18:40:29:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 18:40:29:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718102429 HTTP/1.1" 200 235
2024-06-11 18:40:29:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 18:40:30:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 18:40:30:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-11 18:40:30:WARNING:Try importing flash-attention for faster inference...
2024-06-11 18:40:30:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-11 18:40:30:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-11 18:40:30:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-11 18:40:31:INFO:trainable params: 1310284 || all params: 1838138956 || trainable%: 0.07128318540461856
2024-06-11 18:40:31:INFO:Init labels...
2024-06-11 18:40:31:INFO:Start training...
2024-06-11 18:40:46:INFO:TRAIN-(cmcm) (1/1/3)>> loss: 3.3698
2024-06-11 18:40:48:INFO:VAL-(cmcm) >>
2024-06-11 18:40:48:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4923  Non0_acc_2: 0.5741  Non0_F1_score: 0.4797  Mult_acc_5: 0.2489  Mult_acc_7: 0.1834  MAE: 1.6293  Corr: 0.0437 
2024-06-11 18:40:49:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-11 18:41:04:INFO:TRAIN-(cmcm) (1/2/3)>> loss: 0.9848
2024-06-11 18:41:06:INFO:VAL-(cmcm) >>
2024-06-11 18:41:06:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.4951  Non0_acc_2: 0.5694  Non0_F1_score: 0.4713  Mult_acc_5: 0.1965  Mult_acc_7: 0.1965  MAE: 1.4266  Corr: 0.0344 
2024-06-11 18:41:07:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-11 18:41:22:INFO:TRAIN-(cmcm) (1/3/3)>> loss: 0.9224
2024-06-11 18:41:24:INFO:VAL-(cmcm) >>
2024-06-11 18:41:24:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.5788  Non0_acc_2: 0.5787  Non0_F1_score: 0.5708  Mult_acc_5: 0.2183  Mult_acc_7: 0.2183  MAE: 1.5563  Corr: 0.0899 
2024-06-11 18:41:39:INFO:TRAIN-(cmcm) (2/4/3)>> loss: 0.8993
2024-06-11 18:41:42:INFO:VAL-(cmcm) >>
2024-06-11 18:41:42:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5053  Non0_acc_2: 0.5648  Non0_F1_score: 0.4791  Mult_acc_5: 0.2533  Mult_acc_7: 0.1790  MAE: 1.8651  Corr: -0.0094 
2024-06-11 18:41:56:INFO:TRAIN-(cmcm) (3/5/3)>> loss: 0.8967
2024-06-11 18:41:59:INFO:VAL-(cmcm) >>
2024-06-11 18:41:59:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.4864  Non0_acc_2: 0.5556  Non0_F1_score: 0.4826  Mult_acc_5: 0.1790  Mult_acc_7: 0.1790  MAE: 1.4816  Corr: -0.0175 
2024-06-11 18:42:13:INFO:TRAIN-(cmcm) (4/6/3)>> loss: 0.8817
2024-06-11 18:42:16:INFO:VAL-(cmcm) >>
2024-06-11 18:42:16:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5340  Non0_acc_2: 0.5787  Non0_F1_score: 0.5158  Mult_acc_5: 0.2838  Mult_acc_7: 0.2009  MAE: 1.7180  Corr: 0.0306 
2024-06-11 18:42:30:INFO:TRAIN-(cmcm) (5/7/3)>> loss: 0.8953
2024-06-11 18:42:33:INFO:VAL-(cmcm) >>
2024-06-11 18:42:33:INFO:M: >>  Has0_acc_2: 0.6201  Has0_F1_score: 0.5771  Non0_acc_2: 0.5926  Non0_F1_score: 0.5593  Mult_acc_5: 0.1921  Mult_acc_7: 0.1834  MAE: 1.4777  Corr: 0.0774 
2024-06-11 18:42:48:INFO:TRAIN-(cmcm) (6/8/3)>> loss: 0.8756
2024-06-11 18:42:50:INFO:VAL-(cmcm) >>
2024-06-11 18:42:50:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5219  Non0_acc_2: 0.5787  Non0_F1_score: 0.5029  Mult_acc_5: 0.2795  Mult_acc_7: 0.2052  MAE: 1.7066  Corr: 0.0235 
2024-06-11 18:43:05:INFO:TRAIN-(cmcm) (7/9/3)>> loss: 0.8737
2024-06-11 18:43:07:INFO:VAL-(cmcm) >>
2024-06-11 18:43:07:INFO:M: >>  Has0_acc_2: 0.6201  Has0_F1_score: 0.5081  Non0_acc_2: 0.6019  Non0_F1_score: 0.4913  Mult_acc_5: 0.3100  Mult_acc_7: 0.2358  MAE: 1.7040  Corr: 0.0528 
2024-06-11 18:43:22:INFO:TRAIN-(cmcm) (8/10/3)>> loss: 0.8697
2024-06-11 18:43:24:INFO:VAL-(cmcm) >>
2024-06-11 18:43:24:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4676  Non0_acc_2: 0.5602  Non0_F1_score: 0.4346  Mult_acc_5: 0.2664  Mult_acc_7: 0.1965  MAE: 1.6844  Corr: -0.0256 
2024-06-11 18:43:39:INFO:TRAIN-(cmcm) (9/11/3)>> loss: 0.8658
2024-06-11 18:43:41:INFO:VAL-(cmcm) >>
2024-06-11 18:43:41:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.5059  Non0_acc_2: 0.5833  Non0_F1_score: 0.4799  Mult_acc_5: 0.1703  Mult_acc_7: 0.1703  MAE: 1.5966  Corr: 0.0157 
2024-06-11 18:43:56:INFO:TRAIN-(cmcm) (10/12/3)>> loss: 0.8641
2024-06-11 18:43:59:INFO:VAL-(cmcm) >>
2024-06-11 18:43:59:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.5220  Non0_acc_2: 0.5509  Non0_F1_score: 0.5031  Mult_acc_5: 0.2969  Mult_acc_7: 0.2183  MAE: 1.8874  Corr: -0.0288 
2024-06-11 18:44:06:INFO:TEST-(cmcm) >>
2024-06-11 18:44:06:INFO:M: >>  Has0_acc_2: 0.4898  Has0_F1_score: 0.4035  Non0_acc_2: 0.4695  Non0_F1_score: 0.3843  Mult_acc_5: 0.1589  Mult_acc_7: 0.1574  MAE: 1.4837  Corr: 0.0801 
2024-06-11 18:44:06:INFO:Results are added to results/results/mosi-regression-70.csv...
2024-06-11 18:44:06:INFO:Start running cmcm...
2024-06-11 18:44:06:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 70, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 4444}>
2024-06-11 18:44:06:INFO:Let's use the GPU 1 !
2024-06-11 18:44:06:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 18:44:07:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718102647 HTTP/1.1" 200 235
2024-06-11 18:44:07:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 18:44:07:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 18:44:08:INFO:train samples: (1284,)
2024-06-11 18:44:08:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 18:44:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718102648 HTTP/1.1" 200 235
2024-06-11 18:44:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 18:44:09:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 18:44:09:INFO:valid samples: (229,)
2024-06-11 18:44:09:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 18:44:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718102650 HTTP/1.1" 200 235
2024-06-11 18:44:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 18:44:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 18:44:11:INFO:test samples: (686,)
2024-06-11 18:44:11:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 18:44:11:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718102651 HTTP/1.1" 200 235
2024-06-11 18:44:11:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 18:44:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 18:44:12:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 18:44:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718102652 HTTP/1.1" 200 235
2024-06-11 18:44:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 18:44:13:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 18:44:13:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-11 18:44:13:WARNING:Try importing flash-attention for faster inference...
2024-06-11 18:44:13:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-11 18:44:13:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-11 18:44:13:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-11 18:44:14:INFO:trainable params: 1310284 || all params: 1838138956 || trainable%: 0.07128318540461856
2024-06-11 18:44:14:INFO:Init labels...
2024-06-11 18:44:14:INFO:Start training...
2024-06-11 18:44:29:INFO:TRAIN-(cmcm) (1/1/4)>> loss: 2.5980
2024-06-11 18:44:31:INFO:VAL-(cmcm) >>
2024-06-11 18:44:31:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.5640  Non0_acc_2: 0.5741  Non0_F1_score: 0.5667  Mult_acc_5: 0.2402  Mult_acc_7: 0.2358  MAE: 1.4584  Corr: 0.0522 
2024-06-11 18:44:31:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-11 18:44:46:INFO:TRAIN-(cmcm) (1/2/4)>> loss: 1.0270
2024-06-11 18:44:49:INFO:VAL-(cmcm) >>
2024-06-11 18:44:49:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5741  Non0_F1_score: 0.4346  Mult_acc_5: 0.1790  Mult_acc_7: 0.1790  MAE: 1.4615  Corr: -0.0020 
2024-06-11 18:45:03:INFO:TRAIN-(cmcm) (2/3/4)>> loss: 1.0212
2024-06-11 18:45:06:INFO:VAL-(cmcm) >>
2024-06-11 18:45:06:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.5234  Non0_acc_2: 0.5787  Non0_F1_score: 0.5029  Mult_acc_5: 0.2882  Mult_acc_7: 0.2140  MAE: 1.5926  Corr: 0.0356 
2024-06-11 18:45:21:INFO:TRAIN-(cmcm) (3/4/4)>> loss: 1.0076
2024-06-11 18:45:23:INFO:VAL-(cmcm) >>
2024-06-11 18:45:23:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.4905  Non0_acc_2: 0.4583  Non0_F1_score: 0.3824  Mult_acc_5: 0.2140  Mult_acc_7: 0.2140  MAE: 1.4344  Corr: 0.0688 
2024-06-11 18:45:24:INFO:Saving checkpoint at epoch 4 to results/models/cmcm-mosi-regression.pth.
2024-06-11 18:45:39:INFO:TRAIN-(cmcm) (1/5/4)>> loss: 1.0377
2024-06-11 18:45:41:INFO:VAL-(cmcm) >>
2024-06-11 18:45:41:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4742  Non0_acc_2: 0.5370  Non0_F1_score: 0.4744  Mult_acc_5: 0.1659  Mult_acc_7: 0.1659  MAE: 1.4982  Corr: -0.0103 
2024-06-11 18:45:56:INFO:TRAIN-(cmcm) (2/6/4)>> loss: 0.9718
2024-06-11 18:45:58:INFO:VAL-(cmcm) >>
2024-06-11 18:45:58:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.4730  Non0_acc_2: 0.5556  Non0_F1_score: 0.4826  Mult_acc_5: 0.2314  Mult_acc_7: 0.2183  MAE: 1.4451  Corr: 0.0830 
2024-06-11 18:46:13:INFO:TRAIN-(cmcm) (3/7/4)>> loss: 0.9173
2024-06-11 18:46:16:INFO:VAL-(cmcm) >>
2024-06-11 18:46:16:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.5311  Non0_acc_2: 0.5602  Non0_F1_score: 0.5198  Mult_acc_5: 0.1790  Mult_acc_7: 0.1747  MAE: 1.5969  Corr: 0.0043 
2024-06-11 18:46:30:INFO:TRAIN-(cmcm) (4/8/4)>> loss: 0.8864
2024-06-11 18:46:33:INFO:VAL-(cmcm) >>
2024-06-11 18:46:33:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.6061  Non0_acc_2: 0.6019  Non0_F1_score: 0.6037  Mult_acc_5: 0.2227  Mult_acc_7: 0.1921  MAE: 1.5599  Corr: 0.2067 
2024-06-11 18:46:47:INFO:TRAIN-(cmcm) (5/9/4)>> loss: 0.8773
2024-06-11 18:46:50:INFO:VAL-(cmcm) >>
2024-06-11 18:46:50:INFO:M: >>  Has0_acc_2: 0.6550  Has0_F1_score: 0.6408  Non0_acc_2: 0.6435  Non0_F1_score: 0.6304  Mult_acc_5: 0.1878  Mult_acc_7: 0.1878  MAE: 1.4017  Corr: 0.1906 
2024-06-11 18:46:50:INFO:Saving checkpoint at epoch 9 to results/models/cmcm-mosi-regression.pth.
2024-06-11 18:47:05:INFO:TRAIN-(cmcm) (1/10/4)>> loss: 0.8705
2024-06-11 18:47:08:INFO:VAL-(cmcm) >>
2024-06-11 18:47:08:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.5348  Non0_acc_2: 0.5648  Non0_F1_score: 0.5201  Mult_acc_5: 0.2969  Mult_acc_7: 0.2140  MAE: 1.6743  Corr: 0.0561 
2024-06-11 18:47:23:INFO:TRAIN-(cmcm) (2/11/4)>> loss: 0.8633
2024-06-11 18:47:25:INFO:VAL-(cmcm) >>
2024-06-11 18:47:25:INFO:M: >>  Has0_acc_2: 0.6288  Has0_F1_score: 0.5923  Non0_acc_2: 0.6204  Non0_F1_score: 0.5868  Mult_acc_5: 0.3100  Mult_acc_7: 0.2314  MAE: 1.5643  Corr: 0.1520 
2024-06-11 18:47:40:INFO:TRAIN-(cmcm) (3/12/4)>> loss: 0.8593
2024-06-11 18:47:42:INFO:VAL-(cmcm) >>
2024-06-11 18:47:42:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5905  Non0_acc_2: 0.5787  Non0_F1_score: 0.5624  Mult_acc_5: 0.2314  Mult_acc_7: 0.2096  MAE: 1.4660  Corr: 0.2202 
2024-06-11 18:47:57:INFO:TRAIN-(cmcm) (4/13/4)>> loss: 0.8575
2024-06-11 18:47:59:INFO:VAL-(cmcm) >>
2024-06-11 18:47:59:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4630  Non0_acc_2: 0.5833  Non0_F1_score: 0.4542  Mult_acc_5: 0.2795  Mult_acc_7: 0.2271  MAE: 1.6180  Corr: -0.0120 
2024-06-11 18:48:14:INFO:TRAIN-(cmcm) (5/14/4)>> loss: 0.8447
2024-06-11 18:48:16:INFO:VAL-(cmcm) >>
2024-06-11 18:48:16:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.5005  Non0_acc_2: 0.5741  Non0_F1_score: 0.4742  Mult_acc_5: 0.2620  Mult_acc_7: 0.2052  MAE: 1.6167  Corr: 0.0590 
2024-06-11 18:48:31:INFO:TRAIN-(cmcm) (6/15/4)>> loss: 0.8501
2024-06-11 18:48:34:INFO:VAL-(cmcm) >>
2024-06-11 18:48:34:INFO:M: >>  Has0_acc_2: 0.6681  Has0_F1_score: 0.6343  Non0_acc_2: 0.6574  Non0_F1_score: 0.6222  Mult_acc_5: 0.3231  Mult_acc_7: 0.2314  MAE: 1.5027  Corr: 0.2396 
2024-06-11 18:48:49:INFO:TRAIN-(cmcm) (7/16/4)>> loss: 0.8463
2024-06-11 18:48:51:INFO:VAL-(cmcm) >>
2024-06-11 18:48:51:INFO:M: >>  Has0_acc_2: 0.6463  Has0_F1_score: 0.6374  Non0_acc_2: 0.6435  Non0_F1_score: 0.6433  Mult_acc_5: 0.2664  Mult_acc_7: 0.2314  MAE: 1.3637  Corr: 0.2884 
2024-06-11 18:48:52:INFO:Saving checkpoint at epoch 16 to results/models/cmcm-mosi-regression.pth.
2024-06-11 18:49:07:INFO:TRAIN-(cmcm) (1/17/4)>> loss: 0.8440
2024-06-11 18:49:09:INFO:VAL-(cmcm) >>
2024-06-11 18:49:09:INFO:M: >>  Has0_acc_2: 0.6157  Has0_F1_score: 0.5535  Non0_acc_2: 0.5972  Non0_F1_score: 0.5512  Mult_acc_5: 0.2271  Mult_acc_7: 0.2271  MAE: 1.3804  Corr: 0.2292 
2024-06-11 18:49:24:INFO:TRAIN-(cmcm) (2/18/4)>> loss: 0.8337
2024-06-11 18:49:26:INFO:VAL-(cmcm) >>
2024-06-11 18:49:26:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4855  Non0_acc_2: 0.5787  Non0_F1_score: 0.4584  Mult_acc_5: 0.2533  Mult_acc_7: 0.2052  MAE: 1.5966  Corr: 0.1016 
2024-06-11 18:49:41:INFO:TRAIN-(cmcm) (3/19/4)>> loss: 0.8347
2024-06-11 18:49:44:INFO:VAL-(cmcm) >>
2024-06-11 18:49:44:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.4814  Non0_acc_2: 0.6065  Non0_F1_score: 0.5978  Mult_acc_5: 0.2358  Mult_acc_7: 0.2314  MAE: 1.4132  Corr: 0.1055 
2024-06-11 18:49:58:INFO:TRAIN-(cmcm) (4/20/4)>> loss: 0.8391
2024-06-11 18:50:01:INFO:VAL-(cmcm) >>
2024-06-11 18:50:01:INFO:M: >>  Has0_acc_2: 0.6332  Has0_F1_score: 0.6301  Non0_acc_2: 0.6111  Non0_F1_score: 0.6124  Mult_acc_5: 0.2358  Mult_acc_7: 0.1878  MAE: 1.5359  Corr: 0.2098 
2024-06-11 18:50:15:INFO:TRAIN-(cmcm) (5/21/4)>> loss: 0.8279
2024-06-11 18:50:18:INFO:VAL-(cmcm) >>
2024-06-11 18:50:18:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.5024  Non0_acc_2: 0.5880  Non0_F1_score: 0.5224  Mult_acc_5: 0.2576  Mult_acc_7: 0.2096  MAE: 1.6320  Corr: 0.0168 
2024-06-11 18:50:32:INFO:TRAIN-(cmcm) (6/22/4)>> loss: 0.8327
2024-06-11 18:50:35:INFO:VAL-(cmcm) >>
2024-06-11 18:50:35:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.5727  Non0_acc_2: 0.5972  Non0_F1_score: 0.5748  Mult_acc_5: 0.2140  Mult_acc_7: 0.1921  MAE: 1.5359  Corr: 0.1074 
2024-06-11 18:50:50:INFO:TRAIN-(cmcm) (7/23/4)>> loss: 0.8168
2024-06-11 18:50:52:INFO:VAL-(cmcm) >>
2024-06-11 18:50:52:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.5278  Non0_acc_2: 0.5926  Non0_F1_score: 0.5374  Mult_acc_5: 0.3013  Mult_acc_7: 0.2227  MAE: 1.7477  Corr: 0.1206 
2024-06-11 18:51:07:INFO:TRAIN-(cmcm) (8/24/4)>> loss: 0.8149
2024-06-11 18:51:09:INFO:VAL-(cmcm) >>
2024-06-11 18:51:09:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4978  Non0_acc_2: 0.5833  Non0_F1_score: 0.5150  Mult_acc_5: 0.2620  Mult_acc_7: 0.2358  MAE: 1.4341  Corr: 0.1904 
2024-06-11 18:51:24:INFO:TRAIN-(cmcm) (9/25/4)>> loss: 0.8084
2024-06-11 18:51:26:INFO:VAL-(cmcm) >>
2024-06-11 18:51:26:INFO:M: >>  Has0_acc_2: 0.6157  Has0_F1_score: 0.5608  Non0_acc_2: 0.6435  Non0_F1_score: 0.6108  Mult_acc_5: 0.3231  Mult_acc_7: 0.2533  MAE: 1.4957  Corr: 0.1818 
2024-06-11 18:51:41:INFO:TRAIN-(cmcm) (10/26/4)>> loss: 0.7918
2024-06-11 18:51:43:INFO:VAL-(cmcm) >>
2024-06-11 18:51:43:INFO:M: >>  Has0_acc_2: 0.6201  Has0_F1_score: 0.6009  Non0_acc_2: 0.6435  Non0_F1_score: 0.6345  Mult_acc_5: 0.2969  Mult_acc_7: 0.2271  MAE: 1.4909  Corr: 0.2679 
2024-06-11 18:51:51:INFO:TEST-(cmcm) >>
2024-06-11 18:51:51:INFO:M: >>  Has0_acc_2: 0.5831  Has0_F1_score: 0.5842  Non0_acc_2: 0.6113  Non0_F1_score: 0.6094  Mult_acc_5: 0.2580  Mult_acc_7: 0.2391  MAE: 1.3761  Corr: 0.2381 
2024-06-11 18:51:51:INFO:Results are added to results/results/mosi-regression-70.csv...
2024-06-11 18:51:51:INFO:Start running cmcm...
2024-06-11 18:51:51:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 70, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 5555}>
2024-06-11 18:51:51:INFO:Let's use the GPU 1 !
2024-06-11 18:51:51:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 18:51:52:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718103112 HTTP/1.1" 200 235
2024-06-11 18:51:52:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 18:51:52:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 18:51:53:INFO:train samples: (1284,)
2024-06-11 18:51:53:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 18:51:53:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718103113 HTTP/1.1" 200 235
2024-06-11 18:51:53:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 18:51:54:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 18:51:54:INFO:valid samples: (229,)
2024-06-11 18:51:54:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 18:51:55:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718103115 HTTP/1.1" 200 235
2024-06-11 18:51:55:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 18:51:56:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 18:51:56:INFO:test samples: (686,)
2024-06-11 18:51:56:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 18:51:56:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718103117 HTTP/1.1" 200 235
2024-06-11 18:51:56:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 18:51:57:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 18:51:57:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 18:51:58:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718103118 HTTP/1.1" 200 235
2024-06-11 18:51:58:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 18:51:58:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 18:51:58:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-11 18:51:58:WARNING:Try importing flash-attention for faster inference...
2024-06-11 18:51:58:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-11 18:51:58:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-11 18:51:58:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-11 18:52:00:INFO:trainable params: 1310284 || all params: 1838138956 || trainable%: 0.07128318540461856
2024-06-11 18:52:00:INFO:Init labels...
2024-06-11 18:52:00:INFO:Start training...
2024-06-11 18:52:14:INFO:TRAIN-(cmcm) (1/1/5)>> loss: 2.1615
2024-06-11 18:52:17:INFO:VAL-(cmcm) >>
2024-06-11 18:52:17:INFO:M: >>  Has0_acc_2: 0.5109  Has0_F1_score: 0.5105  Non0_acc_2: 0.5231  Non0_F1_score: 0.5213  Mult_acc_5: 0.2183  Mult_acc_7: 0.1659  MAE: 1.8074  Corr: 0.0292 
2024-06-11 18:52:17:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-11 18:52:32:INFO:TRAIN-(cmcm) (1/2/5)>> loss: 0.9714
2024-06-11 18:52:35:INFO:VAL-(cmcm) >>
2024-06-11 18:52:35:INFO:M: >>  Has0_acc_2: 0.4934  Has0_F1_score: 0.4971  Non0_acc_2: 0.4630  Non0_F1_score: 0.4569  Mult_acc_5: 0.1878  Mult_acc_7: 0.1834  MAE: 1.6777  Corr: -0.0766 
2024-06-11 18:52:35:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-11 18:52:50:INFO:TRAIN-(cmcm) (1/3/5)>> loss: 0.9103
2024-06-11 18:52:53:INFO:VAL-(cmcm) >>
2024-06-11 18:52:53:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4534  Non0_acc_2: 0.5787  Non0_F1_score: 0.4584  Mult_acc_5: 0.2926  Mult_acc_7: 0.2358  MAE: 1.6423  Corr: 0.0214 
2024-06-11 18:52:53:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-mosi-regression.pth.
2024-06-11 18:53:08:INFO:TRAIN-(cmcm) (1/4/5)>> loss: 0.8815
2024-06-11 18:53:11:INFO:VAL-(cmcm) >>
2024-06-11 18:53:11:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5109  Non0_acc_2: 0.5602  Non0_F1_score: 0.4945  Mult_acc_5: 0.2838  Mult_acc_7: 0.2096  MAE: 1.7983  Corr: -0.0078 
2024-06-11 18:53:25:INFO:TRAIN-(cmcm) (2/5/5)>> loss: 0.8694
2024-06-11 18:53:28:INFO:VAL-(cmcm) >>
2024-06-11 18:53:28:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4700  Non0_acc_2: 0.4907  Non0_F1_score: 0.4466  Mult_acc_5: 0.2271  Mult_acc_7: 0.2271  MAE: 1.4571  Corr: 0.0030 
2024-06-11 18:53:28:INFO:Saving checkpoint at epoch 5 to results/models/cmcm-mosi-regression.pth.
2024-06-11 18:53:43:INFO:TRAIN-(cmcm) (1/6/5)>> loss: 0.8689
2024-06-11 18:53:46:INFO:VAL-(cmcm) >>
2024-06-11 18:53:46:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5028  Non0_acc_2: 0.5556  Non0_F1_score: 0.4826  Mult_acc_5: 0.3057  Mult_acc_7: 0.2227  MAE: 1.7132  Corr: 0.0059 
2024-06-11 18:54:01:INFO:TRAIN-(cmcm) (2/7/5)>> loss: 0.8732
2024-06-11 18:54:03:INFO:VAL-(cmcm) >>
2024-06-11 18:54:03:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.5292  Non0_acc_2: 0.5833  Non0_F1_score: 0.5106  Mult_acc_5: 0.3144  Mult_acc_7: 0.2358  MAE: 1.6743  Corr: 0.0555 
2024-06-11 18:54:18:INFO:TRAIN-(cmcm) (3/8/5)>> loss: 0.8621
2024-06-11 18:54:20:INFO:VAL-(cmcm) >>
2024-06-11 18:54:20:INFO:M: >>  Has0_acc_2: 0.4847  Has0_F1_score: 0.4462  Non0_acc_2: 0.5093  Non0_F1_score: 0.4726  Mult_acc_5: 0.2358  Mult_acc_7: 0.2009  MAE: 1.7551  Corr: 0.1189 
2024-06-11 18:54:35:INFO:TRAIN-(cmcm) (4/9/5)>> loss: 0.8604
2024-06-11 18:54:38:INFO:VAL-(cmcm) >>
2024-06-11 18:54:38:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.5215  Non0_acc_2: 0.5648  Non0_F1_score: 0.5097  Mult_acc_5: 0.2969  Mult_acc_7: 0.2183  MAE: 1.6892  Corr: -0.0043 
2024-06-11 18:54:52:INFO:TRAIN-(cmcm) (5/10/5)>> loss: 0.8534
2024-06-11 18:54:55:INFO:VAL-(cmcm) >>
2024-06-11 18:54:55:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5381  Non0_acc_2: 0.5694  Non0_F1_score: 0.5236  Mult_acc_5: 0.2795  Mult_acc_7: 0.1965  MAE: 1.7057  Corr: 0.0310 
2024-06-11 18:55:10:INFO:TRAIN-(cmcm) (6/11/5)>> loss: 0.8495
2024-06-11 18:55:12:INFO:VAL-(cmcm) >>
2024-06-11 18:55:12:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.5727  Non0_acc_2: 0.5926  Non0_F1_score: 0.5643  Mult_acc_5: 0.2795  Mult_acc_7: 0.2009  MAE: 1.7280  Corr: 0.0469 
2024-06-11 18:55:27:INFO:TRAIN-(cmcm) (7/12/5)>> loss: 0.8459
2024-06-11 18:55:29:INFO:VAL-(cmcm) >>
2024-06-11 18:55:29:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5100  Non0_acc_2: 0.5694  Non0_F1_score: 0.4871  Mult_acc_5: 0.2926  Mult_acc_7: 0.2096  MAE: 1.7625  Corr: 0.0013 
2024-06-11 18:55:44:INFO:TRAIN-(cmcm) (8/13/5)>> loss: 0.8523
2024-06-11 18:55:46:INFO:VAL-(cmcm) >>
2024-06-11 18:55:46:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4577  Non0_acc_2: 0.6296  Non0_F1_score: 0.5689  Mult_acc_5: 0.2838  Mult_acc_7: 0.2183  MAE: 1.4896  Corr: 0.1749 
2024-06-11 18:56:01:INFO:TRAIN-(cmcm) (9/14/5)>> loss: 0.8466
2024-06-11 18:56:04:INFO:VAL-(cmcm) >>
2024-06-11 18:56:04:INFO:M: >>  Has0_acc_2: 0.5546  Has0_F1_score: 0.5213  Non0_acc_2: 0.5787  Non0_F1_score: 0.5460  Mult_acc_5: 0.2707  Mult_acc_7: 0.2140  MAE: 1.5193  Corr: 0.3268 
2024-06-11 18:56:18:INFO:TRAIN-(cmcm) (10/15/5)>> loss: 0.8264
2024-06-11 18:56:21:INFO:VAL-(cmcm) >>
2024-06-11 18:56:21:INFO:M: >>  Has0_acc_2: 0.6856  Has0_F1_score: 0.6558  Non0_acc_2: 0.6852  Non0_F1_score: 0.6633  Mult_acc_5: 0.3231  Mult_acc_7: 0.2664  MAE: 1.2333  Corr: 0.4536 
2024-06-11 18:56:21:INFO:Saving checkpoint at epoch 15 to results/models/cmcm-mosi-regression.pth.
2024-06-11 18:56:37:INFO:TRAIN-(cmcm) (1/16/5)>> loss: 0.8086
2024-06-11 18:56:39:INFO:VAL-(cmcm) >>
2024-06-11 18:56:39:INFO:M: >>  Has0_acc_2: 0.7118  Has0_F1_score: 0.7029  Non0_acc_2: 0.7269  Non0_F1_score: 0.7246  Mult_acc_5: 0.4323  Mult_acc_7: 0.3406  MAE: 1.1333  Corr: 0.5079 
2024-06-11 18:56:39:INFO:Saving checkpoint at epoch 16 to results/models/cmcm-mosi-regression.pth.
2024-06-11 18:56:55:INFO:TRAIN-(cmcm) (1/17/5)>> loss: 0.7913
2024-06-11 18:56:57:INFO:VAL-(cmcm) >>
2024-06-11 18:56:57:INFO:M: >>  Has0_acc_2: 0.6507  Has0_F1_score: 0.6456  Non0_acc_2: 0.6574  Non0_F1_score: 0.6449  Mult_acc_5: 0.3319  Mult_acc_7: 0.2620  MAE: 1.2189  Corr: 0.5088 
2024-06-11 18:57:12:INFO:TRAIN-(cmcm) (2/18/5)>> loss: 0.7825
2024-06-11 18:57:14:INFO:VAL-(cmcm) >>
2024-06-11 18:57:14:INFO:M: >>  Has0_acc_2: 0.7380  Has0_F1_score: 0.7343  Non0_acc_2: 0.7685  Non0_F1_score: 0.7630  Mult_acc_5: 0.3974  Mult_acc_7: 0.3013  MAE: 1.1363  Corr: 0.5577 
2024-06-11 18:57:29:INFO:TRAIN-(cmcm) (3/19/5)>> loss: 0.7730
2024-06-11 18:57:31:INFO:VAL-(cmcm) >>
2024-06-11 18:57:31:INFO:M: >>  Has0_acc_2: 0.7424  Has0_F1_score: 0.7368  Non0_acc_2: 0.6667  Non0_F1_score: 0.6650  Mult_acc_5: 0.3974  Mult_acc_7: 0.3188  MAE: 1.0979  Corr: 0.5610 
2024-06-11 18:57:32:INFO:Saving checkpoint at epoch 19 to results/models/cmcm-mosi-regression.pth.
2024-06-11 18:57:47:INFO:TRAIN-(cmcm) (1/20/5)>> loss: 0.7577
2024-06-11 18:57:49:INFO:VAL-(cmcm) >>
2024-06-11 18:57:49:INFO:M: >>  Has0_acc_2: 0.7467  Has0_F1_score: 0.7472  Non0_acc_2: 0.7593  Non0_F1_score: 0.7606  Mult_acc_5: 0.4105  Mult_acc_7: 0.3144  MAE: 1.1167  Corr: 0.5810 
2024-06-11 18:58:04:INFO:TRAIN-(cmcm) (2/21/5)>> loss: 0.7577
2024-06-11 18:58:07:INFO:VAL-(cmcm) >>
2024-06-11 18:58:07:INFO:M: >>  Has0_acc_2: 0.7031  Has0_F1_score: 0.6989  Non0_acc_2: 0.7407  Non0_F1_score: 0.7383  Mult_acc_5: 0.4192  Mult_acc_7: 0.3231  MAE: 1.1305  Corr: 0.5335 
2024-06-11 18:58:21:INFO:TRAIN-(cmcm) (3/22/5)>> loss: 0.7407
2024-06-11 18:58:24:INFO:VAL-(cmcm) >>
2024-06-11 18:58:24:INFO:M: >>  Has0_acc_2: 0.7031  Has0_F1_score: 0.7051  Non0_acc_2: 0.7176  Non0_F1_score: 0.7159  Mult_acc_5: 0.3886  Mult_acc_7: 0.3188  MAE: 1.0769  Corr: 0.5643 
2024-06-11 18:58:24:INFO:Saving checkpoint at epoch 22 to results/models/cmcm-mosi-regression.pth.
2024-06-11 18:58:39:INFO:TRAIN-(cmcm) (1/23/5)>> loss: 0.7367
2024-06-11 18:58:42:INFO:VAL-(cmcm) >>
2024-06-11 18:58:42:INFO:M: >>  Has0_acc_2: 0.7424  Has0_F1_score: 0.7442  Non0_acc_2: 0.7222  Non0_F1_score: 0.7209  Mult_acc_5: 0.3799  Mult_acc_7: 0.3144  MAE: 1.0493  Corr: 0.6151 
2024-06-11 18:58:42:INFO:Saving checkpoint at epoch 23 to results/models/cmcm-mosi-regression.pth.
2024-06-11 18:58:57:INFO:TRAIN-(cmcm) (1/24/5)>> loss: 0.7365
2024-06-11 18:59:00:INFO:VAL-(cmcm) >>
2024-06-11 18:59:00:INFO:M: >>  Has0_acc_2: 0.7249  Has0_F1_score: 0.7266  Non0_acc_2: 0.6528  Non0_F1_score: 0.6455  Mult_acc_5: 0.3843  Mult_acc_7: 0.3013  MAE: 1.1184  Corr: 0.5616 
2024-06-11 18:59:14:INFO:TRAIN-(cmcm) (2/25/5)>> loss: 0.7204
2024-06-11 18:59:17:INFO:VAL-(cmcm) >>
2024-06-11 18:59:17:INFO:M: >>  Has0_acc_2: 0.7424  Has0_F1_score: 0.7398  Non0_acc_2: 0.7500  Non0_F1_score: 0.7500  Mult_acc_5: 0.4498  Mult_acc_7: 0.3537  MAE: 1.1101  Corr: 0.5787 
2024-06-11 18:59:32:INFO:TRAIN-(cmcm) (3/26/5)>> loss: 0.7130
2024-06-11 18:59:34:INFO:VAL-(cmcm) >>
2024-06-11 18:59:34:INFO:M: >>  Has0_acc_2: 0.7293  Has0_F1_score: 0.7187  Non0_acc_2: 0.7361  Non0_F1_score: 0.7303  Mult_acc_5: 0.4061  Mult_acc_7: 0.3406  MAE: 1.0573  Corr: 0.5856 
2024-06-11 18:59:49:INFO:TRAIN-(cmcm) (4/27/5)>> loss: 0.7106
2024-06-11 18:59:51:INFO:VAL-(cmcm) >>
2024-06-11 18:59:51:INFO:M: >>  Has0_acc_2: 0.7162  Has0_F1_score: 0.7186  Non0_acc_2: 0.6806  Non0_F1_score: 0.6748  Mult_acc_5: 0.3974  Mult_acc_7: 0.3275  MAE: 1.0785  Corr: 0.5858 
2024-06-11 19:00:06:INFO:TRAIN-(cmcm) (5/28/5)>> loss: 0.7093
2024-06-11 19:00:08:INFO:VAL-(cmcm) >>
2024-06-11 19:00:08:INFO:M: >>  Has0_acc_2: 0.7162  Has0_F1_score: 0.7189  Non0_acc_2: 0.6991  Non0_F1_score: 0.6945  Mult_acc_5: 0.3843  Mult_acc_7: 0.3057  MAE: 1.1140  Corr: 0.5855 
2024-06-11 19:00:23:INFO:TRAIN-(cmcm) (6/29/5)>> loss: 0.6905
2024-06-11 19:00:25:INFO:VAL-(cmcm) >>
2024-06-11 19:00:25:INFO:M: >>  Has0_acc_2: 0.7249  Has0_F1_score: 0.7148  Non0_acc_2: 0.7176  Non0_F1_score: 0.7189  Mult_acc_5: 0.3668  Mult_acc_7: 0.3144  MAE: 1.0750  Corr: 0.5646 
2024-06-11 19:00:40:INFO:TRAIN-(cmcm) (7/30/5)>> loss: 0.6934
2024-06-11 19:00:43:INFO:VAL-(cmcm) >>
2024-06-11 19:00:43:INFO:M: >>  Has0_acc_2: 0.7424  Has0_F1_score: 0.7391  Non0_acc_2: 0.7639  Non0_F1_score: 0.7625  Mult_acc_5: 0.4891  Mult_acc_7: 0.3974  MAE: 0.9868  Corr: 0.6308 
2024-06-11 19:00:43:INFO:Saving checkpoint at epoch 30 to results/models/cmcm-mosi-regression.pth.
2024-06-11 19:00:58:INFO:TRAIN-(cmcm) (1/31/5)>> loss: 0.6772
2024-06-11 19:01:01:INFO:VAL-(cmcm) >>
2024-06-11 19:01:01:INFO:M: >>  Has0_acc_2: 0.7380  Has0_F1_score: 0.7278  Non0_acc_2: 0.7685  Non0_F1_score: 0.7658  Mult_acc_5: 0.4279  Mult_acc_7: 0.3493  MAE: 1.0510  Corr: 0.6011 
2024-06-11 19:01:16:INFO:TRAIN-(cmcm) (2/32/5)>> loss: 0.6757
2024-06-11 19:01:18:INFO:VAL-(cmcm) >>
2024-06-11 19:01:18:INFO:M: >>  Has0_acc_2: 0.7336  Has0_F1_score: 0.7350  Non0_acc_2: 0.7546  Non0_F1_score: 0.7560  Mult_acc_5: 0.3581  Mult_acc_7: 0.2882  MAE: 1.0628  Corr: 0.6005 
2024-06-11 19:01:33:INFO:TRAIN-(cmcm) (3/33/5)>> loss: 0.6752
2024-06-11 19:01:35:INFO:VAL-(cmcm) >>
2024-06-11 19:01:35:INFO:M: >>  Has0_acc_2: 0.7293  Has0_F1_score: 0.7199  Non0_acc_2: 0.7500  Non0_F1_score: 0.7432  Mult_acc_5: 0.4192  Mult_acc_7: 0.3362  MAE: 1.0584  Corr: 0.6010 
2024-06-11 19:01:50:INFO:TRAIN-(cmcm) (4/34/5)>> loss: 0.6520
2024-06-11 19:01:53:INFO:VAL-(cmcm) >>
2024-06-11 19:01:53:INFO:M: >>  Has0_acc_2: 0.7380  Has0_F1_score: 0.7395  Non0_acc_2: 0.7315  Non0_F1_score: 0.7328  Mult_acc_5: 0.3799  Mult_acc_7: 0.3057  MAE: 1.1271  Corr: 0.5454 
2024-06-11 19:02:07:INFO:TRAIN-(cmcm) (5/35/5)>> loss: 0.6424
2024-06-11 19:02:10:INFO:VAL-(cmcm) >>
2024-06-11 19:02:10:INFO:M: >>  Has0_acc_2: 0.7205  Has0_F1_score: 0.7108  Non0_acc_2: 0.7130  Non0_F1_score: 0.7062  Mult_acc_5: 0.4279  Mult_acc_7: 0.3362  MAE: 1.1424  Corr: 0.5174 
2024-06-11 19:02:24:INFO:TRAIN-(cmcm) (6/36/5)>> loss: 0.6363
2024-06-11 19:02:27:INFO:VAL-(cmcm) >>
2024-06-11 19:02:27:INFO:M: >>  Has0_acc_2: 0.7162  Has0_F1_score: 0.7090  Non0_acc_2: 0.7454  Non0_F1_score: 0.7433  Mult_acc_5: 0.4323  Mult_acc_7: 0.3450  MAE: 1.1520  Corr: 0.5410 
2024-06-11 19:02:41:INFO:TRAIN-(cmcm) (7/37/5)>> loss: 0.6314
2024-06-11 19:02:44:INFO:VAL-(cmcm) >>
2024-06-11 19:02:44:INFO:M: >>  Has0_acc_2: 0.7249  Has0_F1_score: 0.7246  Non0_acc_2: 0.7315  Non0_F1_score: 0.7311  Mult_acc_5: 0.4236  Mult_acc_7: 0.3450  MAE: 1.0755  Corr: 0.5577 
2024-06-11 19:02:58:INFO:TRAIN-(cmcm) (8/38/5)>> loss: 0.6099
2024-06-11 19:03:01:INFO:VAL-(cmcm) >>
2024-06-11 19:03:01:INFO:M: >>  Has0_acc_2: 0.7031  Has0_F1_score: 0.7044  Non0_acc_2: 0.6944  Non0_F1_score: 0.6960  Mult_acc_5: 0.3799  Mult_acc_7: 0.3144  MAE: 1.0833  Corr: 0.5881 
2024-06-11 19:03:16:INFO:TRAIN-(cmcm) (9/39/5)>> loss: 0.6139
2024-06-11 19:03:19:INFO:VAL-(cmcm) >>
2024-06-11 19:03:19:INFO:M: >>  Has0_acc_2: 0.7162  Has0_F1_score: 0.7109  Non0_acc_2: 0.7083  Non0_F1_score: 0.7098  Mult_acc_5: 0.3886  Mult_acc_7: 0.3231  MAE: 1.1126  Corr: 0.5276 
2024-06-11 19:03:33:INFO:TRAIN-(cmcm) (10/40/5)>> loss: 0.6028
2024-06-11 19:03:36:INFO:VAL-(cmcm) >>
2024-06-11 19:03:36:INFO:M: >>  Has0_acc_2: 0.7205  Has0_F1_score: 0.7166  Non0_acc_2: 0.7083  Non0_F1_score: 0.7059  Mult_acc_5: 0.4279  Mult_acc_7: 0.3668  MAE: 1.1079  Corr: 0.5285 
2024-06-11 19:03:43:INFO:TEST-(cmcm) >>
2024-06-11 19:03:43:INFO:M: >>  Has0_acc_2: 0.7362  Has0_F1_score: 0.7368  Non0_acc_2: 0.7698  Non0_F1_score: 0.7711  Mult_acc_5: 0.3717  Mult_acc_7: 0.3163  MAE: 1.0655  Corr: 0.5682 
2024-06-11 19:03:44:INFO:Results are added to results/results/mosi-regression-70.csv...
2024-06-11 19:03:44:INFO:Start running cmcm...
2024-06-11 19:03:44:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 80, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-06-11 19:03:44:INFO:Let's use the GPU 1 !
2024-06-11 19:03:44:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 19:03:44:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718103824 HTTP/1.1" 200 235
2024-06-11 19:03:44:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 19:03:44:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 19:03:45:INFO:train samples: (1284,)
2024-06-11 19:03:45:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 19:03:46:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718103826 HTTP/1.1" 200 235
2024-06-11 19:03:46:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 19:03:46:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 19:03:47:INFO:valid samples: (229,)
2024-06-11 19:03:47:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 19:03:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718103827 HTTP/1.1" 200 235
2024-06-11 19:03:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 19:03:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 19:03:48:INFO:test samples: (686,)
2024-06-11 19:03:48:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 19:03:49:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718103829 HTTP/1.1" 200 235
2024-06-11 19:03:49:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 19:03:49:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 19:03:50:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 19:03:50:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718103830 HTTP/1.1" 200 235
2024-06-11 19:03:50:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 19:03:51:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 19:03:51:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-11 19:03:51:WARNING:Try importing flash-attention for faster inference...
2024-06-11 19:03:51:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-11 19:03:51:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-11 19:03:51:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-11 19:03:52:INFO:trainable params: 1310284 || all params: 1838138956 || trainable%: 0.07128318540461856
2024-06-11 19:03:52:INFO:Init labels...
2024-06-11 19:03:52:INFO:Start training...
2024-06-11 19:04:07:INFO:TRAIN-(cmcm) (1/1/1)>> loss: 2.2320
2024-06-11 19:04:09:INFO:VAL-(cmcm) >>
2024-06-11 19:04:09:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.4513  Non0_acc_2: 0.5694  Non0_F1_score: 0.4595  Mult_acc_5: 0.1834  Mult_acc_7: 0.1834  MAE: 1.5956  Corr: -0.0464 
2024-06-11 19:04:09:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-11 19:04:24:INFO:TRAIN-(cmcm) (1/2/1)>> loss: 0.9474
2024-06-11 19:04:27:INFO:VAL-(cmcm) >>
2024-06-11 19:04:27:INFO:M: >>  Has0_acc_2: 0.5633  Has0_F1_score: 0.5633  Non0_acc_2: 0.5556  Non0_F1_score: 0.5541  Mult_acc_5: 0.2620  Mult_acc_7: 0.2052  MAE: 1.8175  Corr: 0.0327 
2024-06-11 19:04:42:INFO:TRAIN-(cmcm) (2/3/1)>> loss: 0.9401
2024-06-11 19:04:44:INFO:VAL-(cmcm) >>
2024-06-11 19:04:44:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.5314  Non0_acc_2: 0.5602  Non0_F1_score: 0.5063  Mult_acc_5: 0.2664  Mult_acc_7: 0.2183  MAE: 1.7075  Corr: -0.0032 
2024-06-11 19:04:59:INFO:TRAIN-(cmcm) (3/4/1)>> loss: 0.8959
2024-06-11 19:05:01:INFO:VAL-(cmcm) >>
2024-06-11 19:05:01:INFO:M: >>  Has0_acc_2: 0.5546  Has0_F1_score: 0.5391  Non0_acc_2: 0.5463  Non0_F1_score: 0.5286  Mult_acc_5: 0.2576  Mult_acc_7: 0.1747  MAE: 1.7660  Corr: 0.0391 
2024-06-11 19:05:16:INFO:TRAIN-(cmcm) (4/5/1)>> loss: 0.8973
2024-06-11 19:05:18:INFO:VAL-(cmcm) >>
2024-06-11 19:05:19:INFO:M: >>  Has0_acc_2: 0.4934  Has0_F1_score: 0.4921  Non0_acc_2: 0.5093  Non0_F1_score: 0.5069  Mult_acc_5: 0.2402  Mult_acc_7: 0.1878  MAE: 1.6455  Corr: 0.0914 
2024-06-11 19:05:33:INFO:TRAIN-(cmcm) (5/6/1)>> loss: 0.8810
2024-06-11 19:05:36:INFO:VAL-(cmcm) >>
2024-06-11 19:05:36:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5315  Non0_acc_2: 0.5556  Non0_F1_score: 0.5132  Mult_acc_5: 0.2664  Mult_acc_7: 0.2140  MAE: 1.7424  Corr: 0.0117 
2024-06-11 19:05:50:INFO:TRAIN-(cmcm) (6/7/1)>> loss: 0.8882
2024-06-11 19:05:53:INFO:VAL-(cmcm) >>
2024-06-11 19:05:53:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5449  Non0_acc_2: 0.5370  Non0_F1_score: 0.5370  Mult_acc_5: 0.1703  Mult_acc_7: 0.1572  MAE: 1.4925  Corr: 0.0821 
2024-06-11 19:05:53:INFO:Saving checkpoint at epoch 7 to results/models/cmcm-mosi-regression.pth.
2024-06-11 19:06:08:INFO:TRAIN-(cmcm) (1/8/1)>> loss: 0.8737
2024-06-11 19:06:11:INFO:VAL-(cmcm) >>
2024-06-11 19:06:11:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4630  Non0_acc_2: 0.5741  Non0_F1_score: 0.4346  Mult_acc_5: 0.3057  Mult_acc_7: 0.2227  MAE: 1.7520  Corr: -0.0067 
2024-06-11 19:06:25:INFO:TRAIN-(cmcm) (2/9/1)>> loss: 0.8733
2024-06-11 19:06:28:INFO:VAL-(cmcm) >>
2024-06-11 19:06:28:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4630  Non0_acc_2: 0.5741  Non0_F1_score: 0.4346  Mult_acc_5: 0.3013  Mult_acc_7: 0.2227  MAE: 1.7267  Corr: 0.0710 
2024-06-11 19:06:42:INFO:TRAIN-(cmcm) (3/10/1)>> loss: 0.8669
2024-06-11 19:06:45:INFO:VAL-(cmcm) >>
2024-06-11 19:06:45:INFO:M: >>  Has0_acc_2: 0.5328  Has0_F1_score: 0.5304  Non0_acc_2: 0.5324  Non0_F1_score: 0.5275  Mult_acc_5: 0.2445  Mult_acc_7: 0.1572  MAE: 1.8835  Corr: 0.0041 
2024-06-11 19:07:00:INFO:TRAIN-(cmcm) (4/11/1)>> loss: 0.8605
2024-06-11 19:07:02:INFO:VAL-(cmcm) >>
2024-06-11 19:07:02:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.5437  Non0_acc_2: 0.4352  Non0_F1_score: 0.3488  Mult_acc_5: 0.2052  Mult_acc_7: 0.2009  MAE: 1.4903  Corr: 0.0218 
2024-06-11 19:07:02:INFO:Saving checkpoint at epoch 11 to results/models/cmcm-mosi-regression.pth.
2024-06-11 19:07:17:INFO:TRAIN-(cmcm) (1/12/1)>> loss: 0.8607
2024-06-11 19:07:20:INFO:VAL-(cmcm) >>
2024-06-11 19:07:20:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5219  Non0_acc_2: 0.5556  Non0_F1_score: 0.5030  Mult_acc_5: 0.2926  Mult_acc_7: 0.2140  MAE: 1.8359  Corr: -0.0171 
2024-06-11 19:07:35:INFO:TRAIN-(cmcm) (2/13/1)>> loss: 0.8554
2024-06-11 19:07:37:INFO:VAL-(cmcm) >>
2024-06-11 19:07:37:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5282  Non0_acc_2: 0.5556  Non0_F1_score: 0.5163  Mult_acc_5: 0.3057  Mult_acc_7: 0.2314  MAE: 1.6800  Corr: 0.0199 
2024-06-11 19:07:52:INFO:TRAIN-(cmcm) (3/14/1)>> loss: 0.8570
2024-06-11 19:07:54:INFO:VAL-(cmcm) >>
2024-06-11 19:07:54:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.4924  Non0_acc_2: 0.5556  Non0_F1_score: 0.4627  Mult_acc_5: 0.2969  Mult_acc_7: 0.2140  MAE: 1.6848  Corr: -0.0123 
2024-06-11 19:08:09:INFO:TRAIN-(cmcm) (4/15/1)>> loss: 0.8555
2024-06-11 19:08:11:INFO:VAL-(cmcm) >>
2024-06-11 19:08:11:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.4996  Non0_acc_2: 0.5648  Non0_F1_score: 0.4841  Mult_acc_5: 0.2882  Mult_acc_7: 0.2096  MAE: 1.7267  Corr: -0.0220 
2024-06-11 19:08:26:INFO:TRAIN-(cmcm) (5/16/1)>> loss: 0.8504
2024-06-11 19:08:29:INFO:VAL-(cmcm) >>
2024-06-11 19:08:29:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.5445  Non0_acc_2: 0.5833  Non0_F1_score: 0.5269  Mult_acc_5: 0.2838  Mult_acc_7: 0.2009  MAE: 1.7084  Corr: 0.0601 
2024-06-11 19:08:43:INFO:TRAIN-(cmcm) (6/17/1)>> loss: 0.8488
2024-06-11 19:08:46:INFO:VAL-(cmcm) >>
2024-06-11 19:08:46:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4723  Non0_acc_2: 0.5972  Non0_F1_score: 0.4944  Mult_acc_5: 0.2751  Mult_acc_7: 0.2227  MAE: 1.5451  Corr: 0.1372 
2024-06-11 19:09:00:INFO:TRAIN-(cmcm) (7/18/1)>> loss: 0.8372
2024-06-11 19:09:03:INFO:VAL-(cmcm) >>
2024-06-11 19:09:03:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5109  Non0_acc_2: 0.5509  Non0_F1_score: 0.4881  Mult_acc_5: 0.2707  Mult_acc_7: 0.1834  MAE: 1.8328  Corr: -0.0051 
2024-06-11 19:09:18:INFO:TRAIN-(cmcm) (8/19/1)>> loss: 0.8367
2024-06-11 19:09:20:INFO:VAL-(cmcm) >>
2024-06-11 19:09:20:INFO:M: >>  Has0_acc_2: 0.6157  Has0_F1_score: 0.5535  Non0_acc_2: 0.5833  Non0_F1_score: 0.5306  Mult_acc_5: 0.3057  Mult_acc_7: 0.2314  MAE: 1.6110  Corr: 0.1562 
2024-06-11 19:09:35:INFO:TRAIN-(cmcm) (9/20/1)>> loss: 0.8382
2024-06-11 19:09:37:INFO:VAL-(cmcm) >>
2024-06-11 19:09:37:INFO:M: >>  Has0_acc_2: 0.5240  Has0_F1_score: 0.5276  Non0_acc_2: 0.5556  Non0_F1_score: 0.5542  Mult_acc_5: 0.2664  Mult_acc_7: 0.2183  MAE: 1.6381  Corr: 0.0624 
2024-06-11 19:09:52:INFO:TRAIN-(cmcm) (10/21/1)>> loss: 0.8369
2024-06-11 19:09:55:INFO:VAL-(cmcm) >>
2024-06-11 19:09:55:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.5727  Non0_acc_2: 0.5880  Non0_F1_score: 0.5650  Mult_acc_5: 0.2969  Mult_acc_7: 0.2140  MAE: 1.6328  Corr: 0.0654 
2024-06-11 19:10:02:INFO:TEST-(cmcm) >>
2024-06-11 19:10:02:INFO:M: >>  Has0_acc_2: 0.5306  Has0_F1_score: 0.5252  Non0_acc_2: 0.5412  Non0_F1_score: 0.4407  Mult_acc_5: 0.1953  Mult_acc_7: 0.1924  MAE: 1.4134  Corr: -0.0069 
2024-06-11 19:10:02:INFO:Results are added to results/results/mosi-regression-80.csv...
2024-06-11 19:10:02:INFO:Start running cmcm...
2024-06-11 19:10:02:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 80, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 2222}>
2024-06-11 19:10:02:INFO:Let's use the GPU 1 !
2024-06-11 19:10:02:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 19:10:03:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718104203 HTTP/1.1" 200 235
2024-06-11 19:10:03:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 19:10:03:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 19:10:04:INFO:train samples: (1284,)
2024-06-11 19:10:04:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 19:10:04:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718104205 HTTP/1.1" 200 235
2024-06-11 19:10:05:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 19:10:05:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 19:10:06:INFO:valid samples: (229,)
2024-06-11 19:10:06:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 19:10:06:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718104206 HTTP/1.1" 200 235
2024-06-11 19:10:06:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 19:10:06:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 19:10:07:INFO:test samples: (686,)
2024-06-11 19:10:07:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 19:10:07:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718104208 HTTP/1.1" 200 235
2024-06-11 19:10:07:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 19:10:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 19:10:08:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 19:10:09:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718104209 HTTP/1.1" 200 235
2024-06-11 19:10:09:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 19:10:09:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 19:10:09:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-11 19:10:09:WARNING:Try importing flash-attention for faster inference...
2024-06-11 19:10:09:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-11 19:10:09:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-11 19:10:09:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-11 19:10:10:INFO:trainable params: 1310284 || all params: 1838138956 || trainable%: 0.07128318540461856
2024-06-11 19:10:10:INFO:Init labels...
2024-06-11 19:10:10:INFO:Start training...
2024-06-11 19:10:25:INFO:TRAIN-(cmcm) (1/1/2)>> loss: 2.7889
2024-06-11 19:10:28:INFO:VAL-(cmcm) >>
2024-06-11 19:10:28:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.4780  Non0_acc_2: 0.5648  Non0_F1_score: 0.4505  Mult_acc_5: 0.2882  Mult_acc_7: 0.2314  MAE: 1.7542  Corr: -0.0355 
2024-06-11 19:10:28:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-11 19:10:43:INFO:TRAIN-(cmcm) (1/2/2)>> loss: 0.9540
2024-06-11 19:10:45:INFO:VAL-(cmcm) >>
2024-06-11 19:10:45:INFO:M: >>  Has0_acc_2: 0.4629  Has0_F1_score: 0.3854  Non0_acc_2: 0.4861  Non0_F1_score: 0.4098  Mult_acc_5: 0.2183  Mult_acc_7: 0.1703  MAE: 1.8886  Corr: 0.1161 
2024-06-11 19:11:00:INFO:TRAIN-(cmcm) (2/3/2)>> loss: 0.9136
2024-06-11 19:11:02:INFO:VAL-(cmcm) >>
2024-06-11 19:11:02:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.4924  Non0_acc_2: 0.5602  Non0_F1_score: 0.4656  Mult_acc_5: 0.1616  Mult_acc_7: 0.1528  MAE: 1.6455  Corr: -0.0402 
2024-06-11 19:11:03:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-mosi-regression.pth.
2024-06-11 19:11:18:INFO:TRAIN-(cmcm) (1/4/2)>> loss: 0.9014
2024-06-11 19:11:20:INFO:VAL-(cmcm) >>
2024-06-11 19:11:20:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.5826  Non0_acc_2: 0.5324  Non0_F1_score: 0.5338  Mult_acc_5: 0.2358  Mult_acc_7: 0.2314  MAE: 1.4921  Corr: 0.0273 
2024-06-11 19:11:20:INFO:Saving checkpoint at epoch 4 to results/models/cmcm-mosi-regression.pth.
2024-06-11 19:11:35:INFO:TRAIN-(cmcm) (1/5/2)>> loss: 0.8897
2024-06-11 19:11:38:INFO:VAL-(cmcm) >>
2024-06-11 19:11:38:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.4943  Non0_acc_2: 0.4491  Non0_F1_score: 0.4340  Mult_acc_5: 0.1703  Mult_acc_7: 0.1703  MAE: 1.5362  Corr: -0.0671 
2024-06-11 19:11:53:INFO:TRAIN-(cmcm) (2/6/2)>> loss: 0.8821
2024-06-11 19:11:55:INFO:VAL-(cmcm) >>
2024-06-11 19:11:55:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.5483  Non0_acc_2: 0.5648  Non0_F1_score: 0.5346  Mult_acc_5: 0.2882  Mult_acc_7: 0.2052  MAE: 1.6861  Corr: 0.0326 
2024-06-11 19:12:11:INFO:TRAIN-(cmcm) (3/7/2)>> loss: 0.8789
2024-06-11 19:12:13:INFO:VAL-(cmcm) >>
2024-06-11 19:12:13:INFO:M: >>  Has0_acc_2: 0.5546  Has0_F1_score: 0.5589  Non0_acc_2: 0.5602  Non0_F1_score: 0.5626  Mult_acc_5: 0.2576  Mult_acc_7: 0.1878  MAE: 1.6376  Corr: 0.0723 
2024-06-11 19:12:29:INFO:TRAIN-(cmcm) (4/8/2)>> loss: 0.8741
2024-06-11 19:12:31:INFO:VAL-(cmcm) >>
2024-06-11 19:12:31:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.5610  Non0_acc_2: 0.5602  Non0_F1_score: 0.5519  Mult_acc_5: 0.2402  Mult_acc_7: 0.1834  MAE: 1.6271  Corr: 0.0492 
2024-06-11 19:12:46:INFO:TRAIN-(cmcm) (5/9/2)>> loss: 0.8660
2024-06-11 19:12:49:INFO:VAL-(cmcm) >>
2024-06-11 19:12:49:INFO:M: >>  Has0_acc_2: 0.4716  Has0_F1_score: 0.4389  Non0_acc_2: 0.4861  Non0_F1_score: 0.4519  Mult_acc_5: 0.1790  Mult_acc_7: 0.1572  MAE: 1.7453  Corr: 0.0220 
2024-06-11 19:13:04:INFO:TRAIN-(cmcm) (6/10/2)>> loss: 0.8653
2024-06-11 19:13:06:INFO:VAL-(cmcm) >>
2024-06-11 19:13:06:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.5403  Non0_acc_2: 0.5833  Non0_F1_score: 0.5191  Mult_acc_5: 0.2489  Mult_acc_7: 0.1834  MAE: 1.5778  Corr: 0.0652 
2024-06-11 19:13:21:INFO:TRAIN-(cmcm) (7/11/2)>> loss: 0.8563
2024-06-11 19:13:23:INFO:VAL-(cmcm) >>
2024-06-11 19:13:23:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.5058  Non0_acc_2: 0.5787  Non0_F1_score: 0.4827  Mult_acc_5: 0.3057  Mult_acc_7: 0.2227  MAE: 1.7643  Corr: 0.0525 
2024-06-11 19:13:38:INFO:TRAIN-(cmcm) (8/12/2)>> loss: 0.8508
2024-06-11 19:13:41:INFO:VAL-(cmcm) >>
2024-06-11 19:13:41:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.5479  Non0_acc_2: 0.5694  Non0_F1_score: 0.5236  Mult_acc_5: 0.2489  Mult_acc_7: 0.1834  MAE: 1.7244  Corr: 0.0262 
2024-06-11 19:13:55:INFO:TRAIN-(cmcm) (9/13/2)>> loss: 0.8490
2024-06-11 19:13:58:INFO:VAL-(cmcm) >>
2024-06-11 19:13:58:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5946  Non0_acc_2: 0.6019  Non0_F1_score: 0.6006  Mult_acc_5: 0.2926  Mult_acc_7: 0.2096  MAE: 1.6149  Corr: 0.2469 
2024-06-11 19:14:13:INFO:TRAIN-(cmcm) (10/14/2)>> loss: 0.8463
2024-06-11 19:14:15:INFO:VAL-(cmcm) >>
2024-06-11 19:14:15:INFO:M: >>  Has0_acc_2: 0.6201  Has0_F1_score: 0.5251  Non0_acc_2: 0.5972  Non0_F1_score: 0.5106  Mult_acc_5: 0.3100  Mult_acc_7: 0.2271  MAE: 1.6926  Corr: 0.1037 
2024-06-11 19:14:23:INFO:TEST-(cmcm) >>
2024-06-11 19:14:23:INFO:M: >>  Has0_acc_2: 0.5233  Has0_F1_score: 0.5086  Non0_acc_2: 0.5381  Non0_F1_score: 0.5409  Mult_acc_5: 0.2157  Mult_acc_7: 0.2157  MAE: 1.5021  Corr: 0.0693 
2024-06-11 19:14:23:INFO:Results are added to results/results/mosi-regression-80.csv...
2024-06-11 19:14:23:INFO:Start running cmcm...
2024-06-11 19:14:23:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 80, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 3333}>
2024-06-11 19:14:23:INFO:Let's use the GPU 1 !
2024-06-11 19:14:23:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 19:14:23:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718104463 HTTP/1.1" 200 235
2024-06-11 19:14:23:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 19:14:24:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 19:14:25:INFO:train samples: (1284,)
2024-06-11 19:14:25:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 19:14:25:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718104465 HTTP/1.1" 200 235
2024-06-11 19:14:25:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 19:14:26:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 19:14:26:INFO:valid samples: (229,)
2024-06-11 19:14:26:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 19:14:26:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718104467 HTTP/1.1" 200 235
2024-06-11 19:14:27:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 19:14:27:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 19:14:28:INFO:test samples: (686,)
2024-06-11 19:14:28:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 19:14:28:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718104468 HTTP/1.1" 200 235
2024-06-11 19:14:28:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 19:14:29:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 19:14:29:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 19:14:29:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718104469 HTTP/1.1" 200 235
2024-06-11 19:14:30:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 19:14:30:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 19:14:30:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-11 19:14:30:WARNING:Try importing flash-attention for faster inference...
2024-06-11 19:14:30:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-11 19:14:30:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-11 19:14:30:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-11 19:14:31:INFO:trainable params: 1310284 || all params: 1838138956 || trainable%: 0.07128318540461856
2024-06-11 19:14:31:INFO:Init labels...
2024-06-11 19:14:31:INFO:Start training...
2024-06-11 19:14:46:INFO:TRAIN-(cmcm) (1/1/3)>> loss: 3.5089
2024-06-11 19:14:49:INFO:VAL-(cmcm) >>
2024-06-11 19:14:49:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.4469  Non0_acc_2: 0.5602  Non0_F1_score: 0.4414  Mult_acc_5: 0.2009  Mult_acc_7: 0.1921  MAE: 1.5558  Corr: 0.0308 
2024-06-11 19:14:49:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-11 19:15:04:INFO:TRAIN-(cmcm) (1/2/3)>> loss: 1.0059
2024-06-11 19:15:07:INFO:VAL-(cmcm) >>
2024-06-11 19:15:07:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5657  Non0_acc_2: 0.5833  Non0_F1_score: 0.5568  Mult_acc_5: 0.1965  Mult_acc_7: 0.1965  MAE: 1.5170  Corr: 0.0592 
2024-06-11 19:15:07:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-11 19:15:22:INFO:TRAIN-(cmcm) (1/3/3)>> loss: 0.9089
2024-06-11 19:15:25:INFO:VAL-(cmcm) >>
2024-06-11 19:15:25:INFO:M: >>  Has0_acc_2: 0.5459  Has0_F1_score: 0.5502  Non0_acc_2: 0.5509  Non0_F1_score: 0.5533  Mult_acc_5: 0.2838  Mult_acc_7: 0.2052  MAE: 1.6222  Corr: 0.1616 
2024-06-11 19:15:39:INFO:TRAIN-(cmcm) (2/4/3)>> loss: 0.8960
2024-06-11 19:15:42:INFO:VAL-(cmcm) >>
2024-06-11 19:15:42:INFO:M: >>  Has0_acc_2: 0.5415  Has0_F1_score: 0.5392  Non0_acc_2: 0.5370  Non0_F1_score: 0.5327  Mult_acc_5: 0.2533  Mult_acc_7: 0.1790  MAE: 1.7162  Corr: 0.0103 
2024-06-11 19:15:57:INFO:TRAIN-(cmcm) (3/5/3)>> loss: 0.9157
2024-06-11 19:15:59:INFO:VAL-(cmcm) >>
2024-06-11 19:15:59:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4700  Non0_acc_2: 0.4769  Non0_F1_score: 0.4625  Mult_acc_5: 0.2096  Mult_acc_7: 0.2096  MAE: 1.4484  Corr: -0.0155 
2024-06-11 19:16:00:INFO:Saving checkpoint at epoch 5 to results/models/cmcm-mosi-regression.pth.
2024-06-11 19:16:15:INFO:TRAIN-(cmcm) (1/6/3)>> loss: 0.8744
2024-06-11 19:16:17:INFO:VAL-(cmcm) >>
2024-06-11 19:16:17:INFO:M: >>  Has0_acc_2: 0.5633  Has0_F1_score: 0.5188  Non0_acc_2: 0.5509  Non0_F1_score: 0.5031  Mult_acc_5: 0.2751  Mult_acc_7: 0.1965  MAE: 1.7512  Corr: -0.0115 
2024-06-11 19:16:32:INFO:TRAIN-(cmcm) (2/7/3)>> loss: 0.8702
2024-06-11 19:16:34:INFO:VAL-(cmcm) >>
2024-06-11 19:16:34:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.4897  Non0_acc_2: 0.5648  Non0_F1_score: 0.4627  Mult_acc_5: 0.2926  Mult_acc_7: 0.2140  MAE: 1.6472  Corr: -0.0279 
2024-06-11 19:16:49:INFO:TRAIN-(cmcm) (3/8/3)>> loss: 0.8658
2024-06-11 19:16:52:INFO:VAL-(cmcm) >>
2024-06-11 19:16:52:INFO:M: >>  Has0_acc_2: 0.5415  Has0_F1_score: 0.5330  Non0_acc_2: 0.5370  Non0_F1_score: 0.5261  Mult_acc_5: 0.2402  Mult_acc_7: 0.1747  MAE: 1.8053  Corr: -0.0039 
2024-06-11 19:17:06:INFO:TRAIN-(cmcm) (4/9/3)>> loss: 0.8626
2024-06-11 19:17:09:INFO:VAL-(cmcm) >>
2024-06-11 19:17:09:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.4769  Non0_acc_2: 0.5509  Non0_F1_score: 0.5395  Mult_acc_5: 0.2751  Mult_acc_7: 0.2009  MAE: 1.5953  Corr: 0.0337 
2024-06-11 19:17:23:INFO:TRAIN-(cmcm) (5/10/3)>> loss: 0.8640
2024-06-11 19:17:26:INFO:VAL-(cmcm) >>
2024-06-11 19:17:26:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4577  Non0_acc_2: 0.5787  Non0_F1_score: 0.4291  Mult_acc_5: 0.3100  Mult_acc_7: 0.2271  MAE: 1.7136  Corr: 0.0375 
2024-06-11 19:17:41:INFO:TRAIN-(cmcm) (6/11/3)>> loss: 0.8571
2024-06-11 19:17:43:INFO:VAL-(cmcm) >>
2024-06-11 19:17:43:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.4943  Non0_acc_2: 0.5833  Non0_F1_score: 0.4676  Mult_acc_5: 0.2882  Mult_acc_7: 0.2140  MAE: 1.7424  Corr: 0.0167 
2024-06-11 19:17:58:INFO:TRAIN-(cmcm) (7/12/3)>> loss: 0.8521
2024-06-11 19:18:00:INFO:VAL-(cmcm) >>
2024-06-11 19:18:00:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.5576  Non0_acc_2: 0.5926  Non0_F1_score: 0.5444  Mult_acc_5: 0.3057  Mult_acc_7: 0.2271  MAE: 1.6673  Corr: 0.0828 
2024-06-11 19:18:15:INFO:TRAIN-(cmcm) (8/13/3)>> loss: 0.8440
2024-06-11 19:18:17:INFO:VAL-(cmcm) >>
2024-06-11 19:18:17:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4855  Non0_acc_2: 0.5787  Non0_F1_score: 0.4584  Mult_acc_5: 0.2664  Mult_acc_7: 0.2096  MAE: 1.6577  Corr: 0.0274 
2024-06-11 19:18:32:INFO:TRAIN-(cmcm) (9/14/3)>> loss: 0.8456
2024-06-11 19:18:35:INFO:VAL-(cmcm) >>
2024-06-11 19:18:35:INFO:M: >>  Has0_acc_2: 0.6157  Has0_F1_score: 0.6080  Non0_acc_2: 0.6204  Non0_F1_score: 0.6101  Mult_acc_5: 0.3362  Mult_acc_7: 0.2489  MAE: 1.5817  Corr: 0.2218 
2024-06-11 19:18:49:INFO:TRAIN-(cmcm) (10/15/3)>> loss: 0.8471
2024-06-11 19:18:52:INFO:VAL-(cmcm) >>
2024-06-11 19:18:52:INFO:M: >>  Has0_acc_2: 0.5590  Has0_F1_score: 0.5593  Non0_acc_2: 0.5694  Non0_F1_score: 0.5684  Mult_acc_5: 0.2751  Mult_acc_7: 0.2314  MAE: 1.5219  Corr: 0.1259 
2024-06-11 19:18:59:INFO:TEST-(cmcm) >>
2024-06-11 19:18:59:INFO:M: >>  Has0_acc_2: 0.4665  Has0_F1_score: 0.3386  Non0_acc_2: 0.4893  Non0_F1_score: 0.4895  Mult_acc_5: 0.1618  Mult_acc_7: 0.1603  MAE: 1.5092  Corr: 0.0036 
2024-06-11 19:19:00:INFO:Results are added to results/results/mosi-regression-80.csv...
2024-06-11 19:19:00:INFO:Start running cmcm...
2024-06-11 19:19:00:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 80, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 4444}>
2024-06-11 19:19:00:INFO:Let's use the GPU 1 !
2024-06-11 19:19:00:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 19:19:00:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718104740 HTTP/1.1" 200 235
2024-06-11 19:19:00:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 19:19:01:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 19:19:01:INFO:train samples: (1284,)
2024-06-11 19:19:01:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 19:19:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718104742 HTTP/1.1" 200 235
2024-06-11 19:19:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 19:19:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 19:19:03:INFO:valid samples: (229,)
2024-06-11 19:19:03:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 19:19:03:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718104743 HTTP/1.1" 200 235
2024-06-11 19:19:04:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 19:19:04:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 19:19:05:INFO:test samples: (686,)
2024-06-11 19:19:05:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 19:19:05:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718104745 HTTP/1.1" 200 235
2024-06-11 19:19:05:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 19:19:05:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 19:19:06:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 19:19:06:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718104746 HTTP/1.1" 200 235
2024-06-11 19:19:06:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 19:19:07:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 19:19:07:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-11 19:19:07:WARNING:Try importing flash-attention for faster inference...
2024-06-11 19:19:07:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-11 19:19:07:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-11 19:19:07:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-11 19:19:08:INFO:trainable params: 1310284 || all params: 1838138956 || trainable%: 0.07128318540461856
2024-06-11 19:19:08:INFO:Init labels...
2024-06-11 19:19:08:INFO:Start training...
2024-06-11 19:19:23:INFO:TRAIN-(cmcm) (1/1/4)>> loss: 2.5122
2024-06-11 19:19:25:INFO:VAL-(cmcm) >>
2024-06-11 19:19:25:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4723  Non0_acc_2: 0.5787  Non0_F1_score: 0.4445  Mult_acc_5: 0.1616  Mult_acc_7: 0.1572  MAE: 1.5742  Corr: 0.0242 
2024-06-11 19:19:25:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-11 19:19:41:INFO:TRAIN-(cmcm) (1/2/4)>> loss: 1.0828
2024-06-11 19:19:43:INFO:VAL-(cmcm) >>
2024-06-11 19:19:43:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4891  Non0_acc_2: 0.5417  Non0_F1_score: 0.5442  Mult_acc_5: 0.2140  Mult_acc_7: 0.2140  MAE: 1.4309  Corr: 0.0208 
2024-06-11 19:19:43:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-11 19:19:58:INFO:TRAIN-(cmcm) (1/3/4)>> loss: 1.0411
2024-06-11 19:20:01:INFO:VAL-(cmcm) >>
2024-06-11 19:20:01:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5477  Non0_acc_2: 0.5787  Non0_F1_score: 0.5400  Mult_acc_5: 0.1965  Mult_acc_7: 0.1790  MAE: 1.5082  Corr: 0.0586 
2024-06-11 19:20:15:INFO:TRAIN-(cmcm) (2/4/4)>> loss: 0.9884
2024-06-11 19:20:18:INFO:VAL-(cmcm) >>
2024-06-11 19:20:18:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.4975  Non0_acc_2: 0.5509  Non0_F1_score: 0.4749  Mult_acc_5: 0.1703  Mult_acc_7: 0.1703  MAE: 1.5253  Corr: -0.0413 
2024-06-11 19:20:33:INFO:TRAIN-(cmcm) (3/5/4)>> loss: 0.9497
2024-06-11 19:20:35:INFO:VAL-(cmcm) >>
2024-06-11 19:20:35:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.5159  Non0_acc_2: 0.5139  Non0_F1_score: 0.5037  Mult_acc_5: 0.2533  Mult_acc_7: 0.2358  MAE: 1.5183  Corr: 0.0283 
2024-06-11 19:20:50:INFO:TRAIN-(cmcm) (4/6/4)>> loss: 0.9234
2024-06-11 19:20:52:INFO:VAL-(cmcm) >>
2024-06-11 19:20:52:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.5002  Non0_acc_2: 0.5787  Non0_F1_score: 0.4711  Mult_acc_5: 0.1878  Mult_acc_7: 0.1878  MAE: 1.5122  Corr: 0.0179 
2024-06-11 19:21:07:INFO:TRAIN-(cmcm) (5/7/4)>> loss: 0.9078
2024-06-11 19:21:10:INFO:VAL-(cmcm) >>
2024-06-11 19:21:10:INFO:M: >>  Has0_acc_2: 0.5153  Has0_F1_score: 0.5190  Non0_acc_2: 0.5278  Non0_F1_score: 0.5297  Mult_acc_5: 0.2533  Mult_acc_7: 0.1878  MAE: 1.8293  Corr: 0.0447 
2024-06-11 19:21:24:INFO:TRAIN-(cmcm) (6/8/4)>> loss: 0.8947
2024-06-11 19:21:27:INFO:VAL-(cmcm) >>
2024-06-11 19:21:27:INFO:M: >>  Has0_acc_2: 0.4978  Has0_F1_score: 0.4779  Non0_acc_2: 0.5185  Non0_F1_score: 0.4989  Mult_acc_5: 0.1921  Mult_acc_7: 0.1834  MAE: 1.5584  Corr: 0.1639 
2024-06-11 19:21:41:INFO:TRAIN-(cmcm) (7/9/4)>> loss: 0.8893
2024-06-11 19:21:44:INFO:VAL-(cmcm) >>
2024-06-11 19:21:44:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4917  Non0_acc_2: 0.5833  Non0_F1_score: 0.4676  Mult_acc_5: 0.2489  Mult_acc_7: 0.2009  MAE: 1.6226  Corr: -0.0300 
2024-06-11 19:21:59:INFO:TRAIN-(cmcm) (8/10/4)>> loss: 0.8809
2024-06-11 19:22:01:INFO:VAL-(cmcm) >>
2024-06-11 19:22:01:INFO:M: >>  Has0_acc_2: 0.5590  Has0_F1_score: 0.5408  Non0_acc_2: 0.5509  Non0_F1_score: 0.5304  Mult_acc_5: 0.2489  Mult_acc_7: 0.1790  MAE: 1.8219  Corr: -0.0041 
2024-06-11 19:22:16:INFO:TRAIN-(cmcm) (9/11/4)>> loss: 0.8727
2024-06-11 19:22:18:INFO:VAL-(cmcm) >>
2024-06-11 19:22:18:INFO:M: >>  Has0_acc_2: 0.6245  Has0_F1_score: 0.5673  Non0_acc_2: 0.6065  Non0_F1_score: 0.5477  Mult_acc_5: 0.3013  Mult_acc_7: 0.2183  MAE: 1.5630  Corr: 0.1546 
2024-06-11 19:22:33:INFO:TRAIN-(cmcm) (10/12/4)>> loss: 0.8772
2024-06-11 19:22:35:INFO:VAL-(cmcm) >>
2024-06-11 19:22:35:INFO:M: >>  Has0_acc_2: 0.5502  Has0_F1_score: 0.5466  Non0_acc_2: 0.5556  Non0_F1_score: 0.5494  Mult_acc_5: 0.1659  Mult_acc_7: 0.1659  MAE: 1.5934  Corr: 0.1175 
2024-06-11 19:22:43:INFO:TEST-(cmcm) >>
2024-06-11 19:22:43:INFO:M: >>  Has0_acc_2: 0.4592  Has0_F1_score: 0.3405  Non0_acc_2: 0.5351  Non0_F1_score: 0.5328  Mult_acc_5: 0.1778  Mult_acc_7: 0.1778  MAE: 1.5147  Corr: 0.0001 
2024-06-11 19:22:43:INFO:Results are added to results/results/mosi-regression-80.csv...
2024-06-11 19:22:43:INFO:Start running cmcm...
2024-06-11 19:22:43:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 80, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 5555}>
2024-06-11 19:22:43:INFO:Let's use the GPU 1 !
2024-06-11 19:22:43:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 19:22:44:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718104964 HTTP/1.1" 200 235
2024-06-11 19:22:44:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 19:22:44:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 19:22:45:INFO:train samples: (1284,)
2024-06-11 19:22:45:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 19:22:45:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718104965 HTTP/1.1" 200 235
2024-06-11 19:22:46:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 19:22:46:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 19:22:47:INFO:valid samples: (229,)
2024-06-11 19:22:47:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 19:22:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718104967 HTTP/1.1" 200 235
2024-06-11 19:22:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 19:22:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 19:22:48:INFO:test samples: (686,)
2024-06-11 19:22:48:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 19:22:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718104969 HTTP/1.1" 200 235
2024-06-11 19:22:49:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 19:22:49:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 19:22:50:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 19:22:50:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718104970 HTTP/1.1" 200 235
2024-06-11 19:22:50:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 19:22:50:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 19:22:50:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-11 19:22:50:WARNING:Try importing flash-attention for faster inference...
2024-06-11 19:22:50:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-11 19:22:50:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-11 19:22:50:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-11 19:22:52:INFO:trainable params: 1310284 || all params: 1838138956 || trainable%: 0.07128318540461856
2024-06-11 19:22:52:INFO:Init labels...
2024-06-11 19:22:52:INFO:Start training...
2024-06-11 19:23:06:INFO:TRAIN-(cmcm) (1/1/5)>> loss: 2.2472
2024-06-11 19:23:09:INFO:VAL-(cmcm) >>
2024-06-11 19:23:09:INFO:M: >>  Has0_acc_2: 0.5371  Has0_F1_score: 0.5392  Non0_acc_2: 0.5370  Non0_F1_score: 0.5382  Mult_acc_5: 0.1834  Mult_acc_7: 0.1834  MAE: 1.6886  Corr: -0.0288 
2024-06-11 19:23:09:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-11 19:23:24:INFO:TRAIN-(cmcm) (1/2/5)>> loss: 1.0109
2024-06-11 19:23:27:INFO:VAL-(cmcm) >>
2024-06-11 19:23:27:INFO:M: >>  Has0_acc_2: 0.4803  Has0_F1_score: 0.4843  Non0_acc_2: 0.4907  Non0_F1_score: 0.4907  Mult_acc_5: 0.1965  Mult_acc_7: 0.1965  MAE: 1.5973  Corr: -0.0135 
2024-06-11 19:23:27:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-11 19:23:43:INFO:TRAIN-(cmcm) (1/3/5)>> loss: 0.9812
2024-06-11 19:23:46:INFO:VAL-(cmcm) >>
2024-06-11 19:23:46:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5261  Non0_acc_2: 0.5694  Non0_F1_score: 0.5010  Mult_acc_5: 0.2751  Mult_acc_7: 0.2096  MAE: 1.7333  Corr: -0.0161 
2024-06-11 19:24:02:INFO:TRAIN-(cmcm) (2/4/5)>> loss: 0.9338
2024-06-11 19:24:05:INFO:VAL-(cmcm) >>
2024-06-11 19:24:05:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4458  Non0_acc_2: 0.5694  Non0_F1_score: 0.4166  Mult_acc_5: 0.1703  Mult_acc_7: 0.1703  MAE: 1.4812  Corr: -0.0779 
2024-06-11 19:24:05:INFO:Saving checkpoint at epoch 4 to results/models/cmcm-mosi-regression.pth.
2024-06-11 19:24:21:INFO:TRAIN-(cmcm) (1/5/5)>> loss: 0.9079
2024-06-11 19:24:24:INFO:VAL-(cmcm) >>
2024-06-11 19:24:24:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4723  Non0_acc_2: 0.4861  Non0_F1_score: 0.4865  Mult_acc_5: 0.1747  Mult_acc_7: 0.1747  MAE: 1.4602  Corr: -0.0116 
2024-06-11 19:24:24:INFO:Saving checkpoint at epoch 5 to results/models/cmcm-mosi-regression.pth.
2024-06-11 19:24:41:INFO:TRAIN-(cmcm) (1/6/5)>> loss: 0.9057
2024-06-11 19:24:44:INFO:VAL-(cmcm) >>
2024-06-11 19:24:44:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5466  Non0_acc_2: 0.5602  Non0_F1_score: 0.5256  Mult_acc_5: 0.2096  Mult_acc_7: 0.1572  MAE: 1.6603  Corr: 0.0366 
2024-06-11 19:25:00:INFO:TRAIN-(cmcm) (2/7/5)>> loss: 0.8939
2024-06-11 19:25:03:INFO:VAL-(cmcm) >>
2024-06-11 19:25:03:INFO:M: >>  Has0_acc_2: 0.4716  Has0_F1_score: 0.4584  Non0_acc_2: 0.4861  Non0_F1_score: 0.4720  Mult_acc_5: 0.1878  Mult_acc_7: 0.1397  MAE: 1.9389  Corr: 0.0132 
2024-06-11 19:25:19:INFO:TRAIN-(cmcm) (3/8/5)>> loss: 0.8930
2024-06-11 19:25:22:INFO:VAL-(cmcm) >>
2024-06-11 19:25:22:INFO:M: >>  Has0_acc_2: 0.4629  Has0_F1_score: 0.3810  Non0_acc_2: 0.4861  Non0_F1_score: 0.4053  Mult_acc_5: 0.1878  Mult_acc_7: 0.1485  MAE: 1.9851  Corr: 0.0774 
2024-06-11 19:25:37:INFO:TRAIN-(cmcm) (4/9/5)>> loss: 0.8866
2024-06-11 19:25:40:INFO:VAL-(cmcm) >>
2024-06-11 19:25:40:INFO:M: >>  Has0_acc_2: 0.5502  Has0_F1_score: 0.5317  Non0_acc_2: 0.5417  Non0_F1_score: 0.5207  Mult_acc_5: 0.2533  Mult_acc_7: 0.1747  MAE: 1.8215  Corr: 0.0635 
2024-06-11 19:25:55:INFO:TRAIN-(cmcm) (5/10/5)>> loss: 0.8740
2024-06-11 19:25:58:INFO:VAL-(cmcm) >>
2024-06-11 19:25:58:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4458  Non0_acc_2: 0.5694  Non0_F1_score: 0.4166  Mult_acc_5: 0.2009  Mult_acc_7: 0.1703  MAE: 1.6411  Corr: -0.0005 
2024-06-11 19:26:13:INFO:TRAIN-(cmcm) (6/11/5)>> loss: 0.8725
2024-06-11 19:26:16:INFO:VAL-(cmcm) >>
2024-06-11 19:26:16:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.6026  Non0_acc_2: 0.6065  Non0_F1_score: 0.6002  Mult_acc_5: 0.2620  Mult_acc_7: 0.1965  MAE: 1.6472  Corr: 0.1424 
2024-06-11 19:26:31:INFO:TRAIN-(cmcm) (7/12/5)>> loss: 0.8662
2024-06-11 19:26:34:INFO:VAL-(cmcm) >>
2024-06-11 19:26:34:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5129  Non0_acc_2: 0.5694  Non0_F1_score: 0.4871  Mult_acc_5: 0.2969  Mult_acc_7: 0.2183  MAE: 1.7389  Corr: 0.0049 
2024-06-11 19:26:50:INFO:TRAIN-(cmcm) (8/13/5)>> loss: 0.8581
2024-06-11 19:26:53:INFO:VAL-(cmcm) >>
2024-06-11 19:26:53:INFO:M: >>  Has0_acc_2: 0.6288  Has0_F1_score: 0.6082  Non0_acc_2: 0.6296  Non0_F1_score: 0.6060  Mult_acc_5: 0.3231  Mult_acc_7: 0.2533  MAE: 1.4883  Corr: 0.2095 
2024-06-11 19:27:08:INFO:TRAIN-(cmcm) (9/14/5)>> loss: 0.8535
2024-06-11 19:27:11:INFO:VAL-(cmcm) >>
2024-06-11 19:27:11:INFO:M: >>  Has0_acc_2: 0.6419  Has0_F1_score: 0.5840  Non0_acc_2: 0.6157  Non0_F1_score: 0.5830  Mult_acc_5: 0.3450  Mult_acc_7: 0.2576  MAE: 1.5359  Corr: 0.2269 
2024-06-11 19:27:26:INFO:TRAIN-(cmcm) (10/15/5)>> loss: 0.8473
2024-06-11 19:27:29:INFO:VAL-(cmcm) >>
2024-06-11 19:27:29:INFO:M: >>  Has0_acc_2: 0.6638  Has0_F1_score: 0.6077  Non0_acc_2: 0.6574  Non0_F1_score: 0.6079  Mult_acc_5: 0.2183  Mult_acc_7: 0.1965  MAE: 1.3986  Corr: 0.2727 
2024-06-11 19:27:29:INFO:Saving checkpoint at epoch 15 to results/models/cmcm-mosi-regression.pth.
2024-06-11 19:27:45:INFO:TRAIN-(cmcm) (1/16/5)>> loss: 0.8293
2024-06-11 19:27:49:INFO:VAL-(cmcm) >>
2024-06-11 19:27:49:INFO:M: >>  Has0_acc_2: 0.6594  Has0_F1_score: 0.6594  Non0_acc_2: 0.6759  Non0_F1_score: 0.6736  Mult_acc_5: 0.2227  Mult_acc_7: 0.2140  MAE: 1.3344  Corr: 0.3238 
2024-06-11 19:27:49:INFO:Saving checkpoint at epoch 16 to results/models/cmcm-mosi-regression.pth.
2024-06-11 19:28:04:INFO:TRAIN-(cmcm) (1/17/5)>> loss: 0.8189
2024-06-11 19:28:07:INFO:VAL-(cmcm) >>
2024-06-11 19:28:07:INFO:M: >>  Has0_acc_2: 0.6769  Has0_F1_score: 0.6800  Non0_acc_2: 0.6852  Non0_F1_score: 0.6869  Mult_acc_5: 0.2664  Mult_acc_7: 0.2271  MAE: 1.2761  Corr: 0.3957 
2024-06-11 19:28:07:INFO:Saving checkpoint at epoch 17 to results/models/cmcm-mosi-regression.pth.
2024-06-11 19:28:22:INFO:TRAIN-(cmcm) (1/18/5)>> loss: 0.8258
2024-06-11 19:28:25:INFO:VAL-(cmcm) >>
2024-06-11 19:28:25:INFO:M: >>  Has0_acc_2: 0.6856  Has0_F1_score: 0.6829  Non0_acc_2: 0.6806  Non0_F1_score: 0.6779  Mult_acc_5: 0.3712  Mult_acc_7: 0.3013  MAE: 1.3119  Corr: 0.4057 
2024-06-11 19:28:39:INFO:TRAIN-(cmcm) (2/19/5)>> loss: 0.8088
2024-06-11 19:28:42:INFO:VAL-(cmcm) >>
2024-06-11 19:28:42:INFO:M: >>  Has0_acc_2: 0.6463  Has0_F1_score: 0.6062  Non0_acc_2: 0.6852  Non0_F1_score: 0.6856  Mult_acc_5: 0.3450  Mult_acc_7: 0.2751  MAE: 1.2414  Corr: 0.4180 
2024-06-11 19:28:42:INFO:Saving checkpoint at epoch 19 to results/models/cmcm-mosi-regression.pth.
2024-06-11 19:28:57:INFO:TRAIN-(cmcm) (1/20/5)>> loss: 0.8006
2024-06-11 19:28:59:INFO:VAL-(cmcm) >>
2024-06-11 19:28:59:INFO:M: >>  Has0_acc_2: 0.7118  Has0_F1_score: 0.7131  Non0_acc_2: 0.7315  Non0_F1_score: 0.7318  Mult_acc_5: 0.3843  Mult_acc_7: 0.3057  MAE: 1.1918  Corr: 0.4888 
2024-06-11 19:29:00:INFO:Saving checkpoint at epoch 20 to results/models/cmcm-mosi-regression.pth.
2024-06-11 19:29:15:INFO:TRAIN-(cmcm) (1/21/5)>> loss: 0.7865
2024-06-11 19:29:17:INFO:VAL-(cmcm) >>
2024-06-11 19:29:17:INFO:M: >>  Has0_acc_2: 0.6812  Has0_F1_score: 0.6843  Non0_acc_2: 0.7037  Non0_F1_score: 0.7053  Mult_acc_5: 0.3581  Mult_acc_7: 0.2926  MAE: 1.2156  Corr: 0.4772 
2024-06-11 19:29:32:INFO:TRAIN-(cmcm) (2/22/5)>> loss: 0.7903
2024-06-11 19:29:34:INFO:VAL-(cmcm) >>
2024-06-11 19:29:34:INFO:M: >>  Has0_acc_2: 0.7074  Has0_F1_score: 0.7001  Non0_acc_2: 0.7269  Non0_F1_score: 0.7225  Mult_acc_5: 0.3668  Mult_acc_7: 0.2882  MAE: 1.2734  Corr: 0.4271 
2024-06-11 19:29:49:INFO:TRAIN-(cmcm) (3/23/5)>> loss: 0.7723
2024-06-11 19:29:52:INFO:VAL-(cmcm) >>
2024-06-11 19:29:52:INFO:M: >>  Has0_acc_2: 0.7031  Has0_F1_score: 0.6951  Non0_acc_2: 0.6574  Non0_F1_score: 0.6593  Mult_acc_5: 0.3624  Mult_acc_7: 0.2969  MAE: 1.1510  Corr: 0.4696 
2024-06-11 19:29:52:INFO:Saving checkpoint at epoch 23 to results/models/cmcm-mosi-regression.pth.
2024-06-11 19:30:07:INFO:TRAIN-(cmcm) (1/24/5)>> loss: 0.7710
2024-06-11 19:30:09:INFO:VAL-(cmcm) >>
2024-06-11 19:30:09:INFO:M: >>  Has0_acc_2: 0.7249  Has0_F1_score: 0.7096  Non0_acc_2: 0.6713  Non0_F1_score: 0.6722  Mult_acc_5: 0.4061  Mult_acc_7: 0.3493  MAE: 1.1025  Corr: 0.4991 
2024-06-11 19:30:09:INFO:Saving checkpoint at epoch 24 to results/models/cmcm-mosi-regression.pth.
2024-06-11 19:30:24:INFO:TRAIN-(cmcm) (1/25/5)>> loss: 0.7622
2024-06-11 19:30:27:INFO:VAL-(cmcm) >>
2024-06-11 19:30:27:INFO:M: >>  Has0_acc_2: 0.6594  Has0_F1_score: 0.6535  Non0_acc_2: 0.6852  Non0_F1_score: 0.6791  Mult_acc_5: 0.3057  Mult_acc_7: 0.2533  MAE: 1.3293  Corr: 0.4769 
2024-06-11 19:30:42:INFO:TRAIN-(cmcm) (2/26/5)>> loss: 0.7538
2024-06-11 19:30:44:INFO:VAL-(cmcm) >>
2024-06-11 19:30:44:INFO:M: >>  Has0_acc_2: 0.7205  Has0_F1_score: 0.7166  Non0_acc_2: 0.7454  Non0_F1_score: 0.7413  Mult_acc_5: 0.3974  Mult_acc_7: 0.3362  MAE: 1.1228  Corr: 0.5052 
2024-06-11 19:30:59:INFO:TRAIN-(cmcm) (3/27/5)>> loss: 0.7521
2024-06-11 19:31:01:INFO:VAL-(cmcm) >>
2024-06-11 19:31:01:INFO:M: >>  Has0_acc_2: 0.7205  Has0_F1_score: 0.7227  Non0_acc_2: 0.7222  Non0_F1_score: 0.7238  Mult_acc_5: 0.3537  Mult_acc_7: 0.2882  MAE: 1.1638  Corr: 0.5284 
2024-06-11 19:31:16:INFO:TRAIN-(cmcm) (4/28/5)>> loss: 0.7397
2024-06-11 19:31:18:INFO:VAL-(cmcm) >>
2024-06-11 19:31:18:INFO:M: >>  Has0_acc_2: 0.7555  Has0_F1_score: 0.7521  Non0_acc_2: 0.7222  Non0_F1_score: 0.7238  Mult_acc_5: 0.3930  Mult_acc_7: 0.3057  MAE: 1.0883  Corr: 0.5324 
2024-06-11 19:31:19:INFO:Saving checkpoint at epoch 28 to results/models/cmcm-mosi-regression.pth.
2024-06-11 19:31:34:INFO:TRAIN-(cmcm) (1/29/5)>> loss: 0.7224
2024-06-11 19:31:36:INFO:VAL-(cmcm) >>
2024-06-11 19:31:36:INFO:M: >>  Has0_acc_2: 0.7074  Has0_F1_score: 0.6954  Non0_acc_2: 0.7037  Non0_F1_score: 0.6977  Mult_acc_5: 0.3886  Mult_acc_7: 0.2969  MAE: 1.1761  Corr: 0.5128 
2024-06-11 19:31:51:INFO:TRAIN-(cmcm) (2/30/5)>> loss: 0.7238
2024-06-11 19:31:53:INFO:VAL-(cmcm) >>
2024-06-11 19:31:53:INFO:M: >>  Has0_acc_2: 0.7205  Has0_F1_score: 0.7223  Non0_acc_2: 0.7407  Non0_F1_score: 0.7411  Mult_acc_5: 0.3712  Mult_acc_7: 0.3013  MAE: 1.1590  Corr: 0.5217 
2024-06-11 19:32:08:INFO:TRAIN-(cmcm) (3/31/5)>> loss: 0.7079
2024-06-11 19:32:10:INFO:VAL-(cmcm) >>
2024-06-11 19:32:10:INFO:M: >>  Has0_acc_2: 0.7031  Has0_F1_score: 0.6842  Non0_acc_2: 0.7083  Non0_F1_score: 0.7019  Mult_acc_5: 0.3886  Mult_acc_7: 0.3144  MAE: 1.1778  Corr: 0.4739 
2024-06-11 19:32:25:INFO:TRAIN-(cmcm) (4/32/5)>> loss: 0.6986
2024-06-11 19:32:28:INFO:VAL-(cmcm) >>
2024-06-11 19:32:28:INFO:M: >>  Has0_acc_2: 0.7205  Has0_F1_score: 0.7130  Non0_acc_2: 0.7130  Non0_F1_score: 0.7096  Mult_acc_5: 0.4236  Mult_acc_7: 0.3450  MAE: 1.1008  Corr: 0.4999 
2024-06-11 19:32:43:INFO:TRAIN-(cmcm) (5/33/5)>> loss: 0.6895
2024-06-11 19:32:45:INFO:VAL-(cmcm) >>
2024-06-11 19:32:45:INFO:M: >>  Has0_acc_2: 0.7380  Has0_F1_score: 0.7228  Non0_acc_2: 0.7500  Non0_F1_score: 0.7380  Mult_acc_5: 0.4105  Mult_acc_7: 0.3493  MAE: 1.0685  Corr: 0.5759 
2024-06-11 19:32:45:INFO:Saving checkpoint at epoch 33 to results/models/cmcm-mosi-regression.pth.
2024-06-11 19:33:00:INFO:TRAIN-(cmcm) (1/34/5)>> loss: 0.6817
2024-06-11 19:33:03:INFO:VAL-(cmcm) >>
2024-06-11 19:33:03:INFO:M: >>  Has0_acc_2: 0.7467  Has0_F1_score: 0.7379  Non0_acc_2: 0.7639  Non0_F1_score: 0.7570  Mult_acc_5: 0.4192  Mult_acc_7: 0.3450  MAE: 1.1533  Corr: 0.5023 
2024-06-11 19:33:17:INFO:TRAIN-(cmcm) (2/35/5)>> loss: 0.6715
2024-06-11 19:33:20:INFO:VAL-(cmcm) >>
2024-06-11 19:33:20:INFO:M: >>  Has0_acc_2: 0.7380  Has0_F1_score: 0.7370  Non0_acc_2: 0.7454  Non0_F1_score: 0.7438  Mult_acc_5: 0.3755  Mult_acc_7: 0.3013  MAE: 1.1074  Corr: 0.5115 
2024-06-11 19:33:34:INFO:TRAIN-(cmcm) (3/36/5)>> loss: 0.6663
2024-06-11 19:33:37:INFO:VAL-(cmcm) >>
2024-06-11 19:33:37:INFO:M: >>  Has0_acc_2: 0.7293  Has0_F1_score: 0.7209  Non0_acc_2: 0.7778  Non0_F1_score: 0.7732  Mult_acc_5: 0.3537  Mult_acc_7: 0.2664  MAE: 1.2149  Corr: 0.5064 
2024-06-11 19:33:51:INFO:TRAIN-(cmcm) (4/37/5)>> loss: 0.6785
2024-06-11 19:33:54:INFO:VAL-(cmcm) >>
2024-06-11 19:33:54:INFO:M: >>  Has0_acc_2: 0.7336  Has0_F1_score: 0.7334  Non0_acc_2: 0.6620  Non0_F1_score: 0.6637  Mult_acc_5: 0.3755  Mult_acc_7: 0.3188  MAE: 1.1621  Corr: 0.4387 
2024-06-11 19:34:08:INFO:TRAIN-(cmcm) (5/38/5)>> loss: 0.6425
2024-06-11 19:34:11:INFO:VAL-(cmcm) >>
2024-06-11 19:34:11:INFO:M: >>  Has0_acc_2: 0.7511  Has0_F1_score: 0.7533  Non0_acc_2: 0.7593  Non0_F1_score: 0.7604  Mult_acc_5: 0.3450  Mult_acc_7: 0.3013  MAE: 1.1005  Corr: 0.5206 
2024-06-11 19:34:25:INFO:TRAIN-(cmcm) (6/39/5)>> loss: 0.6363
2024-06-11 19:34:28:INFO:VAL-(cmcm) >>
2024-06-11 19:34:28:INFO:M: >>  Has0_acc_2: 0.7162  Has0_F1_score: 0.7147  Non0_acc_2: 0.7130  Non0_F1_score: 0.7125  Mult_acc_5: 0.3755  Mult_acc_7: 0.2969  MAE: 1.1678  Corr: 0.4651 
2024-06-11 19:34:42:INFO:TRAIN-(cmcm) (7/40/5)>> loss: 0.6279
2024-06-11 19:34:45:INFO:VAL-(cmcm) >>
2024-06-11 19:34:45:INFO:M: >>  Has0_acc_2: 0.7249  Has0_F1_score: 0.7148  Non0_acc_2: 0.7130  Non0_F1_score: 0.7030  Mult_acc_5: 0.4061  Mult_acc_7: 0.3362  MAE: 1.1337  Corr: 0.5035 
2024-06-11 19:35:00:INFO:TRAIN-(cmcm) (8/41/5)>> loss: 0.6221
2024-06-11 19:35:02:INFO:VAL-(cmcm) >>
2024-06-11 19:35:02:INFO:M: >>  Has0_acc_2: 0.7162  Has0_F1_score: 0.7181  Non0_acc_2: 0.7222  Non0_F1_score: 0.7226  Mult_acc_5: 0.3712  Mult_acc_7: 0.2926  MAE: 1.1844  Corr: 0.5044 
2024-06-11 19:35:17:INFO:TRAIN-(cmcm) (9/42/5)>> loss: 0.6102
2024-06-11 19:35:19:INFO:VAL-(cmcm) >>
2024-06-11 19:35:19:INFO:M: >>  Has0_acc_2: 0.7074  Has0_F1_score: 0.7072  Non0_acc_2: 0.7222  Non0_F1_score: 0.7226  Mult_acc_5: 0.3712  Mult_acc_7: 0.2969  MAE: 1.1127  Corr: 0.5107 
2024-06-11 19:35:34:INFO:TRAIN-(cmcm) (10/43/5)>> loss: 0.5955
2024-06-11 19:35:36:INFO:VAL-(cmcm) >>
2024-06-11 19:35:36:INFO:M: >>  Has0_acc_2: 0.6987  Has0_F1_score: 0.7015  Non0_acc_2: 0.6806  Non0_F1_score: 0.6820  Mult_acc_5: 0.3668  Mult_acc_7: 0.3100  MAE: 1.1547  Corr: 0.4585 
2024-06-11 19:35:44:INFO:TEST-(cmcm) >>
2024-06-11 19:35:44:INFO:M: >>  Has0_acc_2: 0.6487  Has0_F1_score: 0.6429  Non0_acc_2: 0.6524  Non0_F1_score: 0.6509  Mult_acc_5: 0.2901  Mult_acc_7: 0.2507  MAE: 1.3060  Corr: 0.4579 
2024-06-11 19:35:44:INFO:Results are added to results/results/mosi-regression-80.csv...
2024-06-11 19:35:44:INFO:Start running cmcm...
2024-06-11 19:35:44:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 90, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-06-11 19:35:44:INFO:Let's use the GPU 1 !
2024-06-11 19:35:44:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 19:35:44:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718105745 HTTP/1.1" 200 235
2024-06-11 19:35:45:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 19:35:45:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 19:35:46:INFO:train samples: (1284,)
2024-06-11 19:35:46:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 19:35:46:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718105746 HTTP/1.1" 200 235
2024-06-11 19:35:46:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 19:35:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 19:35:47:INFO:valid samples: (229,)
2024-06-11 19:35:47:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 19:35:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718105748 HTTP/1.1" 200 235
2024-06-11 19:35:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 19:35:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 19:35:49:INFO:test samples: (686,)
2024-06-11 19:35:49:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 19:35:49:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718105749 HTTP/1.1" 200 235
2024-06-11 19:35:49:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 19:35:50:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 19:35:50:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 19:35:50:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718105751 HTTP/1.1" 200 235
2024-06-11 19:35:51:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 19:35:51:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 19:35:51:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-11 19:35:51:WARNING:Try importing flash-attention for faster inference...
2024-06-11 19:35:51:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-11 19:35:51:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-11 19:35:51:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-11 19:35:52:INFO:trainable params: 1310284 || all params: 1838138956 || trainable%: 0.07128318540461856
2024-06-11 19:35:52:INFO:Init labels...
2024-06-11 19:35:52:INFO:Start training...
2024-06-11 19:36:07:INFO:TRAIN-(cmcm) (1/1/1)>> loss: 2.2057
2024-06-11 19:36:09:INFO:VAL-(cmcm) >>
2024-06-11 19:36:09:INFO:M: >>  Has0_acc_2: 0.5633  Has0_F1_score: 0.4882  Non0_acc_2: 0.5278  Non0_F1_score: 0.4757  Mult_acc_5: 0.2838  Mult_acc_7: 0.1921  MAE: 1.9123  Corr: -0.0231 
2024-06-11 19:36:09:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-11 19:36:24:INFO:TRAIN-(cmcm) (1/2/1)>> loss: 0.9464
2024-06-11 19:36:27:INFO:VAL-(cmcm) >>
2024-06-11 19:36:27:INFO:M: >>  Has0_acc_2: 0.5371  Has0_F1_score: 0.5263  Non0_acc_2: 0.5278  Non0_F1_score: 0.5166  Mult_acc_5: 0.2314  Mult_acc_7: 0.1747  MAE: 1.9062  Corr: 0.0163 
2024-06-11 19:36:27:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-11 19:36:42:INFO:TRAIN-(cmcm) (1/3/1)>> loss: 0.9279
2024-06-11 19:36:45:INFO:VAL-(cmcm) >>
2024-06-11 19:36:45:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5315  Non0_acc_2: 0.5556  Non0_F1_score: 0.5132  Mult_acc_5: 0.3144  Mult_acc_7: 0.2402  MAE: 1.6202  Corr: 0.0124 
2024-06-11 19:36:45:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-mosi-regression.pth.
2024-06-11 19:37:00:INFO:TRAIN-(cmcm) (1/4/1)>> loss: 0.9061
2024-06-11 19:37:03:INFO:VAL-(cmcm) >>
2024-06-11 19:37:03:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.5499  Non0_acc_2: 0.5556  Non0_F1_score: 0.5362  Mult_acc_5: 0.1703  Mult_acc_7: 0.1703  MAE: 1.5606  Corr: 0.0031 
2024-06-11 19:37:03:INFO:Saving checkpoint at epoch 4 to results/models/cmcm-mosi-regression.pth.
2024-06-11 19:37:18:INFO:TRAIN-(cmcm) (1/5/1)>> loss: 0.8894
2024-06-11 19:37:20:INFO:VAL-(cmcm) >>
2024-06-11 19:37:20:INFO:M: >>  Has0_acc_2: 0.5546  Has0_F1_score: 0.5457  Non0_acc_2: 0.5463  Non0_F1_score: 0.5356  Mult_acc_5: 0.1921  Mult_acc_7: 0.1878  MAE: 1.6069  Corr: 0.0217 
2024-06-11 19:37:35:INFO:TRAIN-(cmcm) (2/6/1)>> loss: 0.8838
2024-06-11 19:37:38:INFO:VAL-(cmcm) >>
2024-06-11 19:37:38:INFO:M: >>  Has0_acc_2: 0.4803  Has0_F1_score: 0.4773  Non0_acc_2: 0.4954  Non0_F1_score: 0.4890  Mult_acc_5: 0.2052  Mult_acc_7: 0.1703  MAE: 1.7811  Corr: 0.0391 
2024-06-11 19:37:53:INFO:TRAIN-(cmcm) (3/7/1)>> loss: 0.8895
2024-06-11 19:37:56:INFO:VAL-(cmcm) >>
2024-06-11 19:37:56:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4652  Non0_acc_2: 0.5741  Non0_F1_score: 0.4346  Mult_acc_5: 0.1572  Mult_acc_7: 0.1572  MAE: 1.5191  Corr: -0.0817 
2024-06-11 19:37:56:INFO:Saving checkpoint at epoch 7 to results/models/cmcm-mosi-regression.pth.
2024-06-11 19:38:11:INFO:TRAIN-(cmcm) (1/8/1)>> loss: 0.8846
2024-06-11 19:38:13:INFO:VAL-(cmcm) >>
2024-06-11 19:38:13:INFO:M: >>  Has0_acc_2: 0.5590  Has0_F1_score: 0.5055  Non0_acc_2: 0.5463  Non0_F1_score: 0.4888  Mult_acc_5: 0.2838  Mult_acc_7: 0.2052  MAE: 1.8040  Corr: -0.0363 
2024-06-11 19:38:28:INFO:TRAIN-(cmcm) (2/9/1)>> loss: 0.8787
2024-06-11 19:38:30:INFO:VAL-(cmcm) >>
2024-06-11 19:38:30:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4630  Non0_acc_2: 0.5741  Non0_F1_score: 0.4346  Mult_acc_5: 0.2227  Mult_acc_7: 0.1878  MAE: 1.5852  Corr: -0.0171 
2024-06-11 19:38:45:INFO:TRAIN-(cmcm) (3/10/1)>> loss: 0.8696
2024-06-11 19:38:48:INFO:VAL-(cmcm) >>
2024-06-11 19:38:48:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.5527  Non0_acc_2: 0.5694  Non0_F1_score: 0.5356  Mult_acc_5: 0.1703  Mult_acc_7: 0.1703  MAE: 1.5510  Corr: 0.0128 
2024-06-11 19:39:02:INFO:TRAIN-(cmcm) (4/11/1)>> loss: 0.8620
2024-06-11 19:39:05:INFO:VAL-(cmcm) >>
2024-06-11 19:39:05:INFO:M: >>  Has0_acc_2: 0.5502  Has0_F1_score: 0.5317  Non0_acc_2: 0.5463  Non0_F1_score: 0.5482  Mult_acc_5: 0.2358  Mult_acc_7: 0.2096  MAE: 1.5276  Corr: 0.0538 
2024-06-11 19:39:19:INFO:TRAIN-(cmcm) (5/12/1)>> loss: 0.8594
2024-06-11 19:39:22:INFO:VAL-(cmcm) >>
2024-06-11 19:39:22:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5147  Non0_acc_2: 0.5602  Non0_F1_score: 0.4987  Mult_acc_5: 0.2838  Mult_acc_7: 0.2052  MAE: 1.8193  Corr: -0.0004 
2024-06-11 19:39:36:INFO:TRAIN-(cmcm) (6/13/1)>> loss: 0.8511
2024-06-11 19:39:39:INFO:VAL-(cmcm) >>
2024-06-11 19:39:39:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.5390  Non0_acc_2: 0.5509  Non0_F1_score: 0.5304  Mult_acc_5: 0.2707  Mult_acc_7: 0.2227  MAE: 1.6066  Corr: 0.0129 
2024-06-11 19:39:54:INFO:TRAIN-(cmcm) (7/14/1)>> loss: 0.8545
2024-06-11 19:39:56:INFO:VAL-(cmcm) >>
2024-06-11 19:39:56:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5309  Non0_acc_2: 0.5741  Non0_F1_score: 0.5125  Mult_acc_5: 0.2795  Mult_acc_7: 0.2009  MAE: 1.7861  Corr: 0.0291 
2024-06-11 19:40:11:INFO:TRAIN-(cmcm) (8/15/1)>> loss: 0.8496
2024-06-11 19:40:13:INFO:VAL-(cmcm) >>
2024-06-11 19:40:13:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4742  Non0_acc_2: 0.5972  Non0_F1_score: 0.4884  Mult_acc_5: 0.3275  Mult_acc_7: 0.2445  MAE: 1.6940  Corr: 0.0496 
2024-06-11 19:40:28:INFO:TRAIN-(cmcm) (9/16/1)>> loss: 0.8453
2024-06-11 19:40:30:INFO:VAL-(cmcm) >>
2024-06-11 19:40:30:INFO:M: >>  Has0_acc_2: 0.6638  Has0_F1_score: 0.6613  Non0_acc_2: 0.6667  Non0_F1_score: 0.6635  Mult_acc_5: 0.3188  Mult_acc_7: 0.2358  MAE: 1.4970  Corr: 0.2819 
2024-06-11 19:40:31:INFO:Saving checkpoint at epoch 16 to results/models/cmcm-mosi-regression.pth.
2024-06-11 19:40:46:INFO:TRAIN-(cmcm) (1/17/1)>> loss: 0.8409
2024-06-11 19:40:48:INFO:VAL-(cmcm) >>
2024-06-11 19:40:48:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.4718  Non0_acc_2: 0.5741  Non0_F1_score: 0.5763  Mult_acc_5: 0.3362  Mult_acc_7: 0.2795  MAE: 1.4110  Corr: 0.1830 
2024-06-11 19:40:49:INFO:Saving checkpoint at epoch 17 to results/models/cmcm-mosi-regression.pth.
2024-06-11 19:41:04:INFO:TRAIN-(cmcm) (1/18/1)>> loss: 0.8297
2024-06-11 19:41:06:INFO:VAL-(cmcm) >>
2024-06-11 19:41:06:INFO:M: >>  Has0_acc_2: 0.7031  Has0_F1_score: 0.6998  Non0_acc_2: 0.7130  Non0_F1_score: 0.7080  Mult_acc_5: 0.3450  Mult_acc_7: 0.2620  MAE: 1.4280  Corr: 0.3914 
2024-06-11 19:41:21:INFO:TRAIN-(cmcm) (2/19/1)>> loss: 0.8204
2024-06-11 19:41:23:INFO:VAL-(cmcm) >>
2024-06-11 19:41:23:INFO:M: >>  Has0_acc_2: 0.6856  Has0_F1_score: 0.6837  Non0_acc_2: 0.7361  Non0_F1_score: 0.7350  Mult_acc_5: 0.3843  Mult_acc_7: 0.2969  MAE: 1.1848  Corr: 0.4723 
2024-06-11 19:41:23:INFO:Saving checkpoint at epoch 19 to results/models/cmcm-mosi-regression.pth.
2024-06-11 19:41:38:INFO:TRAIN-(cmcm) (1/20/1)>> loss: 0.8142
2024-06-11 19:41:41:INFO:VAL-(cmcm) >>
2024-06-11 19:41:41:INFO:M: >>  Has0_acc_2: 0.6769  Has0_F1_score: 0.6693  Non0_acc_2: 0.6944  Non0_F1_score: 0.6850  Mult_acc_5: 0.3231  Mult_acc_7: 0.2664  MAE: 1.2014  Corr: 0.4407 
2024-06-11 19:41:56:INFO:TRAIN-(cmcm) (2/21/1)>> loss: 0.7992
2024-06-11 19:41:58:INFO:VAL-(cmcm) >>
2024-06-11 19:41:58:INFO:M: >>  Has0_acc_2: 0.7074  Has0_F1_score: 0.7094  Non0_acc_2: 0.7269  Non0_F1_score: 0.7262  Mult_acc_5: 0.3581  Mult_acc_7: 0.2795  MAE: 1.1416  Corr: 0.5421 
2024-06-11 19:41:59:INFO:Saving checkpoint at epoch 21 to results/models/cmcm-mosi-regression.pth.
2024-06-11 19:42:14:INFO:TRAIN-(cmcm) (1/22/1)>> loss: 0.7774
2024-06-11 19:42:16:INFO:VAL-(cmcm) >>
2024-06-11 19:42:16:INFO:M: >>  Has0_acc_2: 0.6856  Has0_F1_score: 0.6579  Non0_acc_2: 0.6759  Non0_F1_score: 0.6553  Mult_acc_5: 0.3450  Mult_acc_7: 0.2533  MAE: 1.3555  Corr: 0.3765 
2024-06-11 19:42:31:INFO:TRAIN-(cmcm) (2/23/1)>> loss: 0.7748
2024-06-11 19:42:33:INFO:VAL-(cmcm) >>
2024-06-11 19:42:33:INFO:M: >>  Has0_acc_2: 0.7424  Has0_F1_score: 0.7384  Non0_acc_2: 0.7778  Non0_F1_score: 0.7762  Mult_acc_5: 0.3974  Mult_acc_7: 0.2882  MAE: 1.1621  Corr: 0.5648 
2024-06-11 19:42:48:INFO:TRAIN-(cmcm) (3/24/1)>> loss: 0.7650
2024-06-11 19:42:50:INFO:VAL-(cmcm) >>
2024-06-11 19:42:50:INFO:M: >>  Has0_acc_2: 0.7074  Has0_F1_score: 0.7103  Non0_acc_2: 0.7269  Non0_F1_score: 0.7283  Mult_acc_5: 0.3886  Mult_acc_7: 0.2664  MAE: 1.2215  Corr: 0.5230 
2024-06-11 19:43:05:INFO:TRAIN-(cmcm) (4/25/1)>> loss: 0.7518
2024-06-11 19:43:07:INFO:VAL-(cmcm) >>
2024-06-11 19:43:07:INFO:M: >>  Has0_acc_2: 0.7118  Has0_F1_score: 0.7040  Non0_acc_2: 0.7176  Non0_F1_score: 0.7094  Mult_acc_5: 0.4061  Mult_acc_7: 0.3188  MAE: 1.0865  Corr: 0.5715 
2024-06-11 19:43:08:INFO:Saving checkpoint at epoch 25 to results/models/cmcm-mosi-regression.pth.
2024-06-11 19:43:23:INFO:TRAIN-(cmcm) (1/26/1)>> loss: 0.7293
2024-06-11 19:43:25:INFO:VAL-(cmcm) >>
2024-06-11 19:43:25:INFO:M: >>  Has0_acc_2: 0.6987  Has0_F1_score: 0.6804  Non0_acc_2: 0.7130  Non0_F1_score: 0.7018  Mult_acc_5: 0.3406  Mult_acc_7: 0.2838  MAE: 1.1829  Corr: 0.4985 
2024-06-11 19:43:40:INFO:TRAIN-(cmcm) (2/27/1)>> loss: 0.7314
2024-06-11 19:43:42:INFO:VAL-(cmcm) >>
2024-06-11 19:43:42:INFO:M: >>  Has0_acc_2: 0.7249  Has0_F1_score: 0.7198  Non0_acc_2: 0.7500  Non0_F1_score: 0.7470  Mult_acc_5: 0.3886  Mult_acc_7: 0.3013  MAE: 1.1298  Corr: 0.5345 
2024-06-11 19:43:57:INFO:TRAIN-(cmcm) (3/28/1)>> loss: 0.7208
2024-06-11 19:43:59:INFO:VAL-(cmcm) >>
2024-06-11 19:43:59:INFO:M: >>  Has0_acc_2: 0.7249  Has0_F1_score: 0.7123  Non0_acc_2: 0.7315  Non0_F1_score: 0.7260  Mult_acc_5: 0.4017  Mult_acc_7: 0.3231  MAE: 1.1433  Corr: 0.5016 
2024-06-11 19:44:14:INFO:TRAIN-(cmcm) (4/29/1)>> loss: 0.7099
2024-06-11 19:44:17:INFO:VAL-(cmcm) >>
2024-06-11 19:44:17:INFO:M: >>  Has0_acc_2: 0.7598  Has0_F1_score: 0.7529  Non0_acc_2: 0.7407  Non0_F1_score: 0.7383  Mult_acc_5: 0.3537  Mult_acc_7: 0.2795  MAE: 1.1106  Corr: 0.5590 
2024-06-11 19:44:31:INFO:TRAIN-(cmcm) (5/30/1)>> loss: 0.7210
2024-06-11 19:44:34:INFO:VAL-(cmcm) >>
2024-06-11 19:44:34:INFO:M: >>  Has0_acc_2: 0.7555  Has0_F1_score: 0.7521  Non0_acc_2: 0.7361  Non0_F1_score: 0.7369  Mult_acc_5: 0.3799  Mult_acc_7: 0.3188  MAE: 1.0886  Corr: 0.5340 
2024-06-11 19:44:48:INFO:TRAIN-(cmcm) (6/31/1)>> loss: 0.6964
2024-06-11 19:44:51:INFO:VAL-(cmcm) >>
2024-06-11 19:44:51:INFO:M: >>  Has0_acc_2: 0.7642  Has0_F1_score: 0.7633  Non0_acc_2: 0.7222  Non0_F1_score: 0.7209  Mult_acc_5: 0.3537  Mult_acc_7: 0.3013  MAE: 1.0785  Corr: 0.5676 
2024-06-11 19:44:51:INFO:Saving checkpoint at epoch 31 to results/models/cmcm-mosi-regression.pth.
2024-06-11 19:45:06:INFO:TRAIN-(cmcm) (1/32/1)>> loss: 0.6783
2024-06-11 19:45:09:INFO:VAL-(cmcm) >>
2024-06-11 19:45:09:INFO:M: >>  Has0_acc_2: 0.7380  Has0_F1_score: 0.7241  Non0_acc_2: 0.7500  Non0_F1_score: 0.7423  Mult_acc_5: 0.3581  Mult_acc_7: 0.2838  MAE: 1.1595  Corr: 0.5041 
2024-06-11 19:45:23:INFO:TRAIN-(cmcm) (2/33/1)>> loss: 0.6745
2024-06-11 19:45:26:INFO:VAL-(cmcm) >>
2024-06-11 19:45:26:INFO:M: >>  Has0_acc_2: 0.6638  Has0_F1_score: 0.6553  Non0_acc_2: 0.6759  Non0_F1_score: 0.6671  Mult_acc_5: 0.3668  Mult_acc_7: 0.2838  MAE: 1.2953  Corr: 0.3663 
2024-06-11 19:45:40:INFO:TRAIN-(cmcm) (3/34/1)>> loss: 0.6923
2024-06-11 19:45:43:INFO:VAL-(cmcm) >>
2024-06-11 19:45:43:INFO:M: >>  Has0_acc_2: 0.7424  Has0_F1_score: 0.7376  Non0_acc_2: 0.7500  Non0_F1_score: 0.7470  Mult_acc_5: 0.3755  Mult_acc_7: 0.3100  MAE: 1.1462  Corr: 0.5005 
2024-06-11 19:45:57:INFO:TRAIN-(cmcm) (4/35/1)>> loss: 0.6800
2024-06-11 19:46:00:INFO:VAL-(cmcm) >>
2024-06-11 19:46:00:INFO:M: >>  Has0_acc_2: 0.7336  Has0_F1_score: 0.7278  Non0_acc_2: 0.7176  Non0_F1_score: 0.7159  Mult_acc_5: 0.3493  Mult_acc_7: 0.2751  MAE: 1.1656  Corr: 0.4804 
2024-06-11 19:46:15:INFO:TRAIN-(cmcm) (5/36/1)>> loss: 0.6595
2024-06-11 19:46:17:INFO:VAL-(cmcm) >>
2024-06-11 19:46:17:INFO:M: >>  Has0_acc_2: 0.7511  Has0_F1_score: 0.7465  Non0_acc_2: 0.7361  Non0_F1_score: 0.7345  Mult_acc_5: 0.3755  Mult_acc_7: 0.2969  MAE: 1.0678  Corr: 0.5775 
2024-06-11 19:46:17:INFO:Saving checkpoint at epoch 36 to results/models/cmcm-mosi-regression.pth.
2024-06-11 19:46:32:INFO:TRAIN-(cmcm) (1/37/1)>> loss: 0.6624
2024-06-11 19:46:35:INFO:VAL-(cmcm) >>
2024-06-11 19:46:35:INFO:M: >>  Has0_acc_2: 0.7555  Has0_F1_score: 0.7550  Non0_acc_2: 0.7315  Non0_F1_score: 0.7326  Mult_acc_5: 0.3362  Mult_acc_7: 0.2707  MAE: 1.1560  Corr: 0.5107 
2024-06-11 19:46:49:INFO:TRAIN-(cmcm) (2/38/1)>> loss: 0.6486
2024-06-11 19:46:52:INFO:VAL-(cmcm) >>
2024-06-11 19:46:52:INFO:M: >>  Has0_acc_2: 0.7642  Has0_F1_score: 0.7633  Non0_acc_2: 0.7037  Non0_F1_score: 0.7051  Mult_acc_5: 0.3886  Mult_acc_7: 0.3100  MAE: 1.1379  Corr: 0.5256 
2024-06-11 19:47:07:INFO:TRAIN-(cmcm) (3/39/1)>> loss: 0.6415
2024-06-11 19:47:09:INFO:VAL-(cmcm) >>
2024-06-11 19:47:09:INFO:M: >>  Has0_acc_2: 0.7074  Has0_F1_score: 0.6827  Non0_acc_2: 0.7130  Non0_F1_score: 0.7062  Mult_acc_5: 0.3799  Mult_acc_7: 0.3013  MAE: 1.1660  Corr: 0.5343 
2024-06-11 19:47:24:INFO:TRAIN-(cmcm) (4/40/1)>> loss: 0.6386
2024-06-11 19:47:26:INFO:VAL-(cmcm) >>
2024-06-11 19:47:26:INFO:M: >>  Has0_acc_2: 0.7336  Has0_F1_score: 0.7356  Non0_acc_2: 0.7593  Non0_F1_score: 0.7605  Mult_acc_5: 0.4017  Mult_acc_7: 0.3144  MAE: 1.0892  Corr: 0.5761 
2024-06-11 19:47:41:INFO:TRAIN-(cmcm) (5/41/1)>> loss: 0.6146
2024-06-11 19:47:43:INFO:VAL-(cmcm) >>
2024-06-11 19:47:43:INFO:M: >>  Has0_acc_2: 0.7162  Has0_F1_score: 0.7100  Non0_acc_2: 0.7315  Non0_F1_score: 0.7283  Mult_acc_5: 0.3755  Mult_acc_7: 0.2926  MAE: 1.1156  Corr: 0.5233 
2024-06-11 19:47:58:INFO:TRAIN-(cmcm) (6/42/1)>> loss: 0.6176
2024-06-11 19:48:01:INFO:VAL-(cmcm) >>
2024-06-11 19:48:01:INFO:M: >>  Has0_acc_2: 0.7249  Has0_F1_score: 0.7066  Non0_acc_2: 0.7361  Non0_F1_score: 0.7327  Mult_acc_5: 0.3886  Mult_acc_7: 0.2969  MAE: 1.0816  Corr: 0.5472 
2024-06-11 19:48:17:INFO:TRAIN-(cmcm) (7/43/1)>> loss: 0.5980
2024-06-11 19:48:20:INFO:VAL-(cmcm) >>
2024-06-11 19:48:20:INFO:M: >>  Has0_acc_2: 0.7467  Has0_F1_score: 0.7452  Non0_acc_2: 0.7361  Non0_F1_score: 0.7363  Mult_acc_5: 0.3581  Mult_acc_7: 0.3013  MAE: 1.1044  Corr: 0.5423 
2024-06-11 19:48:37:INFO:TRAIN-(cmcm) (8/44/1)>> loss: 0.5930
2024-06-11 19:48:40:INFO:VAL-(cmcm) >>
2024-06-11 19:48:40:INFO:M: >>  Has0_acc_2: 0.7424  Has0_F1_score: 0.7339  Non0_acc_2: 0.7639  Non0_F1_score: 0.7579  Mult_acc_5: 0.4148  Mult_acc_7: 0.3319  MAE: 1.1416  Corr: 0.5162 
2024-06-11 19:48:56:INFO:TRAIN-(cmcm) (9/45/1)>> loss: 0.5816
2024-06-11 19:48:58:INFO:VAL-(cmcm) >>
2024-06-11 19:48:58:INFO:M: >>  Has0_acc_2: 0.7336  Has0_F1_score: 0.7227  Non0_acc_2: 0.7500  Non0_F1_score: 0.7391  Mult_acc_5: 0.3275  Mult_acc_7: 0.2576  MAE: 1.1589  Corr: 0.4952 
2024-06-11 19:49:15:INFO:TRAIN-(cmcm) (10/46/1)>> loss: 0.5604
2024-06-11 19:49:19:INFO:VAL-(cmcm) >>
2024-06-11 19:49:19:INFO:M: >>  Has0_acc_2: 0.6987  Has0_F1_score: 0.6931  Non0_acc_2: 0.7361  Non0_F1_score: 0.7350  Mult_acc_5: 0.3581  Mult_acc_7: 0.2707  MAE: 1.1624  Corr: 0.5094 
2024-06-11 19:49:28:INFO:TEST-(cmcm) >>
2024-06-11 19:49:28:INFO:M: >>  Has0_acc_2: 0.6793  Has0_F1_score: 0.6802  Non0_acc_2: 0.6982  Non0_F1_score: 0.6992  Mult_acc_5: 0.3120  Mult_acc_7: 0.2711  MAE: 1.2026  Corr: 0.4899 
2024-06-11 19:49:28:INFO:Results are added to results/results/mosi-regression-90.csv...
2024-06-11 19:49:28:INFO:Start running cmcm...
2024-06-11 19:49:28:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 90, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 2222}>
2024-06-11 19:49:28:INFO:Let's use the GPU 1 !
2024-06-11 19:49:28:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 19:49:29:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718106569 HTTP/1.1" 200 235
2024-06-11 19:49:29:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 19:49:29:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 19:49:30:INFO:train samples: (1284,)
2024-06-11 19:49:30:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 19:49:31:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718106571 HTTP/1.1" 200 235
2024-06-11 19:49:31:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 19:49:31:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 19:49:32:INFO:valid samples: (229,)
2024-06-11 19:49:32:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 19:49:32:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718106572 HTTP/1.1" 200 235
2024-06-11 19:49:32:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 19:49:33:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 19:49:33:INFO:test samples: (686,)
2024-06-11 19:49:33:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 19:49:34:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718106574 HTTP/1.1" 200 235
2024-06-11 19:49:34:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 19:49:34:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 19:49:35:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 19:49:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718106575 HTTP/1.1" 200 235
2024-06-11 19:49:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 19:49:36:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 19:49:36:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-11 19:49:36:WARNING:Try importing flash-attention for faster inference...
2024-06-11 19:49:36:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-11 19:49:36:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-11 19:49:36:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-11 19:49:38:INFO:trainable params: 1310284 || all params: 1838138956 || trainable%: 0.07128318540461856
2024-06-11 19:49:38:INFO:Init labels...
2024-06-11 19:49:38:INFO:Start training...
2024-06-11 19:49:54:INFO:TRAIN-(cmcm) (1/1/2)>> loss: 2.9119
2024-06-11 19:49:57:INFO:VAL-(cmcm) >>
2024-06-11 19:49:57:INFO:M: >>  Has0_acc_2: 0.5240  Has0_F1_score: 0.5259  Non0_acc_2: 0.5278  Non0_F1_score: 0.5284  Mult_acc_5: 0.1921  Mult_acc_7: 0.1703  MAE: 1.6528  Corr: 0.0704 
2024-06-11 19:49:58:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-11 19:50:14:INFO:TRAIN-(cmcm) (1/2/2)>> loss: 0.9745
2024-06-11 19:50:16:INFO:VAL-(cmcm) >>
2024-06-11 19:50:16:INFO:M: >>  Has0_acc_2: 0.4716  Has0_F1_score: 0.4485  Non0_acc_2: 0.4815  Non0_F1_score: 0.4559  Mult_acc_5: 0.1528  Mult_acc_7: 0.1441  MAE: 1.8261  Corr: 0.0293 
2024-06-11 19:50:32:INFO:TRAIN-(cmcm) (2/3/2)>> loss: 0.9148
2024-06-11 19:50:35:INFO:VAL-(cmcm) >>
2024-06-11 19:50:35:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4866  Non0_acc_2: 0.5694  Non0_F1_score: 0.4595  Mult_acc_5: 0.1834  Mult_acc_7: 0.1616  MAE: 1.6490  Corr: -0.0276 
2024-06-11 19:50:35:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-mosi-regression.pth.
2024-06-11 19:50:52:INFO:TRAIN-(cmcm) (1/4/2)>> loss: 0.8891
2024-06-11 19:50:55:INFO:VAL-(cmcm) >>
2024-06-11 19:50:55:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.5568  Non0_acc_2: 0.5648  Non0_F1_score: 0.5514  Mult_acc_5: 0.2402  Mult_acc_7: 0.2140  MAE: 1.5340  Corr: 0.0671 
2024-06-11 19:50:55:INFO:Saving checkpoint at epoch 4 to results/models/cmcm-mosi-regression.pth.
2024-06-11 19:51:11:INFO:TRAIN-(cmcm) (1/5/2)>> loss: 0.8765
2024-06-11 19:51:14:INFO:VAL-(cmcm) >>
2024-06-11 19:51:14:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4950  Non0_acc_2: 0.5926  Non0_F1_score: 0.5477  Mult_acc_5: 0.2402  Mult_acc_7: 0.2009  MAE: 1.5280  Corr: 0.1247 
2024-06-11 19:51:15:INFO:Saving checkpoint at epoch 5 to results/models/cmcm-mosi-regression.pth.
2024-06-11 19:51:31:INFO:TRAIN-(cmcm) (1/6/2)>> loss: 0.8712
2024-06-11 19:51:33:INFO:VAL-(cmcm) >>
2024-06-11 19:51:33:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5028  Non0_acc_2: 0.5509  Non0_F1_score: 0.4795  Mult_acc_5: 0.2838  Mult_acc_7: 0.2096  MAE: 1.7777  Corr: -0.0204 
2024-06-11 19:51:49:INFO:TRAIN-(cmcm) (2/7/2)>> loss: 0.8894
2024-06-11 19:51:52:INFO:VAL-(cmcm) >>
2024-06-11 19:51:52:INFO:M: >>  Has0_acc_2: 0.5633  Has0_F1_score: 0.5048  Non0_acc_2: 0.5509  Non0_F1_score: 0.4881  Mult_acc_5: 0.2707  Mult_acc_7: 0.2140  MAE: 1.5667  Corr: 0.0687 
2024-06-11 19:52:08:INFO:TRAIN-(cmcm) (3/8/2)>> loss: 0.8768
2024-06-11 19:52:11:INFO:VAL-(cmcm) >>
2024-06-11 19:52:11:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.5220  Non0_acc_2: 0.5556  Non0_F1_score: 0.5132  Mult_acc_5: 0.2533  Mult_acc_7: 0.1965  MAE: 1.6165  Corr: 0.0330 
2024-06-11 19:52:28:INFO:TRAIN-(cmcm) (4/9/2)>> loss: 0.8685
2024-06-11 19:52:31:INFO:VAL-(cmcm) >>
2024-06-11 19:52:31:INFO:M: >>  Has0_acc_2: 0.5371  Has0_F1_score: 0.5023  Non0_acc_2: 0.5231  Non0_F1_score: 0.4857  Mult_acc_5: 0.2576  Mult_acc_7: 0.1834  MAE: 1.7774  Corr: -0.0487 
2024-06-11 19:52:48:INFO:TRAIN-(cmcm) (5/10/2)>> loss: 0.8690
2024-06-11 19:52:51:INFO:VAL-(cmcm) >>
2024-06-11 19:52:51:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.4584  Non0_acc_2: 0.5602  Non0_F1_score: 0.4346  Mult_acc_5: 0.2751  Mult_acc_7: 0.2140  MAE: 1.7021  Corr: -0.0985 
2024-06-11 19:53:08:INFO:TRAIN-(cmcm) (6/11/2)>> loss: 0.8585
2024-06-11 19:53:11:INFO:VAL-(cmcm) >>
2024-06-11 19:53:11:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5209  Non0_acc_2: 0.5648  Non0_F1_score: 0.5019  Mult_acc_5: 0.2751  Mult_acc_7: 0.1921  MAE: 1.8944  Corr: 0.0007 
2024-06-11 19:53:28:INFO:TRAIN-(cmcm) (7/12/2)>> loss: 0.8555
2024-06-11 19:53:31:INFO:VAL-(cmcm) >>
2024-06-11 19:53:31:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.4911  Non0_acc_2: 0.5463  Non0_F1_score: 0.4671  Mult_acc_5: 0.2576  Mult_acc_7: 0.1878  MAE: 1.7084  Corr: -0.0253 
2024-06-11 19:53:48:INFO:TRAIN-(cmcm) (8/13/2)>> loss: 0.8552
2024-06-11 19:53:51:INFO:VAL-(cmcm) >>
2024-06-11 19:53:51:INFO:M: >>  Has0_acc_2: 0.5502  Has0_F1_score: 0.5389  Non0_acc_2: 0.5463  Non0_F1_score: 0.5323  Mult_acc_5: 0.2576  Mult_acc_7: 0.1790  MAE: 1.7643  Corr: 0.0468 
2024-06-11 19:54:08:INFO:TRAIN-(cmcm) (9/14/2)>> loss: 0.8546
2024-06-11 19:54:11:INFO:VAL-(cmcm) >>
2024-06-11 19:54:11:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.5099  Non0_acc_2: 0.5602  Non0_F1_score: 0.4902  Mult_acc_5: 0.2402  Mult_acc_7: 0.1921  MAE: 1.6254  Corr: 0.0450 
2024-06-11 19:54:28:INFO:TRAIN-(cmcm) (10/15/2)>> loss: 0.8521
2024-06-11 19:54:30:INFO:VAL-(cmcm) >>
2024-06-11 19:54:30:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5410  Non0_acc_2: 0.5741  Non0_F1_score: 0.5303  Mult_acc_5: 0.2402  Mult_acc_7: 0.1921  MAE: 1.5651  Corr: 0.0845 
2024-06-11 19:54:39:INFO:TEST-(cmcm) >>
2024-06-11 19:54:39:INFO:M: >>  Has0_acc_2: 0.4956  Has0_F1_score: 0.3978  Non0_acc_2: 0.4848  Non0_F1_score: 0.4423  Mult_acc_5: 0.2230  Mult_acc_7: 0.2114  MAE: 1.7443  Corr: 0.0883 
2024-06-11 19:54:39:INFO:Results are added to results/results/mosi-regression-90.csv...
2024-06-11 19:54:39:INFO:Start running cmcm...
2024-06-11 19:54:39:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 90, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 3333}>
2024-06-11 19:54:39:INFO:Let's use the GPU 1 !
2024-06-11 19:54:39:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 19:54:39:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718106880 HTTP/1.1" 200 235
2024-06-11 19:54:40:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 19:54:40:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 19:54:41:INFO:train samples: (1284,)
2024-06-11 19:54:41:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 19:54:41:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718106881 HTTP/1.1" 200 235
2024-06-11 19:54:42:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 19:54:42:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 19:54:43:INFO:valid samples: (229,)
2024-06-11 19:54:43:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 19:54:43:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718106883 HTTP/1.1" 200 235
2024-06-11 19:54:43:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 19:54:44:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 19:54:45:INFO:test samples: (686,)
2024-06-11 19:54:45:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 19:54:45:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718106885 HTTP/1.1" 200 235
2024-06-11 19:54:45:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 19:54:45:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 19:54:46:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 19:54:46:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718106886 HTTP/1.1" 200 235
2024-06-11 19:54:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 19:54:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 19:54:47:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-11 19:54:47:WARNING:Try importing flash-attention for faster inference...
2024-06-11 19:54:47:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-11 19:54:47:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-11 19:54:47:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-11 19:54:51:INFO:trainable params: 1310284 || all params: 1838138956 || trainable%: 0.07128318540461856
2024-06-11 19:54:51:INFO:Init labels...
2024-06-11 19:54:51:INFO:Start training...
2024-06-11 19:55:07:INFO:TRAIN-(cmcm) (1/1/3)>> loss: 3.6186
2024-06-11 19:55:10:INFO:VAL-(cmcm) >>
2024-06-11 19:55:10:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4556  Non0_acc_2: 0.5694  Non0_F1_score: 0.4966  Mult_acc_5: 0.2969  Mult_acc_7: 0.1790  MAE: 2.0197  Corr: -0.0625 
2024-06-11 19:55:10:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-11 19:55:27:INFO:TRAIN-(cmcm) (1/2/3)>> loss: 1.0344
2024-06-11 19:55:30:INFO:VAL-(cmcm) >>
2024-06-11 19:55:30:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4866  Non0_acc_2: 0.5648  Non0_F1_score: 0.4791  Mult_acc_5: 0.1878  Mult_acc_7: 0.1878  MAE: 1.4432  Corr: 0.0287 
2024-06-11 19:55:31:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-11 19:55:47:INFO:TRAIN-(cmcm) (1/3/3)>> loss: 0.9124
2024-06-11 19:55:50:INFO:VAL-(cmcm) >>
2024-06-11 19:55:50:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4866  Non0_acc_2: 0.5694  Non0_F1_score: 0.4595  Mult_acc_5: 0.2183  Mult_acc_7: 0.1616  MAE: 1.7154  Corr: 0.0301 
2024-06-11 19:56:05:INFO:TRAIN-(cmcm) (2/4/3)>> loss: 0.8966
2024-06-11 19:56:08:INFO:VAL-(cmcm) >>
2024-06-11 19:56:08:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.5086  Non0_acc_2: 0.5648  Non0_F1_score: 0.4739  Mult_acc_5: 0.2882  Mult_acc_7: 0.2096  MAE: 1.6481  Corr: 0.0054 
2024-06-11 19:56:23:INFO:TRAIN-(cmcm) (3/5/3)>> loss: 0.8940
2024-06-11 19:56:26:INFO:VAL-(cmcm) >>
2024-06-11 19:56:26:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4923  Non0_acc_2: 0.5509  Non0_F1_score: 0.4651  Mult_acc_5: 0.2402  Mult_acc_7: 0.2227  MAE: 1.6209  Corr: 0.0160 
2024-06-11 19:56:41:INFO:TRAIN-(cmcm) (4/6/3)>> loss: 0.8933
2024-06-11 19:56:43:INFO:VAL-(cmcm) >>
2024-06-11 19:56:43:INFO:M: >>  Has0_acc_2: 0.5633  Has0_F1_score: 0.5305  Non0_acc_2: 0.5509  Non0_F1_score: 0.5156  Mult_acc_5: 0.2271  Mult_acc_7: 0.1747  MAE: 1.7009  Corr: 0.0073 
2024-06-11 19:56:59:INFO:TRAIN-(cmcm) (5/7/3)>> loss: 0.8757
2024-06-11 19:57:02:INFO:VAL-(cmcm) >>
2024-06-11 19:57:02:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.4968  Non0_acc_2: 0.5463  Non0_F1_score: 0.4671  Mult_acc_5: 0.1747  Mult_acc_7: 0.1703  MAE: 1.5270  Corr: -0.0108 
2024-06-11 19:57:17:INFO:TRAIN-(cmcm) (6/8/3)>> loss: 0.8651
2024-06-11 19:57:20:INFO:VAL-(cmcm) >>
2024-06-11 19:57:20:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5621  Non0_acc_2: 0.5833  Non0_F1_score: 0.5492  Mult_acc_5: 0.2707  Mult_acc_7: 0.1878  MAE: 1.6861  Corr: 0.0602 
2024-06-11 19:57:36:INFO:TRAIN-(cmcm) (7/9/3)>> loss: 0.8620
2024-06-11 19:57:38:INFO:VAL-(cmcm) >>
2024-06-11 19:57:38:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.4998  Non0_acc_2: 0.4583  Non0_F1_score: 0.4163  Mult_acc_5: 0.2314  Mult_acc_7: 0.2140  MAE: 1.5126  Corr: -0.0255 
2024-06-11 19:57:53:INFO:TRAIN-(cmcm) (8/10/3)>> loss: 0.8594
2024-06-11 19:57:56:INFO:VAL-(cmcm) >>
2024-06-11 19:57:56:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4577  Non0_acc_2: 0.5694  Non0_F1_score: 0.4246  Mult_acc_5: 0.2445  Mult_acc_7: 0.1965  MAE: 1.5966  Corr: -0.0097 
2024-06-11 19:58:12:INFO:TRAIN-(cmcm) (9/11/3)>> loss: 0.8578
2024-06-11 19:58:14:INFO:VAL-(cmcm) >>
2024-06-11 19:58:14:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5694  Non0_F1_score: 0.4166  Mult_acc_5: 0.2926  Mult_acc_7: 0.2227  MAE: 1.7320  Corr: 0.0080 
2024-06-11 19:58:30:INFO:TRAIN-(cmcm) (10/12/3)>> loss: 0.8588
2024-06-11 19:58:33:INFO:VAL-(cmcm) >>
2024-06-11 19:58:33:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.5178  Non0_acc_2: 0.5602  Non0_F1_score: 0.5026  Mult_acc_5: 0.1703  Mult_acc_7: 0.1616  MAE: 1.6564  Corr: -0.0588 
2024-06-11 19:58:41:INFO:TEST-(cmcm) >>
2024-06-11 19:58:41:INFO:M: >>  Has0_acc_2: 0.4752  Has0_F1_score: 0.3610  Non0_acc_2: 0.4634  Non0_F1_score: 0.3788  Mult_acc_5: 0.1618  Mult_acc_7: 0.1618  MAE: 1.5115  Corr: -0.0165 
2024-06-11 19:58:41:INFO:Results are added to results/results/mosi-regression-90.csv...
2024-06-11 19:58:41:INFO:Start running cmcm...
2024-06-11 19:58:41:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 90, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 4444}>
2024-06-11 19:58:41:INFO:Let's use the GPU 1 !
2024-06-11 19:58:41:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 19:58:42:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718107122 HTTP/1.1" 200 235
2024-06-11 19:58:42:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 19:58:42:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 19:58:43:INFO:train samples: (1284,)
2024-06-11 19:58:43:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 19:58:43:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718107124 HTTP/1.1" 200 235
2024-06-11 19:58:44:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 19:58:44:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 19:58:45:INFO:valid samples: (229,)
2024-06-11 19:58:45:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 19:58:45:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718107125 HTTP/1.1" 200 235
2024-06-11 19:58:45:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 19:58:45:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 19:58:46:INFO:test samples: (686,)
2024-06-11 19:58:46:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 19:58:46:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718107127 HTTP/1.1" 200 235
2024-06-11 19:58:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 19:58:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 19:58:47:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 19:58:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718107128 HTTP/1.1" 200 235
2024-06-11 19:58:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 19:58:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 19:58:48:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-11 19:58:48:WARNING:Try importing flash-attention for faster inference...
2024-06-11 19:58:48:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-11 19:58:48:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-11 19:58:48:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-11 19:58:51:INFO:trainable params: 1310284 || all params: 1838138956 || trainable%: 0.07128318540461856
2024-06-11 19:58:51:INFO:Init labels...
2024-06-11 19:58:51:INFO:Start training...
2024-06-11 19:59:06:INFO:TRAIN-(cmcm) (1/1/4)>> loss: 2.9542
2024-06-11 19:59:09:INFO:VAL-(cmcm) >>
2024-06-11 19:59:09:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.4438  Non0_acc_2: 0.5602  Non0_F1_score: 0.4857  Mult_acc_5: 0.2271  Mult_acc_7: 0.2096  MAE: 1.4894  Corr: 0.0175 
2024-06-11 19:59:09:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-11 19:59:26:INFO:TRAIN-(cmcm) (1/2/4)>> loss: 1.0720
2024-06-11 19:59:29:INFO:VAL-(cmcm) >>
2024-06-11 19:59:29:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5081  Non0_acc_2: 0.5231  Non0_F1_score: 0.5212  Mult_acc_5: 0.2009  Mult_acc_7: 0.2009  MAE: 1.4829  Corr: -0.0433 
2024-06-11 19:59:30:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-11 19:59:47:INFO:TRAIN-(cmcm) (1/3/4)>> loss: 1.0156
2024-06-11 19:59:50:INFO:VAL-(cmcm) >>
2024-06-11 19:59:50:INFO:M: >>  Has0_acc_2: 0.5590  Has0_F1_score: 0.5408  Non0_acc_2: 0.5278  Non0_F1_score: 0.5294  Mult_acc_5: 0.2052  Mult_acc_7: 0.2052  MAE: 1.4536  Corr: 0.0402 
2024-06-11 19:59:50:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-mosi-regression.pth.
2024-06-11 20:00:08:INFO:TRAIN-(cmcm) (1/4/4)>> loss: 0.9625
2024-06-11 20:00:11:INFO:VAL-(cmcm) >>
2024-06-11 20:00:11:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5741  Non0_F1_score: 0.4187  Mult_acc_5: 0.2314  Mult_acc_7: 0.1965  MAE: 1.5616  Corr: 0.0294 
2024-06-11 20:00:28:INFO:TRAIN-(cmcm) (2/5/4)>> loss: 2.0519
2024-06-11 20:00:31:INFO:VAL-(cmcm) >>
2024-06-11 20:00:31:INFO:M: >>  Has0_acc_2: 0.4847  Has0_F1_score: 0.4799  Non0_acc_2: 0.4954  Non0_F1_score: 0.4890  Mult_acc_5: 0.2009  Mult_acc_7: 0.1747  MAE: 1.7084  Corr: -0.0118 
2024-06-11 20:00:48:INFO:TRAIN-(cmcm) (3/6/4)>> loss: 0.9536
2024-06-11 20:00:50:INFO:VAL-(cmcm) >>
2024-06-11 20:00:50:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.5058  Non0_acc_2: 0.5741  Non0_F1_score: 0.4797  Mult_acc_5: 0.1747  Mult_acc_7: 0.1747  MAE: 1.5554  Corr: 0.0116 
2024-06-11 20:01:07:INFO:TRAIN-(cmcm) (4/7/4)>> loss: 0.8986
2024-06-11 20:01:10:INFO:VAL-(cmcm) >>
2024-06-11 20:01:10:INFO:M: >>  Has0_acc_2: 0.5415  Has0_F1_score: 0.5358  Non0_acc_2: 0.5324  Non0_F1_score: 0.5250  Mult_acc_5: 0.1790  Mult_acc_7: 0.1790  MAE: 1.6680  Corr: -0.0376 
2024-06-11 20:01:25:INFO:TRAIN-(cmcm) (5/8/4)>> loss: 0.8860
2024-06-11 20:01:28:INFO:VAL-(cmcm) >>
2024-06-11 20:01:28:INFO:M: >>  Has0_acc_2: 0.4541  Has0_F1_score: 0.3518  Non0_acc_2: 0.4815  Non0_F1_score: 0.3827  Mult_acc_5: 0.1659  Mult_acc_7: 0.1441  MAE: 1.8030  Corr: 0.1330 
2024-06-11 20:01:44:INFO:TRAIN-(cmcm) (6/9/4)>> loss: 0.8828
2024-06-11 20:01:46:INFO:VAL-(cmcm) >>
2024-06-11 20:01:46:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.4653  Non0_acc_2: 0.5648  Non0_F1_score: 0.4371  Mult_acc_5: 0.1659  Mult_acc_7: 0.1659  MAE: 1.5619  Corr: -0.0685 
2024-06-11 20:02:02:INFO:TRAIN-(cmcm) (7/10/4)>> loss: 0.8679
2024-06-11 20:02:04:INFO:VAL-(cmcm) >>
2024-06-11 20:02:04:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.5365  Non0_acc_2: 0.5556  Non0_F1_score: 0.5220  Mult_acc_5: 0.2838  Mult_acc_7: 0.2009  MAE: 1.7298  Corr: 0.0503 
2024-06-11 20:02:21:INFO:TRAIN-(cmcm) (8/11/4)>> loss: 0.8654
2024-06-11 20:02:24:INFO:VAL-(cmcm) >>
2024-06-11 20:02:24:INFO:M: >>  Has0_acc_2: 0.5371  Has0_F1_score: 0.5210  Non0_acc_2: 0.5324  Non0_F1_score: 0.5131  Mult_acc_5: 0.2795  Mult_acc_7: 0.2009  MAE: 1.8132  Corr: -0.0054 
2024-06-11 20:02:40:INFO:TRAIN-(cmcm) (9/12/4)>> loss: 0.8604
2024-06-11 20:02:43:INFO:VAL-(cmcm) >>
2024-06-11 20:02:43:INFO:M: >>  Has0_acc_2: 0.6332  Has0_F1_score: 0.6367  Non0_acc_2: 0.6481  Non0_F1_score: 0.6500  Mult_acc_5: 0.2183  Mult_acc_7: 0.2052  MAE: 1.4271  Corr: 0.2958 
2024-06-11 20:02:43:INFO:Saving checkpoint at epoch 12 to results/models/cmcm-mosi-regression.pth.
2024-06-11 20:03:00:INFO:TRAIN-(cmcm) (1/13/4)>> loss: 0.8486
2024-06-11 20:03:03:INFO:VAL-(cmcm) >>
2024-06-11 20:03:03:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.4584  Non0_acc_2: 0.5648  Non0_F1_score: 0.4299  Mult_acc_5: 0.2533  Mult_acc_7: 0.2227  MAE: 1.6100  Corr: -0.0324 
2024-06-11 20:03:18:INFO:TRAIN-(cmcm) (2/14/4)>> loss: 0.8452
2024-06-11 20:03:21:INFO:VAL-(cmcm) >>
2024-06-11 20:03:21:INFO:M: >>  Has0_acc_2: 0.6245  Has0_F1_score: 0.5559  Non0_acc_2: 0.6019  Non0_F1_score: 0.5323  Mult_acc_5: 0.2882  Mult_acc_7: 0.2052  MAE: 1.6756  Corr: 0.1018 
2024-06-11 20:03:38:INFO:TRAIN-(cmcm) (3/15/4)>> loss: 0.8543
2024-06-11 20:03:41:INFO:VAL-(cmcm) >>
2024-06-11 20:03:41:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.6107  Non0_acc_2: 0.6204  Non0_F1_score: 0.6224  Mult_acc_5: 0.2882  Mult_acc_7: 0.2140  MAE: 1.4368  Corr: 0.2736 
2024-06-11 20:03:57:INFO:TRAIN-(cmcm) (4/16/4)>> loss: 0.8391
2024-06-11 20:04:00:INFO:VAL-(cmcm) >>
2024-06-11 20:04:00:INFO:M: >>  Has0_acc_2: 0.6332  Has0_F1_score: 0.6219  Non0_acc_2: 0.6111  Non0_F1_score: 0.6083  Mult_acc_5: 0.2969  Mult_acc_7: 0.2271  MAE: 1.4149  Corr: 0.2215 
2024-06-11 20:04:01:INFO:Saving checkpoint at epoch 16 to results/models/cmcm-mosi-regression.pth.
2024-06-11 20:04:18:INFO:TRAIN-(cmcm) (1/17/4)>> loss: 0.8393
2024-06-11 20:04:21:INFO:VAL-(cmcm) >>
2024-06-11 20:04:21:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5316  Non0_acc_2: 0.5556  Non0_F1_score: 0.5578  Mult_acc_5: 0.2445  Mult_acc_7: 0.2271  MAE: 1.4324  Corr: 0.1367 
2024-06-11 20:04:38:INFO:TRAIN-(cmcm) (2/18/4)>> loss: 0.8327
2024-06-11 20:04:41:INFO:VAL-(cmcm) >>
2024-06-11 20:04:41:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4652  Non0_acc_2: 0.5833  Non0_F1_score: 0.4469  Mult_acc_5: 0.2271  Mult_acc_7: 0.1747  MAE: 1.5961  Corr: 0.0868 
2024-06-11 20:04:57:INFO:TRAIN-(cmcm) (3/19/4)>> loss: 0.8353
2024-06-11 20:05:01:INFO:VAL-(cmcm) >>
2024-06-11 20:05:01:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4742  Non0_acc_2: 0.5926  Non0_F1_score: 0.5215  Mult_acc_5: 0.2271  Mult_acc_7: 0.1790  MAE: 1.5114  Corr: 0.1144 
2024-06-11 20:05:17:INFO:TRAIN-(cmcm) (4/20/4)>> loss: 0.8253
2024-06-11 20:05:20:INFO:VAL-(cmcm) >>
2024-06-11 20:05:20:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.5394  Non0_acc_2: 0.5972  Non0_F1_score: 0.5939  Mult_acc_5: 0.3057  Mult_acc_7: 0.2533  MAE: 1.4069  Corr: 0.2382 
2024-06-11 20:05:21:INFO:Saving checkpoint at epoch 20 to results/models/cmcm-mosi-regression.pth.
2024-06-11 20:05:36:INFO:TRAIN-(cmcm) (1/21/4)>> loss: 0.8242
2024-06-11 20:05:39:INFO:VAL-(cmcm) >>
2024-06-11 20:05:39:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4976  Non0_acc_2: 0.5787  Non0_F1_score: 0.4711  Mult_acc_5: 0.3057  Mult_acc_7: 0.2227  MAE: 1.7389  Corr: 0.0162 
2024-06-11 20:05:53:INFO:TRAIN-(cmcm) (2/22/4)>> loss: 0.8214
2024-06-11 20:05:56:INFO:VAL-(cmcm) >>
2024-06-11 20:05:56:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.6029  Non0_acc_2: 0.5972  Non0_F1_score: 0.5956  Mult_acc_5: 0.3057  Mult_acc_7: 0.2402  MAE: 1.4113  Corr: 0.2259 
2024-06-11 20:06:10:INFO:TRAIN-(cmcm) (3/23/4)>> loss: 0.8123
2024-06-11 20:06:13:INFO:VAL-(cmcm) >>
2024-06-11 20:06:13:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.5158  Non0_acc_2: 0.5741  Non0_F1_score: 0.4902  Mult_acc_5: 0.2969  Mult_acc_7: 0.2140  MAE: 1.7057  Corr: 0.0431 
2024-06-11 20:06:27:INFO:TRAIN-(cmcm) (4/24/4)>> loss: 0.8095
2024-06-11 20:06:30:INFO:VAL-(cmcm) >>
2024-06-11 20:06:30:INFO:M: >>  Has0_acc_2: 0.6681  Has0_F1_score: 0.6604  Non0_acc_2: 0.6343  Non0_F1_score: 0.6350  Mult_acc_5: 0.2751  Mult_acc_7: 0.2402  MAE: 1.3973  Corr: 0.3136 
2024-06-11 20:06:30:INFO:Saving checkpoint at epoch 24 to results/models/cmcm-mosi-regression.pth.
2024-06-11 20:06:45:INFO:TRAIN-(cmcm) (1/25/4)>> loss: 0.8048
2024-06-11 20:06:48:INFO:VAL-(cmcm) >>
2024-06-11 20:06:48:INFO:M: >>  Has0_acc_2: 0.6201  Has0_F1_score: 0.5903  Non0_acc_2: 0.6157  Non0_F1_score: 0.6016  Mult_acc_5: 0.3144  Mult_acc_7: 0.2533  MAE: 1.4132  Corr: 0.2183 
2024-06-11 20:07:03:INFO:TRAIN-(cmcm) (2/26/4)>> loss: 0.8017
2024-06-11 20:07:05:INFO:VAL-(cmcm) >>
2024-06-11 20:07:05:INFO:M: >>  Has0_acc_2: 0.6419  Has0_F1_score: 0.6192  Non0_acc_2: 0.6296  Non0_F1_score: 0.6060  Mult_acc_5: 0.3188  Mult_acc_7: 0.2445  MAE: 1.5468  Corr: 0.1790 
2024-06-11 20:07:20:INFO:TRAIN-(cmcm) (3/27/4)>> loss: 0.7922
2024-06-11 20:07:22:INFO:VAL-(cmcm) >>
2024-06-11 20:07:22:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.4880  Non0_acc_2: 0.5833  Non0_F1_score: 0.4610  Mult_acc_5: 0.3057  Mult_acc_7: 0.2271  MAE: 1.7123  Corr: 0.0852 
2024-06-11 20:07:37:INFO:TRAIN-(cmcm) (4/28/4)>> loss: 0.7953
2024-06-11 20:07:39:INFO:VAL-(cmcm) >>
2024-06-11 20:07:39:INFO:M: >>  Has0_acc_2: 0.6288  Has0_F1_score: 0.5775  Non0_acc_2: 0.6435  Non0_F1_score: 0.6155  Mult_acc_5: 0.3319  Mult_acc_7: 0.2489  MAE: 1.4953  Corr: 0.2117 
2024-06-11 20:07:54:INFO:TRAIN-(cmcm) (5/29/4)>> loss: 0.7827
2024-06-11 20:07:56:INFO:VAL-(cmcm) >>
2024-06-11 20:07:56:INFO:M: >>  Has0_acc_2: 0.6681  Has0_F1_score: 0.6579  Non0_acc_2: 0.6759  Non0_F1_score: 0.6633  Mult_acc_5: 0.3188  Mult_acc_7: 0.2445  MAE: 1.4145  Corr: 0.2922 
2024-06-11 20:08:11:INFO:TRAIN-(cmcm) (6/30/4)>> loss: 0.7699
2024-06-11 20:08:14:INFO:VAL-(cmcm) >>
2024-06-11 20:08:14:INFO:M: >>  Has0_acc_2: 0.6463  Has0_F1_score: 0.6361  Non0_acc_2: 0.6481  Non0_F1_score: 0.6359  Mult_acc_5: 0.3319  Mult_acc_7: 0.2620  MAE: 1.3826  Corr: 0.3176 
2024-06-11 20:08:14:INFO:Saving checkpoint at epoch 30 to results/models/cmcm-mosi-regression.pth.
2024-06-11 20:08:29:INFO:TRAIN-(cmcm) (1/31/4)>> loss: 0.7692
2024-06-11 20:08:32:INFO:VAL-(cmcm) >>
2024-06-11 20:08:32:INFO:M: >>  Has0_acc_2: 0.6463  Has0_F1_score: 0.5758  Non0_acc_2: 0.6389  Non0_F1_score: 0.5678  Mult_acc_5: 0.3406  Mult_acc_7: 0.2489  MAE: 1.5210  Corr: 0.2601 
2024-06-11 20:08:46:INFO:TRAIN-(cmcm) (2/32/4)>> loss: 0.7500
2024-06-11 20:08:49:INFO:VAL-(cmcm) >>
2024-06-11 20:08:49:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.5158  Non0_acc_2: 0.5787  Non0_F1_score: 0.4932  Mult_acc_5: 0.3013  Mult_acc_7: 0.2183  MAE: 1.6442  Corr: 0.1029 
2024-06-11 20:09:03:INFO:TRAIN-(cmcm) (3/33/4)>> loss: 0.7462
2024-06-11 20:09:06:INFO:VAL-(cmcm) >>
2024-06-11 20:09:06:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.5032  Non0_acc_2: 0.6435  Non0_F1_score: 0.6272  Mult_acc_5: 0.3188  Mult_acc_7: 0.2664  MAE: 1.4084  Corr: 0.2732 
2024-06-11 20:09:20:INFO:TRAIN-(cmcm) (4/34/4)>> loss: 0.7503
2024-06-11 20:09:23:INFO:VAL-(cmcm) >>
2024-06-11 20:09:23:INFO:M: >>  Has0_acc_2: 0.6376  Has0_F1_score: 0.5694  Non0_acc_2: 0.6389  Non0_F1_score: 0.5867  Mult_acc_5: 0.3275  Mult_acc_7: 0.2402  MAE: 1.5354  Corr: 0.2362 
2024-06-11 20:09:38:INFO:TRAIN-(cmcm) (5/35/4)>> loss: 0.7462
2024-06-11 20:09:40:INFO:VAL-(cmcm) >>
2024-06-11 20:09:40:INFO:M: >>  Has0_acc_2: 0.6550  Has0_F1_score: 0.6559  Non0_acc_2: 0.6343  Non0_F1_score: 0.6353  Mult_acc_5: 0.3013  Mult_acc_7: 0.2445  MAE: 1.3320  Corr: 0.3706 
2024-06-11 20:09:41:INFO:Saving checkpoint at epoch 35 to results/models/cmcm-mosi-regression.pth.
2024-06-11 20:09:56:INFO:TRAIN-(cmcm) (1/36/4)>> loss: 0.7317
2024-06-11 20:09:58:INFO:VAL-(cmcm) >>
2024-06-11 20:09:58:INFO:M: >>  Has0_acc_2: 0.6463  Has0_F1_score: 0.6034  Non0_acc_2: 0.6157  Non0_F1_score: 0.6073  Mult_acc_5: 0.3057  Mult_acc_7: 0.2664  MAE: 1.3429  Corr: 0.3173 
2024-06-11 20:10:13:INFO:TRAIN-(cmcm) (2/37/4)>> loss: 0.7205
2024-06-11 20:10:15:INFO:VAL-(cmcm) >>
2024-06-11 20:10:15:INFO:M: >>  Has0_acc_2: 0.6419  Has0_F1_score: 0.6104  Non0_acc_2: 0.6435  Non0_F1_score: 0.6155  Mult_acc_5: 0.3275  Mult_acc_7: 0.2576  MAE: 1.4812  Corr: 0.2534 
2024-06-11 20:10:30:INFO:TRAIN-(cmcm) (3/38/4)>> loss: 0.7260
2024-06-11 20:10:32:INFO:VAL-(cmcm) >>
2024-06-11 20:10:32:INFO:M: >>  Has0_acc_2: 0.6507  Has0_F1_score: 0.5941  Non0_acc_2: 0.6481  Non0_F1_score: 0.6036  Mult_acc_5: 0.3057  Mult_acc_7: 0.2402  MAE: 1.4630  Corr: 0.2728 
2024-06-11 20:10:47:INFO:TRAIN-(cmcm) (4/39/4)>> loss: 0.7048
2024-06-11 20:10:49:INFO:VAL-(cmcm) >>
2024-06-11 20:10:49:INFO:M: >>  Has0_acc_2: 0.6725  Has0_F1_score: 0.6675  Non0_acc_2: 0.6574  Non0_F1_score: 0.6569  Mult_acc_5: 0.3013  Mult_acc_7: 0.2445  MAE: 1.3699  Corr: 0.3298 
2024-06-11 20:11:04:INFO:TRAIN-(cmcm) (5/40/4)>> loss: 0.7154
2024-06-11 20:11:07:INFO:VAL-(cmcm) >>
2024-06-11 20:11:07:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.5836  Non0_acc_2: 0.6019  Non0_F1_score: 0.5941  Mult_acc_5: 0.3100  Mult_acc_7: 0.2795  MAE: 1.4370  Corr: 0.2973 
2024-06-11 20:11:21:INFO:TRAIN-(cmcm) (6/41/4)>> loss: 0.7010
2024-06-11 20:11:24:INFO:VAL-(cmcm) >>
2024-06-11 20:11:24:INFO:M: >>  Has0_acc_2: 0.6594  Has0_F1_score: 0.6626  Non0_acc_2: 0.6528  Non0_F1_score: 0.6546  Mult_acc_5: 0.3493  Mult_acc_7: 0.2969  MAE: 1.3584  Corr: 0.3491 
2024-06-11 20:11:38:INFO:TRAIN-(cmcm) (7/42/4)>> loss: 0.6844
2024-06-11 20:11:41:INFO:VAL-(cmcm) >>
2024-06-11 20:11:41:INFO:M: >>  Has0_acc_2: 0.6769  Has0_F1_score: 0.6505  Non0_acc_2: 0.6759  Non0_F1_score: 0.6671  Mult_acc_5: 0.2969  Mult_acc_7: 0.2314  MAE: 1.3270  Corr: 0.3592 
2024-06-11 20:11:41:INFO:Saving checkpoint at epoch 42 to results/models/cmcm-mosi-regression.pth.
2024-06-11 20:11:56:INFO:TRAIN-(cmcm) (1/43/4)>> loss: 0.6771
2024-06-11 20:11:59:INFO:VAL-(cmcm) >>
2024-06-11 20:11:59:INFO:M: >>  Has0_acc_2: 0.6376  Has0_F1_score: 0.6044  Non0_acc_2: 0.6481  Non0_F1_score: 0.6216  Mult_acc_5: 0.3362  Mult_acc_7: 0.2620  MAE: 1.4577  Corr: 0.2991 
2024-06-11 20:12:13:INFO:TRAIN-(cmcm) (2/44/4)>> loss: 0.6760
2024-06-11 20:12:16:INFO:VAL-(cmcm) >>
2024-06-11 20:12:16:INFO:M: >>  Has0_acc_2: 0.6943  Has0_F1_score: 0.6837  Non0_acc_2: 0.6620  Non0_F1_score: 0.6557  Mult_acc_5: 0.3231  Mult_acc_7: 0.2576  MAE: 1.3423  Corr: 0.3540 
2024-06-11 20:12:30:INFO:TRAIN-(cmcm) (3/45/4)>> loss: 0.6505
2024-06-11 20:12:33:INFO:VAL-(cmcm) >>
2024-06-11 20:12:33:INFO:M: >>  Has0_acc_2: 0.6681  Has0_F1_score: 0.6451  Non0_acc_2: 0.6713  Non0_F1_score: 0.6630  Mult_acc_5: 0.3406  Mult_acc_7: 0.2751  MAE: 1.3328  Corr: 0.3477 
2024-06-11 20:12:48:INFO:TRAIN-(cmcm) (4/46/4)>> loss: 0.6653
2024-06-11 20:12:50:INFO:VAL-(cmcm) >>
2024-06-11 20:12:50:INFO:M: >>  Has0_acc_2: 0.6419  Has0_F1_score: 0.5999  Non0_acc_2: 0.6528  Non0_F1_score: 0.6414  Mult_acc_5: 0.2926  Mult_acc_7: 0.2489  MAE: 1.3069  Corr: 0.3490 
2024-06-11 20:12:50:INFO:Saving checkpoint at epoch 46 to results/models/cmcm-mosi-regression.pth.
2024-06-11 20:13:05:INFO:TRAIN-(cmcm) (1/47/4)>> loss: 0.6432
2024-06-11 20:13:08:INFO:VAL-(cmcm) >>
2024-06-11 20:13:08:INFO:M: >>  Has0_acc_2: 0.6900  Has0_F1_score: 0.6727  Non0_acc_2: 0.6759  Non0_F1_score: 0.6743  Mult_acc_5: 0.3755  Mult_acc_7: 0.3144  MAE: 1.2794  Corr: 0.3788 
2024-06-11 20:13:08:INFO:Saving checkpoint at epoch 47 to results/models/cmcm-mosi-regression.pth.
2024-06-11 20:13:23:INFO:TRAIN-(cmcm) (1/48/4)>> loss: 0.6208
2024-06-11 20:13:26:INFO:VAL-(cmcm) >>
2024-06-11 20:13:26:INFO:M: >>  Has0_acc_2: 0.6638  Has0_F1_score: 0.6662  Non0_acc_2: 0.6204  Non0_F1_score: 0.6213  Mult_acc_5: 0.2882  Mult_acc_7: 0.2533  MAE: 1.3846  Corr: 0.3261 
2024-06-11 20:13:40:INFO:TRAIN-(cmcm) (2/49/4)>> loss: 0.5981
2024-06-11 20:13:43:INFO:VAL-(cmcm) >>
2024-06-11 20:13:43:INFO:M: >>  Has0_acc_2: 0.6987  Has0_F1_score: 0.6769  Non0_acc_2: 0.6574  Non0_F1_score: 0.6525  Mult_acc_5: 0.3581  Mult_acc_7: 0.3100  MAE: 1.3100  Corr: 0.3214 
2024-06-11 20:13:57:INFO:TRAIN-(cmcm) (3/50/4)>> loss: 0.6007
2024-06-11 20:14:00:INFO:VAL-(cmcm) >>
2024-06-11 20:14:00:INFO:M: >>  Has0_acc_2: 0.6769  Has0_F1_score: 0.6545  Non0_acc_2: 0.6435  Non0_F1_score: 0.6451  Mult_acc_5: 0.3231  Mult_acc_7: 0.2838  MAE: 1.2637  Corr: 0.3933 
2024-06-11 20:14:00:INFO:Saving checkpoint at epoch 50 to results/models/cmcm-mosi-regression.pth.
2024-06-11 20:14:15:INFO:TRAIN-(cmcm) (1/51/4)>> loss: 0.5754
2024-06-11 20:14:18:INFO:VAL-(cmcm) >>
2024-06-11 20:14:18:INFO:M: >>  Has0_acc_2: 0.6943  Has0_F1_score: 0.6653  Non0_acc_2: 0.6991  Non0_F1_score: 0.6791  Mult_acc_5: 0.3319  Mult_acc_7: 0.2751  MAE: 1.3031  Corr: 0.4072 
2024-06-11 20:14:33:INFO:TRAIN-(cmcm) (2/52/4)>> loss: 0.5655
2024-06-11 20:14:35:INFO:VAL-(cmcm) >>
2024-06-11 20:14:35:INFO:M: >>  Has0_acc_2: 0.6769  Has0_F1_score: 0.6704  Non0_acc_2: 0.6759  Non0_F1_score: 0.6754  Mult_acc_5: 0.3188  Mult_acc_7: 0.2795  MAE: 1.2702  Corr: 0.3772 
2024-06-11 20:14:50:INFO:TRAIN-(cmcm) (3/53/4)>> loss: 0.5603
2024-06-11 20:14:52:INFO:VAL-(cmcm) >>
2024-06-11 20:14:52:INFO:M: >>  Has0_acc_2: 0.6900  Has0_F1_score: 0.6572  Non0_acc_2: 0.6944  Non0_F1_score: 0.6694  Mult_acc_5: 0.3537  Mult_acc_7: 0.2882  MAE: 1.3353  Corr: 0.3759 
2024-06-11 20:15:07:INFO:TRAIN-(cmcm) (4/54/4)>> loss: 0.5409
2024-06-11 20:15:09:INFO:VAL-(cmcm) >>
2024-06-11 20:15:09:INFO:M: >>  Has0_acc_2: 0.6594  Has0_F1_score: 0.6581  Non0_acc_2: 0.6528  Non0_F1_score: 0.6520  Mult_acc_5: 0.2838  Mult_acc_7: 0.2358  MAE: 1.3663  Corr: 0.3349 
2024-06-11 20:15:24:INFO:TRAIN-(cmcm) (5/55/4)>> loss: 0.5212
2024-06-11 20:15:26:INFO:VAL-(cmcm) >>
2024-06-11 20:15:26:INFO:M: >>  Has0_acc_2: 0.6987  Has0_F1_score: 0.6732  Non0_acc_2: 0.6944  Non0_F1_score: 0.6838  Mult_acc_5: 0.3581  Mult_acc_7: 0.3144  MAE: 1.2763  Corr: 0.3789 
2024-06-11 20:15:41:INFO:TRAIN-(cmcm) (6/56/4)>> loss: 0.5144
2024-06-11 20:15:43:INFO:VAL-(cmcm) >>
2024-06-11 20:15:43:INFO:M: >>  Has0_acc_2: 0.6638  Has0_F1_score: 0.6646  Non0_acc_2: 0.6481  Non0_F1_score: 0.6486  Mult_acc_5: 0.2838  Mult_acc_7: 0.2402  MAE: 1.4113  Corr: 0.3032 
2024-06-11 20:15:58:INFO:TRAIN-(cmcm) (7/57/4)>> loss: 0.4878
2024-06-11 20:16:01:INFO:VAL-(cmcm) >>
2024-06-11 20:16:01:INFO:M: >>  Has0_acc_2: 0.6725  Has0_F1_score: 0.6403  Non0_acc_2: 0.6759  Non0_F1_score: 0.6633  Mult_acc_5: 0.3100  Mult_acc_7: 0.2533  MAE: 1.3021  Corr: 0.4021 
2024-06-11 20:16:15:INFO:TRAIN-(cmcm) (8/58/4)>> loss: 0.4795
2024-06-11 20:16:18:INFO:VAL-(cmcm) >>
2024-06-11 20:16:18:INFO:M: >>  Has0_acc_2: 0.6463  Has0_F1_score: 0.6494  Non0_acc_2: 0.6389  Non0_F1_score: 0.6408  Mult_acc_5: 0.2795  Mult_acc_7: 0.2445  MAE: 1.4274  Corr: 0.2947 
2024-06-11 20:16:33:INFO:TRAIN-(cmcm) (9/59/4)>> loss: 0.4829
2024-06-11 20:16:35:INFO:VAL-(cmcm) >>
2024-06-11 20:16:35:INFO:M: >>  Has0_acc_2: 0.6769  Has0_F1_score: 0.6628  Non0_acc_2: 0.6620  Non0_F1_score: 0.6535  Mult_acc_5: 0.3013  Mult_acc_7: 0.2489  MAE: 1.3515  Corr: 0.3790 
2024-06-11 20:16:50:INFO:TRAIN-(cmcm) (10/60/4)>> loss: 0.4547
2024-06-11 20:16:52:INFO:VAL-(cmcm) >>
2024-06-11 20:16:52:INFO:M: >>  Has0_acc_2: 0.6900  Has0_F1_score: 0.6743  Non0_acc_2: 0.6620  Non0_F1_score: 0.6535  Mult_acc_5: 0.3013  Mult_acc_7: 0.2576  MAE: 1.3200  Corr: 0.3750 
2024-06-11 20:16:59:INFO:TEST-(cmcm) >>
2024-06-11 20:16:59:INFO:M: >>  Has0_acc_2: 0.6633  Has0_F1_score: 0.6595  Non0_acc_2: 0.6677  Non0_F1_score: 0.6670  Mult_acc_5: 0.3003  Mult_acc_7: 0.2609  MAE: 1.2033  Corr: 0.4288 
2024-06-11 20:17:00:INFO:Results are added to results/results/mosi-regression-90.csv...
2024-06-11 20:17:00:INFO:Start running cmcm...
2024-06-11 20:17:00:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 90, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 5555}>
2024-06-11 20:17:00:INFO:Let's use the GPU 1 !
2024-06-11 20:17:00:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 20:17:00:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718108220 HTTP/1.1" 200 235
2024-06-11 20:17:00:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 20:17:01:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 20:17:01:INFO:train samples: (1284,)
2024-06-11 20:17:01:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 20:17:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718108222 HTTP/1.1" 200 235
2024-06-11 20:17:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 20:17:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 20:17:03:INFO:valid samples: (229,)
2024-06-11 20:17:03:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 20:17:03:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718108224 HTTP/1.1" 200 235
2024-06-11 20:17:04:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 20:17:04:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 20:17:05:INFO:test samples: (686,)
2024-06-11 20:17:05:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 20:17:05:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718108225 HTTP/1.1" 200 235
2024-06-11 20:17:05:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 20:17:05:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 20:17:06:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 20:17:06:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718108226 HTTP/1.1" 200 235
2024-06-11 20:17:06:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 20:17:07:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 20:17:07:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-11 20:17:07:WARNING:Try importing flash-attention for faster inference...
2024-06-11 20:17:07:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-11 20:17:07:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-11 20:17:07:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-11 20:17:08:INFO:trainable params: 1310284 || all params: 1838138956 || trainable%: 0.07128318540461856
2024-06-11 20:17:08:INFO:Init labels...
2024-06-11 20:17:08:INFO:Start training...
2024-06-11 20:17:22:INFO:TRAIN-(cmcm) (1/1/5)>> loss: 2.3829
2024-06-11 20:17:25:INFO:VAL-(cmcm) >>
2024-06-11 20:17:25:INFO:M: >>  Has0_acc_2: 0.5633  Has0_F1_score: 0.5633  Non0_acc_2: 0.5556  Non0_F1_score: 0.5541  Mult_acc_5: 0.2183  Mult_acc_7: 0.1703  MAE: 1.6226  Corr: 0.0897 
2024-06-11 20:17:25:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-11 20:17:40:INFO:TRAIN-(cmcm) (1/2/5)>> loss: 0.9868
2024-06-11 20:17:43:INFO:VAL-(cmcm) >>
2024-06-11 20:17:43:INFO:M: >>  Has0_acc_2: 0.4585  Has0_F1_score: 0.4459  Non0_acc_2: 0.4676  Non0_F1_score: 0.4530  Mult_acc_5: 0.1616  Mult_acc_7: 0.1397  MAE: 1.8528  Corr: -0.0038 
2024-06-11 20:17:57:INFO:TRAIN-(cmcm) (2/3/5)>> loss: 0.9195
2024-06-11 20:18:00:INFO:VAL-(cmcm) >>
2024-06-11 20:18:00:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4742  Non0_acc_2: 0.5741  Non0_F1_score: 0.4558  Mult_acc_5: 0.2882  Mult_acc_7: 0.2140  MAE: 1.7551  Corr: -0.0534 
2024-06-11 20:18:14:INFO:TRAIN-(cmcm) (3/4/5)>> loss: 0.8884
2024-06-11 20:18:17:INFO:VAL-(cmcm) >>
2024-06-11 20:18:17:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5146  Non0_acc_2: 0.5741  Non0_F1_score: 0.4951  Mult_acc_5: 0.2227  Mult_acc_7: 0.2096  MAE: 1.4480  Corr: 0.1097 
2024-06-11 20:18:17:INFO:Saving checkpoint at epoch 4 to results/models/cmcm-mosi-regression.pth.
2024-06-11 20:18:32:INFO:TRAIN-(cmcm) (1/5/5)>> loss: 0.8779
2024-06-11 20:18:34:INFO:VAL-(cmcm) >>
2024-06-11 20:18:34:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.5013  Non0_acc_2: 0.5278  Non0_F1_score: 0.5209  Mult_acc_5: 0.1834  Mult_acc_7: 0.1834  MAE: 1.4563  Corr: -0.0125 
2024-06-11 20:18:49:INFO:TRAIN-(cmcm) (2/6/5)>> loss: 0.8774
2024-06-11 20:18:52:INFO:VAL-(cmcm) >>
2024-06-11 20:18:52:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4607  Non0_acc_2: 0.5694  Non0_F1_score: 0.4323  Mult_acc_5: 0.2052  Mult_acc_7: 0.1703  MAE: 1.5855  Corr: 0.0125 
2024-06-11 20:19:06:INFO:TRAIN-(cmcm) (3/7/5)>> loss: 0.8727
2024-06-11 20:19:09:INFO:VAL-(cmcm) >>
2024-06-11 20:19:09:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.5697  Non0_acc_2: 0.5972  Non0_F1_score: 0.5574  Mult_acc_5: 0.3013  Mult_acc_7: 0.2271  MAE: 1.6507  Corr: 0.0659 
2024-06-11 20:19:23:INFO:TRAIN-(cmcm) (4/8/5)>> loss: 0.8720
2024-06-11 20:19:26:INFO:VAL-(cmcm) >>
2024-06-11 20:19:26:INFO:M: >>  Has0_acc_2: 0.4891  Has0_F1_score: 0.4522  Non0_acc_2: 0.5139  Non0_F1_score: 0.4789  Mult_acc_5: 0.2271  Mult_acc_7: 0.1659  MAE: 1.9315  Corr: 0.1178 
2024-06-11 20:19:40:INFO:TRAIN-(cmcm) (5/9/5)>> loss: 0.8726
2024-06-11 20:19:43:INFO:VAL-(cmcm) >>
2024-06-11 20:19:43:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.5621  Non0_acc_2: 0.5648  Non0_F1_score: 0.5439  Mult_acc_5: 0.2402  Mult_acc_7: 0.2140  MAE: 1.6707  Corr: 0.0588 
2024-06-11 20:19:57:INFO:TRAIN-(cmcm) (6/10/5)>> loss: 0.8571
2024-06-11 20:20:00:INFO:VAL-(cmcm) >>
2024-06-11 20:20:00:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5741  Non0_F1_score: 0.4187  Mult_acc_5: 0.2882  Mult_acc_7: 0.2140  MAE: 1.6542  Corr: 0.0314 
2024-06-11 20:20:15:INFO:TRAIN-(cmcm) (7/11/5)>> loss: 0.8565
2024-06-11 20:20:18:INFO:VAL-(cmcm) >>
2024-06-11 20:20:18:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5840  Non0_acc_2: 0.5880  Non0_F1_score: 0.5892  Mult_acc_5: 0.2751  Mult_acc_7: 0.2096  MAE: 1.7253  Corr: 0.1270 
2024-06-11 20:20:33:INFO:TRAIN-(cmcm) (8/12/5)>> loss: 0.8499
2024-06-11 20:20:36:INFO:VAL-(cmcm) >>
2024-06-11 20:20:36:INFO:M: >>  Has0_acc_2: 0.6288  Has0_F1_score: 0.5504  Non0_acc_2: 0.6065  Non0_F1_score: 0.5266  Mult_acc_5: 0.3319  Mult_acc_7: 0.2402  MAE: 1.6258  Corr: 0.2103 
2024-06-11 20:20:51:INFO:TRAIN-(cmcm) (9/13/5)>> loss: 0.8334
2024-06-11 20:20:54:INFO:VAL-(cmcm) >>
2024-06-11 20:20:54:INFO:M: >>  Has0_acc_2: 0.6594  Has0_F1_score: 0.6602  Non0_acc_2: 0.6574  Non0_F1_score: 0.6535  Mult_acc_5: 0.2707  Mult_acc_7: 0.2140  MAE: 1.3711  Corr: 0.4096 
2024-06-11 20:20:55:INFO:Saving checkpoint at epoch 13 to results/models/cmcm-mosi-regression.pth.
2024-06-11 20:21:10:INFO:TRAIN-(cmcm) (1/14/5)>> loss: 0.8329
2024-06-11 20:21:13:INFO:VAL-(cmcm) >>
2024-06-11 20:21:13:INFO:M: >>  Has0_acc_2: 0.5284  Has0_F1_score: 0.4726  Non0_acc_2: 0.5556  Non0_F1_score: 0.5020  Mult_acc_5: 0.2096  Mult_acc_7: 0.1703  MAE: 1.4707  Corr: 0.3653 
2024-06-11 20:21:28:INFO:TRAIN-(cmcm) (2/15/5)>> loss: 0.8123
2024-06-11 20:21:31:INFO:VAL-(cmcm) >>
2024-06-11 20:21:31:INFO:M: >>  Has0_acc_2: 0.6900  Has0_F1_score: 0.6498  Non0_acc_2: 0.6759  Non0_F1_score: 0.6427  Mult_acc_5: 0.3493  Mult_acc_7: 0.2751  MAE: 1.3017  Corr: 0.4177 
2024-06-11 20:21:31:INFO:Saving checkpoint at epoch 15 to results/models/cmcm-mosi-regression.pth.
2024-06-11 20:21:47:INFO:TRAIN-(cmcm) (1/16/5)>> loss: 0.7953
2024-06-11 20:21:50:INFO:VAL-(cmcm) >>
2024-06-11 20:21:50:INFO:M: >>  Has0_acc_2: 0.6856  Has0_F1_score: 0.6600  Non0_acc_2: 0.6806  Non0_F1_score: 0.6534  Mult_acc_5: 0.2969  Mult_acc_7: 0.2271  MAE: 1.3624  Corr: 0.3654 
2024-06-11 20:22:05:INFO:TRAIN-(cmcm) (2/17/5)>> loss: 0.7834
2024-06-11 20:22:08:INFO:VAL-(cmcm) >>
2024-06-11 20:22:08:INFO:M: >>  Has0_acc_2: 0.6507  Has0_F1_score: 0.6456  Non0_acc_2: 0.6713  Non0_F1_score: 0.6599  Mult_acc_5: 0.2882  Mult_acc_7: 0.2445  MAE: 1.2497  Corr: 0.4820 
2024-06-11 20:22:08:INFO:Saving checkpoint at epoch 17 to results/models/cmcm-mosi-regression.pth.
2024-06-11 20:22:24:INFO:TRAIN-(cmcm) (1/18/5)>> loss: 0.7927
2024-06-11 20:22:27:INFO:VAL-(cmcm) >>
2024-06-11 20:22:27:INFO:M: >>  Has0_acc_2: 0.7074  Has0_F1_score: 0.7103  Non0_acc_2: 0.7037  Non0_F1_score: 0.7052  Mult_acc_5: 0.3624  Mult_acc_7: 0.2795  MAE: 1.2346  Corr: 0.5089 
2024-06-11 20:22:27:INFO:Saving checkpoint at epoch 18 to results/models/cmcm-mosi-regression.pth.
2024-06-11 20:22:43:INFO:TRAIN-(cmcm) (1/19/5)>> loss: 0.7738
2024-06-11 20:22:46:INFO:VAL-(cmcm) >>
2024-06-11 20:22:46:INFO:M: >>  Has0_acc_2: 0.7118  Has0_F1_score: 0.7135  Non0_acc_2: 0.6991  Non0_F1_score: 0.6996  Mult_acc_5: 0.3275  Mult_acc_7: 0.2707  MAE: 1.1685  Corr: 0.5282 
2024-06-11 20:22:46:INFO:Saving checkpoint at epoch 19 to results/models/cmcm-mosi-regression.pth.
2024-06-11 20:23:02:INFO:TRAIN-(cmcm) (1/20/5)>> loss: 0.7630
2024-06-11 20:23:04:INFO:VAL-(cmcm) >>
2024-06-11 20:23:04:INFO:M: >>  Has0_acc_2: 0.7380  Has0_F1_score: 0.7405  Non0_acc_2: 0.7593  Non0_F1_score: 0.7604  Mult_acc_5: 0.3755  Mult_acc_7: 0.3013  MAE: 1.1350  Corr: 0.5417 
2024-06-11 20:23:05:INFO:Saving checkpoint at epoch 20 to results/models/cmcm-mosi-regression.pth.
2024-06-11 20:23:22:INFO:TRAIN-(cmcm) (1/21/5)>> loss: 0.7525
2024-06-11 20:23:25:INFO:VAL-(cmcm) >>
2024-06-11 20:23:25:INFO:M: >>  Has0_acc_2: 0.7205  Has0_F1_score: 0.7096  Non0_acc_2: 0.7361  Non0_F1_score: 0.7264  Mult_acc_5: 0.4061  Mult_acc_7: 0.2926  MAE: 1.1686  Corr: 0.5536 
2024-06-11 20:23:41:INFO:TRAIN-(cmcm) (2/22/5)>> loss: 0.7484
2024-06-11 20:23:44:INFO:VAL-(cmcm) >>
2024-06-11 20:23:44:INFO:M: >>  Has0_acc_2: 0.6900  Has0_F1_score: 0.6928  Non0_acc_2: 0.7083  Non0_F1_score: 0.7099  Mult_acc_5: 0.3450  Mult_acc_7: 0.2838  MAE: 1.1995  Corr: 0.4786 
2024-06-11 20:24:01:INFO:TRAIN-(cmcm) (3/23/5)>> loss: 0.7420
2024-06-11 20:24:04:INFO:VAL-(cmcm) >>
2024-06-11 20:24:04:INFO:M: >>  Has0_acc_2: 0.7817  Has0_F1_score: 0.7758  Non0_acc_2: 0.7870  Non0_F1_score: 0.7813  Mult_acc_5: 0.3799  Mult_acc_7: 0.3188  MAE: 1.0510  Corr: 0.5867 
2024-06-11 20:24:05:INFO:Saving checkpoint at epoch 23 to results/models/cmcm-mosi-regression.pth.
2024-06-11 20:24:21:INFO:TRAIN-(cmcm) (1/24/5)>> loss: 0.7336
2024-06-11 20:24:24:INFO:VAL-(cmcm) >>
2024-06-11 20:24:24:INFO:M: >>  Has0_acc_2: 0.7162  Has0_F1_score: 0.7183  Non0_acc_2: 0.7176  Non0_F1_score: 0.7170  Mult_acc_5: 0.3144  Mult_acc_7: 0.2882  MAE: 1.1746  Corr: 0.5082 
2024-06-11 20:24:38:INFO:TRAIN-(cmcm) (2/25/5)>> loss: 0.7347
2024-06-11 20:24:41:INFO:VAL-(cmcm) >>
2024-06-11 20:24:41:INFO:M: >>  Has0_acc_2: 0.7860  Has0_F1_score: 0.7878  Non0_acc_2: 0.7731  Non0_F1_score: 0.7744  Mult_acc_5: 0.4148  Mult_acc_7: 0.3275  MAE: 1.0964  Corr: 0.6066 
2024-06-11 20:24:55:INFO:TRAIN-(cmcm) (3/26/5)>> loss: 0.7245
2024-06-11 20:24:58:INFO:VAL-(cmcm) >>
2024-06-11 20:24:58:INFO:M: >>  Has0_acc_2: 0.7773  Has0_F1_score: 0.7745  Non0_acc_2: 0.7546  Non0_F1_score: 0.7551  Mult_acc_5: 0.4192  Mult_acc_7: 0.3319  MAE: 1.0720  Corr: 0.5966 
2024-06-11 20:25:13:INFO:TRAIN-(cmcm) (4/27/5)>> loss: 0.7087
2024-06-11 20:25:15:INFO:VAL-(cmcm) >>
2024-06-11 20:25:15:INFO:M: >>  Has0_acc_2: 0.7380  Has0_F1_score: 0.7336  Non0_acc_2: 0.7083  Non0_F1_score: 0.7098  Mult_acc_5: 0.3362  Mult_acc_7: 0.3013  MAE: 1.1052  Corr: 0.5609 
2024-06-11 20:25:30:INFO:TRAIN-(cmcm) (5/28/5)>> loss: 0.6950
2024-06-11 20:25:32:INFO:VAL-(cmcm) >>
2024-06-11 20:25:32:INFO:M: >>  Has0_acc_2: 0.7380  Has0_F1_score: 0.7309  Non0_acc_2: 0.7130  Non0_F1_score: 0.7142  Mult_acc_5: 0.3755  Mult_acc_7: 0.2882  MAE: 1.1682  Corr: 0.5244 
2024-06-11 20:25:47:INFO:TRAIN-(cmcm) (6/29/5)>> loss: 0.6958
2024-06-11 20:25:49:INFO:VAL-(cmcm) >>
2024-06-11 20:25:49:INFO:M: >>  Has0_acc_2: 0.7686  Has0_F1_score: 0.7635  Non0_acc_2: 0.7593  Non0_F1_score: 0.7564  Mult_acc_5: 0.4192  Mult_acc_7: 0.3581  MAE: 1.0829  Corr: 0.5592 
2024-06-11 20:26:04:INFO:TRAIN-(cmcm) (7/30/5)>> loss: 0.6943
2024-06-11 20:26:06:INFO:VAL-(cmcm) >>
2024-06-11 20:26:06:INFO:M: >>  Has0_acc_2: 0.7598  Has0_F1_score: 0.7618  Non0_acc_2: 0.7593  Non0_F1_score: 0.7606  Mult_acc_5: 0.3755  Mult_acc_7: 0.3144  MAE: 1.0809  Corr: 0.5752 
2024-06-11 20:26:21:INFO:TRAIN-(cmcm) (8/31/5)>> loss: 0.6817
2024-06-11 20:26:23:INFO:VAL-(cmcm) >>
2024-06-11 20:26:23:INFO:M: >>  Has0_acc_2: 0.7424  Has0_F1_score: 0.7391  Non0_acc_2: 0.7454  Non0_F1_score: 0.7427  Mult_acc_5: 0.3450  Mult_acc_7: 0.2620  MAE: 1.1340  Corr: 0.5385 
2024-06-11 20:26:38:INFO:TRAIN-(cmcm) (9/32/5)>> loss: 0.6740
2024-06-11 20:26:40:INFO:VAL-(cmcm) >>
2024-06-11 20:26:40:INFO:M: >>  Has0_acc_2: 0.7511  Has0_F1_score: 0.7517  Non0_acc_2: 0.7546  Non0_F1_score: 0.7554  Mult_acc_5: 0.3362  Mult_acc_7: 0.2926  MAE: 1.1012  Corr: 0.5611 
2024-06-11 20:26:55:INFO:TRAIN-(cmcm) (10/33/5)>> loss: 0.6658
2024-06-11 20:26:58:INFO:VAL-(cmcm) >>
2024-06-11 20:26:58:INFO:M: >>  Has0_acc_2: 0.7555  Has0_F1_score: 0.7479  Non0_acc_2: 0.7546  Non0_F1_score: 0.7475  Mult_acc_5: 0.3755  Mult_acc_7: 0.3144  MAE: 1.1087  Corr: 0.5665 
2024-06-11 20:27:05:INFO:TEST-(cmcm) >>
2024-06-11 20:27:05:INFO:M: >>  Has0_acc_2: 0.7289  Has0_F1_score: 0.7292  Non0_acc_2: 0.7409  Non0_F1_score: 0.7422  Mult_acc_5: 0.3294  Mult_acc_7: 0.2959  MAE: 1.0973  Corr: 0.5523 
2024-06-11 20:27:05:INFO:Results are added to results/results/mosi-regression-90.csv...
2024-06-11 20:27:05:INFO:Start running cmcm...
2024-06-11 20:27:05:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 100, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-06-11 20:27:05:INFO:Let's use the GPU 1 !
2024-06-11 20:27:05:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 20:27:06:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718108826 HTTP/1.1" 200 235
2024-06-11 20:27:06:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 20:27:06:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 20:27:07:INFO:train samples: (1284,)
2024-06-11 20:27:07:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 20:27:07:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718108827 HTTP/1.1" 200 235
2024-06-11 20:27:07:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 20:27:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 20:27:08:INFO:valid samples: (229,)
2024-06-11 20:27:08:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 20:27:09:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718108829 HTTP/1.1" 200 235
2024-06-11 20:27:09:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 20:27:09:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 20:27:10:INFO:test samples: (686,)
2024-06-11 20:27:10:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 20:27:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718108830 HTTP/1.1" 200 235
2024-06-11 20:27:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 20:27:11:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 20:27:11:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 20:27:11:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718108831 HTTP/1.1" 200 235
2024-06-11 20:27:11:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 20:27:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 20:27:12:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-11 20:27:12:WARNING:Try importing flash-attention for faster inference...
2024-06-11 20:27:12:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-11 20:27:12:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-11 20:27:12:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-11 20:27:13:INFO:trainable params: 1310284 || all params: 1838138956 || trainable%: 0.07128318540461856
2024-06-11 20:27:13:INFO:Init labels...
2024-06-11 20:27:13:INFO:Start training...
2024-06-11 20:27:28:INFO:TRAIN-(cmcm) (1/1/1)>> loss: 2.2971
2024-06-11 20:27:30:INFO:VAL-(cmcm) >>
2024-06-11 20:27:30:INFO:M: >>  Has0_acc_2: 0.5284  Has0_F1_score: 0.5203  Non0_acc_2: 0.5231  Non0_F1_score: 0.5066  Mult_acc_5: 0.1790  Mult_acc_7: 0.1790  MAE: 1.6283  Corr: 0.0957 
2024-06-11 20:27:30:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-11 20:27:45:INFO:TRAIN-(cmcm) (1/2/1)>> loss: 0.9505
2024-06-11 20:27:48:INFO:VAL-(cmcm) >>
2024-06-11 20:27:48:INFO:M: >>  Has0_acc_2: 0.5590  Has0_F1_score: 0.5462  Non0_acc_2: 0.5463  Non0_F1_score: 0.5323  Mult_acc_5: 0.2052  Mult_acc_7: 0.1703  MAE: 1.7676  Corr: 0.0006 
2024-06-11 20:28:02:INFO:TRAIN-(cmcm) (2/3/1)>> loss: 0.9281
2024-06-11 20:28:05:INFO:VAL-(cmcm) >>
2024-06-11 20:28:05:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.4629  Non0_acc_2: 0.5602  Non0_F1_score: 0.4346  Mult_acc_5: 0.2664  Mult_acc_7: 0.1965  MAE: 1.6894  Corr: -0.0192 
2024-06-11 20:28:19:INFO:TRAIN-(cmcm) (3/4/1)>> loss: 0.8877
2024-06-11 20:28:22:INFO:VAL-(cmcm) >>
2024-06-11 20:28:22:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.5013  Non0_acc_2: 0.5556  Non0_F1_score: 0.4780  Mult_acc_5: 0.2882  Mult_acc_7: 0.2096  MAE: 1.6883  Corr: -0.0360 
2024-06-11 20:28:36:INFO:TRAIN-(cmcm) (4/5/1)>> loss: 0.8782
2024-06-11 20:28:39:INFO:VAL-(cmcm) >>
2024-06-11 20:28:39:INFO:M: >>  Has0_acc_2: 0.5415  Has0_F1_score: 0.5381  Non0_acc_2: 0.5463  Non0_F1_score: 0.5421  Mult_acc_5: 0.2489  Mult_acc_7: 0.1878  MAE: 1.6835  Corr: 0.0076 
2024-06-11 20:28:54:INFO:TRAIN-(cmcm) (5/6/1)>> loss: 0.8735
2024-06-11 20:28:56:INFO:VAL-(cmcm) >>
2024-06-11 20:28:56:INFO:M: >>  Has0_acc_2: 0.4978  Has0_F1_score: 0.4978  Non0_acc_2: 0.5093  Non0_F1_score: 0.5077  Mult_acc_5: 0.2052  Mult_acc_7: 0.1616  MAE: 1.7464  Corr: 0.0172 
2024-06-11 20:29:11:INFO:TRAIN-(cmcm) (6/7/1)>> loss: 0.8766
2024-06-11 20:29:13:INFO:VAL-(cmcm) >>
2024-06-11 20:29:13:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.4730  Non0_acc_2: 0.5509  Non0_F1_score: 0.4425  Mult_acc_5: 0.3013  Mult_acc_7: 0.2183  MAE: 1.7446  Corr: -0.0085 
2024-06-11 20:29:28:INFO:TRAIN-(cmcm) (7/8/1)>> loss: 0.8734
2024-06-11 20:29:30:INFO:VAL-(cmcm) >>
2024-06-11 20:29:30:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5081  Non0_acc_2: 0.5694  Non0_F1_score: 0.4821  Mult_acc_5: 0.2882  Mult_acc_7: 0.2096  MAE: 1.7494  Corr: 0.0247 
2024-06-11 20:29:45:INFO:TRAIN-(cmcm) (8/9/1)>> loss: 0.8729
2024-06-11 20:29:47:INFO:VAL-(cmcm) >>
2024-06-11 20:29:47:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.5187  Non0_acc_2: 0.5556  Non0_F1_score: 0.5030  Mult_acc_5: 0.2969  Mult_acc_7: 0.2183  MAE: 1.7276  Corr: 0.0169 
2024-06-11 20:30:02:INFO:TRAIN-(cmcm) (9/10/1)>> loss: 0.8606
2024-06-11 20:30:04:INFO:VAL-(cmcm) >>
2024-06-11 20:30:04:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.5029  Non0_acc_2: 0.5880  Non0_F1_score: 0.4767  Mult_acc_5: 0.3144  Mult_acc_7: 0.2358  MAE: 1.6778  Corr: 0.1349 
2024-06-11 20:30:19:INFO:TRAIN-(cmcm) (10/11/1)>> loss: 0.8493
2024-06-11 20:30:21:INFO:VAL-(cmcm) >>
2024-06-11 20:30:21:INFO:M: >>  Has0_acc_2: 0.6550  Has0_F1_score: 0.6516  Non0_acc_2: 0.6065  Non0_F1_score: 0.5957  Mult_acc_5: 0.3144  Mult_acc_7: 0.2664  MAE: 1.3140  Corr: 0.3276 
2024-06-11 20:30:22:INFO:Saving checkpoint at epoch 11 to results/models/cmcm-mosi-regression.pth.
2024-06-11 20:30:36:INFO:TRAIN-(cmcm) (1/12/1)>> loss: 0.8347
2024-06-11 20:30:39:INFO:VAL-(cmcm) >>
2024-06-11 20:30:39:INFO:M: >>  Has0_acc_2: 0.6594  Has0_F1_score: 0.6627  Non0_acc_2: 0.6898  Non0_F1_score: 0.6915  Mult_acc_5: 0.3319  Mult_acc_7: 0.2445  MAE: 1.3228  Corr: 0.4131 
2024-06-11 20:30:53:INFO:TRAIN-(cmcm) (2/13/1)>> loss: 0.8132
2024-06-11 20:30:56:INFO:VAL-(cmcm) >>
2024-06-11 20:30:56:INFO:M: >>  Has0_acc_2: 0.7162  Has0_F1_score: 0.6989  Non0_acc_2: 0.7176  Non0_F1_score: 0.6988  Mult_acc_5: 0.4017  Mult_acc_7: 0.3057  MAE: 1.2158  Corr: 0.4945 
2024-06-11 20:30:56:INFO:Saving checkpoint at epoch 13 to results/models/cmcm-mosi-regression.pth.
2024-06-11 20:31:11:INFO:TRAIN-(cmcm) (1/14/1)>> loss: 0.8253
2024-06-11 20:31:14:INFO:VAL-(cmcm) >>
2024-06-11 20:31:14:INFO:M: >>  Has0_acc_2: 0.6725  Has0_F1_score: 0.6725  Non0_acc_2: 0.7037  Non0_F1_score: 0.7033  Mult_acc_5: 0.3581  Mult_acc_7: 0.2707  MAE: 1.3734  Corr: 0.4744 
2024-06-11 20:31:28:INFO:TRAIN-(cmcm) (2/15/1)>> loss: 0.7935
2024-06-11 20:31:31:INFO:VAL-(cmcm) >>
2024-06-11 20:31:31:INFO:M: >>  Has0_acc_2: 0.6987  Has0_F1_score: 0.6820  Non0_acc_2: 0.7083  Non0_F1_score: 0.6889  Mult_acc_5: 0.3886  Mult_acc_7: 0.2882  MAE: 1.1966  Corr: 0.5187 
2024-06-11 20:31:31:INFO:Saving checkpoint at epoch 15 to results/models/cmcm-mosi-regression.pth.
2024-06-11 20:31:46:INFO:TRAIN-(cmcm) (1/16/1)>> loss: 0.7752
2024-06-11 20:31:48:INFO:VAL-(cmcm) >>
2024-06-11 20:31:48:INFO:M: >>  Has0_acc_2: 0.7074  Has0_F1_score: 0.7094  Non0_acc_2: 0.7269  Non0_F1_score: 0.7270  Mult_acc_5: 0.3886  Mult_acc_7: 0.2926  MAE: 1.2416  Corr: 0.5105 
2024-06-11 20:32:03:INFO:TRAIN-(cmcm) (2/17/1)>> loss: 0.7748
2024-06-11 20:32:05:INFO:VAL-(cmcm) >>
2024-06-11 20:32:05:INFO:M: >>  Has0_acc_2: 0.7380  Has0_F1_score: 0.7289  Non0_acc_2: 0.6806  Non0_F1_score: 0.6765  Mult_acc_5: 0.3712  Mult_acc_7: 0.3013  MAE: 1.1066  Corr: 0.5529 
2024-06-11 20:32:06:INFO:Saving checkpoint at epoch 17 to results/models/cmcm-mosi-regression.pth.
2024-06-11 20:32:20:INFO:TRAIN-(cmcm) (1/18/1)>> loss: 0.7545
2024-06-11 20:32:23:INFO:VAL-(cmcm) >>
2024-06-11 20:32:23:INFO:M: >>  Has0_acc_2: 0.7467  Has0_F1_score: 0.7485  Non0_acc_2: 0.7639  Non0_F1_score: 0.7643  Mult_acc_5: 0.3843  Mult_acc_7: 0.2969  MAE: 1.1630  Corr: 0.5490 
2024-06-11 20:32:37:INFO:TRAIN-(cmcm) (2/19/1)>> loss: 0.7547
2024-06-11 20:32:40:INFO:VAL-(cmcm) >>
2024-06-11 20:32:40:INFO:M: >>  Has0_acc_2: 0.7074  Has0_F1_score: 0.7103  Non0_acc_2: 0.7454  Non0_F1_score: 0.7463  Mult_acc_5: 0.3886  Mult_acc_7: 0.2969  MAE: 1.0992  Corr: 0.5809 
2024-06-11 20:32:40:INFO:Saving checkpoint at epoch 19 to results/models/cmcm-mosi-regression.pth.
2024-06-11 20:32:55:INFO:TRAIN-(cmcm) (1/20/1)>> loss: 0.7525
2024-06-11 20:32:58:INFO:VAL-(cmcm) >>
2024-06-11 20:32:58:INFO:M: >>  Has0_acc_2: 0.7074  Has0_F1_score: 0.7099  Non0_acc_2: 0.7269  Non0_F1_score: 0.7274  Mult_acc_5: 0.3799  Mult_acc_7: 0.2926  MAE: 1.1263  Corr: 0.5375 
2024-06-11 20:33:12:INFO:TRAIN-(cmcm) (2/21/1)>> loss: 0.7386
2024-06-11 20:33:15:INFO:VAL-(cmcm) >>
2024-06-11 20:33:15:INFO:M: >>  Has0_acc_2: 0.7249  Has0_F1_score: 0.7251  Non0_acc_2: 0.6898  Non0_F1_score: 0.6874  Mult_acc_5: 0.4323  Mult_acc_7: 0.3493  MAE: 1.0743  Corr: 0.5638 
2024-06-11 20:33:15:INFO:Saving checkpoint at epoch 21 to results/models/cmcm-mosi-regression.pth.
2024-06-11 20:33:30:INFO:TRAIN-(cmcm) (1/22/1)>> loss: 0.7194
2024-06-11 20:33:32:INFO:VAL-(cmcm) >>
2024-06-11 20:33:32:INFO:M: >>  Has0_acc_2: 0.7380  Has0_F1_score: 0.7343  Non0_acc_2: 0.7593  Non0_F1_score: 0.7580  Mult_acc_5: 0.4498  Mult_acc_7: 0.3406  MAE: 1.0302  Corr: 0.6171 
2024-06-11 20:33:33:INFO:Saving checkpoint at epoch 22 to results/models/cmcm-mosi-regression.pth.
2024-06-11 20:33:47:INFO:TRAIN-(cmcm) (1/23/1)>> loss: 0.7114
2024-06-11 20:33:50:INFO:VAL-(cmcm) >>
2024-06-11 20:33:50:INFO:M: >>  Has0_acc_2: 0.7249  Has0_F1_score: 0.7198  Non0_acc_2: 0.7083  Non0_F1_score: 0.7081  Mult_acc_5: 0.4105  Mult_acc_7: 0.3188  MAE: 1.1756  Corr: 0.5113 
2024-06-11 20:34:05:INFO:TRAIN-(cmcm) (2/24/1)>> loss: 0.7079
2024-06-11 20:34:07:INFO:VAL-(cmcm) >>
2024-06-11 20:34:07:INFO:M: >>  Has0_acc_2: 0.7642  Has0_F1_score: 0.7658  Non0_acc_2: 0.7778  Non0_F1_score: 0.7790  Mult_acc_5: 0.4279  Mult_acc_7: 0.3144  MAE: 1.0887  Corr: 0.6080 
2024-06-11 20:34:22:INFO:TRAIN-(cmcm) (3/25/1)>> loss: 0.7017
2024-06-11 20:34:24:INFO:VAL-(cmcm) >>
2024-06-11 20:34:24:INFO:M: >>  Has0_acc_2: 0.7424  Has0_F1_score: 0.7398  Non0_acc_2: 0.7454  Non0_F1_score: 0.7438  Mult_acc_5: 0.4105  Mult_acc_7: 0.3100  MAE: 1.1040  Corr: 0.5761 
2024-06-11 20:34:39:INFO:TRAIN-(cmcm) (4/26/1)>> loss: 0.7027
2024-06-11 20:34:41:INFO:VAL-(cmcm) >>
2024-06-11 20:34:41:INFO:M: >>  Has0_acc_2: 0.7162  Has0_F1_score: 0.7126  Non0_acc_2: 0.7593  Non0_F1_score: 0.7598  Mult_acc_5: 0.4017  Mult_acc_7: 0.3188  MAE: 1.0429  Corr: 0.5994 
2024-06-11 20:34:56:INFO:TRAIN-(cmcm) (5/27/1)>> loss: 0.7111
2024-06-11 20:34:58:INFO:VAL-(cmcm) >>
2024-06-11 20:34:58:INFO:M: >>  Has0_acc_2: 0.7380  Has0_F1_score: 0.7402  Non0_acc_2: 0.7454  Non0_F1_score: 0.7466  Mult_acc_5: 0.3799  Mult_acc_7: 0.2795  MAE: 1.1468  Corr: 0.5400 
2024-06-11 20:35:13:INFO:TRAIN-(cmcm) (6/28/1)>> loss: 0.6866
2024-06-11 20:35:15:INFO:VAL-(cmcm) >>
2024-06-11 20:35:15:INFO:M: >>  Has0_acc_2: 0.7555  Has0_F1_score: 0.7562  Non0_acc_2: 0.7361  Non0_F1_score: 0.7375  Mult_acc_5: 0.4148  Mult_acc_7: 0.3319  MAE: 1.0730  Corr: 0.5622 
2024-06-11 20:35:30:INFO:TRAIN-(cmcm) (7/29/1)>> loss: 0.6867
2024-06-11 20:35:32:INFO:VAL-(cmcm) >>
2024-06-11 20:35:32:INFO:M: >>  Has0_acc_2: 0.7336  Has0_F1_score: 0.7310  Non0_acc_2: 0.7315  Non0_F1_score: 0.7324  Mult_acc_5: 0.4192  Mult_acc_7: 0.3231  MAE: 1.0512  Corr: 0.5897 
2024-06-11 20:35:47:INFO:TRAIN-(cmcm) (8/30/1)>> loss: 0.6726
2024-06-11 20:35:49:INFO:VAL-(cmcm) >>
2024-06-11 20:35:49:INFO:M: >>  Has0_acc_2: 0.7380  Has0_F1_score: 0.7405  Non0_acc_2: 0.7315  Non0_F1_score: 0.7302  Mult_acc_5: 0.3755  Mult_acc_7: 0.3013  MAE: 1.1106  Corr: 0.5503 
2024-06-11 20:36:04:INFO:TRAIN-(cmcm) (9/31/1)>> loss: 0.6653
2024-06-11 20:36:06:INFO:VAL-(cmcm) >>
2024-06-11 20:36:06:INFO:M: >>  Has0_acc_2: 0.7293  Has0_F1_score: 0.7199  Non0_acc_2: 0.6667  Non0_F1_score: 0.6678  Mult_acc_5: 0.4017  Mult_acc_7: 0.3144  MAE: 1.1248  Corr: 0.5256 
2024-06-11 20:36:21:INFO:TRAIN-(cmcm) (10/32/1)>> loss: 0.6512
2024-06-11 20:36:24:INFO:VAL-(cmcm) >>
2024-06-11 20:36:24:INFO:M: >>  Has0_acc_2: 0.7293  Has0_F1_score: 0.7282  Non0_acc_2: 0.7176  Non0_F1_score: 0.7178  Mult_acc_5: 0.3930  Mult_acc_7: 0.3057  MAE: 1.1241  Corr: 0.5354 
2024-06-11 20:36:31:INFO:TEST-(cmcm) >>
2024-06-11 20:36:31:INFO:M: >>  Has0_acc_2: 0.6924  Has0_F1_score: 0.6919  Non0_acc_2: 0.7378  Non0_F1_score: 0.7394  Mult_acc_5: 0.3499  Mult_acc_7: 0.3047  MAE: 1.1610  Corr: 0.5414 
2024-06-11 20:36:31:INFO:Results are added to results/results/mosi-regression-100.csv...
2024-06-11 20:36:31:INFO:Start running cmcm...
2024-06-11 20:36:31:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 100, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 2222}>
2024-06-11 20:36:31:INFO:Let's use the GPU 1 !
2024-06-11 20:36:31:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 20:36:32:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718109392 HTTP/1.1" 200 235
2024-06-11 20:36:32:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 20:36:32:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 20:36:33:INFO:train samples: (1284,)
2024-06-11 20:36:33:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 20:36:33:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718109393 HTTP/1.1" 200 235
2024-06-11 20:36:33:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 20:36:34:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 20:36:34:INFO:valid samples: (229,)
2024-06-11 20:36:34:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 20:36:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718109395 HTTP/1.1" 200 235
2024-06-11 20:36:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 20:36:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 20:36:36:INFO:test samples: (686,)
2024-06-11 20:36:36:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 20:36:36:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718109396 HTTP/1.1" 200 235
2024-06-11 20:36:36:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 20:36:37:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 20:36:37:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 20:36:38:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718109398 HTTP/1.1" 200 235
2024-06-11 20:36:38:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 20:36:38:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 20:36:38:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-11 20:36:38:WARNING:Try importing flash-attention for faster inference...
2024-06-11 20:36:38:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-11 20:36:38:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-11 20:36:38:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-11 20:36:39:INFO:trainable params: 1310284 || all params: 1838138956 || trainable%: 0.07128318540461856
2024-06-11 20:36:39:INFO:Init labels...
2024-06-11 20:36:39:INFO:Start training...
2024-06-11 20:36:54:INFO:TRAIN-(cmcm) (1/1/2)>> loss: 2.9422
2024-06-11 20:36:56:INFO:VAL-(cmcm) >>
2024-06-11 20:36:56:INFO:M: >>  Has0_acc_2: 0.4192  Has0_F1_score: 0.3640  Non0_acc_2: 0.4352  Non0_F1_score: 0.3791  Mult_acc_5: 0.2402  Mult_acc_7: 0.1790  MAE: 1.9231  Corr: 0.0504 
2024-06-11 20:36:57:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-11 20:37:12:INFO:TRAIN-(cmcm) (1/2/2)>> loss: 0.9497
2024-06-11 20:37:14:INFO:VAL-(cmcm) >>
2024-06-11 20:37:14:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5003  Non0_acc_2: 0.5694  Non0_F1_score: 0.4768  Mult_acc_5: 0.2882  Mult_acc_7: 0.2096  MAE: 1.7669  Corr: -0.0216 
2024-06-11 20:37:14:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-11 20:37:29:INFO:TRAIN-(cmcm) (1/3/2)>> loss: 0.8986
2024-06-11 20:37:32:INFO:VAL-(cmcm) >>
2024-06-11 20:37:32:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4534  Non0_acc_2: 0.5694  Non0_F1_score: 0.4246  Mult_acc_5: 0.1834  Mult_acc_7: 0.1834  MAE: 1.4501  Corr: 0.0925 
2024-06-11 20:37:32:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-mosi-regression.pth.
2024-06-11 20:37:47:INFO:TRAIN-(cmcm) (1/4/2)>> loss: 0.8787
2024-06-11 20:37:49:INFO:VAL-(cmcm) >>
2024-06-11 20:37:49:INFO:M: >>  Has0_acc_2: 0.6157  Has0_F1_score: 0.5793  Non0_acc_2: 0.6019  Non0_F1_score: 0.5639  Mult_acc_5: 0.1965  Mult_acc_7: 0.1965  MAE: 1.4729  Corr: 0.1130 
2024-06-11 20:38:04:INFO:TRAIN-(cmcm) (2/5/2)>> loss: 0.8826
2024-06-11 20:38:07:INFO:VAL-(cmcm) >>
2024-06-11 20:38:07:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5100  Non0_acc_2: 0.5648  Non0_F1_score: 0.4841  Mult_acc_5: 0.1441  Mult_acc_7: 0.1441  MAE: 1.5261  Corr: -0.0177 
2024-06-11 20:38:21:INFO:TRAIN-(cmcm) (3/6/2)>> loss: 0.8761
2024-06-11 20:38:24:INFO:VAL-(cmcm) >>
2024-06-11 20:38:24:INFO:M: >>  Has0_acc_2: 0.5546  Has0_F1_score: 0.5183  Non0_acc_2: 0.5556  Non0_F1_score: 0.5192  Mult_acc_5: 0.2314  Mult_acc_7: 0.1659  MAE: 1.6717  Corr: 0.0115 
2024-06-11 20:38:38:INFO:TRAIN-(cmcm) (4/7/2)>> loss: 0.8770
2024-06-11 20:38:41:INFO:VAL-(cmcm) >>
2024-06-11 20:38:41:INFO:M: >>  Has0_acc_2: 0.5328  Has0_F1_score: 0.5359  Non0_acc_2: 0.5417  Non0_F1_score: 0.5430  Mult_acc_5: 0.2140  Mult_acc_7: 0.1747  MAE: 1.7742  Corr: 0.0771 
2024-06-11 20:38:55:INFO:TRAIN-(cmcm) (5/8/2)>> loss: 0.8758
2024-06-11 20:38:58:INFO:VAL-(cmcm) >>
2024-06-11 20:38:58:INFO:M: >>  Has0_acc_2: 0.5590  Has0_F1_score: 0.5271  Non0_acc_2: 0.5509  Non0_F1_score: 0.5156  Mult_acc_5: 0.2882  Mult_acc_7: 0.2096  MAE: 1.6324  Corr: 0.0334 
2024-06-11 20:39:12:INFO:TRAIN-(cmcm) (6/9/2)>> loss: 0.8647
2024-06-11 20:39:15:INFO:VAL-(cmcm) >>
2024-06-11 20:39:15:INFO:M: >>  Has0_acc_2: 0.5109  Has0_F1_score: 0.4688  Non0_acc_2: 0.5370  Non0_F1_score: 0.4970  Mult_acc_5: 0.2052  Mult_acc_7: 0.1747  MAE: 1.5580  Corr: 0.2323 
2024-06-11 20:39:29:INFO:TRAIN-(cmcm) (7/10/2)>> loss: 0.8549
2024-06-11 20:39:32:INFO:VAL-(cmcm) >>
2024-06-11 20:39:32:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5219  Non0_acc_2: 0.5787  Non0_F1_score: 0.5029  Mult_acc_5: 0.2445  Mult_acc_7: 0.2271  MAE: 1.5401  Corr: 0.0415 
2024-06-11 20:39:46:INFO:TRAIN-(cmcm) (8/11/2)>> loss: 0.8564
2024-06-11 20:39:49:INFO:VAL-(cmcm) >>
2024-06-11 20:39:49:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.5403  Non0_acc_2: 0.5833  Non0_F1_score: 0.5191  Mult_acc_5: 0.2882  Mult_acc_7: 0.2052  MAE: 1.7590  Corr: 0.0485 
2024-06-11 20:40:04:INFO:TRAIN-(cmcm) (9/12/2)>> loss: 0.8466
2024-06-11 20:40:06:INFO:VAL-(cmcm) >>
2024-06-11 20:40:06:INFO:M: >>  Has0_acc_2: 0.6856  Has0_F1_score: 0.6619  Non0_acc_2: 0.6852  Non0_F1_score: 0.6594  Mult_acc_5: 0.3406  Mult_acc_7: 0.2664  MAE: 1.3180  Corr: 0.3985 
2024-06-11 20:40:06:INFO:Saving checkpoint at epoch 12 to results/models/cmcm-mosi-regression.pth.
2024-06-11 20:40:21:INFO:TRAIN-(cmcm) (1/13/2)>> loss: 0.8263
2024-06-11 20:40:24:INFO:VAL-(cmcm) >>
2024-06-11 20:40:24:INFO:M: >>  Has0_acc_2: 0.6900  Has0_F1_score: 0.6929  Non0_acc_2: 0.7222  Non0_F1_score: 0.7235  Mult_acc_5: 0.3624  Mult_acc_7: 0.2707  MAE: 1.2878  Corr: 0.4547 
2024-06-11 20:40:24:INFO:Saving checkpoint at epoch 13 to results/models/cmcm-mosi-regression.pth.
2024-06-11 20:40:39:INFO:TRAIN-(cmcm) (1/14/2)>> loss: 0.8169
2024-06-11 20:40:41:INFO:VAL-(cmcm) >>
2024-06-11 20:40:41:INFO:M: >>  Has0_acc_2: 0.6856  Has0_F1_score: 0.6883  Non0_acc_2: 0.7130  Non0_F1_score: 0.7141  Mult_acc_5: 0.3144  Mult_acc_7: 0.2707  MAE: 1.2327  Corr: 0.4447 
2024-06-11 20:40:42:INFO:Saving checkpoint at epoch 14 to results/models/cmcm-mosi-regression.pth.
2024-06-11 20:40:57:INFO:TRAIN-(cmcm) (1/15/2)>> loss: 0.8118
2024-06-11 20:40:59:INFO:VAL-(cmcm) >>
2024-06-11 20:40:59:INFO:M: >>  Has0_acc_2: 0.6507  Has0_F1_score: 0.6509  Non0_acc_2: 0.6667  Non0_F1_score: 0.6637  Mult_acc_5: 0.3100  Mult_acc_7: 0.2445  MAE: 1.2254  Corr: 0.4592 
2024-06-11 20:40:59:INFO:Saving checkpoint at epoch 15 to results/models/cmcm-mosi-regression.pth.
2024-06-11 20:41:14:INFO:TRAIN-(cmcm) (1/16/2)>> loss: 0.7990
2024-06-11 20:41:17:INFO:VAL-(cmcm) >>
2024-06-11 20:41:17:INFO:M: >>  Has0_acc_2: 0.7074  Has0_F1_score: 0.7102  Non0_acc_2: 0.7315  Non0_F1_score: 0.7328  Mult_acc_5: 0.3275  Mult_acc_7: 0.2707  MAE: 1.2039  Corr: 0.4715 
2024-06-11 20:41:17:INFO:Saving checkpoint at epoch 16 to results/models/cmcm-mosi-regression.pth.
2024-06-11 20:41:32:INFO:TRAIN-(cmcm) (1/17/2)>> loss: 0.7956
2024-06-11 20:41:34:INFO:VAL-(cmcm) >>
2024-06-11 20:41:34:INFO:M: >>  Has0_acc_2: 0.6856  Has0_F1_score: 0.6880  Non0_acc_2: 0.6852  Non0_F1_score: 0.6868  Mult_acc_5: 0.2751  Mult_acc_7: 0.2358  MAE: 1.2293  Corr: 0.4639 
2024-06-11 20:41:49:INFO:TRAIN-(cmcm) (2/18/2)>> loss: 0.7912
2024-06-11 20:41:51:INFO:VAL-(cmcm) >>
2024-06-11 20:41:51:INFO:M: >>  Has0_acc_2: 0.7380  Has0_F1_score: 0.7309  Non0_acc_2: 0.6713  Non0_F1_score: 0.6706  Mult_acc_5: 0.3362  Mult_acc_7: 0.2969  MAE: 1.1667  Corr: 0.4925 
2024-06-11 20:41:52:INFO:Saving checkpoint at epoch 18 to results/models/cmcm-mosi-regression.pth.
2024-06-11 20:42:07:INFO:TRAIN-(cmcm) (1/19/2)>> loss: 0.7716
2024-06-11 20:42:09:INFO:VAL-(cmcm) >>
2024-06-11 20:42:09:INFO:M: >>  Has0_acc_2: 0.7249  Has0_F1_score: 0.7275  Non0_acc_2: 0.6759  Non0_F1_score: 0.6641  Mult_acc_5: 0.3755  Mult_acc_7: 0.3100  MAE: 1.1191  Corr: 0.5842 
2024-06-11 20:42:09:INFO:Saving checkpoint at epoch 19 to results/models/cmcm-mosi-regression.pth.
2024-06-11 20:42:24:INFO:TRAIN-(cmcm) (1/20/2)>> loss: 0.7734
2024-06-11 20:42:27:INFO:VAL-(cmcm) >>
2024-06-11 20:42:27:INFO:M: >>  Has0_acc_2: 0.7424  Has0_F1_score: 0.7349  Non0_acc_2: 0.6620  Non0_F1_score: 0.6627  Mult_acc_5: 0.3406  Mult_acc_7: 0.2795  MAE: 1.1855  Corr: 0.4530 
2024-06-11 20:42:41:INFO:TRAIN-(cmcm) (2/21/2)>> loss: 0.7517
2024-06-11 20:42:44:INFO:VAL-(cmcm) >>
2024-06-11 20:42:44:INFO:M: >>  Has0_acc_2: 0.7424  Has0_F1_score: 0.7411  Non0_acc_2: 0.7130  Non0_F1_score: 0.7145  Mult_acc_5: 0.3362  Mult_acc_7: 0.2751  MAE: 1.1385  Corr: 0.5373 
2024-06-11 20:42:58:INFO:TRAIN-(cmcm) (3/22/2)>> loss: 0.7476
2024-06-11 20:43:01:INFO:VAL-(cmcm) >>
2024-06-11 20:43:01:INFO:M: >>  Has0_acc_2: 0.6463  Has0_F1_score: 0.6417  Non0_acc_2: 0.6759  Non0_F1_score: 0.6696  Mult_acc_5: 0.3231  Mult_acc_7: 0.2664  MAE: 1.3608  Corr: 0.4775 
2024-06-11 20:43:16:INFO:TRAIN-(cmcm) (4/23/2)>> loss: 0.7374
2024-06-11 20:43:18:INFO:VAL-(cmcm) >>
2024-06-11 20:43:18:INFO:M: >>  Has0_acc_2: 0.7118  Has0_F1_score: 0.7100  Non0_acc_2: 0.7315  Non0_F1_score: 0.7283  Mult_acc_5: 0.3319  Mult_acc_7: 0.2707  MAE: 1.1916  Corr: 0.5201 
2024-06-11 20:43:33:INFO:TRAIN-(cmcm) (5/24/2)>> loss: 0.7308
2024-06-11 20:43:35:INFO:VAL-(cmcm) >>
2024-06-11 20:43:35:INFO:M: >>  Has0_acc_2: 0.7555  Has0_F1_score: 0.7399  Non0_acc_2: 0.7593  Non0_F1_score: 0.7425  Mult_acc_5: 0.4017  Mult_acc_7: 0.2882  MAE: 1.1769  Corr: 0.5457 
2024-06-11 20:43:50:INFO:TRAIN-(cmcm) (6/25/2)>> loss: 0.7284
2024-06-11 20:43:52:INFO:VAL-(cmcm) >>
2024-06-11 20:43:52:INFO:M: >>  Has0_acc_2: 0.7118  Has0_F1_score: 0.7040  Non0_acc_2: 0.7222  Non0_F1_score: 0.7125  Mult_acc_5: 0.3624  Mult_acc_7: 0.2751  MAE: 1.1940  Corr: 0.5101 
2024-06-11 20:44:07:INFO:TRAIN-(cmcm) (7/26/2)>> loss: 0.7244
2024-06-11 20:44:09:INFO:VAL-(cmcm) >>
2024-06-11 20:44:09:INFO:M: >>  Has0_acc_2: 0.6463  Has0_F1_score: 0.6417  Non0_acc_2: 0.6759  Non0_F1_score: 0.6714  Mult_acc_5: 0.3581  Mult_acc_7: 0.2882  MAE: 1.2210  Corr: 0.4874 
2024-06-11 20:44:24:INFO:TRAIN-(cmcm) (8/27/2)>> loss: 0.7058
2024-06-11 20:44:26:INFO:VAL-(cmcm) >>
2024-06-11 20:44:26:INFO:M: >>  Has0_acc_2: 0.7380  Has0_F1_score: 0.7327  Non0_acc_2: 0.7454  Non0_F1_score: 0.7389  Mult_acc_5: 0.3493  Mult_acc_7: 0.2707  MAE: 1.1503  Corr: 0.5224 
2024-06-11 20:44:41:INFO:TRAIN-(cmcm) (9/28/2)>> loss: 0.6960
2024-06-11 20:44:44:INFO:VAL-(cmcm) >>
2024-06-11 20:44:44:INFO:M: >>  Has0_acc_2: 0.6943  Has0_F1_score: 0.6973  Non0_acc_2: 0.7130  Non0_F1_score: 0.7145  Mult_acc_5: 0.3712  Mult_acc_7: 0.3013  MAE: 1.2239  Corr: 0.4945 
2024-06-11 20:44:58:INFO:TRAIN-(cmcm) (10/29/2)>> loss: 0.7005
2024-06-11 20:45:01:INFO:VAL-(cmcm) >>
2024-06-11 20:45:01:INFO:M: >>  Has0_acc_2: 0.7249  Has0_F1_score: 0.7215  Non0_acc_2: 0.7361  Non0_F1_score: 0.7319  Mult_acc_5: 0.3581  Mult_acc_7: 0.3013  MAE: 1.1621  Corr: 0.4979 
2024-06-11 20:45:08:INFO:TEST-(cmcm) >>
2024-06-11 20:45:08:INFO:M: >>  Has0_acc_2: 0.7303  Has0_F1_score: 0.7294  Non0_acc_2: 0.7287  Non0_F1_score: 0.7163  Mult_acc_5: 0.3397  Mult_acc_7: 0.3017  MAE: 1.0617  Corr: 0.5444 
2024-06-11 20:45:08:INFO:Results are added to results/results/mosi-regression-100.csv...
2024-06-11 20:45:08:INFO:Start running cmcm...
2024-06-11 20:45:08:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 100, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 3333}>
2024-06-11 20:45:08:INFO:Let's use the GPU 1 !
2024-06-11 20:45:08:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 20:45:09:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718109909 HTTP/1.1" 200 235
2024-06-11 20:45:09:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 20:45:09:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 20:45:10:INFO:train samples: (1284,)
2024-06-11 20:45:10:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 20:45:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718109910 HTTP/1.1" 200 235
2024-06-11 20:45:11:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 20:45:11:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 20:45:11:INFO:valid samples: (229,)
2024-06-11 20:45:12:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 20:45:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718109912 HTTP/1.1" 200 235
2024-06-11 20:45:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 20:45:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 20:45:13:INFO:test samples: (686,)
2024-06-11 20:45:13:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 20:45:13:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718109913 HTTP/1.1" 200 235
2024-06-11 20:45:13:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 20:45:14:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 20:45:14:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 20:45:15:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718109915 HTTP/1.1" 200 235
2024-06-11 20:45:15:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 20:45:15:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 20:45:15:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-11 20:45:15:WARNING:Try importing flash-attention for faster inference...
2024-06-11 20:45:15:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-11 20:45:15:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-11 20:45:15:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-11 20:45:16:INFO:trainable params: 1310284 || all params: 1838138956 || trainable%: 0.07128318540461856
2024-06-11 20:45:16:INFO:Init labels...
2024-06-11 20:45:16:INFO:Start training...
2024-06-11 20:45:31:INFO:TRAIN-(cmcm) (1/1/3)>> loss: 3.7143
2024-06-11 20:45:33:INFO:VAL-(cmcm) >>
2024-06-11 20:45:33:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4652  Non0_acc_2: 0.5324  Non0_F1_score: 0.5236  Mult_acc_5: 0.2664  Mult_acc_7: 0.1790  MAE: 1.9573  Corr: -0.0062 
2024-06-11 20:45:34:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-11 20:45:49:INFO:TRAIN-(cmcm) (1/2/3)>> loss: 1.0844
2024-06-11 20:45:51:INFO:VAL-(cmcm) >>
2024-06-11 20:45:51:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4866  Non0_acc_2: 0.5000  Non0_F1_score: 0.4753  Mult_acc_5: 0.2140  Mult_acc_7: 0.2140  MAE: 1.4362  Corr: 0.0348 
2024-06-11 20:45:51:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-11 20:46:06:INFO:TRAIN-(cmcm) (1/3/3)>> loss: 0.9182
2024-06-11 20:46:09:INFO:VAL-(cmcm) >>
2024-06-11 20:46:09:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.5292  Non0_acc_2: 0.5880  Non0_F1_score: 0.5044  Mult_acc_5: 0.2969  Mult_acc_7: 0.2183  MAE: 1.6394  Corr: 0.0616 
2024-06-11 20:46:23:INFO:TRAIN-(cmcm) (2/4/3)>> loss: 0.8973
2024-06-11 20:46:26:INFO:VAL-(cmcm) >>
2024-06-11 20:46:26:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.5187  Non0_acc_2: 0.5556  Non0_F1_score: 0.5030  Mult_acc_5: 0.2620  Mult_acc_7: 0.1790  MAE: 1.7835  Corr: 0.0013 
2024-06-11 20:46:40:INFO:TRAIN-(cmcm) (3/5/3)>> loss: 0.8968
2024-06-11 20:46:43:INFO:VAL-(cmcm) >>
2024-06-11 20:46:43:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4866  Non0_acc_2: 0.5278  Non0_F1_score: 0.4950  Mult_acc_5: 0.2096  Mult_acc_7: 0.2052  MAE: 1.4468  Corr: 0.0139 
2024-06-11 20:46:57:INFO:TRAIN-(cmcm) (4/6/3)>> loss: 0.8788
2024-06-11 20:47:00:INFO:VAL-(cmcm) >>
2024-06-11 20:47:00:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4577  Non0_acc_2: 0.5556  Non0_F1_score: 0.4178  Mult_acc_5: 0.2707  Mult_acc_7: 0.2009  MAE: 1.6088  Corr: -0.0293 
2024-06-11 20:47:14:INFO:TRAIN-(cmcm) (5/7/3)>> loss: 0.8780
2024-06-11 20:47:17:INFO:VAL-(cmcm) >>
2024-06-11 20:47:17:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4891  Non0_acc_2: 0.5556  Non0_F1_score: 0.4780  Mult_acc_5: 0.1878  Mult_acc_7: 0.1878  MAE: 1.5392  Corr: -0.0726 
2024-06-11 20:47:31:INFO:TRAIN-(cmcm) (6/8/3)>> loss: 0.8801
2024-06-11 20:47:34:INFO:VAL-(cmcm) >>
2024-06-11 20:47:34:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4978  Non0_acc_2: 0.5741  Non0_F1_score: 0.4742  Mult_acc_5: 0.3100  Mult_acc_7: 0.2314  MAE: 1.7494  Corr: 0.0659 
2024-06-11 20:47:48:INFO:TRAIN-(cmcm) (7/9/3)>> loss: 0.8685
2024-06-11 20:47:51:INFO:VAL-(cmcm) >>
2024-06-11 20:47:51:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4577  Non0_acc_2: 0.5185  Non0_F1_score: 0.5211  Mult_acc_5: 0.2489  Mult_acc_7: 0.2009  MAE: 1.5263  Corr: 0.0324 
2024-06-11 20:48:06:INFO:TRAIN-(cmcm) (8/10/3)>> loss: 0.8628
2024-06-11 20:48:08:INFO:VAL-(cmcm) >>
2024-06-11 20:48:08:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4723  Non0_acc_2: 0.5694  Non0_F1_score: 0.4396  Mult_acc_5: 0.2795  Mult_acc_7: 0.2096  MAE: 1.5931  Corr: -0.0037 
2024-06-11 20:48:23:INFO:TRAIN-(cmcm) (9/11/3)>> loss: 0.8613
2024-06-11 20:48:25:INFO:VAL-(cmcm) >>
2024-06-11 20:48:25:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5100  Non0_acc_2: 0.5648  Non0_F1_score: 0.4841  Mult_acc_5: 0.2314  Mult_acc_7: 0.1834  MAE: 1.5931  Corr: 0.0436 
2024-06-11 20:48:40:INFO:TRAIN-(cmcm) (10/12/3)>> loss: 0.8573
2024-06-11 20:48:42:INFO:VAL-(cmcm) >>
2024-06-11 20:48:42:INFO:M: >>  Has0_acc_2: 0.5546  Has0_F1_score: 0.5154  Non0_acc_2: 0.5278  Non0_F1_score: 0.4950  Mult_acc_5: 0.2445  Mult_acc_7: 0.2009  MAE: 1.5909  Corr: 0.0089 
2024-06-11 20:48:49:INFO:TEST-(cmcm) >>
2024-06-11 20:48:49:INFO:M: >>  Has0_acc_2: 0.4796  Has0_F1_score: 0.3828  Non0_acc_2: 0.4848  Non0_F1_score: 0.4831  Mult_acc_5: 0.1618  Mult_acc_7: 0.1618  MAE: 1.4975  Corr: 0.0054 
2024-06-11 20:48:50:INFO:Results are added to results/results/mosi-regression-100.csv...
2024-06-11 20:48:50:INFO:Start running cmcm...
2024-06-11 20:48:50:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 100, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 4444}>
2024-06-11 20:48:50:INFO:Let's use the GPU 1 !
2024-06-11 20:48:50:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 20:48:50:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718110130 HTTP/1.1" 200 235
2024-06-11 20:48:50:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 20:48:51:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 20:48:51:INFO:train samples: (1284,)
2024-06-11 20:48:52:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 20:48:52:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718110132 HTTP/1.1" 200 235
2024-06-11 20:48:52:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 20:48:52:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 20:48:53:INFO:valid samples: (229,)
2024-06-11 20:48:53:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 20:48:53:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718110133 HTTP/1.1" 200 235
2024-06-11 20:48:53:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 20:48:54:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 20:48:54:INFO:test samples: (686,)
2024-06-11 20:48:54:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 20:48:55:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718110135 HTTP/1.1" 200 235
2024-06-11 20:48:55:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 20:48:55:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 20:48:56:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 20:48:56:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718110136 HTTP/1.1" 200 235
2024-06-11 20:48:56:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 20:48:57:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 20:48:57:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-11 20:48:57:WARNING:Try importing flash-attention for faster inference...
2024-06-11 20:48:57:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-11 20:48:57:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-11 20:48:57:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-11 20:48:58:INFO:trainable params: 1310284 || all params: 1838138956 || trainable%: 0.07128318540461856
2024-06-11 20:48:58:INFO:Init labels...
2024-06-11 20:48:58:INFO:Start training...
2024-06-11 20:49:12:INFO:TRAIN-(cmcm) (1/1/4)>> loss: 2.7785
2024-06-11 20:49:15:INFO:VAL-(cmcm) >>
2024-06-11 20:49:15:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.5518  Non0_acc_2: 0.5694  Non0_F1_score: 0.5649  Mult_acc_5: 0.2096  Mult_acc_7: 0.1616  MAE: 1.5586  Corr: 0.0445 
2024-06-11 20:49:15:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-11 20:49:31:INFO:TRAIN-(cmcm) (1/2/4)>> loss: 1.0531
2024-06-11 20:49:33:INFO:VAL-(cmcm) >>
2024-06-11 20:49:33:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4652  Non0_acc_2: 0.5417  Non0_F1_score: 0.4816  Mult_acc_5: 0.1790  Mult_acc_7: 0.1790  MAE: 1.4763  Corr: -0.0306 
2024-06-11 20:49:34:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-11 20:49:49:INFO:TRAIN-(cmcm) (1/3/4)>> loss: 1.0059
2024-06-11 20:49:51:INFO:VAL-(cmcm) >>
2024-06-11 20:49:51:INFO:M: >>  Has0_acc_2: 0.4148  Has0_F1_score: 0.2718  Non0_acc_2: 0.4352  Non0_F1_score: 0.2892  Mult_acc_5: 0.1266  Mult_acc_7: 0.1223  MAE: 1.8899  Corr: 0.0501 
2024-06-11 20:50:06:INFO:TRAIN-(cmcm) (2/4/4)>> loss: 1.7810
2024-06-11 20:50:08:INFO:VAL-(cmcm) >>
2024-06-11 20:50:08:INFO:M: >>  Has0_acc_2: 0.4847  Has0_F1_score: 0.4373  Non0_acc_2: 0.5093  Non0_F1_score: 0.4537  Mult_acc_5: 0.1528  Mult_acc_7: 0.1528  MAE: 1.6239  Corr: 0.1722 
2024-06-11 20:50:23:INFO:TRAIN-(cmcm) (3/5/4)>> loss: 0.9586
2024-06-11 20:50:26:INFO:VAL-(cmcm) >>
2024-06-11 20:50:26:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.5332  Non0_acc_2: 0.5741  Non0_F1_score: 0.5164  Mult_acc_5: 0.1616  Mult_acc_7: 0.1616  MAE: 1.4846  Corr: 0.0769 
2024-06-11 20:50:40:INFO:TRAIN-(cmcm) (4/6/4)>> loss: 0.9049
2024-06-11 20:50:43:INFO:VAL-(cmcm) >>
2024-06-11 20:50:43:INFO:M: >>  Has0_acc_2: 0.6157  Has0_F1_score: 0.5456  Non0_acc_2: 0.6065  Non0_F1_score: 0.5313  Mult_acc_5: 0.2314  Mult_acc_7: 0.1834  MAE: 1.5175  Corr: 0.1872 
2024-06-11 20:50:58:INFO:TRAIN-(cmcm) (5/7/4)>> loss: 0.8752
2024-06-11 20:51:00:INFO:VAL-(cmcm) >>
2024-06-11 20:51:00:INFO:M: >>  Has0_acc_2: 0.6201  Has0_F1_score: 0.6197  Non0_acc_2: 0.6296  Non0_F1_score: 0.6270  Mult_acc_5: 0.2009  Mult_acc_7: 0.1965  MAE: 1.3943  Corr: 0.2816 
2024-06-11 20:51:00:INFO:Saving checkpoint at epoch 7 to results/models/cmcm-mosi-regression.pth.
2024-06-11 20:51:15:INFO:TRAIN-(cmcm) (1/8/4)>> loss: 0.8605
2024-06-11 20:51:18:INFO:VAL-(cmcm) >>
2024-06-11 20:51:18:INFO:M: >>  Has0_acc_2: 0.6594  Has0_F1_score: 0.6627  Non0_acc_2: 0.6806  Non0_F1_score: 0.6823  Mult_acc_5: 0.3100  Mult_acc_7: 0.2358  MAE: 1.3136  Corr: 0.4003 
2024-06-11 20:51:18:INFO:Saving checkpoint at epoch 8 to results/models/cmcm-mosi-regression.pth.
2024-06-11 20:51:33:INFO:TRAIN-(cmcm) (1/9/4)>> loss: 0.8510
2024-06-11 20:51:36:INFO:VAL-(cmcm) >>
2024-06-11 20:51:36:INFO:M: >>  Has0_acc_2: 0.7118  Has0_F1_score: 0.7086  Non0_acc_2: 0.7176  Non0_F1_score: 0.7131  Mult_acc_5: 0.2838  Mult_acc_7: 0.2009  MAE: 1.2739  Corr: 0.4045 
2024-06-11 20:51:36:INFO:Saving checkpoint at epoch 9 to results/models/cmcm-mosi-regression.pth.
2024-06-11 20:51:51:INFO:TRAIN-(cmcm) (1/10/4)>> loss: 0.8363
2024-06-11 20:51:54:INFO:VAL-(cmcm) >>
2024-06-11 20:51:54:INFO:M: >>  Has0_acc_2: 0.6681  Has0_F1_score: 0.6432  Non0_acc_2: 0.6713  Non0_F1_score: 0.6433  Mult_acc_5: 0.3493  Mult_acc_7: 0.2402  MAE: 1.4110  Corr: 0.3803 
2024-06-11 20:52:08:INFO:TRAIN-(cmcm) (2/11/4)>> loss: 0.8301
2024-06-11 20:52:11:INFO:VAL-(cmcm) >>
2024-06-11 20:52:11:INFO:M: >>  Has0_acc_2: 0.7118  Has0_F1_score: 0.6950  Non0_acc_2: 0.7130  Non0_F1_score: 0.6947  Mult_acc_5: 0.3668  Mult_acc_7: 0.2620  MAE: 1.3106  Corr: 0.4226 
2024-06-11 20:52:25:INFO:TRAIN-(cmcm) (3/12/4)>> loss: 0.8290
2024-06-11 20:52:28:INFO:VAL-(cmcm) >>
2024-06-11 20:52:28:INFO:M: >>  Has0_acc_2: 0.7074  Has0_F1_score: 0.6912  Non0_acc_2: 0.6944  Non0_F1_score: 0.6838  Mult_acc_5: 0.2838  Mult_acc_7: 0.2183  MAE: 1.2088  Corr: 0.4532 
2024-06-11 20:52:28:INFO:Saving checkpoint at epoch 12 to results/models/cmcm-mosi-regression.pth.
2024-06-11 20:52:43:INFO:TRAIN-(cmcm) (1/13/4)>> loss: 0.8019
2024-06-11 20:52:46:INFO:VAL-(cmcm) >>
2024-06-11 20:52:46:INFO:M: >>  Has0_acc_2: 0.7249  Has0_F1_score: 0.7082  Non0_acc_2: 0.7130  Non0_F1_score: 0.7052  Mult_acc_5: 0.3188  Mult_acc_7: 0.2795  MAE: 1.1922  Corr: 0.4525 
2024-06-11 20:52:46:INFO:Saving checkpoint at epoch 13 to results/models/cmcm-mosi-regression.pth.
2024-06-11 20:53:01:INFO:TRAIN-(cmcm) (1/14/4)>> loss: 0.7895
2024-06-11 20:53:03:INFO:VAL-(cmcm) >>
2024-06-11 20:53:03:INFO:M: >>  Has0_acc_2: 0.6987  Has0_F1_score: 0.7012  Non0_acc_2: 0.7361  Non0_F1_score: 0.7371  Mult_acc_5: 0.3406  Mult_acc_7: 0.2533  MAE: 1.2110  Corr: 0.5449 
2024-06-11 20:53:18:INFO:TRAIN-(cmcm) (2/15/4)>> loss: 0.8014
2024-06-11 20:53:20:INFO:VAL-(cmcm) >>
2024-06-11 20:53:20:INFO:M: >>  Has0_acc_2: 0.6288  Has0_F1_score: 0.6170  Non0_acc_2: 0.6620  Non0_F1_score: 0.6516  Mult_acc_5: 0.3144  Mult_acc_7: 0.2445  MAE: 1.4171  Corr: 0.4244 
2024-06-11 20:53:35:INFO:TRAIN-(cmcm) (3/16/4)>> loss: 0.7854
2024-06-11 20:53:38:INFO:VAL-(cmcm) >>
2024-06-11 20:53:38:INFO:M: >>  Has0_acc_2: 0.7118  Has0_F1_score: 0.7143  Non0_acc_2: 0.6898  Non0_F1_score: 0.6874  Mult_acc_5: 0.2795  Mult_acc_7: 0.2358  MAE: 1.1961  Corr: 0.5053 
2024-06-11 20:53:52:INFO:TRAIN-(cmcm) (4/17/4)>> loss: 0.7734
2024-06-11 20:53:55:INFO:VAL-(cmcm) >>
2024-06-11 20:53:55:INFO:M: >>  Has0_acc_2: 0.7293  Has0_F1_score: 0.7199  Non0_acc_2: 0.7407  Non0_F1_score: 0.7355  Mult_acc_5: 0.3537  Mult_acc_7: 0.2882  MAE: 1.1573  Corr: 0.4986 
2024-06-11 20:53:55:INFO:Saving checkpoint at epoch 17 to results/models/cmcm-mosi-regression.pth.
2024-06-11 20:54:10:INFO:TRAIN-(cmcm) (1/18/4)>> loss: 0.7598
2024-06-11 20:54:12:INFO:VAL-(cmcm) >>
2024-06-11 20:54:12:INFO:M: >>  Has0_acc_2: 0.7598  Has0_F1_score: 0.7596  Non0_acc_2: 0.7731  Non0_F1_score: 0.7718  Mult_acc_5: 0.3362  Mult_acc_7: 0.2620  MAE: 1.1586  Corr: 0.5311 
2024-06-11 20:54:27:INFO:TRAIN-(cmcm) (2/19/4)>> loss: 0.7497
2024-06-11 20:54:29:INFO:VAL-(cmcm) >>
2024-06-11 20:54:29:INFO:M: >>  Has0_acc_2: 0.7293  Has0_F1_score: 0.7276  Non0_acc_2: 0.6296  Non0_F1_score: 0.6161  Mult_acc_5: 0.2664  Mult_acc_7: 0.2445  MAE: 1.2140  Corr: 0.4579 
2024-06-11 20:54:44:INFO:TRAIN-(cmcm) (3/20/4)>> loss: 0.7593
2024-06-11 20:54:47:INFO:VAL-(cmcm) >>
2024-06-11 20:54:47:INFO:M: >>  Has0_acc_2: 0.7162  Has0_F1_score: 0.7057  Non0_acc_2: 0.7361  Non0_F1_score: 0.7345  Mult_acc_5: 0.3013  Mult_acc_7: 0.2620  MAE: 1.1385  Corr: 0.5236 
2024-06-11 20:54:47:INFO:Saving checkpoint at epoch 20 to results/models/cmcm-mosi-regression.pth.
2024-06-11 20:55:02:INFO:TRAIN-(cmcm) (1/21/4)>> loss: 0.7594
2024-06-11 20:55:05:INFO:VAL-(cmcm) >>
2024-06-11 20:55:05:INFO:M: >>  Has0_acc_2: 0.7424  Has0_F1_score: 0.7359  Non0_acc_2: 0.7407  Non0_F1_score: 0.7363  Mult_acc_5: 0.3493  Mult_acc_7: 0.2838  MAE: 1.1092  Corr: 0.5419 
2024-06-11 20:55:05:INFO:Saving checkpoint at epoch 21 to results/models/cmcm-mosi-regression.pth.
2024-06-11 20:55:20:INFO:TRAIN-(cmcm) (1/22/4)>> loss: 0.7378
2024-06-11 20:55:22:INFO:VAL-(cmcm) >>
2024-06-11 20:55:22:INFO:M: >>  Has0_acc_2: 0.7380  Has0_F1_score: 0.7392  Non0_acc_2: 0.7731  Non0_F1_score: 0.7742  Mult_acc_5: 0.3057  Mult_acc_7: 0.2838  MAE: 1.1071  Corr: 0.5475 
2024-06-11 20:55:22:INFO:Saving checkpoint at epoch 22 to results/models/cmcm-mosi-regression.pth.
2024-06-11 20:55:37:INFO:TRAIN-(cmcm) (1/23/4)>> loss: 0.7375
2024-06-11 20:55:40:INFO:VAL-(cmcm) >>
2024-06-11 20:55:40:INFO:M: >>  Has0_acc_2: 0.6943  Has0_F1_score: 0.6585  Non0_acc_2: 0.7315  Non0_F1_score: 0.7112  Mult_acc_5: 0.3886  Mult_acc_7: 0.3013  MAE: 1.2114  Corr: 0.5403 
2024-06-11 20:55:55:INFO:TRAIN-(cmcm) (2/24/4)>> loss: 0.7384
2024-06-11 20:55:57:INFO:VAL-(cmcm) >>
2024-06-11 20:55:57:INFO:M: >>  Has0_acc_2: 0.7336  Has0_F1_score: 0.7227  Non0_acc_2: 0.6713  Non0_F1_score: 0.6711  Mult_acc_5: 0.3100  Mult_acc_7: 0.2620  MAE: 1.1542  Corr: 0.5083 
2024-06-11 20:56:12:INFO:TRAIN-(cmcm) (3/25/4)>> loss: 0.7305
2024-06-11 20:56:14:INFO:VAL-(cmcm) >>
2024-06-11 20:56:14:INFO:M: >>  Has0_acc_2: 0.7904  Has0_F1_score: 0.7886  Non0_acc_2: 0.7917  Non0_F1_score: 0.7918  Mult_acc_5: 0.3624  Mult_acc_7: 0.2969  MAE: 1.0638  Corr: 0.5931 
2024-06-11 20:56:14:INFO:Saving checkpoint at epoch 25 to results/models/cmcm-mosi-regression.pth.
2024-06-11 20:56:29:INFO:TRAIN-(cmcm) (1/26/4)>> loss: 0.7168
2024-06-11 20:56:32:INFO:VAL-(cmcm) >>
2024-06-11 20:56:32:INFO:M: >>  Has0_acc_2: 0.7904  Has0_F1_score: 0.7918  Non0_acc_2: 0.7083  Non0_F1_score: 0.7022  Mult_acc_5: 0.3537  Mult_acc_7: 0.2707  MAE: 1.0759  Corr: 0.6236 
2024-06-11 20:56:47:INFO:TRAIN-(cmcm) (2/27/4)>> loss: 0.7007
2024-06-11 20:56:49:INFO:VAL-(cmcm) >>
2024-06-11 20:56:49:INFO:M: >>  Has0_acc_2: 0.7642  Has0_F1_score: 0.7627  Non0_acc_2: 0.7963  Non0_F1_score: 0.7970  Mult_acc_5: 0.3843  Mult_acc_7: 0.3188  MAE: 1.0817  Corr: 0.5752 
2024-06-11 20:57:04:INFO:TRAIN-(cmcm) (3/28/4)>> loss: 0.7039
2024-06-11 20:57:06:INFO:VAL-(cmcm) >>
2024-06-11 20:57:06:INFO:M: >>  Has0_acc_2: 0.7729  Has0_F1_score: 0.7737  Non0_acc_2: 0.8009  Non0_F1_score: 0.8017  Mult_acc_5: 0.3231  Mult_acc_7: 0.2795  MAE: 1.0560  Corr: 0.6099 
2024-06-11 20:57:06:INFO:Saving checkpoint at epoch 28 to results/models/cmcm-mosi-regression.pth.
2024-06-11 20:57:21:INFO:TRAIN-(cmcm) (1/29/4)>> loss: 0.6976
2024-06-11 20:57:24:INFO:VAL-(cmcm) >>
2024-06-11 20:57:24:INFO:M: >>  Has0_acc_2: 0.7336  Has0_F1_score: 0.7361  Non0_acc_2: 0.7500  Non0_F1_score: 0.7496  Mult_acc_5: 0.3319  Mult_acc_7: 0.2926  MAE: 1.0929  Corr: 0.5566 
2024-06-11 20:57:38:INFO:TRAIN-(cmcm) (2/30/4)>> loss: 0.6866
2024-06-11 20:57:41:INFO:VAL-(cmcm) >>
2024-06-11 20:57:41:INFO:M: >>  Has0_acc_2: 0.7948  Has0_F1_score: 0.7963  Non0_acc_2: 0.8056  Non0_F1_score: 0.8064  Mult_acc_5: 0.3537  Mult_acc_7: 0.2707  MAE: 1.0595  Corr: 0.6182 
2024-06-11 20:57:56:INFO:TRAIN-(cmcm) (3/31/4)>> loss: 0.6722
2024-06-11 20:57:58:INFO:VAL-(cmcm) >>
2024-06-11 20:57:58:INFO:M: >>  Has0_acc_2: 0.7467  Has0_F1_score: 0.7379  Non0_acc_2: 0.7824  Non0_F1_score: 0.7834  Mult_acc_5: 0.4061  Mult_acc_7: 0.3406  MAE: 1.0432  Corr: 0.5932 
2024-06-11 20:57:58:INFO:Saving checkpoint at epoch 31 to results/models/cmcm-mosi-regression.pth.
2024-06-11 20:58:13:INFO:TRAIN-(cmcm) (1/32/4)>> loss: 0.6696
2024-06-11 20:58:16:INFO:VAL-(cmcm) >>
2024-06-11 20:58:16:INFO:M: >>  Has0_acc_2: 0.7511  Has0_F1_score: 0.7509  Non0_acc_2: 0.7685  Non0_F1_score: 0.7669  Mult_acc_5: 0.3537  Mult_acc_7: 0.3013  MAE: 1.0908  Corr: 0.5502 
2024-06-11 20:58:30:INFO:TRAIN-(cmcm) (2/33/4)>> loss: 0.6701
2024-06-11 20:58:33:INFO:VAL-(cmcm) >>
2024-06-11 20:58:33:INFO:M: >>  Has0_acc_2: 0.7860  Has0_F1_score: 0.7862  Non0_acc_2: 0.6667  Non0_F1_score: 0.6629  Mult_acc_5: 0.2882  Mult_acc_7: 0.2489  MAE: 1.1210  Corr: 0.5437 
2024-06-11 20:58:48:INFO:TRAIN-(cmcm) (3/34/4)>> loss: 0.6587
2024-06-11 20:58:50:INFO:VAL-(cmcm) >>
2024-06-11 20:58:50:INFO:M: >>  Has0_acc_2: 0.7729  Has0_F1_score: 0.7715  Non0_acc_2: 0.8009  Non0_F1_score: 0.8001  Mult_acc_5: 0.3668  Mult_acc_7: 0.2838  MAE: 1.0453  Corr: 0.5932 
2024-06-11 20:59:05:INFO:TRAIN-(cmcm) (4/35/4)>> loss: 0.6550
2024-06-11 20:59:07:INFO:VAL-(cmcm) >>
2024-06-11 20:59:07:INFO:M: >>  Has0_acc_2: 0.7293  Has0_F1_score: 0.7303  Non0_acc_2: 0.7083  Non0_F1_score: 0.7060  Mult_acc_5: 0.3144  Mult_acc_7: 0.2707  MAE: 1.1861  Corr: 0.5130 
2024-06-11 20:59:22:INFO:TRAIN-(cmcm) (5/36/4)>> loss: 0.6416
2024-06-11 20:59:24:INFO:VAL-(cmcm) >>
2024-06-11 20:59:24:INFO:M: >>  Has0_acc_2: 0.7860  Has0_F1_score: 0.7871  Non0_acc_2: 0.8009  Non0_F1_score: 0.8018  Mult_acc_5: 0.4323  Mult_acc_7: 0.3712  MAE: 0.9983  Corr: 0.6357 
2024-06-11 20:59:25:INFO:Saving checkpoint at epoch 36 to results/models/cmcm-mosi-regression.pth.
2024-06-11 20:59:39:INFO:TRAIN-(cmcm) (1/37/4)>> loss: 0.6206
2024-06-11 20:59:42:INFO:VAL-(cmcm) >>
2024-06-11 20:59:42:INFO:M: >>  Has0_acc_2: 0.7424  Has0_F1_score: 0.7437  Non0_acc_2: 0.7778  Non0_F1_score: 0.7783  Mult_acc_5: 0.3974  Mult_acc_7: 0.3231  MAE: 1.0861  Corr: 0.5710 
2024-06-11 20:59:57:INFO:TRAIN-(cmcm) (2/38/4)>> loss: 0.6226
2024-06-11 20:59:59:INFO:VAL-(cmcm) >>
2024-06-11 20:59:59:INFO:M: >>  Has0_acc_2: 0.7511  Has0_F1_score: 0.7535  Non0_acc_2: 0.7546  Non0_F1_score: 0.7558  Mult_acc_5: 0.4061  Mult_acc_7: 0.3057  MAE: 1.0713  Corr: 0.6360 
2024-06-11 21:00:14:INFO:TRAIN-(cmcm) (3/39/4)>> loss: 0.6070
2024-06-11 21:00:16:INFO:VAL-(cmcm) >>
2024-06-11 21:00:16:INFO:M: >>  Has0_acc_2: 0.7511  Has0_F1_score: 0.7504  Non0_acc_2: 0.7546  Non0_F1_score: 0.7554  Mult_acc_5: 0.3450  Mult_acc_7: 0.2751  MAE: 1.1167  Corr: 0.5535 
2024-06-11 21:00:31:INFO:TRAIN-(cmcm) (4/40/4)>> loss: 0.5978
2024-06-11 21:00:33:INFO:VAL-(cmcm) >>
2024-06-11 21:00:33:INFO:M: >>  Has0_acc_2: 0.7511  Has0_F1_score: 0.7531  Non0_acc_2: 0.7500  Non0_F1_score: 0.7514  Mult_acc_5: 0.4148  Mult_acc_7: 0.3450  MAE: 1.0455  Corr: 0.5841 
2024-06-11 21:00:48:INFO:TRAIN-(cmcm) (5/41/4)>> loss: 0.5925
2024-06-11 21:00:50:INFO:VAL-(cmcm) >>
2024-06-11 21:00:50:INFO:M: >>  Has0_acc_2: 0.7555  Has0_F1_score: 0.7569  Non0_acc_2: 0.7361  Non0_F1_score: 0.7376  Mult_acc_5: 0.3406  Mult_acc_7: 0.2751  MAE: 1.1152  Corr: 0.5750 
2024-06-11 21:01:05:INFO:TRAIN-(cmcm) (6/42/4)>> loss: 0.5759
2024-06-11 21:01:08:INFO:VAL-(cmcm) >>
2024-06-11 21:01:08:INFO:M: >>  Has0_acc_2: 0.7293  Has0_F1_score: 0.7315  Non0_acc_2: 0.7407  Non0_F1_score: 0.7418  Mult_acc_5: 0.3974  Mult_acc_7: 0.3144  MAE: 1.0881  Corr: 0.5555 
2024-06-11 21:01:22:INFO:TRAIN-(cmcm) (7/43/4)>> loss: 0.5555
2024-06-11 21:01:25:INFO:VAL-(cmcm) >>
2024-06-11 21:01:25:INFO:M: >>  Has0_acc_2: 0.7511  Has0_F1_score: 0.7527  Non0_acc_2: 0.7454  Non0_F1_score: 0.7463  Mult_acc_5: 0.3712  Mult_acc_7: 0.2838  MAE: 1.1293  Corr: 0.5435 
2024-06-11 21:01:39:INFO:TRAIN-(cmcm) (8/44/4)>> loss: 0.5486
2024-06-11 21:01:42:INFO:VAL-(cmcm) >>
2024-06-11 21:01:42:INFO:M: >>  Has0_acc_2: 0.7205  Has0_F1_score: 0.7210  Non0_acc_2: 0.7222  Non0_F1_score: 0.7237  Mult_acc_5: 0.3231  Mult_acc_7: 0.2620  MAE: 1.1851  Corr: 0.5052 
2024-06-11 21:01:56:INFO:TRAIN-(cmcm) (9/45/4)>> loss: 0.5389
2024-06-11 21:01:59:INFO:VAL-(cmcm) >>
2024-06-11 21:01:59:INFO:M: >>  Has0_acc_2: 0.7555  Has0_F1_score: 0.7573  Non0_acc_2: 0.7639  Non0_F1_score: 0.7648  Mult_acc_5: 0.3974  Mult_acc_7: 0.3100  MAE: 1.1044  Corr: 0.5589 
2024-06-11 21:02:14:INFO:TRAIN-(cmcm) (10/46/4)>> loss: 0.5091
2024-06-11 21:02:16:INFO:VAL-(cmcm) >>
2024-06-11 21:02:16:INFO:M: >>  Has0_acc_2: 0.7555  Has0_F1_score: 0.7566  Non0_acc_2: 0.7222  Non0_F1_score: 0.7237  Mult_acc_5: 0.3057  Mult_acc_7: 0.2664  MAE: 1.1257  Corr: 0.5470 
2024-06-11 21:02:23:INFO:TEST-(cmcm) >>
2024-06-11 21:02:23:INFO:M: >>  Has0_acc_2: 0.7478  Has0_F1_score: 0.7470  Non0_acc_2: 0.7652  Non0_F1_score: 0.7640  Mult_acc_5: 0.3484  Mult_acc_7: 0.3061  MAE: 1.0759  Corr: 0.5532 
2024-06-11 21:02:24:INFO:Results are added to results/results/mosi-regression-100.csv...
2024-06-11 21:02:24:INFO:Start running cmcm...
2024-06-11 21:02:24:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 100, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 5555}>
2024-06-11 21:02:24:INFO:Let's use the GPU 1 !
2024-06-11 21:02:24:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 21:02:24:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718110944 HTTP/1.1" 200 235
2024-06-11 21:02:24:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 21:02:25:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 21:02:25:INFO:train samples: (1284,)
2024-06-11 21:02:26:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 21:02:26:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718110946 HTTP/1.1" 200 235
2024-06-11 21:02:26:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 21:02:27:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 21:02:27:INFO:valid samples: (229,)
2024-06-11 21:02:27:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 21:02:28:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718110948 HTTP/1.1" 200 235
2024-06-11 21:02:28:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 21:02:28:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 21:02:29:INFO:test samples: (686,)
2024-06-11 21:02:29:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 21:02:29:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718110949 HTTP/1.1" 200 235
2024-06-11 21:02:29:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 21:02:30:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 21:02:30:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-11 21:02:30:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718110950 HTTP/1.1" 200 235
2024-06-11 21:02:30:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-11 21:02:31:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-11 21:02:31:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-11 21:02:31:WARNING:Try importing flash-attention for faster inference...
2024-06-11 21:02:31:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-11 21:02:31:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-11 21:02:31:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-11 21:02:32:INFO:trainable params: 1310284 || all params: 1838138956 || trainable%: 0.07128318540461856
2024-06-11 21:02:32:INFO:Init labels...
2024-06-11 21:02:32:INFO:Start training...
2024-06-11 21:02:47:INFO:TRAIN-(cmcm) (1/1/5)>> loss: 2.3802
2024-06-11 21:02:49:INFO:VAL-(cmcm) >>
2024-06-11 21:02:49:INFO:M: >>  Has0_acc_2: 0.4279  Has0_F1_score: 0.3623  Non0_acc_2: 0.4491  Non0_F1_score: 0.3672  Mult_acc_5: 0.2009  Mult_acc_7: 0.2009  MAE: 1.4842  Corr: 0.0305 
2024-06-11 21:02:50:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-11 21:03:05:INFO:TRAIN-(cmcm) (1/2/5)>> loss: 0.9959
2024-06-11 21:03:07:INFO:VAL-(cmcm) >>
2024-06-11 21:03:07:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5271  Non0_acc_2: 0.5046  Non0_F1_score: 0.4984  Mult_acc_5: 0.1965  Mult_acc_7: 0.1921  MAE: 1.4449  Corr: 0.0495 
2024-06-11 21:03:08:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-11 21:03:23:INFO:TRAIN-(cmcm) (1/3/5)>> loss: 0.9629
2024-06-11 21:03:25:INFO:VAL-(cmcm) >>
2024-06-11 21:03:25:INFO:M: >>  Has0_acc_2: 0.4192  Has0_F1_score: 0.2869  Non0_acc_2: 0.4398  Non0_F1_score: 0.2841  Mult_acc_5: 0.1266  Mult_acc_7: 0.1179  MAE: 1.8143  Corr: 0.0632 
2024-06-11 21:03:40:INFO:TRAIN-(cmcm) (2/4/5)>> loss: 0.9538
2024-06-11 21:03:42:INFO:VAL-(cmcm) >>
2024-06-11 21:03:42:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.5029  Non0_acc_2: 0.5880  Non0_F1_score: 0.4767  Mult_acc_5: 0.1528  Mult_acc_7: 0.1528  MAE: 1.5183  Corr: 0.0257 
2024-06-11 21:03:57:INFO:TRAIN-(cmcm) (3/5/5)>> loss: 0.9272
2024-06-11 21:03:59:INFO:VAL-(cmcm) >>
2024-06-11 21:03:59:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5556  Non0_F1_score: 0.4571  Mult_acc_5: 0.2402  Mult_acc_7: 0.1703  MAE: 1.5848  Corr: 0.0403 
2024-06-11 21:04:14:INFO:TRAIN-(cmcm) (4/6/5)>> loss: 0.9112
2024-06-11 21:04:16:INFO:VAL-(cmcm) >>
2024-06-11 21:04:16:INFO:M: >>  Has0_acc_2: 0.5546  Has0_F1_score: 0.5391  Non0_acc_2: 0.5417  Non0_F1_score: 0.5248  Mult_acc_5: 0.2314  Mult_acc_7: 0.1747  MAE: 1.6407  Corr: -0.0037 
2024-06-11 21:04:31:INFO:TRAIN-(cmcm) (5/7/5)>> loss: 0.9001
2024-06-11 21:04:33:INFO:VAL-(cmcm) >>
2024-06-11 21:04:33:INFO:M: >>  Has0_acc_2: 0.5590  Has0_F1_score: 0.5603  Non0_acc_2: 0.5648  Non0_F1_score: 0.5642  Mult_acc_5: 0.2664  Mult_acc_7: 0.1965  MAE: 1.7101  Corr: 0.1520 
2024-06-11 21:04:48:INFO:TRAIN-(cmcm) (6/8/5)>> loss: 0.8957
2024-06-11 21:04:50:INFO:VAL-(cmcm) >>
2024-06-11 21:04:50:INFO:M: >>  Has0_acc_2: 0.4672  Has0_F1_score: 0.3965  Non0_acc_2: 0.4907  Non0_F1_score: 0.4214  Mult_acc_5: 0.2009  Mult_acc_7: 0.1485  MAE: 1.9477  Corr: 0.1131 
2024-06-11 21:05:05:INFO:TRAIN-(cmcm) (7/9/5)>> loss: 0.8856
2024-06-11 21:05:07:INFO:VAL-(cmcm) >>
2024-06-11 21:05:07:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5753  Non0_acc_2: 0.5972  Non0_F1_score: 0.5748  Mult_acc_5: 0.2795  Mult_acc_7: 0.2009  MAE: 1.6625  Corr: 0.1010 
2024-06-11 21:05:22:INFO:TRAIN-(cmcm) (8/10/5)>> loss: 0.8733
2024-06-11 21:05:24:INFO:VAL-(cmcm) >>
2024-06-11 21:05:24:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4976  Non0_acc_2: 0.5787  Non0_F1_score: 0.4711  Mult_acc_5: 0.2009  Mult_acc_7: 0.1790  MAE: 1.5975  Corr: 0.0585 
2024-06-11 21:05:39:INFO:TRAIN-(cmcm) (9/11/5)>> loss: 0.8753
2024-06-11 21:05:42:INFO:VAL-(cmcm) >>
2024-06-11 21:05:42:INFO:M: >>  Has0_acc_2: 0.6550  Has0_F1_score: 0.6570  Non0_acc_2: 0.6528  Non0_F1_score: 0.6525  Mult_acc_5: 0.2882  Mult_acc_7: 0.2183  MAE: 1.4909  Corr: 0.3372 
2024-06-11 21:05:56:INFO:TRAIN-(cmcm) (10/12/5)>> loss: 0.8604
2024-06-11 21:05:59:INFO:VAL-(cmcm) >>
2024-06-11 21:05:59:INFO:M: >>  Has0_acc_2: 0.6419  Has0_F1_score: 0.6054  Non0_acc_2: 0.6296  Non0_F1_score: 0.5916  Mult_acc_5: 0.2882  Mult_acc_7: 0.2096  MAE: 1.5424  Corr: 0.1746 
2024-06-11 21:06:06:INFO:TEST-(cmcm) >>
2024-06-11 21:06:06:INFO:M: >>  Has0_acc_2: 0.4665  Has0_F1_score: 0.3978  Non0_acc_2: 0.5625  Non0_F1_score: 0.5423  Mult_acc_5: 0.1633  Mult_acc_7: 0.1603  MAE: 1.4766  Corr: 0.0363 
2024-06-11 21:06:06:INFO:Results are added to results/results/mosi-regression-100.csv...
2024-06-12 11:19:58:INFO:Start running cmcm...
2024-06-12 11:19:58:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-06-12 11:19:58:INFO:Find gpu: 1, with memory: 378273792 left!
2024-06-12 11:19:58:INFO:Let's use the GPU 1 !
2024-06-12 11:19:58:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 11:19:58:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718162398 HTTP/1.1" 200 235
2024-06-12 11:19:58:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 11:19:59:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 11:19:59:INFO:train samples: (1284,)
2024-06-12 11:20:00:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 11:20:00:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718162400 HTTP/1.1" 200 235
2024-06-12 11:20:00:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 11:20:01:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 11:20:01:INFO:valid samples: (229,)
2024-06-12 11:20:01:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 11:20:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718162402 HTTP/1.1" 200 235
2024-06-12 11:20:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 11:20:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 11:20:03:INFO:test samples: (686,)
2024-06-12 11:20:03:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 11:20:03:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718162403 HTTP/1.1" 200 235
2024-06-12 11:20:03:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 11:20:04:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 11:20:04:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 11:20:04:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718162405 HTTP/1.1" 200 235
2024-06-12 11:20:05:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 11:20:05:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 11:20:05:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-12 11:20:05:WARNING:Try importing flash-attention for faster inference...
2024-06-12 11:20:05:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-12 11:20:05:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-12 11:20:05:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-12 11:20:08:INFO:trainable params: 1310284 || all params: 1838138956 || trainable%: 0.07128318540461856
2024-06-12 11:20:08:INFO:Init labels...
2024-06-12 11:20:08:INFO:Start training...
2024-06-12 11:20:24:INFO:TRAIN-(cmcm) (1/1/1)>> loss: 2.9528
2024-06-12 11:20:27:INFO:VAL-(cmcm) >>
2024-06-12 11:20:27:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5315  Non0_acc_2: 0.5463  Non0_F1_score: 0.5148  Mult_acc_5: 0.1790  Mult_acc_7: 0.1790  MAE: 1.4973  Corr: 0.0028 
2024-06-12 11:20:29:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-12 11:20:44:INFO:TRAIN-(cmcm) (1/2/1)>> loss: 1.0199
2024-06-12 11:20:46:INFO:VAL-(cmcm) >>
2024-06-12 11:20:47:INFO:M: >>  Has0_acc_2: 0.5109  Has0_F1_score: 0.5128  Non0_acc_2: 0.5185  Non0_F1_score: 0.5185  Mult_acc_5: 0.2664  Mult_acc_7: 0.2052  MAE: 1.8494  Corr: 0.0432 
2024-06-12 11:21:01:INFO:TRAIN-(cmcm) (2/3/1)>> loss: 0.9270
2024-06-12 11:21:04:INFO:VAL-(cmcm) >>
2024-06-12 11:21:04:INFO:M: >>  Has0_acc_2: 0.5459  Has0_F1_score: 0.5144  Non0_acc_2: 0.5370  Non0_F1_score: 0.5049  Mult_acc_5: 0.2052  Mult_acc_7: 0.1747  MAE: 1.6069  Corr: -0.0139 
2024-06-12 11:21:18:INFO:TRAIN-(cmcm) (3/4/1)>> loss: 0.9068
2024-06-12 11:21:21:INFO:VAL-(cmcm) >>
2024-06-12 11:21:21:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.5292  Non0_acc_2: 0.5787  Non0_F1_score: 0.5117  Mult_acc_5: 0.1878  Mult_acc_7: 0.1659  MAE: 1.6411  Corr: 0.0011 
2024-06-12 11:21:35:INFO:TRAIN-(cmcm) (4/5/1)>> loss: 0.9022
2024-06-12 11:21:38:INFO:VAL-(cmcm) >>
2024-06-12 11:21:38:INFO:M: >>  Has0_acc_2: 0.5459  Has0_F1_score: 0.5499  Non0_acc_2: 0.5463  Non0_F1_score: 0.5485  Mult_acc_5: 0.2751  Mult_acc_7: 0.2052  MAE: 1.7023  Corr: 0.1000 
2024-06-12 11:21:52:INFO:TRAIN-(cmcm) (5/6/1)>> loss: 0.8785
2024-06-12 11:21:55:INFO:VAL-(cmcm) >>
2024-06-12 11:21:55:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5721  Non0_acc_2: 0.5648  Non0_F1_score: 0.5634  Mult_acc_5: 0.2096  Mult_acc_7: 0.1921  MAE: 1.5877  Corr: 0.1367 
2024-06-12 11:22:09:INFO:TRAIN-(cmcm) (6/7/1)>> loss: 0.8701
2024-06-12 11:22:12:INFO:VAL-(cmcm) >>
2024-06-12 11:22:12:INFO:M: >>  Has0_acc_2: 0.5590  Has0_F1_score: 0.5534  Non0_acc_2: 0.5509  Non0_F1_score: 0.5472  Mult_acc_5: 0.2707  Mult_acc_7: 0.1965  MAE: 1.5271  Corr: 0.1237 
2024-06-12 11:22:27:INFO:TRAIN-(cmcm) (7/8/1)>> loss: 0.8710
2024-06-12 11:22:29:INFO:VAL-(cmcm) >>
2024-06-12 11:22:29:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5129  Non0_acc_2: 0.5694  Non0_F1_score: 0.5010  Mult_acc_5: 0.2969  Mult_acc_7: 0.2183  MAE: 1.7145  Corr: -0.0168 
2024-06-12 11:22:44:INFO:TRAIN-(cmcm) (8/9/1)>> loss: 0.8692
2024-06-12 11:22:46:INFO:VAL-(cmcm) >>
2024-06-12 11:22:46:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.5363  Non0_acc_2: 0.5880  Non0_F1_score: 0.5182  Mult_acc_5: 0.2838  Mult_acc_7: 0.2052  MAE: 1.7293  Corr: 0.0593 
2024-06-12 11:23:01:INFO:TRAIN-(cmcm) (9/10/1)>> loss: 0.8604
2024-06-12 11:23:03:INFO:VAL-(cmcm) >>
2024-06-12 11:23:03:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5669  Non0_acc_2: 0.5833  Non0_F1_score: 0.5568  Mult_acc_5: 0.2533  Mult_acc_7: 0.1965  MAE: 1.6966  Corr: 0.0574 
2024-06-12 11:23:18:INFO:TRAIN-(cmcm) (10/11/1)>> loss: 0.8556
2024-06-12 11:23:20:INFO:VAL-(cmcm) >>
2024-06-12 11:23:20:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5754  Non0_acc_2: 0.5000  Non0_F1_score: 0.4567  Mult_acc_5: 0.2576  Mult_acc_7: 0.2314  MAE: 1.4672  Corr: 0.1596 
2024-06-12 11:23:21:INFO:Saving checkpoint at epoch 11 to results/models/cmcm-mosi-regression.pth.
2024-06-12 11:23:36:INFO:TRAIN-(cmcm) (1/12/1)>> loss: 0.8532
2024-06-12 11:23:39:INFO:VAL-(cmcm) >>
2024-06-12 11:23:39:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.5512  Non0_acc_2: 0.5833  Non0_F1_score: 0.5340  Mult_acc_5: 0.2533  Mult_acc_7: 0.1790  MAE: 1.6961  Corr: 0.0674 
2024-06-12 11:23:53:INFO:TRAIN-(cmcm) (2/13/1)>> loss: 0.8442
2024-06-12 11:23:56:INFO:VAL-(cmcm) >>
2024-06-12 11:23:56:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.5201  Non0_acc_2: 0.5463  Non0_F1_score: 0.5463  Mult_acc_5: 0.2533  Mult_acc_7: 0.1921  MAE: 1.5516  Corr: 0.0720 
2024-06-12 11:24:10:INFO:TRAIN-(cmcm) (3/14/1)>> loss: 0.8462
2024-06-12 11:24:13:INFO:VAL-(cmcm) >>
2024-06-12 11:24:13:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.5859  Non0_acc_2: 0.5926  Non0_F1_score: 0.5784  Mult_acc_5: 0.2751  Mult_acc_7: 0.2009  MAE: 1.5582  Corr: 0.1256 
2024-06-12 11:24:27:INFO:TRAIN-(cmcm) (4/15/1)>> loss: 0.8351
2024-06-12 11:24:30:INFO:VAL-(cmcm) >>
2024-06-12 11:24:30:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.5394  Non0_acc_2: 0.6019  Non0_F1_score: 0.5579  Mult_acc_5: 0.3144  Mult_acc_7: 0.2533  MAE: 1.5100  Corr: 0.1153 
2024-06-12 11:24:45:INFO:TRAIN-(cmcm) (5/16/1)>> loss: 0.8268
2024-06-12 11:24:47:INFO:VAL-(cmcm) >>
2024-06-12 11:24:47:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.6147  Non0_acc_2: 0.6157  Non0_F1_score: 0.6179  Mult_acc_5: 0.3275  Mult_acc_7: 0.2445  MAE: 1.4966  Corr: 0.2535 
2024-06-12 11:25:02:INFO:TRAIN-(cmcm) (6/17/1)>> loss: 0.8258
2024-06-12 11:25:04:INFO:VAL-(cmcm) >>
2024-06-12 11:25:04:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.5249  Non0_acc_2: 0.6065  Non0_F1_score: 0.5780  Mult_acc_5: 0.2707  Mult_acc_7: 0.2096  MAE: 1.4979  Corr: 0.1624 
2024-06-12 11:25:19:INFO:TRAIN-(cmcm) (7/18/1)>> loss: 0.8120
2024-06-12 11:25:21:INFO:VAL-(cmcm) >>
2024-06-12 11:25:21:INFO:M: >>  Has0_acc_2: 0.6419  Has0_F1_score: 0.6453  Non0_acc_2: 0.6435  Non0_F1_score: 0.6454  Mult_acc_5: 0.3144  Mult_acc_7: 0.2314  MAE: 1.4625  Corr: 0.3298 
2024-06-12 11:25:22:INFO:Saving checkpoint at epoch 18 to results/models/cmcm-mosi-regression.pth.
2024-06-12 11:25:37:INFO:TRAIN-(cmcm) (1/19/1)>> loss: 0.8065
2024-06-12 11:25:39:INFO:VAL-(cmcm) >>
2024-06-12 11:25:39:INFO:M: >>  Has0_acc_2: 0.6245  Has0_F1_score: 0.6082  Non0_acc_2: 0.6111  Non0_F1_score: 0.6065  Mult_acc_5: 0.3100  Mult_acc_7: 0.2271  MAE: 1.4285  Corr: 0.2845 
2024-06-12 11:25:40:INFO:Saving checkpoint at epoch 19 to results/models/cmcm-mosi-regression.pth.
2024-06-12 11:25:55:INFO:TRAIN-(cmcm) (1/20/1)>> loss: 0.8002
2024-06-12 11:25:58:INFO:VAL-(cmcm) >>
2024-06-12 11:25:58:INFO:M: >>  Has0_acc_2: 0.6245  Has0_F1_score: 0.6254  Non0_acc_2: 0.6389  Non0_F1_score: 0.6371  Mult_acc_5: 0.3188  Mult_acc_7: 0.2445  MAE: 1.4079  Corr: 0.2964 
2024-06-12 11:25:58:INFO:Saving checkpoint at epoch 20 to results/models/cmcm-mosi-regression.pth.
2024-06-12 11:26:14:INFO:TRAIN-(cmcm) (1/21/1)>> loss: 0.7934
2024-06-12 11:26:16:INFO:VAL-(cmcm) >>
2024-06-12 11:26:16:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.6019  Non0_acc_2: 0.6019  Non0_F1_score: 0.5929  Mult_acc_5: 0.3188  Mult_acc_7: 0.2533  MAE: 1.3612  Corr: 0.3797 
2024-06-12 11:26:17:INFO:Saving checkpoint at epoch 21 to results/models/cmcm-mosi-regression.pth.
2024-06-12 11:26:32:INFO:TRAIN-(cmcm) (1/22/1)>> loss: 0.7765
2024-06-12 11:26:35:INFO:VAL-(cmcm) >>
2024-06-12 11:26:35:INFO:M: >>  Has0_acc_2: 0.6376  Has0_F1_score: 0.6044  Non0_acc_2: 0.6250  Non0_F1_score: 0.5955  Mult_acc_5: 0.3013  Mult_acc_7: 0.2227  MAE: 1.4564  Corr: 0.2422 
2024-06-12 11:26:49:INFO:TRAIN-(cmcm) (2/23/1)>> loss: 0.7675
2024-06-12 11:26:52:INFO:VAL-(cmcm) >>
2024-06-12 11:26:52:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.6150  Non0_acc_2: 0.5972  Non0_F1_score: 0.5956  Mult_acc_5: 0.3100  Mult_acc_7: 0.2445  MAE: 1.4494  Corr: 0.2759 
2024-06-12 11:27:06:INFO:TRAIN-(cmcm) (3/24/1)>> loss: 0.7579
2024-06-12 11:27:09:INFO:VAL-(cmcm) >>
2024-06-12 11:27:09:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.6011  Non0_acc_2: 0.6343  Non0_F1_score: 0.6305  Mult_acc_5: 0.3537  Mult_acc_7: 0.2707  MAE: 1.4468  Corr: 0.3083 
2024-06-12 11:27:23:INFO:TRAIN-(cmcm) (4/25/1)>> loss: 0.7501
2024-06-12 11:27:26:INFO:VAL-(cmcm) >>
2024-06-12 11:27:26:INFO:M: >>  Has0_acc_2: 0.6157  Has0_F1_score: 0.6179  Non0_acc_2: 0.6296  Non0_F1_score: 0.6309  Mult_acc_5: 0.3188  Mult_acc_7: 0.2358  MAE: 1.4499  Corr: 0.2430 
2024-06-12 11:27:41:INFO:TRAIN-(cmcm) (5/26/1)>> loss: 0.7383
2024-06-12 11:27:43:INFO:VAL-(cmcm) >>
2024-06-12 11:27:43:INFO:M: >>  Has0_acc_2: 0.6288  Has0_F1_score: 0.6270  Non0_acc_2: 0.6389  Non0_F1_score: 0.6398  Mult_acc_5: 0.3362  Mult_acc_7: 0.2576  MAE: 1.3763  Corr: 0.2913 
2024-06-12 11:27:58:INFO:TRAIN-(cmcm) (6/27/1)>> loss: 0.7315
2024-06-12 11:28:00:INFO:VAL-(cmcm) >>
2024-06-12 11:28:00:INFO:M: >>  Has0_acc_2: 0.6245  Has0_F1_score: 0.6129  Non0_acc_2: 0.6435  Non0_F1_score: 0.6379  Mult_acc_5: 0.3362  Mult_acc_7: 0.2489  MAE: 1.3996  Corr: 0.2856 
2024-06-12 11:28:15:INFO:TRAIN-(cmcm) (7/28/1)>> loss: 0.7231
2024-06-12 11:28:18:INFO:VAL-(cmcm) >>
2024-06-12 11:28:18:INFO:M: >>  Has0_acc_2: 0.6288  Has0_F1_score: 0.6261  Non0_acc_2: 0.6296  Non0_F1_score: 0.6296  Mult_acc_5: 0.3231  Mult_acc_7: 0.2402  MAE: 1.3913  Corr: 0.2845 
2024-06-12 11:28:32:INFO:TRAIN-(cmcm) (8/29/1)>> loss: 0.7200
2024-06-12 11:28:35:INFO:VAL-(cmcm) >>
2024-06-12 11:28:35:INFO:M: >>  Has0_acc_2: 0.6288  Has0_F1_score: 0.6231  Non0_acc_2: 0.6528  Non0_F1_score: 0.6507  Mult_acc_5: 0.3581  Mult_acc_7: 0.2707  MAE: 1.3547  Corr: 0.3087 
2024-06-12 11:28:36:INFO:Saving checkpoint at epoch 29 to results/models/cmcm-mosi-regression.pth.
2024-06-12 11:28:51:INFO:TRAIN-(cmcm) (1/30/1)>> loss: 0.7155
2024-06-12 11:28:53:INFO:VAL-(cmcm) >>
2024-06-12 11:28:53:INFO:M: >>  Has0_acc_2: 0.6288  Has0_F1_score: 0.6220  Non0_acc_2: 0.6528  Non0_F1_score: 0.6499  Mult_acc_5: 0.3537  Mult_acc_7: 0.2707  MAE: 1.3695  Corr: 0.3004 
2024-06-12 11:29:08:INFO:TRAIN-(cmcm) (2/31/1)>> loss: 0.7164
2024-06-12 11:29:10:INFO:VAL-(cmcm) >>
2024-06-12 11:29:10:INFO:M: >>  Has0_acc_2: 0.6245  Has0_F1_score: 0.6169  Non0_acc_2: 0.6481  Non0_F1_score: 0.6449  Mult_acc_5: 0.3624  Mult_acc_7: 0.2751  MAE: 1.3756  Corr: 0.2980 
2024-06-12 11:29:25:INFO:TRAIN-(cmcm) (3/32/1)>> loss: 0.7166
2024-06-12 11:29:28:INFO:VAL-(cmcm) >>
2024-06-12 11:29:28:INFO:M: >>  Has0_acc_2: 0.6419  Has0_F1_score: 0.6431  Non0_acc_2: 0.6528  Non0_F1_score: 0.6543  Mult_acc_5: 0.3493  Mult_acc_7: 0.2707  MAE: 1.3433  Corr: 0.3144 
2024-06-12 11:29:28:INFO:Saving checkpoint at epoch 32 to results/models/cmcm-mosi-regression.pth.
2024-06-12 11:29:43:INFO:TRAIN-(cmcm) (1/33/1)>> loss: 0.7228
2024-06-12 11:29:46:INFO:VAL-(cmcm) >>
2024-06-12 11:29:46:INFO:M: >>  Has0_acc_2: 0.6463  Has0_F1_score: 0.6453  Non0_acc_2: 0.6574  Non0_F1_score: 0.6574  Mult_acc_5: 0.3406  Mult_acc_7: 0.2576  MAE: 1.3918  Corr: 0.3054 
2024-06-12 11:30:01:INFO:TRAIN-(cmcm) (2/34/1)>> loss: 0.7246
2024-06-12 11:30:03:INFO:VAL-(cmcm) >>
2024-06-12 11:30:03:INFO:M: >>  Has0_acc_2: 0.6288  Has0_F1_score: 0.6312  Non0_acc_2: 0.6389  Non0_F1_score: 0.6406  Mult_acc_5: 0.3450  Mult_acc_7: 0.2795  MAE: 1.3892  Corr: 0.2692 
2024-06-12 11:30:18:INFO:TRAIN-(cmcm) (3/35/1)>> loss: 0.7254
2024-06-12 11:30:20:INFO:VAL-(cmcm) >>
2024-06-12 11:30:20:INFO:M: >>  Has0_acc_2: 0.6638  Has0_F1_score: 0.6634  Non0_acc_2: 0.6667  Non0_F1_score: 0.6678  Mult_acc_5: 0.3362  Mult_acc_7: 0.2707  MAE: 1.3191  Corr: 0.3484 
2024-06-12 11:30:21:INFO:Saving checkpoint at epoch 35 to results/models/cmcm-mosi-regression.pth.
2024-06-12 11:30:36:INFO:TRAIN-(cmcm) (1/36/1)>> loss: 0.7317
2024-06-12 11:30:39:INFO:VAL-(cmcm) >>
2024-06-12 11:30:39:INFO:M: >>  Has0_acc_2: 0.6463  Has0_F1_score: 0.6497  Non0_acc_2: 0.6528  Non0_F1_score: 0.6546  Mult_acc_5: 0.3493  Mult_acc_7: 0.2795  MAE: 1.3202  Corr: 0.3196 
2024-06-12 11:30:53:INFO:TRAIN-(cmcm) (2/37/1)>> loss: 0.7360
2024-06-12 11:30:56:INFO:VAL-(cmcm) >>
2024-06-12 11:30:56:INFO:M: >>  Has0_acc_2: 0.6201  Has0_F1_score: 0.6235  Non0_acc_2: 0.6250  Non0_F1_score: 0.6252  Mult_acc_5: 0.3319  Mult_acc_7: 0.2620  MAE: 1.4861  Corr: 0.2734 
2024-06-12 11:31:10:INFO:TRAIN-(cmcm) (3/38/1)>> loss: 0.7348
2024-06-12 11:31:13:INFO:VAL-(cmcm) >>
2024-06-12 11:31:13:INFO:M: >>  Has0_acc_2: 0.6550  Has0_F1_score: 0.6487  Non0_acc_2: 0.6435  Non0_F1_score: 0.6451  Mult_acc_5: 0.3450  Mult_acc_7: 0.2664  MAE: 1.3739  Corr: 0.2947 
2024-06-12 11:31:28:INFO:TRAIN-(cmcm) (4/39/1)>> loss: 0.7466
2024-06-12 11:31:30:INFO:VAL-(cmcm) >>
2024-06-12 11:31:30:INFO:M: >>  Has0_acc_2: 0.6332  Has0_F1_score: 0.6357  Non0_acc_2: 0.6343  Non0_F1_score: 0.6305  Mult_acc_5: 0.3013  Mult_acc_7: 0.2489  MAE: 1.2752  Corr: 0.3785 
2024-06-12 11:31:31:INFO:Saving checkpoint at epoch 39 to results/models/cmcm-mosi-regression.pth.
2024-06-12 11:31:46:INFO:TRAIN-(cmcm) (1/40/1)>> loss: 0.7565
2024-06-12 11:31:48:INFO:VAL-(cmcm) >>
2024-06-12 11:31:48:INFO:M: >>  Has0_acc_2: 0.6245  Has0_F1_score: 0.6200  Non0_acc_2: 0.6204  Non0_F1_score: 0.6106  Mult_acc_5: 0.3144  Mult_acc_7: 0.2533  MAE: 1.4331  Corr: 0.3167 
2024-06-12 11:32:03:INFO:TRAIN-(cmcm) (2/41/1)>> loss: 0.7584
2024-06-12 11:32:06:INFO:VAL-(cmcm) >>
2024-06-12 11:32:06:INFO:M: >>  Has0_acc_2: 0.6376  Has0_F1_score: 0.6396  Non0_acc_2: 0.6296  Non0_F1_score: 0.6235  Mult_acc_5: 0.3231  Mult_acc_7: 0.2795  MAE: 1.3427  Corr: 0.3296 
2024-06-12 11:32:20:INFO:TRAIN-(cmcm) (3/42/1)>> loss: 0.7724
2024-06-12 11:32:23:INFO:VAL-(cmcm) >>
2024-06-12 11:32:23:INFO:M: >>  Has0_acc_2: 0.6201  Has0_F1_score: 0.5771  Non0_acc_2: 0.6481  Non0_F1_score: 0.6257  Mult_acc_5: 0.3013  Mult_acc_7: 0.2533  MAE: 1.4079  Corr: 0.2287 
2024-06-12 11:32:37:INFO:TRAIN-(cmcm) (4/43/1)>> loss: 0.7662
2024-06-12 11:32:40:INFO:VAL-(cmcm) >>
2024-06-12 11:32:40:INFO:M: >>  Has0_acc_2: 0.6332  Has0_F1_score: 0.6233  Non0_acc_2: 0.6481  Non0_F1_score: 0.6476  Mult_acc_5: 0.2795  Mult_acc_7: 0.2533  MAE: 1.2641  Corr: 0.3628 
2024-06-12 11:32:41:INFO:Saving checkpoint at epoch 43 to results/models/cmcm-mosi-regression.pth.
2024-06-12 11:32:56:INFO:TRAIN-(cmcm) (1/44/1)>> loss: 0.7659
2024-06-12 11:32:58:INFO:VAL-(cmcm) >>
2024-06-12 11:32:58:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.6029  Non0_acc_2: 0.6389  Non0_F1_score: 0.6284  Mult_acc_5: 0.3319  Mult_acc_7: 0.2707  MAE: 1.3813  Corr: 0.3198 
2024-06-12 11:33:13:INFO:TRAIN-(cmcm) (2/45/1)>> loss: 0.7779
2024-06-12 11:33:15:INFO:VAL-(cmcm) >>
2024-06-12 11:33:15:INFO:M: >>  Has0_acc_2: 0.6376  Has0_F1_score: 0.6297  Non0_acc_2: 0.6389  Non0_F1_score: 0.6291  Mult_acc_5: 0.2926  Mult_acc_7: 0.2314  MAE: 1.3996  Corr: 0.3263 
2024-06-12 11:33:30:INFO:TRAIN-(cmcm) (3/46/1)>> loss: 0.7661
2024-06-12 11:33:32:INFO:VAL-(cmcm) >>
2024-06-12 11:33:32:INFO:M: >>  Has0_acc_2: 0.6157  Has0_F1_score: 0.5793  Non0_acc_2: 0.5972  Non0_F1_score: 0.5602  Mult_acc_5: 0.3231  Mult_acc_7: 0.2358  MAE: 1.4839  Corr: 0.2286 
2024-06-12 11:33:47:INFO:TRAIN-(cmcm) (4/47/1)>> loss: 0.7764
2024-06-12 11:33:50:INFO:VAL-(cmcm) >>
2024-06-12 11:33:50:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.4880  Non0_acc_2: 0.5926  Non0_F1_score: 0.5124  Mult_acc_5: 0.3231  Mult_acc_7: 0.2271  MAE: 1.5704  Corr: 0.2210 
2024-06-12 11:34:04:INFO:TRAIN-(cmcm) (5/48/1)>> loss: 0.7741
2024-06-12 11:34:07:INFO:VAL-(cmcm) >>
2024-06-12 11:34:07:INFO:M: >>  Has0_acc_2: 0.6550  Has0_F1_score: 0.6573  Non0_acc_2: 0.6574  Non0_F1_score: 0.6543  Mult_acc_5: 0.3319  Mult_acc_7: 0.2664  MAE: 1.3747  Corr: 0.4038 
2024-06-12 11:34:21:INFO:TRAIN-(cmcm) (6/49/1)>> loss: 0.7763
2024-06-12 11:34:24:INFO:VAL-(cmcm) >>
2024-06-12 11:34:24:INFO:M: >>  Has0_acc_2: 0.6376  Has0_F1_score: 0.6114  Non0_acc_2: 0.6343  Non0_F1_score: 0.6192  Mult_acc_5: 0.3057  Mult_acc_7: 0.2489  MAE: 1.4608  Corr: 0.1886 
2024-06-12 11:34:38:INFO:TRAIN-(cmcm) (7/50/1)>> loss: 0.7637
2024-06-12 11:34:41:INFO:VAL-(cmcm) >>
2024-06-12 11:34:41:INFO:M: >>  Has0_acc_2: 0.6725  Has0_F1_score: 0.6756  Non0_acc_2: 0.6204  Non0_F1_score: 0.6141  Mult_acc_5: 0.2882  Mult_acc_7: 0.2751  MAE: 1.2804  Corr: 0.3911 
2024-06-12 11:34:56:INFO:TRAIN-(cmcm) (8/51/1)>> loss: 0.7759
2024-06-12 11:34:58:INFO:VAL-(cmcm) >>
2024-06-12 11:34:58:INFO:M: >>  Has0_acc_2: 0.6638  Has0_F1_score: 0.6628  Non0_acc_2: 0.6667  Non0_F1_score: 0.6662  Mult_acc_5: 0.3581  Mult_acc_7: 0.2882  MAE: 1.2743  Corr: 0.3868 
2024-06-12 11:35:13:INFO:TRAIN-(cmcm) (9/52/1)>> loss: 0.7691
2024-06-12 11:35:15:INFO:VAL-(cmcm) >>
2024-06-12 11:35:15:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.5409  Non0_acc_2: 0.5880  Non0_F1_score: 0.5265  Mult_acc_5: 0.3144  Mult_acc_7: 0.2183  MAE: 1.6909  Corr: 0.1487 
2024-06-12 11:35:30:INFO:TRAIN-(cmcm) (10/53/1)>> loss: 0.7520
2024-06-12 11:35:32:INFO:VAL-(cmcm) >>
2024-06-12 11:35:32:INFO:M: >>  Has0_acc_2: 0.6419  Has0_F1_score: 0.6347  Non0_acc_2: 0.6481  Non0_F1_score: 0.6410  Mult_acc_5: 0.3057  Mult_acc_7: 0.2271  MAE: 1.3359  Corr: 0.3293 
2024-06-12 11:35:40:INFO:TEST-(cmcm) >>
2024-06-12 11:35:40:INFO:M: >>  Has0_acc_2: 0.6035  Has0_F1_score: 0.6009  Non0_acc_2: 0.6052  Non0_F1_score: 0.6076  Mult_acc_5: 0.2566  Mult_acc_7: 0.2405  MAE: 1.3367  Corr: 0.2777 
2024-06-12 11:35:40:INFO:Results are added to results/results/mosi-regression-30.csv...
2024-06-12 11:35:40:INFO:Start running cmcm...
2024-06-12 11:35:40:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 2222}>
2024-06-12 11:35:40:INFO:Let's use the GPU 1 !
2024-06-12 11:35:40:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 11:35:41:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718163341 HTTP/1.1" 200 235
2024-06-12 11:35:41:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 11:35:41:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 11:35:42:INFO:train samples: (1284,)
2024-06-12 11:35:42:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 11:35:43:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718163343 HTTP/1.1" 200 235
2024-06-12 11:35:43:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 11:35:43:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 11:35:44:INFO:valid samples: (229,)
2024-06-12 11:35:44:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 11:35:44:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718163344 HTTP/1.1" 200 235
2024-06-12 11:35:44:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 11:35:45:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 11:35:46:INFO:test samples: (686,)
2024-06-12 11:35:46:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 11:35:46:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718163346 HTTP/1.1" 200 235
2024-06-12 11:35:46:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 11:35:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 11:35:47:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 11:35:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718163348 HTTP/1.1" 200 235
2024-06-12 11:35:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 11:35:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 11:35:48:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-12 11:35:48:WARNING:Try importing flash-attention for faster inference...
2024-06-12 11:35:48:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-12 11:35:48:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-12 11:35:48:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-12 11:35:50:INFO:trainable params: 1310284 || all params: 1838138956 || trainable%: 0.07128318540461856
2024-06-12 11:35:50:INFO:Init labels...
2024-06-12 11:35:50:INFO:Start training...
2024-06-12 11:36:04:INFO:TRAIN-(cmcm) (1/1/2)>> loss: 3.8062
2024-06-12 11:36:07:INFO:VAL-(cmcm) >>
2024-06-12 11:36:07:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.4438  Non0_acc_2: 0.5556  Non0_F1_score: 0.5132  Mult_acc_5: 0.2795  Mult_acc_7: 0.1528  MAE: 2.2285  Corr: 0.0414 
2024-06-12 11:36:08:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-12 11:36:23:INFO:TRAIN-(cmcm) (1/2/2)>> loss: 1.1498
2024-06-12 11:36:26:INFO:VAL-(cmcm) >>
2024-06-12 11:36:26:INFO:M: >>  Has0_acc_2: 0.5633  Has0_F1_score: 0.5674  Non0_acc_2: 0.5556  Non0_F1_score: 0.5580  Mult_acc_5: 0.1965  Mult_acc_7: 0.1878  MAE: 1.5846  Corr: 0.0747 
2024-06-12 11:36:27:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-12 11:36:42:INFO:TRAIN-(cmcm) (1/3/2)>> loss: 0.9695
2024-06-12 11:36:44:INFO:VAL-(cmcm) >>
2024-06-12 11:36:44:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.5086  Non0_acc_2: 0.5833  Non0_F1_score: 0.4856  Mult_acc_5: 0.3231  Mult_acc_7: 0.2402  MAE: 1.6782  Corr: 0.0534 
2024-06-12 11:36:59:INFO:TRAIN-(cmcm) (2/4/2)>> loss: 0.8945
2024-06-12 11:37:02:INFO:VAL-(cmcm) >>
2024-06-12 11:37:02:INFO:M: >>  Has0_acc_2: 0.5633  Has0_F1_score: 0.5647  Non0_acc_2: 0.5509  Non0_F1_score: 0.5522  Mult_acc_5: 0.1834  Mult_acc_7: 0.1834  MAE: 1.5401  Corr: 0.0355 
2024-06-12 11:37:02:INFO:Saving checkpoint at epoch 4 to results/models/cmcm-mosi-regression.pth.
2024-06-12 11:37:18:INFO:TRAIN-(cmcm) (1/5/2)>> loss: 0.8820
2024-06-12 11:37:20:INFO:VAL-(cmcm) >>
2024-06-12 11:37:20:INFO:M: >>  Has0_acc_2: 0.5415  Has0_F1_score: 0.5459  Non0_acc_2: 0.5370  Non0_F1_score: 0.5396  Mult_acc_5: 0.2489  Mult_acc_7: 0.1878  MAE: 1.7451  Corr: 0.0632 
2024-06-12 11:37:35:INFO:TRAIN-(cmcm) (2/6/2)>> loss: 0.8690
2024-06-12 11:37:37:INFO:VAL-(cmcm) >>
2024-06-12 11:37:37:INFO:M: >>  Has0_acc_2: 0.5502  Has0_F1_score: 0.5252  Non0_acc_2: 0.5370  Non0_F1_score: 0.5101  Mult_acc_5: 0.2664  Mult_acc_7: 0.1834  MAE: 1.7568  Corr: -0.0030 
2024-06-12 11:37:52:INFO:TRAIN-(cmcm) (3/7/2)>> loss: 0.8655
2024-06-12 11:37:55:INFO:VAL-(cmcm) >>
2024-06-12 11:37:55:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.5240  Non0_acc_2: 0.5741  Non0_F1_score: 0.5084  Mult_acc_5: 0.1965  Mult_acc_7: 0.1921  MAE: 1.6315  Corr: 0.0344 
2024-06-12 11:38:09:INFO:TRAIN-(cmcm) (4/8/2)>> loss: 0.8612
2024-06-12 11:38:12:INFO:VAL-(cmcm) >>
2024-06-12 11:38:12:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5724  Non0_acc_2: 0.5694  Non0_F1_score: 0.5684  Mult_acc_5: 0.2489  Mult_acc_7: 0.1790  MAE: 1.6298  Corr: 0.0908 
2024-06-12 11:38:26:INFO:TRAIN-(cmcm) (5/9/2)>> loss: 0.8604
2024-06-12 11:38:29:INFO:VAL-(cmcm) >>
2024-06-12 11:38:29:INFO:M: >>  Has0_acc_2: 0.4934  Has0_F1_score: 0.4556  Non0_acc_2: 0.5000  Non0_F1_score: 0.4567  Mult_acc_5: 0.1747  Mult_acc_7: 0.1485  MAE: 1.7992  Corr: 0.0677 
2024-06-12 11:38:44:INFO:TRAIN-(cmcm) (6/10/2)>> loss: 0.8618
2024-06-12 11:38:46:INFO:VAL-(cmcm) >>
2024-06-12 11:38:46:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4978  Non0_acc_2: 0.5694  Non0_F1_score: 0.4713  Mult_acc_5: 0.2271  Mult_acc_7: 0.1878  MAE: 1.5909  Corr: 0.0503 
2024-06-12 11:39:01:INFO:TRAIN-(cmcm) (7/11/2)>> loss: 0.8546
2024-06-12 11:39:03:INFO:VAL-(cmcm) >>
2024-06-12 11:39:03:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5109  Non0_acc_2: 0.5556  Non0_F1_score: 0.4913  Mult_acc_5: 0.2926  Mult_acc_7: 0.2140  MAE: 1.7739  Corr: 0.0306 
2024-06-12 11:39:18:INFO:TRAIN-(cmcm) (8/12/2)>> loss: 0.8490
2024-06-12 11:39:21:INFO:VAL-(cmcm) >>
2024-06-12 11:39:21:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.5658  Non0_acc_2: 0.5370  Non0_F1_score: 0.5382  Mult_acc_5: 0.2533  Mult_acc_7: 0.2052  MAE: 1.5110  Corr: 0.0998 
2024-06-12 11:39:21:INFO:Saving checkpoint at epoch 12 to results/models/cmcm-mosi-regression.pth.
2024-06-12 11:39:36:INFO:TRAIN-(cmcm) (1/13/2)>> loss: 0.8472
2024-06-12 11:39:39:INFO:VAL-(cmcm) >>
2024-06-12 11:39:39:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.4562  Non0_acc_2: 0.5602  Non0_F1_score: 0.4275  Mult_acc_5: 0.2882  Mult_acc_7: 0.2140  MAE: 1.7957  Corr: -0.0805 
2024-06-12 11:39:54:INFO:TRAIN-(cmcm) (2/14/2)>> loss: 0.8420
2024-06-12 11:39:56:INFO:VAL-(cmcm) >>
2024-06-12 11:39:56:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.4843  Non0_acc_2: 0.5556  Non0_F1_score: 0.4627  Mult_acc_5: 0.2489  Mult_acc_7: 0.2009  MAE: 1.6708  Corr: 0.0049 
2024-06-12 11:40:11:INFO:TRAIN-(cmcm) (3/15/2)>> loss: 0.8428
2024-06-12 11:40:13:INFO:VAL-(cmcm) >>
2024-06-12 11:40:13:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5372  Non0_acc_2: 0.5602  Non0_F1_score: 0.5380  Mult_acc_5: 0.2358  Mult_acc_7: 0.1834  MAE: 1.6180  Corr: 0.0372 
2024-06-12 11:40:28:INFO:TRAIN-(cmcm) (4/16/2)>> loss: 0.8380
2024-06-12 11:40:31:INFO:VAL-(cmcm) >>
2024-06-12 11:40:31:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5175  Non0_acc_2: 0.5648  Non0_F1_score: 0.5019  Mult_acc_5: 0.2882  Mult_acc_7: 0.2096  MAE: 1.6713  Corr: 0.0036 
2024-06-12 11:40:45:INFO:TRAIN-(cmcm) (5/17/2)>> loss: 0.8333
2024-06-12 11:40:48:INFO:VAL-(cmcm) >>
2024-06-12 11:40:48:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5282  Non0_acc_2: 0.5787  Non0_F1_score: 0.5632  Mult_acc_5: 0.3057  Mult_acc_7: 0.2358  MAE: 1.5883  Corr: 0.0896 
2024-06-12 11:41:02:INFO:TRAIN-(cmcm) (6/18/2)>> loss: 0.8278
2024-06-12 11:41:05:INFO:VAL-(cmcm) >>
2024-06-12 11:41:05:INFO:M: >>  Has0_acc_2: 0.6288  Has0_F1_score: 0.6195  Non0_acc_2: 0.4676  Non0_F1_score: 0.3838  Mult_acc_5: 0.1965  Mult_acc_7: 0.1878  MAE: 1.4453  Corr: 0.1248 
2024-06-12 11:41:06:INFO:Saving checkpoint at epoch 18 to results/models/cmcm-mosi-regression.pth.
2024-06-12 11:41:21:INFO:TRAIN-(cmcm) (1/19/2)>> loss: 0.8171
2024-06-12 11:41:23:INFO:VAL-(cmcm) >>
2024-06-12 11:41:23:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.6016  Non0_acc_2: 0.5417  Non0_F1_score: 0.5425  Mult_acc_5: 0.2620  Mult_acc_7: 0.2052  MAE: 1.5311  Corr: 0.1150 
2024-06-12 11:41:38:INFO:TRAIN-(cmcm) (2/20/2)>> loss: 0.8189
2024-06-12 11:41:41:INFO:VAL-(cmcm) >>
2024-06-12 11:41:41:INFO:M: >>  Has0_acc_2: 0.6201  Has0_F1_score: 0.6238  Non0_acc_2: 0.6111  Non0_F1_score: 0.6067  Mult_acc_5: 0.3013  Mult_acc_7: 0.2533  MAE: 1.4660  Corr: 0.2561 
2024-06-12 11:41:56:INFO:TRAIN-(cmcm) (3/21/2)>> loss: 0.8096
2024-06-12 11:41:58:INFO:VAL-(cmcm) >>
2024-06-12 11:41:58:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5042  Non0_acc_2: 0.5509  Non0_F1_score: 0.5522  Mult_acc_5: 0.2227  Mult_acc_7: 0.1834  MAE: 1.4905  Corr: 0.0952 
2024-06-12 11:42:13:INFO:TRAIN-(cmcm) (4/22/2)>> loss: 0.8004
2024-06-12 11:42:15:INFO:VAL-(cmcm) >>
2024-06-12 11:42:15:INFO:M: >>  Has0_acc_2: 0.5633  Has0_F1_score: 0.5603  Non0_acc_2: 0.5787  Non0_F1_score: 0.5723  Mult_acc_5: 0.2838  Mult_acc_7: 0.2314  MAE: 1.6621  Corr: 0.2112 
2024-06-12 11:42:30:INFO:TRAIN-(cmcm) (5/23/2)>> loss: 0.7924
2024-06-12 11:42:33:INFO:VAL-(cmcm) >>
2024-06-12 11:42:33:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.5383  Non0_acc_2: 0.6065  Non0_F1_score: 0.5549  Mult_acc_5: 0.3057  Mult_acc_7: 0.2358  MAE: 1.5713  Corr: 0.1768 
2024-06-12 11:42:47:INFO:TRAIN-(cmcm) (6/24/2)>> loss: 0.7889
2024-06-12 11:42:50:INFO:VAL-(cmcm) >>
2024-06-12 11:42:50:INFO:M: >>  Has0_acc_2: 0.6376  Has0_F1_score: 0.6411  Non0_acc_2: 0.6296  Non0_F1_score: 0.6315  Mult_acc_5: 0.3144  Mult_acc_7: 0.2533  MAE: 1.5206  Corr: 0.2563 
2024-06-12 11:43:04:INFO:TRAIN-(cmcm) (7/25/2)>> loss: 0.7786
2024-06-12 11:43:07:INFO:VAL-(cmcm) >>
2024-06-12 11:43:07:INFO:M: >>  Has0_acc_2: 0.6332  Has0_F1_score: 0.6357  Non0_acc_2: 0.6204  Non0_F1_score: 0.6223  Mult_acc_5: 0.2882  Mult_acc_7: 0.2358  MAE: 1.5044  Corr: 0.2395 
2024-06-12 11:43:21:INFO:TRAIN-(cmcm) (8/26/2)>> loss: 0.7729
2024-06-12 11:43:24:INFO:VAL-(cmcm) >>
2024-06-12 11:43:24:INFO:M: >>  Has0_acc_2: 0.6376  Has0_F1_score: 0.6407  Non0_acc_2: 0.6204  Non0_F1_score: 0.6222  Mult_acc_5: 0.3057  Mult_acc_7: 0.2533  MAE: 1.4582  Corr: 0.2544 
2024-06-12 11:43:39:INFO:TRAIN-(cmcm) (9/27/2)>> loss: 0.7674
2024-06-12 11:43:41:INFO:VAL-(cmcm) >>
2024-06-12 11:43:41:INFO:M: >>  Has0_acc_2: 0.6463  Has0_F1_score: 0.6361  Non0_acc_2: 0.6296  Non0_F1_score: 0.6253  Mult_acc_5: 0.2707  Mult_acc_7: 0.2140  MAE: 1.4726  Corr: 0.2229 
2024-06-12 11:43:56:INFO:TRAIN-(cmcm) (10/28/2)>> loss: 0.7640
2024-06-12 11:43:58:INFO:VAL-(cmcm) >>
2024-06-12 11:43:58:INFO:M: >>  Has0_acc_2: 0.6463  Has0_F1_score: 0.6481  Non0_acc_2: 0.6296  Non0_F1_score: 0.6316  Mult_acc_5: 0.2707  Mult_acc_7: 0.2183  MAE: 1.4669  Corr: 0.2342 
2024-06-12 11:44:06:INFO:TEST-(cmcm) >>
2024-06-12 11:44:06:INFO:M: >>  Has0_acc_2: 0.5714  Has0_F1_score: 0.5668  Non0_acc_2: 0.5427  Non0_F1_score: 0.4779  Mult_acc_5: 0.1837  Mult_acc_7: 0.1822  MAE: 1.4522  Corr: 0.0164 
2024-06-12 11:44:06:INFO:Results are added to results/results/mosi-regression-30.csv...
2024-06-12 11:44:06:INFO:Start running cmcm...
2024-06-12 11:44:06:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 3333}>
2024-06-12 11:44:06:INFO:Let's use the GPU 1 !
2024-06-12 11:44:06:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 11:44:06:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718163846 HTTP/1.1" 200 235
2024-06-12 11:44:07:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 11:44:07:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 11:44:08:INFO:train samples: (1284,)
2024-06-12 11:44:08:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 11:44:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718163848 HTTP/1.1" 200 235
2024-06-12 11:44:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 11:44:09:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 11:44:10:INFO:valid samples: (229,)
2024-06-12 11:44:10:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 11:44:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718163850 HTTP/1.1" 200 235
2024-06-12 11:44:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 11:44:11:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 11:44:11:INFO:test samples: (686,)
2024-06-12 11:44:11:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 11:44:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718163852 HTTP/1.1" 200 235
2024-06-12 11:44:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 11:44:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 11:44:13:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 11:44:13:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718163853 HTTP/1.1" 200 235
2024-06-12 11:44:13:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 11:44:14:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 11:44:14:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-12 11:44:14:WARNING:Try importing flash-attention for faster inference...
2024-06-12 11:44:14:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-12 11:44:14:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-12 11:44:14:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-12 11:44:15:INFO:trainable params: 1310284 || all params: 1838138956 || trainable%: 0.07128318540461856
2024-06-12 11:44:15:INFO:Init labels...
2024-06-12 11:44:15:INFO:Start training...
2024-06-12 11:44:30:INFO:TRAIN-(cmcm) (1/1/3)>> loss: 4.1900
2024-06-12 11:44:33:INFO:VAL-(cmcm) >>
2024-06-12 11:44:33:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4259  Non0_F1_score: 0.2544  Mult_acc_5: 0.2140  Mult_acc_7: 0.2140  MAE: 1.4370  Corr: nan 
2024-06-12 11:44:34:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-12 11:44:49:INFO:TRAIN-(cmcm) (1/2/3)>> loss: 2.1072
2024-06-12 11:44:51:INFO:VAL-(cmcm) >>
2024-06-12 11:44:51:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4607  Non0_acc_2: 0.5741  Non0_F1_score: 0.4420  Mult_acc_5: 0.2096  Mult_acc_7: 0.2052  MAE: 1.4366  Corr: 0.0615 
2024-06-12 11:44:52:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-12 11:45:07:INFO:TRAIN-(cmcm) (1/3/3)>> loss: 0.9779
2024-06-12 11:45:09:INFO:VAL-(cmcm) >>
2024-06-12 11:45:09:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5634  Non0_acc_2: 0.5787  Non0_F1_score: 0.5507  Mult_acc_5: 0.2402  Mult_acc_7: 0.2052  MAE: 1.5309  Corr: 0.1947 
2024-06-12 11:45:24:INFO:TRAIN-(cmcm) (2/4/3)>> loss: 0.9077
2024-06-12 11:45:27:INFO:VAL-(cmcm) >>
2024-06-12 11:45:27:INFO:M: >>  Has0_acc_2: 0.5240  Has0_F1_score: 0.5287  Non0_acc_2: 0.4815  Non0_F1_score: 0.4582  Mult_acc_5: 0.2402  Mult_acc_7: 0.2227  MAE: 1.6193  Corr: 0.0686 
2024-06-12 11:45:42:INFO:TRAIN-(cmcm) (3/5/3)>> loss: 0.8915
2024-06-12 11:45:44:INFO:VAL-(cmcm) >>
2024-06-12 11:45:44:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4767  Non0_acc_2: 0.5185  Non0_F1_score: 0.5128  Mult_acc_5: 0.2183  Mult_acc_7: 0.2183  MAE: 1.4440  Corr: -0.0108 
2024-06-12 11:45:59:INFO:TRAIN-(cmcm) (4/6/3)>> loss: 0.8743
2024-06-12 11:46:01:INFO:VAL-(cmcm) >>
2024-06-12 11:46:01:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.5240  Non0_acc_2: 0.5741  Non0_F1_score: 0.5125  Mult_acc_5: 0.2271  Mult_acc_7: 0.1878  MAE: 1.6309  Corr: 0.0232 
2024-06-12 11:46:16:INFO:TRAIN-(cmcm) (5/7/3)>> loss: 0.8741
2024-06-12 11:46:19:INFO:VAL-(cmcm) >>
2024-06-12 11:46:19:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4742  Non0_acc_2: 0.5741  Non0_F1_score: 0.4902  Mult_acc_5: 0.2271  Mult_acc_7: 0.2227  MAE: 1.5065  Corr: 0.0338 
2024-06-12 11:46:33:INFO:TRAIN-(cmcm) (6/8/3)>> loss: 0.8657
2024-06-12 11:46:36:INFO:VAL-(cmcm) >>
2024-06-12 11:46:36:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.5655  Non0_acc_2: 0.5787  Non0_F1_score: 0.5456  Mult_acc_5: 0.2969  Mult_acc_7: 0.2183  MAE: 1.5961  Corr: 0.1379 
2024-06-12 11:46:50:INFO:TRAIN-(cmcm) (7/9/3)>> loss: 0.8653
2024-06-12 11:46:53:INFO:VAL-(cmcm) >>
2024-06-12 11:46:53:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5189  Non0_acc_2: 0.5648  Non0_F1_score: 0.4934  Mult_acc_5: 0.2838  Mult_acc_7: 0.2140  MAE: 1.6507  Corr: 0.0493 
2024-06-12 11:47:08:INFO:TRAIN-(cmcm) (8/10/3)>> loss: 0.8576
2024-06-12 11:47:10:INFO:VAL-(cmcm) >>
2024-06-12 11:47:10:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.4815  Non0_acc_2: 0.5509  Non0_F1_score: 0.4881  Mult_acc_5: 0.2795  Mult_acc_7: 0.2271  MAE: 1.5162  Corr: 0.0566 
2024-06-12 11:47:25:INFO:TRAIN-(cmcm) (9/11/3)>> loss: 0.8564
2024-06-12 11:47:27:INFO:VAL-(cmcm) >>
2024-06-12 11:47:27:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.5240  Non0_acc_2: 0.5741  Non0_F1_score: 0.5164  Mult_acc_5: 0.2227  Mult_acc_7: 0.1921  MAE: 1.5293  Corr: 0.0843 
2024-06-12 11:47:42:INFO:TRAIN-(cmcm) (10/12/3)>> loss: 0.8538
2024-06-12 11:47:45:INFO:VAL-(cmcm) >>
2024-06-12 11:47:45:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.5978  Non0_acc_2: 0.5926  Non0_F1_score: 0.5830  Mult_acc_5: 0.2489  Mult_acc_7: 0.2183  MAE: 1.5385  Corr: 0.1659 
2024-06-12 11:47:52:INFO:TEST-(cmcm) >>
2024-06-12 11:47:52:INFO:M: >>  Has0_acc_2: 0.4606  Has0_F1_score: 0.3164  Non0_acc_2: 0.4360  Non0_F1_score: 0.2943  Mult_acc_5: 0.1764  Mult_acc_7: 0.1706  MAE: 1.5854  Corr: 0.0153 
2024-06-12 11:47:52:INFO:Results are added to results/results/mosi-regression-30.csv...
2024-06-12 11:47:52:INFO:Start running cmcm...
2024-06-12 11:47:52:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 4444}>
2024-06-12 11:47:52:INFO:Let's use the GPU 1 !
2024-06-12 11:47:52:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 11:47:53:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718164073 HTTP/1.1" 200 235
2024-06-12 11:47:53:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 11:47:53:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 11:47:54:INFO:train samples: (1284,)
2024-06-12 11:47:54:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 11:47:54:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718164074 HTTP/1.1" 200 235
2024-06-12 11:47:54:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 11:47:55:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 11:47:56:INFO:valid samples: (229,)
2024-06-12 11:47:56:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 11:47:56:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718164076 HTTP/1.1" 200 235
2024-06-12 11:47:56:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 11:47:57:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 11:47:57:INFO:test samples: (686,)
2024-06-12 11:47:57:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 11:47:58:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718164078 HTTP/1.1" 200 235
2024-06-12 11:47:58:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 11:47:58:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 11:47:59:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 11:47:59:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718164079 HTTP/1.1" 200 235
2024-06-12 11:47:59:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 11:48:00:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 11:48:00:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-12 11:48:00:WARNING:Try importing flash-attention for faster inference...
2024-06-12 11:48:00:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-12 11:48:00:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-12 11:48:00:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-12 11:48:02:INFO:trainable params: 1310284 || all params: 1838138956 || trainable%: 0.07128318540461856
2024-06-12 11:48:02:INFO:Init labels...
2024-06-12 11:48:02:INFO:Start training...
2024-06-12 11:48:17:INFO:TRAIN-(cmcm) (1/1/4)>> loss: 3.3800
2024-06-12 11:48:19:INFO:VAL-(cmcm) >>
2024-06-12 11:48:19:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5370  Non0_F1_score: 0.5303  Mult_acc_5: 0.1703  Mult_acc_7: 0.1703  MAE: 1.4715  Corr: -0.0008 
2024-06-12 11:48:20:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-12 11:48:35:INFO:TRAIN-(cmcm) (1/2/4)>> loss: 1.0793
2024-06-12 11:48:38:INFO:VAL-(cmcm) >>
2024-06-12 11:48:38:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.4438  Non0_acc_2: 0.5880  Non0_F1_score: 0.4703  Mult_acc_5: 0.1965  Mult_acc_7: 0.1834  MAE: 1.4720  Corr: 0.0427 
2024-06-12 11:48:52:INFO:TRAIN-(cmcm) (2/3/4)>> loss: 1.0226
2024-06-12 11:48:55:INFO:VAL-(cmcm) >>
2024-06-12 11:48:55:INFO:M: >>  Has0_acc_2: 0.5590  Has0_F1_score: 0.5462  Non0_acc_2: 0.5648  Non0_F1_score: 0.5514  Mult_acc_5: 0.2533  Mult_acc_7: 0.2140  MAE: 1.6440  Corr: 0.0247 
2024-06-12 11:49:09:INFO:TRAIN-(cmcm) (3/4/4)>> loss: 0.9731
2024-06-12 11:49:12:INFO:VAL-(cmcm) >>
2024-06-12 11:49:12:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5100  Non0_acc_2: 0.5833  Non0_F1_score: 0.5013  Mult_acc_5: 0.2227  Mult_acc_7: 0.1747  MAE: 1.5848  Corr: 0.0503 
2024-06-12 11:49:27:INFO:TRAIN-(cmcm) (4/5/4)>> loss: 1.2048
2024-06-12 11:49:29:INFO:VAL-(cmcm) >>
2024-06-12 11:49:29:INFO:M: >>  Has0_acc_2: 0.4760  Has0_F1_score: 0.4423  Non0_acc_2: 0.4861  Non0_F1_score: 0.4400  Mult_acc_5: 0.1659  Mult_acc_7: 0.1659  MAE: 1.6122  Corr: 0.0714 
2024-06-12 11:49:44:INFO:TRAIN-(cmcm) (5/6/4)>> loss: 0.9913
2024-06-12 11:49:47:INFO:VAL-(cmcm) >>
2024-06-12 11:49:47:INFO:M: >>  Has0_acc_2: 0.5590  Has0_F1_score: 0.4939  Non0_acc_2: 0.4861  Non0_F1_score: 0.4783  Mult_acc_5: 0.1790  Mult_acc_7: 0.1790  MAE: 1.5196  Corr: -0.0352 
2024-06-12 11:50:01:INFO:TRAIN-(cmcm) (6/7/4)>> loss: 0.9571
2024-06-12 11:50:04:INFO:VAL-(cmcm) >>
2024-06-12 11:50:04:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.5626  Non0_acc_2: 0.5648  Non0_F1_score: 0.5497  Mult_acc_5: 0.1878  Mult_acc_7: 0.1878  MAE: 1.5698  Corr: 0.0485 
2024-06-12 11:50:18:INFO:TRAIN-(cmcm) (7/8/4)>> loss: 0.9346
2024-06-12 11:50:21:INFO:VAL-(cmcm) >>
2024-06-12 11:50:21:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5895  Non0_acc_2: 0.5741  Non0_F1_score: 0.5734  Mult_acc_5: 0.1616  Mult_acc_7: 0.1616  MAE: 1.5641  Corr: 0.0816 
2024-06-12 11:50:36:INFO:TRAIN-(cmcm) (8/9/4)>> loss: 0.9088
2024-06-12 11:50:38:INFO:VAL-(cmcm) >>
2024-06-12 11:50:38:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5003  Non0_acc_2: 0.5463  Non0_F1_score: 0.4764  Mult_acc_5: 0.2227  Mult_acc_7: 0.1834  MAE: 1.5545  Corr: -0.0216 
2024-06-12 11:50:53:INFO:TRAIN-(cmcm) (9/10/4)>> loss: 0.8926
2024-06-12 11:50:56:INFO:VAL-(cmcm) >>
2024-06-12 11:50:56:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5934  Non0_acc_2: 0.5926  Non0_F1_score: 0.5947  Mult_acc_5: 0.2533  Mult_acc_7: 0.2140  MAE: 1.5966  Corr: 0.1672 
2024-06-12 11:51:11:INFO:TRAIN-(cmcm) (10/11/4)>> loss: 0.8861
2024-06-12 11:51:13:INFO:VAL-(cmcm) >>
2024-06-12 11:51:13:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4978  Non0_acc_2: 0.5741  Non0_F1_score: 0.4742  Mult_acc_5: 0.2882  Mult_acc_7: 0.2052  MAE: 1.6341  Corr: 0.0668 
2024-06-12 11:51:20:INFO:TEST-(cmcm) >>
2024-06-12 11:51:20:INFO:M: >>  Has0_acc_2: 0.4504  Has0_F1_score: 0.2831  Non0_acc_2: 0.4741  Non0_F1_score: 0.4613  Mult_acc_5: 0.1676  Mult_acc_7: 0.1676  MAE: 1.6427  Corr: 0.0013 
2024-06-12 11:51:21:INFO:Results are added to results/results/mosi-regression-30.csv...
2024-06-12 11:51:21:INFO:Start running cmcm...
2024-06-12 11:51:21:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 5555}>
2024-06-12 11:51:21:INFO:Let's use the GPU 1 !
2024-06-12 11:51:21:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 11:51:21:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718164281 HTTP/1.1" 200 235
2024-06-12 11:51:21:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 11:51:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 11:51:23:INFO:train samples: (1284,)
2024-06-12 11:51:23:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 11:51:23:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718164283 HTTP/1.1" 200 235
2024-06-12 11:51:23:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 11:51:24:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 11:51:24:INFO:valid samples: (229,)
2024-06-12 11:51:24:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 11:51:25:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718164285 HTTP/1.1" 200 235
2024-06-12 11:51:25:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 11:51:25:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 11:51:26:INFO:test samples: (686,)
2024-06-12 11:51:26:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 11:51:26:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718164287 HTTP/1.1" 200 235
2024-06-12 11:51:27:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 11:51:27:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 11:51:28:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 11:51:28:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718164288 HTTP/1.1" 200 235
2024-06-12 11:51:28:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 11:51:29:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 11:51:29:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-12 11:51:29:WARNING:Try importing flash-attention for faster inference...
2024-06-12 11:51:29:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-12 11:51:29:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-12 11:51:29:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-12 11:51:30:INFO:trainable params: 1310284 || all params: 1838138956 || trainable%: 0.07128318540461856
2024-06-12 11:51:30:INFO:Init labels...
2024-06-12 11:51:30:INFO:Start training...
2024-06-12 11:51:45:INFO:TRAIN-(cmcm) (1/1/5)>> loss: 2.8712
2024-06-12 11:51:48:INFO:VAL-(cmcm) >>
2024-06-12 11:51:48:INFO:M: >>  Has0_acc_2: 0.4498  Has0_F1_score: 0.4312  Non0_acc_2: 0.4537  Non0_F1_score: 0.4188  Mult_acc_5: 0.1659  Mult_acc_7: 0.1572  MAE: 1.5881  Corr: -0.0608 
2024-06-12 11:51:48:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-12 11:52:04:INFO:TRAIN-(cmcm) (1/2/5)>> loss: 1.0136
2024-06-12 11:52:06:INFO:VAL-(cmcm) >>
2024-06-12 11:52:06:INFO:M: >>  Has0_acc_2: 0.5371  Has0_F1_score: 0.5320  Non0_acc_2: 0.5463  Non0_F1_score: 0.5421  Mult_acc_5: 0.2096  Mult_acc_7: 0.1572  MAE: 1.6926  Corr: 0.0003 
2024-06-12 11:52:21:INFO:TRAIN-(cmcm) (2/3/5)>> loss: 0.9554
2024-06-12 11:52:23:INFO:VAL-(cmcm) >>
2024-06-12 11:52:23:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4830  Non0_acc_2: 0.5741  Non0_F1_score: 0.4622  Mult_acc_5: 0.2271  Mult_acc_7: 0.1921  MAE: 1.5973  Corr: 0.0671 
2024-06-12 11:52:38:INFO:TRAIN-(cmcm) (3/4/5)>> loss: 0.9043
2024-06-12 11:52:41:INFO:VAL-(cmcm) >>
2024-06-12 11:52:41:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.4674  Non0_acc_2: 0.5787  Non0_F1_score: 0.4649  Mult_acc_5: 0.1965  Mult_acc_7: 0.1659  MAE: 1.5261  Corr: 0.1076 
2024-06-12 11:52:41:INFO:Saving checkpoint at epoch 4 to results/models/cmcm-mosi-regression.pth.
2024-06-12 11:52:56:INFO:TRAIN-(cmcm) (1/5/5)>> loss: 0.8831
2024-06-12 11:52:59:INFO:VAL-(cmcm) >>
2024-06-12 11:52:59:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4723  Non0_acc_2: 0.5787  Non0_F1_score: 0.5370  Mult_acc_5: 0.2445  Mult_acc_7: 0.1965  MAE: 1.4664  Corr: 0.0923 
2024-06-12 11:53:00:INFO:Saving checkpoint at epoch 5 to results/models/cmcm-mosi-regression.pth.
2024-06-12 11:53:16:INFO:TRAIN-(cmcm) (1/6/5)>> loss: 0.8712
2024-06-12 11:53:19:INFO:VAL-(cmcm) >>
2024-06-12 11:53:19:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.5406  Non0_acc_2: 0.5648  Non0_F1_score: 0.5263  Mult_acc_5: 0.2795  Mult_acc_7: 0.2096  MAE: 1.6446  Corr: 0.0552 
2024-06-12 11:53:34:INFO:TRAIN-(cmcm) (2/7/5)>> loss: 0.8641
2024-06-12 11:53:37:INFO:VAL-(cmcm) >>
2024-06-12 11:53:37:INFO:M: >>  Has0_acc_2: 0.6201  Has0_F1_score: 0.6225  Non0_acc_2: 0.6296  Non0_F1_score: 0.6301  Mult_acc_5: 0.2926  Mult_acc_7: 0.2227  MAE: 1.4555  Corr: 0.2054 
2024-06-12 11:53:37:INFO:Saving checkpoint at epoch 7 to results/models/cmcm-mosi-regression.pth.
2024-06-12 11:53:52:INFO:TRAIN-(cmcm) (1/8/5)>> loss: 0.8573
2024-06-12 11:53:55:INFO:VAL-(cmcm) >>
2024-06-12 11:53:55:INFO:M: >>  Has0_acc_2: 0.5415  Has0_F1_score: 0.5153  Non0_acc_2: 0.5648  Non0_F1_score: 0.5392  Mult_acc_5: 0.1878  Mult_acc_7: 0.1266  MAE: 1.7057  Corr: 0.2282 
2024-06-12 11:54:10:INFO:TRAIN-(cmcm) (2/9/5)>> loss: 0.8401
2024-06-12 11:54:12:INFO:VAL-(cmcm) >>
2024-06-12 11:54:12:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.6140  Non0_acc_2: 0.6250  Non0_F1_score: 0.6261  Mult_acc_5: 0.2489  Mult_acc_7: 0.2096  MAE: 1.4603  Corr: 0.2845 
2024-06-12 11:54:27:INFO:TRAIN-(cmcm) (3/10/5)>> loss: 0.8284
2024-06-12 11:54:29:INFO:VAL-(cmcm) >>
2024-06-12 11:54:29:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.5606  Non0_acc_2: 0.5833  Non0_F1_score: 0.5406  Mult_acc_5: 0.2795  Mult_acc_7: 0.2314  MAE: 1.5114  Corr: 0.1530 
2024-06-12 11:54:44:INFO:TRAIN-(cmcm) (4/11/5)>> loss: 0.8294
2024-06-12 11:54:47:INFO:VAL-(cmcm) >>
2024-06-12 11:54:47:INFO:M: >>  Has0_acc_2: 0.6638  Has0_F1_score: 0.6670  Non0_acc_2: 0.6806  Non0_F1_score: 0.6823  Mult_acc_5: 0.2882  Mult_acc_7: 0.2402  MAE: 1.3464  Corr: 0.3994 
2024-06-12 11:54:47:INFO:Saving checkpoint at epoch 11 to results/models/cmcm-mosi-regression.pth.
2024-06-12 11:55:03:INFO:TRAIN-(cmcm) (1/12/5)>> loss: 0.8174
2024-06-12 11:55:05:INFO:VAL-(cmcm) >>
2024-06-12 11:55:05:INFO:M: >>  Has0_acc_2: 0.6507  Has0_F1_score: 0.6097  Non0_acc_2: 0.6389  Non0_F1_score: 0.5991  Mult_acc_5: 0.3057  Mult_acc_7: 0.2402  MAE: 1.4455  Corr: 0.2694 
2024-06-12 11:55:20:INFO:TRAIN-(cmcm) (2/13/5)>> loss: 0.8070
2024-06-12 11:55:22:INFO:VAL-(cmcm) >>
2024-06-12 11:55:22:INFO:M: >>  Has0_acc_2: 0.6638  Has0_F1_score: 0.6665  Non0_acc_2: 0.6806  Non0_F1_score: 0.6818  Mult_acc_5: 0.2926  Mult_acc_7: 0.2009  MAE: 1.3429  Corr: 0.4556 
2024-06-12 11:55:23:INFO:Saving checkpoint at epoch 13 to results/models/cmcm-mosi-regression.pth.
2024-06-12 11:55:38:INFO:TRAIN-(cmcm) (1/14/5)>> loss: 0.8047
2024-06-12 11:55:41:INFO:VAL-(cmcm) >>
2024-06-12 11:55:41:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.6013  Non0_acc_2: 0.6389  Non0_F1_score: 0.6329  Mult_acc_5: 0.3362  Mult_acc_7: 0.2445  MAE: 1.4835  Corr: 0.4022 
2024-06-12 11:55:56:INFO:TRAIN-(cmcm) (2/15/5)>> loss: 0.7905
2024-06-12 11:55:58:INFO:VAL-(cmcm) >>
2024-06-12 11:55:58:INFO:M: >>  Has0_acc_2: 0.6463  Has0_F1_score: 0.6140  Non0_acc_2: 0.6389  Non0_F1_score: 0.6116  Mult_acc_5: 0.3188  Mult_acc_7: 0.2402  MAE: 1.3931  Corr: 0.3232 
2024-06-12 11:56:13:INFO:TRAIN-(cmcm) (3/16/5)>> loss: 0.7841
2024-06-12 11:56:16:INFO:VAL-(cmcm) >>
2024-06-12 11:56:16:INFO:M: >>  Has0_acc_2: 0.6594  Has0_F1_score: 0.6547  Non0_acc_2: 0.6713  Non0_F1_score: 0.6715  Mult_acc_5: 0.2882  Mult_acc_7: 0.2445  MAE: 1.2538  Corr: 0.4326 
2024-06-12 11:56:16:INFO:Saving checkpoint at epoch 16 to results/models/cmcm-mosi-regression.pth.
2024-06-12 11:56:31:INFO:TRAIN-(cmcm) (1/17/5)>> loss: 0.7740
2024-06-12 11:56:34:INFO:VAL-(cmcm) >>
2024-06-12 11:56:34:INFO:M: >>  Has0_acc_2: 0.6550  Has0_F1_score: 0.6537  Non0_acc_2: 0.6667  Non0_F1_score: 0.6602  Mult_acc_5: 0.2882  Mult_acc_7: 0.2140  MAE: 1.2787  Corr: 0.4787 
2024-06-12 11:56:48:INFO:TRAIN-(cmcm) (2/18/5)>> loss: 0.7747
2024-06-12 11:56:51:INFO:VAL-(cmcm) >>
2024-06-12 11:56:51:INFO:M: >>  Has0_acc_2: 0.6419  Has0_F1_score: 0.6436  Non0_acc_2: 0.6620  Non0_F1_score: 0.6623  Mult_acc_5: 0.3319  Mult_acc_7: 0.2402  MAE: 1.3686  Corr: 0.4055 
2024-06-12 11:57:06:INFO:TRAIN-(cmcm) (3/19/5)>> loss: 0.7604
2024-06-12 11:57:08:INFO:VAL-(cmcm) >>
2024-06-12 11:57:08:INFO:M: >>  Has0_acc_2: 0.6594  Has0_F1_score: 0.6605  Non0_acc_2: 0.6481  Non0_F1_score: 0.6490  Mult_acc_5: 0.3188  Mult_acc_7: 0.2402  MAE: 1.2826  Corr: 0.4271 
2024-06-12 11:57:23:INFO:TRAIN-(cmcm) (4/20/5)>> loss: 0.7520
2024-06-12 11:57:26:INFO:VAL-(cmcm) >>
2024-06-12 11:57:26:INFO:M: >>  Has0_acc_2: 0.6594  Has0_F1_score: 0.6396  Non0_acc_2: 0.6620  Non0_F1_score: 0.6466  Mult_acc_5: 0.3493  Mult_acc_7: 0.2402  MAE: 1.2774  Corr: 0.4491 
2024-06-12 11:57:40:INFO:TRAIN-(cmcm) (5/21/5)>> loss: 0.7429
2024-06-12 11:57:43:INFO:VAL-(cmcm) >>
2024-06-12 11:57:43:INFO:M: >>  Has0_acc_2: 0.6550  Has0_F1_score: 0.6573  Non0_acc_2: 0.6713  Non0_F1_score: 0.6715  Mult_acc_5: 0.3624  Mult_acc_7: 0.2707  MAE: 1.2839  Corr: 0.4824 
2024-06-12 11:57:57:INFO:TRAIN-(cmcm) (6/22/5)>> loss: 0.7368
2024-06-12 11:58:00:INFO:VAL-(cmcm) >>
2024-06-12 11:58:00:INFO:M: >>  Has0_acc_2: 0.6507  Has0_F1_score: 0.6285  Non0_acc_2: 0.6944  Non0_F1_score: 0.6892  Mult_acc_5: 0.3668  Mult_acc_7: 0.2795  MAE: 1.2337  Corr: 0.4298 
2024-06-12 11:58:01:INFO:Saving checkpoint at epoch 22 to results/models/cmcm-mosi-regression.pth.
2024-06-12 11:58:16:INFO:TRAIN-(cmcm) (1/23/5)>> loss: 0.7293
2024-06-12 11:58:18:INFO:VAL-(cmcm) >>
2024-06-12 11:58:18:INFO:M: >>  Has0_acc_2: 0.6638  Has0_F1_score: 0.6640  Non0_acc_2: 0.6250  Non0_F1_score: 0.6252  Mult_acc_5: 0.3188  Mult_acc_7: 0.2489  MAE: 1.2437  Corr: 0.4306 
2024-06-12 11:58:33:INFO:TRAIN-(cmcm) (2/24/5)>> loss: 0.7209
2024-06-12 11:58:35:INFO:VAL-(cmcm) >>
2024-06-12 11:58:35:INFO:M: >>  Has0_acc_2: 0.6463  Has0_F1_score: 0.6494  Non0_acc_2: 0.6296  Non0_F1_score: 0.6291  Mult_acc_5: 0.3319  Mult_acc_7: 0.2489  MAE: 1.2747  Corr: 0.4386 
2024-06-12 11:58:50:INFO:TRAIN-(cmcm) (3/25/5)>> loss: 0.7147
2024-06-12 11:58:53:INFO:VAL-(cmcm) >>
2024-06-12 11:58:53:INFO:M: >>  Has0_acc_2: 0.6507  Has0_F1_score: 0.6437  Non0_acc_2: 0.6435  Non0_F1_score: 0.6433  Mult_acc_5: 0.3668  Mult_acc_7: 0.2751  MAE: 1.2538  Corr: 0.4469 
2024-06-12 11:59:08:INFO:TRAIN-(cmcm) (4/26/5)>> loss: 0.7035
2024-06-12 11:59:10:INFO:VAL-(cmcm) >>
2024-06-12 11:59:10:INFO:M: >>  Has0_acc_2: 0.6681  Has0_F1_score: 0.6661  Non0_acc_2: 0.6713  Non0_F1_score: 0.6715  Mult_acc_5: 0.3362  Mult_acc_7: 0.2533  MAE: 1.2398  Corr: 0.4477 
2024-06-12 11:59:25:INFO:TRAIN-(cmcm) (5/27/5)>> loss: 0.6969
2024-06-12 11:59:27:INFO:VAL-(cmcm) >>
2024-06-12 11:59:27:INFO:M: >>  Has0_acc_2: 0.6725  Has0_F1_score: 0.6722  Non0_acc_2: 0.6620  Non0_F1_score: 0.6638  Mult_acc_5: 0.3450  Mult_acc_7: 0.2576  MAE: 1.2267  Corr: 0.4585 
2024-06-12 11:59:28:INFO:Saving checkpoint at epoch 27 to results/models/cmcm-mosi-regression.pth.
2024-06-12 11:59:43:INFO:TRAIN-(cmcm) (1/28/5)>> loss: 0.6938
2024-06-12 11:59:45:INFO:VAL-(cmcm) >>
2024-06-12 11:59:46:INFO:M: >>  Has0_acc_2: 0.6681  Has0_F1_score: 0.6668  Non0_acc_2: 0.6667  Non0_F1_score: 0.6681  Mult_acc_5: 0.3319  Mult_acc_7: 0.2489  MAE: 1.2302  Corr: 0.4558 
2024-06-12 12:00:00:INFO:TRAIN-(cmcm) (2/29/5)>> loss: 0.6897
2024-06-12 12:00:03:INFO:VAL-(cmcm) >>
2024-06-12 12:00:03:INFO:M: >>  Has0_acc_2: 0.6769  Has0_F1_score: 0.6783  Non0_acc_2: 0.6620  Non0_F1_score: 0.6639  Mult_acc_5: 0.3362  Mult_acc_7: 0.2489  MAE: 1.2215  Corr: 0.4694 
2024-06-12 12:00:03:INFO:Saving checkpoint at epoch 29 to results/models/cmcm-mosi-regression.pth.
2024-06-12 12:00:18:INFO:TRAIN-(cmcm) (1/30/5)>> loss: 0.6901
2024-06-12 12:00:21:INFO:VAL-(cmcm) >>
2024-06-12 12:00:21:INFO:M: >>  Has0_acc_2: 0.6725  Has0_F1_score: 0.6742  Non0_acc_2: 0.6528  Non0_F1_score: 0.6546  Mult_acc_5: 0.3406  Mult_acc_7: 0.2576  MAE: 1.2267  Corr: 0.4659 
2024-06-12 12:00:36:INFO:TRAIN-(cmcm) (2/31/5)>> loss: 0.6893
2024-06-12 12:00:38:INFO:VAL-(cmcm) >>
2024-06-12 12:00:38:INFO:M: >>  Has0_acc_2: 0.6725  Has0_F1_score: 0.6742  Non0_acc_2: 0.6528  Non0_F1_score: 0.6546  Mult_acc_5: 0.3406  Mult_acc_7: 0.2576  MAE: 1.2232  Corr: 0.4664 
2024-06-12 12:00:53:INFO:TRAIN-(cmcm) (3/32/5)>> loss: 0.6906
2024-06-12 12:00:56:INFO:VAL-(cmcm) >>
2024-06-12 12:00:56:INFO:M: >>  Has0_acc_2: 0.6638  Has0_F1_score: 0.6628  Non0_acc_2: 0.6528  Non0_F1_score: 0.6545  Mult_acc_5: 0.3406  Mult_acc_7: 0.2576  MAE: 1.2398  Corr: 0.4483 
2024-06-12 12:01:11:INFO:TRAIN-(cmcm) (4/33/5)>> loss: 0.6915
2024-06-12 12:01:13:INFO:VAL-(cmcm) >>
2024-06-12 12:01:13:INFO:M: >>  Has0_acc_2: 0.6681  Has0_F1_score: 0.6700  Non0_acc_2: 0.6574  Non0_F1_score: 0.6590  Mult_acc_5: 0.3362  Mult_acc_7: 0.2533  MAE: 1.2354  Corr: 0.4607 
2024-06-12 12:01:28:INFO:TRAIN-(cmcm) (5/34/5)>> loss: 0.6947
2024-06-12 12:01:30:INFO:VAL-(cmcm) >>
2024-06-12 12:01:30:INFO:M: >>  Has0_acc_2: 0.6769  Has0_F1_score: 0.6783  Non0_acc_2: 0.6852  Non0_F1_score: 0.6867  Mult_acc_5: 0.3450  Mult_acc_7: 0.2620  MAE: 1.2276  Corr: 0.4652 
2024-06-12 12:01:45:INFO:TRAIN-(cmcm) (6/35/5)>> loss: 0.6954
2024-06-12 12:01:48:INFO:VAL-(cmcm) >>
2024-06-12 12:01:48:INFO:M: >>  Has0_acc_2: 0.6812  Has0_F1_score: 0.6803  Non0_acc_2: 0.6759  Non0_F1_score: 0.6775  Mult_acc_5: 0.3406  Mult_acc_7: 0.2576  MAE: 1.2189  Corr: 0.4654 
2024-06-12 12:01:48:INFO:Saving checkpoint at epoch 35 to results/models/cmcm-mosi-regression.pth.
2024-06-12 12:02:03:INFO:TRAIN-(cmcm) (1/36/5)>> loss: 0.6995
2024-06-12 12:02:06:INFO:VAL-(cmcm) >>
2024-06-12 12:02:06:INFO:M: >>  Has0_acc_2: 0.6725  Has0_F1_score: 0.6733  Non0_acc_2: 0.6806  Non0_F1_score: 0.6823  Mult_acc_5: 0.3537  Mult_acc_7: 0.2664  MAE: 1.2354  Corr: 0.4634 
2024-06-12 12:02:20:INFO:TRAIN-(cmcm) (2/37/5)>> loss: 0.7042
2024-06-12 12:02:23:INFO:VAL-(cmcm) >>
2024-06-12 12:02:23:INFO:M: >>  Has0_acc_2: 0.6681  Has0_F1_score: 0.6700  Non0_acc_2: 0.6620  Non0_F1_score: 0.6639  Mult_acc_5: 0.3362  Mult_acc_7: 0.2489  MAE: 1.2232  Corr: 0.4661 
2024-06-12 12:02:38:INFO:TRAIN-(cmcm) (3/38/5)>> loss: 0.7065
2024-06-12 12:02:40:INFO:VAL-(cmcm) >>
2024-06-12 12:02:40:INFO:M: >>  Has0_acc_2: 0.6550  Has0_F1_score: 0.6580  Non0_acc_2: 0.6528  Non0_F1_score: 0.6546  Mult_acc_5: 0.3144  Mult_acc_7: 0.2271  MAE: 1.2651  Corr: 0.4609 
2024-06-12 12:02:55:INFO:TRAIN-(cmcm) (4/39/5)>> loss: 0.7164
2024-06-12 12:02:57:INFO:VAL-(cmcm) >>
2024-06-12 12:02:57:INFO:M: >>  Has0_acc_2: 0.6900  Has0_F1_score: 0.6912  Non0_acc_2: 0.5972  Non0_F1_score: 0.5900  Mult_acc_5: 0.2707  Mult_acc_7: 0.1965  MAE: 1.2717  Corr: 0.4442 
2024-06-12 12:03:12:INFO:TRAIN-(cmcm) (5/40/5)>> loss: 0.7160
2024-06-12 12:03:14:INFO:VAL-(cmcm) >>
2024-06-12 12:03:14:INFO:M: >>  Has0_acc_2: 0.6419  Has0_F1_score: 0.6447  Non0_acc_2: 0.6620  Non0_F1_score: 0.6627  Mult_acc_5: 0.3188  Mult_acc_7: 0.2183  MAE: 1.3966  Corr: 0.4222 
2024-06-12 12:03:29:INFO:TRAIN-(cmcm) (6/41/5)>> loss: 0.7269
2024-06-12 12:03:32:INFO:VAL-(cmcm) >>
2024-06-12 12:03:32:INFO:M: >>  Has0_acc_2: 0.6507  Has0_F1_score: 0.6468  Non0_acc_2: 0.6481  Non0_F1_score: 0.6470  Mult_acc_5: 0.3406  Mult_acc_7: 0.2489  MAE: 1.2337  Corr: 0.4661 
2024-06-12 12:03:46:INFO:TRAIN-(cmcm) (7/42/5)>> loss: 0.7259
2024-06-12 12:03:49:INFO:VAL-(cmcm) >>
2024-06-12 12:03:49:INFO:M: >>  Has0_acc_2: 0.6725  Has0_F1_score: 0.6630  Non0_acc_2: 0.6759  Non0_F1_score: 0.6671  Mult_acc_5: 0.3057  Mult_acc_7: 0.2140  MAE: 1.2503  Corr: 0.4609 
2024-06-12 12:04:03:INFO:TRAIN-(cmcm) (8/43/5)>> loss: 0.7342
2024-06-12 12:04:06:INFO:VAL-(cmcm) >>
2024-06-12 12:04:06:INFO:M: >>  Has0_acc_2: 0.6507  Has0_F1_score: 0.6538  Non0_acc_2: 0.6250  Non0_F1_score: 0.6147  Mult_acc_5: 0.2795  Mult_acc_7: 0.1965  MAE: 1.3162  Corr: 0.4397 
2024-06-12 12:04:21:INFO:TRAIN-(cmcm) (9/44/5)>> loss: 0.7381
2024-06-12 12:04:23:INFO:VAL-(cmcm) >>
2024-06-12 12:04:23:INFO:M: >>  Has0_acc_2: 0.6463  Has0_F1_score: 0.6497  Non0_acc_2: 0.6713  Non0_F1_score: 0.6731  Mult_acc_5: 0.3188  Mult_acc_7: 0.2314  MAE: 1.3433  Corr: 0.4479 
2024-06-12 12:04:38:INFO:TRAIN-(cmcm) (10/45/5)>> loss: 0.7420
2024-06-12 12:04:40:INFO:VAL-(cmcm) >>
2024-06-12 12:04:40:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.5875  Non0_acc_2: 0.6019  Non0_F1_score: 0.5764  Mult_acc_5: 0.2314  Mult_acc_7: 0.1703  MAE: 1.5049  Corr: 0.4167 
2024-06-12 12:04:48:INFO:TEST-(cmcm) >>
2024-06-12 12:04:48:INFO:M: >>  Has0_acc_2: 0.6706  Has0_F1_score: 0.6715  Non0_acc_2: 0.6875  Non0_F1_score: 0.6880  Mult_acc_5: 0.3294  Mult_acc_7: 0.2872  MAE: 1.2416  Corr: 0.4174 
2024-06-12 12:04:48:INFO:Results are added to results/results/mosi-regression-30.csv...
2024-06-12 12:04:48:INFO:Start running cmcm...
2024-06-12 12:04:48:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 40, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-06-12 12:04:48:INFO:Let's use the GPU 1 !
2024-06-12 12:04:48:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 12:04:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718165089 HTTP/1.1" 200 235
2024-06-12 12:04:49:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 12:04:49:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 12:04:50:INFO:train samples: (1284,)
2024-06-12 12:04:50:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 12:04:50:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718165090 HTTP/1.1" 200 235
2024-06-12 12:04:51:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 12:04:51:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 12:04:52:INFO:valid samples: (229,)
2024-06-12 12:04:52:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 12:04:52:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718165092 HTTP/1.1" 200 235
2024-06-12 12:04:52:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 12:04:53:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 12:04:53:INFO:test samples: (686,)
2024-06-12 12:04:53:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 12:04:54:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718165094 HTTP/1.1" 200 235
2024-06-12 12:04:54:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 12:04:54:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 12:04:55:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 12:04:55:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718165095 HTTP/1.1" 200 235
2024-06-12 12:04:55:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 12:04:55:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 12:04:56:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-12 12:04:56:WARNING:Try importing flash-attention for faster inference...
2024-06-12 12:04:56:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-12 12:04:56:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-12 12:04:56:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-12 12:04:57:INFO:trainable params: 1310284 || all params: 1838138956 || trainable%: 0.07128318540461856
2024-06-12 12:04:57:INFO:Init labels...
2024-06-12 12:04:57:INFO:Start training...
2024-06-12 12:05:12:INFO:TRAIN-(cmcm) (1/1/1)>> loss: 3.1254
2024-06-12 12:05:14:INFO:VAL-(cmcm) >>
2024-06-12 12:05:14:INFO:M: >>  Has0_acc_2: 0.4541  Has0_F1_score: 0.4230  Non0_acc_2: 0.4398  Non0_F1_score: 0.3702  Mult_acc_5: 0.1616  Mult_acc_7: 0.1397  MAE: 2.1707  Corr: 0.0048 
2024-06-12 12:05:15:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-12 12:05:30:INFO:TRAIN-(cmcm) (1/2/1)>> loss: 1.0575
2024-06-12 12:05:32:INFO:VAL-(cmcm) >>
2024-06-12 12:05:32:INFO:M: >>  Has0_acc_2: 0.5546  Has0_F1_score: 0.5560  Non0_acc_2: 0.5602  Non0_F1_score: 0.5605  Mult_acc_5: 0.2052  Mult_acc_7: 0.1747  MAE: 1.5659  Corr: 0.1010 
2024-06-12 12:05:32:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-12 12:05:47:INFO:TRAIN-(cmcm) (1/3/1)>> loss: 0.9408
2024-06-12 12:05:50:INFO:VAL-(cmcm) >>
2024-06-12 12:05:50:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4923  Non0_acc_2: 0.5694  Non0_F1_score: 0.4768  Mult_acc_5: 0.1834  Mult_acc_7: 0.1659  MAE: 1.6014  Corr: 0.0083 
2024-06-12 12:06:05:INFO:TRAIN-(cmcm) (2/4/1)>> loss: 0.9111
2024-06-12 12:06:07:INFO:VAL-(cmcm) >>
2024-06-12 12:06:07:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.4718  Non0_acc_2: 0.5602  Non0_F1_score: 0.4479  Mult_acc_5: 0.1572  Mult_acc_7: 0.1572  MAE: 1.5975  Corr: -0.0785 
2024-06-12 12:06:22:INFO:TRAIN-(cmcm) (3/5/1)>> loss: 0.8967
2024-06-12 12:06:24:INFO:VAL-(cmcm) >>
2024-06-12 12:06:24:INFO:M: >>  Has0_acc_2: 0.5197  Has0_F1_score: 0.5224  Non0_acc_2: 0.5231  Non0_F1_score: 0.5241  Mult_acc_5: 0.2271  Mult_acc_7: 0.1921  MAE: 1.6707  Corr: 0.0379 
2024-06-12 12:06:39:INFO:TRAIN-(cmcm) (4/6/1)>> loss: 0.8821
2024-06-12 12:06:42:INFO:VAL-(cmcm) >>
2024-06-12 12:06:42:INFO:M: >>  Has0_acc_2: 0.5590  Has0_F1_score: 0.5632  Non0_acc_2: 0.5602  Non0_F1_score: 0.5626  Mult_acc_5: 0.2969  Mult_acc_7: 0.2314  MAE: 1.6440  Corr: 0.1900 
2024-06-12 12:06:56:INFO:TRAIN-(cmcm) (5/7/1)>> loss: 0.8786
2024-06-12 12:06:59:INFO:VAL-(cmcm) >>
2024-06-12 12:06:59:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5381  Non0_acc_2: 0.5556  Non0_F1_score: 0.5065  Mult_acc_5: 0.1965  Mult_acc_7: 0.1572  MAE: 1.5560  Corr: 0.0679 
2024-06-12 12:06:59:INFO:Saving checkpoint at epoch 7 to results/models/cmcm-mosi-regression.pth.
2024-06-12 12:07:14:INFO:TRAIN-(cmcm) (1/8/1)>> loss: 0.8691
2024-06-12 12:07:17:INFO:VAL-(cmcm) >>
2024-06-12 12:07:17:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.5187  Non0_acc_2: 0.5787  Non0_F1_score: 0.5158  Mult_acc_5: 0.3057  Mult_acc_7: 0.2227  MAE: 1.6520  Corr: 0.0492 
2024-06-12 12:07:32:INFO:TRAIN-(cmcm) (2/9/1)>> loss: 0.8727
2024-06-12 12:07:34:INFO:VAL-(cmcm) >>
2024-06-12 12:07:34:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5761  Non0_acc_2: 0.5694  Non0_F1_score: 0.5717  Mult_acc_5: 0.2707  Mult_acc_7: 0.1878  MAE: 1.8446  Corr: 0.1082 
2024-06-12 12:07:49:INFO:TRAIN-(cmcm) (3/10/1)>> loss: 0.8670
2024-06-12 12:07:52:INFO:VAL-(cmcm) >>
2024-06-12 12:07:52:INFO:M: >>  Has0_acc_2: 0.6201  Has0_F1_score: 0.5771  Non0_acc_2: 0.6065  Non0_F1_score: 0.5675  Mult_acc_5: 0.2533  Mult_acc_7: 0.2009  MAE: 1.5982  Corr: 0.1546 
2024-06-12 12:08:06:INFO:TRAIN-(cmcm) (4/11/1)>> loss: 0.8628
2024-06-12 12:08:09:INFO:VAL-(cmcm) >>
2024-06-12 12:08:09:INFO:M: >>  Has0_acc_2: 0.6201  Has0_F1_score: 0.6118  Non0_acc_2: 0.4815  Non0_F1_score: 0.4190  Mult_acc_5: 0.2314  Mult_acc_7: 0.2271  MAE: 1.4707  Corr: 0.1635 
2024-06-12 12:08:09:INFO:Saving checkpoint at epoch 11 to results/models/cmcm-mosi-regression.pth.
2024-06-12 12:08:24:INFO:TRAIN-(cmcm) (1/12/1)>> loss: 0.8548
2024-06-12 12:08:27:INFO:VAL-(cmcm) >>
2024-06-12 12:08:27:INFO:M: >>  Has0_acc_2: 0.6157  Has0_F1_score: 0.5954  Non0_acc_2: 0.6065  Non0_F1_score: 0.5846  Mult_acc_5: 0.2795  Mult_acc_7: 0.2009  MAE: 1.7232  Corr: 0.1456 
2024-06-12 12:08:41:INFO:TRAIN-(cmcm) (2/13/1)>> loss: 0.8447
2024-06-12 12:08:44:INFO:VAL-(cmcm) >>
2024-06-12 12:08:44:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.5703  Non0_acc_2: 0.6065  Non0_F1_score: 0.5951  Mult_acc_5: 0.3057  Mult_acc_7: 0.2183  MAE: 1.5429  Corr: 0.1567 
2024-06-12 12:08:58:INFO:TRAIN-(cmcm) (3/14/1)>> loss: 0.8425
2024-06-12 12:09:01:INFO:VAL-(cmcm) >>
2024-06-12 12:09:01:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5413  Non0_acc_2: 0.5833  Non0_F1_score: 0.5269  Mult_acc_5: 0.2969  Mult_acc_7: 0.1965  MAE: 1.7826  Corr: 0.0703 
2024-06-12 12:09:16:INFO:TRAIN-(cmcm) (4/15/1)>> loss: 0.8369
2024-06-12 12:09:18:INFO:VAL-(cmcm) >>
2024-06-12 12:09:18:INFO:M: >>  Has0_acc_2: 0.6245  Has0_F1_score: 0.5742  Non0_acc_2: 0.6019  Non0_F1_score: 0.5548  Mult_acc_5: 0.2926  Mult_acc_7: 0.2140  MAE: 1.6040  Corr: 0.1947 
2024-06-12 12:09:33:INFO:TRAIN-(cmcm) (5/16/1)>> loss: 0.8295
2024-06-12 12:09:35:INFO:VAL-(cmcm) >>
2024-06-12 12:09:35:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5875  Non0_acc_2: 0.6019  Non0_F1_score: 0.5929  Mult_acc_5: 0.2576  Mult_acc_7: 0.1965  MAE: 1.5704  Corr: 0.3070 
2024-06-12 12:09:50:INFO:TRAIN-(cmcm) (6/17/1)>> loss: 0.8276
2024-06-12 12:09:53:INFO:VAL-(cmcm) >>
2024-06-12 12:09:53:INFO:M: >>  Has0_acc_2: 0.6157  Has0_F1_score: 0.5573  Non0_acc_2: 0.5880  Non0_F1_score: 0.5814  Mult_acc_5: 0.2882  Mult_acc_7: 0.2227  MAE: 1.4232  Corr: 0.2291 
2024-06-12 12:09:53:INFO:Saving checkpoint at epoch 17 to results/models/cmcm-mosi-regression.pth.
2024-06-12 12:10:08:INFO:TRAIN-(cmcm) (1/18/1)>> loss: 0.8188
2024-06-12 12:10:10:INFO:VAL-(cmcm) >>
2024-06-12 12:10:10:INFO:M: >>  Has0_acc_2: 0.6638  Has0_F1_score: 0.6667  Non0_acc_2: 0.6852  Non0_F1_score: 0.6868  Mult_acc_5: 0.2926  Mult_acc_7: 0.2358  MAE: 1.4860  Corr: 0.3232 
2024-06-12 12:10:25:INFO:TRAIN-(cmcm) (2/19/1)>> loss: 0.8166
2024-06-12 12:10:28:INFO:VAL-(cmcm) >>
2024-06-12 12:10:28:INFO:M: >>  Has0_acc_2: 0.6507  Has0_F1_score: 0.6244  Non0_acc_2: 0.6250  Non0_F1_score: 0.6179  Mult_acc_5: 0.2838  Mult_acc_7: 0.2096  MAE: 1.4276  Corr: 0.2964 
2024-06-12 12:10:42:INFO:TRAIN-(cmcm) (3/20/1)>> loss: 0.8221
2024-06-12 12:10:45:INFO:VAL-(cmcm) >>
2024-06-12 12:10:45:INFO:M: >>  Has0_acc_2: 0.6812  Has0_F1_score: 0.6842  Non0_acc_2: 0.6898  Non0_F1_score: 0.6914  Mult_acc_5: 0.2882  Mult_acc_7: 0.2227  MAE: 1.3903  Corr: 0.3515 
2024-06-12 12:10:45:INFO:Saving checkpoint at epoch 20 to results/models/cmcm-mosi-regression.pth.
2024-06-12 12:11:00:INFO:TRAIN-(cmcm) (1/21/1)>> loss: 0.8013
2024-06-12 12:11:03:INFO:VAL-(cmcm) >>
2024-06-12 12:11:03:INFO:M: >>  Has0_acc_2: 0.6507  Has0_F1_score: 0.6446  Non0_acc_2: 0.6713  Non0_F1_score: 0.6644  Mult_acc_5: 0.2969  Mult_acc_7: 0.2271  MAE: 1.4394  Corr: 0.4093 
2024-06-12 12:11:17:INFO:TRAIN-(cmcm) (2/22/1)>> loss: 0.7972
2024-06-12 12:11:20:INFO:VAL-(cmcm) >>
2024-06-12 12:11:20:INFO:M: >>  Has0_acc_2: 0.6201  Has0_F1_score: 0.6091  Non0_acc_2: 0.6389  Non0_F1_score: 0.6291  Mult_acc_5: 0.2358  Mult_acc_7: 0.1921  MAE: 1.4951  Corr: 0.2054 
2024-06-12 12:11:34:INFO:TRAIN-(cmcm) (3/23/1)>> loss: 0.7919
2024-06-12 12:11:37:INFO:VAL-(cmcm) >>
2024-06-12 12:11:37:INFO:M: >>  Has0_acc_2: 0.6987  Has0_F1_score: 0.6984  Non0_acc_2: 0.7083  Non0_F1_score: 0.7094  Mult_acc_5: 0.3843  Mult_acc_7: 0.2751  MAE: 1.3621  Corr: 0.3904 
2024-06-12 12:11:37:INFO:Saving checkpoint at epoch 23 to results/models/cmcm-mosi-regression.pth.
2024-06-12 12:11:52:INFO:TRAIN-(cmcm) (1/24/1)>> loss: 0.7781
2024-06-12 12:11:55:INFO:VAL-(cmcm) >>
2024-06-12 12:11:55:INFO:M: >>  Has0_acc_2: 0.6856  Has0_F1_score: 0.6878  Non0_acc_2: 0.7083  Non0_F1_score: 0.7092  Mult_acc_5: 0.3013  Mult_acc_7: 0.2183  MAE: 1.3822  Corr: 0.4365 
2024-06-12 12:12:09:INFO:TRAIN-(cmcm) (2/25/1)>> loss: 0.7719
2024-06-12 12:12:12:INFO:VAL-(cmcm) >>
2024-06-12 12:12:12:INFO:M: >>  Has0_acc_2: 0.6550  Has0_F1_score: 0.6547  Non0_acc_2: 0.6620  Non0_F1_score: 0.6600  Mult_acc_5: 0.3188  Mult_acc_7: 0.2227  MAE: 1.4761  Corr: 0.3154 
2024-06-12 12:12:27:INFO:TRAIN-(cmcm) (3/26/1)>> loss: 0.7565
2024-06-12 12:12:29:INFO:VAL-(cmcm) >>
2024-06-12 12:12:29:INFO:M: >>  Has0_acc_2: 0.7118  Has0_F1_score: 0.7142  Non0_acc_2: 0.6944  Non0_F1_score: 0.6910  Mult_acc_5: 0.2664  Mult_acc_7: 0.2402  MAE: 1.2253  Corr: 0.4539 
2024-06-12 12:12:29:INFO:Saving checkpoint at epoch 26 to results/models/cmcm-mosi-regression.pth.
2024-06-12 12:12:44:INFO:TRAIN-(cmcm) (1/27/1)>> loss: 0.7555
2024-06-12 12:12:47:INFO:VAL-(cmcm) >>
2024-06-12 12:12:47:INFO:M: >>  Has0_acc_2: 0.6681  Has0_F1_score: 0.6665  Non0_acc_2: 0.6806  Non0_F1_score: 0.6765  Mult_acc_5: 0.2489  Mult_acc_7: 0.2009  MAE: 1.3921  Corr: 0.4263 
2024-06-12 12:13:02:INFO:TRAIN-(cmcm) (2/28/1)>> loss: 0.7428
2024-06-12 12:13:04:INFO:VAL-(cmcm) >>
2024-06-12 12:13:04:INFO:M: >>  Has0_acc_2: 0.6725  Has0_F1_score: 0.6753  Non0_acc_2: 0.6667  Non0_F1_score: 0.6684  Mult_acc_5: 0.2576  Mult_acc_7: 0.2140  MAE: 1.3726  Corr: 0.3442 
2024-06-12 12:13:19:INFO:TRAIN-(cmcm) (3/29/1)>> loss: 0.7400
2024-06-12 12:13:21:INFO:VAL-(cmcm) >>
2024-06-12 12:13:21:INFO:M: >>  Has0_acc_2: 0.6900  Has0_F1_score: 0.6902  Non0_acc_2: 0.6759  Non0_F1_score: 0.6755  Mult_acc_5: 0.2314  Mult_acc_7: 0.1965  MAE: 1.2586  Corr: 0.4192 
2024-06-12 12:13:36:INFO:TRAIN-(cmcm) (4/30/1)>> loss: 0.7245
2024-06-12 12:13:39:INFO:VAL-(cmcm) >>
2024-06-12 12:13:39:INFO:M: >>  Has0_acc_2: 0.6812  Has0_F1_score: 0.6681  Non0_acc_2: 0.6806  Non0_F1_score: 0.6745  Mult_acc_5: 0.2926  Mult_acc_7: 0.2227  MAE: 1.3158  Corr: 0.3880 
2024-06-12 12:13:53:INFO:TRAIN-(cmcm) (5/31/1)>> loss: 0.7116
2024-06-12 12:13:56:INFO:VAL-(cmcm) >>
2024-06-12 12:13:56:INFO:M: >>  Has0_acc_2: 0.6550  Has0_F1_score: 0.6359  Non0_acc_2: 0.6620  Non0_F1_score: 0.6466  Mult_acc_5: 0.3188  Mult_acc_7: 0.2402  MAE: 1.3975  Corr: 0.3427 
2024-06-12 12:14:10:INFO:TRAIN-(cmcm) (6/32/1)>> loss: 0.7032
2024-06-12 12:14:13:INFO:VAL-(cmcm) >>
2024-06-12 12:14:13:INFO:M: >>  Has0_acc_2: 0.6812  Has0_F1_score: 0.6720  Non0_acc_2: 0.6898  Non0_F1_score: 0.6840  Mult_acc_5: 0.3275  Mult_acc_7: 0.2576  MAE: 1.3228  Corr: 0.3872 
2024-06-12 12:14:28:INFO:TRAIN-(cmcm) (7/33/1)>> loss: 0.6949
2024-06-12 12:14:30:INFO:VAL-(cmcm) >>
2024-06-12 12:14:30:INFO:M: >>  Has0_acc_2: 0.6594  Has0_F1_score: 0.6536  Non0_acc_2: 0.6528  Non0_F1_score: 0.6473  Mult_acc_5: 0.3362  Mult_acc_7: 0.2489  MAE: 1.4280  Corr: 0.3596 
2024-06-12 12:14:45:INFO:TRAIN-(cmcm) (8/34/1)>> loss: 0.6892
2024-06-12 12:14:47:INFO:VAL-(cmcm) >>
2024-06-12 12:14:47:INFO:M: >>  Has0_acc_2: 0.6769  Has0_F1_score: 0.6787  Non0_acc_2: 0.6852  Non0_F1_score: 0.6863  Mult_acc_5: 0.3144  Mult_acc_7: 0.2489  MAE: 1.3416  Corr: 0.4104 
2024-06-12 12:15:02:INFO:TRAIN-(cmcm) (9/35/1)>> loss: 0.6792
2024-06-12 12:15:05:INFO:VAL-(cmcm) >>
2024-06-12 12:15:05:INFO:M: >>  Has0_acc_2: 0.6594  Has0_F1_score: 0.6573  Non0_acc_2: 0.6667  Non0_F1_score: 0.6667  Mult_acc_5: 0.2620  Mult_acc_7: 0.2052  MAE: 1.3379  Corr: 0.3619 
2024-06-12 12:15:19:INFO:TRAIN-(cmcm) (10/36/1)>> loss: 0.6752
2024-06-12 12:15:22:INFO:VAL-(cmcm) >>
2024-06-12 12:15:22:INFO:M: >>  Has0_acc_2: 0.6725  Has0_F1_score: 0.6701  Non0_acc_2: 0.6759  Non0_F1_score: 0.6754  Mult_acc_5: 0.3013  Mult_acc_7: 0.2358  MAE: 1.3293  Corr: 0.4007 
2024-06-12 12:15:29:INFO:TEST-(cmcm) >>
2024-06-12 12:15:29:INFO:M: >>  Has0_acc_2: 0.6399  Has0_F1_score: 0.6407  Non0_acc_2: 0.6341  Non0_F1_score: 0.6269  Mult_acc_5: 0.2755  Mult_acc_7: 0.2609  MAE: 1.3032  Corr: 0.2747 
2024-06-12 12:15:30:INFO:Results are added to results/results/mosi-regression-40.csv...
2024-06-12 12:15:30:INFO:Start running cmcm...
2024-06-12 12:15:30:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 40, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 2222}>
2024-06-12 12:15:30:INFO:Let's use the GPU 1 !
2024-06-12 12:15:30:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 12:15:30:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718165730 HTTP/1.1" 200 235
2024-06-12 12:15:30:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 12:15:31:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 12:15:31:INFO:train samples: (1284,)
2024-06-12 12:15:31:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 12:15:32:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718165732 HTTP/1.1" 200 235
2024-06-12 12:15:32:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 12:15:32:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 12:15:33:INFO:valid samples: (229,)
2024-06-12 12:15:33:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 12:15:33:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718165734 HTTP/1.1" 200 235
2024-06-12 12:15:34:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 12:15:34:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 12:15:35:INFO:test samples: (686,)
2024-06-12 12:15:35:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 12:15:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718165735 HTTP/1.1" 200 235
2024-06-12 12:15:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 12:15:36:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 12:15:36:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 12:15:36:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718165737 HTTP/1.1" 200 235
2024-06-12 12:15:37:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 12:15:37:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 12:15:37:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-12 12:15:37:WARNING:Try importing flash-attention for faster inference...
2024-06-12 12:15:37:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-12 12:15:37:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-12 12:15:37:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-12 12:15:38:INFO:trainable params: 1310284 || all params: 1838138956 || trainable%: 0.07128318540461856
2024-06-12 12:15:38:INFO:Init labels...
2024-06-12 12:15:38:INFO:Start training...
2024-06-12 12:15:53:INFO:TRAIN-(cmcm) (1/1/2)>> loss: 3.9975
2024-06-12 12:15:55:INFO:VAL-(cmcm) >>
2024-06-12 12:15:55:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5324  Non0_F1_score: 0.5131  Mult_acc_5: 0.2795  Mult_acc_7: 0.1354  MAE: 2.2861  Corr: 0.0145 
2024-06-12 12:15:56:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-12 12:16:11:INFO:TRAIN-(cmcm) (1/2/2)>> loss: 1.3212
2024-06-12 12:16:13:INFO:VAL-(cmcm) >>
2024-06-12 12:16:13:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5344  Non0_acc_2: 0.5556  Non0_F1_score: 0.5163  Mult_acc_5: 0.2445  Mult_acc_7: 0.2140  MAE: 1.7896  Corr: -0.0347 
2024-06-12 12:16:14:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-12 12:16:29:INFO:TRAIN-(cmcm) (1/3/2)>> loss: 0.9667
2024-06-12 12:16:31:INFO:VAL-(cmcm) >>
2024-06-12 12:16:31:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4630  Non0_acc_2: 0.5741  Non0_F1_score: 0.4346  Mult_acc_5: 0.1965  Mult_acc_7: 0.1965  MAE: 1.5584  Corr: 0.0150 
2024-06-12 12:16:31:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-mosi-regression.pth.
2024-06-12 12:16:47:INFO:TRAIN-(cmcm) (1/4/2)>> loss: 0.9035
2024-06-12 12:16:49:INFO:VAL-(cmcm) >>
2024-06-12 12:16:49:INFO:M: >>  Has0_acc_2: 0.4017  Has0_F1_score: 0.2303  Non0_acc_2: 0.4259  Non0_F1_score: 0.2544  Mult_acc_5: 0.1397  Mult_acc_7: 0.1266  MAE: 2.0432  Corr: -0.0601 
2024-06-12 12:17:04:INFO:TRAIN-(cmcm) (2/5/2)>> loss: 0.9009
2024-06-12 12:17:06:INFO:VAL-(cmcm) >>
2024-06-12 12:17:06:INFO:M: >>  Has0_acc_2: 0.5502  Has0_F1_score: 0.5317  Non0_acc_2: 0.5370  Non0_F1_score: 0.5169  Mult_acc_5: 0.2140  Mult_acc_7: 0.1965  MAE: 1.5807  Corr: 0.0141 
2024-06-12 12:17:21:INFO:TRAIN-(cmcm) (3/6/2)>> loss: 0.8788
2024-06-12 12:17:24:INFO:VAL-(cmcm) >>
2024-06-12 12:17:24:INFO:M: >>  Has0_acc_2: 0.5590  Has0_F1_score: 0.5625  Non0_acc_2: 0.5185  Non0_F1_score: 0.5118  Mult_acc_5: 0.1921  Mult_acc_7: 0.1572  MAE: 1.6376  Corr: 0.0492 
2024-06-12 12:17:38:INFO:TRAIN-(cmcm) (4/7/2)>> loss: 0.8722
2024-06-12 12:17:41:INFO:VAL-(cmcm) >>
2024-06-12 12:17:41:INFO:M: >>  Has0_acc_2: 0.5371  Has0_F1_score: 0.5392  Non0_acc_2: 0.5278  Non0_F1_score: 0.5284  Mult_acc_5: 0.1790  Mult_acc_7: 0.1790  MAE: 1.6817  Corr: 0.0053 
2024-06-12 12:17:56:INFO:TRAIN-(cmcm) (5/8/2)>> loss: 0.8622
2024-06-12 12:17:58:INFO:VAL-(cmcm) >>
2024-06-12 12:17:58:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.5642  Non0_acc_2: 0.5278  Non0_F1_score: 0.5297  Mult_acc_5: 0.2052  Mult_acc_7: 0.1878  MAE: 1.5320  Corr: 0.0883 
2024-06-12 12:17:59:INFO:Saving checkpoint at epoch 8 to results/models/cmcm-mosi-regression.pth.
2024-06-12 12:18:14:INFO:TRAIN-(cmcm) (1/9/2)>> loss: 0.8643
2024-06-12 12:18:16:INFO:VAL-(cmcm) >>
2024-06-12 12:18:16:INFO:M: >>  Has0_acc_2: 0.5502  Has0_F1_score: 0.5536  Non0_acc_2: 0.5602  Non0_F1_score: 0.5618  Mult_acc_5: 0.2096  Mult_acc_7: 0.1790  MAE: 1.6715  Corr: 0.0956 
2024-06-12 12:18:31:INFO:TRAIN-(cmcm) (2/10/2)>> loss: 0.8608
2024-06-12 12:18:33:INFO:VAL-(cmcm) >>
2024-06-12 12:18:33:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.5352  Non0_acc_2: 0.5833  Non0_F1_score: 0.5106  Mult_acc_5: 0.2751  Mult_acc_7: 0.2314  MAE: 1.6215  Corr: 0.0677 
2024-06-12 12:18:48:INFO:TRAIN-(cmcm) (3/11/2)>> loss: 0.8600
2024-06-12 12:18:51:INFO:VAL-(cmcm) >>
2024-06-12 12:18:51:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5247  Non0_acc_2: 0.5648  Non0_F1_score: 0.5059  Mult_acc_5: 0.2838  Mult_acc_7: 0.2052  MAE: 1.7485  Corr: 0.0209 
2024-06-12 12:19:06:INFO:TRAIN-(cmcm) (4/12/2)>> loss: 0.8469
2024-06-12 12:19:08:INFO:VAL-(cmcm) >>
2024-06-12 12:19:08:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5876  Non0_acc_2: 0.5787  Non0_F1_score: 0.5720  Mult_acc_5: 0.2533  Mult_acc_7: 0.1878  MAE: 1.5354  Corr: 0.1322 
2024-06-12 12:19:23:INFO:TRAIN-(cmcm) (5/13/2)>> loss: 0.8492
2024-06-12 12:19:25:INFO:VAL-(cmcm) >>
2024-06-12 12:19:25:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5645  Non0_acc_2: 0.5509  Non0_F1_score: 0.5362  Mult_acc_5: 0.2402  Mult_acc_7: 0.1790  MAE: 1.6839  Corr: 0.0874 
2024-06-12 12:19:40:INFO:TRAIN-(cmcm) (6/14/2)>> loss: 0.8436
2024-06-12 12:19:43:INFO:VAL-(cmcm) >>
2024-06-12 12:19:43:INFO:M: >>  Has0_acc_2: 0.6157  Has0_F1_score: 0.6054  Non0_acc_2: 0.5926  Non0_F1_score: 0.5855  Mult_acc_5: 0.3013  Mult_acc_7: 0.2227  MAE: 1.5503  Corr: 0.1778 
2024-06-12 12:19:57:INFO:TRAIN-(cmcm) (7/15/2)>> loss: 0.8388
2024-06-12 12:20:00:INFO:VAL-(cmcm) >>
2024-06-12 12:20:00:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.5613  Non0_acc_2: 0.5972  Non0_F1_score: 0.5817  Mult_acc_5: 0.2533  Mult_acc_7: 0.2140  MAE: 1.5066  Corr: 0.2843 
2024-06-12 12:20:00:INFO:Saving checkpoint at epoch 15 to results/models/cmcm-mosi-regression.pth.
2024-06-12 12:20:15:INFO:TRAIN-(cmcm) (1/16/2)>> loss: 0.8371
2024-06-12 12:20:18:INFO:VAL-(cmcm) >>
2024-06-12 12:20:18:INFO:M: >>  Has0_acc_2: 0.6245  Has0_F1_score: 0.5474  Non0_acc_2: 0.5880  Non0_F1_score: 0.5224  Mult_acc_5: 0.2969  Mult_acc_7: 0.2227  MAE: 1.5538  Corr: 0.1626 
2024-06-12 12:20:32:INFO:TRAIN-(cmcm) (2/17/2)>> loss: 0.8285
2024-06-12 12:20:35:INFO:VAL-(cmcm) >>
2024-06-12 12:20:35:INFO:M: >>  Has0_acc_2: 0.6376  Has0_F1_score: 0.6405  Non0_acc_2: 0.6204  Non0_F1_score: 0.6224  Mult_acc_5: 0.2838  Mult_acc_7: 0.2052  MAE: 1.4678  Corr: 0.2461 
2024-06-12 12:20:35:INFO:Saving checkpoint at epoch 17 to results/models/cmcm-mosi-regression.pth.
2024-06-12 12:20:50:INFO:TRAIN-(cmcm) (1/18/2)>> loss: 0.8271
2024-06-12 12:20:53:INFO:VAL-(cmcm) >>
2024-06-12 12:20:53:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5966  Non0_acc_2: 0.5185  Non0_F1_score: 0.4948  Mult_acc_5: 0.2009  Mult_acc_7: 0.1878  MAE: 1.4873  Corr: 0.1412 
2024-06-12 12:21:07:INFO:TRAIN-(cmcm) (2/19/2)>> loss: 0.8271
2024-06-12 12:21:10:INFO:VAL-(cmcm) >>
2024-06-12 12:21:10:INFO:M: >>  Has0_acc_2: 0.6157  Has0_F1_score: 0.6142  Non0_acc_2: 0.6111  Non0_F1_score: 0.6121  Mult_acc_5: 0.3013  Mult_acc_7: 0.2314  MAE: 1.4822  Corr: 0.2381 
2024-06-12 12:21:25:INFO:TRAIN-(cmcm) (3/20/2)>> loss: 0.8204
2024-06-12 12:21:27:INFO:VAL-(cmcm) >>
2024-06-12 12:21:27:INFO:M: >>  Has0_acc_2: 0.6288  Has0_F1_score: 0.6195  Non0_acc_2: 0.5972  Non0_F1_score: 0.5896  Mult_acc_5: 0.3406  Mult_acc_7: 0.2576  MAE: 1.5320  Corr: 0.2045 
2024-06-12 12:21:42:INFO:TRAIN-(cmcm) (4/21/2)>> loss: 0.8157
2024-06-12 12:21:44:INFO:VAL-(cmcm) >>
2024-06-12 12:21:44:INFO:M: >>  Has0_acc_2: 0.6288  Has0_F1_score: 0.5949  Non0_acc_2: 0.5787  Non0_F1_score: 0.5808  Mult_acc_5: 0.2620  Mult_acc_7: 0.2314  MAE: 1.3940  Corr: 0.1885 
2024-06-12 12:21:45:INFO:Saving checkpoint at epoch 21 to results/models/cmcm-mosi-regression.pth.
2024-06-12 12:22:00:INFO:TRAIN-(cmcm) (1/22/2)>> loss: 0.8030
2024-06-12 12:22:02:INFO:VAL-(cmcm) >>
2024-06-12 12:22:02:INFO:M: >>  Has0_acc_2: 0.5197  Has0_F1_score: 0.4629  Non0_acc_2: 0.5463  Non0_F1_score: 0.4916  Mult_acc_5: 0.2358  Mult_acc_7: 0.1878  MAE: 1.8328  Corr: 0.1988 
2024-06-12 12:22:17:INFO:TRAIN-(cmcm) (2/23/2)>> loss: 0.7970
2024-06-12 12:22:20:INFO:VAL-(cmcm) >>
2024-06-12 12:22:20:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.5292  Non0_acc_2: 0.5787  Non0_F1_score: 0.4982  Mult_acc_5: 0.2707  Mult_acc_7: 0.2096  MAE: 1.5817  Corr: 0.1133 
2024-06-12 12:22:34:INFO:TRAIN-(cmcm) (3/24/2)>> loss: 0.7934
2024-06-12 12:22:37:INFO:VAL-(cmcm) >>
2024-06-12 12:22:37:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.5635  Non0_acc_2: 0.5833  Non0_F1_score: 0.5492  Mult_acc_5: 0.2620  Mult_acc_7: 0.2140  MAE: 1.5887  Corr: 0.1279 
2024-06-12 12:22:51:INFO:TRAIN-(cmcm) (4/25/2)>> loss: 0.7920
2024-06-12 12:22:54:INFO:VAL-(cmcm) >>
2024-06-12 12:22:54:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.5621  Non0_acc_2: 0.5741  Non0_F1_score: 0.5640  Mult_acc_5: 0.2576  Mult_acc_7: 0.2096  MAE: 1.4852  Corr: 0.1836 
2024-06-12 12:23:09:INFO:TRAIN-(cmcm) (5/26/2)>> loss: 0.7826
2024-06-12 12:23:11:INFO:VAL-(cmcm) >>
2024-06-12 12:23:11:INFO:M: >>  Has0_acc_2: 0.6507  Has0_F1_score: 0.6518  Non0_acc_2: 0.6157  Non0_F1_score: 0.6175  Mult_acc_5: 0.3144  Mult_acc_7: 0.2402  MAE: 1.4402  Corr: 0.3023 
2024-06-12 12:23:26:INFO:TRAIN-(cmcm) (6/27/2)>> loss: 0.7702
2024-06-12 12:23:28:INFO:VAL-(cmcm) >>
2024-06-12 12:23:28:INFO:M: >>  Has0_acc_2: 0.6419  Has0_F1_score: 0.6425  Non0_acc_2: 0.6250  Non0_F1_score: 0.6264  Mult_acc_5: 0.3188  Mult_acc_7: 0.2489  MAE: 1.4577  Corr: 0.2595 
2024-06-12 12:23:43:INFO:TRAIN-(cmcm) (7/28/2)>> loss: 0.7654
2024-06-12 12:23:46:INFO:VAL-(cmcm) >>
2024-06-12 12:23:46:INFO:M: >>  Has0_acc_2: 0.6245  Has0_F1_score: 0.6245  Non0_acc_2: 0.6204  Non0_F1_score: 0.6224  Mult_acc_5: 0.3100  Mult_acc_7: 0.2358  MAE: 1.4276  Corr: 0.2739 
2024-06-12 12:24:00:INFO:TRAIN-(cmcm) (8/29/2)>> loss: 0.7569
2024-06-12 12:24:03:INFO:VAL-(cmcm) >>
2024-06-12 12:24:03:INFO:M: >>  Has0_acc_2: 0.6376  Has0_F1_score: 0.6406  Non0_acc_2: 0.6250  Non0_F1_score: 0.6252  Mult_acc_5: 0.3144  Mult_acc_7: 0.2358  MAE: 1.4499  Corr: 0.2977 
2024-06-12 12:24:17:INFO:TRAIN-(cmcm) (9/30/2)>> loss: 0.7507
2024-06-12 12:24:20:INFO:VAL-(cmcm) >>
2024-06-12 12:24:20:INFO:M: >>  Has0_acc_2: 0.6594  Has0_F1_score: 0.6610  Non0_acc_2: 0.6343  Non0_F1_score: 0.6359  Mult_acc_5: 0.2969  Mult_acc_7: 0.2358  MAE: 1.4274  Corr: 0.2853 
2024-06-12 12:24:35:INFO:TRAIN-(cmcm) (10/31/2)>> loss: 0.7410
2024-06-12 12:24:37:INFO:VAL-(cmcm) >>
2024-06-12 12:24:37:INFO:M: >>  Has0_acc_2: 0.6157  Has0_F1_score: 0.6194  Non0_acc_2: 0.5880  Non0_F1_score: 0.5892  Mult_acc_5: 0.2227  Mult_acc_7: 0.1703  MAE: 1.5410  Corr: 0.2053 
2024-06-12 12:24:45:INFO:TEST-(cmcm) >>
2024-06-12 12:24:45:INFO:M: >>  Has0_acc_2: 0.5787  Has0_F1_score: 0.5589  Non0_acc_2: 0.5671  Non0_F1_score: 0.5689  Mult_acc_5: 0.2668  Mult_acc_7: 0.2536  MAE: 1.4409  Corr: 0.1926 
2024-06-12 12:24:45:INFO:Results are added to results/results/mosi-regression-40.csv...
2024-06-12 12:24:45:INFO:Start running cmcm...
2024-06-12 12:24:45:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 40, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 3333}>
2024-06-12 12:24:45:INFO:Let's use the GPU 1 !
2024-06-12 12:24:45:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 12:24:46:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718166286 HTTP/1.1" 200 235
2024-06-12 12:24:46:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 12:24:46:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 12:24:47:INFO:train samples: (1284,)
2024-06-12 12:24:47:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 12:24:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718166288 HTTP/1.1" 200 235
2024-06-12 12:24:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 12:24:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 12:24:49:INFO:valid samples: (229,)
2024-06-12 12:24:49:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 12:24:49:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718166289 HTTP/1.1" 200 235
2024-06-12 12:24:49:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 12:24:50:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 12:24:50:INFO:test samples: (686,)
2024-06-12 12:24:50:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 12:24:51:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718166291 HTTP/1.1" 200 235
2024-06-12 12:24:51:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 12:24:51:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 12:24:52:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 12:24:52:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718166293 HTTP/1.1" 200 235
2024-06-12 12:24:52:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 12:24:53:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 12:24:53:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-12 12:24:53:WARNING:Try importing flash-attention for faster inference...
2024-06-12 12:24:53:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-12 12:24:53:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-12 12:24:53:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-12 12:24:54:INFO:trainable params: 1310284 || all params: 1838138956 || trainable%: 0.07128318540461856
2024-06-12 12:24:54:INFO:Init labels...
2024-06-12 12:24:54:INFO:Start training...
2024-06-12 12:25:09:INFO:TRAIN-(cmcm) (1/1/3)>> loss: 4.2463
2024-06-12 12:25:12:INFO:VAL-(cmcm) >>
2024-06-12 12:25:12:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4259  Non0_F1_score: 0.2544  Mult_acc_5: 0.2140  Mult_acc_7: 0.2140  MAE: 1.4370  Corr: nan 
2024-06-12 12:25:13:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-12 12:25:28:INFO:TRAIN-(cmcm) (1/2/3)>> loss: 2.5529
2024-06-12 12:25:30:INFO:VAL-(cmcm) >>
2024-06-12 12:25:30:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4630  Non0_acc_2: 0.5602  Non0_F1_score: 0.4275  Mult_acc_5: 0.1965  Mult_acc_7: 0.1965  MAE: 1.4698  Corr: -0.0174 
2024-06-12 12:25:45:INFO:TRAIN-(cmcm) (2/3/3)>> loss: 1.0161
2024-06-12 12:25:47:INFO:VAL-(cmcm) >>
2024-06-12 12:25:47:INFO:M: >>  Has0_acc_2: 0.5153  Has0_F1_score: 0.5178  Non0_acc_2: 0.5046  Non0_F1_score: 0.5056  Mult_acc_5: 0.1703  Mult_acc_7: 0.1616  MAE: 1.7104  Corr: -0.0487 
2024-06-12 12:26:02:INFO:TRAIN-(cmcm) (3/4/3)>> loss: 0.9215
2024-06-12 12:26:05:INFO:VAL-(cmcm) >>
2024-06-12 12:26:05:INFO:M: >>  Has0_acc_2: 0.5328  Has0_F1_score: 0.5175  Non0_acc_2: 0.4954  Non0_F1_score: 0.4888  Mult_acc_5: 0.1790  Mult_acc_7: 0.1310  MAE: 1.7800  Corr: -0.0137 
2024-06-12 12:26:19:INFO:TRAIN-(cmcm) (4/5/3)>> loss: 0.9022
2024-06-12 12:26:22:INFO:VAL-(cmcm) >>
2024-06-12 12:26:22:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.5109  Non0_acc_2: 0.5231  Non0_F1_score: 0.4966  Mult_acc_5: 0.2052  Mult_acc_7: 0.2052  MAE: 1.4388  Corr: 0.0117 
2024-06-12 12:26:36:INFO:TRAIN-(cmcm) (5/6/3)>> loss: 0.8805
2024-06-12 12:26:39:INFO:VAL-(cmcm) >>
2024-06-12 12:26:39:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.5109  Non0_acc_2: 0.5741  Non0_F1_score: 0.4851  Mult_acc_5: 0.2969  Mult_acc_7: 0.2140  MAE: 1.6909  Corr: 0.0252 
2024-06-12 12:26:53:INFO:TRAIN-(cmcm) (6/7/3)>> loss: 0.8748
2024-06-12 12:26:56:INFO:VAL-(cmcm) >>
2024-06-12 12:26:56:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4676  Non0_acc_2: 0.4398  Non0_F1_score: 0.4423  Mult_acc_5: 0.2445  Mult_acc_7: 0.2314  MAE: 1.4117  Corr: 0.1252 
2024-06-12 12:26:56:INFO:Saving checkpoint at epoch 7 to results/models/cmcm-mosi-regression.pth.
2024-06-12 12:27:11:INFO:TRAIN-(cmcm) (1/8/3)>> loss: 0.8676
2024-06-12 12:27:14:INFO:VAL-(cmcm) >>
2024-06-12 12:27:14:INFO:M: >>  Has0_acc_2: 0.5459  Has0_F1_score: 0.5491  Non0_acc_2: 0.5417  Non0_F1_score: 0.5413  Mult_acc_5: 0.2358  Mult_acc_7: 0.1965  MAE: 1.5883  Corr: 0.1290 
2024-06-12 12:27:29:INFO:TRAIN-(cmcm) (2/9/3)>> loss: 0.8618
2024-06-12 12:27:31:INFO:VAL-(cmcm) >>
2024-06-12 12:27:31:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.5363  Non0_acc_2: 0.5324  Non0_F1_score: 0.5277  Mult_acc_5: 0.2576  Mult_acc_7: 0.2314  MAE: 1.4088  Corr: 0.1361 
2024-06-12 12:27:32:INFO:Saving checkpoint at epoch 9 to results/models/cmcm-mosi-regression.pth.
2024-06-12 12:27:47:INFO:TRAIN-(cmcm) (1/10/3)>> loss: 0.8600
2024-06-12 12:27:49:INFO:VAL-(cmcm) >>
2024-06-12 12:27:49:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4652  Non0_acc_2: 0.5833  Non0_F1_score: 0.4469  Mult_acc_5: 0.2445  Mult_acc_7: 0.2009  MAE: 1.5095  Corr: 0.0620 
2024-06-12 12:28:04:INFO:TRAIN-(cmcm) (2/11/3)>> loss: 0.8550
2024-06-12 12:28:06:INFO:VAL-(cmcm) >>
2024-06-12 12:28:06:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.5059  Non0_acc_2: 0.5787  Non0_F1_score: 0.4827  Mult_acc_5: 0.2751  Mult_acc_7: 0.2009  MAE: 1.6691  Corr: 0.1056 
2024-06-12 12:28:21:INFO:TRAIN-(cmcm) (3/12/3)>> loss: 0.8514
2024-06-12 12:28:23:INFO:VAL-(cmcm) >>
2024-06-12 12:28:23:INFO:M: >>  Has0_acc_2: 0.6157  Has0_F1_score: 0.5222  Non0_acc_2: 0.5926  Non0_F1_score: 0.4970  Mult_acc_5: 0.2489  Mult_acc_7: 0.1878  MAE: 1.5896  Corr: 0.0888 
2024-06-12 12:28:38:INFO:TRAIN-(cmcm) (4/13/3)>> loss: 0.8494
2024-06-12 12:28:40:INFO:VAL-(cmcm) >>
2024-06-12 12:28:40:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4917  Non0_acc_2: 0.5787  Non0_F1_score: 0.4649  Mult_acc_5: 0.2969  Mult_acc_7: 0.2271  MAE: 1.6664  Corr: 0.0639 
2024-06-12 12:28:55:INFO:TRAIN-(cmcm) (5/14/3)>> loss: 0.8497
2024-06-12 12:28:58:INFO:VAL-(cmcm) >>
2024-06-12 12:28:58:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.5244  Non0_acc_2: 0.5926  Non0_F1_score: 0.5024  Mult_acc_5: 0.3100  Mult_acc_7: 0.2314  MAE: 1.6189  Corr: 0.1049 
2024-06-12 12:29:12:INFO:TRAIN-(cmcm) (6/15/3)>> loss: 0.8521
2024-06-12 12:29:15:INFO:VAL-(cmcm) >>
2024-06-12 12:29:15:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.5409  Non0_acc_2: 0.6019  Non0_F1_score: 0.5787  Mult_acc_5: 0.2751  Mult_acc_7: 0.2314  MAE: 1.5567  Corr: 0.1151 
2024-06-12 12:29:29:INFO:TRAIN-(cmcm) (7/16/3)>> loss: 0.8389
2024-06-12 12:29:32:INFO:VAL-(cmcm) >>
2024-06-12 12:29:32:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.5664  Non0_acc_2: 0.5509  Non0_F1_score: 0.5512  Mult_acc_5: 0.2358  Mult_acc_7: 0.1659  MAE: 1.6481  Corr: 0.1077 
2024-06-12 12:29:46:INFO:TRAIN-(cmcm) (8/17/3)>> loss: 0.8381
2024-06-12 12:29:49:INFO:VAL-(cmcm) >>
2024-06-12 12:29:49:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.5731  Non0_acc_2: 0.5556  Non0_F1_score: 0.5561  Mult_acc_5: 0.2183  Mult_acc_7: 0.2096  MAE: 1.4667  Corr: 0.0990 
2024-06-12 12:30:04:INFO:TRAIN-(cmcm) (9/18/3)>> loss: 0.8341
2024-06-12 12:30:06:INFO:VAL-(cmcm) >>
2024-06-12 12:30:06:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.5733  Non0_acc_2: 0.5185  Non0_F1_score: 0.5170  Mult_acc_5: 0.2489  Mult_acc_7: 0.1921  MAE: 1.5956  Corr: 0.1021 
2024-06-12 12:30:21:INFO:TRAIN-(cmcm) (10/19/3)>> loss: 0.8274
2024-06-12 12:30:23:INFO:VAL-(cmcm) >>
2024-06-12 12:30:23:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5769  Non0_acc_2: 0.5787  Non0_F1_score: 0.5699  Mult_acc_5: 0.2707  Mult_acc_7: 0.2052  MAE: 1.6110  Corr: 0.2096 
2024-06-12 12:30:31:INFO:TEST-(cmcm) >>
2024-06-12 12:30:31:INFO:M: >>  Has0_acc_2: 0.5087  Has0_F1_score: 0.4437  Non0_acc_2: 0.5534  Non0_F1_score: 0.5429  Mult_acc_5: 0.1939  Mult_acc_7: 0.1866  MAE: 1.4579  Corr: 0.1191 
2024-06-12 12:30:31:INFO:Results are added to results/results/mosi-regression-40.csv...
2024-06-12 12:30:31:INFO:Start running cmcm...
2024-06-12 12:30:31:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 40, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 4444}>
2024-06-12 12:30:31:INFO:Let's use the GPU 1 !
2024-06-12 12:30:31:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 12:30:31:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718166631 HTTP/1.1" 200 235
2024-06-12 12:30:31:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 12:30:32:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 12:30:33:INFO:train samples: (1284,)
2024-06-12 12:30:33:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 12:30:33:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718166633 HTTP/1.1" 200 235
2024-06-12 12:30:33:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 12:30:34:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 12:30:34:INFO:valid samples: (229,)
2024-06-12 12:30:34:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 12:30:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718166635 HTTP/1.1" 200 235
2024-06-12 12:30:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 12:30:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 12:30:36:INFO:test samples: (686,)
2024-06-12 12:30:36:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 12:30:36:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718166637 HTTP/1.1" 200 235
2024-06-12 12:30:37:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 12:30:37:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 12:30:38:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 12:30:38:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718166638 HTTP/1.1" 200 235
2024-06-12 12:30:38:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 12:30:38:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 12:30:38:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-12 12:30:38:WARNING:Try importing flash-attention for faster inference...
2024-06-12 12:30:38:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-12 12:30:38:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-12 12:30:39:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-12 12:30:40:INFO:trainable params: 1310284 || all params: 1838138956 || trainable%: 0.07128318540461856
2024-06-12 12:30:40:INFO:Init labels...
2024-06-12 12:30:40:INFO:Start training...
2024-06-12 12:30:55:INFO:TRAIN-(cmcm) (1/1/4)>> loss: 3.6694
2024-06-12 12:30:57:INFO:VAL-(cmcm) >>
2024-06-12 12:30:57:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.4864  Non0_acc_2: 0.4815  Non0_F1_score: 0.4832  Mult_acc_5: 0.1659  Mult_acc_7: 0.1659  MAE: 1.5139  Corr: -0.0165 
2024-06-12 12:30:57:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-12 12:31:13:INFO:TRAIN-(cmcm) (1/2/4)>> loss: 1.1561
2024-06-12 12:31:15:INFO:VAL-(cmcm) >>
2024-06-12 12:31:15:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4630  Non0_acc_2: 0.5787  Non0_F1_score: 0.4827  Mult_acc_5: 0.2140  Mult_acc_7: 0.2009  MAE: 1.4615  Corr: 0.0362 
2024-06-12 12:31:15:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-12 12:31:30:INFO:TRAIN-(cmcm) (1/3/4)>> loss: 1.0289
2024-06-12 12:31:33:INFO:VAL-(cmcm) >>
2024-06-12 12:31:33:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.4815  Non0_acc_2: 0.5602  Non0_F1_score: 0.4810  Mult_acc_5: 0.2183  Mult_acc_7: 0.1659  MAE: 1.6398  Corr: 0.0093 
2024-06-12 12:31:48:INFO:TRAIN-(cmcm) (2/4/4)>> loss: 0.9712
2024-06-12 12:31:50:INFO:VAL-(cmcm) >>
2024-06-12 12:31:50:INFO:M: >>  Has0_acc_2: 0.4148  Has0_F1_score: 0.2718  Non0_acc_2: 0.4398  Non0_F1_score: 0.2985  Mult_acc_5: 0.1397  Mult_acc_7: 0.1354  MAE: 1.7148  Corr: -0.0425 
2024-06-12 12:32:05:INFO:TRAIN-(cmcm) (3/5/4)>> loss: 3.4259
2024-06-12 12:32:08:INFO:VAL-(cmcm) >>
2024-06-12 12:32:08:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4259  Non0_F1_score: 0.2544  Mult_acc_5: 0.2140  Mult_acc_7: 0.2140  MAE: 1.4370  Corr: nan 
2024-06-12 12:32:08:INFO:Saving checkpoint at epoch 5 to results/models/cmcm-mosi-regression.pth.
2024-06-12 12:32:23:INFO:TRAIN-(cmcm) (1/6/4)>> loss: 2.1558
2024-06-12 12:32:26:INFO:VAL-(cmcm) >>
2024-06-12 12:32:26:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.5071  Non0_acc_2: 0.5602  Non0_F1_score: 0.4810  Mult_acc_5: 0.2140  Mult_acc_7: 0.1834  MAE: 1.7416  Corr: -0.0588 
2024-06-12 12:32:40:INFO:TRAIN-(cmcm) (2/7/4)>> loss: 1.0083
2024-06-12 12:32:43:INFO:VAL-(cmcm) >>
2024-06-12 12:32:43:INFO:M: >>  Has0_acc_2: 0.5153  Has0_F1_score: 0.5199  Non0_acc_2: 0.5185  Non0_F1_score: 0.5211  Mult_acc_5: 0.2445  Mult_acc_7: 0.1878  MAE: 1.7678  Corr: 0.0338 
2024-06-12 12:32:58:INFO:TRAIN-(cmcm) (3/8/4)>> loss: 0.9353
2024-06-12 12:33:00:INFO:VAL-(cmcm) >>
2024-06-12 12:33:00:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5978  Non0_acc_2: 0.5972  Non0_F1_score: 0.5994  Mult_acc_5: 0.2707  Mult_acc_7: 0.2096  MAE: 1.6711  Corr: 0.1363 
2024-06-12 12:33:15:INFO:TRAIN-(cmcm) (4/9/4)>> loss: 0.9038
2024-06-12 12:33:17:INFO:VAL-(cmcm) >>
2024-06-12 12:33:17:INFO:M: >>  Has0_acc_2: 0.5415  Has0_F1_score: 0.5407  Non0_acc_2: 0.5509  Non0_F1_score: 0.5483  Mult_acc_5: 0.2271  Mult_acc_7: 0.1921  MAE: 1.6283  Corr: 0.1010 
2024-06-12 12:33:32:INFO:TRAIN-(cmcm) (5/10/4)>> loss: 0.8832
2024-06-12 12:33:35:INFO:VAL-(cmcm) >>
2024-06-12 12:33:35:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5410  Non0_acc_2: 0.5602  Non0_F1_score: 0.5198  Mult_acc_5: 0.2664  Mult_acc_7: 0.1878  MAE: 1.8149  Corr: -0.0074 
2024-06-12 12:33:49:INFO:TRAIN-(cmcm) (6/11/4)>> loss: 0.8796
2024-06-12 12:33:52:INFO:VAL-(cmcm) >>
2024-06-12 12:33:52:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.5826  Non0_acc_2: 0.5833  Non0_F1_score: 0.5671  Mult_acc_5: 0.2838  Mult_acc_7: 0.2052  MAE: 1.6826  Corr: 0.0974 
2024-06-12 12:34:06:INFO:TRAIN-(cmcm) (7/12/4)>> loss: 0.8749
2024-06-12 12:34:09:INFO:VAL-(cmcm) >>
2024-06-12 12:34:09:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5605  Non0_acc_2: 0.5509  Non0_F1_score: 0.5410  Mult_acc_5: 0.2358  Mult_acc_7: 0.1659  MAE: 1.7494  Corr: 0.0028 
2024-06-12 12:34:24:INFO:TRAIN-(cmcm) (8/13/4)>> loss: 0.8648
2024-06-12 12:34:26:INFO:VAL-(cmcm) >>
2024-06-12 12:34:26:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5219  Non0_acc_2: 0.5648  Non0_F1_score: 0.5201  Mult_acc_5: 0.1921  Mult_acc_7: 0.1747  MAE: 1.6025  Corr: 0.0189 
2024-06-12 12:34:41:INFO:TRAIN-(cmcm) (9/14/4)>> loss: 0.8645
2024-06-12 12:34:43:INFO:VAL-(cmcm) >>
2024-06-12 12:34:43:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5100  Non0_acc_2: 0.5694  Non0_F1_score: 0.4871  Mult_acc_5: 0.2576  Mult_acc_7: 0.1878  MAE: 1.6468  Corr: 0.0072 
2024-06-12 12:34:59:INFO:TRAIN-(cmcm) (10/15/4)>> loss: 0.8653
2024-06-12 12:35:01:INFO:VAL-(cmcm) >>
2024-06-12 12:35:01:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.5284  Non0_acc_2: 0.5602  Non0_F1_score: 0.5099  Mult_acc_5: 0.2402  Mult_acc_7: 0.1790  MAE: 1.6857  Corr: -0.0124 
2024-06-12 12:35:09:INFO:TEST-(cmcm) >>
2024-06-12 12:35:09:INFO:M: >>  Has0_acc_2: 0.4475  Has0_F1_score: 0.2767  Non0_acc_2: 0.5777  Non0_F1_score: 0.4231  Mult_acc_5: 0.1545  Mult_acc_7: 0.1545  MAE: 1.4174  Corr: nan 
2024-06-12 12:35:09:INFO:Results are added to results/results/mosi-regression-40.csv...
2024-06-12 12:35:09:INFO:Start running cmcm...
2024-06-12 12:35:09:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 40, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 5555}>
2024-06-12 12:35:09:INFO:Let's use the GPU 1 !
2024-06-12 12:35:09:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 12:35:09:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718166909 HTTP/1.1" 200 235
2024-06-12 12:35:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 12:35:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 12:35:11:INFO:train samples: (1284,)
2024-06-12 12:35:11:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 12:35:11:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718166911 HTTP/1.1" 200 235
2024-06-12 12:35:11:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 12:35:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 12:35:13:INFO:valid samples: (229,)
2024-06-12 12:35:13:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 12:35:13:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718166913 HTTP/1.1" 200 235
2024-06-12 12:35:13:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 12:35:13:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 12:35:14:INFO:test samples: (686,)
2024-06-12 12:35:14:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 12:35:14:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718166915 HTTP/1.1" 200 235
2024-06-12 12:35:15:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 12:35:15:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 12:35:16:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 12:35:16:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718166916 HTTP/1.1" 200 235
2024-06-12 12:35:16:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 12:35:17:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 12:35:17:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-12 12:35:17:WARNING:Try importing flash-attention for faster inference...
2024-06-12 12:35:17:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-12 12:35:17:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-12 12:35:17:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-12 12:35:18:INFO:trainable params: 1310284 || all params: 1838138956 || trainable%: 0.07128318540461856
2024-06-12 12:35:18:INFO:Init labels...
2024-06-12 12:35:18:INFO:Start training...
2024-06-12 12:35:33:INFO:TRAIN-(cmcm) (1/1/5)>> loss: 3.0734
2024-06-12 12:35:35:INFO:VAL-(cmcm) >>
2024-06-12 12:35:35:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.4584  Non0_acc_2: 0.5602  Non0_F1_score: 0.4710  Mult_acc_5: 0.2445  Mult_acc_7: 0.1965  MAE: 1.5119  Corr: 0.0466 
2024-06-12 12:35:36:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-12 12:35:51:INFO:TRAIN-(cmcm) (1/2/5)>> loss: 1.0206
2024-06-12 12:35:54:INFO:VAL-(cmcm) >>
2024-06-12 12:35:54:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.5590  Non0_acc_2: 0.5648  Non0_F1_score: 0.5459  Mult_acc_5: 0.1747  Mult_acc_7: 0.1747  MAE: 1.5397  Corr: 0.0290 
2024-06-12 12:36:08:INFO:TRAIN-(cmcm) (2/3/5)>> loss: 0.9578
2024-06-12 12:36:11:INFO:VAL-(cmcm) >>
2024-06-12 12:36:11:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5100  Non0_acc_2: 0.5648  Non0_F1_score: 0.4841  Mult_acc_5: 0.2358  Mult_acc_7: 0.1834  MAE: 1.6455  Corr: 0.0008 
2024-06-12 12:36:26:INFO:TRAIN-(cmcm) (3/4/5)>> loss: 0.9271
2024-06-12 12:36:28:INFO:VAL-(cmcm) >>
2024-06-12 12:36:28:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4577  Non0_acc_2: 0.5833  Non0_F1_score: 0.4393  Mult_acc_5: 0.1703  Mult_acc_7: 0.1659  MAE: 1.5285  Corr: 0.1025 
2024-06-12 12:36:43:INFO:TRAIN-(cmcm) (4/5/5)>> loss: 0.8984
2024-06-12 12:36:46:INFO:VAL-(cmcm) >>
2024-06-12 12:36:46:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4556  Non0_acc_2: 0.5648  Non0_F1_score: 0.4223  Mult_acc_5: 0.1572  Mult_acc_7: 0.1572  MAE: 1.5231  Corr: 0.0068 
2024-06-12 12:37:00:INFO:TRAIN-(cmcm) (5/6/5)>> loss: 0.8788
2024-06-12 12:37:03:INFO:VAL-(cmcm) >>
2024-06-12 12:37:03:INFO:M: >>  Has0_acc_2: 0.6201  Has0_F1_score: 0.5709  Non0_acc_2: 0.6111  Non0_F1_score: 0.5585  Mult_acc_5: 0.3275  Mult_acc_7: 0.2445  MAE: 1.5555  Corr: 0.1281 
2024-06-12 12:37:18:INFO:TRAIN-(cmcm) (6/7/5)>> loss: 0.8677
2024-06-12 12:37:20:INFO:VAL-(cmcm) >>
2024-06-12 12:37:20:INFO:M: >>  Has0_acc_2: 0.6550  Has0_F1_score: 0.6408  Non0_acc_2: 0.6574  Non0_F1_score: 0.6440  Mult_acc_5: 0.2795  Mult_acc_7: 0.2620  MAE: 1.3935  Corr: 0.2158 
2024-06-12 12:37:21:INFO:Saving checkpoint at epoch 7 to results/models/cmcm-mosi-regression.pth.
2024-06-12 12:37:36:INFO:TRAIN-(cmcm) (1/8/5)>> loss: 0.8623
2024-06-12 12:37:38:INFO:VAL-(cmcm) >>
2024-06-12 12:37:38:INFO:M: >>  Has0_acc_2: 0.5415  Has0_F1_score: 0.4979  Non0_acc_2: 0.5648  Non0_F1_score: 0.5216  Mult_acc_5: 0.2576  Mult_acc_7: 0.1878  MAE: 1.7477  Corr: 0.2693 
2024-06-12 12:37:53:INFO:TRAIN-(cmcm) (2/9/5)>> loss: 0.8605
2024-06-12 12:37:56:INFO:VAL-(cmcm) >>
2024-06-12 12:37:56:INFO:M: >>  Has0_acc_2: 0.6769  Has0_F1_score: 0.6800  Non0_acc_2: 0.6944  Non0_F1_score: 0.6961  Mult_acc_5: 0.2882  Mult_acc_7: 0.2314  MAE: 1.3577  Corr: 0.3624 
2024-06-12 12:37:56:INFO:Saving checkpoint at epoch 9 to results/models/cmcm-mosi-regression.pth.
2024-06-12 12:38:11:INFO:TRAIN-(cmcm) (1/10/5)>> loss: 0.8423
2024-06-12 12:38:14:INFO:VAL-(cmcm) >>
2024-06-12 12:38:14:INFO:M: >>  Has0_acc_2: 0.6376  Has0_F1_score: 0.5906  Non0_acc_2: 0.6296  Non0_F1_score: 0.5795  Mult_acc_5: 0.2795  Mult_acc_7: 0.2009  MAE: 1.5110  Corr: 0.2379 
2024-06-12 12:38:29:INFO:TRAIN-(cmcm) (2/11/5)>> loss: 0.8418
2024-06-12 12:38:31:INFO:VAL-(cmcm) >>
2024-06-12 12:38:31:INFO:M: >>  Has0_acc_2: 0.6769  Has0_F1_score: 0.6763  Non0_acc_2: 0.6806  Non0_F1_score: 0.6793  Mult_acc_5: 0.2620  Mult_acc_7: 0.2227  MAE: 1.3612  Corr: 0.3478 
2024-06-12 12:38:46:INFO:TRAIN-(cmcm) (3/12/5)>> loss: 0.8314
2024-06-12 12:38:48:INFO:VAL-(cmcm) >>
2024-06-12 12:38:48:INFO:M: >>  Has0_acc_2: 0.6725  Has0_F1_score: 0.6590  Non0_acc_2: 0.6759  Non0_F1_score: 0.6603  Mult_acc_5: 0.3013  Mult_acc_7: 0.2314  MAE: 1.3743  Corr: 0.3167 
2024-06-12 12:39:03:INFO:TRAIN-(cmcm) (4/13/5)>> loss: 0.8255
2024-06-12 12:39:06:INFO:VAL-(cmcm) >>
2024-06-12 12:39:06:INFO:M: >>  Has0_acc_2: 0.6900  Has0_F1_score: 0.6758  Non0_acc_2: 0.6898  Non0_F1_score: 0.6830  Mult_acc_5: 0.3406  Mult_acc_7: 0.2445  MAE: 1.3817  Corr: 0.3663 
2024-06-12 12:39:21:INFO:TRAIN-(cmcm) (5/14/5)>> loss: 0.8217
2024-06-12 12:39:23:INFO:VAL-(cmcm) >>
2024-06-12 12:39:23:INFO:M: >>  Has0_acc_2: 0.6594  Has0_F1_score: 0.6570  Non0_acc_2: 0.6898  Non0_F1_score: 0.6859  Mult_acc_5: 0.3493  Mult_acc_7: 0.2445  MAE: 1.3979  Corr: 0.4620 
2024-06-12 12:39:38:INFO:TRAIN-(cmcm) (6/15/5)>> loss: 0.8103
2024-06-12 12:39:40:INFO:VAL-(cmcm) >>
2024-06-12 12:39:40:INFO:M: >>  Has0_acc_2: 0.6900  Has0_F1_score: 0.6572  Non0_acc_2: 0.6759  Non0_F1_score: 0.6427  Mult_acc_5: 0.2707  Mult_acc_7: 0.2140  MAE: 1.3599  Corr: 0.3469 
2024-06-12 12:39:55:INFO:TRAIN-(cmcm) (7/16/5)>> loss: 0.8055
2024-06-12 12:39:58:INFO:VAL-(cmcm) >>
2024-06-12 12:39:58:INFO:M: >>  Has0_acc_2: 0.7205  Has0_F1_score: 0.7210  Non0_acc_2: 0.7407  Non0_F1_score: 0.7404  Mult_acc_5: 0.3231  Mult_acc_7: 0.2489  MAE: 1.2320  Corr: 0.4820 
2024-06-12 12:39:58:INFO:Saving checkpoint at epoch 16 to results/models/cmcm-mosi-regression.pth.
2024-06-12 12:40:13:INFO:TRAIN-(cmcm) (1/17/5)>> loss: 0.7929
2024-06-12 12:40:16:INFO:VAL-(cmcm) >>
2024-06-12 12:40:16:INFO:M: >>  Has0_acc_2: 0.6987  Has0_F1_score: 0.6999  Non0_acc_2: 0.7130  Non0_F1_score: 0.7133  Mult_acc_5: 0.3319  Mult_acc_7: 0.2533  MAE: 1.2215  Corr: 0.4733 
2024-06-12 12:40:16:INFO:Saving checkpoint at epoch 17 to results/models/cmcm-mosi-regression.pth.
2024-06-12 12:40:31:INFO:TRAIN-(cmcm) (1/18/5)>> loss: 0.7851
2024-06-12 12:40:34:INFO:VAL-(cmcm) >>
2024-06-12 12:40:34:INFO:M: >>  Has0_acc_2: 0.7074  Has0_F1_score: 0.7089  Non0_acc_2: 0.7269  Non0_F1_score: 0.7270  Mult_acc_5: 0.3537  Mult_acc_7: 0.2533  MAE: 1.2477  Corr: 0.5029 
2024-06-12 12:40:49:INFO:TRAIN-(cmcm) (2/19/5)>> loss: 0.7815
2024-06-12 12:40:51:INFO:VAL-(cmcm) >>
2024-06-12 12:40:51:INFO:M: >>  Has0_acc_2: 0.7074  Has0_F1_score: 0.6880  Non0_acc_2: 0.7176  Non0_F1_score: 0.7019  Mult_acc_5: 0.3144  Mult_acc_7: 0.2620  MAE: 1.1826  Corr: 0.4972 
2024-06-12 12:40:52:INFO:Saving checkpoint at epoch 19 to results/models/cmcm-mosi-regression.pth.
2024-06-12 12:41:07:INFO:TRAIN-(cmcm) (1/20/5)>> loss: 0.7749
2024-06-12 12:41:10:INFO:VAL-(cmcm) >>
2024-06-12 12:41:10:INFO:M: >>  Has0_acc_2: 0.7031  Has0_F1_score: 0.6971  Non0_acc_2: 0.7176  Non0_F1_score: 0.7114  Mult_acc_5: 0.3057  Mult_acc_7: 0.2402  MAE: 1.2031  Corr: 0.4575 
2024-06-12 12:41:24:INFO:TRAIN-(cmcm) (2/21/5)>> loss: 0.7658
2024-06-12 12:41:27:INFO:VAL-(cmcm) >>
2024-06-12 12:41:27:INFO:M: >>  Has0_acc_2: 0.7118  Has0_F1_score: 0.7142  Non0_acc_2: 0.7269  Non0_F1_score: 0.7281  Mult_acc_5: 0.3843  Mult_acc_7: 0.2707  MAE: 1.2031  Corr: 0.5274 
2024-06-12 12:41:42:INFO:TRAIN-(cmcm) (3/22/5)>> loss: 0.7569
2024-06-12 12:41:44:INFO:VAL-(cmcm) >>
2024-06-12 12:41:44:INFO:M: >>  Has0_acc_2: 0.7162  Has0_F1_score: 0.7032  Non0_acc_2: 0.7037  Non0_F1_score: 0.6957  Mult_acc_5: 0.3100  Mult_acc_7: 0.2489  MAE: 1.2263  Corr: 0.4584 
2024-06-12 12:41:59:INFO:TRAIN-(cmcm) (4/23/5)>> loss: 0.7501
2024-06-12 12:42:01:INFO:VAL-(cmcm) >>
2024-06-12 12:42:01:INFO:M: >>  Has0_acc_2: 0.6900  Has0_F1_score: 0.6891  Non0_acc_2: 0.6250  Non0_F1_score: 0.6228  Mult_acc_5: 0.3319  Mult_acc_7: 0.2576  MAE: 1.2114  Corr: 0.4586 
2024-06-12 12:42:16:INFO:TRAIN-(cmcm) (5/24/5)>> loss: 0.7450
2024-06-12 12:42:19:INFO:VAL-(cmcm) >>
2024-06-12 12:42:19:INFO:M: >>  Has0_acc_2: 0.6856  Has0_F1_score: 0.6886  Non0_acc_2: 0.6944  Non0_F1_score: 0.6955  Mult_acc_5: 0.2926  Mult_acc_7: 0.2096  MAE: 1.2516  Corr: 0.4944 
2024-06-12 12:42:33:INFO:TRAIN-(cmcm) (6/25/5)>> loss: 0.7334
2024-06-12 12:42:36:INFO:VAL-(cmcm) >>
2024-06-12 12:42:36:INFO:M: >>  Has0_acc_2: 0.6812  Has0_F1_score: 0.6820  Non0_acc_2: 0.6852  Non0_F1_score: 0.6856  Mult_acc_5: 0.3144  Mult_acc_7: 0.2358  MAE: 1.2739  Corr: 0.4481 
2024-06-12 12:42:51:INFO:TRAIN-(cmcm) (7/26/5)>> loss: 0.7290
2024-06-12 12:42:53:INFO:VAL-(cmcm) >>
2024-06-12 12:42:53:INFO:M: >>  Has0_acc_2: 0.7118  Has0_F1_score: 0.7131  Non0_acc_2: 0.7176  Non0_F1_score: 0.7189  Mult_acc_5: 0.3581  Mult_acc_7: 0.2707  MAE: 1.2244  Corr: 0.4997 
2024-06-12 12:43:08:INFO:TRAIN-(cmcm) (8/27/5)>> loss: 0.7215
2024-06-12 12:43:10:INFO:VAL-(cmcm) >>
2024-06-12 12:43:10:INFO:M: >>  Has0_acc_2: 0.7074  Has0_F1_score: 0.7093  Non0_acc_2: 0.6944  Non0_F1_score: 0.6960  Mult_acc_5: 0.3275  Mult_acc_7: 0.2533  MAE: 1.1865  Corr: 0.5084 
2024-06-12 12:43:25:INFO:TRAIN-(cmcm) (9/28/5)>> loss: 0.7212
2024-06-12 12:43:28:INFO:VAL-(cmcm) >>
2024-06-12 12:43:28:INFO:M: >>  Has0_acc_2: 0.7162  Has0_F1_score: 0.7126  Non0_acc_2: 0.6991  Non0_F1_score: 0.7006  Mult_acc_5: 0.3930  Mult_acc_7: 0.2969  MAE: 1.1228  Corr: 0.5338 
2024-06-12 12:43:28:INFO:Saving checkpoint at epoch 28 to results/models/cmcm-mosi-regression.pth.
2024-06-12 12:43:43:INFO:TRAIN-(cmcm) (1/29/5)>> loss: 0.7014
2024-06-12 12:43:46:INFO:VAL-(cmcm) >>
2024-06-12 12:43:46:INFO:M: >>  Has0_acc_2: 0.7074  Has0_F1_score: 0.7089  Non0_acc_2: 0.7037  Non0_F1_score: 0.7049  Mult_acc_5: 0.3493  Mult_acc_7: 0.2533  MAE: 1.1857  Corr: 0.5058 
2024-06-12 12:44:01:INFO:TRAIN-(cmcm) (2/30/5)>> loss: 0.6980
2024-06-12 12:44:03:INFO:VAL-(cmcm) >>
2024-06-12 12:44:03:INFO:M: >>  Has0_acc_2: 0.6943  Has0_F1_score: 0.6964  Non0_acc_2: 0.7176  Non0_F1_score: 0.7191  Mult_acc_5: 0.3188  Mult_acc_7: 0.2183  MAE: 1.2119  Corr: 0.5128 
2024-06-12 12:44:18:INFO:TRAIN-(cmcm) (3/31/5)>> loss: 0.6906
2024-06-12 12:44:20:INFO:VAL-(cmcm) >>
2024-06-12 12:44:20:INFO:M: >>  Has0_acc_2: 0.7031  Has0_F1_score: 0.7019  Non0_acc_2: 0.6944  Non0_F1_score: 0.6959  Mult_acc_5: 0.3755  Mult_acc_7: 0.2751  MAE: 1.2097  Corr: 0.4799 
2024-06-12 12:44:35:INFO:TRAIN-(cmcm) (4/32/5)>> loss: 0.6867
2024-06-12 12:44:38:INFO:VAL-(cmcm) >>
2024-06-12 12:44:38:INFO:M: >>  Has0_acc_2: 0.7074  Has0_F1_score: 0.7077  Non0_acc_2: 0.6991  Non0_F1_score: 0.7006  Mult_acc_5: 0.3231  Mult_acc_7: 0.2271  MAE: 1.2306  Corr: 0.4733 
2024-06-12 12:44:52:INFO:TRAIN-(cmcm) (5/33/5)>> loss: 0.6771
2024-06-12 12:44:55:INFO:VAL-(cmcm) >>
2024-06-12 12:44:55:INFO:M: >>  Has0_acc_2: 0.7118  Has0_F1_score: 0.7060  Non0_acc_2: 0.7037  Non0_F1_score: 0.7016  Mult_acc_5: 0.3144  Mult_acc_7: 0.2314  MAE: 1.1817  Corr: 0.4957 
2024-06-12 12:45:10:INFO:TRAIN-(cmcm) (6/34/5)>> loss: 0.6736
2024-06-12 12:45:12:INFO:VAL-(cmcm) >>
2024-06-12 12:45:12:INFO:M: >>  Has0_acc_2: 0.6987  Has0_F1_score: 0.6984  Non0_acc_2: 0.7037  Non0_F1_score: 0.7028  Mult_acc_5: 0.3537  Mult_acc_7: 0.2620  MAE: 1.2354  Corr: 0.4695 
2024-06-12 12:45:27:INFO:TRAIN-(cmcm) (7/35/5)>> loss: 0.6637
2024-06-12 12:45:29:INFO:VAL-(cmcm) >>
2024-06-12 12:45:29:INFO:M: >>  Has0_acc_2: 0.6943  Has0_F1_score: 0.6961  Non0_acc_2: 0.6991  Non0_F1_score: 0.7006  Mult_acc_5: 0.3275  Mult_acc_7: 0.2402  MAE: 1.2437  Corr: 0.4709 
2024-06-12 12:45:44:INFO:TRAIN-(cmcm) (8/36/5)>> loss: 0.6609
2024-06-12 12:45:47:INFO:VAL-(cmcm) >>
2024-06-12 12:45:47:INFO:M: >>  Has0_acc_2: 0.6987  Has0_F1_score: 0.6994  Non0_acc_2: 0.6991  Non0_F1_score: 0.7006  Mult_acc_5: 0.3231  Mult_acc_7: 0.2314  MAE: 1.2263  Corr: 0.4713 
2024-06-12 12:46:01:INFO:TRAIN-(cmcm) (9/37/5)>> loss: 0.6558
2024-06-12 12:46:04:INFO:VAL-(cmcm) >>
2024-06-12 12:46:04:INFO:M: >>  Has0_acc_2: 0.6987  Has0_F1_score: 0.7009  Non0_acc_2: 0.7083  Non0_F1_score: 0.7099  Mult_acc_5: 0.3013  Mult_acc_7: 0.2183  MAE: 1.2302  Corr: 0.4802 
2024-06-12 12:46:19:INFO:TRAIN-(cmcm) (10/38/5)>> loss: 0.6518
2024-06-12 12:46:21:INFO:VAL-(cmcm) >>
2024-06-12 12:46:21:INFO:M: >>  Has0_acc_2: 0.6987  Has0_F1_score: 0.7009  Non0_acc_2: 0.6944  Non0_F1_score: 0.6959  Mult_acc_5: 0.3100  Mult_acc_7: 0.2227  MAE: 1.2123  Corr: 0.4934 
2024-06-12 12:46:29:INFO:TEST-(cmcm) >>
2024-06-12 12:46:29:INFO:M: >>  Has0_acc_2: 0.6822  Has0_F1_score: 0.6826  Non0_acc_2: 0.7226  Non0_F1_score: 0.7203  Mult_acc_5: 0.3134  Mult_acc_7: 0.2682  MAE: 1.2053  Corr: 0.4660 
2024-06-12 12:46:29:INFO:Results are added to results/results/mosi-regression-40.csv...
2024-06-12 12:46:29:INFO:Start running cmcm...
2024-06-12 12:46:29:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 50, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-06-12 12:46:29:INFO:Let's use the GPU 1 !
2024-06-12 12:46:29:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 12:46:29:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718167590 HTTP/1.1" 200 235
2024-06-12 12:46:30:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 12:46:30:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 12:46:31:INFO:train samples: (1284,)
2024-06-12 12:46:31:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 12:46:31:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718167592 HTTP/1.1" 200 235
2024-06-12 12:46:32:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 12:46:32:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 12:46:33:INFO:valid samples: (229,)
2024-06-12 12:46:33:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 12:46:33:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718167593 HTTP/1.1" 200 235
2024-06-12 12:46:33:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 12:46:34:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 12:46:34:INFO:test samples: (686,)
2024-06-12 12:46:34:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 12:46:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718167595 HTTP/1.1" 200 235
2024-06-12 12:46:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 12:46:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 12:46:36:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 12:46:36:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718167596 HTTP/1.1" 200 235
2024-06-12 12:46:37:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 12:46:37:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 12:46:37:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-12 12:46:37:WARNING:Try importing flash-attention for faster inference...
2024-06-12 12:46:37:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-12 12:46:37:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-12 12:46:37:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-12 12:46:38:INFO:trainable params: 1310284 || all params: 1838138956 || trainable%: 0.07128318540461856
2024-06-12 12:46:38:INFO:Init labels...
2024-06-12 12:46:38:INFO:Start training...
2024-06-12 12:46:53:INFO:TRAIN-(cmcm) (1/1/1)>> loss: 3.3776
2024-06-12 12:46:56:INFO:VAL-(cmcm) >>
2024-06-12 12:46:56:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.4558  Non0_acc_2: 0.5463  Non0_F1_score: 0.4997  Mult_acc_5: 0.1965  Mult_acc_7: 0.1965  MAE: 1.4873  Corr: 0.0055 
2024-06-12 12:46:56:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-12 12:47:11:INFO:TRAIN-(cmcm) (1/2/1)>> loss: 1.0128
2024-06-12 12:47:14:INFO:VAL-(cmcm) >>
2024-06-12 12:47:14:INFO:M: >>  Has0_acc_2: 0.4367  Has0_F1_score: 0.3462  Non0_acc_2: 0.4676  Non0_F1_score: 0.3688  Mult_acc_5: 0.1485  Mult_acc_7: 0.1397  MAE: 1.6231  Corr: 0.0068 
2024-06-12 12:47:28:INFO:TRAIN-(cmcm) (2/3/1)>> loss: 0.9568
2024-06-12 12:47:31:INFO:VAL-(cmcm) >>
2024-06-12 12:47:31:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4534  Non0_acc_2: 0.5324  Non0_F1_score: 0.4483  Mult_acc_5: 0.2052  Mult_acc_7: 0.1616  MAE: 1.6724  Corr: -0.1409 
2024-06-12 12:47:45:INFO:TRAIN-(cmcm) (3/4/1)>> loss: 0.9172
2024-06-12 12:47:48:INFO:VAL-(cmcm) >>
2024-06-12 12:47:48:INFO:M: >>  Has0_acc_2: 0.5590  Has0_F1_score: 0.5216  Non0_acc_2: 0.5417  Non0_F1_score: 0.5056  Mult_acc_5: 0.1790  Mult_acc_7: 0.1659  MAE: 1.6349  Corr: -0.0152 
2024-06-12 12:48:03:INFO:TRAIN-(cmcm) (4/5/1)>> loss: 0.9005
2024-06-12 12:48:05:INFO:VAL-(cmcm) >>
2024-06-12 12:48:05:INFO:M: >>  Has0_acc_2: 0.5284  Has0_F1_score: 0.5320  Non0_acc_2: 0.5278  Non0_F1_score: 0.5294  Mult_acc_5: 0.1834  Mult_acc_7: 0.1703  MAE: 1.5672  Corr: 0.0325 
2024-06-12 12:48:20:INFO:TRAIN-(cmcm) (5/6/1)>> loss: 0.8894
2024-06-12 12:48:23:INFO:VAL-(cmcm) >>
2024-06-12 12:48:23:INFO:M: >>  Has0_acc_2: 0.5415  Has0_F1_score: 0.5283  Non0_acc_2: 0.5278  Non0_F1_score: 0.5132  Mult_acc_5: 0.2533  Mult_acc_7: 0.2227  MAE: 1.6180  Corr: -0.0233 
2024-06-12 12:48:37:INFO:TRAIN-(cmcm) (6/7/1)>> loss: 0.8808
2024-06-12 12:48:40:INFO:VAL-(cmcm) >>
2024-06-12 12:48:40:INFO:M: >>  Has0_acc_2: 0.5590  Has0_F1_score: 0.5462  Non0_acc_2: 0.5324  Non0_F1_score: 0.5236  Mult_acc_5: 0.2795  Mult_acc_7: 0.2271  MAE: 1.6528  Corr: 0.0395 
2024-06-12 12:48:55:INFO:TRAIN-(cmcm) (7/8/1)>> loss: 0.8745
2024-06-12 12:48:57:INFO:VAL-(cmcm) >>
2024-06-12 12:48:57:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.5220  Non0_acc_2: 0.5509  Non0_F1_score: 0.5031  Mult_acc_5: 0.2882  Mult_acc_7: 0.2096  MAE: 1.7289  Corr: 0.0047 
2024-06-12 12:49:12:INFO:TRAIN-(cmcm) (8/9/1)>> loss: 0.8742
2024-06-12 12:49:14:INFO:VAL-(cmcm) >>
2024-06-12 12:49:14:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4534  Non0_acc_2: 0.5694  Non0_F1_score: 0.4246  Mult_acc_5: 0.2664  Mult_acc_7: 0.1921  MAE: 1.7154  Corr: -0.0139 
2024-06-12 12:49:29:INFO:TRAIN-(cmcm) (9/10/1)>> loss: 0.8675
2024-06-12 12:49:32:INFO:VAL-(cmcm) >>
2024-06-12 12:49:32:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.5642  Non0_acc_2: 0.5833  Non0_F1_score: 0.5374  Mult_acc_5: 0.3275  Mult_acc_7: 0.2445  MAE: 1.6263  Corr: 0.0936 
2024-06-12 12:49:46:INFO:TRAIN-(cmcm) (10/11/1)>> loss: 0.8625
2024-06-12 12:49:49:INFO:VAL-(cmcm) >>
2024-06-12 12:49:49:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5840  Non0_acc_2: 0.5787  Non0_F1_score: 0.5808  Mult_acc_5: 0.2795  Mult_acc_7: 0.2358  MAE: 1.5568  Corr: 0.1424 
2024-06-12 12:49:56:INFO:TEST-(cmcm) >>
2024-06-12 12:49:56:INFO:M: >>  Has0_acc_2: 0.4519  Has0_F1_score: 0.3383  Non0_acc_2: 0.4848  Non0_F1_score: 0.4412  Mult_acc_5: 0.1706  Mult_acc_7: 0.1706  MAE: 1.7010  Corr: 0.0453 
2024-06-12 12:49:57:INFO:Results are added to results/results/mosi-regression-50.csv...
2024-06-12 12:49:57:INFO:Start running cmcm...
2024-06-12 12:49:57:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 50, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 2222}>
2024-06-12 12:49:57:INFO:Let's use the GPU 1 !
2024-06-12 12:49:57:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 12:49:57:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718167797 HTTP/1.1" 200 235
2024-06-12 12:49:57:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 12:49:58:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 12:49:59:INFO:train samples: (1284,)
2024-06-12 12:49:59:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 12:49:59:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718167799 HTTP/1.1" 200 235
2024-06-12 12:49:59:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 12:50:00:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 12:50:00:INFO:valid samples: (229,)
2024-06-12 12:50:00:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 12:50:01:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718167801 HTTP/1.1" 200 235
2024-06-12 12:50:01:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 12:50:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 12:50:02:INFO:test samples: (686,)
2024-06-12 12:50:02:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 12:50:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718167803 HTTP/1.1" 200 235
2024-06-12 12:50:03:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 12:50:03:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 12:50:04:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 12:50:04:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718167804 HTTP/1.1" 200 235
2024-06-12 12:50:04:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 12:50:04:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 12:50:04:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-12 12:50:04:WARNING:Try importing flash-attention for faster inference...
2024-06-12 12:50:04:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-12 12:50:04:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-12 12:50:04:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-12 12:50:06:INFO:trainable params: 1310284 || all params: 1838138956 || trainable%: 0.07128318540461856
2024-06-12 12:50:06:INFO:Init labels...
2024-06-12 12:50:06:INFO:Start training...
2024-06-12 12:50:20:INFO:TRAIN-(cmcm) (1/1/2)>> loss: 4.0998
2024-06-12 12:50:23:INFO:VAL-(cmcm) >>
2024-06-12 12:50:23:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4537  Non0_F1_score: 0.3793  Mult_acc_5: 0.2445  Mult_acc_7: 0.2052  MAE: 1.5471  Corr: 0.0557 
2024-06-12 12:50:23:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-12 12:50:39:INFO:TRAIN-(cmcm) (1/2/2)>> loss: 1.4893
2024-06-12 12:50:41:INFO:VAL-(cmcm) >>
2024-06-12 12:50:41:INFO:M: >>  Has0_acc_2: 0.5197  Has0_F1_score: 0.5167  Non0_acc_2: 0.5093  Non0_F1_score: 0.5068  Mult_acc_5: 0.1965  Mult_acc_7: 0.1659  MAE: 1.7580  Corr: -0.0757 
2024-06-12 12:50:56:INFO:TRAIN-(cmcm) (2/3/2)>> loss: 0.9766
2024-06-12 12:50:58:INFO:VAL-(cmcm) >>
2024-06-12 12:50:58:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.4943  Non0_acc_2: 0.5787  Non0_F1_score: 0.4649  Mult_acc_5: 0.1790  Mult_acc_7: 0.1703  MAE: 1.5864  Corr: 0.0092 
2024-06-12 12:51:13:INFO:TRAIN-(cmcm) (3/4/2)>> loss: 0.9112
2024-06-12 12:51:16:INFO:VAL-(cmcm) >>
2024-06-12 12:51:16:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4978  Non0_acc_2: 0.5694  Non0_F1_score: 0.4713  Mult_acc_5: 0.2009  Mult_acc_7: 0.1878  MAE: 1.6445  Corr: -0.0463 
2024-06-12 12:51:30:INFO:TRAIN-(cmcm) (4/5/2)>> loss: 0.8979
2024-06-12 12:51:33:INFO:VAL-(cmcm) >>
2024-06-12 12:51:33:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5081  Non0_acc_2: 0.5694  Non0_F1_score: 0.4821  Mult_acc_5: 0.2227  Mult_acc_7: 0.2183  MAE: 1.5951  Corr: 0.0173 
2024-06-12 12:51:48:INFO:TRAIN-(cmcm) (5/6/2)>> loss: 0.8827
2024-06-12 12:51:50:INFO:VAL-(cmcm) >>
2024-06-12 12:51:50:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5031  Non0_acc_2: 0.5278  Non0_F1_score: 0.4950  Mult_acc_5: 0.2314  Mult_acc_7: 0.2009  MAE: 1.5381  Corr: 0.0248 
2024-06-12 12:51:51:INFO:Saving checkpoint at epoch 6 to results/models/cmcm-mosi-regression.pth.
2024-06-12 12:52:06:INFO:TRAIN-(cmcm) (1/7/2)>> loss: 0.8817
2024-06-12 12:52:09:INFO:VAL-(cmcm) >>
2024-06-12 12:52:09:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5678  Non0_acc_2: 0.5833  Non0_F1_score: 0.5591  Mult_acc_5: 0.2795  Mult_acc_7: 0.1921  MAE: 1.7175  Corr: 0.0917 
2024-06-12 12:52:23:INFO:TRAIN-(cmcm) (2/8/2)>> loss: 0.8733
2024-06-12 12:52:26:INFO:VAL-(cmcm) >>
2024-06-12 12:52:26:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.5640  Non0_acc_2: 0.5926  Non0_F1_score: 0.5477  Mult_acc_5: 0.3013  Mult_acc_7: 0.2402  MAE: 1.6049  Corr: 0.0834 
2024-06-12 12:52:41:INFO:TRAIN-(cmcm) (3/9/2)>> loss: 0.8750
2024-06-12 12:52:43:INFO:VAL-(cmcm) >>
2024-06-12 12:52:43:INFO:M: >>  Has0_acc_2: 0.5328  Has0_F1_score: 0.5372  Non0_acc_2: 0.5324  Non0_F1_score: 0.5349  Mult_acc_5: 0.1921  Mult_acc_7: 0.1790  MAE: 1.5641  Corr: 0.0563 
2024-06-12 12:52:58:INFO:TRAIN-(cmcm) (4/10/2)>> loss: 0.8690
2024-06-12 12:53:00:INFO:VAL-(cmcm) >>
2024-06-12 12:53:00:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.4653  Non0_acc_2: 0.5648  Non0_F1_score: 0.4371  Mult_acc_5: 0.2271  Mult_acc_7: 0.2096  MAE: 1.5733  Corr: -0.0226 
2024-06-12 12:53:15:INFO:TRAIN-(cmcm) (5/11/2)>> loss: 0.8616
2024-06-12 12:53:18:INFO:VAL-(cmcm) >>
2024-06-12 12:53:18:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.5826  Non0_acc_2: 0.5926  Non0_F1_score: 0.5710  Mult_acc_5: 0.2358  Mult_acc_7: 0.1834  MAE: 1.6782  Corr: 0.1434 
2024-06-12 12:53:33:INFO:TRAIN-(cmcm) (6/12/2)>> loss: 0.8577
2024-06-12 12:53:35:INFO:VAL-(cmcm) >>
2024-06-12 12:53:35:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.5785  Non0_acc_2: 0.5926  Non0_F1_score: 0.5593  Mult_acc_5: 0.2882  Mult_acc_7: 0.2052  MAE: 1.5944  Corr: 0.1510 
2024-06-12 12:53:50:INFO:TRAIN-(cmcm) (7/13/2)>> loss: 0.8514
2024-06-12 12:53:52:INFO:VAL-(cmcm) >>
2024-06-12 12:53:52:INFO:M: >>  Has0_acc_2: 0.6157  Has0_F1_score: 0.5675  Non0_acc_2: 0.5972  Non0_F1_score: 0.5479  Mult_acc_5: 0.3013  Mult_acc_7: 0.2183  MAE: 1.6926  Corr: 0.1078 
2024-06-12 12:54:07:INFO:TRAIN-(cmcm) (8/14/2)>> loss: 0.8548
2024-06-12 12:54:10:INFO:VAL-(cmcm) >>
2024-06-12 12:54:10:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5930  Non0_acc_2: 0.5926  Non0_F1_score: 0.5943  Mult_acc_5: 0.3057  Mult_acc_7: 0.2314  MAE: 1.6337  Corr: 0.1729 
2024-06-12 12:54:24:INFO:TRAIN-(cmcm) (9/15/2)>> loss: 0.8559
2024-06-12 12:54:27:INFO:VAL-(cmcm) >>
2024-06-12 12:54:27:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.6105  Non0_acc_2: 0.6019  Non0_F1_score: 0.6039  Mult_acc_5: 0.2751  Mult_acc_7: 0.2096  MAE: 1.4804  Corr: 0.2055 
2024-06-12 12:54:27:INFO:Saving checkpoint at epoch 15 to results/models/cmcm-mosi-regression.pth.
2024-06-12 12:54:42:INFO:TRAIN-(cmcm) (1/16/2)>> loss: 0.8462
2024-06-12 12:54:45:INFO:VAL-(cmcm) >>
2024-06-12 12:54:45:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.5509  Non0_acc_2: 0.5787  Non0_F1_score: 0.5271  Mult_acc_5: 0.2882  Mult_acc_7: 0.2183  MAE: 1.6023  Corr: 0.0927 
2024-06-12 12:55:00:INFO:TRAIN-(cmcm) (2/17/2)>> loss: 0.8388
2024-06-12 12:55:02:INFO:VAL-(cmcm) >>
2024-06-12 12:55:02:INFO:M: >>  Has0_acc_2: 0.6376  Has0_F1_score: 0.5841  Non0_acc_2: 0.6250  Non0_F1_score: 0.5822  Mult_acc_5: 0.2620  Mult_acc_7: 0.2183  MAE: 1.5433  Corr: 0.1115 
2024-06-12 12:55:17:INFO:TRAIN-(cmcm) (3/18/2)>> loss: 0.8359
2024-06-12 12:55:19:INFO:VAL-(cmcm) >>
2024-06-12 12:55:19:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5962  Non0_acc_2: 0.4722  Non0_F1_score: 0.4125  Mult_acc_5: 0.2227  Mult_acc_7: 0.2096  MAE: 1.4318  Corr: 0.1733 
2024-06-12 12:55:20:INFO:Saving checkpoint at epoch 18 to results/models/cmcm-mosi-regression.pth.
2024-06-12 12:55:35:INFO:TRAIN-(cmcm) (1/19/2)>> loss: 0.8325
2024-06-12 12:55:37:INFO:VAL-(cmcm) >>
2024-06-12 12:55:37:INFO:M: >>  Has0_acc_2: 0.6288  Has0_F1_score: 0.5410  Non0_acc_2: 0.6157  Non0_F1_score: 0.5546  Mult_acc_5: 0.2096  Mult_acc_7: 0.2096  MAE: 1.4501  Corr: 0.0693 
2024-06-12 12:55:52:INFO:TRAIN-(cmcm) (2/20/2)>> loss: 0.8287
2024-06-12 12:55:55:INFO:VAL-(cmcm) >>
2024-06-12 12:55:55:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5968  Non0_acc_2: 0.5833  Non0_F1_score: 0.5856  Mult_acc_5: 0.2969  Mult_acc_7: 0.2314  MAE: 1.5803  Corr: 0.1892 
2024-06-12 12:56:09:INFO:TRAIN-(cmcm) (3/21/2)>> loss: 0.8256
2024-06-12 12:56:12:INFO:VAL-(cmcm) >>
2024-06-12 12:56:12:INFO:M: >>  Has0_acc_2: 0.6288  Has0_F1_score: 0.6082  Non0_acc_2: 0.6019  Non0_F1_score: 0.5863  Mult_acc_5: 0.2664  Mult_acc_7: 0.2009  MAE: 1.4180  Corr: 0.2469 
2024-06-12 12:56:12:INFO:Saving checkpoint at epoch 21 to results/models/cmcm-mosi-regression.pth.
2024-06-12 12:56:27:INFO:TRAIN-(cmcm) (1/22/2)>> loss: 0.8142
2024-06-12 12:56:30:INFO:VAL-(cmcm) >>
2024-06-12 12:56:30:INFO:M: >>  Has0_acc_2: 0.5109  Has0_F1_score: 0.4423  Non0_acc_2: 0.5417  Non0_F1_score: 0.4774  Mult_acc_5: 0.2533  Mult_acc_7: 0.2009  MAE: 1.8087  Corr: 0.2959 
2024-06-12 12:56:45:INFO:TRAIN-(cmcm) (2/23/2)>> loss: 0.8088
2024-06-12 12:56:47:INFO:VAL-(cmcm) >>
2024-06-12 12:56:47:INFO:M: >>  Has0_acc_2: 0.6419  Has0_F1_score: 0.5940  Non0_acc_2: 0.6250  Non0_F1_score: 0.5791  Mult_acc_5: 0.3013  Mult_acc_7: 0.2140  MAE: 1.4586  Corr: 0.3079 
2024-06-12 12:57:02:INFO:TRAIN-(cmcm) (3/24/2)>> loss: 0.8039
2024-06-12 12:57:05:INFO:VAL-(cmcm) >>
2024-06-12 12:57:05:INFO:M: >>  Has0_acc_2: 0.6376  Has0_F1_score: 0.6271  Non0_acc_2: 0.6343  Non0_F1_score: 0.6223  Mult_acc_5: 0.2795  Mult_acc_7: 0.2271  MAE: 1.4900  Corr: 0.2526 
2024-06-12 12:57:19:INFO:TRAIN-(cmcm) (4/25/2)>> loss: 0.8015
2024-06-12 12:57:22:INFO:VAL-(cmcm) >>
2024-06-12 12:57:22:INFO:M: >>  Has0_acc_2: 0.6332  Has0_F1_score: 0.6246  Non0_acc_2: 0.6435  Non0_F1_score: 0.6345  Mult_acc_5: 0.3100  Mult_acc_7: 0.2620  MAE: 1.3913  Corr: 0.2924 
2024-06-12 12:57:22:INFO:Saving checkpoint at epoch 25 to results/models/cmcm-mosi-regression.pth.
2024-06-12 12:57:37:INFO:TRAIN-(cmcm) (1/26/2)>> loss: 0.7920
2024-06-12 12:57:40:INFO:VAL-(cmcm) >>
2024-06-12 12:57:40:INFO:M: >>  Has0_acc_2: 0.6507  Has0_F1_score: 0.6458  Non0_acc_2: 0.6574  Non0_F1_score: 0.6579  Mult_acc_5: 0.3275  Mult_acc_7: 0.2576  MAE: 1.3730  Corr: 0.3164 
2024-06-12 12:57:40:INFO:Saving checkpoint at epoch 26 to results/models/cmcm-mosi-regression.pth.
2024-06-12 12:57:55:INFO:TRAIN-(cmcm) (1/27/2)>> loss: 0.7778
2024-06-12 12:57:58:INFO:VAL-(cmcm) >>
2024-06-12 12:57:58:INFO:M: >>  Has0_acc_2: 0.6157  Has0_F1_score: 0.6170  Non0_acc_2: 0.6204  Non0_F1_score: 0.6213  Mult_acc_5: 0.2795  Mult_acc_7: 0.1921  MAE: 1.5787  Corr: 0.2387 
2024-06-12 12:58:13:INFO:TRAIN-(cmcm) (2/28/2)>> loss: 0.7781
2024-06-12 12:58:15:INFO:VAL-(cmcm) >>
2024-06-12 12:58:15:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.6143  Non0_acc_2: 0.6296  Non0_F1_score: 0.6312  Mult_acc_5: 0.2882  Mult_acc_7: 0.2096  MAE: 1.4599  Corr: 0.3195 
2024-06-12 12:58:30:INFO:TRAIN-(cmcm) (3/29/2)>> loss: 0.7706
2024-06-12 12:58:32:INFO:VAL-(cmcm) >>
2024-06-12 12:58:32:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5939  Non0_acc_2: 0.6157  Non0_F1_score: 0.6149  Mult_acc_5: 0.2926  Mult_acc_7: 0.1965  MAE: 1.5324  Corr: 0.3276 
2024-06-12 12:58:47:INFO:TRAIN-(cmcm) (4/30/2)>> loss: 0.7638
2024-06-12 12:58:50:INFO:VAL-(cmcm) >>
2024-06-12 12:58:50:INFO:M: >>  Has0_acc_2: 0.6419  Has0_F1_score: 0.6422  Non0_acc_2: 0.6250  Non0_F1_score: 0.6134  Mult_acc_5: 0.2751  Mult_acc_7: 0.2271  MAE: 1.3835  Corr: 0.3487 
2024-06-12 12:59:04:INFO:TRAIN-(cmcm) (5/31/2)>> loss: 0.7580
2024-06-12 12:59:07:INFO:VAL-(cmcm) >>
2024-06-12 12:59:07:INFO:M: >>  Has0_acc_2: 0.6332  Has0_F1_score: 0.6365  Non0_acc_2: 0.6481  Non0_F1_score: 0.6498  Mult_acc_5: 0.3406  Mult_acc_7: 0.2620  MAE: 1.4119  Corr: 0.3208 
2024-06-12 12:59:22:INFO:TRAIN-(cmcm) (6/32/2)>> loss: 0.7538
2024-06-12 12:59:24:INFO:VAL-(cmcm) >>
2024-06-12 12:59:24:INFO:M: >>  Has0_acc_2: 0.6245  Has0_F1_score: 0.6264  Non0_acc_2: 0.6389  Non0_F1_score: 0.6394  Mult_acc_5: 0.2969  Mult_acc_7: 0.2358  MAE: 1.3654  Corr: 0.3757 
2024-06-12 12:59:25:INFO:Saving checkpoint at epoch 32 to results/models/cmcm-mosi-regression.pth.
2024-06-12 12:59:40:INFO:TRAIN-(cmcm) (1/33/2)>> loss: 0.7454
2024-06-12 12:59:42:INFO:VAL-(cmcm) >>
2024-06-12 12:59:42:INFO:M: >>  Has0_acc_2: 0.6376  Has0_F1_score: 0.6271  Non0_acc_2: 0.6157  Non0_F1_score: 0.6172  Mult_acc_5: 0.2882  Mult_acc_7: 0.2096  MAE: 1.3621  Corr: 0.3369 
2024-06-12 12:59:43:INFO:Saving checkpoint at epoch 33 to results/models/cmcm-mosi-regression.pth.
2024-06-12 12:59:58:INFO:TRAIN-(cmcm) (1/34/2)>> loss: 0.7427
2024-06-12 13:00:00:INFO:VAL-(cmcm) >>
2024-06-12 13:00:00:INFO:M: >>  Has0_acc_2: 0.6419  Has0_F1_score: 0.6280  Non0_acc_2: 0.6528  Non0_F1_score: 0.6514  Mult_acc_5: 0.3493  Mult_acc_7: 0.2751  MAE: 1.3149  Corr: 0.3274 
2024-06-12 13:00:01:INFO:Saving checkpoint at epoch 34 to results/models/cmcm-mosi-regression.pth.
2024-06-12 13:00:16:INFO:TRAIN-(cmcm) (1/35/2)>> loss: 0.7344
2024-06-12 13:00:19:INFO:VAL-(cmcm) >>
2024-06-12 13:00:19:INFO:M: >>  Has0_acc_2: 0.6332  Has0_F1_score: 0.6219  Non0_acc_2: 0.6296  Non0_F1_score: 0.6196  Mult_acc_5: 0.3057  Mult_acc_7: 0.2358  MAE: 1.3676  Corr: 0.3229 
2024-06-12 13:00:33:INFO:TRAIN-(cmcm) (2/36/2)>> loss: 0.7275
2024-06-12 13:00:36:INFO:VAL-(cmcm) >>
2024-06-12 13:00:36:INFO:M: >>  Has0_acc_2: 0.6201  Has0_F1_score: 0.6194  Non0_acc_2: 0.6435  Non0_F1_score: 0.6381  Mult_acc_5: 0.3231  Mult_acc_7: 0.2489  MAE: 1.3839  Corr: 0.3663 
2024-06-12 13:00:51:INFO:TRAIN-(cmcm) (3/37/2)>> loss: 0.7262
2024-06-12 13:00:53:INFO:VAL-(cmcm) >>
2024-06-12 13:00:53:INFO:M: >>  Has0_acc_2: 0.6463  Has0_F1_score: 0.6497  Non0_acc_2: 0.6620  Non0_F1_score: 0.6638  Mult_acc_5: 0.3362  Mult_acc_7: 0.2489  MAE: 1.3429  Corr: 0.4056 
2024-06-12 13:01:08:INFO:TRAIN-(cmcm) (4/38/2)>> loss: 0.7128
2024-06-12 13:01:10:INFO:VAL-(cmcm) >>
2024-06-12 13:01:10:INFO:M: >>  Has0_acc_2: 0.6288  Has0_F1_score: 0.6324  Non0_acc_2: 0.6435  Non0_F1_score: 0.6453  Mult_acc_5: 0.2882  Mult_acc_7: 0.2009  MAE: 1.4001  Corr: 0.3475 
2024-06-12 13:01:25:INFO:TRAIN-(cmcm) (5/39/2)>> loss: 0.7075
2024-06-12 13:01:28:INFO:VAL-(cmcm) >>
2024-06-12 13:01:28:INFO:M: >>  Has0_acc_2: 0.6594  Has0_F1_score: 0.6565  Non0_acc_2: 0.6157  Non0_F1_score: 0.6178  Mult_acc_5: 0.3275  Mult_acc_7: 0.2620  MAE: 1.3084  Corr: 0.3404 
2024-06-12 13:01:28:INFO:Saving checkpoint at epoch 39 to results/models/cmcm-mosi-regression.pth.
2024-06-12 13:01:43:INFO:TRAIN-(cmcm) (1/40/2)>> loss: 0.6998
2024-06-12 13:01:46:INFO:VAL-(cmcm) >>
2024-06-12 13:01:46:INFO:M: >>  Has0_acc_2: 0.6725  Has0_F1_score: 0.6618  Non0_acc_2: 0.6435  Non0_F1_score: 0.6433  Mult_acc_5: 0.3406  Mult_acc_7: 0.2576  MAE: 1.3215  Corr: 0.3446 
2024-06-12 13:02:00:INFO:TRAIN-(cmcm) (2/41/2)>> loss: 0.6960
2024-06-12 13:02:03:INFO:VAL-(cmcm) >>
2024-06-12 13:02:03:INFO:M: >>  Has0_acc_2: 0.6245  Has0_F1_score: 0.6277  Non0_acc_2: 0.6435  Non0_F1_score: 0.6453  Mult_acc_5: 0.3100  Mult_acc_7: 0.2271  MAE: 1.3953  Corr: 0.3477 
2024-06-12 13:02:18:INFO:TRAIN-(cmcm) (3/42/2)>> loss: 0.6907
2024-06-12 13:02:20:INFO:VAL-(cmcm) >>
2024-06-12 13:02:20:INFO:M: >>  Has0_acc_2: 0.6594  Has0_F1_score: 0.6614  Non0_acc_2: 0.6667  Non0_F1_score: 0.6683  Mult_acc_5: 0.2795  Mult_acc_7: 0.2009  MAE: 1.3180  Corr: 0.3710 
2024-06-12 13:02:35:INFO:TRAIN-(cmcm) (4/43/2)>> loss: 0.6839
2024-06-12 13:02:37:INFO:VAL-(cmcm) >>
2024-06-12 13:02:37:INFO:M: >>  Has0_acc_2: 0.6288  Has0_F1_score: 0.6270  Non0_acc_2: 0.6389  Non0_F1_score: 0.6383  Mult_acc_5: 0.2576  Mult_acc_7: 0.1834  MAE: 1.4175  Corr: 0.2931 
2024-06-12 13:02:52:INFO:TRAIN-(cmcm) (5/44/2)>> loss: 0.6835
2024-06-12 13:02:55:INFO:VAL-(cmcm) >>
2024-06-12 13:02:55:INFO:M: >>  Has0_acc_2: 0.6376  Has0_F1_score: 0.6349  Non0_acc_2: 0.6389  Non0_F1_score: 0.6363  Mult_acc_5: 0.3057  Mult_acc_7: 0.2227  MAE: 1.3887  Corr: 0.3359 
2024-06-12 13:03:09:INFO:TRAIN-(cmcm) (6/45/2)>> loss: 0.6785
2024-06-12 13:03:12:INFO:VAL-(cmcm) >>
2024-06-12 13:03:12:INFO:M: >>  Has0_acc_2: 0.6376  Has0_F1_score: 0.6405  Non0_acc_2: 0.6435  Non0_F1_score: 0.6453  Mult_acc_5: 0.3100  Mult_acc_7: 0.2314  MAE: 1.3621  Corr: 0.3498 
2024-06-12 13:03:26:INFO:TRAIN-(cmcm) (7/46/2)>> loss: 0.6740
2024-06-12 13:03:29:INFO:VAL-(cmcm) >>
2024-06-12 13:03:29:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.6151  Non0_acc_2: 0.6157  Non0_F1_score: 0.6179  Mult_acc_5: 0.3100  Mult_acc_7: 0.2271  MAE: 1.4381  Corr: 0.3129 
2024-06-12 13:03:44:INFO:TRAIN-(cmcm) (8/47/2)>> loss: 0.6721
2024-06-12 13:03:46:INFO:VAL-(cmcm) >>
2024-06-12 13:03:46:INFO:M: >>  Has0_acc_2: 0.6288  Has0_F1_score: 0.6318  Non0_acc_2: 0.6389  Non0_F1_score: 0.6408  Mult_acc_5: 0.3144  Mult_acc_7: 0.2314  MAE: 1.4005  Corr: 0.3210 
2024-06-12 13:04:01:INFO:TRAIN-(cmcm) (9/48/2)>> loss: 0.6721
2024-06-12 13:04:03:INFO:VAL-(cmcm) >>
2024-06-12 13:04:03:INFO:M: >>  Has0_acc_2: 0.6376  Has0_F1_score: 0.6402  Non0_acc_2: 0.6574  Non0_F1_score: 0.6592  Mult_acc_5: 0.3100  Mult_acc_7: 0.2314  MAE: 1.3625  Corr: 0.3437 
2024-06-12 13:04:18:INFO:TRAIN-(cmcm) (10/49/2)>> loss: 0.6697
2024-06-12 13:04:21:INFO:VAL-(cmcm) >>
2024-06-12 13:04:21:INFO:M: >>  Has0_acc_2: 0.6376  Has0_F1_score: 0.6402  Non0_acc_2: 0.6389  Non0_F1_score: 0.6404  Mult_acc_5: 0.3231  Mult_acc_7: 0.2358  MAE: 1.3835  Corr: 0.3388 
2024-06-12 13:04:28:INFO:TEST-(cmcm) >>
2024-06-12 13:04:28:INFO:M: >>  Has0_acc_2: 0.6399  Has0_F1_score: 0.6384  Non0_acc_2: 0.6616  Non0_F1_score: 0.6627  Mult_acc_5: 0.2988  Mult_acc_7: 0.2697  MAE: 1.2935  Corr: 0.3634 
2024-06-12 13:04:28:INFO:Results are added to results/results/mosi-regression-50.csv...
2024-06-12 13:04:28:INFO:Start running cmcm...
2024-06-12 13:04:28:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 50, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 3333}>
2024-06-12 13:04:28:INFO:Let's use the GPU 1 !
2024-06-12 13:04:29:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 13:04:29:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718168669 HTTP/1.1" 200 235
2024-06-12 13:04:29:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 13:04:29:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 13:04:30:INFO:train samples: (1284,)
2024-06-12 13:04:30:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 13:04:31:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718168671 HTTP/1.1" 200 235
2024-06-12 13:04:31:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 13:04:31:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 13:04:32:INFO:valid samples: (229,)
2024-06-12 13:04:32:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 13:04:33:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718168673 HTTP/1.1" 200 235
2024-06-12 13:04:33:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 13:04:33:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 13:04:34:INFO:test samples: (686,)
2024-06-12 13:04:34:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 13:04:34:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718168675 HTTP/1.1" 200 235
2024-06-12 13:04:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 13:04:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 13:04:36:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 13:04:36:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718168676 HTTP/1.1" 200 235
2024-06-12 13:04:36:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 13:04:36:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 13:04:37:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-12 13:04:37:WARNING:Try importing flash-attention for faster inference...
2024-06-12 13:04:37:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-12 13:04:37:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-12 13:04:37:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-12 13:04:38:INFO:trainable params: 1310284 || all params: 1838138956 || trainable%: 0.07128318540461856
2024-06-12 13:04:38:INFO:Init labels...
2024-06-12 13:04:38:INFO:Start training...
2024-06-12 13:04:53:INFO:TRAIN-(cmcm) (1/1/3)>> loss: 4.2816
2024-06-12 13:04:56:INFO:VAL-(cmcm) >>
2024-06-12 13:04:56:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4259  Non0_F1_score: 0.2544  Mult_acc_5: 0.2140  Mult_acc_7: 0.2140  MAE: 1.4370  Corr: nan 
2024-06-12 13:04:56:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-12 13:05:11:INFO:TRAIN-(cmcm) (1/2/3)>> loss: 2.9412
2024-06-12 13:05:14:INFO:VAL-(cmcm) >>
2024-06-12 13:05:14:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4652  Non0_acc_2: 0.5787  Non0_F1_score: 0.4370  Mult_acc_5: 0.2926  Mult_acc_7: 0.1965  MAE: 1.7791  Corr: -0.0186 
2024-06-12 13:05:29:INFO:TRAIN-(cmcm) (2/3/3)>> loss: 1.0908
2024-06-12 13:05:31:INFO:VAL-(cmcm) >>
2024-06-12 13:05:31:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5515  Non0_acc_2: 0.5556  Non0_F1_score: 0.5342  Mult_acc_5: 0.2183  Mult_acc_7: 0.1965  MAE: 1.7372  Corr: 0.0066 
2024-06-12 13:05:46:INFO:TRAIN-(cmcm) (3/4/3)>> loss: 0.9381
2024-06-12 13:05:49:INFO:VAL-(cmcm) >>
2024-06-12 13:05:49:INFO:M: >>  Has0_acc_2: 0.4934  Has0_F1_score: 0.4951  Non0_acc_2: 0.4861  Non0_F1_score: 0.4865  Mult_acc_5: 0.1310  Mult_acc_7: 0.1266  MAE: 1.7877  Corr: -0.0461 
2024-06-12 13:06:03:INFO:TRAIN-(cmcm) (4/5/3)>> loss: 0.9118
2024-06-12 13:06:06:INFO:VAL-(cmcm) >>
2024-06-12 13:06:06:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4742  Non0_acc_2: 0.5741  Non0_F1_score: 0.4622  Mult_acc_5: 0.2314  Mult_acc_7: 0.1834  MAE: 1.5643  Corr: -0.0065 
2024-06-12 13:06:21:INFO:TRAIN-(cmcm) (5/6/3)>> loss: 0.8897
2024-06-12 13:06:23:INFO:VAL-(cmcm) >>
2024-06-12 13:06:23:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4923  Non0_acc_2: 0.5741  Non0_F1_score: 0.4683  Mult_acc_5: 0.2358  Mult_acc_7: 0.1965  MAE: 1.6586  Corr: -0.0027 
2024-06-12 13:06:38:INFO:TRAIN-(cmcm) (6/7/3)>> loss: 0.8770
2024-06-12 13:06:40:INFO:VAL-(cmcm) >>
2024-06-12 13:06:41:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.4840  Non0_acc_2: 0.4769  Non0_F1_score: 0.4792  Mult_acc_5: 0.2183  Mult_acc_7: 0.1834  MAE: 1.5366  Corr: -0.0109 
2024-06-12 13:06:55:INFO:TRAIN-(cmcm) (7/8/3)>> loss: 0.8735
2024-06-12 13:06:58:INFO:VAL-(cmcm) >>
2024-06-12 13:06:58:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.5642  Non0_acc_2: 0.5694  Non0_F1_score: 0.5477  Mult_acc_5: 0.2707  Mult_acc_7: 0.2052  MAE: 1.6734  Corr: 0.0713 
2024-06-12 13:07:13:INFO:TRAIN-(cmcm) (8/9/3)>> loss: 0.8644
2024-06-12 13:07:15:INFO:VAL-(cmcm) >>
2024-06-12 13:07:15:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.4746  Non0_acc_2: 0.4630  Non0_F1_score: 0.3711  Mult_acc_5: 0.2140  Mult_acc_7: 0.2140  MAE: 1.4126  Corr: 0.1073 
2024-06-12 13:07:15:INFO:Saving checkpoint at epoch 9 to results/models/cmcm-mosi-regression.pth.
2024-06-12 13:07:30:INFO:TRAIN-(cmcm) (1/10/3)>> loss: 0.8661
2024-06-12 13:07:33:INFO:VAL-(cmcm) >>
2024-06-12 13:07:33:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4458  Non0_acc_2: 0.5648  Non0_F1_score: 0.4223  Mult_acc_5: 0.2533  Mult_acc_7: 0.1965  MAE: 1.5453  Corr: 0.0366 
2024-06-12 13:07:48:INFO:TRAIN-(cmcm) (2/11/3)>> loss: 0.8583
2024-06-12 13:07:50:INFO:VAL-(cmcm) >>
2024-06-12 13:07:50:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4830  Non0_acc_2: 0.5787  Non0_F1_score: 0.4584  Mult_acc_5: 0.2576  Mult_acc_7: 0.2052  MAE: 1.6333  Corr: 0.0668 
2024-06-12 13:08:05:INFO:TRAIN-(cmcm) (3/12/3)>> loss: 0.8560
2024-06-12 13:08:07:INFO:VAL-(cmcm) >>
2024-06-12 13:08:07:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5261  Non0_acc_2: 0.5648  Non0_F1_score: 0.5019  Mult_acc_5: 0.2402  Mult_acc_7: 0.1878  MAE: 1.5826  Corr: 0.0708 
2024-06-12 13:08:22:INFO:TRAIN-(cmcm) (4/13/3)>> loss: 0.8500
2024-06-12 13:08:25:INFO:VAL-(cmcm) >>
2024-06-12 13:08:25:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5146  Non0_acc_2: 0.5694  Non0_F1_score: 0.4920  Mult_acc_5: 0.2838  Mult_acc_7: 0.2140  MAE: 1.7250  Corr: -0.0383 
2024-06-12 13:08:39:INFO:TRAIN-(cmcm) (5/14/3)>> loss: 0.8570
2024-06-12 13:08:42:INFO:VAL-(cmcm) >>
2024-06-12 13:08:42:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.5292  Non0_acc_2: 0.5926  Non0_F1_score: 0.5075  Mult_acc_5: 0.3057  Mult_acc_7: 0.2140  MAE: 1.8136  Corr: 0.0806 
2024-06-12 13:08:57:INFO:TRAIN-(cmcm) (6/15/3)>> loss: 0.8528
2024-06-12 13:08:59:INFO:VAL-(cmcm) >>
2024-06-12 13:08:59:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5042  Non0_acc_2: 0.5417  Non0_F1_score: 0.5420  Mult_acc_5: 0.2140  Mult_acc_7: 0.1790  MAE: 1.5149  Corr: 0.0879 
2024-06-12 13:09:14:INFO:TRAIN-(cmcm) (7/16/3)>> loss: 0.8443
2024-06-12 13:09:16:INFO:VAL-(cmcm) >>
2024-06-12 13:09:16:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5909  Non0_acc_2: 0.5602  Non0_F1_score: 0.5615  Mult_acc_5: 0.2489  Mult_acc_7: 0.1878  MAE: 1.5503  Corr: 0.1399 
2024-06-12 13:09:31:INFO:TRAIN-(cmcm) (8/17/3)>> loss: 0.8435
2024-06-12 13:09:34:INFO:VAL-(cmcm) >>
2024-06-12 13:09:34:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.5820  Non0_acc_2: 0.5694  Non0_F1_score: 0.5585  Mult_acc_5: 0.2358  Mult_acc_7: 0.2271  MAE: 1.4436  Corr: 0.1314 
2024-06-12 13:09:48:INFO:TRAIN-(cmcm) (9/18/3)>> loss: 0.8418
2024-06-12 13:09:51:INFO:VAL-(cmcm) >>
2024-06-12 13:09:51:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5042  Non0_acc_2: 0.5463  Non0_F1_score: 0.4926  Mult_acc_5: 0.2751  Mult_acc_7: 0.2140  MAE: 1.7066  Corr: 0.0152 
2024-06-12 13:10:05:INFO:TRAIN-(cmcm) (10/19/3)>> loss: 0.8350
2024-06-12 13:10:08:INFO:VAL-(cmcm) >>
2024-06-12 13:10:08:INFO:M: >>  Has0_acc_2: 0.4934  Has0_F1_score: 0.4468  Non0_acc_2: 0.5139  Non0_F1_score: 0.4672  Mult_acc_5: 0.2009  Mult_acc_7: 0.1703  MAE: 1.7628  Corr: 0.1323 
2024-06-12 13:10:15:INFO:TEST-(cmcm) >>
2024-06-12 13:10:15:INFO:M: >>  Has0_acc_2: 0.4534  Has0_F1_score: 0.2943  Non0_acc_2: 0.5579  Non0_F1_score: 0.4760  Mult_acc_5: 0.1545  Mult_acc_7: 0.1545  MAE: 1.4349  Corr: 0.0480 
2024-06-12 13:10:16:INFO:Results are added to results/results/mosi-regression-50.csv...
2024-06-12 13:10:16:INFO:Start running cmcm...
2024-06-12 13:10:16:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 50, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 4444}>
2024-06-12 13:10:16:INFO:Let's use the GPU 1 !
2024-06-12 13:10:16:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 13:10:16:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718169016 HTTP/1.1" 200 235
2024-06-12 13:10:16:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 13:10:17:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 13:10:18:INFO:train samples: (1284,)
2024-06-12 13:10:18:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 13:10:18:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718169018 HTTP/1.1" 200 235
2024-06-12 13:10:18:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 13:10:19:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 13:10:19:INFO:valid samples: (229,)
2024-06-12 13:10:20:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 13:10:20:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718169020 HTTP/1.1" 200 235
2024-06-12 13:10:20:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 13:10:20:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 13:10:21:INFO:test samples: (686,)
2024-06-12 13:10:21:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 13:10:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718169022 HTTP/1.1" 200 235
2024-06-12 13:10:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 13:10:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 13:10:23:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 13:10:23:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718169023 HTTP/1.1" 200 235
2024-06-12 13:10:23:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 13:10:24:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 13:10:24:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-12 13:10:24:WARNING:Try importing flash-attention for faster inference...
2024-06-12 13:10:24:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-12 13:10:24:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-12 13:10:24:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-12 13:10:25:INFO:trainable params: 1310284 || all params: 1838138956 || trainable%: 0.07128318540461856
2024-06-12 13:10:25:INFO:Init labels...
2024-06-12 13:10:25:INFO:Start training...
2024-06-12 13:10:41:INFO:TRAIN-(cmcm) (1/1/4)>> loss: 3.6951
2024-06-12 13:10:43:INFO:VAL-(cmcm) >>
2024-06-12 13:10:43:INFO:M: >>  Has0_acc_2: 0.5415  Has0_F1_score: 0.4931  Non0_acc_2: 0.4815  Non0_F1_score: 0.4655  Mult_acc_5: 0.1528  Mult_acc_7: 0.1528  MAE: 1.5969  Corr: -0.0949 
2024-06-12 13:10:44:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-12 13:10:59:INFO:TRAIN-(cmcm) (1/2/4)>> loss: 1.1428
2024-06-12 13:11:01:INFO:VAL-(cmcm) >>
2024-06-12 13:11:01:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5833  Non0_F1_score: 0.4393  Mult_acc_5: 0.1790  Mult_acc_7: 0.1790  MAE: 1.4667  Corr: 0.0121 
2024-06-12 13:11:02:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-12 13:11:17:INFO:TRAIN-(cmcm) (1/3/4)>> loss: 1.2603
2024-06-12 13:11:19:INFO:VAL-(cmcm) >>
2024-06-12 13:11:19:INFO:M: >>  Has0_acc_2: 0.4410  Has0_F1_score: 0.4372  Non0_acc_2: 0.4491  Non0_F1_score: 0.4206  Mult_acc_5: 0.1790  Mult_acc_7: 0.1790  MAE: 1.7069  Corr: -0.0925 
2024-06-12 13:11:34:INFO:TRAIN-(cmcm) (2/4/4)>> loss: 1.0388
2024-06-12 13:11:37:INFO:VAL-(cmcm) >>
2024-06-12 13:11:37:INFO:M: >>  Has0_acc_2: 0.5328  Has0_F1_score: 0.4798  Non0_acc_2: 0.5139  Non0_F1_score: 0.4621  Mult_acc_5: 0.1616  Mult_acc_7: 0.1616  MAE: 1.5397  Corr: -0.0686 
2024-06-12 13:11:51:INFO:TRAIN-(cmcm) (3/5/4)>> loss: 0.9857
2024-06-12 13:11:54:INFO:VAL-(cmcm) >>
2024-06-12 13:11:54:INFO:M: >>  Has0_acc_2: 0.5109  Has0_F1_score: 0.4825  Non0_acc_2: 0.5046  Non0_F1_score: 0.5035  Mult_acc_5: 0.2664  Mult_acc_7: 0.2052  MAE: 1.7122  Corr: -0.0656 
2024-06-12 13:12:09:INFO:TRAIN-(cmcm) (4/6/4)>> loss: 0.9532
2024-06-12 13:12:11:INFO:VAL-(cmcm) >>
2024-06-12 13:12:11:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.5263  Non0_acc_2: 0.5694  Non0_F1_score: 0.5052  Mult_acc_5: 0.1878  Mult_acc_7: 0.1878  MAE: 1.5490  Corr: -0.0968 
2024-06-12 13:12:26:INFO:TRAIN-(cmcm) (5/7/4)>> loss: 0.9254
2024-06-12 13:12:28:INFO:VAL-(cmcm) >>
2024-06-12 13:12:28:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5424  Non0_acc_2: 0.5602  Non0_F1_score: 0.5283  Mult_acc_5: 0.2751  Mult_acc_7: 0.2052  MAE: 1.7271  Corr: -0.0052 
2024-06-12 13:12:43:INFO:TRAIN-(cmcm) (6/8/4)>> loss: 0.9142
2024-06-12 13:12:46:INFO:VAL-(cmcm) >>
2024-06-12 13:12:46:INFO:M: >>  Has0_acc_2: 0.5328  Has0_F1_score: 0.5357  Non0_acc_2: 0.5417  Non0_F1_score: 0.5420  Mult_acc_5: 0.2140  Mult_acc_7: 0.2096  MAE: 1.6305  Corr: 0.0309 
2024-06-12 13:13:00:INFO:TRAIN-(cmcm) (7/9/4)>> loss: 0.8881
2024-06-12 13:13:03:INFO:VAL-(cmcm) >>
2024-06-12 13:13:03:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5762  Non0_acc_2: 0.6019  Non0_F1_score: 0.6040  Mult_acc_5: 0.2358  Mult_acc_7: 0.2227  MAE: 1.5497  Corr: 0.1773 
2024-06-12 13:13:17:INFO:TRAIN-(cmcm) (8/10/4)>> loss: 0.8741
2024-06-12 13:13:20:INFO:VAL-(cmcm) >>
2024-06-12 13:13:20:INFO:M: >>  Has0_acc_2: 0.5590  Has0_F1_score: 0.5630  Non0_acc_2: 0.5741  Non0_F1_score: 0.5758  Mult_acc_5: 0.2576  Mult_acc_7: 0.1878  MAE: 1.6673  Corr: 0.1176 
2024-06-12 13:13:35:INFO:TRAIN-(cmcm) (9/11/4)>> loss: 0.8658
2024-06-12 13:13:37:INFO:VAL-(cmcm) >>
2024-06-12 13:13:37:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.5785  Non0_acc_2: 0.5926  Non0_F1_score: 0.5666  Mult_acc_5: 0.2882  Mult_acc_7: 0.2096  MAE: 1.6079  Corr: 0.1307 
2024-06-12 13:13:52:INFO:TRAIN-(cmcm) (10/12/4)>> loss: 0.8652
2024-06-12 13:13:54:INFO:VAL-(cmcm) >>
2024-06-12 13:13:54:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5957  Non0_acc_2: 0.5278  Non0_F1_score: 0.5000  Mult_acc_5: 0.2358  Mult_acc_7: 0.1921  MAE: 1.6293  Corr: 0.2228 
2024-06-12 13:14:02:INFO:TEST-(cmcm) >>
2024-06-12 13:14:02:INFO:M: >>  Has0_acc_2: 0.4504  Has0_F1_score: 0.2881  Non0_acc_2: 0.4223  Non0_F1_score: 0.2711  Mult_acc_5: 0.1633  Mult_acc_7: 0.1633  MAE: 1.7318  Corr: -0.0015 
2024-06-12 13:14:02:INFO:Results are added to results/results/mosi-regression-50.csv...
2024-06-12 13:14:02:INFO:Start running cmcm...
2024-06-12 13:14:02:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 50, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 5555}>
2024-06-12 13:14:02:INFO:Let's use the GPU 1 !
2024-06-12 13:14:02:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 13:14:03:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718169243 HTTP/1.1" 200 235
2024-06-12 13:14:03:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 13:14:03:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 13:14:04:INFO:train samples: (1284,)
2024-06-12 13:14:04:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 13:14:05:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718169245 HTTP/1.1" 200 235
2024-06-12 13:14:05:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 13:14:05:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 13:14:06:INFO:valid samples: (229,)
2024-06-12 13:14:06:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 13:14:07:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718169247 HTTP/1.1" 200 235
2024-06-12 13:14:07:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 13:14:07:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 13:14:08:INFO:test samples: (686,)
2024-06-12 13:14:08:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 13:14:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718169249 HTTP/1.1" 200 235
2024-06-12 13:14:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 13:14:09:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 13:14:09:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 13:14:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718169250 HTTP/1.1" 200 235
2024-06-12 13:14:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 13:14:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 13:14:10:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-12 13:14:10:WARNING:Try importing flash-attention for faster inference...
2024-06-12 13:14:10:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-12 13:14:10:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-12 13:14:10:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-12 13:14:12:INFO:trainable params: 1310284 || all params: 1838138956 || trainable%: 0.07128318540461856
2024-06-12 13:14:12:INFO:Init labels...
2024-06-12 13:14:12:INFO:Start training...
2024-06-12 13:14:26:INFO:TRAIN-(cmcm) (1/1/5)>> loss: 3.2279
2024-06-12 13:14:29:INFO:VAL-(cmcm) >>
2024-06-12 13:14:29:INFO:M: >>  Has0_acc_2: 0.5415  Has0_F1_score: 0.5402  Non0_acc_2: 0.5093  Non0_F1_score: 0.5113  Mult_acc_5: 0.2140  Mult_acc_7: 0.2140  MAE: 1.4737  Corr: 0.0217 
2024-06-12 13:14:29:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-12 13:14:45:INFO:TRAIN-(cmcm) (1/2/5)>> loss: 1.0779
2024-06-12 13:14:47:INFO:VAL-(cmcm) >>
2024-06-12 13:14:47:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4700  Non0_acc_2: 0.5741  Non0_F1_score: 0.4491  Mult_acc_5: 0.1703  Mult_acc_7: 0.1703  MAE: 1.4772  Corr: -0.0130 
2024-06-12 13:15:02:INFO:TRAIN-(cmcm) (2/3/5)>> loss: 0.9389
2024-06-12 13:15:04:INFO:VAL-(cmcm) >>
2024-06-12 13:15:05:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4556  Non0_acc_2: 0.5787  Non0_F1_score: 0.4445  Mult_acc_5: 0.2358  Mult_acc_7: 0.1878  MAE: 1.5595  Corr: 0.0624 
2024-06-12 13:15:19:INFO:TRAIN-(cmcm) (3/4/5)>> loss: 0.8897
2024-06-12 13:15:22:INFO:VAL-(cmcm) >>
2024-06-12 13:15:22:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5787  Non0_F1_score: 0.4584  Mult_acc_5: 0.1747  Mult_acc_7: 0.1747  MAE: 1.5625  Corr: -0.0249 
2024-06-12 13:15:37:INFO:TRAIN-(cmcm) (4/5/5)>> loss: 0.8769
2024-06-12 13:15:39:INFO:VAL-(cmcm) >>
2024-06-12 13:15:39:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4723  Non0_acc_2: 0.5833  Non0_F1_score: 0.4542  Mult_acc_5: 0.1703  Mult_acc_7: 0.1703  MAE: 1.4694  Corr: 0.0330 
2024-06-12 13:15:39:INFO:Saving checkpoint at epoch 5 to results/models/cmcm-mosi-regression.pth.
2024-06-12 13:15:54:INFO:TRAIN-(cmcm) (1/6/5)>> loss: 0.8710
2024-06-12 13:15:57:INFO:VAL-(cmcm) >>
2024-06-12 13:15:57:INFO:M: >>  Has0_acc_2: 0.5502  Has0_F1_score: 0.5027  Non0_acc_2: 0.5370  Non0_F1_score: 0.4895  Mult_acc_5: 0.1747  Mult_acc_7: 0.1747  MAE: 1.5948  Corr: -0.0126 
2024-06-12 13:16:12:INFO:TRAIN-(cmcm) (2/7/5)>> loss: 0.8678
2024-06-12 13:16:14:INFO:VAL-(cmcm) >>
2024-06-12 13:16:14:INFO:M: >>  Has0_acc_2: 0.5459  Has0_F1_score: 0.5282  Non0_acc_2: 0.5417  Non0_F1_score: 0.5207  Mult_acc_5: 0.2795  Mult_acc_7: 0.2096  MAE: 1.6451  Corr: 0.0204 
2024-06-12 13:16:29:INFO:TRAIN-(cmcm) (3/8/5)>> loss: 0.8643
2024-06-12 13:16:32:INFO:VAL-(cmcm) >>
2024-06-12 13:16:32:INFO:M: >>  Has0_acc_2: 0.4672  Has0_F1_score: 0.4080  Non0_acc_2: 0.4907  Non0_F1_score: 0.4331  Mult_acc_5: 0.2096  Mult_acc_7: 0.1834  MAE: 1.7637  Corr: 0.0904 
2024-06-12 13:16:46:INFO:TRAIN-(cmcm) (4/9/5)>> loss: 0.8608
2024-06-12 13:16:49:INFO:VAL-(cmcm) >>
2024-06-12 13:16:49:INFO:M: >>  Has0_acc_2: 0.5590  Has0_F1_score: 0.5632  Non0_acc_2: 0.5694  Non0_F1_score: 0.5718  Mult_acc_5: 0.2620  Mult_acc_7: 0.1921  MAE: 1.6961  Corr: 0.1407 
2024-06-12 13:17:04:INFO:TRAIN-(cmcm) (5/10/5)>> loss: 0.8573
2024-06-12 13:17:06:INFO:VAL-(cmcm) >>
2024-06-12 13:17:06:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.4968  Non0_acc_2: 0.5880  Non0_F1_score: 0.4703  Mult_acc_5: 0.2402  Mult_acc_7: 0.1834  MAE: 1.5852  Corr: 0.0118 
2024-06-12 13:17:21:INFO:TRAIN-(cmcm) (6/11/5)>> loss: 0.8522
2024-06-12 13:17:23:INFO:VAL-(cmcm) >>
2024-06-12 13:17:23:INFO:M: >>  Has0_acc_2: 0.5022  Has0_F1_score: 0.5064  Non0_acc_2: 0.5185  Non0_F1_score: 0.5202  Mult_acc_5: 0.2271  Mult_acc_7: 0.1921  MAE: 1.7149  Corr: 0.0229 
2024-06-12 13:17:38:INFO:TRAIN-(cmcm) (7/12/5)>> loss: 0.8534
2024-06-12 13:17:41:INFO:VAL-(cmcm) >>
2024-06-12 13:17:41:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4866  Non0_acc_2: 0.5694  Non0_F1_score: 0.4595  Mult_acc_5: 0.2969  Mult_acc_7: 0.2183  MAE: 1.7468  Corr: 0.0029 
2024-06-12 13:17:55:INFO:TRAIN-(cmcm) (8/13/5)>> loss: 0.8456
2024-06-12 13:17:58:INFO:VAL-(cmcm) >>
2024-06-12 13:17:58:INFO:M: >>  Has0_acc_2: 0.6245  Has0_F1_score: 0.5804  Non0_acc_2: 0.6296  Non0_F1_score: 0.5943  Mult_acc_5: 0.3275  Mult_acc_7: 0.2489  MAE: 1.4739  Corr: 0.2789 
2024-06-12 13:18:13:INFO:TRAIN-(cmcm) (9/14/5)>> loss: 0.8428
2024-06-12 13:18:15:INFO:VAL-(cmcm) >>
2024-06-12 13:18:15:INFO:M: >>  Has0_acc_2: 0.5459  Has0_F1_score: 0.5119  Non0_acc_2: 0.5694  Non0_F1_score: 0.5360  Mult_acc_5: 0.2096  Mult_acc_7: 0.1441  MAE: 1.6223  Corr: 0.3201 
2024-06-12 13:18:30:INFO:TRAIN-(cmcm) (10/15/5)>> loss: 0.8224
2024-06-12 13:18:33:INFO:VAL-(cmcm) >>
2024-06-12 13:18:33:INFO:M: >>  Has0_acc_2: 0.6376  Has0_F1_score: 0.5565  Non0_acc_2: 0.5602  Non0_F1_score: 0.5624  Mult_acc_5: 0.2926  Mult_acc_7: 0.2402  MAE: 1.4079  Corr: 0.2092 
2024-06-12 13:18:33:INFO:Saving checkpoint at epoch 15 to results/models/cmcm-mosi-regression.pth.
2024-06-12 13:18:48:INFO:TRAIN-(cmcm) (1/16/5)>> loss: 0.8114
2024-06-12 13:18:51:INFO:VAL-(cmcm) >>
2024-06-12 13:18:51:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.6062  Non0_acc_2: 0.6019  Non0_F1_score: 0.6024  Mult_acc_5: 0.2489  Mult_acc_7: 0.1965  MAE: 1.3953  Corr: 0.3440 
2024-06-12 13:18:51:INFO:Saving checkpoint at epoch 16 to results/models/cmcm-mosi-regression.pth.
2024-06-12 13:19:06:INFO:TRAIN-(cmcm) (1/17/5)>> loss: 0.7972
2024-06-12 13:19:08:INFO:VAL-(cmcm) >>
2024-06-12 13:19:08:INFO:M: >>  Has0_acc_2: 0.6332  Has0_F1_score: 0.6351  Non0_acc_2: 0.6389  Non0_F1_score: 0.6389  Mult_acc_5: 0.2926  Mult_acc_7: 0.2358  MAE: 1.3507  Corr: 0.3841 
2024-06-12 13:19:09:INFO:Saving checkpoint at epoch 17 to results/models/cmcm-mosi-regression.pth.
2024-06-12 13:19:24:INFO:TRAIN-(cmcm) (1/18/5)>> loss: 0.7930
2024-06-12 13:19:26:INFO:VAL-(cmcm) >>
2024-06-12 13:19:26:INFO:M: >>  Has0_acc_2: 0.6288  Has0_F1_score: 0.6324  Non0_acc_2: 0.6620  Non0_F1_score: 0.6638  Mult_acc_5: 0.3493  Mult_acc_7: 0.2664  MAE: 1.3429  Corr: 0.3819 
2024-06-12 13:19:26:INFO:Saving checkpoint at epoch 18 to results/models/cmcm-mosi-regression.pth.
2024-06-12 13:19:41:INFO:TRAIN-(cmcm) (1/19/5)>> loss: 0.7805
2024-06-12 13:19:44:INFO:VAL-(cmcm) >>
2024-06-12 13:19:44:INFO:M: >>  Has0_acc_2: 0.6638  Has0_F1_score: 0.6621  Non0_acc_2: 0.6343  Non0_F1_score: 0.6328  Mult_acc_5: 0.2882  Mult_acc_7: 0.2271  MAE: 1.2765  Corr: 0.4246 
2024-06-12 13:19:44:INFO:Saving checkpoint at epoch 19 to results/models/cmcm-mosi-regression.pth.
2024-06-12 13:19:59:INFO:TRAIN-(cmcm) (1/20/5)>> loss: 0.7766
2024-06-12 13:20:02:INFO:VAL-(cmcm) >>
2024-06-12 13:20:02:INFO:M: >>  Has0_acc_2: 0.6725  Has0_F1_score: 0.6733  Non0_acc_2: 0.7037  Non0_F1_score: 0.7033  Mult_acc_5: 0.3450  Mult_acc_7: 0.2664  MAE: 1.3210  Corr: 0.4360 
2024-06-12 13:20:16:INFO:TRAIN-(cmcm) (2/21/5)>> loss: 0.7609
2024-06-12 13:20:19:INFO:VAL-(cmcm) >>
2024-06-12 13:20:19:INFO:M: >>  Has0_acc_2: 0.6550  Has0_F1_score: 0.6578  Non0_acc_2: 0.6713  Non0_F1_score: 0.6725  Mult_acc_5: 0.3450  Mult_acc_7: 0.2533  MAE: 1.4101  Corr: 0.3810 
2024-06-12 13:20:34:INFO:TRAIN-(cmcm) (3/22/5)>> loss: 0.7542
2024-06-12 13:20:36:INFO:VAL-(cmcm) >>
2024-06-12 13:20:36:INFO:M: >>  Has0_acc_2: 0.6900  Has0_F1_score: 0.6869  Non0_acc_2: 0.7083  Non0_F1_score: 0.7059  Mult_acc_5: 0.3100  Mult_acc_7: 0.2489  MAE: 1.2354  Corr: 0.4453 
2024-06-12 13:20:37:INFO:Saving checkpoint at epoch 22 to results/models/cmcm-mosi-regression.pth.
2024-06-12 13:20:52:INFO:TRAIN-(cmcm) (1/23/5)>> loss: 0.7479
2024-06-12 13:20:54:INFO:VAL-(cmcm) >>
2024-06-12 13:20:54:INFO:M: >>  Has0_acc_2: 0.7031  Has0_F1_score: 0.6971  Non0_acc_2: 0.6944  Non0_F1_score: 0.6961  Mult_acc_5: 0.3275  Mult_acc_7: 0.2533  MAE: 1.2110  Corr: 0.4701 
2024-06-12 13:20:54:INFO:Saving checkpoint at epoch 23 to results/models/cmcm-mosi-regression.pth.
2024-06-12 13:21:09:INFO:TRAIN-(cmcm) (1/24/5)>> loss: 0.7538
2024-06-12 13:21:12:INFO:VAL-(cmcm) >>
2024-06-12 13:21:12:INFO:M: >>  Has0_acc_2: 0.6550  Has0_F1_score: 0.6537  Non0_acc_2: 0.5648  Non0_F1_score: 0.5347  Mult_acc_5: 0.2751  Mult_acc_7: 0.2271  MAE: 1.3440  Corr: 0.4355 
2024-06-12 13:21:27:INFO:TRAIN-(cmcm) (2/25/5)>> loss: 0.7372
2024-06-12 13:21:29:INFO:VAL-(cmcm) >>
2024-06-12 13:21:29:INFO:M: >>  Has0_acc_2: 0.6419  Has0_F1_score: 0.6450  Non0_acc_2: 0.6157  Non0_F1_score: 0.6127  Mult_acc_5: 0.3231  Mult_acc_7: 0.2314  MAE: 1.3747  Corr: 0.4332 
2024-06-12 13:21:44:INFO:TRAIN-(cmcm) (3/26/5)>> loss: 0.7261
2024-06-12 13:21:46:INFO:VAL-(cmcm) >>
2024-06-12 13:21:46:INFO:M: >>  Has0_acc_2: 0.6681  Has0_F1_score: 0.6644  Non0_acc_2: 0.6944  Non0_F1_score: 0.6900  Mult_acc_5: 0.3493  Mult_acc_7: 0.2751  MAE: 1.2582  Corr: 0.4476 
2024-06-12 13:22:01:INFO:TRAIN-(cmcm) (4/27/5)>> loss: 0.7232
2024-06-12 13:22:04:INFO:VAL-(cmcm) >>
2024-06-12 13:22:04:INFO:M: >>  Has0_acc_2: 0.6900  Has0_F1_score: 0.6930  Non0_acc_2: 0.7083  Non0_F1_score: 0.7098  Mult_acc_5: 0.3450  Mult_acc_7: 0.2620  MAE: 1.2625  Corr: 0.4715 
2024-06-12 13:22:18:INFO:TRAIN-(cmcm) (5/28/5)>> loss: 0.7180
2024-06-12 13:22:21:INFO:VAL-(cmcm) >>
2024-06-12 13:22:21:INFO:M: >>  Has0_acc_2: 0.7074  Has0_F1_score: 0.7077  Non0_acc_2: 0.6898  Non0_F1_score: 0.6915  Mult_acc_5: 0.3493  Mult_acc_7: 0.2620  MAE: 1.2088  Corr: 0.4859 
2024-06-12 13:22:21:INFO:Saving checkpoint at epoch 28 to results/models/cmcm-mosi-regression.pth.
2024-06-12 13:22:36:INFO:TRAIN-(cmcm) (1/29/5)>> loss: 0.7055
2024-06-12 13:22:39:INFO:VAL-(cmcm) >>
2024-06-12 13:22:39:INFO:M: >>  Has0_acc_2: 0.6638  Has0_F1_score: 0.6667  Non0_acc_2: 0.6667  Non0_F1_score: 0.6685  Mult_acc_5: 0.3362  Mult_acc_7: 0.2533  MAE: 1.3014  Corr: 0.4455 
2024-06-12 13:22:53:INFO:TRAIN-(cmcm) (2/30/5)>> loss: 0.6960
2024-06-12 13:22:56:INFO:VAL-(cmcm) >>
2024-06-12 13:22:56:INFO:M: >>  Has0_acc_2: 0.6463  Has0_F1_score: 0.6479  Non0_acc_2: 0.6713  Non0_F1_score: 0.6715  Mult_acc_5: 0.3319  Mult_acc_7: 0.2489  MAE: 1.3053  Corr: 0.4631 
2024-06-12 13:23:11:INFO:TRAIN-(cmcm) (3/31/5)>> loss: 0.6975
2024-06-12 13:23:13:INFO:VAL-(cmcm) >>
2024-06-12 13:23:13:INFO:M: >>  Has0_acc_2: 0.7118  Has0_F1_score: 0.7140  Non0_acc_2: 0.7176  Non0_F1_score: 0.7189  Mult_acc_5: 0.3930  Mult_acc_7: 0.2969  MAE: 1.1988  Corr: 0.5028 
2024-06-12 13:23:14:INFO:Saving checkpoint at epoch 31 to results/models/cmcm-mosi-regression.pth.
2024-06-12 13:23:29:INFO:TRAIN-(cmcm) (1/32/5)>> loss: 0.6869
2024-06-12 13:23:31:INFO:VAL-(cmcm) >>
2024-06-12 13:23:31:INFO:M: >>  Has0_acc_2: 0.7249  Has0_F1_score: 0.7215  Non0_acc_2: 0.7130  Non0_F1_score: 0.7130  Mult_acc_5: 0.3537  Mult_acc_7: 0.2795  MAE: 1.1538  Corr: 0.5012 
2024-06-12 13:23:31:INFO:Saving checkpoint at epoch 32 to results/models/cmcm-mosi-regression.pth.
2024-06-12 13:23:47:INFO:TRAIN-(cmcm) (1/33/5)>> loss: 0.6746
2024-06-12 13:23:50:INFO:VAL-(cmcm) >>
2024-06-12 13:23:50:INFO:M: >>  Has0_acc_2: 0.6856  Has0_F1_score: 0.6856  Non0_acc_2: 0.7083  Non0_F1_score: 0.7071  Mult_acc_5: 0.3755  Mult_acc_7: 0.3057  MAE: 1.1765  Corr: 0.4753 
2024-06-12 13:24:05:INFO:TRAIN-(cmcm) (2/34/5)>> loss: 0.6639
2024-06-12 13:24:07:INFO:VAL-(cmcm) >>
2024-06-12 13:24:07:INFO:M: >>  Has0_acc_2: 0.6943  Has0_F1_score: 0.6811  Non0_acc_2: 0.6991  Non0_F1_score: 0.6853  Mult_acc_5: 0.3755  Mult_acc_7: 0.2926  MAE: 1.3228  Corr: 0.4337 
2024-06-12 13:24:22:INFO:TRAIN-(cmcm) (3/35/5)>> loss: 0.6687
2024-06-12 13:24:25:INFO:VAL-(cmcm) >>
2024-06-12 13:24:25:INFO:M: >>  Has0_acc_2: 0.7162  Has0_F1_score: 0.7159  Non0_acc_2: 0.7315  Non0_F1_score: 0.7296  Mult_acc_5: 0.3886  Mult_acc_7: 0.3013  MAE: 1.2154  Corr: 0.4962 
2024-06-12 13:24:39:INFO:TRAIN-(cmcm) (4/36/5)>> loss: 0.6462
2024-06-12 13:24:42:INFO:VAL-(cmcm) >>
2024-06-12 13:24:42:INFO:M: >>  Has0_acc_2: 0.6900  Has0_F1_score: 0.6891  Non0_acc_2: 0.7222  Non0_F1_score: 0.7222  Mult_acc_5: 0.3799  Mult_acc_7: 0.2838  MAE: 1.2320  Corr: 0.4943 
2024-06-12 13:24:56:INFO:TRAIN-(cmcm) (5/37/5)>> loss: 0.6489
2024-06-12 13:24:59:INFO:VAL-(cmcm) >>
2024-06-12 13:24:59:INFO:M: >>  Has0_acc_2: 0.6987  Has0_F1_score: 0.6999  Non0_acc_2: 0.6991  Non0_F1_score: 0.7002  Mult_acc_5: 0.3493  Mult_acc_7: 0.2838  MAE: 1.1864  Corr: 0.4949 
2024-06-12 13:25:14:INFO:TRAIN-(cmcm) (6/38/5)>> loss: 0.6424
2024-06-12 13:25:16:INFO:VAL-(cmcm) >>
2024-06-12 13:25:16:INFO:M: >>  Has0_acc_2: 0.6812  Has0_F1_score: 0.6843  Non0_acc_2: 0.6944  Non0_F1_score: 0.6960  Mult_acc_5: 0.3537  Mult_acc_7: 0.2838  MAE: 1.1940  Corr: 0.4884 
2024-06-12 13:25:31:INFO:TRAIN-(cmcm) (7/39/5)>> loss: 0.6281
2024-06-12 13:25:33:INFO:VAL-(cmcm) >>
2024-06-12 13:25:33:INFO:M: >>  Has0_acc_2: 0.7293  Has0_F1_score: 0.7308  Non0_acc_2: 0.7222  Non0_F1_score: 0.7238  Mult_acc_5: 0.3799  Mult_acc_7: 0.3144  MAE: 1.1340  Corr: 0.5323 
2024-06-12 13:25:34:INFO:Saving checkpoint at epoch 39 to results/models/cmcm-mosi-regression.pth.
2024-06-12 13:25:49:INFO:TRAIN-(cmcm) (1/40/5)>> loss: 0.6236
2024-06-12 13:25:51:INFO:VAL-(cmcm) >>
2024-06-12 13:25:51:INFO:M: >>  Has0_acc_2: 0.7162  Has0_F1_score: 0.7134  Non0_acc_2: 0.7176  Non0_F1_score: 0.7139  Mult_acc_5: 0.3843  Mult_acc_7: 0.2969  MAE: 1.2001  Corr: 0.4822 
2024-06-12 13:26:06:INFO:TRAIN-(cmcm) (2/41/5)>> loss: 0.6171
2024-06-12 13:26:08:INFO:VAL-(cmcm) >>
2024-06-12 13:26:08:INFO:M: >>  Has0_acc_2: 0.7031  Has0_F1_score: 0.7044  Non0_acc_2: 0.7222  Non0_F1_score: 0.7234  Mult_acc_5: 0.3624  Mult_acc_7: 0.2795  MAE: 1.1800  Corr: 0.5018 
2024-06-12 13:26:23:INFO:TRAIN-(cmcm) (3/42/5)>> loss: 0.6090
2024-06-12 13:26:26:INFO:VAL-(cmcm) >>
2024-06-12 13:26:26:INFO:M: >>  Has0_acc_2: 0.7162  Has0_F1_score: 0.7164  Non0_acc_2: 0.7269  Non0_F1_score: 0.7270  Mult_acc_5: 0.3712  Mult_acc_7: 0.2795  MAE: 1.1586  Corr: 0.5135 
2024-06-12 13:26:40:INFO:TRAIN-(cmcm) (4/43/5)>> loss: 0.6029
2024-06-12 13:26:43:INFO:VAL-(cmcm) >>
2024-06-12 13:26:43:INFO:M: >>  Has0_acc_2: 0.7031  Has0_F1_score: 0.7031  Non0_acc_2: 0.7083  Non0_F1_score: 0.7092  Mult_acc_5: 0.3537  Mult_acc_7: 0.2751  MAE: 1.2079  Corr: 0.4940 
2024-06-12 13:26:57:INFO:TRAIN-(cmcm) (5/44/5)>> loss: 0.5978
2024-06-12 13:27:00:INFO:VAL-(cmcm) >>
2024-06-12 13:27:00:INFO:M: >>  Has0_acc_2: 0.7031  Has0_F1_score: 0.7036  Non0_acc_2: 0.7176  Non0_F1_score: 0.7181  Mult_acc_5: 0.3799  Mult_acc_7: 0.2969  MAE: 1.2162  Corr: 0.4824 
2024-06-12 13:27:14:INFO:TRAIN-(cmcm) (6/45/5)>> loss: 0.5930
2024-06-12 13:27:17:INFO:VAL-(cmcm) >>
2024-06-12 13:27:17:INFO:M: >>  Has0_acc_2: 0.7074  Has0_F1_score: 0.7082  Non0_acc_2: 0.7130  Non0_F1_score: 0.7139  Mult_acc_5: 0.3624  Mult_acc_7: 0.2751  MAE: 1.1887  Corr: 0.4961 
2024-06-12 13:27:32:INFO:TRAIN-(cmcm) (7/46/5)>> loss: 0.5892
2024-06-12 13:27:34:INFO:VAL-(cmcm) >>
2024-06-12 13:27:34:INFO:M: >>  Has0_acc_2: 0.7074  Has0_F1_score: 0.7086  Non0_acc_2: 0.7176  Non0_F1_score: 0.7187  Mult_acc_5: 0.3712  Mult_acc_7: 0.2838  MAE: 1.1983  Corr: 0.4949 
2024-06-12 13:27:49:INFO:TRAIN-(cmcm) (8/47/5)>> loss: 0.5879
2024-06-12 13:27:51:INFO:VAL-(cmcm) >>
2024-06-12 13:27:51:INFO:M: >>  Has0_acc_2: 0.7118  Has0_F1_score: 0.7113  Non0_acc_2: 0.7176  Non0_F1_score: 0.7178  Mult_acc_5: 0.3712  Mult_acc_7: 0.2926  MAE: 1.1726  Corr: 0.5010 
2024-06-12 13:28:06:INFO:TRAIN-(cmcm) (9/48/5)>> loss: 0.5849
2024-06-12 13:28:08:INFO:VAL-(cmcm) >>
2024-06-12 13:28:08:INFO:M: >>  Has0_acc_2: 0.7118  Has0_F1_score: 0.7123  Non0_acc_2: 0.7176  Non0_F1_score: 0.7181  Mult_acc_5: 0.3712  Mult_acc_7: 0.2926  MAE: 1.1948  Corr: 0.4890 
2024-06-12 13:28:23:INFO:TRAIN-(cmcm) (10/49/5)>> loss: 0.5841
2024-06-12 13:28:26:INFO:VAL-(cmcm) >>
2024-06-12 13:28:26:INFO:M: >>  Has0_acc_2: 0.7074  Has0_F1_score: 0.7082  Non0_acc_2: 0.7222  Non0_F1_score: 0.7226  Mult_acc_5: 0.3755  Mult_acc_7: 0.2969  MAE: 1.1935  Corr: 0.4877 
2024-06-12 13:28:33:INFO:TEST-(cmcm) >>
2024-06-12 13:28:33:INFO:M: >>  Has0_acc_2: 0.7128  Has0_F1_score: 0.7127  Non0_acc_2: 0.7302  Non0_F1_score: 0.7256  Mult_acc_5: 0.3630  Mult_acc_7: 0.3149  MAE: 1.0957  Corr: 0.5091 
2024-06-12 13:28:33:INFO:Results are added to results/results/mosi-regression-50.csv...
2024-06-12 13:28:33:INFO:Start running cmcm...
2024-06-12 13:28:33:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 60, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-06-12 13:28:33:INFO:Let's use the GPU 1 !
2024-06-12 13:28:33:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 13:28:34:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718170114 HTTP/1.1" 200 235
2024-06-12 13:28:34:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 13:28:34:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 13:28:35:INFO:train samples: (1284,)
2024-06-12 13:28:35:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 13:28:36:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718170116 HTTP/1.1" 200 235
2024-06-12 13:28:36:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 13:28:37:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 13:28:37:INFO:valid samples: (229,)
2024-06-12 13:28:37:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 13:28:38:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718170118 HTTP/1.1" 200 235
2024-06-12 13:28:38:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 13:28:38:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 13:28:39:INFO:test samples: (686,)
2024-06-12 13:28:39:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 13:28:39:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718170119 HTTP/1.1" 200 235
2024-06-12 13:28:39:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 13:28:40:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 13:28:40:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 13:28:41:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718170121 HTTP/1.1" 200 235
2024-06-12 13:28:41:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 13:28:42:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 13:28:42:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-12 13:28:42:WARNING:Try importing flash-attention for faster inference...
2024-06-12 13:28:42:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-12 13:28:42:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-12 13:28:42:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-12 13:28:43:INFO:trainable params: 1310284 || all params: 1838138956 || trainable%: 0.07128318540461856
2024-06-12 13:28:43:INFO:Init labels...
2024-06-12 13:28:43:INFO:Start training...
2024-06-12 13:28:58:INFO:TRAIN-(cmcm) (1/1/1)>> loss: 3.5761
2024-06-12 13:29:01:INFO:VAL-(cmcm) >>
2024-06-12 13:29:01:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5564  Non0_acc_2: 0.5417  Non0_F1_score: 0.5368  Mult_acc_5: 0.1747  Mult_acc_7: 0.1747  MAE: 1.4964  Corr: 0.0319 
2024-06-12 13:29:01:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-12 13:29:16:INFO:TRAIN-(cmcm) (1/2/1)>> loss: 1.0224
2024-06-12 13:29:19:INFO:VAL-(cmcm) >>
2024-06-12 13:29:19:INFO:M: >>  Has0_acc_2: 0.5371  Has0_F1_score: 0.5392  Non0_acc_2: 0.5324  Non0_F1_score: 0.5327  Mult_acc_5: 0.1747  Mult_acc_7: 0.1310  MAE: 1.7852  Corr: 0.0485 
2024-06-12 13:29:34:INFO:TRAIN-(cmcm) (2/3/1)>> loss: 0.9595
2024-06-12 13:29:36:INFO:VAL-(cmcm) >>
2024-06-12 13:29:36:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.5002  Non0_acc_2: 0.5833  Non0_F1_score: 0.4739  Mult_acc_5: 0.2795  Mult_acc_7: 0.2140  MAE: 1.6699  Corr: 0.0544 
2024-06-12 13:29:51:INFO:TRAIN-(cmcm) (3/4/1)>> loss: 0.9140
2024-06-12 13:29:54:INFO:VAL-(cmcm) >>
2024-06-12 13:29:54:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.5499  Non0_acc_2: 0.5556  Non0_F1_score: 0.5362  Mult_acc_5: 0.2183  Mult_acc_7: 0.1747  MAE: 1.7451  Corr: 0.0090 
2024-06-12 13:30:09:INFO:TRAIN-(cmcm) (4/5/1)>> loss: 0.8951
2024-06-12 13:30:11:INFO:VAL-(cmcm) >>
2024-06-12 13:30:11:INFO:M: >>  Has0_acc_2: 0.5371  Has0_F1_score: 0.5304  Non0_acc_2: 0.5509  Non0_F1_score: 0.5429  Mult_acc_5: 0.2489  Mult_acc_7: 0.2009  MAE: 1.6573  Corr: 0.1412 
2024-06-12 13:30:26:INFO:TRAIN-(cmcm) (5/6/1)>> loss: 0.8927
2024-06-12 13:30:29:INFO:VAL-(cmcm) >>
2024-06-12 13:30:29:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5377  Non0_acc_2: 0.5694  Non0_F1_score: 0.5131  Mult_acc_5: 0.2096  Mult_acc_7: 0.1834  MAE: 1.5804  Corr: 0.0049 
2024-06-12 13:30:43:INFO:TRAIN-(cmcm) (6/7/1)>> loss: 0.8863
2024-06-12 13:30:46:INFO:VAL-(cmcm) >>
2024-06-12 13:30:46:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.4943  Non0_acc_2: 0.5694  Non0_F1_score: 0.5356  Mult_acc_5: 0.2751  Mult_acc_7: 0.2183  MAE: 1.5765  Corr: 0.0345 
2024-06-12 13:31:01:INFO:TRAIN-(cmcm) (7/8/1)>> loss: 0.8876
2024-06-12 13:31:03:INFO:VAL-(cmcm) >>
2024-06-12 13:31:03:INFO:M: >>  Has0_acc_2: 0.6201  Has0_F1_score: 0.5740  Non0_acc_2: 0.6019  Non0_F1_score: 0.5548  Mult_acc_5: 0.2664  Mult_acc_7: 0.2140  MAE: 1.5848  Corr: 0.0603 
2024-06-12 13:31:18:INFO:TRAIN-(cmcm) (8/9/1)>> loss: 0.8837
2024-06-12 13:31:20:INFO:VAL-(cmcm) >>
2024-06-12 13:31:20:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.5662  Non0_acc_2: 0.5787  Non0_F1_score: 0.5574  Mult_acc_5: 0.2838  Mult_acc_7: 0.2227  MAE: 1.7402  Corr: 0.0695 
2024-06-12 13:31:36:INFO:TRAIN-(cmcm) (9/10/1)>> loss: 0.8794
2024-06-12 13:31:38:INFO:VAL-(cmcm) >>
2024-06-12 13:31:38:INFO:M: >>  Has0_acc_2: 0.6288  Has0_F1_score: 0.5669  Non0_acc_2: 0.6157  Non0_F1_score: 0.5507  Mult_acc_5: 0.2140  Mult_acc_7: 0.2052  MAE: 1.4886  Corr: 0.1044 
2024-06-12 13:31:38:INFO:Saving checkpoint at epoch 10 to results/models/cmcm-mosi-regression.pth.
2024-06-12 13:31:53:INFO:TRAIN-(cmcm) (1/11/1)>> loss: 0.8705
2024-06-12 13:31:56:INFO:VAL-(cmcm) >>
2024-06-12 13:31:56:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4577  Non0_acc_2: 0.5648  Non0_F1_score: 0.5097  Mult_acc_5: 0.2882  Mult_acc_7: 0.2314  MAE: 1.5999  Corr: 0.0605 
2024-06-12 13:32:11:INFO:TRAIN-(cmcm) (2/12/1)>> loss: 0.8677
2024-06-12 13:32:13:INFO:VAL-(cmcm) >>
2024-06-12 13:32:13:INFO:M: >>  Has0_acc_2: 0.6201  Has0_F1_score: 0.5567  Non0_acc_2: 0.6019  Non0_F1_score: 0.5365  Mult_acc_5: 0.2751  Mult_acc_7: 0.1921  MAE: 1.7372  Corr: 0.1065 
2024-06-12 13:32:28:INFO:TRAIN-(cmcm) (3/13/1)>> loss: 0.8531
2024-06-12 13:32:31:INFO:VAL-(cmcm) >>
2024-06-12 13:32:31:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5822  Non0_acc_2: 0.5787  Non0_F1_score: 0.5732  Mult_acc_5: 0.2969  Mult_acc_7: 0.2227  MAE: 1.5926  Corr: 0.0875 
2024-06-12 13:32:45:INFO:TRAIN-(cmcm) (4/14/1)>> loss: 0.8548
2024-06-12 13:32:48:INFO:VAL-(cmcm) >>
2024-06-12 13:32:48:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5646  Non0_acc_2: 0.5787  Non0_F1_score: 0.5482  Mult_acc_5: 0.2707  Mult_acc_7: 0.1878  MAE: 1.7001  Corr: 0.0551 
2024-06-12 13:33:03:INFO:TRAIN-(cmcm) (5/15/1)>> loss: 0.8541
2024-06-12 13:33:05:INFO:VAL-(cmcm) >>
2024-06-12 13:33:05:INFO:M: >>  Has0_acc_2: 0.6376  Has0_F1_score: 0.5418  Non0_acc_2: 0.6065  Non0_F1_score: 0.5168  Mult_acc_5: 0.3057  Mult_acc_7: 0.2271  MAE: 1.5848  Corr: 0.1185 
2024-06-12 13:33:20:INFO:TRAIN-(cmcm) (6/16/1)>> loss: 0.8429
2024-06-12 13:33:22:INFO:VAL-(cmcm) >>
2024-06-12 13:33:22:INFO:M: >>  Has0_acc_2: 0.6201  Has0_F1_score: 0.6130  Non0_acc_2: 0.6250  Non0_F1_score: 0.6147  Mult_acc_5: 0.2707  Mult_acc_7: 0.2140  MAE: 1.6130  Corr: 0.2716 
2024-06-12 13:33:38:INFO:TRAIN-(cmcm) (7/17/1)>> loss: 0.8451
2024-06-12 13:33:40:INFO:VAL-(cmcm) >>
2024-06-12 13:33:40:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.5511  Non0_acc_2: 0.5694  Non0_F1_score: 0.5585  Mult_acc_5: 0.2489  Mult_acc_7: 0.2052  MAE: 1.5485  Corr: 0.0706 
2024-06-12 13:33:55:INFO:TRAIN-(cmcm) (8/18/1)>> loss: 0.8372
2024-06-12 13:33:58:INFO:VAL-(cmcm) >>
2024-06-12 13:33:58:INFO:M: >>  Has0_acc_2: 0.6201  Has0_F1_score: 0.6236  Non0_acc_2: 0.6296  Non0_F1_score: 0.6315  Mult_acc_5: 0.3100  Mult_acc_7: 0.2271  MAE: 1.6616  Corr: 0.2337 
2024-06-12 13:34:13:INFO:TRAIN-(cmcm) (9/19/1)>> loss: 0.8331
2024-06-12 13:34:16:INFO:VAL-(cmcm) >>
2024-06-12 13:34:16:INFO:M: >>  Has0_acc_2: 0.6507  Has0_F1_score: 0.6303  Non0_acc_2: 0.6481  Non0_F1_score: 0.6295  Mult_acc_5: 0.3231  Mult_acc_7: 0.2402  MAE: 1.5598  Corr: 0.2156 
2024-06-12 13:34:31:INFO:TRAIN-(cmcm) (10/20/1)>> loss: 0.8394
2024-06-12 13:34:33:INFO:VAL-(cmcm) >>
2024-06-12 13:34:33:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5809  Non0_acc_2: 0.6111  Non0_F1_score: 0.5969  Mult_acc_5: 0.2445  Mult_acc_7: 0.2096  MAE: 1.5350  Corr: 0.2307 
2024-06-12 13:34:41:INFO:TEST-(cmcm) >>
2024-06-12 13:34:41:INFO:M: >>  Has0_acc_2: 0.5160  Has0_F1_score: 0.4766  Non0_acc_2: 0.5000  Non0_F1_score: 0.4626  Mult_acc_5: 0.1983  Mult_acc_7: 0.1880  MAE: 1.6935  Corr: 0.1127 
2024-06-12 13:34:41:INFO:Results are added to results/results/mosi-regression-60.csv...
2024-06-12 13:34:41:INFO:Start running cmcm...
2024-06-12 13:34:41:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 60, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 2222}>
2024-06-12 13:34:41:INFO:Let's use the GPU 1 !
2024-06-12 13:34:41:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 13:34:41:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718170482 HTTP/1.1" 200 235
2024-06-12 13:34:42:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 13:34:42:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 13:34:43:INFO:train samples: (1284,)
2024-06-12 13:34:43:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 13:34:43:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718170483 HTTP/1.1" 200 235
2024-06-12 13:34:43:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 13:34:44:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 13:34:44:INFO:valid samples: (229,)
2024-06-12 13:34:45:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 13:34:45:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718170485 HTTP/1.1" 200 235
2024-06-12 13:34:45:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 13:34:45:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 13:34:46:INFO:test samples: (686,)
2024-06-12 13:34:46:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 13:34:46:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718170487 HTTP/1.1" 200 235
2024-06-12 13:34:46:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 13:34:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 13:34:47:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 13:34:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718170488 HTTP/1.1" 200 235
2024-06-12 13:34:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 13:34:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 13:34:48:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-12 13:34:48:WARNING:Try importing flash-attention for faster inference...
2024-06-12 13:34:48:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-12 13:34:48:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-12 13:34:48:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-12 13:34:50:INFO:trainable params: 1310284 || all params: 1838138956 || trainable%: 0.07128318540461856
2024-06-12 13:34:50:INFO:Init labels...
2024-06-12 13:34:50:INFO:Start training...
2024-06-12 13:35:05:INFO:TRAIN-(cmcm) (1/1/2)>> loss: 4.1752
2024-06-12 13:35:08:INFO:VAL-(cmcm) >>
2024-06-12 13:35:08:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4259  Non0_F1_score: 0.2544  Mult_acc_5: 0.2140  Mult_acc_7: 0.2140  MAE: 1.4370  Corr: nan 
2024-06-12 13:35:08:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-12 13:35:24:INFO:TRAIN-(cmcm) (1/2/2)>> loss: 1.6551
2024-06-12 13:35:26:INFO:VAL-(cmcm) >>
2024-06-12 13:35:26:INFO:M: >>  Has0_acc_2: 0.5153  Has0_F1_score: 0.5200  Non0_acc_2: 0.4954  Non0_F1_score: 0.4890  Mult_acc_5: 0.2489  Mult_acc_7: 0.2271  MAE: 1.6921  Corr: -0.0074 
2024-06-12 13:35:41:INFO:TRAIN-(cmcm) (2/3/2)>> loss: 0.9888
2024-06-12 13:35:44:INFO:VAL-(cmcm) >>
2024-06-12 13:35:44:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5042  Non0_acc_2: 0.5741  Non0_F1_score: 0.5042  Mult_acc_5: 0.2183  Mult_acc_7: 0.1965  MAE: 1.6582  Corr: -0.0164 
2024-06-12 13:35:58:INFO:TRAIN-(cmcm) (3/4/2)>> loss: 0.9134
2024-06-12 13:36:01:INFO:VAL-(cmcm) >>
2024-06-12 13:36:01:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5100  Non0_acc_2: 0.5648  Non0_F1_score: 0.4841  Mult_acc_5: 0.1441  Mult_acc_7: 0.1441  MAE: 1.5713  Corr: -0.0337 
2024-06-12 13:36:16:INFO:TRAIN-(cmcm) (4/5/2)>> loss: 0.8901
2024-06-12 13:36:18:INFO:VAL-(cmcm) >>
2024-06-12 13:36:18:INFO:M: >>  Has0_acc_2: 0.5633  Has0_F1_score: 0.5188  Non0_acc_2: 0.5463  Non0_F1_score: 0.4997  Mult_acc_5: 0.1965  Mult_acc_7: 0.1965  MAE: 1.6047  Corr: 0.0010 
2024-06-12 13:36:33:INFO:TRAIN-(cmcm) (5/6/2)>> loss: 0.8926
2024-06-12 13:36:36:INFO:VAL-(cmcm) >>
2024-06-12 13:36:36:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5271  Non0_acc_2: 0.5741  Non0_F1_score: 0.5084  Mult_acc_5: 0.2882  Mult_acc_7: 0.2140  MAE: 1.6726  Corr: 0.0098 
2024-06-12 13:36:50:INFO:TRAIN-(cmcm) (6/7/2)>> loss: 0.8748
2024-06-12 13:36:53:INFO:VAL-(cmcm) >>
2024-06-12 13:36:53:INFO:M: >>  Has0_acc_2: 0.5022  Has0_F1_score: 0.4976  Non0_acc_2: 0.5093  Non0_F1_score: 0.5025  Mult_acc_5: 0.1834  Mult_acc_7: 0.1659  MAE: 1.6564  Corr: 0.0610 
2024-06-12 13:37:08:INFO:TRAIN-(cmcm) (7/8/2)>> loss: 0.8719
2024-06-12 13:37:10:INFO:VAL-(cmcm) >>
2024-06-12 13:37:10:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.5715  Non0_acc_2: 0.5648  Non0_F1_score: 0.5395  Mult_acc_5: 0.3057  Mult_acc_7: 0.2271  MAE: 1.5905  Corr: 0.1032 
2024-06-12 13:37:25:INFO:TRAIN-(cmcm) (8/9/2)>> loss: 0.8663
2024-06-12 13:37:28:INFO:VAL-(cmcm) >>
2024-06-12 13:37:28:INFO:M: >>  Has0_acc_2: 0.4978  Has0_F1_score: 0.4799  Non0_acc_2: 0.5185  Non0_F1_score: 0.5009  Mult_acc_5: 0.2358  Mult_acc_7: 0.1834  MAE: 1.6215  Corr: 0.1813 
2024-06-12 13:37:43:INFO:TRAIN-(cmcm) (9/10/2)>> loss: 0.8670
2024-06-12 13:37:45:INFO:VAL-(cmcm) >>
2024-06-12 13:37:45:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.5216  Non0_acc_2: 0.5694  Non0_F1_score: 0.4871  Mult_acc_5: 0.2926  Mult_acc_7: 0.2140  MAE: 1.6429  Corr: -0.0278 
2024-06-12 13:38:00:INFO:TRAIN-(cmcm) (10/11/2)>> loss: 0.8583
2024-06-12 13:38:03:INFO:VAL-(cmcm) >>
2024-06-12 13:38:03:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.5159  Non0_acc_2: 0.5648  Non0_F1_score: 0.4934  Mult_acc_5: 0.2664  Mult_acc_7: 0.1921  MAE: 1.7944  Corr: -0.0213 
2024-06-12 13:38:10:INFO:TEST-(cmcm) >>
2024-06-12 13:38:10:INFO:M: >>  Has0_acc_2: 0.4475  Has0_F1_score: 0.2767  Non0_acc_2: 0.5777  Non0_F1_score: 0.4258  Mult_acc_5: 0.1545  Mult_acc_7: 0.1545  MAE: 1.4232  Corr: 0.0108 
2024-06-12 13:38:11:INFO:Results are added to results/results/mosi-regression-60.csv...
2024-06-12 13:38:11:INFO:Start running cmcm...
2024-06-12 13:38:11:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 60, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 3333}>
2024-06-12 13:38:11:INFO:Let's use the GPU 1 !
2024-06-12 13:38:11:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 13:38:11:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718170691 HTTP/1.1" 200 235
2024-06-12 13:38:11:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 13:38:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 13:38:13:INFO:train samples: (1284,)
2024-06-12 13:38:13:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 13:38:13:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718170693 HTTP/1.1" 200 235
2024-06-12 13:38:13:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 13:38:14:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 13:38:14:INFO:valid samples: (229,)
2024-06-12 13:38:14:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 13:38:15:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718170695 HTTP/1.1" 200 235
2024-06-12 13:38:15:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 13:38:15:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 13:38:16:INFO:test samples: (686,)
2024-06-12 13:38:16:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 13:38:16:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718170696 HTTP/1.1" 200 235
2024-06-12 13:38:16:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 13:38:17:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 13:38:17:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 13:38:18:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718170698 HTTP/1.1" 200 235
2024-06-12 13:38:18:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 13:38:18:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 13:38:18:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-12 13:38:18:WARNING:Try importing flash-attention for faster inference...
2024-06-12 13:38:18:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-12 13:38:18:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-12 13:38:18:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-12 13:38:20:INFO:trainable params: 1310284 || all params: 1838138956 || trainable%: 0.07128318540461856
2024-06-12 13:38:20:INFO:Init labels...
2024-06-12 13:38:20:INFO:Start training...
2024-06-12 13:38:35:INFO:TRAIN-(cmcm) (1/1/3)>> loss: 4.3063
2024-06-12 13:38:37:INFO:VAL-(cmcm) >>
2024-06-12 13:38:37:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4306  Non0_F1_score: 0.2645  Mult_acc_5: 0.2140  Mult_acc_7: 0.2140  MAE: 1.8632  Corr: 0.0358 
2024-06-12 13:38:37:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-12 13:38:53:INFO:TRAIN-(cmcm) (1/2/3)>> loss: 3.2749
2024-06-12 13:38:55:INFO:VAL-(cmcm) >>
2024-06-12 13:38:55:INFO:M: >>  Has0_acc_2: 0.5633  Has0_F1_score: 0.5048  Non0_acc_2: 0.5324  Non0_F1_score: 0.4790  Mult_acc_5: 0.2795  Mult_acc_7: 0.1179  MAE: 2.5053  Corr: -0.0315 
2024-06-12 13:39:10:INFO:TRAIN-(cmcm) (2/3/3)>> loss: 1.1538
2024-06-12 13:39:13:INFO:VAL-(cmcm) >>
2024-06-12 13:39:13:INFO:M: >>  Has0_acc_2: 0.5590  Has0_F1_score: 0.5216  Non0_acc_2: 0.5417  Non0_F1_score: 0.5056  Mult_acc_5: 0.2489  Mult_acc_7: 0.2009  MAE: 1.8123  Corr: -0.0168 
2024-06-12 13:39:13:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-mosi-regression.pth.
2024-06-12 13:39:28:INFO:TRAIN-(cmcm) (1/4/3)>> loss: 0.9558
2024-06-12 13:39:31:INFO:VAL-(cmcm) >>
2024-06-12 13:39:31:INFO:M: >>  Has0_acc_2: 0.5197  Has0_F1_score: 0.5049  Non0_acc_2: 0.4907  Non0_F1_score: 0.4819  Mult_acc_5: 0.1878  Mult_acc_7: 0.1878  MAE: 1.6314  Corr: -0.0507 
2024-06-12 13:39:31:INFO:Saving checkpoint at epoch 4 to results/models/cmcm-mosi-regression.pth.
2024-06-12 13:39:46:INFO:TRAIN-(cmcm) (1/5/3)>> loss: 0.9130
2024-06-12 13:39:49:INFO:VAL-(cmcm) >>
2024-06-12 13:39:49:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4607  Non0_acc_2: 0.5694  Non0_F1_score: 0.4323  Mult_acc_5: 0.2795  Mult_acc_7: 0.2009  MAE: 1.6813  Corr: -0.0571 
2024-06-12 13:40:03:INFO:TRAIN-(cmcm) (2/6/3)>> loss: 0.8891
2024-06-12 13:40:06:INFO:VAL-(cmcm) >>
2024-06-12 13:40:06:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5634  Non0_acc_2: 0.5694  Non0_F1_score: 0.5432  Mult_acc_5: 0.2969  Mult_acc_7: 0.2183  MAE: 1.7202  Corr: 0.0342 
2024-06-12 13:40:21:INFO:TRAIN-(cmcm) (3/7/3)>> loss: 0.8812
2024-06-12 13:40:23:INFO:VAL-(cmcm) >>
2024-06-12 13:40:23:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4723  Non0_acc_2: 0.5602  Non0_F1_score: 0.4479  Mult_acc_5: 0.2707  Mult_acc_7: 0.2183  MAE: 1.5830  Corr: 0.0261 
2024-06-12 13:40:24:INFO:Saving checkpoint at epoch 7 to results/models/cmcm-mosi-regression.pth.
2024-06-12 13:40:39:INFO:TRAIN-(cmcm) (1/8/3)>> loss: 0.8682
2024-06-12 13:40:41:INFO:VAL-(cmcm) >>
2024-06-12 13:40:41:INFO:M: >>  Has0_acc_2: 0.5328  Has0_F1_score: 0.5304  Non0_acc_2: 0.5324  Non0_F1_score: 0.5286  Mult_acc_5: 0.2620  Mult_acc_7: 0.1921  MAE: 1.7424  Corr: 0.0455 
2024-06-12 13:40:56:INFO:TRAIN-(cmcm) (2/9/3)>> loss: 0.8657
2024-06-12 13:40:58:INFO:VAL-(cmcm) >>
2024-06-12 13:40:58:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4607  Non0_acc_2: 0.5278  Non0_F1_score: 0.5132  Mult_acc_5: 0.2096  Mult_acc_7: 0.2096  MAE: 1.4733  Corr: 0.0157 
2024-06-12 13:40:59:INFO:Saving checkpoint at epoch 9 to results/models/cmcm-mosi-regression.pth.
2024-06-12 13:41:14:INFO:TRAIN-(cmcm) (1/10/3)>> loss: 0.8640
2024-06-12 13:41:16:INFO:VAL-(cmcm) >>
2024-06-12 13:41:16:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4723  Non0_acc_2: 0.5741  Non0_F1_score: 0.4951  Mult_acc_5: 0.2227  Mult_acc_7: 0.1878  MAE: 1.4699  Corr: 0.0397 
2024-06-12 13:41:17:INFO:Saving checkpoint at epoch 10 to results/models/cmcm-mosi-regression.pth.
2024-06-12 13:41:32:INFO:TRAIN-(cmcm) (1/11/3)>> loss: 0.8577
2024-06-12 13:41:34:INFO:VAL-(cmcm) >>
2024-06-12 13:41:34:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.5109  Non0_acc_2: 0.5741  Non0_F1_score: 0.5125  Mult_acc_5: 0.2314  Mult_acc_7: 0.1834  MAE: 1.6341  Corr: 0.0151 
2024-06-12 13:41:49:INFO:TRAIN-(cmcm) (2/12/3)>> loss: 0.8529
2024-06-12 13:41:51:INFO:VAL-(cmcm) >>
2024-06-12 13:41:51:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.4968  Non0_acc_2: 0.5880  Non0_F1_score: 0.5044  Mult_acc_5: 0.2751  Mult_acc_7: 0.2183  MAE: 1.5533  Corr: 0.0310 
2024-06-12 13:42:06:INFO:TRAIN-(cmcm) (3/13/3)>> loss: 0.8521
2024-06-12 13:42:08:INFO:VAL-(cmcm) >>
2024-06-12 13:42:09:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.5204  Non0_acc_2: 0.5787  Non0_F1_score: 0.5029  Mult_acc_5: 0.2576  Mult_acc_7: 0.2271  MAE: 1.5088  Corr: 0.1092 
2024-06-12 13:42:23:INFO:TRAIN-(cmcm) (4/14/3)>> loss: 0.8579
2024-06-12 13:42:26:INFO:VAL-(cmcm) >>
2024-06-12 13:42:26:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4830  Non0_acc_2: 0.5833  Non0_F1_score: 0.4739  Mult_acc_5: 0.3013  Mult_acc_7: 0.2183  MAE: 1.7590  Corr: 0.0961 
2024-06-12 13:42:40:INFO:TRAIN-(cmcm) (5/15/3)>> loss: 0.8467
2024-06-12 13:42:43:INFO:VAL-(cmcm) >>
2024-06-12 13:42:43:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5247  Non0_acc_2: 0.5000  Non0_F1_score: 0.4943  Mult_acc_5: 0.2009  Mult_acc_7: 0.1747  MAE: 1.4931  Corr: 0.0867 
2024-06-12 13:42:58:INFO:TRAIN-(cmcm) (6/16/3)>> loss: 0.8447
2024-06-12 13:43:00:INFO:VAL-(cmcm) >>
2024-06-12 13:43:00:INFO:M: >>  Has0_acc_2: 0.5328  Has0_F1_score: 0.5372  Non0_acc_2: 0.5370  Non0_F1_score: 0.5389  Mult_acc_5: 0.2620  Mult_acc_7: 0.1921  MAE: 1.6664  Corr: 0.0847 
2024-06-12 13:43:15:INFO:TRAIN-(cmcm) (7/17/3)>> loss: 0.8391
2024-06-12 13:43:17:INFO:VAL-(cmcm) >>
2024-06-12 13:43:17:INFO:M: >>  Has0_acc_2: 0.5502  Has0_F1_score: 0.5506  Non0_acc_2: 0.5417  Non0_F1_score: 0.5425  Mult_acc_5: 0.2009  Mult_acc_7: 0.1790  MAE: 1.5646  Corr: 0.0882 
2024-06-12 13:43:32:INFO:TRAIN-(cmcm) (8/18/3)>> loss: 0.8365
2024-06-12 13:43:35:INFO:VAL-(cmcm) >>
2024-06-12 13:43:35:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5070  Non0_acc_2: 0.5602  Non0_F1_score: 0.5440  Mult_acc_5: 0.2969  Mult_acc_7: 0.2271  MAE: 1.6512  Corr: 0.0307 
2024-06-12 13:43:49:INFO:TRAIN-(cmcm) (9/19/3)>> loss: 0.8355
2024-06-12 13:43:52:INFO:VAL-(cmcm) >>
2024-06-12 13:43:52:INFO:M: >>  Has0_acc_2: 0.5153  Has0_F1_score: 0.5047  Non0_acc_2: 0.5324  Non0_F1_score: 0.5124  Mult_acc_5: 0.2707  Mult_acc_7: 0.2271  MAE: 1.6389  Corr: 0.1416 
2024-06-12 13:44:07:INFO:TRAIN-(cmcm) (10/20/3)>> loss: 0.8338
2024-06-12 13:44:09:INFO:VAL-(cmcm) >>
2024-06-12 13:44:09:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.4814  Non0_acc_2: 0.5648  Non0_F1_score: 0.4739  Mult_acc_5: 0.2882  Mult_acc_7: 0.2314  MAE: 1.5844  Corr: 0.0329 
2024-06-12 13:44:17:INFO:TEST-(cmcm) >>
2024-06-12 13:44:17:INFO:M: >>  Has0_acc_2: 0.4810  Has0_F1_score: 0.3527  Non0_acc_2: 0.4482  Non0_F1_score: 0.3846  Mult_acc_5: 0.1837  Mult_acc_7: 0.1749  MAE: 1.5598  Corr: 0.0503 
2024-06-12 13:44:17:INFO:Results are added to results/results/mosi-regression-60.csv...
2024-06-12 13:44:17:INFO:Start running cmcm...
2024-06-12 13:44:17:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 60, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 4444}>
2024-06-12 13:44:17:INFO:Let's use the GPU 1 !
2024-06-12 13:44:17:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 13:44:17:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718171057 HTTP/1.1" 200 235
2024-06-12 13:44:18:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 13:44:18:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 13:44:19:INFO:train samples: (1284,)
2024-06-12 13:44:19:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 13:44:19:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718171059 HTTP/1.1" 200 235
2024-06-12 13:44:19:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 13:44:20:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 13:44:21:INFO:valid samples: (229,)
2024-06-12 13:44:21:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 13:44:21:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718171061 HTTP/1.1" 200 235
2024-06-12 13:44:21:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 13:44:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 13:44:22:INFO:test samples: (686,)
2024-06-12 13:44:22:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 13:44:23:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718171063 HTTP/1.1" 200 235
2024-06-12 13:44:23:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 13:44:23:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 13:44:24:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 13:44:24:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718171064 HTTP/1.1" 200 235
2024-06-12 13:44:24:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 13:44:25:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 13:44:25:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-12 13:44:25:WARNING:Try importing flash-attention for faster inference...
2024-06-12 13:44:25:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-12 13:44:25:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-12 13:44:25:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-12 13:44:26:INFO:trainable params: 1310284 || all params: 1838138956 || trainable%: 0.07128318540461856
2024-06-12 13:44:26:INFO:Init labels...
2024-06-12 13:44:26:INFO:Start training...
2024-06-12 13:44:41:INFO:TRAIN-(cmcm) (1/1/4)>> loss: 3.8454
2024-06-12 13:44:44:INFO:VAL-(cmcm) >>
2024-06-12 13:44:44:INFO:M: >>  Has0_acc_2: 0.5197  Has0_F1_score: 0.5229  Non0_acc_2: 0.4769  Non0_F1_score: 0.4715  Mult_acc_5: 0.1354  Mult_acc_7: 0.1354  MAE: 1.6161  Corr: -0.0008 
2024-06-12 13:44:44:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-12 13:44:59:INFO:TRAIN-(cmcm) (1/2/4)>> loss: 1.5674
2024-06-12 13:45:02:INFO:VAL-(cmcm) >>
2024-06-12 13:45:02:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.4788  Non0_acc_2: 0.5648  Non0_F1_score: 0.4888  Mult_acc_5: 0.1616  Mult_acc_7: 0.1616  MAE: 1.4833  Corr: 0.0068 
2024-06-12 13:45:02:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-12 13:45:17:INFO:TRAIN-(cmcm) (1/3/4)>> loss: 1.0461
2024-06-12 13:45:19:INFO:VAL-(cmcm) >>
2024-06-12 13:45:19:INFO:M: >>  Has0_acc_2: 0.5590  Has0_F1_score: 0.5124  Non0_acc_2: 0.5556  Non0_F1_score: 0.5192  Mult_acc_5: 0.1703  Mult_acc_7: 0.1659  MAE: 1.5488  Corr: -0.0361 
2024-06-12 13:45:34:INFO:TRAIN-(cmcm) (2/4/4)>> loss: 1.0058
2024-06-12 13:45:37:INFO:VAL-(cmcm) >>
2024-06-12 13:45:37:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5787  Non0_F1_score: 0.4445  Mult_acc_5: 0.2183  Mult_acc_7: 0.1790  MAE: 1.5440  Corr: 0.0441 
2024-06-12 13:45:51:INFO:TRAIN-(cmcm) (3/5/4)>> loss: 0.9890
2024-06-12 13:45:54:INFO:VAL-(cmcm) >>
2024-06-12 13:45:54:INFO:M: >>  Has0_acc_2: 0.5590  Has0_F1_score: 0.5462  Non0_acc_2: 0.4815  Non0_F1_score: 0.4799  Mult_acc_5: 0.2052  Mult_acc_7: 0.2052  MAE: 1.4929  Corr: 0.0371 
2024-06-12 13:46:09:INFO:TRAIN-(cmcm) (4/6/4)>> loss: 0.9748
2024-06-12 13:46:11:INFO:VAL-(cmcm) >>
2024-06-12 13:46:11:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.5365  Non0_acc_2: 0.5324  Non0_F1_score: 0.5350  Mult_acc_5: 0.2009  Mult_acc_7: 0.2009  MAE: 1.4925  Corr: 0.0637 
2024-06-12 13:46:26:INFO:TRAIN-(cmcm) (5/7/4)>> loss: 0.9458
2024-06-12 13:46:29:INFO:VAL-(cmcm) >>
2024-06-12 13:46:29:INFO:M: >>  Has0_acc_2: 0.5153  Has0_F1_score: 0.5139  Non0_acc_2: 0.5139  Non0_F1_score: 0.5099  Mult_acc_5: 0.1790  Mult_acc_7: 0.1703  MAE: 1.8301  Corr: -0.0349 
2024-06-12 13:46:43:INFO:TRAIN-(cmcm) (6/8/4)>> loss: 0.9341
2024-06-12 13:46:46:INFO:VAL-(cmcm) >>
2024-06-12 13:46:46:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.5499  Non0_acc_2: 0.5602  Non0_F1_score: 0.5440  Mult_acc_5: 0.2620  Mult_acc_7: 0.1921  MAE: 1.7411  Corr: 0.0046 
2024-06-12 13:47:01:INFO:TRAIN-(cmcm) (7/9/4)>> loss: 0.9303
2024-06-12 13:47:03:INFO:VAL-(cmcm) >>
2024-06-12 13:47:03:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5344  Non0_acc_2: 0.5509  Non0_F1_score: 0.5156  Mult_acc_5: 0.1878  Mult_acc_7: 0.1834  MAE: 1.5589  Corr: 0.0255 
2024-06-12 13:47:18:INFO:TRAIN-(cmcm) (8/10/4)>> loss: 0.9044
2024-06-12 13:47:21:INFO:VAL-(cmcm) >>
2024-06-12 13:47:21:INFO:M: >>  Has0_acc_2: 0.4454  Has0_F1_score: 0.3609  Non0_acc_2: 0.4676  Non0_F1_score: 0.3838  Mult_acc_5: 0.2489  Mult_acc_7: 0.2096  MAE: 1.9005  Corr: 0.1257 
2024-06-12 13:47:35:INFO:TRAIN-(cmcm) (9/11/4)>> loss: 2.5894
2024-06-12 13:47:38:INFO:VAL-(cmcm) >>
2024-06-12 13:47:38:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4259  Non0_F1_score: 0.2544  Mult_acc_5: 0.2140  Mult_acc_7: 0.2140  MAE: 1.4370  Corr: nan 
2024-06-12 13:47:38:INFO:Saving checkpoint at epoch 11 to results/models/cmcm-mosi-regression.pth.
2024-06-12 13:47:53:INFO:TRAIN-(cmcm) (1/12/4)>> loss: 2.6378
2024-06-12 13:47:56:INFO:VAL-(cmcm) >>
2024-06-12 13:47:56:INFO:M: >>  Has0_acc_2: 0.5590  Has0_F1_score: 0.5367  Non0_acc_2: 0.5556  Non0_F1_score: 0.5362  Mult_acc_5: 0.1878  Mult_acc_7: 0.1790  MAE: 1.5654  Corr: 0.0179 
2024-06-12 13:48:10:INFO:TRAIN-(cmcm) (2/13/4)>> loss: 1.0042
2024-06-12 13:48:13:INFO:VAL-(cmcm) >>
2024-06-12 13:48:13:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.4840  Non0_acc_2: 0.5741  Non0_F1_score: 0.4742  Mult_acc_5: 0.2009  Mult_acc_7: 0.1965  MAE: 1.5402  Corr: -0.1069 
2024-06-12 13:48:28:INFO:TRAIN-(cmcm) (3/14/4)>> loss: 0.9174
2024-06-12 13:48:30:INFO:VAL-(cmcm) >>
2024-06-12 13:48:30:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5070  Non0_acc_2: 0.5509  Non0_F1_score: 0.4839  Mult_acc_5: 0.2620  Mult_acc_7: 0.1878  MAE: 1.8555  Corr: -0.0167 
2024-06-12 13:48:45:INFO:TRAIN-(cmcm) (4/15/4)>> loss: 0.8998
2024-06-12 13:48:48:INFO:VAL-(cmcm) >>
2024-06-12 13:48:48:INFO:M: >>  Has0_acc_2: 0.5459  Has0_F1_score: 0.5170  Non0_acc_2: 0.5324  Non0_F1_score: 0.5039  Mult_acc_5: 0.2183  Mult_acc_7: 0.1485  MAE: 1.8001  Corr: -0.0014 
2024-06-12 13:49:02:INFO:TRAIN-(cmcm) (5/16/4)>> loss: 0.8769
2024-06-12 13:49:05:INFO:VAL-(cmcm) >>
2024-06-12 13:49:05:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5586  Non0_acc_2: 0.5741  Non0_F1_score: 0.5515  Mult_acc_5: 0.2271  Mult_acc_7: 0.2052  MAE: 1.4536  Corr: 0.1189 
2024-06-12 13:49:20:INFO:TRAIN-(cmcm) (6/17/4)>> loss: 0.8713
2024-06-12 13:49:22:INFO:VAL-(cmcm) >>
2024-06-12 13:49:22:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.4956  Non0_acc_2: 0.4444  Non0_F1_score: 0.4394  Mult_acc_5: 0.1965  Mult_acc_7: 0.1965  MAE: 1.4999  Corr: -0.0056 
2024-06-12 13:49:37:INFO:TRAIN-(cmcm) (7/18/4)>> loss: 0.8590
2024-06-12 13:49:39:INFO:VAL-(cmcm) >>
2024-06-12 13:49:39:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4723  Non0_acc_2: 0.5741  Non0_F1_score: 0.4491  Mult_acc_5: 0.1921  Mult_acc_7: 0.1747  MAE: 1.5817  Corr: 0.0795 
2024-06-12 13:49:54:INFO:TRAIN-(cmcm) (8/19/4)>> loss: 0.8550
2024-06-12 13:49:57:INFO:VAL-(cmcm) >>
2024-06-12 13:49:57:INFO:M: >>  Has0_acc_2: 0.6245  Has0_F1_score: 0.5474  Non0_acc_2: 0.5880  Non0_F1_score: 0.5303  Mult_acc_5: 0.3057  Mult_acc_7: 0.2664  MAE: 1.4759  Corr: 0.1174 
2024-06-12 13:50:12:INFO:TRAIN-(cmcm) (9/20/4)>> loss: 0.8562
2024-06-12 13:50:14:INFO:VAL-(cmcm) >>
2024-06-12 13:50:14:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5346  Non0_acc_2: 0.5093  Non0_F1_score: 0.5085  Mult_acc_5: 0.2052  Mult_acc_7: 0.1965  MAE: 1.4680  Corr: 0.0896 
2024-06-12 13:50:29:INFO:TRAIN-(cmcm) (10/21/4)>> loss: 0.8452
2024-06-12 13:50:32:INFO:VAL-(cmcm) >>
2024-06-12 13:50:32:INFO:M: >>  Has0_acc_2: 0.6157  Has0_F1_score: 0.4994  Non0_acc_2: 0.5926  Non0_F1_score: 0.4730  Mult_acc_5: 0.2838  Mult_acc_7: 0.2183  MAE: 1.6673  Corr: 0.0691 
2024-06-12 13:50:39:INFO:TEST-(cmcm) >>
2024-06-12 13:50:39:INFO:M: >>  Has0_acc_2: 0.4475  Has0_F1_score: 0.2767  Non0_acc_2: 0.5777  Non0_F1_score: 0.4231  Mult_acc_5: 0.1545  Mult_acc_7: 0.1545  MAE: 1.4174  Corr: nan 
2024-06-12 13:50:39:INFO:Results are added to results/results/mosi-regression-60.csv...
2024-06-12 13:50:39:INFO:Start running cmcm...
2024-06-12 13:50:39:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 60, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 5555}>
2024-06-12 13:50:39:INFO:Let's use the GPU 1 !
2024-06-12 13:50:40:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 13:50:40:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718171440 HTTP/1.1" 200 235
2024-06-12 13:50:40:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 13:50:40:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 13:50:41:INFO:train samples: (1284,)
2024-06-12 13:50:41:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 13:50:42:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718171442 HTTP/1.1" 200 235
2024-06-12 13:50:42:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 13:50:42:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 13:50:43:INFO:valid samples: (229,)
2024-06-12 13:50:43:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 13:50:43:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718171443 HTTP/1.1" 200 235
2024-06-12 13:50:43:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 13:50:44:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 13:50:44:INFO:test samples: (686,)
2024-06-12 13:50:44:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 13:50:45:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718171445 HTTP/1.1" 200 235
2024-06-12 13:50:45:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 13:50:45:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 13:50:46:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 13:50:46:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718171446 HTTP/1.1" 200 235
2024-06-12 13:50:46:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 13:50:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 13:50:47:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-12 13:50:47:WARNING:Try importing flash-attention for faster inference...
2024-06-12 13:50:47:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-12 13:50:47:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-12 13:50:47:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-12 13:50:48:INFO:trainable params: 1310284 || all params: 1838138956 || trainable%: 0.07128318540461856
2024-06-12 13:50:48:INFO:Init labels...
2024-06-12 13:50:48:INFO:Start training...
2024-06-12 13:51:03:INFO:TRAIN-(cmcm) (1/1/5)>> loss: 3.4140
2024-06-12 13:51:05:INFO:VAL-(cmcm) >>
2024-06-12 13:51:05:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5556  Non0_F1_score: 0.4627  Mult_acc_5: 0.2533  Mult_acc_7: 0.2489  MAE: 1.4213  Corr: 0.0561 
2024-06-12 13:51:06:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-12 13:51:21:INFO:TRAIN-(cmcm) (1/2/5)>> loss: 1.0974
2024-06-12 13:51:23:INFO:VAL-(cmcm) >>
2024-06-12 13:51:23:INFO:M: >>  Has0_acc_2: 0.5371  Has0_F1_score: 0.5278  Non0_acc_2: 0.5278  Non0_F1_score: 0.5166  Mult_acc_5: 0.2096  Mult_acc_7: 0.1790  MAE: 1.6472  Corr: -0.0007 
2024-06-12 13:51:38:INFO:TRAIN-(cmcm) (2/3/5)>> loss: 0.9452
2024-06-12 13:51:40:INFO:VAL-(cmcm) >>
2024-06-12 13:51:40:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.4924  Non0_acc_2: 0.5741  Non0_F1_score: 0.4742  Mult_acc_5: 0.2838  Mult_acc_7: 0.2009  MAE: 1.7651  Corr: 0.0263 
2024-06-12 13:51:55:INFO:TRAIN-(cmcm) (3/4/5)>> loss: 0.8970
2024-06-12 13:51:58:INFO:VAL-(cmcm) >>
2024-06-12 13:51:58:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.4880  Non0_acc_2: 0.5833  Non0_F1_score: 0.4610  Mult_acc_5: 0.1747  Mult_acc_7: 0.1747  MAE: 1.5082  Corr: 0.0485 
2024-06-12 13:52:12:INFO:TRAIN-(cmcm) (4/5/5)>> loss: 0.8837
2024-06-12 13:52:15:INFO:VAL-(cmcm) >>
2024-06-12 13:52:15:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4791  Non0_acc_2: 0.5324  Non0_F1_score: 0.5342  Mult_acc_5: 0.2402  Mult_acc_7: 0.2052  MAE: 1.5132  Corr: 0.0697 
2024-06-12 13:52:30:INFO:TRAIN-(cmcm) (5/6/5)>> loss: 0.8876
2024-06-12 13:52:32:INFO:VAL-(cmcm) >>
2024-06-12 13:52:32:INFO:M: >>  Has0_acc_2: 0.5415  Has0_F1_score: 0.5205  Non0_acc_2: 0.5324  Non0_F1_score: 0.5088  Mult_acc_5: 0.1747  Mult_acc_7: 0.1747  MAE: 1.6957  Corr: -0.0264 
2024-06-12 13:52:47:INFO:TRAIN-(cmcm) (6/7/5)>> loss: 0.8757
2024-06-12 13:52:50:INFO:VAL-(cmcm) >>
2024-06-12 13:52:50:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.5658  Non0_acc_2: 0.5648  Non0_F1_score: 0.5530  Mult_acc_5: 0.1485  Mult_acc_7: 0.1441  MAE: 1.6219  Corr: 0.0801 
2024-06-12 13:53:05:INFO:TRAIN-(cmcm) (7/8/5)>> loss: 0.8671
2024-06-12 13:53:07:INFO:VAL-(cmcm) >>
2024-06-12 13:53:07:INFO:M: >>  Has0_acc_2: 0.4629  Has0_F1_score: 0.3936  Non0_acc_2: 0.4861  Non0_F1_score: 0.4182  Mult_acc_5: 0.1354  Mult_acc_7: 0.1354  MAE: 1.7855  Corr: 0.0984 
2024-06-12 13:53:22:INFO:TRAIN-(cmcm) (8/9/5)>> loss: 0.8620
2024-06-12 13:53:24:INFO:VAL-(cmcm) >>
2024-06-12 13:53:24:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5753  Non0_acc_2: 0.5833  Non0_F1_score: 0.5671  Mult_acc_5: 0.2227  Mult_acc_7: 0.1878  MAE: 1.5676  Corr: 0.1325 
2024-06-12 13:53:39:INFO:TRAIN-(cmcm) (9/10/5)>> loss: 0.8478
2024-06-12 13:53:42:INFO:VAL-(cmcm) >>
2024-06-12 13:53:42:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5741  Non0_F1_score: 0.4187  Mult_acc_5: 0.2183  Mult_acc_7: 0.1921  MAE: 1.5638  Corr: 0.1477 
2024-06-12 13:53:57:INFO:TRAIN-(cmcm) (10/11/5)>> loss: 0.8461
2024-06-12 13:53:59:INFO:VAL-(cmcm) >>
2024-06-12 13:53:59:INFO:M: >>  Has0_acc_2: 0.6201  Has0_F1_score: 0.6238  Non0_acc_2: 0.6481  Non0_F1_score: 0.6498  Mult_acc_5: 0.2445  Mult_acc_7: 0.2271  MAE: 1.3497  Corr: 0.3268 
2024-06-12 13:53:59:INFO:Saving checkpoint at epoch 11 to results/models/cmcm-mosi-regression.pth.
2024-06-12 13:54:15:INFO:TRAIN-(cmcm) (1/12/5)>> loss: 0.8287
2024-06-12 13:54:17:INFO:VAL-(cmcm) >>
2024-06-12 13:54:17:INFO:M: >>  Has0_acc_2: 0.6332  Has0_F1_score: 0.6173  Non0_acc_2: 0.6435  Non0_F1_score: 0.6237  Mult_acc_5: 0.2620  Mult_acc_7: 0.2009  MAE: 1.3948  Corr: 0.3480 
2024-06-12 13:54:32:INFO:TRAIN-(cmcm) (2/13/5)>> loss: 0.8249
2024-06-12 13:54:34:INFO:VAL-(cmcm) >>
2024-06-12 13:54:34:INFO:M: >>  Has0_acc_2: 0.6507  Has0_F1_score: 0.6458  Non0_acc_2: 0.6389  Non0_F1_score: 0.6371  Mult_acc_5: 0.3100  Mult_acc_7: 0.2751  MAE: 1.3542  Corr: 0.3747 
2024-06-12 13:54:49:INFO:TRAIN-(cmcm) (3/14/5)>> loss: 0.8152
2024-06-12 13:54:52:INFO:VAL-(cmcm) >>
2024-06-12 13:54:52:INFO:M: >>  Has0_acc_2: 0.5459  Has0_F1_score: 0.5189  Non0_acc_2: 0.5602  Non0_F1_score: 0.5309  Mult_acc_5: 0.2620  Mult_acc_7: 0.1878  MAE: 1.6018  Corr: 0.3370 
2024-06-12 13:55:06:INFO:TRAIN-(cmcm) (4/15/5)>> loss: 0.8020
2024-06-12 13:55:09:INFO:VAL-(cmcm) >>
2024-06-12 13:55:09:INFO:M: >>  Has0_acc_2: 0.6550  Has0_F1_score: 0.5975  Non0_acc_2: 0.6481  Non0_F1_score: 0.5973  Mult_acc_5: 0.3930  Mult_acc_7: 0.3406  MAE: 1.1839  Corr: 0.4497 
2024-06-12 13:55:09:INFO:Saving checkpoint at epoch 15 to results/models/cmcm-mosi-regression.pth.
2024-06-12 13:55:24:INFO:TRAIN-(cmcm) (1/16/5)>> loss: 0.7928
2024-06-12 13:55:27:INFO:VAL-(cmcm) >>
2024-06-12 13:55:27:INFO:M: >>  Has0_acc_2: 0.6550  Has0_F1_score: 0.6547  Non0_acc_2: 0.6713  Non0_F1_score: 0.6686  Mult_acc_5: 0.3275  Mult_acc_7: 0.2576  MAE: 1.2630  Corr: 0.4401 
2024-06-12 13:55:42:INFO:TRAIN-(cmcm) (2/17/5)>> loss: 0.7792
2024-06-12 13:55:44:INFO:VAL-(cmcm) >>
2024-06-12 13:55:44:INFO:M: >>  Has0_acc_2: 0.6550  Has0_F1_score: 0.6556  Non0_acc_2: 0.6620  Non0_F1_score: 0.6601  Mult_acc_5: 0.3057  Mult_acc_7: 0.2358  MAE: 1.2678  Corr: 0.4632 
2024-06-12 13:55:59:INFO:TRAIN-(cmcm) (3/18/5)>> loss: 0.7779
2024-06-12 13:56:01:INFO:VAL-(cmcm) >>
2024-06-12 13:56:01:INFO:M: >>  Has0_acc_2: 0.6638  Has0_F1_score: 0.6657  Non0_acc_2: 0.6898  Non0_F1_score: 0.6900  Mult_acc_5: 0.3406  Mult_acc_7: 0.2795  MAE: 1.2529  Corr: 0.4844 
2024-06-12 13:56:16:INFO:TRAIN-(cmcm) (4/19/5)>> loss: 0.7691
2024-06-12 13:56:18:INFO:VAL-(cmcm) >>
2024-06-12 13:56:18:INFO:M: >>  Has0_acc_2: 0.6725  Has0_F1_score: 0.6526  Non0_acc_2: 0.7130  Non0_F1_score: 0.7137  Mult_acc_5: 0.4017  Mult_acc_7: 0.3319  MAE: 1.1699  Corr: 0.4968 
2024-06-12 13:56:19:INFO:Saving checkpoint at epoch 19 to results/models/cmcm-mosi-regression.pth.
2024-06-12 13:56:34:INFO:TRAIN-(cmcm) (1/20/5)>> loss: 0.7690
2024-06-12 13:56:36:INFO:VAL-(cmcm) >>
2024-06-12 13:56:36:INFO:M: >>  Has0_acc_2: 0.7162  Has0_F1_score: 0.7164  Non0_acc_2: 0.7315  Non0_F1_score: 0.7301  Mult_acc_5: 0.3624  Mult_acc_7: 0.2795  MAE: 1.1861  Corr: 0.5226 
2024-06-12 13:56:51:INFO:TRAIN-(cmcm) (2/21/5)>> loss: 0.7484
2024-06-12 13:56:54:INFO:VAL-(cmcm) >>
2024-06-12 13:56:54:INFO:M: >>  Has0_acc_2: 0.6769  Has0_F1_score: 0.6799  Non0_acc_2: 0.6944  Non0_F1_score: 0.6960  Mult_acc_5: 0.3624  Mult_acc_7: 0.2707  MAE: 1.2529  Corr: 0.5215 
2024-06-12 13:57:08:INFO:TRAIN-(cmcm) (3/22/5)>> loss: 0.7562
2024-06-12 13:57:11:INFO:VAL-(cmcm) >>
2024-06-12 13:57:11:INFO:M: >>  Has0_acc_2: 0.6856  Has0_F1_score: 0.6771  Non0_acc_2: 0.7130  Non0_F1_score: 0.7080  Mult_acc_5: 0.4367  Mult_acc_7: 0.3537  MAE: 1.1411  Corr: 0.5213 
2024-06-12 13:57:11:INFO:Saving checkpoint at epoch 22 to results/models/cmcm-mosi-regression.pth.
2024-06-12 13:57:26:INFO:TRAIN-(cmcm) (1/23/5)>> loss: 0.7410
2024-06-12 13:57:29:INFO:VAL-(cmcm) >>
2024-06-12 13:57:29:INFO:M: >>  Has0_acc_2: 0.6725  Has0_F1_score: 0.6722  Non0_acc_2: 0.7222  Non0_F1_score: 0.7238  Mult_acc_5: 0.3712  Mult_acc_7: 0.3013  MAE: 1.1503  Corr: 0.5160 
2024-06-12 13:57:43:INFO:TRAIN-(cmcm) (2/24/5)>> loss: 0.7351
2024-06-12 13:57:46:INFO:VAL-(cmcm) >>
2024-06-12 13:57:46:INFO:M: >>  Has0_acc_2: 0.6769  Has0_F1_score: 0.6753  Non0_acc_2: 0.6759  Non0_F1_score: 0.6676  Mult_acc_5: 0.3450  Mult_acc_7: 0.2620  MAE: 1.2983  Corr: 0.4725 
2024-06-12 13:58:00:INFO:TRAIN-(cmcm) (3/25/5)>> loss: 0.7293
2024-06-12 13:58:03:INFO:VAL-(cmcm) >>
2024-06-12 13:58:03:INFO:M: >>  Has0_acc_2: 0.7031  Has0_F1_score: 0.7056  Non0_acc_2: 0.7222  Non0_F1_score: 0.7238  Mult_acc_5: 0.3974  Mult_acc_7: 0.3100  MAE: 1.2184  Corr: 0.5320 
2024-06-12 13:58:18:INFO:TRAIN-(cmcm) (4/26/5)>> loss: 0.7248
2024-06-12 13:58:20:INFO:VAL-(cmcm) >>
2024-06-12 13:58:20:INFO:M: >>  Has0_acc_2: 0.6594  Has0_F1_score: 0.6627  Non0_acc_2: 0.6944  Non0_F1_score: 0.6960  Mult_acc_5: 0.3581  Mult_acc_7: 0.2751  MAE: 1.2678  Corr: 0.4904 
2024-06-12 13:58:35:INFO:TRAIN-(cmcm) (5/27/5)>> loss: 0.7110
2024-06-12 13:58:37:INFO:VAL-(cmcm) >>
2024-06-12 13:58:37:INFO:M: >>  Has0_acc_2: 0.6856  Has0_F1_score: 0.6877  Non0_acc_2: 0.6852  Non0_F1_score: 0.6868  Mult_acc_5: 0.3406  Mult_acc_7: 0.2664  MAE: 1.2376  Corr: 0.4986 
2024-06-12 13:58:52:INFO:TRAIN-(cmcm) (6/28/5)>> loss: 0.7123
2024-06-12 13:58:55:INFO:VAL-(cmcm) >>
2024-06-12 13:58:55:INFO:M: >>  Has0_acc_2: 0.6681  Has0_F1_score: 0.6696  Non0_acc_2: 0.6713  Non0_F1_score: 0.6687  Mult_acc_5: 0.4061  Mult_acc_7: 0.3188  MAE: 1.1664  Corr: 0.5234 
2024-06-12 13:59:09:INFO:TRAIN-(cmcm) (7/29/5)>> loss: 0.7061
2024-06-12 13:59:12:INFO:VAL-(cmcm) >>
2024-06-12 13:59:12:INFO:M: >>  Has0_acc_2: 0.6856  Has0_F1_score: 0.6870  Non0_acc_2: 0.7083  Non0_F1_score: 0.7092  Mult_acc_5: 0.3843  Mult_acc_7: 0.3057  MAE: 1.1717  Corr: 0.5157 
2024-06-12 13:59:27:INFO:TRAIN-(cmcm) (8/30/5)>> loss: 0.7045
2024-06-12 13:59:30:INFO:VAL-(cmcm) >>
2024-06-12 13:59:30:INFO:M: >>  Has0_acc_2: 0.6987  Has0_F1_score: 0.7015  Non0_acc_2: 0.6991  Non0_F1_score: 0.6996  Mult_acc_5: 0.3799  Mult_acc_7: 0.2969  MAE: 1.1874  Corr: 0.5303 
2024-06-12 13:59:45:INFO:TRAIN-(cmcm) (9/31/5)>> loss: 0.7004
2024-06-12 13:59:48:INFO:VAL-(cmcm) >>
2024-06-12 13:59:48:INFO:M: >>  Has0_acc_2: 0.6725  Has0_F1_score: 0.6756  Non0_acc_2: 0.6713  Non0_F1_score: 0.6729  Mult_acc_5: 0.3624  Mult_acc_7: 0.2751  MAE: 1.2210  Corr: 0.5118 
2024-06-12 14:00:02:INFO:TRAIN-(cmcm) (10/32/5)>> loss: 0.6860
2024-06-12 14:00:05:INFO:VAL-(cmcm) >>
2024-06-12 14:00:05:INFO:M: >>  Has0_acc_2: 0.6943  Has0_F1_score: 0.6957  Non0_acc_2: 0.6991  Non0_F1_score: 0.7007  Mult_acc_5: 0.3974  Mult_acc_7: 0.3188  MAE: 1.0979  Corr: 0.5473 
2024-06-12 14:00:05:INFO:Saving checkpoint at epoch 32 to results/models/cmcm-mosi-regression.pth.
2024-06-12 14:00:20:INFO:TRAIN-(cmcm) (1/33/5)>> loss: 0.6893
2024-06-12 14:00:23:INFO:VAL-(cmcm) >>
2024-06-12 14:00:23:INFO:M: >>  Has0_acc_2: 0.6812  Has0_F1_score: 0.6772  Non0_acc_2: 0.7176  Non0_F1_score: 0.7131  Mult_acc_5: 0.3668  Mult_acc_7: 0.2926  MAE: 1.1385  Corr: 0.5301 
2024-06-12 14:00:37:INFO:TRAIN-(cmcm) (2/34/5)>> loss: 0.6740
2024-06-12 14:00:40:INFO:VAL-(cmcm) >>
2024-06-12 14:00:40:INFO:M: >>  Has0_acc_2: 0.6900  Has0_F1_score: 0.6912  Non0_acc_2: 0.7037  Non0_F1_score: 0.7044  Mult_acc_5: 0.3843  Mult_acc_7: 0.3013  MAE: 1.1560  Corr: 0.5327 
2024-06-12 14:00:55:INFO:TRAIN-(cmcm) (3/35/5)>> loss: 0.6730
2024-06-12 14:00:58:INFO:VAL-(cmcm) >>
2024-06-12 14:00:58:INFO:M: >>  Has0_acc_2: 0.6900  Has0_F1_score: 0.6925  Non0_acc_2: 0.7083  Non0_F1_score: 0.7098  Mult_acc_5: 0.4017  Mult_acc_7: 0.3188  MAE: 1.1189  Corr: 0.5630 
2024-06-12 14:01:12:INFO:TRAIN-(cmcm) (4/36/5)>> loss: 0.6593
2024-06-12 14:01:15:INFO:VAL-(cmcm) >>
2024-06-12 14:01:15:INFO:M: >>  Has0_acc_2: 0.6812  Has0_F1_score: 0.6809  Non0_acc_2: 0.6991  Non0_F1_score: 0.7002  Mult_acc_5: 0.3799  Mult_acc_7: 0.2969  MAE: 1.1909  Corr: 0.5084 
2024-06-12 14:01:30:INFO:TRAIN-(cmcm) (5/37/5)>> loss: 0.6554
2024-06-12 14:01:32:INFO:VAL-(cmcm) >>
2024-06-12 14:01:32:INFO:M: >>  Has0_acc_2: 0.6856  Has0_F1_score: 0.6821  Non0_acc_2: 0.7037  Non0_F1_score: 0.7016  Mult_acc_5: 0.3712  Mult_acc_7: 0.2969  MAE: 1.1730  Corr: 0.5136 
2024-06-12 14:01:47:INFO:TRAIN-(cmcm) (6/38/5)>> loss: 0.6517
2024-06-12 14:01:49:INFO:VAL-(cmcm) >>
2024-06-12 14:01:49:INFO:M: >>  Has0_acc_2: 0.6856  Has0_F1_score: 0.6884  Non0_acc_2: 0.7083  Non0_F1_score: 0.7094  Mult_acc_5: 0.3799  Mult_acc_7: 0.2926  MAE: 1.1699  Corr: 0.5253 
2024-06-12 14:02:04:INFO:TRAIN-(cmcm) (7/39/5)>> loss: 0.6482
2024-06-12 14:02:07:INFO:VAL-(cmcm) >>
2024-06-12 14:02:07:INFO:M: >>  Has0_acc_2: 0.6681  Has0_F1_score: 0.6675  Non0_acc_2: 0.6852  Non0_F1_score: 0.6865  Mult_acc_5: 0.3886  Mult_acc_7: 0.3188  MAE: 1.1918  Corr: 0.4785 
2024-06-12 14:02:21:INFO:TRAIN-(cmcm) (8/40/5)>> loss: 0.6395
2024-06-12 14:02:24:INFO:VAL-(cmcm) >>
2024-06-12 14:02:24:INFO:M: >>  Has0_acc_2: 0.6856  Has0_F1_score: 0.6812  Non0_acc_2: 0.7037  Non0_F1_score: 0.7016  Mult_acc_5: 0.3799  Mult_acc_7: 0.2969  MAE: 1.2110  Corr: 0.5043 
2024-06-12 14:02:39:INFO:TRAIN-(cmcm) (9/41/5)>> loss: 0.6267
2024-06-12 14:02:41:INFO:VAL-(cmcm) >>
2024-06-12 14:02:41:INFO:M: >>  Has0_acc_2: 0.6812  Has0_F1_score: 0.6753  Non0_acc_2: 0.6806  Non0_F1_score: 0.6779  Mult_acc_5: 0.3843  Mult_acc_7: 0.2969  MAE: 1.1944  Corr: 0.5002 
2024-06-12 14:02:56:INFO:TRAIN-(cmcm) (10/42/5)>> loss: 0.6271
2024-06-12 14:02:58:INFO:VAL-(cmcm) >>
2024-06-12 14:02:58:INFO:M: >>  Has0_acc_2: 0.6769  Has0_F1_score: 0.6799  Non0_acc_2: 0.6667  Non0_F1_score: 0.6684  Mult_acc_5: 0.3886  Mult_acc_7: 0.3100  MAE: 1.1940  Corr: 0.5203 
2024-06-12 14:03:06:INFO:TEST-(cmcm) >>
2024-06-12 14:03:06:INFO:M: >>  Has0_acc_2: 0.7085  Has0_F1_score: 0.7087  Non0_acc_2: 0.7332  Non0_F1_score: 0.7319  Mult_acc_5: 0.3440  Mult_acc_7: 0.3032  MAE: 1.1458  Corr: 0.4823 
2024-06-12 14:03:06:INFO:Results are added to results/results/mosi-regression-60.csv...
2024-06-12 14:03:06:INFO:Start running cmcm...
2024-06-12 14:03:06:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 70, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-06-12 14:03:06:INFO:Let's use the GPU 1 !
2024-06-12 14:03:06:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 14:03:07:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718172187 HTTP/1.1" 200 235
2024-06-12 14:03:07:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 14:03:07:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 14:03:08:INFO:train samples: (1284,)
2024-06-12 14:03:08:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 14:03:09:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718172189 HTTP/1.1" 200 235
2024-06-12 14:03:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 14:03:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 14:03:13:INFO:valid samples: (229,)
2024-06-12 14:03:13:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 14:03:13:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718172194 HTTP/1.1" 200 235
2024-06-12 14:03:14:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 14:03:14:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 14:03:15:INFO:test samples: (686,)
2024-06-12 14:03:15:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 14:03:15:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718172195 HTTP/1.1" 200 235
2024-06-12 14:03:15:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 14:03:16:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 14:03:16:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 14:03:17:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718172197 HTTP/1.1" 200 235
2024-06-12 14:03:17:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 14:03:17:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 14:03:18:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-12 14:03:18:WARNING:Try importing flash-attention for faster inference...
2024-06-12 14:03:18:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-12 14:03:18:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-12 14:03:18:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-12 14:03:19:INFO:trainable params: 1310284 || all params: 1838138956 || trainable%: 0.07128318540461856
2024-06-12 14:03:19:INFO:Init labels...
2024-06-12 14:03:19:INFO:Start training...
2024-06-12 14:03:34:INFO:TRAIN-(cmcm) (1/1/1)>> loss: 3.7655
2024-06-12 14:03:37:INFO:VAL-(cmcm) >>
2024-06-12 14:03:37:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.5688  Non0_acc_2: 0.5556  Non0_F1_score: 0.5578  Mult_acc_5: 0.2576  Mult_acc_7: 0.1834  MAE: 1.7145  Corr: 0.0494 
2024-06-12 14:03:37:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-12 14:03:52:INFO:TRAIN-(cmcm) (1/2/1)>> loss: 1.1192
2024-06-12 14:03:55:INFO:VAL-(cmcm) >>
2024-06-12 14:03:55:INFO:M: >>  Has0_acc_2: 0.5459  Has0_F1_score: 0.5502  Non0_acc_2: 0.5417  Non0_F1_score: 0.5439  Mult_acc_5: 0.1965  Mult_acc_7: 0.1616  MAE: 1.6969  Corr: 0.0335 
2024-06-12 14:03:55:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-12 14:04:11:INFO:TRAIN-(cmcm) (1/3/1)>> loss: 0.9368
2024-06-12 14:04:13:INFO:VAL-(cmcm) >>
2024-06-12 14:04:13:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.5278  Non0_acc_2: 0.5694  Non0_F1_score: 0.5131  Mult_acc_5: 0.1921  Mult_acc_7: 0.1921  MAE: 1.5301  Corr: 0.0084 
2024-06-12 14:04:14:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-mosi-regression.pth.
2024-06-12 14:04:29:INFO:TRAIN-(cmcm) (1/4/1)>> loss: 0.9161
2024-06-12 14:04:31:INFO:VAL-(cmcm) >>
2024-06-12 14:04:31:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5518  Non0_acc_2: 0.5694  Non0_F1_score: 0.5383  Mult_acc_5: 0.1965  Mult_acc_7: 0.1965  MAE: 1.5213  Corr: 0.0480 
2024-06-12 14:04:32:INFO:Saving checkpoint at epoch 4 to results/models/cmcm-mosi-regression.pth.
2024-06-12 14:04:47:INFO:TRAIN-(cmcm) (1/5/1)>> loss: 0.9052
2024-06-12 14:04:49:INFO:VAL-(cmcm) >>
2024-06-12 14:04:50:INFO:M: >>  Has0_acc_2: 0.5066  Has0_F1_score: 0.4926  Non0_acc_2: 0.5231  Non0_F1_score: 0.5084  Mult_acc_5: 0.2576  Mult_acc_7: 0.2052  MAE: 1.7708  Corr: 0.0937 
2024-06-12 14:05:04:INFO:TRAIN-(cmcm) (2/6/1)>> loss: 0.8920
2024-06-12 14:05:07:INFO:VAL-(cmcm) >>
2024-06-12 14:05:07:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.4905  Non0_acc_2: 0.5880  Non0_F1_score: 0.4637  Mult_acc_5: 0.1747  Mult_acc_7: 0.1747  MAE: 1.5034  Corr: 0.0581 
2024-06-12 14:05:07:INFO:Saving checkpoint at epoch 6 to results/models/cmcm-mosi-regression.pth.
2024-06-12 14:05:22:INFO:TRAIN-(cmcm) (1/7/1)>> loss: 0.9081
2024-06-12 14:05:25:INFO:VAL-(cmcm) >>
2024-06-12 14:05:25:INFO:M: >>  Has0_acc_2: 0.5502  Has0_F1_score: 0.5446  Non0_acc_2: 0.5417  Non0_F1_score: 0.5357  Mult_acc_5: 0.2445  Mult_acc_7: 0.1790  MAE: 1.7424  Corr: -0.0103 
2024-06-12 14:05:40:INFO:TRAIN-(cmcm) (2/8/1)>> loss: 0.8918
2024-06-12 14:05:42:INFO:VAL-(cmcm) >>
2024-06-12 14:05:42:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4950  Non0_acc_2: 0.5324  Non0_F1_score: 0.4533  Mult_acc_5: 0.2402  Mult_acc_7: 0.1747  MAE: 1.6730  Corr: -0.0618 
2024-06-12 14:05:57:INFO:TRAIN-(cmcm) (3/9/1)>> loss: 0.8930
2024-06-12 14:05:59:INFO:VAL-(cmcm) >>
2024-06-12 14:05:59:INFO:M: >>  Has0_acc_2: 0.5459  Has0_F1_score: 0.5395  Non0_acc_2: 0.5370  Non0_F1_score: 0.5290  Mult_acc_5: 0.2620  Mult_acc_7: 0.1834  MAE: 1.7752  Corr: -0.0253 
2024-06-12 14:06:14:INFO:TRAIN-(cmcm) (4/10/1)>> loss: 0.8888
2024-06-12 14:06:17:INFO:VAL-(cmcm) >>
2024-06-12 14:06:17:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5534  Non0_acc_2: 0.5787  Non0_F1_score: 0.5400  Mult_acc_5: 0.2314  Mult_acc_7: 0.2052  MAE: 1.5667  Corr: 0.0459 
2024-06-12 14:06:31:INFO:TRAIN-(cmcm) (5/11/1)>> loss: 0.8693
2024-06-12 14:06:34:INFO:VAL-(cmcm) >>
2024-06-12 14:06:34:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5031  Non0_acc_2: 0.5370  Non0_F1_score: 0.5303  Mult_acc_5: 0.2096  Mult_acc_7: 0.2009  MAE: 1.4781  Corr: 0.0436 
2024-06-12 14:06:34:INFO:Saving checkpoint at epoch 11 to results/models/cmcm-mosi-regression.pth.
2024-06-12 14:06:50:INFO:TRAIN-(cmcm) (1/12/1)>> loss: 0.8707
2024-06-12 14:06:53:INFO:VAL-(cmcm) >>
2024-06-12 14:06:53:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4723  Non0_acc_2: 0.5787  Non0_F1_score: 0.4516  Mult_acc_5: 0.3057  Mult_acc_7: 0.2358  MAE: 1.7494  Corr: 0.0883 
2024-06-12 14:07:07:INFO:TRAIN-(cmcm) (2/13/1)>> loss: 0.8670
2024-06-12 14:07:10:INFO:VAL-(cmcm) >>
2024-06-12 14:07:10:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.6088  Non0_acc_2: 0.6111  Non0_F1_score: 0.6111  Mult_acc_5: 0.3100  Mult_acc_7: 0.2576  MAE: 1.4558  Corr: 0.1986 
2024-06-12 14:07:10:INFO:Saving checkpoint at epoch 13 to results/models/cmcm-mosi-regression.pth.
2024-06-12 14:07:25:INFO:TRAIN-(cmcm) (1/14/1)>> loss: 0.8656
2024-06-12 14:07:28:INFO:VAL-(cmcm) >>
2024-06-12 14:07:28:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5760  Non0_acc_2: 0.5787  Non0_F1_score: 0.5808  Mult_acc_5: 0.2664  Mult_acc_7: 0.1834  MAE: 1.6713  Corr: 0.1655 
2024-06-12 14:07:42:INFO:TRAIN-(cmcm) (2/15/1)>> loss: 0.8623
2024-06-12 14:07:45:INFO:VAL-(cmcm) >>
2024-06-12 14:07:45:INFO:M: >>  Has0_acc_2: 0.6419  Has0_F1_score: 0.5908  Non0_acc_2: 0.6481  Non0_F1_score: 0.6146  Mult_acc_5: 0.3406  Mult_acc_7: 0.2795  MAE: 1.4739  Corr: 0.1738 
2024-06-12 14:08:00:INFO:TRAIN-(cmcm) (3/16/1)>> loss: 0.8516
2024-06-12 14:08:02:INFO:VAL-(cmcm) >>
2024-06-12 14:08:02:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.6039  Non0_acc_2: 0.5833  Non0_F1_score: 0.5712  Mult_acc_5: 0.2314  Mult_acc_7: 0.2009  MAE: 1.6235  Corr: 0.2002 
2024-06-12 14:08:17:INFO:TRAIN-(cmcm) (4/17/1)>> loss: 0.8572
2024-06-12 14:08:19:INFO:VAL-(cmcm) >>
2024-06-12 14:08:19:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5031  Non0_acc_2: 0.5787  Non0_F1_score: 0.5158  Mult_acc_5: 0.2795  Mult_acc_7: 0.2096  MAE: 1.5459  Corr: 0.1107 
2024-06-12 14:08:34:INFO:TRAIN-(cmcm) (5/18/1)>> loss: 0.8449
2024-06-12 14:08:36:INFO:VAL-(cmcm) >>
2024-06-12 14:08:36:INFO:M: >>  Has0_acc_2: 0.6157  Has0_F1_score: 0.6104  Non0_acc_2: 0.6111  Non0_F1_score: 0.6044  Mult_acc_5: 0.2664  Mult_acc_7: 0.2183  MAE: 1.6250  Corr: 0.1403 
2024-06-12 14:08:51:INFO:TRAIN-(cmcm) (6/19/1)>> loss: 0.8436
2024-06-12 14:08:54:INFO:VAL-(cmcm) >>
2024-06-12 14:08:54:INFO:M: >>  Has0_acc_2: 0.6332  Has0_F1_score: 0.6099  Non0_acc_2: 0.6250  Non0_F1_score: 0.6041  Mult_acc_5: 0.3144  Mult_acc_7: 0.2314  MAE: 1.5817  Corr: 0.1834 
2024-06-12 14:09:08:INFO:TRAIN-(cmcm) (7/20/1)>> loss: 0.8514
2024-06-12 14:09:11:INFO:VAL-(cmcm) >>
2024-06-12 14:09:11:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.6021  Non0_acc_2: 0.5926  Non0_F1_score: 0.5947  Mult_acc_5: 0.2620  Mult_acc_7: 0.2096  MAE: 1.6009  Corr: 0.1701 
2024-06-12 14:09:25:INFO:TRAIN-(cmcm) (8/21/1)>> loss: 0.8504
2024-06-12 14:09:28:INFO:VAL-(cmcm) >>
2024-06-12 14:09:28:INFO:M: >>  Has0_acc_2: 0.6463  Has0_F1_score: 0.6496  Non0_acc_2: 0.6574  Non0_F1_score: 0.6592  Mult_acc_5: 0.2795  Mult_acc_7: 0.2271  MAE: 1.4245  Corr: 0.3131 
2024-06-12 14:09:29:INFO:Saving checkpoint at epoch 21 to results/models/cmcm-mosi-regression.pth.
2024-06-12 14:09:44:INFO:TRAIN-(cmcm) (1/22/1)>> loss: 0.8358
2024-06-12 14:09:46:INFO:VAL-(cmcm) >>
2024-06-12 14:09:46:INFO:M: >>  Has0_acc_2: 0.6332  Has0_F1_score: 0.5738  Non0_acc_2: 0.6111  Non0_F1_score: 0.5512  Mult_acc_5: 0.2751  Mult_acc_7: 0.2009  MAE: 1.5713  Corr: 0.1648 
2024-06-12 14:10:01:INFO:TRAIN-(cmcm) (2/23/1)>> loss: 0.8341
2024-06-12 14:10:03:INFO:VAL-(cmcm) >>
2024-06-12 14:10:03:INFO:M: >>  Has0_acc_2: 0.6812  Has0_F1_score: 0.6720  Non0_acc_2: 0.6806  Non0_F1_score: 0.6701  Mult_acc_5: 0.3624  Mult_acc_7: 0.2664  MAE: 1.4721  Corr: 0.3147 
2024-06-12 14:10:18:INFO:TRAIN-(cmcm) (3/24/1)>> loss: 0.8328
2024-06-12 14:10:20:INFO:VAL-(cmcm) >>
2024-06-12 14:10:20:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.5844  Non0_acc_2: 0.5694  Non0_F1_score: 0.5528  Mult_acc_5: 0.2096  Mult_acc_7: 0.1747  MAE: 1.6223  Corr: 0.1839 
2024-06-12 14:10:35:INFO:TRAIN-(cmcm) (4/25/1)>> loss: 0.8255
2024-06-12 14:10:38:INFO:VAL-(cmcm) >>
2024-06-12 14:10:38:INFO:M: >>  Has0_acc_2: 0.6332  Has0_F1_score: 0.6367  Non0_acc_2: 0.6528  Non0_F1_score: 0.6543  Mult_acc_5: 0.3100  Mult_acc_7: 0.2402  MAE: 1.5023  Corr: 0.3100 
2024-06-12 14:10:52:INFO:TRAIN-(cmcm) (5/26/1)>> loss: 0.8147
2024-06-12 14:10:55:INFO:VAL-(cmcm) >>
2024-06-12 14:10:55:INFO:M: >>  Has0_acc_2: 0.6769  Has0_F1_score: 0.6277  Non0_acc_2: 0.6574  Non0_F1_score: 0.6079  Mult_acc_5: 0.2271  Mult_acc_7: 0.2096  MAE: 1.3759  Corr: 0.2211 
2024-06-12 14:10:55:INFO:Saving checkpoint at epoch 26 to results/models/cmcm-mosi-regression.pth.
2024-06-12 14:11:10:INFO:TRAIN-(cmcm) (1/27/1)>> loss: 0.8146
2024-06-12 14:11:13:INFO:VAL-(cmcm) >>
2024-06-12 14:11:13:INFO:M: >>  Has0_acc_2: 0.6463  Has0_F1_score: 0.6208  Non0_acc_2: 0.6435  Non0_F1_score: 0.6218  Mult_acc_5: 0.2533  Mult_acc_7: 0.2052  MAE: 1.4765  Corr: 0.2232 
2024-06-12 14:11:28:INFO:TRAIN-(cmcm) (2/28/1)>> loss: 0.8071
2024-06-12 14:11:30:INFO:VAL-(cmcm) >>
2024-06-12 14:11:30:INFO:M: >>  Has0_acc_2: 0.6943  Has0_F1_score: 0.6713  Non0_acc_2: 0.6944  Non0_F1_score: 0.6935  Mult_acc_5: 0.3362  Mult_acc_7: 0.2926  MAE: 1.2852  Corr: 0.3345 
2024-06-12 14:11:31:INFO:Saving checkpoint at epoch 28 to results/models/cmcm-mosi-regression.pth.
2024-06-12 14:11:46:INFO:TRAIN-(cmcm) (1/29/1)>> loss: 0.8002
2024-06-12 14:11:48:INFO:VAL-(cmcm) >>
2024-06-12 14:11:48:INFO:M: >>  Has0_acc_2: 0.6507  Has0_F1_score: 0.6399  Non0_acc_2: 0.6528  Non0_F1_score: 0.6462  Mult_acc_5: 0.3100  Mult_acc_7: 0.2402  MAE: 1.4184  Corr: 0.2655 
2024-06-12 14:12:03:INFO:TRAIN-(cmcm) (2/30/1)>> loss: 0.7936
2024-06-12 14:12:05:INFO:VAL-(cmcm) >>
2024-06-12 14:12:05:INFO:M: >>  Has0_acc_2: 0.6507  Has0_F1_score: 0.5703  Non0_acc_2: 0.6435  Non0_F1_score: 0.5794  Mult_acc_5: 0.3013  Mult_acc_7: 0.2445  MAE: 1.4437  Corr: 0.2175 
2024-06-12 14:12:20:INFO:TRAIN-(cmcm) (3/31/1)>> loss: 0.7854
2024-06-12 14:12:22:INFO:VAL-(cmcm) >>
2024-06-12 14:12:23:INFO:M: >>  Has0_acc_2: 0.6900  Has0_F1_score: 0.6785  Non0_acc_2: 0.6898  Non0_F1_score: 0.6784  Mult_acc_5: 0.3100  Mult_acc_7: 0.2445  MAE: 1.4057  Corr: 0.3181 
2024-06-12 14:12:37:INFO:TRAIN-(cmcm) (4/32/1)>> loss: 0.7829
2024-06-12 14:12:40:INFO:VAL-(cmcm) >>
2024-06-12 14:12:40:INFO:M: >>  Has0_acc_2: 0.6594  Has0_F1_score: 0.6625  Non0_acc_2: 0.5787  Non0_F1_score: 0.5529  Mult_acc_5: 0.2795  Mult_acc_7: 0.2445  MAE: 1.4087  Corr: 0.2983 
2024-06-12 14:12:54:INFO:TRAIN-(cmcm) (5/33/1)>> loss: 0.7801
2024-06-12 14:12:57:INFO:VAL-(cmcm) >>
2024-06-12 14:12:57:INFO:M: >>  Has0_acc_2: 0.6419  Has0_F1_score: 0.5684  Non0_acc_2: 0.6204  Non0_F1_score: 0.5541  Mult_acc_5: 0.3100  Mult_acc_7: 0.2227  MAE: 1.5149  Corr: 0.2048 
2024-06-12 14:13:12:INFO:TRAIN-(cmcm) (6/34/1)>> loss: 0.7755
2024-06-12 14:13:14:INFO:VAL-(cmcm) >>
2024-06-12 14:13:14:INFO:M: >>  Has0_acc_2: 0.6812  Has0_F1_score: 0.6832  Non0_acc_2: 0.6944  Non0_F1_score: 0.6960  Mult_acc_5: 0.3100  Mult_acc_7: 0.2402  MAE: 1.3075  Corr: 0.3927 
2024-06-12 14:13:29:INFO:TRAIN-(cmcm) (7/35/1)>> loss: 0.7622
2024-06-12 14:13:31:INFO:VAL-(cmcm) >>
2024-06-12 14:13:31:INFO:M: >>  Has0_acc_2: 0.6769  Has0_F1_score: 0.6628  Non0_acc_2: 0.6991  Non0_F1_score: 0.6925  Mult_acc_5: 0.3057  Mult_acc_7: 0.2489  MAE: 1.3178  Corr: 0.3343 
2024-06-12 14:13:46:INFO:TRAIN-(cmcm) (8/36/1)>> loss: 0.7674
2024-06-12 14:13:49:INFO:VAL-(cmcm) >>
2024-06-12 14:13:49:INFO:M: >>  Has0_acc_2: 0.6987  Has0_F1_score: 0.6949  Non0_acc_2: 0.7130  Non0_F1_score: 0.7142  Mult_acc_5: 0.3100  Mult_acc_7: 0.2707  MAE: 1.1975  Corr: 0.4363 
2024-06-12 14:13:49:INFO:Saving checkpoint at epoch 36 to results/models/cmcm-mosi-regression.pth.
2024-06-12 14:14:04:INFO:TRAIN-(cmcm) (1/37/1)>> loss: 0.7636
2024-06-12 14:14:07:INFO:VAL-(cmcm) >>
2024-06-12 14:14:07:INFO:M: >>  Has0_acc_2: 0.6550  Has0_F1_score: 0.6544  Non0_acc_2: 0.6806  Non0_F1_score: 0.6780  Mult_acc_5: 0.3188  Mult_acc_7: 0.2489  MAE: 1.4136  Corr: 0.3966 
2024-06-12 14:14:22:INFO:TRAIN-(cmcm) (2/38/1)>> loss: 0.7464
2024-06-12 14:14:24:INFO:VAL-(cmcm) >>
2024-06-12 14:14:24:INFO:M: >>  Has0_acc_2: 0.6856  Has0_F1_score: 0.6600  Non0_acc_2: 0.6898  Non0_F1_score: 0.6741  Mult_acc_5: 0.3406  Mult_acc_7: 0.2795  MAE: 1.2995  Corr: 0.3510 
2024-06-12 14:14:39:INFO:TRAIN-(cmcm) (3/39/1)>> loss: 0.7400
2024-06-12 14:14:42:INFO:VAL-(cmcm) >>
2024-06-12 14:14:42:INFO:M: >>  Has0_acc_2: 0.6638  Has0_F1_score: 0.6395  Non0_acc_2: 0.6389  Non0_F1_score: 0.6355  Mult_acc_5: 0.3188  Mult_acc_7: 0.2751  MAE: 1.2822  Corr: 0.3400 
2024-06-12 14:14:57:INFO:TRAIN-(cmcm) (4/40/1)>> loss: 0.7382
2024-06-12 14:14:59:INFO:VAL-(cmcm) >>
2024-06-12 14:14:59:INFO:M: >>  Has0_acc_2: 0.6376  Has0_F1_score: 0.6346  Non0_acc_2: 0.6620  Non0_F1_score: 0.6578  Mult_acc_5: 0.2795  Mult_acc_7: 0.2314  MAE: 1.4114  Corr: 0.3665 
2024-06-12 14:15:14:INFO:TRAIN-(cmcm) (5/41/1)>> loss: 0.7372
2024-06-12 14:15:16:INFO:VAL-(cmcm) >>
2024-06-12 14:15:17:INFO:M: >>  Has0_acc_2: 0.6856  Has0_F1_score: 0.6861  Non0_acc_2: 0.6713  Non0_F1_score: 0.6728  Mult_acc_5: 0.2707  Mult_acc_7: 0.2402  MAE: 1.2756  Corr: 0.3777 
2024-06-12 14:15:31:INFO:TRAIN-(cmcm) (6/42/1)>> loss: 0.7235
2024-06-12 14:15:34:INFO:VAL-(cmcm) >>
2024-06-12 14:15:34:INFO:M: >>  Has0_acc_2: 0.6594  Has0_F1_score: 0.6221  Non0_acc_2: 0.6343  Non0_F1_score: 0.6192  Mult_acc_5: 0.3493  Mult_acc_7: 0.3100  MAE: 1.2909  Corr: 0.3549 
2024-06-12 14:15:49:INFO:TRAIN-(cmcm) (7/43/1)>> loss: 0.7115
2024-06-12 14:15:51:INFO:VAL-(cmcm) >>
2024-06-12 14:15:51:INFO:M: >>  Has0_acc_2: 0.7205  Has0_F1_score: 0.7130  Non0_acc_2: 0.6991  Non0_F1_score: 0.6973  Mult_acc_5: 0.3668  Mult_acc_7: 0.3144  MAE: 1.1999  Corr: 0.4546 
2024-06-12 14:16:06:INFO:TRAIN-(cmcm) (8/44/1)>> loss: 0.7082
2024-06-12 14:16:08:INFO:VAL-(cmcm) >>
2024-06-12 14:16:08:INFO:M: >>  Has0_acc_2: 0.6725  Has0_F1_score: 0.6730  Non0_acc_2: 0.6991  Non0_F1_score: 0.6979  Mult_acc_5: 0.3406  Mult_acc_7: 0.2882  MAE: 1.2322  Corr: 0.4353 
2024-06-12 14:16:23:INFO:TRAIN-(cmcm) (9/45/1)>> loss: 0.6952
2024-06-12 14:16:26:INFO:VAL-(cmcm) >>
2024-06-12 14:16:26:INFO:M: >>  Has0_acc_2: 0.6856  Has0_F1_score: 0.6877  Non0_acc_2: 0.7130  Non0_F1_score: 0.7137  Mult_acc_5: 0.3362  Mult_acc_7: 0.2664  MAE: 1.2887  Corr: 0.4146 
2024-06-12 14:16:41:INFO:TRAIN-(cmcm) (10/46/1)>> loss: 0.6814
2024-06-12 14:16:43:INFO:VAL-(cmcm) >>
2024-06-12 14:16:43:INFO:M: >>  Has0_acc_2: 0.6900  Has0_F1_score: 0.6842  Non0_acc_2: 0.6806  Non0_F1_score: 0.6786  Mult_acc_5: 0.3668  Mult_acc_7: 0.3144  MAE: 1.2536  Corr: 0.3731 
2024-06-12 14:16:51:INFO:TEST-(cmcm) >>
2024-06-12 14:16:51:INFO:M: >>  Has0_acc_2: 0.6910  Has0_F1_score: 0.6918  Non0_acc_2: 0.6768  Non0_F1_score: 0.6773  Mult_acc_5: 0.3120  Mult_acc_7: 0.2901  MAE: 1.1924  Corr: 0.4173 
2024-06-12 14:16:51:INFO:Results are added to results/results/mosi-regression-70.csv...
2024-06-12 14:16:51:INFO:Start running cmcm...
2024-06-12 14:16:51:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 70, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 2222}>
2024-06-12 14:16:51:INFO:Let's use the GPU 1 !
2024-06-12 14:16:51:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 14:16:52:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718173012 HTTP/1.1" 200 235
2024-06-12 14:16:52:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 14:16:52:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 14:16:53:INFO:train samples: (1284,)
2024-06-12 14:16:53:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 14:16:53:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718173013 HTTP/1.1" 200 235
2024-06-12 14:16:53:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 14:16:54:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 14:16:54:INFO:valid samples: (229,)
2024-06-12 14:16:54:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 14:16:55:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718173015 HTTP/1.1" 200 235
2024-06-12 14:16:55:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 14:16:55:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 14:16:56:INFO:test samples: (686,)
2024-06-12 14:16:56:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 14:16:56:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718173016 HTTP/1.1" 200 235
2024-06-12 14:16:56:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 14:16:57:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 14:16:57:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 14:16:57:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718173018 HTTP/1.1" 200 235
2024-06-12 14:16:58:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 14:16:58:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 14:16:58:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-12 14:16:58:WARNING:Try importing flash-attention for faster inference...
2024-06-12 14:16:58:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-12 14:16:58:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-12 14:16:58:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-12 14:16:59:INFO:trainable params: 1310284 || all params: 1838138956 || trainable%: 0.07128318540461856
2024-06-12 14:16:59:INFO:Init labels...
2024-06-12 14:16:59:INFO:Start training...
2024-06-12 14:17:14:INFO:TRAIN-(cmcm) (1/1/2)>> loss: 4.2274
2024-06-12 14:17:17:INFO:VAL-(cmcm) >>
2024-06-12 14:17:17:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4259  Non0_F1_score: 0.2544  Mult_acc_5: 0.2140  Mult_acc_7: 0.2140  MAE: 1.4370  Corr: nan 
2024-06-12 14:17:17:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-12 14:17:32:INFO:TRAIN-(cmcm) (1/2/2)>> loss: 1.8601
2024-06-12 14:17:35:INFO:VAL-(cmcm) >>
2024-06-12 14:17:35:INFO:M: >>  Has0_acc_2: 0.4323  Has0_F1_score: 0.3691  Non0_acc_2: 0.4491  Non0_F1_score: 0.3718  Mult_acc_5: 0.1965  Mult_acc_7: 0.1878  MAE: 1.6973  Corr: -0.0438 
2024-06-12 14:17:49:INFO:TRAIN-(cmcm) (2/3/2)>> loss: 0.9986
2024-06-12 14:17:52:INFO:VAL-(cmcm) >>
2024-06-12 14:17:52:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.4880  Non0_acc_2: 0.5833  Non0_F1_score: 0.4610  Mult_acc_5: 0.2314  Mult_acc_7: 0.1878  MAE: 1.6433  Corr: 0.0432 
2024-06-12 14:18:06:INFO:TRAIN-(cmcm) (3/4/2)>> loss: 0.9157
2024-06-12 14:18:09:INFO:VAL-(cmcm) >>
2024-06-12 14:18:09:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.5576  Non0_acc_2: 0.5648  Non0_F1_score: 0.5371  Mult_acc_5: 0.2009  Mult_acc_7: 0.1878  MAE: 1.6167  Corr: 0.0132 
2024-06-12 14:18:24:INFO:TRAIN-(cmcm) (4/5/2)>> loss: 0.9198
2024-06-12 14:18:26:INFO:VAL-(cmcm) >>
2024-06-12 14:18:26:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5446  Non0_acc_2: 0.5741  Non0_F1_score: 0.5271  Mult_acc_5: 0.1965  Mult_acc_7: 0.1572  MAE: 1.7499  Corr: 0.0370 
2024-06-12 14:18:41:INFO:TRAIN-(cmcm) (5/6/2)>> loss: 0.8828
2024-06-12 14:18:43:INFO:VAL-(cmcm) >>
2024-06-12 14:18:43:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.5544  Non0_acc_2: 0.5509  Non0_F1_score: 0.5282  Mult_acc_5: 0.3100  Mult_acc_7: 0.2314  MAE: 1.5957  Corr: 0.0567 
2024-06-12 14:18:58:INFO:TRAIN-(cmcm) (6/7/2)>> loss: 0.8841
2024-06-12 14:19:00:INFO:VAL-(cmcm) >>
2024-06-12 14:19:00:INFO:M: >>  Has0_acc_2: 0.5633  Has0_F1_score: 0.5641  Non0_acc_2: 0.5648  Non0_F1_score: 0.5634  Mult_acc_5: 0.1659  Mult_acc_7: 0.1616  MAE: 1.5781  Corr: 0.1010 
2024-06-12 14:19:16:INFO:TRAIN-(cmcm) (7/8/2)>> loss: 0.8774
2024-06-12 14:19:18:INFO:VAL-(cmcm) >>
2024-06-12 14:19:18:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.5240  Non0_acc_2: 0.5694  Non0_F1_score: 0.5052  Mult_acc_5: 0.1921  Mult_acc_7: 0.1834  MAE: 1.5973  Corr: -0.0118 
2024-06-12 14:19:33:INFO:TRAIN-(cmcm) (8/9/2)>> loss: 0.8685
2024-06-12 14:19:36:INFO:VAL-(cmcm) >>
2024-06-12 14:19:36:INFO:M: >>  Has0_acc_2: 0.4978  Has0_F1_score: 0.4912  Non0_acc_2: 0.5139  Non0_F1_score: 0.5065  Mult_acc_5: 0.1659  Mult_acc_7: 0.1659  MAE: 1.6602  Corr: 0.0688 
2024-06-12 14:19:50:INFO:TRAIN-(cmcm) (9/10/2)>> loss: 0.8653
2024-06-12 14:19:53:INFO:VAL-(cmcm) >>
2024-06-12 14:19:53:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4791  Non0_acc_2: 0.5509  Non0_F1_score: 0.4651  Mult_acc_5: 0.2707  Mult_acc_7: 0.2183  MAE: 1.6704  Corr: -0.0026 
2024-06-12 14:20:08:INFO:TRAIN-(cmcm) (10/11/2)>> loss: 0.8599
2024-06-12 14:20:11:INFO:VAL-(cmcm) >>
2024-06-12 14:20:11:INFO:M: >>  Has0_acc_2: 0.5633  Has0_F1_score: 0.5086  Non0_acc_2: 0.5463  Non0_F1_score: 0.4888  Mult_acc_5: 0.2795  Mult_acc_7: 0.2009  MAE: 1.8394  Corr: -0.0365 
2024-06-12 14:20:18:INFO:TEST-(cmcm) >>
2024-06-12 14:20:18:INFO:M: >>  Has0_acc_2: 0.4475  Has0_F1_score: 0.2767  Non0_acc_2: 0.5777  Non0_F1_score: 0.4231  Mult_acc_5: 0.1545  Mult_acc_7: 0.1545  MAE: 1.4174  Corr: nan 
2024-06-12 14:20:19:INFO:Results are added to results/results/mosi-regression-70.csv...
2024-06-12 14:20:19:INFO:Start running cmcm...
2024-06-12 14:20:19:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 70, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 3333}>
2024-06-12 14:20:19:INFO:Let's use the GPU 1 !
2024-06-12 14:20:19:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 14:20:19:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718173219 HTTP/1.1" 200 235
2024-06-12 14:20:19:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 14:20:20:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 14:20:20:INFO:train samples: (1284,)
2024-06-12 14:20:21:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 14:20:21:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718173221 HTTP/1.1" 200 235
2024-06-12 14:20:21:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 14:20:21:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 14:20:22:INFO:valid samples: (229,)
2024-06-12 14:20:22:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 14:20:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718173223 HTTP/1.1" 200 235
2024-06-12 14:20:23:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 14:20:23:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 14:20:24:INFO:test samples: (686,)
2024-06-12 14:20:24:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 14:20:24:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718173224 HTTP/1.1" 200 235
2024-06-12 14:20:24:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 14:20:25:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 14:20:25:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 14:20:26:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718173226 HTTP/1.1" 200 235
2024-06-12 14:20:26:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 14:20:26:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 14:20:26:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-12 14:20:26:WARNING:Try importing flash-attention for faster inference...
2024-06-12 14:20:26:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-12 14:20:26:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-12 14:20:26:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-12 14:20:27:INFO:trainable params: 1310284 || all params: 1838138956 || trainable%: 0.07128318540461856
2024-06-12 14:20:27:INFO:Init labels...
2024-06-12 14:20:27:INFO:Start training...
2024-06-12 14:20:42:INFO:TRAIN-(cmcm) (1/1/3)>> loss: 4.3235
2024-06-12 14:20:45:INFO:VAL-(cmcm) >>
2024-06-12 14:20:45:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4306  Non0_F1_score: 0.2645  Mult_acc_5: 0.2140  Mult_acc_7: 0.2140  MAE: 1.8632  Corr: 0.0358 
2024-06-12 14:20:45:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-12 14:21:00:INFO:TRAIN-(cmcm) (1/2/3)>> loss: 3.4657
2024-06-12 14:21:03:INFO:VAL-(cmcm) >>
2024-06-12 14:21:03:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4630  Non0_acc_2: 0.5602  Non0_F1_score: 0.4810  Mult_acc_5: 0.2926  Mult_acc_7: 0.1048  MAE: 2.5848  Corr: -0.0394 
2024-06-12 14:21:18:INFO:TRAIN-(cmcm) (2/3/3)>> loss: 1.3239
2024-06-12 14:21:20:INFO:VAL-(cmcm) >>
2024-06-12 14:21:20:INFO:M: >>  Has0_acc_2: 0.4498  Has0_F1_score: 0.4332  Non0_acc_2: 0.4583  Non0_F1_score: 0.4352  Mult_acc_5: 0.1572  Mult_acc_7: 0.1397  MAE: 1.7833  Corr: -0.0144 
2024-06-12 14:21:21:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-mosi-regression.pth.
2024-06-12 14:21:36:INFO:TRAIN-(cmcm) (1/4/3)>> loss: 0.9519
2024-06-12 14:21:39:INFO:VAL-(cmcm) >>
2024-06-12 14:21:39:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5826  Non0_acc_2: 0.5741  Non0_F1_score: 0.5667  Mult_acc_5: 0.2576  Mult_acc_7: 0.2009  MAE: 1.5844  Corr: 0.1297 
2024-06-12 14:21:40:INFO:Saving checkpoint at epoch 4 to results/models/cmcm-mosi-regression.pth.
2024-06-12 14:21:55:INFO:TRAIN-(cmcm) (1/5/3)>> loss: 0.9036
2024-06-12 14:21:57:INFO:VAL-(cmcm) >>
2024-06-12 14:21:57:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.5774  Non0_acc_2: 0.5741  Non0_F1_score: 0.5727  Mult_acc_5: 0.2576  Mult_acc_7: 0.2271  MAE: 1.4938  Corr: 0.0871 
2024-06-12 14:21:58:INFO:Saving checkpoint at epoch 5 to results/models/cmcm-mosi-regression.pth.
2024-06-12 14:22:13:INFO:TRAIN-(cmcm) (1/6/3)>> loss: 0.8900
2024-06-12 14:22:16:INFO:VAL-(cmcm) >>
2024-06-12 14:22:16:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.5279  Non0_acc_2: 0.5787  Non0_F1_score: 0.5029  Mult_acc_5: 0.3057  Mult_acc_7: 0.2227  MAE: 1.6429  Corr: 0.0413 
2024-06-12 14:22:30:INFO:TRAIN-(cmcm) (2/7/3)>> loss: 0.8860
2024-06-12 14:22:33:INFO:VAL-(cmcm) >>
2024-06-12 14:22:33:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.5394  Non0_acc_2: 0.5741  Non0_F1_score: 0.5164  Mult_acc_5: 0.2445  Mult_acc_7: 0.2271  MAE: 1.4616  Corr: 0.1232 
2024-06-12 14:22:33:INFO:Saving checkpoint at epoch 7 to results/models/cmcm-mosi-regression.pth.
2024-06-12 14:22:48:INFO:TRAIN-(cmcm) (1/8/3)>> loss: 0.8703
2024-06-12 14:22:51:INFO:VAL-(cmcm) >>
2024-06-12 14:22:51:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4917  Non0_acc_2: 0.5787  Non0_F1_score: 0.4649  Mult_acc_5: 0.3057  Mult_acc_7: 0.2271  MAE: 1.6533  Corr: 0.0368 
2024-06-12 14:23:06:INFO:TRAIN-(cmcm) (2/9/3)>> loss: 0.8680
2024-06-12 14:23:08:INFO:VAL-(cmcm) >>
2024-06-12 14:23:08:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4607  Non0_acc_2: 0.5463  Non0_F1_score: 0.4458  Mult_acc_5: 0.1659  Mult_acc_7: 0.1616  MAE: 1.5384  Corr: 0.0231 
2024-06-12 14:23:23:INFO:TRAIN-(cmcm) (3/10/3)>> loss: 0.8656
2024-06-12 14:23:25:INFO:VAL-(cmcm) >>
2024-06-12 14:23:25:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.4814  Non0_acc_2: 0.5648  Non0_F1_score: 0.4627  Mult_acc_5: 0.2620  Mult_acc_7: 0.2227  MAE: 1.5353  Corr: 0.0852 
2024-06-12 14:23:40:INFO:TRAIN-(cmcm) (4/11/3)>> loss: 0.8571
2024-06-12 14:23:43:INFO:VAL-(cmcm) >>
2024-06-12 14:23:43:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.4762  Non0_acc_2: 0.5370  Non0_F1_score: 0.4611  Mult_acc_5: 0.2620  Mult_acc_7: 0.2271  MAE: 1.6005  Corr: 0.0378 
2024-06-12 14:23:57:INFO:TRAIN-(cmcm) (5/12/3)>> loss: 0.8619
2024-06-12 14:24:00:INFO:VAL-(cmcm) >>
2024-06-12 14:24:00:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.5473  Non0_acc_2: 0.5787  Non0_F1_score: 0.5482  Mult_acc_5: 0.2358  Mult_acc_7: 0.2052  MAE: 1.5226  Corr: 0.0923 
2024-06-12 14:24:14:INFO:TRAIN-(cmcm) (6/13/3)>> loss: 0.8496
2024-06-12 14:24:17:INFO:VAL-(cmcm) >>
2024-06-12 14:24:17:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4978  Non0_acc_2: 0.5694  Non0_F1_score: 0.4713  Mult_acc_5: 0.2664  Mult_acc_7: 0.1965  MAE: 1.7691  Corr: 0.0464 
2024-06-12 14:24:31:INFO:TRAIN-(cmcm) (7/14/3)>> loss: 0.8476
2024-06-12 14:24:34:INFO:VAL-(cmcm) >>
2024-06-12 14:24:34:INFO:M: >>  Has0_acc_2: 0.6288  Has0_F1_score: 0.5504  Non0_acc_2: 0.6065  Non0_F1_score: 0.5266  Mult_acc_5: 0.3013  Mult_acc_7: 0.2271  MAE: 1.6237  Corr: 0.1831 
2024-06-12 14:24:49:INFO:TRAIN-(cmcm) (8/15/3)>> loss: 0.8582
2024-06-12 14:24:51:INFO:VAL-(cmcm) >>
2024-06-12 14:24:51:INFO:M: >>  Has0_acc_2: 0.5153  Has0_F1_score: 0.5178  Non0_acc_2: 0.4583  Non0_F1_score: 0.4528  Mult_acc_5: 0.1790  Mult_acc_7: 0.1790  MAE: 1.5956  Corr: 0.0042 
2024-06-12 14:25:06:INFO:TRAIN-(cmcm) (9/16/3)>> loss: 0.8476
2024-06-12 14:25:08:INFO:VAL-(cmcm) >>
2024-06-12 14:25:08:INFO:M: >>  Has0_acc_2: 0.5415  Has0_F1_score: 0.5459  Non0_acc_2: 0.5509  Non0_F1_score: 0.5529  Mult_acc_5: 0.2271  Mult_acc_7: 0.1747  MAE: 1.6446  Corr: 0.1353 
2024-06-12 14:25:23:INFO:TRAIN-(cmcm) (10/17/3)>> loss: 0.8425
2024-06-12 14:25:26:INFO:VAL-(cmcm) >>
2024-06-12 14:25:26:INFO:M: >>  Has0_acc_2: 0.6288  Has0_F1_score: 0.5868  Non0_acc_2: 0.5417  Non0_F1_score: 0.5240  Mult_acc_5: 0.2314  Mult_acc_7: 0.2140  MAE: 1.3711  Corr: 0.1971 
2024-06-12 14:25:26:INFO:Saving checkpoint at epoch 17 to results/models/cmcm-mosi-regression.pth.
2024-06-12 14:25:41:INFO:TRAIN-(cmcm) (1/18/3)>> loss: 0.8394
2024-06-12 14:25:44:INFO:VAL-(cmcm) >>
2024-06-12 14:25:44:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5662  Non0_acc_2: 0.5602  Non0_F1_score: 0.5555  Mult_acc_5: 0.2707  Mult_acc_7: 0.2358  MAE: 1.4555  Corr: 0.1648 
2024-06-12 14:25:59:INFO:TRAIN-(cmcm) (2/19/3)>> loss: 0.8303
2024-06-12 14:26:01:INFO:VAL-(cmcm) >>
2024-06-12 14:26:01:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5818  Non0_acc_2: 0.5926  Non0_F1_score: 0.5906  Mult_acc_5: 0.2445  Mult_acc_7: 0.2009  MAE: 1.4568  Corr: 0.2799 
2024-06-12 14:26:16:INFO:TRAIN-(cmcm) (3/20/3)>> loss: 0.8341
2024-06-12 14:26:19:INFO:VAL-(cmcm) >>
2024-06-12 14:26:19:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.5249  Non0_acc_2: 0.5833  Non0_F1_score: 0.5060  Mult_acc_5: 0.2445  Mult_acc_7: 0.2096  MAE: 1.4493  Corr: 0.1367 
2024-06-12 14:26:33:INFO:TRAIN-(cmcm) (4/21/3)>> loss: 0.8241
2024-06-12 14:26:36:INFO:VAL-(cmcm) >>
2024-06-12 14:26:36:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.6019  Non0_acc_2: 0.6111  Non0_F1_score: 0.6130  Mult_acc_5: 0.2576  Mult_acc_7: 0.2227  MAE: 1.4538  Corr: 0.2632 
2024-06-12 14:26:51:INFO:TRAIN-(cmcm) (5/22/3)>> loss: 0.8185
2024-06-12 14:26:53:INFO:VAL-(cmcm) >>
2024-06-12 14:26:53:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.5978  Non0_acc_2: 0.5787  Non0_F1_score: 0.5734  Mult_acc_5: 0.2838  Mult_acc_7: 0.2358  MAE: 1.3957  Corr: 0.2060 
2024-06-12 14:27:08:INFO:TRAIN-(cmcm) (6/23/3)>> loss: 0.8170
2024-06-12 14:27:10:INFO:VAL-(cmcm) >>
2024-06-12 14:27:10:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.5509  Non0_acc_2: 0.6111  Non0_F1_score: 0.5767  Mult_acc_5: 0.3100  Mult_acc_7: 0.2664  MAE: 1.4171  Corr: 0.1624 
2024-06-12 14:27:25:INFO:TRAIN-(cmcm) (7/24/3)>> loss: 0.8209
2024-06-12 14:27:28:INFO:VAL-(cmcm) >>
2024-06-12 14:27:28:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.5875  Non0_acc_2: 0.6204  Non0_F1_score: 0.6209  Mult_acc_5: 0.2838  Mult_acc_7: 0.2052  MAE: 1.5346  Corr: 0.2635 
2024-06-12 14:27:42:INFO:TRAIN-(cmcm) (8/25/3)>> loss: 0.8138
2024-06-12 14:27:45:INFO:VAL-(cmcm) >>
2024-06-12 14:27:45:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.5799  Non0_acc_2: 0.5880  Non0_F1_score: 0.5898  Mult_acc_5: 0.2445  Mult_acc_7: 0.1878  MAE: 1.5747  Corr: 0.2349 
2024-06-12 14:27:59:INFO:TRAIN-(cmcm) (9/26/3)>> loss: 0.8066
2024-06-12 14:28:02:INFO:VAL-(cmcm) >>
2024-06-12 14:28:02:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5939  Non0_acc_2: 0.6250  Non0_F1_score: 0.6228  Mult_acc_5: 0.2664  Mult_acc_7: 0.1921  MAE: 1.4682  Corr: 0.3506 
2024-06-12 14:28:17:INFO:TRAIN-(cmcm) (10/27/3)>> loss: 0.8102
2024-06-12 14:28:19:INFO:VAL-(cmcm) >>
2024-06-12 14:28:19:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.6082  Non0_acc_2: 0.6296  Non0_F1_score: 0.6254  Mult_acc_5: 0.2969  Mult_acc_7: 0.2314  MAE: 1.4328  Corr: 0.3676 
2024-06-12 14:28:27:INFO:TEST-(cmcm) >>
2024-06-12 14:28:27:INFO:M: >>  Has0_acc_2: 0.5729  Has0_F1_score: 0.5510  Non0_acc_2: 0.5442  Non0_F1_score: 0.5101  Mult_acc_5: 0.1953  Mult_acc_7: 0.1939  MAE: 1.4070  Corr: 0.1102 
2024-06-12 14:28:27:INFO:Results are added to results/results/mosi-regression-70.csv...
2024-06-12 14:28:27:INFO:Start running cmcm...
2024-06-12 14:28:27:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 70, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 4444}>
2024-06-12 14:28:27:INFO:Let's use the GPU 1 !
2024-06-12 14:28:27:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 14:28:28:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718173708 HTTP/1.1" 200 235
2024-06-12 14:28:28:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 14:28:28:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 14:28:29:INFO:train samples: (1284,)
2024-06-12 14:28:29:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 14:28:29:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718173710 HTTP/1.1" 200 235
2024-06-12 14:28:30:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 14:28:30:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 14:28:31:INFO:valid samples: (229,)
2024-06-12 14:28:31:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 14:28:31:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718173711 HTTP/1.1" 200 235
2024-06-12 14:28:31:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 14:28:32:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 14:28:33:INFO:test samples: (686,)
2024-06-12 14:28:33:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 14:28:33:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718173713 HTTP/1.1" 200 235
2024-06-12 14:28:33:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 14:28:33:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 14:28:34:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 14:28:34:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718173714 HTTP/1.1" 200 235
2024-06-12 14:28:34:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 14:28:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 14:28:35:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-12 14:28:35:WARNING:Try importing flash-attention for faster inference...
2024-06-12 14:28:35:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-12 14:28:35:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-12 14:28:35:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-12 14:28:36:INFO:trainable params: 1310284 || all params: 1838138956 || trainable%: 0.07128318540461856
2024-06-12 14:28:36:INFO:Init labels...
2024-06-12 14:28:36:INFO:Start training...
2024-06-12 14:28:51:INFO:TRAIN-(cmcm) (1/1/4)>> loss: 3.9156
2024-06-12 14:28:54:INFO:VAL-(cmcm) >>
2024-06-12 14:28:54:INFO:M: >>  Has0_acc_2: 0.5153  Has0_F1_score: 0.5193  Non0_acc_2: 0.4583  Non0_F1_score: 0.4223  Mult_acc_5: 0.1354  Mult_acc_7: 0.1354  MAE: 1.6231  Corr: 0.0480 
2024-06-12 14:28:54:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-12 14:29:09:INFO:TRAIN-(cmcm) (1/2/4)>> loss: 1.2978
2024-06-12 14:29:12:INFO:VAL-(cmcm) >>
2024-06-12 14:29:12:INFO:M: >>  Has0_acc_2: 0.5240  Has0_F1_score: 0.5248  Non0_acc_2: 0.5185  Non0_F1_score: 0.5061  Mult_acc_5: 0.1921  Mult_acc_7: 0.1878  MAE: 1.5598  Corr: 0.0708 
2024-06-12 14:29:12:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-12 14:29:27:INFO:TRAIN-(cmcm) (1/3/4)>> loss: 1.0422
2024-06-12 14:29:29:INFO:VAL-(cmcm) >>
2024-06-12 14:29:29:INFO:M: >>  Has0_acc_2: 0.5459  Has0_F1_score: 0.5170  Non0_acc_2: 0.5602  Non0_F1_score: 0.5380  Mult_acc_5: 0.1790  Mult_acc_7: 0.1790  MAE: 1.5017  Corr: 0.0075 
2024-06-12 14:29:30:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-mosi-regression.pth.
2024-06-12 14:29:45:INFO:TRAIN-(cmcm) (1/4/4)>> loss: 0.9852
2024-06-12 14:29:47:INFO:VAL-(cmcm) >>
2024-06-12 14:29:47:INFO:M: >>  Has0_acc_2: 0.4847  Has0_F1_score: 0.4799  Non0_acc_2: 0.4861  Non0_F1_score: 0.4769  Mult_acc_5: 0.1485  Mult_acc_7: 0.1485  MAE: 1.6619  Corr: 0.0382 
2024-06-12 14:30:02:INFO:TRAIN-(cmcm) (2/5/4)>> loss: 1.1209
2024-06-12 14:30:04:INFO:VAL-(cmcm) >>
2024-06-12 14:30:04:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.5382  Non0_acc_2: 0.5602  Non0_F1_score: 0.5166  Mult_acc_5: 0.2489  Mult_acc_7: 0.1878  MAE: 1.7023  Corr: -0.0070 
2024-06-12 14:30:20:INFO:TRAIN-(cmcm) (3/6/4)>> loss: 0.9840
2024-06-12 14:30:22:INFO:VAL-(cmcm) >>
2024-06-12 14:30:22:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.4975  Non0_acc_2: 0.5324  Non0_F1_score: 0.4580  Mult_acc_5: 0.1747  Mult_acc_7: 0.1747  MAE: 1.6328  Corr: -0.0644 
2024-06-12 14:30:37:INFO:TRAIN-(cmcm) (4/7/4)>> loss: 0.9544
2024-06-12 14:30:39:INFO:VAL-(cmcm) >>
2024-06-12 14:30:39:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.5688  Non0_acc_2: 0.5602  Non0_F1_score: 0.5605  Mult_acc_5: 0.1747  Mult_acc_7: 0.1747  MAE: 1.5619  Corr: 0.1022 
2024-06-12 14:30:54:INFO:TRAIN-(cmcm) (5/8/4)>> loss: 0.9249
2024-06-12 14:30:57:INFO:VAL-(cmcm) >>
2024-06-12 14:30:57:INFO:M: >>  Has0_acc_2: 0.5459  Has0_F1_score: 0.5352  Non0_acc_2: 0.5370  Non0_F1_score: 0.5245  Mult_acc_5: 0.1659  Mult_acc_7: 0.1659  MAE: 1.6472  Corr: -0.0008 
2024-06-12 14:31:11:INFO:TRAIN-(cmcm) (6/9/4)>> loss: 0.9094
2024-06-12 14:31:14:INFO:VAL-(cmcm) >>
2024-06-12 14:31:14:INFO:M: >>  Has0_acc_2: 0.5590  Has0_F1_score: 0.5244  Non0_acc_2: 0.5463  Non0_F1_score: 0.5092  Mult_acc_5: 0.2576  Mult_acc_7: 0.1965  MAE: 1.6634  Corr: 0.0230 
2024-06-12 14:31:29:INFO:TRAIN-(cmcm) (7/10/4)>> loss: 0.9088
2024-06-12 14:31:31:INFO:VAL-(cmcm) >>
2024-06-12 14:31:31:INFO:M: >>  Has0_acc_2: 0.5022  Has0_F1_score: 0.4750  Non0_acc_2: 0.5231  Non0_F1_score: 0.4963  Mult_acc_5: 0.2052  Mult_acc_7: 0.1747  MAE: 1.8337  Corr: 0.1100 
2024-06-12 14:31:46:INFO:TRAIN-(cmcm) (8/11/4)>> loss: 0.9051
2024-06-12 14:31:48:INFO:VAL-(cmcm) >>
2024-06-12 14:31:48:INFO:M: >>  Has0_acc_2: 0.5590  Has0_F1_score: 0.5244  Non0_acc_2: 0.5463  Non0_F1_score: 0.5121  Mult_acc_5: 0.2489  Mult_acc_7: 0.1703  MAE: 1.7084  Corr: 0.0176 
2024-06-12 14:32:03:INFO:TRAIN-(cmcm) (9/12/4)>> loss: 0.8931
2024-06-12 14:32:06:INFO:VAL-(cmcm) >>
2024-06-12 14:32:06:INFO:M: >>  Has0_acc_2: 0.6245  Has0_F1_score: 0.6157  Non0_acc_2: 0.6111  Non0_F1_score: 0.6032  Mult_acc_5: 0.3057  Mult_acc_7: 0.2271  MAE: 1.5743  Corr: 0.1594 
2024-06-12 14:32:20:INFO:TRAIN-(cmcm) (10/13/4)>> loss: 0.8747
2024-06-12 14:32:23:INFO:VAL-(cmcm) >>
2024-06-12 14:32:23:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.4746  Non0_acc_2: 0.5787  Non0_F1_score: 0.4649  Mult_acc_5: 0.2576  Mult_acc_7: 0.2052  MAE: 1.5864  Corr: 0.0205 
2024-06-12 14:32:30:INFO:TEST-(cmcm) >>
2024-06-12 14:32:30:INFO:M: >>  Has0_acc_2: 0.4854  Has0_F1_score: 0.4717  Non0_acc_2: 0.4863  Non0_F1_score: 0.4809  Mult_acc_5: 0.1793  Mult_acc_7: 0.1793  MAE: 1.6388  Corr: -0.0094 
2024-06-12 14:32:31:INFO:Results are added to results/results/mosi-regression-70.csv...
2024-06-12 14:32:31:INFO:Start running cmcm...
2024-06-12 14:32:31:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 70, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 5555}>
2024-06-12 14:32:31:INFO:Let's use the GPU 1 !
2024-06-12 14:32:31:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 14:32:31:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718173951 HTTP/1.1" 200 235
2024-06-12 14:32:31:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 14:32:32:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 14:32:32:INFO:train samples: (1284,)
2024-06-12 14:32:32:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 14:32:33:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718173953 HTTP/1.1" 200 235
2024-06-12 14:32:33:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 14:32:33:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 14:32:34:INFO:valid samples: (229,)
2024-06-12 14:32:34:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 14:32:34:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718173955 HTTP/1.1" 200 235
2024-06-12 14:32:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 14:32:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 14:32:36:INFO:test samples: (686,)
2024-06-12 14:32:36:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 14:32:36:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718173956 HTTP/1.1" 200 235
2024-06-12 14:32:36:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 14:32:37:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 14:32:37:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 14:32:37:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718173958 HTTP/1.1" 200 235
2024-06-12 14:32:38:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 14:32:38:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 14:32:38:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-12 14:32:38:WARNING:Try importing flash-attention for faster inference...
2024-06-12 14:32:38:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-12 14:32:38:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-12 14:32:38:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-12 14:32:40:INFO:trainable params: 1310284 || all params: 1838138956 || trainable%: 0.07128318540461856
2024-06-12 14:32:40:INFO:Init labels...
2024-06-12 14:32:40:INFO:Start training...
2024-06-12 14:32:54:INFO:TRAIN-(cmcm) (1/1/5)>> loss: 3.4531
2024-06-12 14:32:57:INFO:VAL-(cmcm) >>
2024-06-12 14:32:57:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5648  Non0_F1_score: 0.5320  Mult_acc_5: 0.2140  Mult_acc_7: 0.2140  MAE: 1.4270  Corr: 0.0216 
2024-06-12 14:32:57:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-12 14:33:13:INFO:TRAIN-(cmcm) (1/2/5)>> loss: 1.1039
2024-06-12 14:33:15:INFO:VAL-(cmcm) >>
2024-06-12 14:33:15:INFO:M: >>  Has0_acc_2: 0.5502  Has0_F1_score: 0.5091  Non0_acc_2: 0.5463  Non0_F1_score: 0.5030  Mult_acc_5: 0.2227  Mult_acc_7: 0.1747  MAE: 1.6826  Corr: 0.0018 
2024-06-12 14:33:30:INFO:TRAIN-(cmcm) (2/3/5)>> loss: 0.9268
2024-06-12 14:33:32:INFO:VAL-(cmcm) >>
2024-06-12 14:33:32:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5381  Non0_acc_2: 0.5694  Non0_F1_score: 0.5268  Mult_acc_5: 0.2533  Mult_acc_7: 0.1834  MAE: 1.8232  Corr: -0.0375 
2024-06-12 14:33:47:INFO:TRAIN-(cmcm) (3/4/5)>> loss: 0.9073
2024-06-12 14:33:50:INFO:VAL-(cmcm) >>
2024-06-12 14:33:50:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5787  Non0_F1_score: 0.4370  Mult_acc_5: 0.1659  Mult_acc_7: 0.1659  MAE: 1.4659  Corr: 0.0475 
2024-06-12 14:34:04:INFO:TRAIN-(cmcm) (4/5/5)>> loss: 0.8867
2024-06-12 14:34:07:INFO:VAL-(cmcm) >>
2024-06-12 14:34:07:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4830  Non0_acc_2: 0.5741  Non0_F1_score: 0.4558  Mult_acc_5: 0.1747  Mult_acc_7: 0.1747  MAE: 1.4929  Corr: -0.0100 
2024-06-12 14:34:22:INFO:TRAIN-(cmcm) (5/6/5)>> loss: 0.8786
2024-06-12 14:34:24:INFO:VAL-(cmcm) >>
2024-06-12 14:34:24:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.4730  Non0_acc_2: 0.5602  Non0_F1_score: 0.4540  Mult_acc_5: 0.1616  Mult_acc_7: 0.1616  MAE: 1.5025  Corr: -0.0509 
2024-06-12 14:34:39:INFO:TRAIN-(cmcm) (6/7/5)>> loss: 0.8921
2024-06-12 14:34:41:INFO:VAL-(cmcm) >>
2024-06-12 14:34:41:INFO:M: >>  Has0_acc_2: 0.5459  Has0_F1_score: 0.5497  Non0_acc_2: 0.4398  Non0_F1_score: 0.2841  Mult_acc_5: 0.1747  Mult_acc_7: 0.1703  MAE: 1.5611  Corr: 0.0664 
2024-06-12 14:34:56:INFO:TRAIN-(cmcm) (7/8/5)>> loss: 0.8724
2024-06-12 14:34:59:INFO:VAL-(cmcm) >>
2024-06-12 14:34:59:INFO:M: >>  Has0_acc_2: 0.4541  Has0_F1_score: 0.4230  Non0_acc_2: 0.4676  Non0_F1_score: 0.4349  Mult_acc_5: 0.1354  Mult_acc_7: 0.1354  MAE: 1.8196  Corr: -0.0139 
2024-06-12 14:35:13:INFO:TRAIN-(cmcm) (8/9/5)>> loss: 0.8681
2024-06-12 14:35:16:INFO:VAL-(cmcm) >>
2024-06-12 14:35:16:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.5390  Non0_acc_2: 0.5556  Non0_F1_score: 0.5247  Mult_acc_5: 0.2664  Mult_acc_7: 0.1878  MAE: 1.8188  Corr: 0.0250 
2024-06-12 14:35:31:INFO:TRAIN-(cmcm) (9/10/5)>> loss: 0.8597
2024-06-12 14:35:33:INFO:VAL-(cmcm) >>
2024-06-12 14:35:33:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.5116  Non0_acc_2: 0.5602  Non0_F1_score: 0.4857  Mult_acc_5: 0.2533  Mult_acc_7: 0.2271  MAE: 1.7328  Corr: -0.0282 
2024-06-12 14:35:48:INFO:TRAIN-(cmcm) (10/11/5)>> loss: 0.8616
2024-06-12 14:35:51:INFO:VAL-(cmcm) >>
2024-06-12 14:35:51:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5410  Non0_acc_2: 0.5694  Non0_F1_score: 0.5268  Mult_acc_5: 0.2620  Mult_acc_7: 0.2052  MAE: 1.6774  Corr: 0.0587 
2024-06-12 14:35:58:INFO:TEST-(cmcm) >>
2024-06-12 14:35:58:INFO:M: >>  Has0_acc_2: 0.4446  Has0_F1_score: 0.2755  Non0_acc_2: 0.4802  Non0_F1_score: 0.4491  Mult_acc_5: 0.1545  Mult_acc_7: 0.1545  MAE: 1.4356  Corr: 0.0137 
2024-06-12 14:35:58:INFO:Results are added to results/results/mosi-regression-70.csv...
2024-06-12 14:35:58:INFO:Start running cmcm...
2024-06-12 14:35:58:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 80, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-06-12 14:35:58:INFO:Let's use the GPU 1 !
2024-06-12 14:35:58:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 14:35:59:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718174159 HTTP/1.1" 200 235
2024-06-12 14:35:59:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 14:35:59:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 14:36:00:INFO:train samples: (1284,)
2024-06-12 14:36:00:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 14:36:01:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718174161 HTTP/1.1" 200 235
2024-06-12 14:36:01:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 14:36:01:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 14:36:02:INFO:valid samples: (229,)
2024-06-12 14:36:02:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 14:36:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718174163 HTTP/1.1" 200 235
2024-06-12 14:36:03:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 14:36:03:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 14:36:04:INFO:test samples: (686,)
2024-06-12 14:36:04:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 14:36:04:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718174164 HTTP/1.1" 200 235
2024-06-12 14:36:04:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 14:36:05:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 14:36:05:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 14:36:05:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718174166 HTTP/1.1" 200 235
2024-06-12 14:36:06:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 14:36:06:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 14:36:06:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-12 14:36:06:WARNING:Try importing flash-attention for faster inference...
2024-06-12 14:36:06:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-12 14:36:06:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-12 14:36:06:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-12 14:36:07:INFO:trainable params: 1310284 || all params: 1838138956 || trainable%: 0.07128318540461856
2024-06-12 14:36:07:INFO:Init labels...
2024-06-12 14:36:07:INFO:Start training...
2024-06-12 14:36:22:INFO:TRAIN-(cmcm) (1/1/1)>> loss: 3.8132
2024-06-12 14:36:25:INFO:VAL-(cmcm) >>
2024-06-12 14:36:25:INFO:M: >>  Has0_acc_2: 0.5502  Has0_F1_score: 0.5373  Non0_acc_2: 0.5648  Non0_F1_score: 0.5659  Mult_acc_5: 0.2969  Mult_acc_7: 0.1965  MAE: 1.7711  Corr: 0.0312 
2024-06-12 14:36:25:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-12 14:36:40:INFO:TRAIN-(cmcm) (1/2/1)>> loss: 1.0918
2024-06-12 14:36:43:INFO:VAL-(cmcm) >>
2024-06-12 14:36:43:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5769  Non0_acc_2: 0.5833  Non0_F1_score: 0.5688  Mult_acc_5: 0.2314  Mult_acc_7: 0.1878  MAE: 1.7127  Corr: 0.0841 
2024-06-12 14:36:43:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-12 14:36:58:INFO:TRAIN-(cmcm) (1/3/1)>> loss: 0.9392
2024-06-12 14:37:00:INFO:VAL-(cmcm) >>
2024-06-12 14:37:00:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.5215  Non0_acc_2: 0.5648  Non0_F1_score: 0.5133  Mult_acc_5: 0.1616  Mult_acc_7: 0.1616  MAE: 1.6340  Corr: -0.0337 
2024-06-12 14:37:01:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-mosi-regression.pth.
2024-06-12 14:37:16:INFO:TRAIN-(cmcm) (1/4/1)>> loss: 0.9083
2024-06-12 14:37:18:INFO:VAL-(cmcm) >>
2024-06-12 14:37:18:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.5317  Non0_acc_2: 0.5648  Non0_F1_score: 0.5168  Mult_acc_5: 0.2358  Mult_acc_7: 0.1747  MAE: 1.6922  Corr: 0.0272 
2024-06-12 14:37:33:INFO:TRAIN-(cmcm) (2/5/1)>> loss: 0.9030
2024-06-12 14:37:35:INFO:VAL-(cmcm) >>
2024-06-12 14:37:35:INFO:M: >>  Has0_acc_2: 0.5328  Has0_F1_score: 0.5282  Non0_acc_2: 0.5231  Non0_F1_score: 0.5169  Mult_acc_5: 0.1878  Mult_acc_7: 0.1659  MAE: 1.6453  Corr: 0.0342 
2024-06-12 14:37:50:INFO:TRAIN-(cmcm) (3/6/1)>> loss: 0.8932
2024-06-12 14:37:53:INFO:VAL-(cmcm) >>
2024-06-12 14:37:53:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5879  Non0_acc_2: 0.5880  Non0_F1_score: 0.5877  Mult_acc_5: 0.2882  Mult_acc_7: 0.2358  MAE: 1.5205  Corr: 0.1434 
2024-06-12 14:37:53:INFO:Saving checkpoint at epoch 6 to results/models/cmcm-mosi-regression.pth.
2024-06-12 14:38:08:INFO:TRAIN-(cmcm) (1/7/1)>> loss: 0.8896
2024-06-12 14:38:11:INFO:VAL-(cmcm) >>
2024-06-12 14:38:11:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.4897  Non0_acc_2: 0.5093  Non0_F1_score: 0.5119  Mult_acc_5: 0.2402  Mult_acc_7: 0.2096  MAE: 1.5305  Corr: 0.0090 
2024-06-12 14:38:26:INFO:TRAIN-(cmcm) (2/8/1)>> loss: 0.8847
2024-06-12 14:38:28:INFO:VAL-(cmcm) >>
2024-06-12 14:38:28:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.5153  Non0_acc_2: 0.5509  Non0_F1_score: 0.4960  Mult_acc_5: 0.2795  Mult_acc_7: 0.2009  MAE: 1.7363  Corr: -0.0419 
2024-06-12 14:38:43:INFO:TRAIN-(cmcm) (3/9/1)>> loss: 0.8856
2024-06-12 14:38:46:INFO:VAL-(cmcm) >>
2024-06-12 14:38:46:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4976  Non0_acc_2: 0.5787  Non0_F1_score: 0.4711  Mult_acc_5: 0.2402  Mult_acc_7: 0.1747  MAE: 1.6446  Corr: -0.0202 
2024-06-12 14:39:01:INFO:TRAIN-(cmcm) (4/10/1)>> loss: 0.8824
2024-06-12 14:39:03:INFO:VAL-(cmcm) >>
2024-06-12 14:39:03:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.5699  Non0_acc_2: 0.5694  Non0_F1_score: 0.5536  Mult_acc_5: 0.2664  Mult_acc_7: 0.2052  MAE: 1.6350  Corr: 0.0440 
2024-06-12 14:39:18:INFO:TRAIN-(cmcm) (5/11/1)>> loss: 0.8757
2024-06-12 14:39:20:INFO:VAL-(cmcm) >>
2024-06-12 14:39:20:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.5841  Non0_acc_2: 0.4398  Non0_F1_score: 0.3359  Mult_acc_5: 0.2402  Mult_acc_7: 0.2314  MAE: 1.4646  Corr: 0.1951 
2024-06-12 14:39:21:INFO:Saving checkpoint at epoch 11 to results/models/cmcm-mosi-regression.pth.
2024-06-12 14:39:36:INFO:TRAIN-(cmcm) (1/12/1)>> loss: 0.8622
2024-06-12 14:39:38:INFO:VAL-(cmcm) >>
2024-06-12 14:39:38:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.4897  Non0_acc_2: 0.5648  Non0_F1_score: 0.4627  Mult_acc_5: 0.2795  Mult_acc_7: 0.1965  MAE: 1.8612  Corr: 0.0484 
2024-06-12 14:39:53:INFO:TRAIN-(cmcm) (2/13/1)>> loss: 0.8561
2024-06-12 14:39:55:INFO:VAL-(cmcm) >>
2024-06-12 14:39:55:INFO:M: >>  Has0_acc_2: 0.6288  Has0_F1_score: 0.6208  Non0_acc_2: 0.5833  Non0_F1_score: 0.5855  Mult_acc_5: 0.2926  Mult_acc_7: 0.2271  MAE: 1.4704  Corr: 0.1653 
2024-06-12 14:40:10:INFO:TRAIN-(cmcm) (3/14/1)>> loss: 0.8605
2024-06-12 14:40:13:INFO:VAL-(cmcm) >>
2024-06-12 14:40:13:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5231  Non0_acc_2: 0.5694  Non0_F1_score: 0.5010  Mult_acc_5: 0.2795  Mult_acc_7: 0.2140  MAE: 1.6023  Corr: 0.0441 
2024-06-12 14:40:27:INFO:TRAIN-(cmcm) (4/15/1)>> loss: 0.8552
2024-06-12 14:40:30:INFO:VAL-(cmcm) >>
2024-06-12 14:40:30:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4805  Non0_acc_2: 0.5694  Non0_F1_score: 0.4531  Mult_acc_5: 0.2795  Mult_acc_7: 0.2140  MAE: 1.5742  Corr: 0.1577 
2024-06-12 14:40:45:INFO:TRAIN-(cmcm) (5/16/1)>> loss: 0.8458
2024-06-12 14:40:47:INFO:VAL-(cmcm) >>
2024-06-12 14:40:47:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5761  Non0_acc_2: 0.5833  Non0_F1_score: 0.5856  Mult_acc_5: 0.2795  Mult_acc_7: 0.2140  MAE: 1.6497  Corr: 0.1790 
2024-06-12 14:41:02:INFO:TRAIN-(cmcm) (6/17/1)>> loss: 0.8530
2024-06-12 14:41:04:INFO:VAL-(cmcm) >>
2024-06-12 14:41:04:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.5770  Non0_acc_2: 0.5463  Non0_F1_score: 0.5431  Mult_acc_5: 0.2926  Mult_acc_7: 0.2227  MAE: 1.4996  Corr: 0.1277 
2024-06-12 14:41:19:INFO:TRAIN-(cmcm) (7/18/1)>> loss: 0.8361
2024-06-12 14:41:21:INFO:VAL-(cmcm) >>
2024-06-12 14:41:21:INFO:M: >>  Has0_acc_2: 0.6376  Has0_F1_score: 0.6210  Non0_acc_2: 0.6296  Non0_F1_score: 0.6118  Mult_acc_5: 0.2489  Mult_acc_7: 0.1572  MAE: 1.5593  Corr: 0.1993 
2024-06-12 14:41:36:INFO:TRAIN-(cmcm) (8/19/1)>> loss: 0.8332
2024-06-12 14:41:39:INFO:VAL-(cmcm) >>
2024-06-12 14:41:39:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4976  Non0_acc_2: 0.5926  Non0_F1_score: 0.5215  Mult_acc_5: 0.3188  Mult_acc_7: 0.2489  MAE: 1.4005  Corr: 0.2322 
2024-06-12 14:41:39:INFO:Saving checkpoint at epoch 19 to results/models/cmcm-mosi-regression.pth.
2024-06-12 14:41:54:INFO:TRAIN-(cmcm) (1/20/1)>> loss: 0.8381
2024-06-12 14:41:56:INFO:VAL-(cmcm) >>
2024-06-12 14:41:56:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5886  Non0_acc_2: 0.6111  Non0_F1_score: 0.6047  Mult_acc_5: 0.2140  Mult_acc_7: 0.1878  MAE: 1.4619  Corr: 0.2762 
2024-06-12 14:42:11:INFO:TRAIN-(cmcm) (2/21/1)>> loss: 0.8255
2024-06-12 14:42:14:INFO:VAL-(cmcm) >>
2024-06-12 14:42:14:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.6024  Non0_acc_2: 0.6389  Non0_F1_score: 0.6329  Mult_acc_5: 0.3057  Mult_acc_7: 0.2445  MAE: 1.3285  Corr: 0.3878 
2024-06-12 14:42:14:INFO:Saving checkpoint at epoch 21 to results/models/cmcm-mosi-regression.pth.
2024-06-12 14:42:29:INFO:TRAIN-(cmcm) (1/22/1)>> loss: 0.8138
2024-06-12 14:42:32:INFO:VAL-(cmcm) >>
2024-06-12 14:42:32:INFO:M: >>  Has0_acc_2: 0.6507  Has0_F1_score: 0.6512  Non0_acc_2: 0.6620  Non0_F1_score: 0.6613  Mult_acc_5: 0.3362  Mult_acc_7: 0.2576  MAE: 1.4232  Corr: 0.2820 
2024-06-12 14:42:47:INFO:TRAIN-(cmcm) (2/23/1)>> loss: 0.8143
2024-06-12 14:42:49:INFO:VAL-(cmcm) >>
2024-06-12 14:42:49:INFO:M: >>  Has0_acc_2: 0.6725  Has0_F1_score: 0.6746  Non0_acc_2: 0.6852  Non0_F1_score: 0.6863  Mult_acc_5: 0.3319  Mult_acc_7: 0.2445  MAE: 1.4232  Corr: 0.3494 
2024-06-12 14:43:04:INFO:TRAIN-(cmcm) (3/24/1)>> loss: 0.8059
2024-06-12 14:43:06:INFO:VAL-(cmcm) >>
2024-06-12 14:43:06:INFO:M: >>  Has0_acc_2: 0.6376  Has0_F1_score: 0.6403  Non0_acc_2: 0.6759  Non0_F1_score: 0.6775  Mult_acc_5: 0.3493  Mult_acc_7: 0.2533  MAE: 1.4101  Corr: 0.3659 
2024-06-12 14:43:21:INFO:TRAIN-(cmcm) (4/25/1)>> loss: 0.8074
2024-06-12 14:43:24:INFO:VAL-(cmcm) >>
2024-06-12 14:43:24:INFO:M: >>  Has0_acc_2: 0.6245  Has0_F1_score: 0.6281  Non0_acc_2: 0.6435  Non0_F1_score: 0.6453  Mult_acc_5: 0.3013  Mult_acc_7: 0.2227  MAE: 1.4363  Corr: 0.3124 
2024-06-12 14:43:39:INFO:TRAIN-(cmcm) (5/26/1)>> loss: 0.7983
2024-06-12 14:43:41:INFO:VAL-(cmcm) >>
2024-06-12 14:43:41:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.6063  Non0_acc_2: 0.6204  Non0_F1_score: 0.6065  Mult_acc_5: 0.2096  Mult_acc_7: 0.2096  MAE: 1.3545  Corr: 0.3462 
2024-06-12 14:43:56:INFO:TRAIN-(cmcm) (6/27/1)>> loss: 0.7901
2024-06-12 14:43:59:INFO:VAL-(cmcm) >>
2024-06-12 14:43:59:INFO:M: >>  Has0_acc_2: 0.6507  Has0_F1_score: 0.6537  Non0_acc_2: 0.6898  Non0_F1_score: 0.6914  Mult_acc_5: 0.3362  Mult_acc_7: 0.2707  MAE: 1.3017  Corr: 0.4043 
2024-06-12 14:43:59:INFO:Saving checkpoint at epoch 27 to results/models/cmcm-mosi-regression.pth.
2024-06-12 14:44:14:INFO:TRAIN-(cmcm) (1/28/1)>> loss: 0.7842
2024-06-12 14:44:16:INFO:VAL-(cmcm) >>
2024-06-12 14:44:16:INFO:M: >>  Has0_acc_2: 0.6943  Has0_F1_score: 0.6957  Non0_acc_2: 0.7083  Non0_F1_score: 0.7099  Mult_acc_5: 0.3450  Mult_acc_7: 0.2926  MAE: 1.1787  Corr: 0.4517 
2024-06-12 14:44:17:INFO:Saving checkpoint at epoch 28 to results/models/cmcm-mosi-regression.pth.
2024-06-12 14:44:32:INFO:TRAIN-(cmcm) (1/29/1)>> loss: 0.7703
2024-06-12 14:44:34:INFO:VAL-(cmcm) >>
2024-06-12 14:44:34:INFO:M: >>  Has0_acc_2: 0.6376  Has0_F1_score: 0.6381  Non0_acc_2: 0.6528  Non0_F1_score: 0.6507  Mult_acc_5: 0.3231  Mult_acc_7: 0.2795  MAE: 1.2803  Corr: 0.4154 
2024-06-12 14:44:49:INFO:TRAIN-(cmcm) (2/30/1)>> loss: 0.7739
2024-06-12 14:44:51:INFO:VAL-(cmcm) >>
2024-06-12 14:44:51:INFO:M: >>  Has0_acc_2: 0.7074  Has0_F1_score: 0.7001  Non0_acc_2: 0.6991  Non0_F1_score: 0.6989  Mult_acc_5: 0.3799  Mult_acc_7: 0.3231  MAE: 1.1729  Corr: 0.4441 
2024-06-12 14:44:52:INFO:Saving checkpoint at epoch 30 to results/models/cmcm-mosi-regression.pth.
2024-06-12 14:45:07:INFO:TRAIN-(cmcm) (1/31/1)>> loss: 0.7594
2024-06-12 14:45:09:INFO:VAL-(cmcm) >>
2024-06-12 14:45:09:INFO:M: >>  Has0_acc_2: 0.6725  Has0_F1_score: 0.6733  Non0_acc_2: 0.6435  Non0_F1_score: 0.6427  Mult_acc_5: 0.3188  Mult_acc_7: 0.2838  MAE: 1.2283  Corr: 0.4102 
2024-06-12 14:45:24:INFO:TRAIN-(cmcm) (2/32/1)>> loss: 0.7576
2024-06-12 14:45:27:INFO:VAL-(cmcm) >>
2024-06-12 14:45:27:INFO:M: >>  Has0_acc_2: 0.6245  Has0_F1_score: 0.6259  Non0_acc_2: 0.6343  Non0_F1_score: 0.6297  Mult_acc_5: 0.3231  Mult_acc_7: 0.2882  MAE: 1.3418  Corr: 0.3658 
2024-06-12 14:45:41:INFO:TRAIN-(cmcm) (3/33/1)>> loss: 0.7491
2024-06-12 14:45:44:INFO:VAL-(cmcm) >>
2024-06-12 14:45:44:INFO:M: >>  Has0_acc_2: 0.6812  Has0_F1_score: 0.6499  Non0_acc_2: 0.6898  Non0_F1_score: 0.6726  Mult_acc_5: 0.3362  Mult_acc_7: 0.2620  MAE: 1.2699  Corr: 0.4357 
2024-06-12 14:45:59:INFO:TRAIN-(cmcm) (4/34/1)>> loss: 0.7528
2024-06-12 14:46:01:INFO:VAL-(cmcm) >>
2024-06-12 14:46:01:INFO:M: >>  Has0_acc_2: 0.6856  Has0_F1_score: 0.6689  Non0_acc_2: 0.6898  Non0_F1_score: 0.6741  Mult_acc_5: 0.3450  Mult_acc_7: 0.2620  MAE: 1.3733  Corr: 0.3907 
2024-06-12 14:46:16:INFO:TRAIN-(cmcm) (5/35/1)>> loss: 0.7348
2024-06-12 14:46:19:INFO:VAL-(cmcm) >>
2024-06-12 14:46:19:INFO:M: >>  Has0_acc_2: 0.6769  Has0_F1_score: 0.6681  Non0_acc_2: 0.6991  Non0_F1_score: 0.6903  Mult_acc_5: 0.3581  Mult_acc_7: 0.2707  MAE: 1.2892  Corr: 0.4143 
2024-06-12 14:46:33:INFO:TRAIN-(cmcm) (6/36/1)>> loss: 0.7239
2024-06-12 14:46:36:INFO:VAL-(cmcm) >>
2024-06-12 14:46:36:INFO:M: >>  Has0_acc_2: 0.7074  Has0_F1_score: 0.6896  Non0_acc_2: 0.7315  Non0_F1_score: 0.7251  Mult_acc_5: 0.3537  Mult_acc_7: 0.2882  MAE: 1.1654  Corr: 0.4811 
2024-06-12 14:46:36:INFO:Saving checkpoint at epoch 36 to results/models/cmcm-mosi-regression.pth.
2024-06-12 14:46:51:INFO:TRAIN-(cmcm) (1/37/1)>> loss: 0.7298
2024-06-12 14:46:54:INFO:VAL-(cmcm) >>
2024-06-12 14:46:54:INFO:M: >>  Has0_acc_2: 0.7249  Has0_F1_score: 0.7215  Non0_acc_2: 0.6852  Non0_F1_score: 0.6856  Mult_acc_5: 0.3231  Mult_acc_7: 0.2751  MAE: 1.3008  Corr: 0.4175 
2024-06-12 14:47:08:INFO:TRAIN-(cmcm) (2/38/1)>> loss: 0.7098
2024-06-12 14:47:11:INFO:VAL-(cmcm) >>
2024-06-12 14:47:11:INFO:M: >>  Has0_acc_2: 0.6594  Has0_F1_score: 0.6605  Non0_acc_2: 0.6713  Non0_F1_score: 0.6680  Mult_acc_5: 0.3755  Mult_acc_7: 0.3144  MAE: 1.2136  Corr: 0.4440 
2024-06-12 14:47:26:INFO:TRAIN-(cmcm) (3/39/1)>> loss: 0.7046
2024-06-12 14:47:28:INFO:VAL-(cmcm) >>
2024-06-12 14:47:28:INFO:M: >>  Has0_acc_2: 0.6812  Has0_F1_score: 0.6476  Non0_acc_2: 0.6991  Non0_F1_score: 0.6807  Mult_acc_5: 0.3712  Mult_acc_7: 0.2795  MAE: 1.2612  Corr: 0.4470 
2024-06-12 14:47:43:INFO:TRAIN-(cmcm) (4/40/1)>> loss: 0.6988
2024-06-12 14:47:46:INFO:VAL-(cmcm) >>
2024-06-12 14:47:46:INFO:M: >>  Has0_acc_2: 0.6812  Has0_F1_score: 0.6772  Non0_acc_2: 0.6898  Non0_F1_score: 0.6900  Mult_acc_5: 0.3144  Mult_acc_7: 0.2707  MAE: 1.2715  Corr: 0.3828 
2024-06-12 14:48:00:INFO:TRAIN-(cmcm) (5/41/1)>> loss: 0.6909
2024-06-12 14:48:03:INFO:VAL-(cmcm) >>
2024-06-12 14:48:03:INFO:M: >>  Has0_acc_2: 0.6725  Has0_F1_score: 0.6684  Non0_acc_2: 0.6759  Non0_F1_score: 0.6767  Mult_acc_5: 0.3537  Mult_acc_7: 0.3013  MAE: 1.2293  Corr: 0.4052 
2024-06-12 14:48:18:INFO:TRAIN-(cmcm) (6/42/1)>> loss: 0.6923
2024-06-12 14:48:20:INFO:VAL-(cmcm) >>
2024-06-12 14:48:20:INFO:M: >>  Has0_acc_2: 0.7118  Has0_F1_score: 0.7093  Non0_acc_2: 0.7222  Non0_F1_score: 0.7196  Mult_acc_5: 0.3581  Mult_acc_7: 0.3144  MAE: 1.1598  Corr: 0.4844 
2024-06-12 14:48:20:INFO:Saving checkpoint at epoch 42 to results/models/cmcm-mosi-regression.pth.
2024-06-12 14:48:35:INFO:TRAIN-(cmcm) (1/43/1)>> loss: 0.6791
2024-06-12 14:48:38:INFO:VAL-(cmcm) >>
2024-06-12 14:48:38:INFO:M: >>  Has0_acc_2: 0.7074  Has0_F1_score: 0.7011  Non0_acc_2: 0.7037  Non0_F1_score: 0.7033  Mult_acc_5: 0.3930  Mult_acc_7: 0.3275  MAE: 1.1418  Corr: 0.4816 
2024-06-12 14:48:38:INFO:Saving checkpoint at epoch 43 to results/models/cmcm-mosi-regression.pth.
2024-06-12 14:48:53:INFO:TRAIN-(cmcm) (1/44/1)>> loss: 0.6674
2024-06-12 14:48:56:INFO:VAL-(cmcm) >>
2024-06-12 14:48:56:INFO:M: >>  Has0_acc_2: 0.6419  Has0_F1_score: 0.6454  Non0_acc_2: 0.6574  Non0_F1_score: 0.6588  Mult_acc_5: 0.3319  Mult_acc_7: 0.2664  MAE: 1.2947  Corr: 0.3836 
2024-06-12 14:49:11:INFO:TRAIN-(cmcm) (2/45/1)>> loss: 0.6719
2024-06-12 14:49:13:INFO:VAL-(cmcm) >>
2024-06-12 14:49:13:INFO:M: >>  Has0_acc_2: 0.7074  Has0_F1_score: 0.7082  Non0_acc_2: 0.7222  Non0_F1_score: 0.7222  Mult_acc_5: 0.3319  Mult_acc_7: 0.2838  MAE: 1.2152  Corr: 0.4446 
2024-06-12 14:49:28:INFO:TRAIN-(cmcm) (3/46/1)>> loss: 0.6566
2024-06-12 14:49:31:INFO:VAL-(cmcm) >>
2024-06-12 14:49:31:INFO:M: >>  Has0_acc_2: 0.6987  Has0_F1_score: 0.6957  Non0_acc_2: 0.7037  Non0_F1_score: 0.7016  Mult_acc_5: 0.3188  Mult_acc_7: 0.2707  MAE: 1.2087  Corr: 0.4508 
2024-06-12 14:49:45:INFO:TRAIN-(cmcm) (4/47/1)>> loss: 0.6506
2024-06-12 14:49:48:INFO:VAL-(cmcm) >>
2024-06-12 14:49:48:INFO:M: >>  Has0_acc_2: 0.6987  Has0_F1_score: 0.6849  Non0_acc_2: 0.7037  Non0_F1_score: 0.7016  Mult_acc_5: 0.3581  Mult_acc_7: 0.3100  MAE: 1.1580  Corr: 0.4869 
2024-06-12 14:50:03:INFO:TRAIN-(cmcm) (5/48/1)>> loss: 0.6370
2024-06-12 14:50:05:INFO:VAL-(cmcm) >>
2024-06-12 14:50:05:INFO:M: >>  Has0_acc_2: 0.6812  Has0_F1_score: 0.6772  Non0_acc_2: 0.6898  Non0_F1_score: 0.6910  Mult_acc_5: 0.3537  Mult_acc_7: 0.3013  MAE: 1.2318  Corr: 0.4318 
2024-06-12 14:50:20:INFO:TRAIN-(cmcm) (6/49/1)>> loss: 0.6235
2024-06-12 14:50:22:INFO:VAL-(cmcm) >>
2024-06-12 14:50:22:INFO:M: >>  Has0_acc_2: 0.6594  Has0_F1_score: 0.6610  Non0_acc_2: 0.6944  Non0_F1_score: 0.6948  Mult_acc_5: 0.2969  Mult_acc_7: 0.2576  MAE: 1.2746  Corr: 0.3838 
2024-06-12 14:50:37:INFO:TRAIN-(cmcm) (7/50/1)>> loss: 0.6246
2024-06-12 14:50:40:INFO:VAL-(cmcm) >>
2024-06-12 14:50:40:INFO:M: >>  Has0_acc_2: 0.6638  Has0_F1_score: 0.6605  Non0_acc_2: 0.6713  Non0_F1_score: 0.6723  Mult_acc_5: 0.3624  Mult_acc_7: 0.3144  MAE: 1.2305  Corr: 0.4427 
2024-06-12 14:50:54:INFO:TRAIN-(cmcm) (8/51/1)>> loss: 0.6075
2024-06-12 14:50:57:INFO:VAL-(cmcm) >>
2024-06-12 14:50:57:INFO:M: >>  Has0_acc_2: 0.6943  Has0_F1_score: 0.6931  Non0_acc_2: 0.7222  Non0_F1_score: 0.7218  Mult_acc_5: 0.3100  Mult_acc_7: 0.2445  MAE: 1.2117  Corr: 0.4545 
2024-06-12 14:51:12:INFO:TRAIN-(cmcm) (9/52/1)>> loss: 0.6061
2024-06-12 14:51:14:INFO:VAL-(cmcm) >>
2024-06-12 14:51:14:INFO:M: >>  Has0_acc_2: 0.6943  Has0_F1_score: 0.6957  Non0_acc_2: 0.7222  Non0_F1_score: 0.7222  Mult_acc_5: 0.3100  Mult_acc_7: 0.2664  MAE: 1.2510  Corr: 0.4422 
2024-06-12 14:51:29:INFO:TRAIN-(cmcm) (10/53/1)>> loss: 0.5933
2024-06-12 14:51:31:INFO:VAL-(cmcm) >>
2024-06-12 14:51:31:INFO:M: >>  Has0_acc_2: 0.6725  Has0_F1_score: 0.6701  Non0_acc_2: 0.7083  Non0_F1_score: 0.7081  Mult_acc_5: 0.3624  Mult_acc_7: 0.2838  MAE: 1.2296  Corr: 0.4523 
2024-06-12 14:51:39:INFO:TEST-(cmcm) >>
2024-06-12 14:51:39:INFO:M: >>  Has0_acc_2: 0.7041  Has0_F1_score: 0.7046  Non0_acc_2: 0.7073  Non0_F1_score: 0.7085  Mult_acc_5: 0.2959  Mult_acc_7: 0.2653  MAE: 1.2198  Corr: 0.4811 
2024-06-12 14:51:39:INFO:Results are added to results/results/mosi-regression-80.csv...
2024-06-12 14:51:39:INFO:Start running cmcm...
2024-06-12 14:51:39:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 80, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 2222}>
2024-06-12 14:51:39:INFO:Let's use the GPU 1 !
2024-06-12 14:51:39:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 14:51:39:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718175100 HTTP/1.1" 200 235
2024-06-12 14:51:40:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 14:51:40:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 14:51:41:INFO:train samples: (1284,)
2024-06-12 14:51:41:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 14:51:42:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718175102 HTTP/1.1" 200 235
2024-06-12 14:51:42:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 14:51:42:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 14:51:43:INFO:valid samples: (229,)
2024-06-12 14:51:43:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 14:51:44:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718175104 HTTP/1.1" 200 235
2024-06-12 14:51:44:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 14:51:44:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 14:51:45:INFO:test samples: (686,)
2024-06-12 14:51:45:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 14:51:45:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718175105 HTTP/1.1" 200 235
2024-06-12 14:51:45:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 14:51:46:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 14:51:46:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 14:51:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718175107 HTTP/1.1" 200 235
2024-06-12 14:51:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 14:51:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 14:51:47:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-12 14:51:47:WARNING:Try importing flash-attention for faster inference...
2024-06-12 14:51:47:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-12 14:51:47:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-12 14:51:47:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-12 14:51:49:INFO:trainable params: 1310284 || all params: 1838138956 || trainable%: 0.07128318540461856
2024-06-12 14:51:49:INFO:Init labels...
2024-06-12 14:51:49:INFO:Start training...
2024-06-12 14:52:04:INFO:TRAIN-(cmcm) (1/1/2)>> loss: 4.2668
2024-06-12 14:52:06:INFO:VAL-(cmcm) >>
2024-06-12 14:52:06:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4259  Non0_F1_score: 0.2544  Mult_acc_5: 0.2140  Mult_acc_7: 0.2140  MAE: 1.4370  Corr: nan 
2024-06-12 14:52:07:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-12 14:52:22:INFO:TRAIN-(cmcm) (1/2/2)>> loss: 1.9643
2024-06-12 14:52:25:INFO:VAL-(cmcm) >>
2024-06-12 14:52:25:INFO:M: >>  Has0_acc_2: 0.5546  Has0_F1_score: 0.5287  Non0_acc_2: 0.5324  Non0_F1_score: 0.5189  Mult_acc_5: 0.2271  Mult_acc_7: 0.1921  MAE: 1.7245  Corr: -0.0780 
2024-06-12 14:52:40:INFO:TRAIN-(cmcm) (2/3/2)>> loss: 1.0161
2024-06-12 14:52:43:INFO:VAL-(cmcm) >>
2024-06-12 14:52:43:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.4843  Non0_acc_2: 0.5370  Non0_F1_score: 0.4512  Mult_acc_5: 0.2751  Mult_acc_7: 0.2096  MAE: 1.7289  Corr: -0.0719 
2024-06-12 14:52:58:INFO:TRAIN-(cmcm) (3/4/2)>> loss: 0.9391
2024-06-12 14:53:00:INFO:VAL-(cmcm) >>
2024-06-12 14:53:00:INFO:M: >>  Has0_acc_2: 0.5502  Has0_F1_score: 0.5204  Non0_acc_2: 0.4583  Non0_F1_score: 0.4593  Mult_acc_5: 0.1965  Mult_acc_7: 0.1878  MAE: 1.5861  Corr: -0.0450 
2024-06-12 14:53:15:INFO:TRAIN-(cmcm) (4/5/2)>> loss: 0.9111
2024-06-12 14:53:18:INFO:VAL-(cmcm) >>
2024-06-12 14:53:18:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.5352  Non0_acc_2: 0.5833  Non0_F1_score: 0.5106  Mult_acc_5: 0.1921  Mult_acc_7: 0.1659  MAE: 1.5782  Corr: 0.0496 
2024-06-12 14:53:33:INFO:TRAIN-(cmcm) (5/6/2)>> loss: 0.8953
2024-06-12 14:53:35:INFO:VAL-(cmcm) >>
2024-06-12 14:53:35:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.5552  Non0_acc_2: 0.5509  Non0_F1_score: 0.5379  Mult_acc_5: 0.2795  Mult_acc_7: 0.2052  MAE: 1.7437  Corr: 0.0478 
2024-06-12 14:53:50:INFO:TRAIN-(cmcm) (6/7/2)>> loss: 0.8849
2024-06-12 14:53:52:INFO:VAL-(cmcm) >>
2024-06-12 14:53:52:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5611  Non0_acc_2: 0.5787  Non0_F1_score: 0.5507  Mult_acc_5: 0.1703  Mult_acc_7: 0.1528  MAE: 1.6298  Corr: 0.0798 
2024-06-12 14:54:07:INFO:TRAIN-(cmcm) (7/8/2)>> loss: 0.8870
2024-06-12 14:54:10:INFO:VAL-(cmcm) >>
2024-06-12 14:54:10:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.5873  Non0_acc_2: 0.5741  Non0_F1_score: 0.5751  Mult_acc_5: 0.2664  Mult_acc_7: 0.2052  MAE: 1.5918  Corr: 0.1044 
2024-06-12 14:54:25:INFO:TRAIN-(cmcm) (8/9/2)>> loss: 0.8703
2024-06-12 14:54:27:INFO:VAL-(cmcm) >>
2024-06-12 14:54:27:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5648  Non0_acc_2: 0.5694  Non0_F1_score: 0.5613  Mult_acc_5: 0.1703  Mult_acc_7: 0.1703  MAE: 1.5555  Corr: 0.0734 
2024-06-12 14:54:42:INFO:TRAIN-(cmcm) (9/10/2)>> loss: 0.8798
2024-06-12 14:54:45:INFO:VAL-(cmcm) >>
2024-06-12 14:54:45:INFO:M: >>  Has0_acc_2: 0.6201  Has0_F1_score: 0.5302  Non0_acc_2: 0.5972  Non0_F1_score: 0.5054  Mult_acc_5: 0.2402  Mult_acc_7: 0.2096  MAE: 1.6114  Corr: 0.0017 
2024-06-12 14:55:00:INFO:TRAIN-(cmcm) (10/11/2)>> loss: 0.8626
2024-06-12 14:55:02:INFO:VAL-(cmcm) >>
2024-06-12 14:55:02:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.5216  Non0_acc_2: 0.5833  Non0_F1_score: 0.4963  Mult_acc_5: 0.3100  Mult_acc_7: 0.2271  MAE: 1.7691  Corr: 0.0396 
2024-06-12 14:55:10:INFO:TEST-(cmcm) >>
2024-06-12 14:55:10:INFO:M: >>  Has0_acc_2: 0.4475  Has0_F1_score: 0.2767  Non0_acc_2: 0.5777  Non0_F1_score: 0.4231  Mult_acc_5: 0.1545  Mult_acc_7: 0.1545  MAE: 1.4174  Corr: nan 
2024-06-12 14:55:10:INFO:Results are added to results/results/mosi-regression-80.csv...
2024-06-12 14:55:10:INFO:Start running cmcm...
2024-06-12 14:55:10:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 80, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 3333}>
2024-06-12 14:55:10:INFO:Let's use the GPU 1 !
2024-06-12 14:55:10:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 14:55:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718175310 HTTP/1.1" 200 235
2024-06-12 14:55:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 14:55:11:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 14:55:12:INFO:train samples: (1284,)
2024-06-12 14:55:12:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 14:55:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718175312 HTTP/1.1" 200 235
2024-06-12 14:55:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 14:55:13:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 14:55:13:INFO:valid samples: (229,)
2024-06-12 14:55:13:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 14:55:14:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718175314 HTTP/1.1" 200 235
2024-06-12 14:55:14:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 14:55:14:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 14:55:15:INFO:test samples: (686,)
2024-06-12 14:55:15:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 14:55:15:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718175315 HTTP/1.1" 200 235
2024-06-12 14:55:15:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 14:55:16:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 14:55:16:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 14:55:17:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718175317 HTTP/1.1" 200 235
2024-06-12 14:55:17:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 14:55:17:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 14:55:17:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-12 14:55:17:WARNING:Try importing flash-attention for faster inference...
2024-06-12 14:55:17:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-12 14:55:17:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-12 14:55:17:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-12 14:55:19:INFO:trainable params: 1310284 || all params: 1838138956 || trainable%: 0.07128318540461856
2024-06-12 14:55:19:INFO:Init labels...
2024-06-12 14:55:19:INFO:Start training...
2024-06-12 14:55:33:INFO:TRAIN-(cmcm) (1/1/3)>> loss: 4.3362
2024-06-12 14:55:36:INFO:VAL-(cmcm) >>
2024-06-12 14:55:36:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4259  Non0_F1_score: 0.2544  Mult_acc_5: 0.2140  Mult_acc_7: 0.2140  MAE: 1.4370  Corr: nan 
2024-06-12 14:55:36:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-12 14:55:51:INFO:TRAIN-(cmcm) (1/2/3)>> loss: 3.6403
2024-06-12 14:55:54:INFO:VAL-(cmcm) >>
2024-06-12 14:55:54:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5602  Non0_F1_score: 0.5099  Mult_acc_5: 0.3144  Mult_acc_7: 0.1354  MAE: 2.4023  Corr: 0.0055 
2024-06-12 14:56:09:INFO:TRAIN-(cmcm) (2/3/3)>> loss: 1.5170
2024-06-12 14:56:11:INFO:VAL-(cmcm) >>
2024-06-12 14:56:11:INFO:M: >>  Has0_acc_2: 0.5459  Has0_F1_score: 0.5352  Non0_acc_2: 0.5370  Non0_F1_score: 0.5245  Mult_acc_5: 0.1616  Mult_acc_7: 0.1485  MAE: 1.7532  Corr: 0.0441 
2024-06-12 14:56:26:INFO:TRAIN-(cmcm) (3/4/3)>> loss: 0.9613
2024-06-12 14:56:28:INFO:VAL-(cmcm) >>
2024-06-12 14:56:28:INFO:M: >>  Has0_acc_2: 0.4585  Has0_F1_score: 0.4263  Non0_acc_2: 0.4398  Non0_F1_score: 0.3823  Mult_acc_5: 0.1616  Mult_acc_7: 0.1528  MAE: 1.7846  Corr: -0.0056 
2024-06-12 14:56:43:INFO:TRAIN-(cmcm) (4/5/3)>> loss: 0.9136
2024-06-12 14:56:46:INFO:VAL-(cmcm) >>
2024-06-12 14:56:46:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.4815  Non0_acc_2: 0.4630  Non0_F1_score: 0.4555  Mult_acc_5: 0.2052  Mult_acc_7: 0.2009  MAE: 1.4549  Corr: 0.0313 
2024-06-12 14:57:01:INFO:TRAIN-(cmcm) (5/6/3)>> loss: 0.8848
2024-06-12 14:57:03:INFO:VAL-(cmcm) >>
2024-06-12 14:57:03:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.4718  Non0_acc_2: 0.5648  Non0_F1_score: 0.4440  Mult_acc_5: 0.2882  Mult_acc_7: 0.2052  MAE: 1.7084  Corr: -0.0380 
2024-06-12 14:57:18:INFO:TRAIN-(cmcm) (6/7/3)>> loss: 0.8821
2024-06-12 14:57:20:INFO:VAL-(cmcm) >>
2024-06-12 14:57:20:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.4755  Non0_acc_2: 0.5509  Non0_F1_score: 0.4425  Mult_acc_5: 0.2183  Mult_acc_7: 0.1790  MAE: 1.6586  Corr: -0.1049 
2024-06-12 14:57:35:INFO:TRAIN-(cmcm) (7/8/3)>> loss: 0.8822
2024-06-12 14:57:38:INFO:VAL-(cmcm) >>
2024-06-12 14:57:38:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4917  Non0_acc_2: 0.5741  Non0_F1_score: 0.4797  Mult_acc_5: 0.2707  Mult_acc_7: 0.1965  MAE: 1.6459  Corr: 0.0717 
2024-06-12 14:57:52:INFO:TRAIN-(cmcm) (8/9/3)>> loss: 0.8686
2024-06-12 14:57:55:INFO:VAL-(cmcm) >>
2024-06-12 14:57:55:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.4606  Non0_acc_2: 0.5370  Non0_F1_score: 0.5021  Mult_acc_5: 0.1878  Mult_acc_7: 0.1834  MAE: 1.5568  Corr: 0.0206 
2024-06-12 14:58:10:INFO:TRAIN-(cmcm) (9/10/3)>> loss: 0.8653
2024-06-12 14:58:12:INFO:VAL-(cmcm) >>
2024-06-12 14:58:12:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.4539  Non0_acc_2: 0.5556  Non0_F1_score: 0.4321  Mult_acc_5: 0.2096  Mult_acc_7: 0.1747  MAE: 1.5817  Corr: -0.0434 
2024-06-12 14:58:27:INFO:TRAIN-(cmcm) (10/11/3)>> loss: 0.8623
2024-06-12 14:58:29:INFO:VAL-(cmcm) >>
2024-06-12 14:58:29:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4805  Non0_acc_2: 0.5787  Non0_F1_score: 0.5198  Mult_acc_5: 0.2751  Mult_acc_7: 0.2533  MAE: 1.5852  Corr: 0.0666 
2024-06-12 14:58:37:INFO:TEST-(cmcm) >>
2024-06-12 14:58:37:INFO:M: >>  Has0_acc_2: 0.4475  Has0_F1_score: 0.2767  Non0_acc_2: 0.5793  Non0_F1_score: 0.4266  Mult_acc_5: 0.1545  Mult_acc_7: 0.1545  MAE: 1.4159  Corr: 0.0654 
2024-06-12 14:58:38:INFO:Results are added to results/results/mosi-regression-80.csv...
2024-06-12 14:58:38:INFO:Start running cmcm...
2024-06-12 14:58:38:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 80, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 4444}>
2024-06-12 14:58:38:INFO:Let's use the GPU 1 !
2024-06-12 14:58:38:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 14:58:38:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718175518 HTTP/1.1" 200 235
2024-06-12 14:58:38:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 14:58:39:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 14:58:39:INFO:train samples: (1284,)
2024-06-12 14:58:40:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 14:58:40:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718175520 HTTP/1.1" 200 235
2024-06-12 14:58:40:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 14:58:40:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 14:58:41:INFO:valid samples: (229,)
2024-06-12 14:58:41:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 14:58:41:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718175522 HTTP/1.1" 200 235
2024-06-12 14:58:42:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 14:58:42:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 14:58:43:INFO:test samples: (686,)
2024-06-12 14:58:43:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 14:58:43:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718175523 HTTP/1.1" 200 235
2024-06-12 14:58:43:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 14:58:43:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 14:58:44:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 14:58:44:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718175524 HTTP/1.1" 200 235
2024-06-12 14:58:44:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 14:58:45:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 14:58:45:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-12 14:58:45:WARNING:Try importing flash-attention for faster inference...
2024-06-12 14:58:45:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-12 14:58:45:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-12 14:58:45:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-12 14:58:46:INFO:trainable params: 1310284 || all params: 1838138956 || trainable%: 0.07128318540461856
2024-06-12 14:58:46:INFO:Init labels...
2024-06-12 14:58:46:INFO:Start training...
2024-06-12 14:59:01:INFO:TRAIN-(cmcm) (1/1/4)>> loss: 3.9842
2024-06-12 14:59:04:INFO:VAL-(cmcm) >>
2024-06-12 14:59:04:INFO:M: >>  Has0_acc_2: 0.4803  Has0_F1_score: 0.4749  Non0_acc_2: 0.4398  Non0_F1_score: 0.3743  Mult_acc_5: 0.1266  Mult_acc_7: 0.1266  MAE: 1.6991  Corr: 0.0357 
2024-06-12 14:59:04:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-12 14:59:19:INFO:TRAIN-(cmcm) (1/2/4)>> loss: 1.5356
2024-06-12 14:59:22:INFO:VAL-(cmcm) >>
2024-06-12 14:59:22:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4458  Non0_acc_2: 0.5370  Non0_F1_score: 0.4860  Mult_acc_5: 0.1659  Mult_acc_7: 0.1485  MAE: 1.5152  Corr: 0.0196 
2024-06-12 14:59:22:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-12 14:59:37:INFO:TRAIN-(cmcm) (1/3/4)>> loss: 1.0783
2024-06-12 14:59:40:INFO:VAL-(cmcm) >>
2024-06-12 14:59:40:INFO:M: >>  Has0_acc_2: 0.5371  Has0_F1_score: 0.5307  Non0_acc_2: 0.5463  Non0_F1_score: 0.5409  Mult_acc_5: 0.2358  Mult_acc_7: 0.1790  MAE: 1.6992  Corr: 0.0027 
2024-06-12 14:59:55:INFO:TRAIN-(cmcm) (2/4/4)>> loss: 1.0025
2024-06-12 14:59:57:INFO:VAL-(cmcm) >>
2024-06-12 14:59:58:INFO:M: >>  Has0_acc_2: 0.5022  Has0_F1_score: 0.5045  Non0_acc_2: 0.5278  Non0_F1_score: 0.5284  Mult_acc_5: 0.1965  Mult_acc_7: 0.1834  MAE: 1.6052  Corr: -0.0292 
2024-06-12 15:00:12:INFO:TRAIN-(cmcm) (3/5/4)>> loss: 0.9826
2024-06-12 15:00:15:INFO:VAL-(cmcm) >>
2024-06-12 15:00:15:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.5458  Non0_acc_2: 0.5278  Non0_F1_score: 0.5196  Mult_acc_5: 0.2052  Mult_acc_7: 0.2052  MAE: 1.4774  Corr: 0.0012 
2024-06-12 15:00:15:INFO:Saving checkpoint at epoch 5 to results/models/cmcm-mosi-regression.pth.
2024-06-12 15:00:30:INFO:TRAIN-(cmcm) (1/6/4)>> loss: 0.9798
2024-06-12 15:00:33:INFO:VAL-(cmcm) >>
2024-06-12 15:00:33:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.4814  Non0_acc_2: 0.5833  Non0_F1_score: 0.4911  Mult_acc_5: 0.2140  Mult_acc_7: 0.2096  MAE: 1.5385  Corr: 0.0147 
2024-06-12 15:00:48:INFO:TRAIN-(cmcm) (2/7/4)>> loss: 0.9466
2024-06-12 15:00:50:INFO:VAL-(cmcm) >>
2024-06-12 15:00:50:INFO:M: >>  Has0_acc_2: 0.5590  Has0_F1_score: 0.5018  Non0_acc_2: 0.5463  Non0_F1_score: 0.4888  Mult_acc_5: 0.1834  Mult_acc_7: 0.1790  MAE: 1.6271  Corr: -0.0111 
2024-06-12 15:01:05:INFO:TRAIN-(cmcm) (3/8/4)>> loss: 0.9420
2024-06-12 15:01:07:INFO:VAL-(cmcm) >>
2024-06-12 15:01:07:INFO:M: >>  Has0_acc_2: 0.4279  Has0_F1_score: 0.3207  Non0_acc_2: 0.4537  Non0_F1_score: 0.3496  Mult_acc_5: 0.2489  Mult_acc_7: 0.2358  MAE: 1.5667  Corr: -0.0242 
2024-06-12 15:01:22:INFO:TRAIN-(cmcm) (4/9/4)>> loss: 0.9309
2024-06-12 15:01:25:INFO:VAL-(cmcm) >>
2024-06-12 15:01:25:INFO:M: >>  Has0_acc_2: 0.5371  Has0_F1_score: 0.4932  Non0_acc_2: 0.5324  Non0_F1_score: 0.4861  Mult_acc_5: 0.1572  Mult_acc_7: 0.1572  MAE: 1.5916  Corr: -0.0382 
2024-06-12 15:01:39:INFO:TRAIN-(cmcm) (5/10/4)>> loss: 0.9033
2024-06-12 15:01:42:INFO:VAL-(cmcm) >>
2024-06-12 15:01:42:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5850  Non0_acc_2: 0.5926  Non0_F1_score: 0.5855  Mult_acc_5: 0.2882  Mult_acc_7: 0.2052  MAE: 1.6289  Corr: 0.1565 
2024-06-12 15:01:57:INFO:TRAIN-(cmcm) (6/11/4)>> loss: 0.8996
2024-06-12 15:01:59:INFO:VAL-(cmcm) >>
2024-06-12 15:01:59:INFO:M: >>  Has0_acc_2: 0.6288  Has0_F1_score: 0.6042  Non0_acc_2: 0.6157  Non0_F1_score: 0.5902  Mult_acc_5: 0.3013  Mult_acc_7: 0.2183  MAE: 1.5149  Corr: 0.2318 
2024-06-12 15:02:14:INFO:TRAIN-(cmcm) (7/12/4)>> loss: 0.8953
2024-06-12 15:02:17:INFO:VAL-(cmcm) >>
2024-06-12 15:02:17:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.5284  Non0_acc_2: 0.5602  Non0_F1_score: 0.5134  Mult_acc_5: 0.2751  Mult_acc_7: 0.2052  MAE: 1.6258  Corr: 0.0451 
2024-06-12 15:02:32:INFO:TRAIN-(cmcm) (8/13/4)>> loss: 0.8818
2024-06-12 15:02:34:INFO:VAL-(cmcm) >>
2024-06-12 15:02:34:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4976  Non0_acc_2: 0.5787  Non0_F1_score: 0.4711  Mult_acc_5: 0.2227  Mult_acc_7: 0.2052  MAE: 1.5698  Corr: 0.0036 
2024-06-12 15:02:49:INFO:TRAIN-(cmcm) (9/14/4)>> loss: 0.8706
2024-06-12 15:02:51:INFO:VAL-(cmcm) >>
2024-06-12 15:02:51:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.5187  Non0_acc_2: 0.5694  Non0_F1_score: 0.4871  Mult_acc_5: 0.2707  Mult_acc_7: 0.1965  MAE: 1.6298  Corr: 0.0077 
2024-06-12 15:03:06:INFO:TRAIN-(cmcm) (10/15/4)>> loss: 0.8717
2024-06-12 15:03:09:INFO:VAL-(cmcm) >>
2024-06-12 15:03:09:INFO:M: >>  Has0_acc_2: 0.6376  Has0_F1_score: 0.6210  Non0_acc_2: 0.6296  Non0_F1_score: 0.6118  Mult_acc_5: 0.2707  Mult_acc_7: 0.2052  MAE: 1.4608  Corr: 0.2049 
2024-06-12 15:03:09:INFO:Saving checkpoint at epoch 15 to results/models/cmcm-mosi-regression.pth.
2024-06-12 15:03:24:INFO:TRAIN-(cmcm) (1/16/4)>> loss: 0.8593
2024-06-12 15:03:26:INFO:VAL-(cmcm) >>
2024-06-12 15:03:26:INFO:M: >>  Has0_acc_2: 0.6419  Has0_F1_score: 0.5875  Non0_acc_2: 0.6157  Non0_F1_score: 0.5687  Mult_acc_5: 0.2140  Mult_acc_7: 0.2140  MAE: 1.3999  Corr: 0.1532 
2024-06-12 15:03:27:INFO:Saving checkpoint at epoch 16 to results/models/cmcm-mosi-regression.pth.
2024-06-12 15:03:42:INFO:TRAIN-(cmcm) (1/17/4)>> loss: 0.8623
2024-06-12 15:03:44:INFO:VAL-(cmcm) >>
2024-06-12 15:03:44:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4923  Non0_acc_2: 0.5880  Non0_F1_score: 0.5441  Mult_acc_5: 0.2227  Mult_acc_7: 0.2096  MAE: 1.5293  Corr: 0.0987 
2024-06-12 15:03:59:INFO:TRAIN-(cmcm) (2/18/4)>> loss: 0.8593
2024-06-12 15:04:02:INFO:VAL-(cmcm) >>
2024-06-12 15:04:02:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.4769  Non0_acc_2: 0.5880  Non0_F1_score: 0.4494  Mult_acc_5: 0.2882  Mult_acc_7: 0.2052  MAE: 1.6682  Corr: 0.1071 
2024-06-12 15:04:17:INFO:TRAIN-(cmcm) (3/19/4)>> loss: 0.8505
2024-06-12 15:04:19:INFO:VAL-(cmcm) >>
2024-06-12 15:04:19:INFO:M: >>  Has0_acc_2: 0.6201  Has0_F1_score: 0.4955  Non0_acc_2: 0.6019  Non0_F1_score: 0.4784  Mult_acc_5: 0.2707  Mult_acc_7: 0.2314  MAE: 1.5451  Corr: 0.1634 
2024-06-12 15:04:34:INFO:TRAIN-(cmcm) (4/20/4)>> loss: 0.8580
2024-06-12 15:04:37:INFO:VAL-(cmcm) >>
2024-06-12 15:04:37:INFO:M: >>  Has0_acc_2: 0.6332  Has0_F1_score: 0.6291  Non0_acc_2: 0.4815  Non0_F1_score: 0.4109  Mult_acc_5: 0.2183  Mult_acc_7: 0.2183  MAE: 1.4445  Corr: 0.1882 
2024-06-12 15:04:52:INFO:TRAIN-(cmcm) (5/21/4)>> loss: 0.8558
2024-06-12 15:04:54:INFO:VAL-(cmcm) >>
2024-06-12 15:04:54:INFO:M: >>  Has0_acc_2: 0.6157  Has0_F1_score: 0.4863  Non0_acc_2: 0.5926  Non0_F1_score: 0.4592  Mult_acc_5: 0.3057  Mult_acc_7: 0.2271  MAE: 1.7075  Corr: 0.0682 
2024-06-12 15:05:09:INFO:TRAIN-(cmcm) (6/22/4)>> loss: 0.8599
2024-06-12 15:05:12:INFO:VAL-(cmcm) >>
2024-06-12 15:05:12:INFO:M: >>  Has0_acc_2: 0.6638  Has0_F1_score: 0.6353  Non0_acc_2: 0.6204  Non0_F1_score: 0.6021  Mult_acc_5: 0.2795  Mult_acc_7: 0.2533  MAE: 1.4616  Corr: 0.1730 
2024-06-12 15:05:26:INFO:TRAIN-(cmcm) (7/23/4)>> loss: 0.8393
2024-06-12 15:05:29:INFO:VAL-(cmcm) >>
2024-06-12 15:05:29:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4891  Non0_acc_2: 0.5787  Non0_F1_score: 0.4711  Mult_acc_5: 0.2882  Mult_acc_7: 0.2140  MAE: 1.7328  Corr: 0.0107 
2024-06-12 15:05:44:INFO:TRAIN-(cmcm) (8/24/4)>> loss: 0.8491
2024-06-12 15:05:46:INFO:VAL-(cmcm) >>
2024-06-12 15:05:46:INFO:M: >>  Has0_acc_2: 0.6245  Has0_F1_score: 0.5168  Non0_acc_2: 0.6065  Non0_F1_score: 0.5002  Mult_acc_5: 0.2620  Mult_acc_7: 0.2402  MAE: 1.5331  Corr: 0.1183 
2024-06-12 15:06:01:INFO:TRAIN-(cmcm) (9/25/4)>> loss: 0.8422
2024-06-12 15:06:03:INFO:VAL-(cmcm) >>
2024-06-12 15:06:03:INFO:M: >>  Has0_acc_2: 0.6288  Has0_F1_score: 0.6278  Non0_acc_2: 0.6250  Non0_F1_score: 0.6227  Mult_acc_5: 0.2751  Mult_acc_7: 0.2489  MAE: 1.5239  Corr: 0.1605 
2024-06-12 15:06:18:INFO:TRAIN-(cmcm) (10/26/4)>> loss: 0.8370
2024-06-12 15:06:21:INFO:VAL-(cmcm) >>
2024-06-12 15:06:21:INFO:M: >>  Has0_acc_2: 0.6550  Has0_F1_score: 0.5779  Non0_acc_2: 0.6481  Non0_F1_score: 0.6005  Mult_acc_5: 0.3057  Mult_acc_7: 0.2445  MAE: 1.5376  Corr: 0.2496 
2024-06-12 15:06:28:INFO:TEST-(cmcm) >>
2024-06-12 15:06:28:INFO:M: >>  Has0_acc_2: 0.5627  Has0_F1_score: 0.5537  Non0_acc_2: 0.5518  Non0_F1_score: 0.5484  Mult_acc_5: 0.1880  Mult_acc_7: 0.1778  MAE: 1.4387  Corr: 0.1570 
2024-06-12 15:06:28:INFO:Results are added to results/results/mosi-regression-80.csv...
2024-06-12 15:06:28:INFO:Start running cmcm...
2024-06-12 15:06:28:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 80, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 5555}>
2024-06-12 15:06:28:INFO:Let's use the GPU 1 !
2024-06-12 15:06:28:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 15:06:29:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718175989 HTTP/1.1" 200 235
2024-06-12 15:06:29:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 15:06:29:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 15:06:30:INFO:train samples: (1284,)
2024-06-12 15:06:30:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 15:06:31:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718175991 HTTP/1.1" 200 235
2024-06-12 15:06:31:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 15:06:32:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 15:06:32:INFO:valid samples: (229,)
2024-06-12 15:06:32:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 15:06:33:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718175993 HTTP/1.1" 200 235
2024-06-12 15:06:33:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 15:06:33:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 15:06:34:INFO:test samples: (686,)
2024-06-12 15:06:34:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 15:06:34:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718175995 HTTP/1.1" 200 235
2024-06-12 15:06:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 15:06:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 15:06:36:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 15:06:36:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718175996 HTTP/1.1" 200 235
2024-06-12 15:06:37:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 15:06:37:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 15:06:37:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-12 15:06:37:WARNING:Try importing flash-attention for faster inference...
2024-06-12 15:06:37:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-12 15:06:37:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-12 15:06:37:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-12 15:06:39:INFO:trainable params: 1310284 || all params: 1838138956 || trainable%: 0.07128318540461856
2024-06-12 15:06:39:INFO:Init labels...
2024-06-12 15:06:39:INFO:Start training...
2024-06-12 15:06:54:INFO:TRAIN-(cmcm) (1/1/5)>> loss: 3.5590
2024-06-12 15:06:56:INFO:VAL-(cmcm) >>
2024-06-12 15:06:56:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4458  Non0_acc_2: 0.5694  Non0_F1_score: 0.4396  Mult_acc_5: 0.2140  Mult_acc_7: 0.2140  MAE: 1.4301  Corr: -0.0634 
2024-06-12 15:06:57:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-12 15:07:12:INFO:TRAIN-(cmcm) (1/2/5)>> loss: 1.1399
2024-06-12 15:07:14:INFO:VAL-(cmcm) >>
2024-06-12 15:07:14:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.5390  Non0_acc_2: 0.5648  Non0_F1_score: 0.5395  Mult_acc_5: 0.2140  Mult_acc_7: 0.1834  MAE: 1.5747  Corr: 0.0179 
2024-06-12 15:07:29:INFO:TRAIN-(cmcm) (2/3/5)>> loss: 0.9327
2024-06-12 15:07:31:INFO:VAL-(cmcm) >>
2024-06-12 15:07:31:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4652  Non0_acc_2: 0.5787  Non0_F1_score: 0.4584  Mult_acc_5: 0.3013  Mult_acc_7: 0.2183  MAE: 1.7354  Corr: 0.0034 
2024-06-12 15:07:47:INFO:TRAIN-(cmcm) (3/4/5)>> loss: 0.9005
2024-06-12 15:07:49:INFO:VAL-(cmcm) >>
2024-06-12 15:07:49:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.5178  Non0_acc_2: 0.5648  Non0_F1_score: 0.5019  Mult_acc_5: 0.1616  Mult_acc_7: 0.1572  MAE: 1.5995  Corr: 0.0112 
2024-06-12 15:08:04:INFO:TRAIN-(cmcm) (4/5/5)>> loss: 0.8826
2024-06-12 15:08:06:INFO:VAL-(cmcm) >>
2024-06-12 15:08:06:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.4718  Non0_acc_2: 0.5833  Non0_F1_score: 0.4856  Mult_acc_5: 0.1747  Mult_acc_7: 0.1747  MAE: 1.4996  Corr: 0.0106 
2024-06-12 15:08:21:INFO:TRAIN-(cmcm) (5/6/5)>> loss: 0.8860
2024-06-12 15:08:23:INFO:VAL-(cmcm) >>
2024-06-12 15:08:23:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5282  Non0_acc_2: 0.5694  Non0_F1_score: 0.5131  Mult_acc_5: 0.2445  Mult_acc_7: 0.2009  MAE: 1.6619  Corr: 0.0350 
2024-06-12 15:08:38:INFO:TRAIN-(cmcm) (6/7/5)>> loss: 0.8717
2024-06-12 15:08:40:INFO:VAL-(cmcm) >>
2024-06-12 15:08:40:INFO:M: >>  Has0_acc_2: 0.4803  Has0_F1_score: 0.4171  Non0_acc_2: 0.5046  Non0_F1_score: 0.4430  Mult_acc_5: 0.1441  Mult_acc_7: 0.1441  MAE: 1.6117  Corr: 0.2184 
2024-06-12 15:08:55:INFO:TRAIN-(cmcm) (7/8/5)>> loss: 0.8797
2024-06-12 15:08:58:INFO:VAL-(cmcm) >>
2024-06-12 15:08:58:INFO:M: >>  Has0_acc_2: 0.4498  Has0_F1_score: 0.3590  Non0_acc_2: 0.4722  Non0_F1_score: 0.3820  Mult_acc_5: 0.1921  Mult_acc_7: 0.1528  MAE: 2.1008  Corr: 0.1325 
2024-06-12 15:09:12:INFO:TRAIN-(cmcm) (8/9/5)>> loss: 0.8745
2024-06-12 15:09:15:INFO:VAL-(cmcm) >>
2024-06-12 15:09:15:INFO:M: >>  Has0_acc_2: 0.5371  Has0_F1_score: 0.5379  Non0_acc_2: 0.5370  Non0_F1_score: 0.5356  Mult_acc_5: 0.1834  Mult_acc_7: 0.1790  MAE: 1.6095  Corr: 0.0646 
2024-06-12 15:09:30:INFO:TRAIN-(cmcm) (9/10/5)>> loss: 0.8629
2024-06-12 15:09:32:INFO:VAL-(cmcm) >>
2024-06-12 15:09:32:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.5013  Non0_acc_2: 0.5648  Non0_F1_score: 0.4841  Mult_acc_5: 0.2664  Mult_acc_7: 0.1921  MAE: 1.6778  Corr: 0.0248 
2024-06-12 15:09:47:INFO:TRAIN-(cmcm) (10/11/5)>> loss: 0.8586
2024-06-12 15:09:50:INFO:VAL-(cmcm) >>
2024-06-12 15:09:50:INFO:M: >>  Has0_acc_2: 0.5590  Has0_F1_score: 0.5613  Non0_acc_2: 0.5602  Non0_F1_score: 0.5605  Mult_acc_5: 0.2096  Mult_acc_7: 0.1878  MAE: 1.5384  Corr: 0.1153 
2024-06-12 15:09:57:INFO:TEST-(cmcm) >>
2024-06-12 15:09:57:INFO:M: >>  Has0_acc_2: 0.4519  Has0_F1_score: 0.2960  Non0_acc_2: 0.4588  Non0_F1_score: 0.3503  Mult_acc_5: 0.1545  Mult_acc_7: 0.1545  MAE: 1.4515  Corr: 0.0469 
2024-06-12 15:09:57:INFO:Results are added to results/results/mosi-regression-80.csv...
2024-06-12 15:09:57:INFO:Start running cmcm...
2024-06-12 15:09:57:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 90, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-06-12 15:09:57:INFO:Let's use the GPU 1 !
2024-06-12 15:09:57:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 15:09:58:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718176198 HTTP/1.1" 200 235
2024-06-12 15:09:58:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 15:09:58:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 15:09:59:INFO:train samples: (1284,)
2024-06-12 15:09:59:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 15:10:00:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718176200 HTTP/1.1" 200 235
2024-06-12 15:10:00:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 15:10:01:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 15:10:01:INFO:valid samples: (229,)
2024-06-12 15:10:01:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 15:10:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718176202 HTTP/1.1" 200 235
2024-06-12 15:10:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 15:10:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 15:10:03:INFO:test samples: (686,)
2024-06-12 15:10:03:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 15:10:03:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718176203 HTTP/1.1" 200 235
2024-06-12 15:10:03:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 15:10:04:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 15:10:04:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 15:10:04:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718176205 HTTP/1.1" 200 235
2024-06-12 15:10:05:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 15:10:05:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 15:10:05:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-12 15:10:05:WARNING:Try importing flash-attention for faster inference...
2024-06-12 15:10:05:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-12 15:10:05:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-12 15:10:05:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-12 15:10:06:INFO:trainable params: 1310284 || all params: 1838138956 || trainable%: 0.07128318540461856
2024-06-12 15:10:06:INFO:Init labels...
2024-06-12 15:10:06:INFO:Start training...
2024-06-12 15:10:21:INFO:TRAIN-(cmcm) (1/1/1)>> loss: 3.8021
2024-06-12 15:10:24:INFO:VAL-(cmcm) >>
2024-06-12 15:10:24:INFO:M: >>  Has0_acc_2: 0.5240  Has0_F1_score: 0.5286  Non0_acc_2: 0.5185  Non0_F1_score: 0.5077  Mult_acc_5: 0.2358  Mult_acc_7: 0.2009  MAE: 1.6206  Corr: 0.0848 
2024-06-12 15:10:24:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-12 15:10:39:INFO:TRAIN-(cmcm) (1/2/1)>> loss: 1.1240
2024-06-12 15:10:41:INFO:VAL-(cmcm) >>
2024-06-12 15:10:41:INFO:M: >>  Has0_acc_2: 0.5502  Has0_F1_score: 0.5458  Non0_acc_2: 0.5509  Non0_F1_score: 0.5462  Mult_acc_5: 0.2533  Mult_acc_7: 0.2052  MAE: 1.7158  Corr: 0.0470 
2024-06-12 15:10:56:INFO:TRAIN-(cmcm) (2/3/1)>> loss: 0.9539
2024-06-12 15:10:58:INFO:VAL-(cmcm) >>
2024-06-12 15:10:58:INFO:M: >>  Has0_acc_2: 0.5197  Has0_F1_score: 0.5178  Non0_acc_2: 0.5231  Non0_F1_score: 0.5192  Mult_acc_5: 0.2009  Mult_acc_7: 0.1485  MAE: 1.7315  Corr: -0.0031 
2024-06-12 15:11:13:INFO:TRAIN-(cmcm) (3/4/1)>> loss: 0.9262
2024-06-12 15:11:15:INFO:VAL-(cmcm) >>
2024-06-12 15:11:15:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5399  Non0_acc_2: 0.5648  Non0_F1_score: 0.5320  Mult_acc_5: 0.1790  Mult_acc_7: 0.1747  MAE: 1.5689  Corr: 0.0266 
2024-06-12 15:11:16:INFO:Saving checkpoint at epoch 4 to results/models/cmcm-mosi-regression.pth.
2024-06-12 15:11:31:INFO:TRAIN-(cmcm) (1/5/1)>> loss: 0.9030
2024-06-12 15:11:33:INFO:VAL-(cmcm) >>
2024-06-12 15:11:33:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.5220  Non0_acc_2: 0.5556  Non0_F1_score: 0.5065  Mult_acc_5: 0.2358  Mult_acc_7: 0.1703  MAE: 1.7014  Corr: 0.0160 
2024-06-12 15:11:48:INFO:TRAIN-(cmcm) (2/6/1)>> loss: 0.8993
2024-06-12 15:11:50:INFO:VAL-(cmcm) >>
2024-06-12 15:11:50:INFO:M: >>  Has0_acc_2: 0.5415  Has0_F1_score: 0.4996  Non0_acc_2: 0.5370  Non0_F1_score: 0.4929  Mult_acc_5: 0.2445  Mult_acc_7: 0.2009  MAE: 1.6813  Corr: -0.0056 
2024-06-12 15:12:05:INFO:TRAIN-(cmcm) (3/7/1)>> loss: 0.8997
2024-06-12 15:12:07:INFO:VAL-(cmcm) >>
2024-06-12 15:12:07:INFO:M: >>  Has0_acc_2: 0.5328  Has0_F1_score: 0.5256  Non0_acc_2: 0.5231  Non0_F1_score: 0.5142  Mult_acc_5: 0.2052  Mult_acc_7: 0.1659  MAE: 1.6680  Corr: 0.0127 
2024-06-12 15:12:22:INFO:TRAIN-(cmcm) (4/8/1)>> loss: 0.8931
2024-06-12 15:12:25:INFO:VAL-(cmcm) >>
2024-06-12 15:12:25:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4866  Non0_acc_2: 0.5741  Non0_F1_score: 0.4622  Mult_acc_5: 0.2838  Mult_acc_7: 0.2052  MAE: 1.7145  Corr: 0.0350 
2024-06-12 15:12:40:INFO:TRAIN-(cmcm) (5/9/1)>> loss: 0.8992
2024-06-12 15:12:42:INFO:VAL-(cmcm) >>
2024-06-12 15:12:42:INFO:M: >>  Has0_acc_2: 0.5109  Has0_F1_score: 0.5052  Non0_acc_2: 0.5139  Non0_F1_score: 0.5052  Mult_acc_5: 0.2314  Mult_acc_7: 0.1878  MAE: 1.7100  Corr: 0.0783 
2024-06-12 15:12:57:INFO:TRAIN-(cmcm) (6/10/1)>> loss: 0.8860
2024-06-12 15:12:59:INFO:VAL-(cmcm) >>
2024-06-12 15:12:59:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5595  Non0_acc_2: 0.5833  Non0_F1_score: 0.5465  Mult_acc_5: 0.2664  Mult_acc_7: 0.1965  MAE: 1.6328  Corr: 0.0189 
2024-06-12 15:13:14:INFO:TRAIN-(cmcm) (7/11/1)>> loss: 0.8716
2024-06-12 15:13:16:INFO:VAL-(cmcm) >>
2024-06-12 15:13:16:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5261  Non0_acc_2: 0.5694  Non0_F1_score: 0.5010  Mult_acc_5: 0.3144  Mult_acc_7: 0.2445  MAE: 1.6625  Corr: 0.0751 
2024-06-12 15:13:31:INFO:TRAIN-(cmcm) (8/12/1)>> loss: 0.8695
2024-06-12 15:13:34:INFO:VAL-(cmcm) >>
2024-06-12 15:13:34:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.5991  Non0_acc_2: 0.6019  Non0_F1_score: 0.5924  Mult_acc_5: 0.3188  Mult_acc_7: 0.2227  MAE: 1.6664  Corr: 0.1886 
2024-06-12 15:13:48:INFO:TRAIN-(cmcm) (9/13/1)>> loss: 0.8575
2024-06-12 15:13:51:INFO:VAL-(cmcm) >>
2024-06-12 15:13:51:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.5512  Non0_acc_2: 0.5833  Non0_F1_score: 0.5406  Mult_acc_5: 0.3144  Mult_acc_7: 0.2271  MAE: 1.6189  Corr: 0.0797 
2024-06-12 15:14:05:INFO:TRAIN-(cmcm) (10/14/1)>> loss: 0.8578
2024-06-12 15:14:08:INFO:VAL-(cmcm) >>
2024-06-12 15:14:08:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5129  Non0_acc_2: 0.5602  Non0_F1_score: 0.4902  Mult_acc_5: 0.2882  Mult_acc_7: 0.2009  MAE: 1.7197  Corr: 0.0110 
2024-06-12 15:14:15:INFO:TEST-(cmcm) >>
2024-06-12 15:14:15:INFO:M: >>  Has0_acc_2: 0.4971  Has0_F1_score: 0.4786  Non0_acc_2: 0.4924  Non0_F1_score: 0.4759  Mult_acc_5: 0.2099  Mult_acc_7: 0.2026  MAE: 1.6738  Corr: 0.0377 
2024-06-12 15:14:16:INFO:Results are added to results/results/mosi-regression-90.csv...
2024-06-12 15:14:16:INFO:Start running cmcm...
2024-06-12 15:14:16:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 90, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 2222}>
2024-06-12 15:14:16:INFO:Let's use the GPU 1 !
2024-06-12 15:14:16:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 15:14:16:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718176456 HTTP/1.1" 200 235
2024-06-12 15:14:16:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 15:14:17:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 15:14:17:INFO:train samples: (1284,)
2024-06-12 15:14:17:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 15:14:18:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718176458 HTTP/1.1" 200 235
2024-06-12 15:14:18:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 15:14:19:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 15:14:19:INFO:valid samples: (229,)
2024-06-12 15:14:19:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 15:14:20:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718176460 HTTP/1.1" 200 235
2024-06-12 15:14:20:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 15:14:20:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 15:14:21:INFO:test samples: (686,)
2024-06-12 15:14:21:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 15:14:21:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718176461 HTTP/1.1" 200 235
2024-06-12 15:14:21:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 15:14:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 15:14:22:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 15:14:23:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718176463 HTTP/1.1" 200 235
2024-06-12 15:14:23:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 15:14:23:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 15:14:23:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-12 15:14:23:WARNING:Try importing flash-attention for faster inference...
2024-06-12 15:14:23:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-12 15:14:23:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-12 15:14:23:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-12 15:14:24:INFO:trainable params: 1310284 || all params: 1838138956 || trainable%: 0.07128318540461856
2024-06-12 15:14:24:INFO:Init labels...
2024-06-12 15:14:24:INFO:Start training...
2024-06-12 15:14:39:INFO:TRAIN-(cmcm) (1/1/2)>> loss: 4.3000
2024-06-12 15:14:41:INFO:VAL-(cmcm) >>
2024-06-12 15:14:41:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4259  Non0_F1_score: 0.2544  Mult_acc_5: 0.2140  Mult_acc_7: 0.2140  MAE: 1.4370  Corr: nan 
2024-06-12 15:14:42:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-12 15:14:57:INFO:TRAIN-(cmcm) (1/2/2)>> loss: 2.2478
2024-06-12 15:14:59:INFO:VAL-(cmcm) >>
2024-06-12 15:14:59:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.5568  Non0_acc_2: 0.5648  Non0_F1_score: 0.5573  Mult_acc_5: 0.1965  Mult_acc_7: 0.1616  MAE: 1.7616  Corr: 0.0095 
2024-06-12 15:15:14:INFO:TRAIN-(cmcm) (2/3/2)>> loss: 1.0123
2024-06-12 15:15:16:INFO:VAL-(cmcm) >>
2024-06-12 15:15:16:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.4897  Non0_acc_2: 0.5648  Non0_F1_score: 0.4684  Mult_acc_5: 0.2271  Mult_acc_7: 0.1659  MAE: 1.7158  Corr: -0.0224 
2024-06-12 15:15:31:INFO:TRAIN-(cmcm) (3/4/2)>> loss: 0.9258
2024-06-12 15:15:33:INFO:VAL-(cmcm) >>
2024-06-12 15:15:33:INFO:M: >>  Has0_acc_2: 0.4847  Has0_F1_score: 0.4083  Non0_acc_2: 0.5000  Non0_F1_score: 0.4145  Mult_acc_5: 0.1441  Mult_acc_7: 0.1354  MAE: 1.6685  Corr: 0.1967 
2024-06-12 15:15:48:INFO:TRAIN-(cmcm) (4/5/2)>> loss: 0.9026
2024-06-12 15:15:50:INFO:VAL-(cmcm) >>
2024-06-12 15:15:50:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5446  Non0_acc_2: 0.5694  Non0_F1_score: 0.5236  Mult_acc_5: 0.1703  Mult_acc_7: 0.1703  MAE: 1.5763  Corr: 0.0296 
2024-06-12 15:16:05:INFO:TRAIN-(cmcm) (5/6/2)>> loss: 0.8922
2024-06-12 15:16:08:INFO:VAL-(cmcm) >>
2024-06-12 15:16:08:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.5201  Non0_acc_2: 0.5509  Non0_F1_score: 0.5410  Mult_acc_5: 0.2489  Mult_acc_7: 0.2052  MAE: 1.5494  Corr: 0.0126 
2024-06-12 15:16:22:INFO:TRAIN-(cmcm) (6/7/2)>> loss: 0.8877
2024-06-12 15:16:25:INFO:VAL-(cmcm) >>
2024-06-12 15:16:25:INFO:M: >>  Has0_acc_2: 0.5415  Has0_F1_score: 0.5441  Non0_acc_2: 0.5463  Non0_F1_score: 0.5469  Mult_acc_5: 0.2009  Mult_acc_7: 0.1834  MAE: 1.6616  Corr: 0.0659 
2024-06-12 15:16:39:INFO:TRAIN-(cmcm) (7/8/2)>> loss: 0.8810
2024-06-12 15:16:42:INFO:VAL-(cmcm) >>
2024-06-12 15:16:42:INFO:M: >>  Has0_acc_2: 0.5066  Has0_F1_score: 0.4926  Non0_acc_2: 0.5231  Non0_F1_score: 0.5084  Mult_acc_5: 0.2096  Mult_acc_7: 0.1790  MAE: 1.6039  Corr: 0.1081 
2024-06-12 15:16:56:INFO:TRAIN-(cmcm) (8/9/2)>> loss: 0.8734
2024-06-12 15:16:59:INFO:VAL-(cmcm) >>
2024-06-12 15:16:59:INFO:M: >>  Has0_acc_2: 0.4934  Has0_F1_score: 0.4528  Non0_acc_2: 0.5139  Non0_F1_score: 0.4733  Mult_acc_5: 0.2096  Mult_acc_7: 0.1790  MAE: 1.6135  Corr: 0.1531 
2024-06-12 15:17:14:INFO:TRAIN-(cmcm) (9/10/2)>> loss: 0.8866
2024-06-12 15:17:16:INFO:VAL-(cmcm) >>
2024-06-12 15:17:16:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.4584  Non0_acc_2: 0.5556  Non0_F1_score: 0.4780  Mult_acc_5: 0.2533  Mult_acc_7: 0.2052  MAE: 1.6267  Corr: -0.0357 
2024-06-12 15:17:31:INFO:TRAIN-(cmcm) (10/11/2)>> loss: 0.8717
2024-06-12 15:17:33:INFO:VAL-(cmcm) >>
2024-06-12 15:17:33:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.4947  Non0_acc_2: 0.5556  Non0_F1_score: 0.4680  Mult_acc_5: 0.2926  Mult_acc_7: 0.2140  MAE: 1.8263  Corr: -0.0244 
2024-06-12 15:17:41:INFO:TEST-(cmcm) >>
2024-06-12 15:17:41:INFO:M: >>  Has0_acc_2: 0.4475  Has0_F1_score: 0.2767  Non0_acc_2: 0.5777  Non0_F1_score: 0.4231  Mult_acc_5: 0.1545  Mult_acc_7: 0.1545  MAE: 1.4174  Corr: nan 
2024-06-12 15:17:41:INFO:Results are added to results/results/mosi-regression-90.csv...
2024-06-12 15:17:41:INFO:Start running cmcm...
2024-06-12 15:17:41:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 90, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 3333}>
2024-06-12 15:17:41:INFO:Let's use the GPU 1 !
2024-06-12 15:17:41:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 15:17:41:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718176661 HTTP/1.1" 200 235
2024-06-12 15:17:41:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 15:17:42:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 15:17:42:INFO:train samples: (1284,)
2024-06-12 15:17:43:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 15:17:43:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718176663 HTTP/1.1" 200 235
2024-06-12 15:17:43:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 15:17:43:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 15:17:44:INFO:valid samples: (229,)
2024-06-12 15:17:44:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 15:17:45:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718176665 HTTP/1.1" 200 235
2024-06-12 15:17:45:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 15:17:46:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 15:17:46:INFO:test samples: (686,)
2024-06-12 15:17:46:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 15:17:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718176667 HTTP/1.1" 200 235
2024-06-12 15:17:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 15:17:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 15:17:48:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 15:17:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718176668 HTTP/1.1" 200 235
2024-06-12 15:17:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 15:17:49:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 15:17:49:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-12 15:17:49:WARNING:Try importing flash-attention for faster inference...
2024-06-12 15:17:49:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-12 15:17:49:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-12 15:17:49:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-12 15:17:50:INFO:trainable params: 1310284 || all params: 1838138956 || trainable%: 0.07128318540461856
2024-06-12 15:17:50:INFO:Init labels...
2024-06-12 15:17:50:INFO:Start training...
2024-06-12 15:18:05:INFO:TRAIN-(cmcm) (1/1/3)>> loss: 4.3458
2024-06-12 15:18:07:INFO:VAL-(cmcm) >>
2024-06-12 15:18:07:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4259  Non0_F1_score: 0.2544  Mult_acc_5: 0.2140  Mult_acc_7: 0.2140  MAE: 1.4370  Corr: nan 
2024-06-12 15:18:08:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-12 15:18:23:INFO:TRAIN-(cmcm) (1/2/3)>> loss: 3.7375
2024-06-12 15:18:25:INFO:VAL-(cmcm) >>
2024-06-12 15:18:25:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5463  Non0_F1_score: 0.5323  Mult_acc_5: 0.3231  Mult_acc_7: 0.1616  MAE: 2.1961  Corr: 0.0322 
2024-06-12 15:18:40:INFO:TRAIN-(cmcm) (2/3/3)>> loss: 1.7665
2024-06-12 15:18:42:INFO:VAL-(cmcm) >>
2024-06-12 15:18:42:INFO:M: >>  Has0_acc_2: 0.5109  Has0_F1_score: 0.5138  Non0_acc_2: 0.5000  Non0_F1_score: 0.5012  Mult_acc_5: 0.1659  Mult_acc_7: 0.1310  MAE: 1.8975  Corr: -0.0384 
2024-06-12 15:18:57:INFO:TRAIN-(cmcm) (3/4/3)>> loss: 0.9909
2024-06-12 15:19:00:INFO:VAL-(cmcm) >>
2024-06-12 15:19:00:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.5479  Non0_acc_2: 0.5509  Non0_F1_score: 0.5324  Mult_acc_5: 0.1965  Mult_acc_7: 0.1878  MAE: 1.5018  Corr: 0.0627 
2024-06-12 15:19:15:INFO:TRAIN-(cmcm) (4/5/3)>> loss: 0.9310
2024-06-12 15:19:17:INFO:VAL-(cmcm) >>
2024-06-12 15:19:17:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4607  Non0_acc_2: 0.5694  Non0_F1_score: 0.4323  Mult_acc_5: 0.2358  Mult_acc_7: 0.1703  MAE: 1.6678  Corr: 0.0087 
2024-06-12 15:19:33:INFO:TRAIN-(cmcm) (5/6/3)>> loss: 0.9038
2024-06-12 15:19:35:INFO:VAL-(cmcm) >>
2024-06-12 15:19:35:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.5234  Non0_acc_2: 0.5833  Non0_F1_score: 0.5013  Mult_acc_5: 0.2969  Mult_acc_7: 0.2183  MAE: 1.6354  Corr: 0.0767 
2024-06-12 15:19:50:INFO:TRAIN-(cmcm) (6/7/3)>> loss: 0.8902
2024-06-12 15:19:52:INFO:VAL-(cmcm) >>
2024-06-12 15:19:52:INFO:M: >>  Has0_acc_2: 0.6157  Has0_F1_score: 0.5222  Non0_acc_2: 0.5926  Non0_F1_score: 0.4970  Mult_acc_5: 0.2576  Mult_acc_7: 0.2096  MAE: 1.5429  Corr: 0.0790 
2024-06-12 15:20:07:INFO:TRAIN-(cmcm) (7/8/3)>> loss: 0.8787
2024-06-12 15:20:09:INFO:VAL-(cmcm) >>
2024-06-12 15:20:10:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.5544  Non0_acc_2: 0.5880  Non0_F1_score: 0.5340  Mult_acc_5: 0.2926  Mult_acc_7: 0.2052  MAE: 1.6634  Corr: 0.0930 
2024-06-12 15:20:24:INFO:TRAIN-(cmcm) (8/9/3)>> loss: 0.8795
2024-06-12 15:20:27:INFO:VAL-(cmcm) >>
2024-06-12 15:20:27:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.4584  Non0_acc_2: 0.5093  Non0_F1_score: 0.5116  Mult_acc_5: 0.2271  Mult_acc_7: 0.2052  MAE: 1.4931  Corr: -0.0543 
2024-06-12 15:20:41:INFO:TRAIN-(cmcm) (9/10/3)>> loss: 0.8803
2024-06-12 15:20:44:INFO:VAL-(cmcm) >>
2024-06-12 15:20:44:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4652  Non0_acc_2: 0.5787  Non0_F1_score: 0.4370  Mult_acc_5: 0.2009  Mult_acc_7: 0.2009  MAE: 1.5324  Corr: 0.0191 
2024-06-12 15:20:59:INFO:TRAIN-(cmcm) (10/11/3)>> loss: 0.8675
2024-06-12 15:21:01:INFO:VAL-(cmcm) >>
2024-06-12 15:21:01:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.5278  Non0_acc_2: 0.5694  Non0_F1_score: 0.5131  Mult_acc_5: 0.2183  Mult_acc_7: 0.2052  MAE: 1.5647  Corr: 0.0280 
2024-06-12 15:21:09:INFO:TEST-(cmcm) >>
2024-06-12 15:21:09:INFO:M: >>  Has0_acc_2: 0.4475  Has0_F1_score: 0.2767  Non0_acc_2: 0.5777  Non0_F1_score: 0.4231  Mult_acc_5: 0.1545  Mult_acc_7: 0.1545  MAE: 1.4174  Corr: nan 
2024-06-12 15:21:09:INFO:Results are added to results/results/mosi-regression-90.csv...
2024-06-12 15:21:09:INFO:Start running cmcm...
2024-06-12 15:21:09:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 90, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 4444}>
2024-06-12 15:21:09:INFO:Let's use the GPU 1 !
2024-06-12 15:21:09:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 15:21:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718176869 HTTP/1.1" 200 235
2024-06-12 15:21:11:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 15:21:11:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 15:21:12:INFO:train samples: (1284,)
2024-06-12 15:21:12:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 15:21:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718176872 HTTP/1.1" 200 235
2024-06-12 15:21:16:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 15:21:16:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 15:21:17:INFO:valid samples: (229,)
2024-06-12 15:21:17:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 15:21:17:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718176878 HTTP/1.1" 200 235
2024-06-12 15:21:18:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 15:21:18:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 15:21:19:INFO:test samples: (686,)
2024-06-12 15:21:19:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 15:21:19:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718176879 HTTP/1.1" 200 235
2024-06-12 15:21:19:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 15:21:20:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 15:21:20:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 15:21:21:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718176881 HTTP/1.1" 200 235
2024-06-12 15:21:21:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 15:21:21:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 15:21:21:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-12 15:21:21:WARNING:Try importing flash-attention for faster inference...
2024-06-12 15:21:21:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-12 15:21:21:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-12 15:21:21:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-12 15:21:23:INFO:trainable params: 1310284 || all params: 1838138956 || trainable%: 0.07128318540461856
2024-06-12 15:21:23:INFO:Init labels...
2024-06-12 15:21:23:INFO:Start training...
2024-06-12 15:21:38:INFO:TRAIN-(cmcm) (1/1/4)>> loss: 4.0489
2024-06-12 15:21:40:INFO:VAL-(cmcm) >>
2024-06-12 15:21:40:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4577  Non0_acc_2: 0.4259  Non0_F1_score: 0.2544  Mult_acc_5: 0.2140  Mult_acc_7: 0.2140  MAE: 1.4449  Corr: 0.0365 
2024-06-12 15:21:41:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-12 15:21:56:INFO:TRAIN-(cmcm) (1/2/4)>> loss: 1.8151
2024-06-12 15:21:58:INFO:VAL-(cmcm) >>
2024-06-12 15:21:58:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.4705  Non0_acc_2: 0.5556  Non0_F1_score: 0.4731  Mult_acc_5: 0.1703  Mult_acc_7: 0.1703  MAE: 1.4969  Corr: -0.0266 
2024-06-12 15:22:13:INFO:TRAIN-(cmcm) (2/3/4)>> loss: 1.0661
2024-06-12 15:22:15:INFO:VAL-(cmcm) >>
2024-06-12 15:22:15:INFO:M: >>  Has0_acc_2: 0.4541  Has0_F1_score: 0.4497  Non0_acc_2: 0.4444  Non0_F1_score: 0.3997  Mult_acc_5: 0.1572  Mult_acc_7: 0.1572  MAE: 1.6593  Corr: -0.0755 
2024-06-12 15:22:30:INFO:TRAIN-(cmcm) (3/4/4)>> loss: 1.0215
2024-06-12 15:22:32:INFO:VAL-(cmcm) >>
2024-06-12 15:22:32:INFO:M: >>  Has0_acc_2: 0.5590  Has0_F1_score: 0.5567  Non0_acc_2: 0.5556  Non0_F1_score: 0.5541  Mult_acc_5: 0.2402  Mult_acc_7: 0.2140  MAE: 1.5641  Corr: 0.0546 
2024-06-12 15:22:47:INFO:TRAIN-(cmcm) (4/5/4)>> loss: 0.9804
2024-06-12 15:22:50:INFO:VAL-(cmcm) >>
2024-06-12 15:22:50:INFO:M: >>  Has0_acc_2: 0.5546  Has0_F1_score: 0.5287  Non0_acc_2: 0.5046  Non0_F1_score: 0.4994  Mult_acc_5: 0.2096  Mult_acc_7: 0.2096  MAE: 1.5497  Corr: -0.0721 
2024-06-12 15:23:05:INFO:TRAIN-(cmcm) (5/6/4)>> loss: 0.9653
2024-06-12 15:23:07:INFO:VAL-(cmcm) >>
2024-06-12 15:23:07:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5377  Non0_acc_2: 0.5741  Non0_F1_score: 0.5164  Mult_acc_5: 0.1616  Mult_acc_7: 0.1572  MAE: 1.5178  Corr: 0.0645 
2024-06-12 15:23:22:INFO:TRAIN-(cmcm) (6/7/4)>> loss: 0.9417
2024-06-12 15:23:25:INFO:VAL-(cmcm) >>
2024-06-12 15:23:25:INFO:M: >>  Has0_acc_2: 0.4760  Has0_F1_score: 0.4684  Non0_acc_2: 0.4815  Non0_F1_score: 0.4714  Mult_acc_5: 0.2271  Mult_acc_7: 0.1747  MAE: 1.8913  Corr: 0.0127 
2024-06-12 15:23:39:INFO:TRAIN-(cmcm) (7/8/4)>> loss: 1.5218
2024-06-12 15:23:42:INFO:VAL-(cmcm) >>
2024-06-12 15:23:42:INFO:M: >>  Has0_acc_2: 0.5066  Has0_F1_score: 0.5066  Non0_acc_2: 0.4583  Non0_F1_score: 0.3731  Mult_acc_5: 0.2271  Mult_acc_7: 0.2183  MAE: 1.4899  Corr: 0.0809 
2024-06-12 15:23:57:INFO:TRAIN-(cmcm) (8/9/4)>> loss: 1.0474
2024-06-12 15:23:59:INFO:VAL-(cmcm) >>
2024-06-12 15:23:59:INFO:M: >>  Has0_acc_2: 0.4847  Has0_F1_score: 0.4727  Non0_acc_2: 0.4491  Non0_F1_score: 0.3997  Mult_acc_5: 0.1703  Mult_acc_7: 0.1659  MAE: 1.6991  Corr: -0.0010 
2024-06-12 15:24:14:INFO:TRAIN-(cmcm) (9/10/4)>> loss: 0.9125
2024-06-12 15:24:16:INFO:VAL-(cmcm) >>
2024-06-12 15:24:16:INFO:M: >>  Has0_acc_2: 0.5240  Has0_F1_score: 0.5286  Non0_acc_2: 0.5278  Non0_F1_score: 0.5303  Mult_acc_5: 0.2052  Mult_acc_7: 0.1572  MAE: 1.7136  Corr: 0.0470 
2024-06-12 15:24:31:INFO:TRAIN-(cmcm) (10/11/4)>> loss: 0.9003
2024-06-12 15:24:33:INFO:VAL-(cmcm) >>
2024-06-12 15:24:33:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.5609  Non0_acc_2: 0.5880  Non0_F1_score: 0.5409  Mult_acc_5: 0.1921  Mult_acc_7: 0.1659  MAE: 1.5193  Corr: 0.0883 
2024-06-12 15:24:41:INFO:TEST-(cmcm) >>
2024-06-12 15:24:41:INFO:M: >>  Has0_acc_2: 0.4534  Has0_F1_score: 0.2894  Non0_acc_2: 0.5777  Non0_F1_score: 0.4231  Mult_acc_5: 0.1574  Mult_acc_7: 0.1560  MAE: 1.4171  Corr: 0.0490 
2024-06-12 15:24:41:INFO:Results are added to results/results/mosi-regression-90.csv...
2024-06-12 15:24:41:INFO:Start running cmcm...
2024-06-12 15:24:41:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 90, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 5555}>
2024-06-12 15:24:41:INFO:Let's use the GPU 1 !
2024-06-12 15:24:41:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 15:24:42:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718177082 HTTP/1.1" 200 235
2024-06-12 15:24:42:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 15:24:42:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 15:24:43:INFO:train samples: (1284,)
2024-06-12 15:24:43:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 15:24:43:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718177084 HTTP/1.1" 200 235
2024-06-12 15:24:44:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 15:24:44:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 15:24:45:INFO:valid samples: (229,)
2024-06-12 15:24:45:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 15:24:45:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718177085 HTTP/1.1" 200 235
2024-06-12 15:24:45:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 15:24:46:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 15:24:46:INFO:test samples: (686,)
2024-06-12 15:24:46:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 15:24:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718177087 HTTP/1.1" 200 235
2024-06-12 15:24:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 15:24:55:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 15:24:55:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 15:24:56:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718177096 HTTP/1.1" 200 235
2024-06-12 15:24:56:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 15:24:59:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 15:24:59:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-12 15:24:59:WARNING:Try importing flash-attention for faster inference...
2024-06-12 15:24:59:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-12 15:24:59:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-12 15:24:59:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-12 15:25:01:INFO:trainable params: 1310284 || all params: 1838138956 || trainable%: 0.07128318540461856
2024-06-12 15:25:01:INFO:Init labels...
2024-06-12 15:25:01:INFO:Start training...
2024-06-12 15:25:15:INFO:TRAIN-(cmcm) (1/1/5)>> loss: 3.6593
2024-06-12 15:25:18:INFO:VAL-(cmcm) >>
2024-06-12 15:25:18:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5741  Non0_F1_score: 0.4420  Mult_acc_5: 0.2969  Mult_acc_7: 0.1266  MAE: 2.4306  Corr: -0.0057 
2024-06-12 15:25:18:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-12 15:25:33:INFO:TRAIN-(cmcm) (1/2/5)>> loss: 1.1783
2024-06-12 15:25:36:INFO:VAL-(cmcm) >>
2024-06-12 15:25:36:INFO:M: >>  Has0_acc_2: 0.4847  Has0_F1_score: 0.4856  Non0_acc_2: 0.4907  Non0_F1_score: 0.4883  Mult_acc_5: 0.2227  Mult_acc_7: 0.1965  MAE: 1.5145  Corr: 0.0151 
2024-06-12 15:25:36:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-12 15:25:51:INFO:TRAIN-(cmcm) (1/3/5)>> loss: 0.9625
2024-06-12 15:25:53:INFO:VAL-(cmcm) >>
2024-06-12 15:25:53:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.4870  Non0_acc_2: 0.5648  Non0_F1_score: 0.4791  Mult_acc_5: 0.2402  Mult_acc_7: 0.2140  MAE: 1.7226  Corr: -0.0539 
2024-06-12 15:26:08:INFO:TRAIN-(cmcm) (2/4/5)>> loss: 0.9010
2024-06-12 15:26:10:INFO:VAL-(cmcm) >>
2024-06-12 15:26:10:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.4924  Non0_acc_2: 0.5694  Non0_F1_score: 0.4768  Mult_acc_5: 0.1747  Mult_acc_7: 0.1747  MAE: 1.5603  Corr: -0.0082 
2024-06-12 15:26:25:INFO:TRAIN-(cmcm) (3/5/5)>> loss: 0.8848
2024-06-12 15:26:28:INFO:VAL-(cmcm) >>
2024-06-12 15:26:28:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5741  Non0_F1_score: 0.4683  Mult_acc_5: 0.1834  Mult_acc_7: 0.1790  MAE: 1.4632  Corr: 0.0339 
2024-06-12 15:26:28:INFO:Saving checkpoint at epoch 5 to results/models/cmcm-mosi-regression.pth.
2024-06-12 15:26:43:INFO:TRAIN-(cmcm) (1/6/5)>> loss: 0.8880
2024-06-12 15:26:45:INFO:VAL-(cmcm) >>
2024-06-12 15:26:45:INFO:M: >>  Has0_acc_2: 0.5546  Has0_F1_score: 0.5124  Non0_acc_2: 0.5370  Non0_F1_score: 0.4929  Mult_acc_5: 0.2751  Mult_acc_7: 0.1921  MAE: 1.8271  Corr: -0.0216 
2024-06-12 15:27:00:INFO:TRAIN-(cmcm) (2/7/5)>> loss: 0.8747
2024-06-12 15:27:03:INFO:VAL-(cmcm) >>
2024-06-12 15:27:03:INFO:M: >>  Has0_acc_2: 0.5502  Has0_F1_score: 0.5337  Non0_acc_2: 0.5046  Non0_F1_score: 0.5050  Mult_acc_5: 0.2096  Mult_acc_7: 0.1834  MAE: 1.5874  Corr: 0.0153 
2024-06-12 15:27:17:INFO:TRAIN-(cmcm) (3/8/5)>> loss: 0.8738
2024-06-12 15:27:20:INFO:VAL-(cmcm) >>
2024-06-12 15:27:20:INFO:M: >>  Has0_acc_2: 0.4236  Has0_F1_score: 0.3014  Non0_acc_2: 0.4444  Non0_F1_score: 0.3208  Mult_acc_5: 0.1528  Mult_acc_7: 0.1310  MAE: 2.0694  Corr: -0.0135 
2024-06-12 15:27:34:INFO:TRAIN-(cmcm) (4/9/5)>> loss: 0.8696
2024-06-12 15:27:37:INFO:VAL-(cmcm) >>
2024-06-12 15:27:37:INFO:M: >>  Has0_acc_2: 0.5546  Has0_F1_score: 0.5263  Non0_acc_2: 0.5417  Non0_F1_score: 0.5112  Mult_acc_5: 0.2533  Mult_acc_7: 0.1747  MAE: 1.8747  Corr: -0.0186 
2024-06-12 15:27:52:INFO:TRAIN-(cmcm) (5/10/5)>> loss: 0.8658
2024-06-12 15:27:54:INFO:VAL-(cmcm) >>
2024-06-12 15:27:54:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5231  Non0_acc_2: 0.5694  Non0_F1_score: 0.5010  Mult_acc_5: 0.1747  Mult_acc_7: 0.1747  MAE: 1.6464  Corr: -0.0051 
2024-06-12 15:28:09:INFO:TRAIN-(cmcm) (6/11/5)>> loss: 0.8607
2024-06-12 15:28:11:INFO:VAL-(cmcm) >>
2024-06-12 15:28:11:INFO:M: >>  Has0_acc_2: 0.5590  Has0_F1_score: 0.5622  Non0_acc_2: 0.5648  Non0_F1_score: 0.5659  Mult_acc_5: 0.2445  Mult_acc_7: 0.1747  MAE: 1.7254  Corr: 0.0780 
2024-06-12 15:28:26:INFO:TRAIN-(cmcm) (7/12/5)>> loss: 0.8484
2024-06-12 15:28:28:INFO:VAL-(cmcm) >>
2024-06-12 15:28:28:INFO:M: >>  Has0_acc_2: 0.6550  Has0_F1_score: 0.6301  Non0_acc_2: 0.6481  Non0_F1_score: 0.6216  Mult_acc_5: 0.3231  Mult_acc_7: 0.2664  MAE: 1.5001  Corr: 0.2394 
2024-06-12 15:28:43:INFO:TRAIN-(cmcm) (8/13/5)>> loss: 0.8414
2024-06-12 15:28:46:INFO:VAL-(cmcm) >>
2024-06-12 15:28:46:INFO:M: >>  Has0_acc_2: 0.6769  Has0_F1_score: 0.6769  Non0_acc_2: 0.6852  Non0_F1_score: 0.6852  Mult_acc_5: 0.2620  Mult_acc_7: 0.2052  MAE: 1.3800  Corr: 0.3731 
2024-06-12 15:28:46:INFO:Saving checkpoint at epoch 13 to results/models/cmcm-mosi-regression.pth.
2024-06-12 15:29:01:INFO:TRAIN-(cmcm) (1/14/5)>> loss: 0.8304
2024-06-12 15:29:03:INFO:VAL-(cmcm) >>
2024-06-12 15:29:03:INFO:M: >>  Has0_acc_2: 0.6288  Has0_F1_score: 0.6240  Non0_acc_2: 0.6481  Non0_F1_score: 0.6423  Mult_acc_5: 0.3406  Mult_acc_7: 0.2576  MAE: 1.4560  Corr: 0.3995 
2024-06-12 15:29:18:INFO:TRAIN-(cmcm) (2/15/5)>> loss: 0.8169
2024-06-12 15:29:21:INFO:VAL-(cmcm) >>
2024-06-12 15:29:21:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.4746  Non0_acc_2: 0.6204  Non0_F1_score: 0.5456  Mult_acc_5: 0.2183  Mult_acc_7: 0.2096  MAE: 1.4298  Corr: 0.2735 
2024-06-12 15:29:36:INFO:TRAIN-(cmcm) (3/16/5)>> loss: 0.8139
2024-06-12 15:29:38:INFO:VAL-(cmcm) >>
2024-06-12 15:29:38:INFO:M: >>  Has0_acc_2: 0.7336  Has0_F1_score: 0.7347  Non0_acc_2: 0.7593  Non0_F1_score: 0.7585  Mult_acc_5: 0.3319  Mult_acc_7: 0.2445  MAE: 1.1337  Corr: 0.5539 
2024-06-12 15:29:39:INFO:Saving checkpoint at epoch 16 to results/models/cmcm-mosi-regression.pth.
2024-06-12 15:29:54:INFO:TRAIN-(cmcm) (1/17/5)>> loss: 0.7934
2024-06-12 15:29:56:INFO:VAL-(cmcm) >>
2024-06-12 15:29:56:INFO:M: >>  Has0_acc_2: 0.7162  Has0_F1_score: 0.7185  Non0_acc_2: 0.7269  Non0_F1_score: 0.7281  Mult_acc_5: 0.3362  Mult_acc_7: 0.2620  MAE: 1.2512  Corr: 0.4438 
2024-06-12 15:30:11:INFO:TRAIN-(cmcm) (2/18/5)>> loss: 0.7986
2024-06-12 15:30:14:INFO:VAL-(cmcm) >>
2024-06-12 15:30:14:INFO:M: >>  Has0_acc_2: 0.7162  Has0_F1_score: 0.7170  Non0_acc_2: 0.7454  Non0_F1_score: 0.7455  Mult_acc_5: 0.3537  Mult_acc_7: 0.2664  MAE: 1.1542  Corr: 0.5626 
2024-06-12 15:30:28:INFO:TRAIN-(cmcm) (3/19/5)>> loss: 0.7798
2024-06-12 15:30:31:INFO:VAL-(cmcm) >>
2024-06-12 15:30:31:INFO:M: >>  Has0_acc_2: 0.7336  Has0_F1_score: 0.7055  Non0_acc_2: 0.7500  Non0_F1_score: 0.7482  Mult_acc_5: 0.3843  Mult_acc_7: 0.2838  MAE: 1.0778  Corr: 0.5916 
2024-06-12 15:30:31:INFO:Saving checkpoint at epoch 19 to results/models/cmcm-mosi-regression.pth.
2024-06-12 15:30:46:INFO:TRAIN-(cmcm) (1/20/5)>> loss: 0.7725
2024-06-12 15:30:49:INFO:VAL-(cmcm) >>
2024-06-12 15:30:49:INFO:M: >>  Has0_acc_2: 0.7293  Has0_F1_score: 0.7276  Non0_acc_2: 0.7500  Non0_F1_score: 0.7487  Mult_acc_5: 0.4061  Mult_acc_7: 0.2969  MAE: 1.1092  Corr: 0.5502 
2024-06-12 15:31:04:INFO:TRAIN-(cmcm) (2/21/5)>> loss: 0.7618
2024-06-12 15:31:07:INFO:VAL-(cmcm) >>
2024-06-12 15:31:07:INFO:M: >>  Has0_acc_2: 0.7424  Has0_F1_score: 0.7444  Non0_acc_2: 0.7593  Non0_F1_score: 0.7601  Mult_acc_5: 0.3712  Mult_acc_7: 0.2795  MAE: 1.1699  Corr: 0.5372 
2024-06-12 15:31:21:INFO:TRAIN-(cmcm) (3/22/5)>> loss: 0.7615
2024-06-12 15:31:24:INFO:VAL-(cmcm) >>
2024-06-12 15:31:24:INFO:M: >>  Has0_acc_2: 0.7249  Has0_F1_score: 0.7180  Non0_acc_2: 0.7315  Non0_F1_score: 0.7260  Mult_acc_5: 0.3930  Mult_acc_7: 0.3144  MAE: 1.1494  Corr: 0.5191 
2024-06-12 15:31:38:INFO:TRAIN-(cmcm) (4/23/5)>> loss: 0.7573
2024-06-12 15:31:41:INFO:VAL-(cmcm) >>
2024-06-12 15:31:41:INFO:M: >>  Has0_acc_2: 0.7424  Has0_F1_score: 0.7430  Non0_acc_2: 0.7639  Non0_F1_score: 0.7648  Mult_acc_5: 0.3537  Mult_acc_7: 0.2882  MAE: 1.0734  Corr: 0.5762 
2024-06-12 15:31:41:INFO:Saving checkpoint at epoch 23 to results/models/cmcm-mosi-regression.pth.
2024-06-12 15:31:56:INFO:TRAIN-(cmcm) (1/24/5)>> loss: 0.7547
2024-06-12 15:31:59:INFO:VAL-(cmcm) >>
2024-06-12 15:31:59:INFO:M: >>  Has0_acc_2: 0.6507  Has0_F1_score: 0.6465  Non0_acc_2: 0.6667  Non0_F1_score: 0.6581  Mult_acc_5: 0.2969  Mult_acc_7: 0.2445  MAE: 1.2743  Corr: 0.4941 
2024-06-12 15:32:13:INFO:TRAIN-(cmcm) (2/25/5)>> loss: 0.7484
2024-06-12 15:32:16:INFO:VAL-(cmcm) >>
2024-06-12 15:32:16:INFO:M: >>  Has0_acc_2: 0.7773  Has0_F1_score: 0.7751  Non0_acc_2: 0.8056  Non0_F1_score: 0.8049  Mult_acc_5: 0.3843  Mult_acc_7: 0.3100  MAE: 0.9900  Corr: 0.6535 
2024-06-12 15:32:16:INFO:Saving checkpoint at epoch 25 to results/models/cmcm-mosi-regression.pth.
2024-06-12 15:32:31:INFO:TRAIN-(cmcm) (1/26/5)>> loss: 0.7443
2024-06-12 15:32:34:INFO:VAL-(cmcm) >>
2024-06-12 15:32:34:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.5574  Non0_acc_2: 0.6157  Non0_F1_score: 0.5881  Mult_acc_5: 0.2751  Mult_acc_7: 0.1965  MAE: 1.3424  Corr: 0.5046 
2024-06-12 15:32:48:INFO:TRAIN-(cmcm) (2/27/5)>> loss: 0.7372
2024-06-12 15:32:51:INFO:VAL-(cmcm) >>
2024-06-12 15:32:51:INFO:M: >>  Has0_acc_2: 0.7336  Has0_F1_score: 0.7339  Non0_acc_2: 0.6898  Non0_F1_score: 0.6910  Mult_acc_5: 0.3406  Mult_acc_7: 0.2707  MAE: 1.1088  Corr: 0.5284 
2024-06-12 15:33:05:INFO:TRAIN-(cmcm) (3/28/5)>> loss: 0.7317
2024-06-12 15:33:08:INFO:VAL-(cmcm) >>
2024-06-12 15:33:08:INFO:M: >>  Has0_acc_2: 0.7424  Has0_F1_score: 0.7449  Non0_acc_2: 0.6806  Non0_F1_score: 0.6748  Mult_acc_5: 0.3450  Mult_acc_7: 0.2707  MAE: 1.1132  Corr: 0.5802 
2024-06-12 15:33:23:INFO:TRAIN-(cmcm) (4/29/5)>> loss: 0.7201
2024-06-12 15:33:26:INFO:VAL-(cmcm) >>
2024-06-12 15:33:26:INFO:M: >>  Has0_acc_2: 0.7686  Has0_F1_score: 0.7590  Non0_acc_2: 0.7685  Non0_F1_score: 0.7682  Mult_acc_5: 0.3755  Mult_acc_7: 0.2969  MAE: 1.0564  Corr: 0.5834 
2024-06-12 15:33:41:INFO:TRAIN-(cmcm) (5/30/5)>> loss: 0.7241
2024-06-12 15:33:43:INFO:VAL-(cmcm) >>
2024-06-12 15:33:43:INFO:M: >>  Has0_acc_2: 0.7074  Has0_F1_score: 0.7087  Non0_acc_2: 0.6713  Non0_F1_score: 0.6611  Mult_acc_5: 0.3537  Mult_acc_7: 0.2926  MAE: 1.1381  Corr: 0.5661 
2024-06-12 15:33:58:INFO:TRAIN-(cmcm) (6/31/5)>> loss: 0.7201
2024-06-12 15:34:01:INFO:VAL-(cmcm) >>
2024-06-12 15:34:01:INFO:M: >>  Has0_acc_2: 0.7424  Has0_F1_score: 0.7442  Non0_acc_2: 0.7269  Non0_F1_score: 0.7282  Mult_acc_5: 0.3493  Mult_acc_7: 0.2882  MAE: 1.1381  Corr: 0.5234 
2024-06-12 15:34:15:INFO:TRAIN-(cmcm) (7/32/5)>> loss: 0.7309
2024-06-12 15:34:18:INFO:VAL-(cmcm) >>
2024-06-12 15:34:18:INFO:M: >>  Has0_acc_2: 0.7380  Has0_F1_score: 0.7278  Non0_acc_2: 0.7407  Non0_F1_score: 0.7363  Mult_acc_5: 0.4017  Mult_acc_7: 0.3231  MAE: 1.1210  Corr: 0.5295 
2024-06-12 15:34:33:INFO:TRAIN-(cmcm) (8/33/5)>> loss: 0.7122
2024-06-12 15:34:35:INFO:VAL-(cmcm) >>
2024-06-12 15:34:35:INFO:M: >>  Has0_acc_2: 0.7424  Has0_F1_score: 0.7398  Non0_acc_2: 0.7639  Non0_F1_score: 0.7625  Mult_acc_5: 0.4061  Mult_acc_7: 0.3362  MAE: 1.0389  Corr: 0.5901 
2024-06-12 15:34:50:INFO:TRAIN-(cmcm) (9/34/5)>> loss: 0.6959
2024-06-12 15:34:52:INFO:VAL-(cmcm) >>
2024-06-12 15:34:52:INFO:M: >>  Has0_acc_2: 0.7729  Has0_F1_score: 0.7691  Non0_acc_2: 0.7870  Non0_F1_score: 0.7855  Mult_acc_5: 0.4105  Mult_acc_7: 0.3275  MAE: 1.0900  Corr: 0.5740 
2024-06-12 15:35:07:INFO:TRAIN-(cmcm) (10/35/5)>> loss: 0.7005
2024-06-12 15:35:10:INFO:VAL-(cmcm) >>
2024-06-12 15:35:10:INFO:M: >>  Has0_acc_2: 0.7249  Has0_F1_score: 0.7274  Non0_acc_2: 0.7731  Non0_F1_score: 0.7744  Mult_acc_5: 0.3930  Mult_acc_7: 0.3188  MAE: 1.0608  Corr: 0.5996 
2024-06-12 15:35:17:INFO:TEST-(cmcm) >>
2024-06-12 15:35:17:INFO:M: >>  Has0_acc_2: 0.6953  Has0_F1_score: 0.6941  Non0_acc_2: 0.7104  Non0_F1_score: 0.7120  Mult_acc_5: 0.3469  Mult_acc_7: 0.3017  MAE: 1.1892  Corr: 0.4993 
2024-06-12 15:35:17:INFO:Results are added to results/results/mosi-regression-90.csv...
2024-06-12 15:35:17:INFO:Start running cmcm...
2024-06-12 15:35:17:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 100, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-06-12 15:35:17:INFO:Let's use the GPU 1 !
2024-06-12 15:35:17:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 15:35:18:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718177718 HTTP/1.1" 200 235
2024-06-12 15:35:18:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 15:35:18:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 15:35:19:INFO:train samples: (1284,)
2024-06-12 15:35:19:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 15:35:19:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718177720 HTTP/1.1" 200 235
2024-06-12 15:35:20:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 15:35:20:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 15:35:21:INFO:valid samples: (229,)
2024-06-12 15:35:21:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 15:35:21:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718177721 HTTP/1.1" 200 235
2024-06-12 15:35:21:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 15:35:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 15:35:22:INFO:test samples: (686,)
2024-06-12 15:35:22:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 15:35:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718177723 HTTP/1.1" 200 235
2024-06-12 15:35:23:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 15:35:23:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 15:35:23:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 15:35:24:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718177724 HTTP/1.1" 200 235
2024-06-12 15:35:24:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 15:35:24:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 15:35:24:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-12 15:35:24:WARNING:Try importing flash-attention for faster inference...
2024-06-12 15:35:24:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-12 15:35:24:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-12 15:35:24:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-12 15:35:26:INFO:trainable params: 1310284 || all params: 1838138956 || trainable%: 0.07128318540461856
2024-06-12 15:35:26:INFO:Init labels...
2024-06-12 15:35:26:INFO:Start training...
2024-06-12 15:35:40:INFO:TRAIN-(cmcm) (1/1/1)>> loss: 3.9101
2024-06-12 15:35:43:INFO:VAL-(cmcm) >>
2024-06-12 15:35:43:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.5086  Non0_acc_2: 0.5694  Non0_F1_score: 0.5299  Mult_acc_5: 0.2533  Mult_acc_7: 0.2009  MAE: 1.7123  Corr: 0.1197 
2024-06-12 15:35:43:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-12 15:35:58:INFO:TRAIN-(cmcm) (1/2/1)>> loss: 1.2346
2024-06-12 15:36:01:INFO:VAL-(cmcm) >>
2024-06-12 15:36:01:INFO:M: >>  Has0_acc_2: 0.5633  Has0_F1_score: 0.5482  Non0_acc_2: 0.5509  Non0_F1_score: 0.5395  Mult_acc_5: 0.2183  Mult_acc_7: 0.1790  MAE: 1.6248  Corr: 0.0856 
2024-06-12 15:36:01:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-12 15:36:16:INFO:TRAIN-(cmcm) (1/3/1)>> loss: 0.9821
2024-06-12 15:36:19:INFO:VAL-(cmcm) >>
2024-06-12 15:36:19:INFO:M: >>  Has0_acc_2: 0.5633  Has0_F1_score: 0.4926  Non0_acc_2: 0.5417  Non0_F1_score: 0.4733  Mult_acc_5: 0.1703  Mult_acc_7: 0.1528  MAE: 1.6210  Corr: -0.0153 
2024-06-12 15:36:19:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-mosi-regression.pth.
2024-06-12 15:36:34:INFO:TRAIN-(cmcm) (1/4/1)>> loss: 0.9217
2024-06-12 15:36:36:INFO:VAL-(cmcm) >>
2024-06-12 15:36:36:INFO:M: >>  Has0_acc_2: 0.5590  Has0_F1_score: 0.5522  Non0_acc_2: 0.5509  Non0_F1_score: 0.5425  Mult_acc_5: 0.1790  Mult_acc_7: 0.1659  MAE: 1.6401  Corr: 0.0154 
2024-06-12 15:36:51:INFO:TRAIN-(cmcm) (2/5/1)>> loss: 0.9137
2024-06-12 15:36:54:INFO:VAL-(cmcm) >>
2024-06-12 15:36:54:INFO:M: >>  Has0_acc_2: 0.5371  Has0_F1_score: 0.5293  Non0_acc_2: 0.5278  Non0_F1_score: 0.5196  Mult_acc_5: 0.2183  Mult_acc_7: 0.1703  MAE: 1.7057  Corr: 0.0339 
2024-06-12 15:37:08:INFO:TRAIN-(cmcm) (3/6/1)>> loss: 0.9044
2024-06-12 15:37:11:INFO:VAL-(cmcm) >>
2024-06-12 15:37:11:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5684  Non0_acc_2: 0.5185  Non0_F1_score: 0.5210  Mult_acc_5: 0.2358  Mult_acc_7: 0.2183  MAE: 1.5117  Corr: 0.0799 
2024-06-12 15:37:11:INFO:Saving checkpoint at epoch 6 to results/models/cmcm-mosi-regression.pth.
2024-06-12 15:37:26:INFO:TRAIN-(cmcm) (1/7/1)>> loss: 0.8944
2024-06-12 15:37:29:INFO:VAL-(cmcm) >>
2024-06-12 15:37:29:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.5013  Non0_acc_2: 0.5046  Non0_F1_score: 0.5065  Mult_acc_5: 0.2445  Mult_acc_7: 0.2314  MAE: 1.5126  Corr: -0.0391 
2024-06-12 15:37:43:INFO:TRAIN-(cmcm) (2/8/1)>> loss: 0.8793
2024-06-12 15:37:46:INFO:VAL-(cmcm) >>
2024-06-12 15:37:46:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.4880  Non0_acc_2: 0.5741  Non0_F1_score: 0.4622  Mult_acc_5: 0.2795  Mult_acc_7: 0.2096  MAE: 1.6577  Corr: 0.0103 
2024-06-12 15:38:01:INFO:TRAIN-(cmcm) (3/9/1)>> loss: 0.8782
2024-06-12 15:38:03:INFO:VAL-(cmcm) >>
2024-06-12 15:38:03:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.5137  Non0_acc_2: 0.5880  Non0_F1_score: 0.4940  Mult_acc_5: 0.2271  Mult_acc_7: 0.1790  MAE: 1.7359  Corr: 0.0107 
2024-06-12 15:38:18:INFO:TRAIN-(cmcm) (4/10/1)>> loss: 0.8897
2024-06-12 15:38:20:INFO:VAL-(cmcm) >>
2024-06-12 15:38:20:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5003  Non0_acc_2: 0.5648  Non0_F1_score: 0.4739  Mult_acc_5: 0.2314  Mult_acc_7: 0.1878  MAE: 1.6366  Corr: 0.0122 
2024-06-12 15:38:35:INFO:TRAIN-(cmcm) (5/11/1)>> loss: 0.8750
2024-06-12 15:38:38:INFO:VAL-(cmcm) >>
2024-06-12 15:38:38:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5129  Non0_acc_2: 0.5833  Non0_F1_score: 0.5231  Mult_acc_5: 0.1878  Mult_acc_7: 0.1659  MAE: 1.5336  Corr: 0.0003 
2024-06-12 15:38:52:INFO:TRAIN-(cmcm) (6/12/1)>> loss: 0.8794
2024-06-12 15:38:55:INFO:VAL-(cmcm) >>
2024-06-12 15:38:55:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4676  Non0_acc_2: 0.5185  Non0_F1_score: 0.4953  Mult_acc_5: 0.2795  Mult_acc_7: 0.2009  MAE: 1.6992  Corr: -0.0084 
2024-06-12 15:39:10:INFO:TRAIN-(cmcm) (7/13/1)>> loss: 0.8683
2024-06-12 15:39:12:INFO:VAL-(cmcm) >>
2024-06-12 15:39:12:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5826  Non0_acc_2: 0.5880  Non0_F1_score: 0.5826  Mult_acc_5: 0.2402  Mult_acc_7: 0.2140  MAE: 1.5555  Corr: 0.1176 
2024-06-12 15:39:27:INFO:TRAIN-(cmcm) (8/14/1)>> loss: 0.8708
2024-06-12 15:39:29:INFO:VAL-(cmcm) >>
2024-06-12 15:39:29:INFO:M: >>  Has0_acc_2: 0.5328  Has0_F1_score: 0.5254  Non0_acc_2: 0.5509  Non0_F1_score: 0.5429  Mult_acc_5: 0.2489  Mult_acc_7: 0.2052  MAE: 1.5446  Corr: 0.1536 
2024-06-12 15:39:44:INFO:TRAIN-(cmcm) (9/15/1)>> loss: 0.8648
2024-06-12 15:39:47:INFO:VAL-(cmcm) >>
2024-06-12 15:39:47:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4742  Non0_acc_2: 0.5741  Non0_F1_score: 0.4622  Mult_acc_5: 0.2926  Mult_acc_7: 0.2140  MAE: 1.6057  Corr: 0.0637 
2024-06-12 15:40:01:INFO:TRAIN-(cmcm) (10/16/1)>> loss: 0.8439
2024-06-12 15:40:04:INFO:VAL-(cmcm) >>
2024-06-12 15:40:04:INFO:M: >>  Has0_acc_2: 0.5109  Has0_F1_score: 0.4460  Non0_acc_2: 0.5370  Non0_F1_score: 0.4740  Mult_acc_5: 0.2314  Mult_acc_7: 0.1703  MAE: 1.7357  Corr: 0.3146 
2024-06-12 15:40:11:INFO:TEST-(cmcm) >>
2024-06-12 15:40:11:INFO:M: >>  Has0_acc_2: 0.5248  Has0_F1_score: 0.5254  Non0_acc_2: 0.5137  Non0_F1_score: 0.5131  Mult_acc_5: 0.2012  Mult_acc_7: 0.1968  MAE: 1.5777  Corr: 0.0269 
2024-06-12 15:40:12:INFO:Results are added to results/results/mosi-regression-100.csv...
2024-06-12 15:40:12:INFO:Start running cmcm...
2024-06-12 15:40:12:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 100, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 2222}>
2024-06-12 15:40:12:INFO:Let's use the GPU 1 !
2024-06-12 15:40:12:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 15:40:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718178012 HTTP/1.1" 200 235
2024-06-12 15:40:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 15:40:13:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 15:40:13:INFO:train samples: (1284,)
2024-06-12 15:40:14:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 15:40:14:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718178014 HTTP/1.1" 200 235
2024-06-12 15:40:14:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 15:40:14:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 15:40:15:INFO:valid samples: (229,)
2024-06-12 15:40:15:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 15:40:15:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718178016 HTTP/1.1" 200 235
2024-06-12 15:40:16:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 15:40:16:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 15:40:17:INFO:test samples: (686,)
2024-06-12 15:40:17:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 15:40:17:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718178017 HTTP/1.1" 200 235
2024-06-12 15:40:17:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 15:40:17:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 15:40:18:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 15:40:19:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718178018 HTTP/1.1" 200 235
2024-06-12 15:40:19:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 15:40:25:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 15:40:25:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-12 15:40:25:WARNING:Try importing flash-attention for faster inference...
2024-06-12 15:40:25:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-12 15:40:25:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-12 15:40:25:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-12 15:40:26:INFO:trainable params: 1310284 || all params: 1838138956 || trainable%: 0.07128318540461856
2024-06-12 15:40:26:INFO:Init labels...
2024-06-12 15:40:26:INFO:Start training...
2024-06-12 15:40:41:INFO:TRAIN-(cmcm) (1/1/2)>> loss: 4.3175
2024-06-12 15:40:44:INFO:VAL-(cmcm) >>
2024-06-12 15:40:44:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4259  Non0_F1_score: 0.2544  Mult_acc_5: 0.2140  Mult_acc_7: 0.2140  MAE: 1.4370  Corr: nan 
2024-06-12 15:40:44:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-12 15:40:59:INFO:TRAIN-(cmcm) (1/2/2)>> loss: 2.3639
2024-06-12 15:41:01:INFO:VAL-(cmcm) >>
2024-06-12 15:41:01:INFO:M: >>  Has0_acc_2: 0.5022  Has0_F1_score: 0.5057  Non0_acc_2: 0.5046  Non0_F1_score: 0.5043  Mult_acc_5: 0.2314  Mult_acc_7: 0.1616  MAE: 1.9468  Corr: 0.0452 
2024-06-12 15:41:16:INFO:TRAIN-(cmcm) (2/3/2)>> loss: 1.0530
2024-06-12 15:41:19:INFO:VAL-(cmcm) >>
2024-06-12 15:41:19:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.5216  Non0_acc_2: 0.5926  Non0_F1_score: 0.5298  Mult_acc_5: 0.2358  Mult_acc_7: 0.2052  MAE: 1.5402  Corr: 0.0988 
2024-06-12 15:41:33:INFO:TRAIN-(cmcm) (3/4/2)>> loss: 0.9205
2024-06-12 15:41:36:INFO:VAL-(cmcm) >>
2024-06-12 15:41:36:INFO:M: >>  Has0_acc_2: 0.5546  Has0_F1_score: 0.5557  Non0_acc_2: 0.5417  Non0_F1_score: 0.5380  Mult_acc_5: 0.2140  Mult_acc_7: 0.1572  MAE: 1.8049  Corr: 0.0707 
2024-06-12 15:41:51:INFO:TRAIN-(cmcm) (4/5/2)>> loss: 0.9051
2024-06-12 15:41:53:INFO:VAL-(cmcm) >>
2024-06-12 15:41:53:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5595  Non0_acc_2: 0.5694  Non0_F1_score: 0.5432  Mult_acc_5: 0.2009  Mult_acc_7: 0.2009  MAE: 1.5641  Corr: -0.0256 
2024-06-12 15:42:08:INFO:TRAIN-(cmcm) (5/6/2)>> loss: 0.8945
2024-06-12 15:42:11:INFO:VAL-(cmcm) >>
2024-06-12 15:42:11:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.5440  Non0_acc_2: 0.5185  Non0_F1_score: 0.4930  Mult_acc_5: 0.2358  Mult_acc_7: 0.1921  MAE: 1.6311  Corr: 0.0110 
2024-06-12 15:42:25:INFO:TRAIN-(cmcm) (6/7/2)>> loss: 0.8842
2024-06-12 15:42:28:INFO:VAL-(cmcm) >>
2024-06-12 15:42:28:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.5715  Non0_acc_2: 0.5694  Non0_F1_score: 0.5714  Mult_acc_5: 0.1834  Mult_acc_7: 0.1747  MAE: 1.6643  Corr: 0.0725 
2024-06-12 15:42:43:INFO:TRAIN-(cmcm) (7/8/2)>> loss: 0.8795
2024-06-12 15:42:45:INFO:VAL-(cmcm) >>
2024-06-12 15:42:45:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.5800  Non0_acc_2: 0.5741  Non0_F1_score: 0.5679  Mult_acc_5: 0.2533  Mult_acc_7: 0.2009  MAE: 1.5809  Corr: 0.1224 
2024-06-12 15:43:00:INFO:TRAIN-(cmcm) (8/9/2)>> loss: 0.8714
2024-06-12 15:43:02:INFO:VAL-(cmcm) >>
2024-06-12 15:43:02:INFO:M: >>  Has0_acc_2: 0.5633  Has0_F1_score: 0.5671  Non0_acc_2: 0.5741  Non0_F1_score: 0.5761  Mult_acc_5: 0.2533  Mult_acc_7: 0.2096  MAE: 1.5568  Corr: 0.1190 
2024-06-12 15:43:17:INFO:TRAIN-(cmcm) (9/10/2)>> loss: 0.8723
2024-06-12 15:43:20:INFO:VAL-(cmcm) >>
2024-06-12 15:43:20:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5261  Non0_acc_2: 0.5000  Non0_F1_score: 0.4941  Mult_acc_5: 0.2402  Mult_acc_7: 0.2009  MAE: 1.5136  Corr: 0.0210 
2024-06-12 15:43:35:INFO:TRAIN-(cmcm) (10/11/2)>> loss: 0.8648
2024-06-12 15:43:37:INFO:VAL-(cmcm) >>
2024-06-12 15:43:37:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5209  Non0_acc_2: 0.5648  Non0_F1_score: 0.5019  Mult_acc_5: 0.2707  Mult_acc_7: 0.2271  MAE: 1.7424  Corr: -0.0113 
2024-06-12 15:43:45:INFO:TEST-(cmcm) >>
2024-06-12 15:43:45:INFO:M: >>  Has0_acc_2: 0.4475  Has0_F1_score: 0.2767  Non0_acc_2: 0.5777  Non0_F1_score: 0.4231  Mult_acc_5: 0.1545  Mult_acc_7: 0.1545  MAE: 1.4174  Corr: nan 
2024-06-12 15:43:45:INFO:Results are added to results/results/mosi-regression-100.csv...
2024-06-12 15:43:45:INFO:Start running cmcm...
2024-06-12 15:43:45:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 100, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 3333}>
2024-06-12 15:43:45:INFO:Let's use the GPU 1 !
2024-06-12 15:43:45:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 15:43:45:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718178226 HTTP/1.1" 200 235
2024-06-12 15:43:46:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 15:43:46:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 15:43:47:INFO:train samples: (1284,)
2024-06-12 15:43:47:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 15:43:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718178227 HTTP/1.1" 200 235
2024-06-12 15:43:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 15:43:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 15:43:48:INFO:valid samples: (229,)
2024-06-12 15:43:49:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 15:43:49:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718178229 HTTP/1.1" 200 235
2024-06-12 15:43:49:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 15:43:49:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 15:43:50:INFO:test samples: (686,)
2024-06-12 15:43:50:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 15:43:50:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718178231 HTTP/1.1" 200 235
2024-06-12 15:43:52:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 15:43:56:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 15:43:57:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 15:43:57:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718178237 HTTP/1.1" 200 235
2024-06-12 15:44:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 15:44:03:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 15:44:03:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-12 15:44:03:WARNING:Try importing flash-attention for faster inference...
2024-06-12 15:44:03:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-12 15:44:03:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-12 15:44:03:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-12 15:44:04:INFO:trainable params: 1310284 || all params: 1838138956 || trainable%: 0.07128318540461856
2024-06-12 15:44:04:INFO:Init labels...
2024-06-12 15:44:04:INFO:Start training...
2024-06-12 15:44:19:INFO:TRAIN-(cmcm) (1/1/3)>> loss: 4.3535
2024-06-12 15:44:21:INFO:VAL-(cmcm) >>
2024-06-12 15:44:21:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4259  Non0_F1_score: 0.2544  Mult_acc_5: 0.2140  Mult_acc_7: 0.2140  MAE: 1.4370  Corr: nan 
2024-06-12 15:44:22:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-12 15:44:37:INFO:TRAIN-(cmcm) (1/2/3)>> loss: 3.8121
2024-06-12 15:44:39:INFO:VAL-(cmcm) >>
2024-06-12 15:44:39:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5324  Non0_F1_score: 0.5226  Mult_acc_5: 0.2838  Mult_acc_7: 0.1790  MAE: 1.7515  Corr: 0.0710 
2024-06-12 15:44:54:INFO:TRAIN-(cmcm) (2/3/3)>> loss: 1.9585
2024-06-12 15:44:57:INFO:VAL-(cmcm) >>
2024-06-12 15:44:57:INFO:M: >>  Has0_acc_2: 0.5502  Has0_F1_score: 0.5446  Non0_acc_2: 0.5370  Non0_F1_score: 0.5303  Mult_acc_5: 0.2096  Mult_acc_7: 0.1747  MAE: 1.7402  Corr: 0.0395 
2024-06-12 15:45:11:INFO:TRAIN-(cmcm) (3/4/3)>> loss: 1.0049
2024-06-12 15:45:14:INFO:VAL-(cmcm) >>
2024-06-12 15:45:14:INFO:M: >>  Has0_acc_2: 0.5546  Has0_F1_score: 0.5508  Non0_acc_2: 0.5648  Non0_F1_score: 0.5617  Mult_acc_5: 0.1965  Mult_acc_7: 0.1834  MAE: 1.5822  Corr: 0.0267 
2024-06-12 15:45:29:INFO:TRAIN-(cmcm) (4/5/3)>> loss: 0.9412
2024-06-12 15:45:31:INFO:VAL-(cmcm) >>
2024-06-12 15:45:31:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5694  Non0_F1_score: 0.4166  Mult_acc_5: 0.2314  Mult_acc_7: 0.2271  MAE: 1.4213  Corr: 0.0092 
2024-06-12 15:45:32:INFO:Saving checkpoint at epoch 5 to results/models/cmcm-mosi-regression.pth.
2024-06-12 15:45:47:INFO:TRAIN-(cmcm) (1/6/3)>> loss: 0.9060
2024-06-12 15:45:49:INFO:VAL-(cmcm) >>
2024-06-12 15:45:49:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5129  Non0_acc_2: 0.5694  Non0_F1_score: 0.4871  Mult_acc_5: 0.2620  Mult_acc_7: 0.1965  MAE: 1.7027  Corr: -0.0305 
2024-06-12 15:46:04:INFO:TRAIN-(cmcm) (2/7/3)>> loss: 0.8888
2024-06-12 15:46:07:INFO:VAL-(cmcm) >>
2024-06-12 15:46:07:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.5187  Non0_acc_2: 0.5787  Non0_F1_score: 0.4932  Mult_acc_5: 0.2795  Mult_acc_7: 0.2052  MAE: 1.6433  Corr: 0.0057 
2024-06-12 15:46:21:INFO:TRAIN-(cmcm) (3/8/3)>> loss: 0.8827
2024-06-12 15:46:24:INFO:VAL-(cmcm) >>
2024-06-12 15:46:24:INFO:M: >>  Has0_acc_2: 0.6201  Has0_F1_score: 0.5827  Non0_acc_2: 0.6204  Non0_F1_score: 0.5814  Mult_acc_5: 0.3013  Mult_acc_7: 0.2402  MAE: 1.5206  Corr: 0.1117 
2024-06-12 15:46:39:INFO:TRAIN-(cmcm) (4/9/3)>> loss: 0.8803
2024-06-12 15:46:41:INFO:VAL-(cmcm) >>
2024-06-12 15:46:41:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5509  Non0_F1_score: 0.5395  Mult_acc_5: 0.2358  Mult_acc_7: 0.2227  MAE: 1.4135  Corr: 0.0741 
2024-06-12 15:46:42:INFO:Saving checkpoint at epoch 9 to results/models/cmcm-mosi-regression.pth.
2024-06-12 15:46:57:INFO:TRAIN-(cmcm) (1/10/3)>> loss: 0.8779
2024-06-12 15:46:59:INFO:VAL-(cmcm) >>
2024-06-12 15:46:59:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.4815  Non0_acc_2: 0.5833  Non0_F1_score: 0.4542  Mult_acc_5: 0.2096  Mult_acc_7: 0.1921  MAE: 1.5606  Corr: 0.0741 
2024-06-12 15:47:14:INFO:TRAIN-(cmcm) (2/11/3)>> loss: 0.8721
2024-06-12 15:47:16:INFO:VAL-(cmcm) >>
2024-06-12 15:47:16:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.4780  Non0_acc_2: 0.5648  Non0_F1_score: 0.4627  Mult_acc_5: 0.1572  Mult_acc_7: 0.1528  MAE: 1.6795  Corr: -0.0581 
2024-06-12 15:47:31:INFO:TRAIN-(cmcm) (3/12/3)>> loss: 0.8631
2024-06-12 15:47:34:INFO:VAL-(cmcm) >>
2024-06-12 15:47:34:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5175  Non0_acc_2: 0.5787  Non0_F1_score: 0.5029  Mult_acc_5: 0.2576  Mult_acc_7: 0.1921  MAE: 1.5926  Corr: 0.0668 
2024-06-12 15:47:48:INFO:TRAIN-(cmcm) (4/13/3)>> loss: 0.8573
2024-06-12 15:47:51:INFO:VAL-(cmcm) >>
2024-06-12 15:47:51:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.5024  Non0_acc_2: 0.5602  Non0_F1_score: 0.4761  Mult_acc_5: 0.2402  Mult_acc_7: 0.1747  MAE: 1.8490  Corr: -0.0089 
2024-06-12 15:48:06:INFO:TRAIN-(cmcm) (5/14/3)>> loss: 0.8555
2024-06-12 15:48:08:INFO:VAL-(cmcm) >>
2024-06-12 15:48:08:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5785  Non0_acc_2: 0.5787  Non0_F1_score: 0.5665  Mult_acc_5: 0.2795  Mult_acc_7: 0.1921  MAE: 1.6830  Corr: 0.1249 
2024-06-12 15:48:23:INFO:TRAIN-(cmcm) (6/15/3)>> loss: 0.8589
2024-06-12 15:48:25:INFO:VAL-(cmcm) >>
2024-06-12 15:48:25:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.4939  Non0_acc_2: 0.5509  Non0_F1_score: 0.5425  Mult_acc_5: 0.2358  Mult_acc_7: 0.1921  MAE: 1.5603  Corr: 0.1009 
2024-06-12 15:48:40:INFO:TRAIN-(cmcm) (7/16/3)>> loss: 0.8486
2024-06-12 15:48:43:INFO:VAL-(cmcm) >>
2024-06-12 15:48:43:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.5821  Non0_acc_2: 0.5694  Non0_F1_score: 0.5677  Mult_acc_5: 0.2358  Mult_acc_7: 0.1965  MAE: 1.5410  Corr: 0.1353 
2024-06-12 15:48:57:INFO:TRAIN-(cmcm) (8/17/3)>> loss: 0.8503
2024-06-12 15:49:00:INFO:VAL-(cmcm) >>
2024-06-12 15:49:00:INFO:M: >>  Has0_acc_2: 0.6332  Has0_F1_score: 0.5738  Non0_acc_2: 0.5694  Non0_F1_score: 0.5629  Mult_acc_5: 0.2183  Mult_acc_7: 0.2140  MAE: 1.3886  Corr: 0.2195 
2024-06-12 15:49:00:INFO:Saving checkpoint at epoch 17 to results/models/cmcm-mosi-regression.pth.
2024-06-12 15:49:16:INFO:TRAIN-(cmcm) (1/18/3)>> loss: 0.8475
2024-06-12 15:49:18:INFO:VAL-(cmcm) >>
2024-06-12 15:49:18:INFO:M: >>  Has0_acc_2: 0.6201  Has0_F1_score: 0.6091  Non0_acc_2: 0.6111  Non0_F1_score: 0.6005  Mult_acc_5: 0.3013  Mult_acc_7: 0.2271  MAE: 1.5765  Corr: 0.1807 
2024-06-12 15:49:33:INFO:TRAIN-(cmcm) (2/19/3)>> loss: 0.8463
2024-06-12 15:49:35:INFO:VAL-(cmcm) >>
2024-06-12 15:49:35:INFO:M: >>  Has0_acc_2: 0.6463  Has0_F1_score: 0.6479  Non0_acc_2: 0.6435  Non0_F1_score: 0.6414  Mult_acc_5: 0.3057  Mult_acc_7: 0.2445  MAE: 1.5228  Corr: 0.2524 
2024-06-12 15:49:50:INFO:TRAIN-(cmcm) (3/20/3)>> loss: 0.8474
2024-06-12 15:49:53:INFO:VAL-(cmcm) >>
2024-06-12 15:49:53:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5070  Non0_acc_2: 0.5648  Non0_F1_score: 0.5019  Mult_acc_5: 0.2183  Mult_acc_7: 0.1878  MAE: 1.5720  Corr: 0.0359 
2024-06-12 15:50:07:INFO:TRAIN-(cmcm) (4/21/3)>> loss: 0.8369
2024-06-12 15:50:10:INFO:VAL-(cmcm) >>
2024-06-12 15:50:10:INFO:M: >>  Has0_acc_2: 0.5328  Has0_F1_score: 0.5240  Non0_acc_2: 0.5278  Non0_F1_score: 0.5140  Mult_acc_5: 0.1921  Mult_acc_7: 0.1878  MAE: 1.6156  Corr: 0.1504 
2024-06-12 15:50:25:INFO:TRAIN-(cmcm) (5/22/3)>> loss: 0.8344
2024-06-12 15:50:27:INFO:VAL-(cmcm) >>
2024-06-12 15:50:27:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.5409  Non0_acc_2: 0.5417  Non0_F1_score: 0.5368  Mult_acc_5: 0.2358  Mult_acc_7: 0.2052  MAE: 1.5881  Corr: 0.0578 
2024-06-12 15:50:42:INFO:TRAIN-(cmcm) (6/23/3)>> loss: 0.8331
2024-06-12 15:50:44:INFO:VAL-(cmcm) >>
2024-06-12 15:50:44:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.5440  Non0_acc_2: 0.5833  Non0_F1_score: 0.5652  Mult_acc_5: 0.2751  Mult_acc_7: 0.2183  MAE: 1.5101  Corr: 0.1439 
2024-06-12 15:50:59:INFO:TRAIN-(cmcm) (7/24/3)>> loss: 0.8370
2024-06-12 15:51:02:INFO:VAL-(cmcm) >>
2024-06-12 15:51:02:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.6046  Non0_acc_2: 0.6019  Non0_F1_score: 0.5981  Mult_acc_5: 0.3013  Mult_acc_7: 0.2314  MAE: 1.5555  Corr: 0.1783 
2024-06-12 15:51:16:INFO:TRAIN-(cmcm) (8/25/3)>> loss: 0.8255
2024-06-12 15:51:19:INFO:VAL-(cmcm) >>
2024-06-12 15:51:19:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5925  Non0_acc_2: 0.5972  Non0_F1_score: 0.5975  Mult_acc_5: 0.2838  Mult_acc_7: 0.2227  MAE: 1.5761  Corr: 0.2116 
2024-06-12 15:51:34:INFO:TRAIN-(cmcm) (9/26/3)>> loss: 0.8204
2024-06-12 15:51:36:INFO:VAL-(cmcm) >>
2024-06-12 15:51:36:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5886  Non0_acc_2: 0.6019  Non0_F1_score: 0.5888  Mult_acc_5: 0.2926  Mult_acc_7: 0.2358  MAE: 1.4625  Corr: 0.2946 
2024-06-12 15:51:51:INFO:TRAIN-(cmcm) (10/27/3)>> loss: 0.8237
2024-06-12 15:51:54:INFO:VAL-(cmcm) >>
2024-06-12 15:51:54:INFO:M: >>  Has0_acc_2: 0.5502  Has0_F1_score: 0.5502  Non0_acc_2: 0.5602  Non0_F1_score: 0.5567  Mult_acc_5: 0.2402  Mult_acc_7: 0.1790  MAE: 1.6171  Corr: 0.1799 
2024-06-12 15:52:01:INFO:TEST-(cmcm) >>
2024-06-12 15:52:01:INFO:M: >>  Has0_acc_2: 0.5350  Has0_F1_score: 0.4863  Non0_acc_2: 0.5503  Non0_F1_score: 0.5475  Mult_acc_5: 0.1866  Mult_acc_7: 0.1837  MAE: 1.4080  Corr: 0.1307 
2024-06-12 15:52:01:INFO:Results are added to results/results/mosi-regression-100.csv...
2024-06-12 15:52:01:INFO:Start running cmcm...
2024-06-12 15:52:01:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 100, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 4444}>
2024-06-12 15:52:01:INFO:Let's use the GPU 1 !
2024-06-12 15:52:01:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 15:52:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718178722 HTTP/1.1" 200 235
2024-06-12 15:52:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 15:52:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 15:52:03:INFO:train samples: (1284,)
2024-06-12 15:52:03:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 15:52:04:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718178724 HTTP/1.1" 200 235
2024-06-12 15:52:04:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 15:52:04:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 15:52:05:INFO:valid samples: (229,)
2024-06-12 15:52:05:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 15:52:05:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718178725 HTTP/1.1" 200 235
2024-06-12 15:52:05:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 15:52:06:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 15:52:06:INFO:test samples: (686,)
2024-06-12 15:52:06:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 15:52:07:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718178727 HTTP/1.1" 200 235
2024-06-12 15:52:07:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 15:52:07:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 15:52:08:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 15:52:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718178728 HTTP/1.1" 200 235
2024-06-12 15:52:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 15:52:09:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 15:52:09:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-12 15:52:09:WARNING:Try importing flash-attention for faster inference...
2024-06-12 15:52:09:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-12 15:52:09:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-12 15:52:09:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-12 15:52:10:INFO:trainable params: 1310284 || all params: 1838138956 || trainable%: 0.07128318540461856
2024-06-12 15:52:10:INFO:Init labels...
2024-06-12 15:52:10:INFO:Start training...
2024-06-12 15:52:25:INFO:TRAIN-(cmcm) (1/1/4)>> loss: 4.0930
2024-06-12 15:52:27:INFO:VAL-(cmcm) >>
2024-06-12 15:52:27:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4259  Non0_F1_score: 0.2544  Mult_acc_5: 0.2140  Mult_acc_7: 0.2140  MAE: 1.4370  Corr: nan 
2024-06-12 15:52:27:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-12 15:52:43:INFO:TRAIN-(cmcm) (1/2/4)>> loss: 2.0309
2024-06-12 15:52:45:INFO:VAL-(cmcm) >>
2024-06-12 15:52:45:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.4513  Non0_acc_2: 0.5648  Non0_F1_score: 0.4684  Mult_acc_5: 0.1790  Mult_acc_7: 0.1790  MAE: 1.4746  Corr: -0.0171 
2024-06-12 15:53:00:INFO:TRAIN-(cmcm) (2/3/4)>> loss: 1.0669
2024-06-12 15:53:02:INFO:VAL-(cmcm) >>
2024-06-12 15:53:02:INFO:M: >>  Has0_acc_2: 0.5633  Has0_F1_score: 0.5219  Non0_acc_2: 0.5556  Non0_F1_score: 0.5247  Mult_acc_5: 0.2009  Mult_acc_7: 0.1790  MAE: 1.6293  Corr: 0.0024 
2024-06-12 15:53:17:INFO:TRAIN-(cmcm) (3/4/4)>> loss: 0.9851
2024-06-12 15:53:20:INFO:VAL-(cmcm) >>
2024-06-12 15:53:20:INFO:M: >>  Has0_acc_2: 0.5502  Has0_F1_score: 0.5121  Non0_acc_2: 0.5324  Non0_F1_score: 0.5110  Mult_acc_5: 0.1747  Mult_acc_7: 0.1703  MAE: 1.6021  Corr: -0.0344 
2024-06-12 15:53:34:INFO:TRAIN-(cmcm) (4/5/4)>> loss: 0.9753
2024-06-12 15:53:37:INFO:VAL-(cmcm) >>
2024-06-12 15:53:37:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5518  Non0_acc_2: 0.5648  Non0_F1_score: 0.5371  Mult_acc_5: 0.2009  Mult_acc_7: 0.1834  MAE: 1.5926  Corr: 0.0488 
2024-06-12 15:53:52:INFO:TRAIN-(cmcm) (5/6/4)>> loss: 1.0216
2024-06-12 15:53:54:INFO:VAL-(cmcm) >>
2024-06-12 15:53:54:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5209  Non0_acc_2: 0.4398  Non0_F1_score: 0.3119  Mult_acc_5: 0.2009  Mult_acc_7: 0.2009  MAE: 1.5074  Corr: 0.0156 
2024-06-12 15:54:09:INFO:TRAIN-(cmcm) (6/7/4)>> loss: 0.9588
2024-06-12 15:54:12:INFO:VAL-(cmcm) >>
2024-06-12 15:54:12:INFO:M: >>  Has0_acc_2: 0.5459  Has0_F1_score: 0.5466  Non0_acc_2: 0.5463  Non0_F1_score: 0.5456  Mult_acc_5: 0.2227  Mult_acc_7: 0.2096  MAE: 1.5969  Corr: 0.0572 
2024-06-12 15:54:26:INFO:TRAIN-(cmcm) (7/8/4)>> loss: 0.9306
2024-06-12 15:54:29:INFO:VAL-(cmcm) >>
2024-06-12 15:54:29:INFO:M: >>  Has0_acc_2: 0.5197  Has0_F1_score: 0.5192  Non0_acc_2: 0.5278  Non0_F1_score: 0.5255  Mult_acc_5: 0.2620  Mult_acc_7: 0.2140  MAE: 1.5520  Corr: 0.0225 
2024-06-12 15:54:43:INFO:TRAIN-(cmcm) (8/9/4)>> loss: 0.9150
2024-06-12 15:54:46:INFO:VAL-(cmcm) >>
2024-06-12 15:54:46:INFO:M: >>  Has0_acc_2: 0.6245  Has0_F1_score: 0.5914  Non0_acc_2: 0.6157  Non0_F1_score: 0.5804  Mult_acc_5: 0.2227  Mult_acc_7: 0.2227  MAE: 1.4894  Corr: 0.1092 
2024-06-12 15:55:01:INFO:TRAIN-(cmcm) (9/10/4)>> loss: 0.9056
2024-06-12 15:55:03:INFO:VAL-(cmcm) >>
2024-06-12 15:55:03:INFO:M: >>  Has0_acc_2: 0.5284  Has0_F1_score: 0.5158  Non0_acc_2: 0.5324  Non0_F1_score: 0.5162  Mult_acc_5: 0.1965  Mult_acc_7: 0.1965  MAE: 1.4817  Corr: 0.1183 
2024-06-12 15:55:18:INFO:TRAIN-(cmcm) (10/11/4)>> loss: 1.1318
2024-06-12 15:55:21:INFO:VAL-(cmcm) >>
2024-06-12 15:55:21:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.5371  Non0_acc_2: 0.5972  Non0_F1_score: 0.5445  Mult_acc_5: 0.2096  Mult_acc_7: 0.1921  MAE: 1.5091  Corr: 0.0652 
2024-06-12 15:55:28:INFO:TEST-(cmcm) >>
2024-06-12 15:55:28:INFO:M: >>  Has0_acc_2: 0.4461  Has0_F1_score: 0.2761  Non0_acc_2: 0.5777  Non0_F1_score: 0.4231  Mult_acc_5: 0.1545  Mult_acc_7: 0.1545  MAE: 1.4181  Corr: -0.0124 
2024-06-12 15:55:28:INFO:Results are added to results/results/mosi-regression-100.csv...
2024-06-12 15:55:28:INFO:Start running cmcm...
2024-06-12 15:55:28:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 100, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 5555}>
2024-06-12 15:55:28:INFO:Let's use the GPU 1 !
2024-06-12 15:55:28:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 15:55:29:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718178929 HTTP/1.1" 200 235
2024-06-12 15:55:29:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 15:55:29:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 15:55:30:INFO:train samples: (1284,)
2024-06-12 15:55:30:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 15:55:30:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718178931 HTTP/1.1" 200 235
2024-06-12 15:55:31:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 15:55:31:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 15:55:32:INFO:valid samples: (229,)
2024-06-12 15:55:32:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 15:55:32:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718178932 HTTP/1.1" 200 235
2024-06-12 15:55:33:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 15:55:33:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 15:55:34:INFO:test samples: (686,)
2024-06-12 15:55:34:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 15:55:34:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718178934 HTTP/1.1" 200 235
2024-06-12 15:55:34:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 15:55:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 15:55:35:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 15:55:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718178935 HTTP/1.1" 200 235
2024-06-12 15:55:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 15:55:36:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 15:55:36:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-12 15:55:36:WARNING:Try importing flash-attention for faster inference...
2024-06-12 15:55:36:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-12 15:55:36:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-12 15:55:36:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-12 15:55:37:INFO:trainable params: 1310284 || all params: 1838138956 || trainable%: 0.07128318540461856
2024-06-12 15:55:37:INFO:Init labels...
2024-06-12 15:55:37:INFO:Start training...
2024-06-12 15:55:52:INFO:TRAIN-(cmcm) (1/1/5)>> loss: 3.7542
2024-06-12 15:55:54:INFO:VAL-(cmcm) >>
2024-06-12 15:55:54:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4577  Non0_acc_2: 0.5880  Non0_F1_score: 0.4827  Mult_acc_5: 0.3057  Mult_acc_7: 0.1266  MAE: 2.4263  Corr: 0.0400 
2024-06-12 15:55:55:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-12 15:56:10:INFO:TRAIN-(cmcm) (1/2/5)>> loss: 1.2446
2024-06-12 15:56:13:INFO:VAL-(cmcm) >>
2024-06-12 15:56:13:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.4653  Non0_acc_2: 0.5648  Non0_F1_score: 0.4505  Mult_acc_5: 0.1528  Mult_acc_7: 0.1266  MAE: 1.5905  Corr: -0.0001 
2024-06-12 15:56:13:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-12 15:56:28:INFO:TRAIN-(cmcm) (1/3/5)>> loss: 0.9676
2024-06-12 15:56:31:INFO:VAL-(cmcm) >>
2024-06-12 15:56:31:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4458  Non0_acc_2: 0.5741  Non0_F1_score: 0.4420  Mult_acc_5: 0.1878  Mult_acc_7: 0.1747  MAE: 1.5938  Corr: -0.0633 
2024-06-12 15:56:45:INFO:TRAIN-(cmcm) (2/4/5)>> loss: 0.9107
2024-06-12 15:56:48:INFO:VAL-(cmcm) >>
2024-06-12 15:56:48:INFO:M: >>  Has0_acc_2: 0.5546  Has0_F1_score: 0.5409  Non0_acc_2: 0.5463  Non0_F1_score: 0.5305  Mult_acc_5: 0.1616  Mult_acc_7: 0.1441  MAE: 1.7031  Corr: -0.0133 
2024-06-12 15:57:03:INFO:TRAIN-(cmcm) (3/5/5)>> loss: 0.8846
2024-06-12 15:57:05:INFO:VAL-(cmcm) >>
2024-06-12 15:57:05:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4630  Non0_acc_2: 0.5694  Non0_F1_score: 0.4595  Mult_acc_5: 0.1616  Mult_acc_7: 0.1616  MAE: 1.4720  Corr: 0.0639 
2024-06-12 15:57:05:INFO:Saving checkpoint at epoch 5 to results/models/cmcm-mosi-regression.pth.
2024-06-12 15:57:20:INFO:TRAIN-(cmcm) (1/6/5)>> loss: 0.8863
2024-06-12 15:57:23:INFO:VAL-(cmcm) >>
2024-06-12 15:57:23:INFO:M: >>  Has0_acc_2: 0.5546  Has0_F1_score: 0.5353  Non0_acc_2: 0.5370  Non0_F1_score: 0.5169  Mult_acc_5: 0.1616  Mult_acc_7: 0.1616  MAE: 1.6892  Corr: -0.0068 
2024-06-12 15:57:38:INFO:TRAIN-(cmcm) (2/7/5)>> loss: 0.8830
2024-06-12 15:57:40:INFO:VAL-(cmcm) >>
2024-06-12 15:57:40:INFO:M: >>  Has0_acc_2: 0.4061  Has0_F1_score: 0.2541  Non0_acc_2: 0.4306  Non0_F1_score: 0.2797  Mult_acc_5: 0.1310  Mult_acc_7: 0.1310  MAE: 1.7715  Corr: 0.0240 
2024-06-12 15:57:55:INFO:TRAIN-(cmcm) (3/8/5)>> loss: 0.8749
2024-06-12 15:57:57:INFO:VAL-(cmcm) >>
2024-06-12 15:57:57:INFO:M: >>  Has0_acc_2: 0.4978  Has0_F1_score: 0.4836  Non0_acc_2: 0.5046  Non0_F1_score: 0.4874  Mult_acc_5: 0.1790  Mult_acc_7: 0.1790  MAE: 1.6296  Corr: 0.0974 
2024-06-12 15:58:12:INFO:TRAIN-(cmcm) (4/9/5)>> loss: 0.8825
2024-06-12 15:58:15:INFO:VAL-(cmcm) >>
2024-06-12 15:58:15:INFO:M: >>  Has0_acc_2: 0.5546  Has0_F1_score: 0.5287  Non0_acc_2: 0.5509  Non0_F1_score: 0.5282  Mult_acc_5: 0.2533  Mult_acc_7: 0.1747  MAE: 1.9088  Corr: -0.0035 
2024-06-12 15:58:29:INFO:TRAIN-(cmcm) (5/10/5)>> loss: 0.8669
2024-06-12 15:58:32:INFO:VAL-(cmcm) >>
2024-06-12 15:58:32:INFO:M: >>  Has0_acc_2: 0.5633  Has0_F1_score: 0.4882  Non0_acc_2: 0.5463  Non0_F1_score: 0.4671  Mult_acc_5: 0.2838  Mult_acc_7: 0.2052  MAE: 1.7568  Corr: -0.0428 
2024-06-12 15:58:47:INFO:TRAIN-(cmcm) (6/11/5)>> loss: 0.8604
2024-06-12 15:58:49:INFO:VAL-(cmcm) >>
2024-06-12 15:58:49:INFO:M: >>  Has0_acc_2: 0.6507  Has0_F1_score: 0.6399  Non0_acc_2: 0.6296  Non0_F1_score: 0.6243  Mult_acc_5: 0.2707  Mult_acc_7: 0.2227  MAE: 1.4860  Corr: 0.2105 
2024-06-12 15:59:04:INFO:TRAIN-(cmcm) (7/12/5)>> loss: 0.8496
2024-06-12 15:59:06:INFO:VAL-(cmcm) >>
2024-06-12 15:59:07:INFO:M: >>  Has0_acc_2: 0.6550  Has0_F1_score: 0.6235  Non0_acc_2: 0.6528  Non0_F1_score: 0.6232  Mult_acc_5: 0.2795  Mult_acc_7: 0.2271  MAE: 1.4909  Corr: 0.2527 
2024-06-12 15:59:21:INFO:TRAIN-(cmcm) (8/13/5)>> loss: 0.8418
2024-06-12 15:59:24:INFO:VAL-(cmcm) >>
2024-06-12 15:59:24:INFO:M: >>  Has0_acc_2: 0.6507  Has0_F1_score: 0.6355  Non0_acc_2: 0.6528  Non0_F1_score: 0.6352  Mult_acc_5: 0.3581  Mult_acc_7: 0.2751  MAE: 1.4702  Corr: 0.2893 
2024-06-12 15:59:24:INFO:Saving checkpoint at epoch 13 to results/models/cmcm-mosi-regression.pth.
2024-06-12 15:59:39:INFO:TRAIN-(cmcm) (1/14/5)>> loss: 0.8401
2024-06-12 15:59:42:INFO:VAL-(cmcm) >>
2024-06-12 15:59:42:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.5704  Non0_acc_2: 0.6111  Non0_F1_score: 0.5969  Mult_acc_5: 0.2707  Mult_acc_7: 0.2052  MAE: 1.5437  Corr: 0.3523 
2024-06-12 15:59:56:INFO:TRAIN-(cmcm) (2/15/5)>> loss: 0.8218
2024-06-12 15:59:59:INFO:VAL-(cmcm) >>
2024-06-12 15:59:59:INFO:M: >>  Has0_acc_2: 0.6201  Has0_F1_score: 0.5020  Non0_acc_2: 0.5972  Non0_F1_score: 0.4757  Mult_acc_5: 0.2664  Mult_acc_7: 0.2271  MAE: 1.4711  Corr: 0.2779 
2024-06-12 16:00:14:INFO:TRAIN-(cmcm) (3/16/5)>> loss: 0.8103
2024-06-12 16:00:16:INFO:VAL-(cmcm) >>
2024-06-12 16:00:16:INFO:M: >>  Has0_acc_2: 0.6463  Has0_F1_score: 0.6479  Non0_acc_2: 0.6806  Non0_F1_score: 0.6812  Mult_acc_5: 0.3362  Mult_acc_7: 0.2489  MAE: 1.3921  Corr: 0.4215 
2024-06-12 16:00:16:INFO:Saving checkpoint at epoch 16 to results/models/cmcm-mosi-regression.pth.
2024-06-12 16:00:31:INFO:TRAIN-(cmcm) (1/17/5)>> loss: 0.7943
2024-06-12 16:00:34:INFO:VAL-(cmcm) >>
2024-06-12 16:00:34:INFO:M: >>  Has0_acc_2: 0.6419  Has0_F1_score: 0.6441  Non0_acc_2: 0.5972  Non0_F1_score: 0.5817  Mult_acc_5: 0.2664  Mult_acc_7: 0.2227  MAE: 1.3008  Corr: 0.3834 
2024-06-12 16:00:34:INFO:Saving checkpoint at epoch 17 to results/models/cmcm-mosi-regression.pth.
2024-06-12 16:00:49:INFO:TRAIN-(cmcm) (1/18/5)>> loss: 0.7865
2024-06-12 16:00:52:INFO:VAL-(cmcm) >>
2024-06-12 16:00:52:INFO:M: >>  Has0_acc_2: 0.6856  Has0_F1_score: 0.6793  Non0_acc_2: 0.6944  Non0_F1_score: 0.6872  Mult_acc_5: 0.3537  Mult_acc_7: 0.2620  MAE: 1.2908  Corr: 0.4560 
2024-06-12 16:00:52:INFO:Saving checkpoint at epoch 18 to results/models/cmcm-mosi-regression.pth.
2024-06-12 16:01:07:INFO:TRAIN-(cmcm) (1/19/5)>> loss: 0.7759
2024-06-12 16:01:10:INFO:VAL-(cmcm) >>
2024-06-12 16:01:10:INFO:M: >>  Has0_acc_2: 0.6725  Has0_F1_score: 0.6469  Non0_acc_2: 0.6528  Non0_F1_score: 0.6543  Mult_acc_5: 0.3755  Mult_acc_7: 0.3057  MAE: 1.1571  Corr: 0.5042 
2024-06-12 16:01:10:INFO:Saving checkpoint at epoch 19 to results/models/cmcm-mosi-regression.pth.
2024-06-12 16:01:25:INFO:TRAIN-(cmcm) (1/20/5)>> loss: 0.7760
2024-06-12 16:01:28:INFO:VAL-(cmcm) >>
2024-06-12 16:01:28:INFO:M: >>  Has0_acc_2: 0.6725  Has0_F1_score: 0.6693  Non0_acc_2: 0.6991  Non0_F1_score: 0.6943  Mult_acc_5: 0.3450  Mult_acc_7: 0.2533  MAE: 1.2612  Corr: 0.4583 
2024-06-12 16:01:42:INFO:TRAIN-(cmcm) (2/21/5)>> loss: 0.7710
2024-06-12 16:01:45:INFO:VAL-(cmcm) >>
2024-06-12 16:01:45:INFO:M: >>  Has0_acc_2: 0.6507  Has0_F1_score: 0.6509  Non0_acc_2: 0.6852  Non0_F1_score: 0.6852  Mult_acc_5: 0.3144  Mult_acc_7: 0.2576  MAE: 1.3100  Corr: 0.4635 
2024-06-12 16:02:00:INFO:TRAIN-(cmcm) (3/22/5)>> loss: 0.7587
2024-06-12 16:02:02:INFO:VAL-(cmcm) >>
2024-06-12 16:02:02:INFO:M: >>  Has0_acc_2: 0.7205  Has0_F1_score: 0.7096  Non0_acc_2: 0.6806  Non0_F1_score: 0.6786  Mult_acc_5: 0.3755  Mult_acc_7: 0.2969  MAE: 1.1196  Corr: 0.5249 
2024-06-12 16:02:02:INFO:Saving checkpoint at epoch 22 to results/models/cmcm-mosi-regression.pth.
2024-06-12 16:02:17:INFO:TRAIN-(cmcm) (1/23/5)>> loss: 0.7539
2024-06-12 16:02:20:INFO:VAL-(cmcm) >>
2024-06-12 16:02:20:INFO:M: >>  Has0_acc_2: 0.7118  Has0_F1_score: 0.6935  Non0_acc_2: 0.7130  Non0_F1_score: 0.6930  Mult_acc_5: 0.3799  Mult_acc_7: 0.3057  MAE: 1.2158  Corr: 0.4864 
2024-06-12 16:02:35:INFO:TRAIN-(cmcm) (2/24/5)>> loss: 0.7514
2024-06-12 16:02:37:INFO:VAL-(cmcm) >>
2024-06-12 16:02:37:INFO:M: >>  Has0_acc_2: 0.6463  Has0_F1_score: 0.6426  Non0_acc_2: 0.5833  Non0_F1_score: 0.5473  Mult_acc_5: 0.3275  Mult_acc_7: 0.2751  MAE: 1.2593  Corr: 0.4748 
2024-06-12 16:02:52:INFO:TRAIN-(cmcm) (3/25/5)>> loss: 0.7404
2024-06-12 16:02:54:INFO:VAL-(cmcm) >>
2024-06-12 16:02:54:INFO:M: >>  Has0_acc_2: 0.6987  Has0_F1_score: 0.7009  Non0_acc_2: 0.7222  Non0_F1_score: 0.7229  Mult_acc_5: 0.3843  Mult_acc_7: 0.2882  MAE: 1.2961  Corr: 0.4703 
2024-06-12 16:03:09:INFO:TRAIN-(cmcm) (4/26/5)>> loss: 0.7355
2024-06-12 16:03:12:INFO:VAL-(cmcm) >>
2024-06-12 16:03:12:INFO:M: >>  Has0_acc_2: 0.6900  Has0_F1_score: 0.6798  Non0_acc_2: 0.7130  Non0_F1_score: 0.7005  Mult_acc_5: 0.3581  Mult_acc_7: 0.2707  MAE: 1.2344  Corr: 0.4706 
2024-06-12 16:03:26:INFO:TRAIN-(cmcm) (5/27/5)>> loss: 0.7274
2024-06-12 16:03:29:INFO:VAL-(cmcm) >>
2024-06-12 16:03:29:INFO:M: >>  Has0_acc_2: 0.7031  Has0_F1_score: 0.7005  Non0_acc_2: 0.7130  Non0_F1_score: 0.7130  Mult_acc_5: 0.3668  Mult_acc_7: 0.2882  MAE: 1.2298  Corr: 0.4722 
2024-06-12 16:03:43:INFO:TRAIN-(cmcm) (6/28/5)>> loss: 0.7383
2024-06-12 16:03:46:INFO:VAL-(cmcm) >>
2024-06-12 16:03:46:INFO:M: >>  Has0_acc_2: 0.6987  Has0_F1_score: 0.6835  Non0_acc_2: 0.6759  Non0_F1_score: 0.6749  Mult_acc_5: 0.3712  Mult_acc_7: 0.2969  MAE: 1.2462  Corr: 0.4321 
2024-06-12 16:04:01:INFO:TRAIN-(cmcm) (7/29/5)>> loss: 0.7274
2024-06-12 16:04:03:INFO:VAL-(cmcm) >>
2024-06-12 16:04:03:INFO:M: >>  Has0_acc_2: 0.7031  Has0_F1_score: 0.7036  Non0_acc_2: 0.6852  Non0_F1_score: 0.6869  Mult_acc_5: 0.3362  Mult_acc_7: 0.2707  MAE: 1.2091  Corr: 0.4898 
2024-06-12 16:04:18:INFO:TRAIN-(cmcm) (8/30/5)>> loss: 0.7184
2024-06-12 16:04:20:INFO:VAL-(cmcm) >>
2024-06-12 16:04:20:INFO:M: >>  Has0_acc_2: 0.6900  Has0_F1_score: 0.6929  Non0_acc_2: 0.7037  Non0_F1_score: 0.7049  Mult_acc_5: 0.3799  Mult_acc_7: 0.2926  MAE: 1.2148  Corr: 0.4926 
2024-06-12 16:04:35:INFO:TRAIN-(cmcm) (9/31/5)>> loss: 0.7261
2024-06-12 16:04:38:INFO:VAL-(cmcm) >>
2024-06-12 16:04:38:INFO:M: >>  Has0_acc_2: 0.6987  Has0_F1_score: 0.6876  Non0_acc_2: 0.7130  Non0_F1_score: 0.7041  Mult_acc_5: 0.3624  Mult_acc_7: 0.2795  MAE: 1.1737  Corr: 0.4962 
2024-06-12 16:04:52:INFO:TRAIN-(cmcm) (10/32/5)>> loss: 0.7138
2024-06-12 16:04:55:INFO:VAL-(cmcm) >>
2024-06-12 16:04:55:INFO:M: >>  Has0_acc_2: 0.7118  Has0_F1_score: 0.6901  Non0_acc_2: 0.6389  Non0_F1_score: 0.6409  Mult_acc_5: 0.3624  Mult_acc_7: 0.3013  MAE: 1.1407  Corr: 0.4992 
2024-06-12 16:05:02:INFO:TEST-(cmcm) >>
2024-06-12 16:05:02:INFO:M: >>  Has0_acc_2: 0.6895  Has0_F1_score: 0.6862  Non0_acc_2: 0.7226  Non0_F1_score: 0.7242  Mult_acc_5: 0.3192  Mult_acc_7: 0.2901  MAE: 1.2220  Corr: 0.4967 
2024-06-12 16:05:03:INFO:Results are added to results/results/mosi-regression-100.csv...
2024-06-12 20:27:27:INFO:Start running cmcm...
2024-06-12 20:27:27:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 2, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-06-12 20:27:27:INFO:Find gpu: 0, with memory: 378273792 left!
2024-06-12 20:27:27:INFO:Let's use the GPU 0 !
2024-06-12 20:27:27:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 20:27:27:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718195247 HTTP/1.1" 200 235
2024-06-12 20:27:28:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 20:27:28:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 20:27:29:INFO:train samples: (1284,)
2024-06-12 20:27:29:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 20:27:30:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718195250 HTTP/1.1" 200 235
2024-06-12 20:27:30:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 20:27:30:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 20:27:31:INFO:valid samples: (229,)
2024-06-12 20:27:31:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 20:27:32:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718195252 HTTP/1.1" 200 235
2024-06-12 20:27:32:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 20:27:32:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 20:27:33:INFO:test samples: (686,)
2024-06-12 20:27:33:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 20:27:33:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718195254 HTTP/1.1" 200 235
2024-06-12 20:27:34:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 20:27:34:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 20:27:35:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 20:27:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718195255 HTTP/1.1" 200 235
2024-06-12 20:27:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 20:27:36:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 20:27:36:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-12 20:27:36:WARNING:Try importing flash-attention for faster inference...
2024-06-12 20:27:36:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-12 20:27:36:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-12 20:27:36:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-12 20:27:38:INFO:trainable params: 1310280 || all params: 1838138952 || trainable%: 0.07128296794833386
2024-06-12 20:27:38:INFO:Init labels...
2024-06-12 20:27:38:INFO:Start training...
2024-06-12 20:27:53:INFO:TRAIN-(cmcm) (1/1/1)>> loss: 3.7305
2024-06-12 20:27:56:INFO:VAL-(cmcm) >>
2024-06-12 20:27:56:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5463  Non0_F1_score: 0.4515  Mult_acc_5: 0.3057  Mult_acc_7: 0.1092  MAE: 2.5844  Corr: -0.0568 
2024-06-12 20:27:58:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-12 20:28:14:INFO:TRAIN-(cmcm) (1/2/1)>> loss: 1.1744
2024-06-12 20:28:17:INFO:VAL-(cmcm) >>
2024-06-12 20:28:17:INFO:M: >>  Has0_acc_2: 0.5633  Has0_F1_score: 0.5673  Non0_acc_2: 0.5741  Non0_F1_score: 0.5761  Mult_acc_5: 0.2314  Mult_acc_7: 0.2096  MAE: 1.5525  Corr: 0.1095 
2024-06-12 20:28:17:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-12 20:28:33:INFO:TRAIN-(cmcm) (1/3/1)>> loss: 0.9465
2024-06-12 20:28:35:INFO:VAL-(cmcm) >>
2024-06-12 20:28:35:INFO:M: >>  Has0_acc_2: 0.5328  Has0_F1_score: 0.5368  Non0_acc_2: 0.5370  Non0_F1_score: 0.5390  Mult_acc_5: 0.2140  Mult_acc_7: 0.1703  MAE: 1.7219  Corr: 0.0370 
2024-06-12 20:28:50:INFO:TRAIN-(cmcm) (2/4/1)>> loss: 0.9092
2024-06-12 20:28:53:INFO:VAL-(cmcm) >>
2024-06-12 20:28:53:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.4539  Non0_acc_2: 0.5556  Non0_F1_score: 0.4251  Mult_acc_5: 0.1747  Mult_acc_7: 0.1703  MAE: 1.6228  Corr: -0.0254 
2024-06-12 20:29:08:INFO:TRAIN-(cmcm) (3/5/1)>> loss: 0.8941
2024-06-12 20:29:10:INFO:VAL-(cmcm) >>
2024-06-12 20:29:10:INFO:M: >>  Has0_acc_2: 0.5153  Has0_F1_score: 0.4921  Non0_acc_2: 0.5417  Non0_F1_score: 0.4946  Mult_acc_5: 0.1878  Mult_acc_7: 0.1659  MAE: 1.5598  Corr: 0.1825 
2024-06-12 20:29:27:INFO:TRAIN-(cmcm) (4/6/1)>> loss: 0.8844
2024-06-12 20:29:29:INFO:VAL-(cmcm) >>
2024-06-12 20:29:29:INFO:M: >>  Has0_acc_2: 0.5590  Has0_F1_score: 0.5629  Non0_acc_2: 0.5648  Non0_F1_score: 0.5669  Mult_acc_5: 0.2489  Mult_acc_7: 0.2009  MAE: 1.5896  Corr: 0.1347 
2024-06-12 20:29:45:INFO:TRAIN-(cmcm) (5/7/1)>> loss: 0.8760
2024-06-12 20:29:47:INFO:VAL-(cmcm) >>
2024-06-12 20:29:47:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4978  Non0_acc_2: 0.5694  Non0_F1_score: 0.4713  Mult_acc_5: 0.2838  Mult_acc_7: 0.2096  MAE: 1.6490  Corr: -0.0119 
2024-06-12 20:30:03:INFO:TRAIN-(cmcm) (6/8/1)>> loss: 0.8744
2024-06-12 20:30:05:INFO:VAL-(cmcm) >>
2024-06-12 20:30:05:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.5013  Non0_acc_2: 0.5602  Non0_F1_score: 0.4810  Mult_acc_5: 0.2620  Mult_acc_7: 0.2052  MAE: 1.6717  Corr: 0.0042 
2024-06-12 20:30:20:INFO:TRAIN-(cmcm) (7/9/1)>> loss: 0.8709
2024-06-12 20:30:23:INFO:VAL-(cmcm) >>
2024-06-12 20:30:23:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5477  Non0_acc_2: 0.5926  Non0_F1_score: 0.5749  Mult_acc_5: 0.2358  Mult_acc_7: 0.2140  MAE: 1.5079  Corr: 0.0786 
2024-06-12 20:30:24:INFO:Saving checkpoint at epoch 9 to results/models/cmcm-mosi-regression.pth.
2024-06-12 20:30:39:INFO:TRAIN-(cmcm) (1/10/1)>> loss: 0.8644
2024-06-12 20:30:41:INFO:VAL-(cmcm) >>
2024-06-12 20:30:41:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4830  Non0_acc_2: 0.5787  Non0_F1_score: 0.4584  Mult_acc_5: 0.2096  Mult_acc_7: 0.1747  MAE: 1.5743  Corr: 0.0389 
2024-06-12 20:30:56:INFO:TRAIN-(cmcm) (2/11/1)>> loss: 0.8568
2024-06-12 20:30:59:INFO:VAL-(cmcm) >>
2024-06-12 20:30:59:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4830  Non0_acc_2: 0.5741  Non0_F1_score: 0.4558  Mult_acc_5: 0.2751  Mult_acc_7: 0.1965  MAE: 1.7660  Corr: 0.0435 
2024-06-12 20:31:14:INFO:TRAIN-(cmcm) (3/12/1)>> loss: 0.8601
2024-06-12 20:31:16:INFO:VAL-(cmcm) >>
2024-06-12 20:31:16:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.5645  Non0_acc_2: 0.5648  Non0_F1_score: 0.5597  Mult_acc_5: 0.2620  Mult_acc_7: 0.2096  MAE: 1.6520  Corr: 0.1195 
2024-06-12 20:31:32:INFO:TRAIN-(cmcm) (4/13/1)>> loss: 0.8470
2024-06-12 20:31:35:INFO:VAL-(cmcm) >>
2024-06-12 20:31:35:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4700  Non0_acc_2: 0.5741  Non0_F1_score: 0.4420  Mult_acc_5: 0.2183  Mult_acc_7: 0.2052  MAE: 1.4388  Corr: 0.0926 
2024-06-12 20:31:35:INFO:Saving checkpoint at epoch 13 to results/models/cmcm-mosi-regression.pth.
2024-06-12 20:31:51:INFO:TRAIN-(cmcm) (1/14/1)>> loss: 0.8484
2024-06-12 20:31:53:INFO:VAL-(cmcm) >>
2024-06-12 20:31:53:INFO:M: >>  Has0_acc_2: 0.6201  Has0_F1_score: 0.6232  Non0_acc_2: 0.6111  Non0_F1_score: 0.6130  Mult_acc_5: 0.2882  Mult_acc_7: 0.2140  MAE: 1.6306  Corr: 0.1931 
2024-06-12 20:32:09:INFO:TRAIN-(cmcm) (2/15/1)>> loss: 0.8417
2024-06-12 20:32:11:INFO:VAL-(cmcm) >>
2024-06-12 20:32:11:INFO:M: >>  Has0_acc_2: 0.6332  Has0_F1_score: 0.6270  Non0_acc_2: 0.6065  Non0_F1_score: 0.6056  Mult_acc_5: 0.2533  Mult_acc_7: 0.2271  MAE: 1.4226  Corr: 0.1836 
2024-06-12 20:32:12:INFO:Saving checkpoint at epoch 15 to results/models/cmcm-mosi-regression.pth.
2024-06-12 20:32:27:INFO:TRAIN-(cmcm) (1/16/1)>> loss: 0.8441
2024-06-12 20:32:30:INFO:VAL-(cmcm) >>
2024-06-12 20:32:30:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5340  Non0_acc_2: 0.5741  Non0_F1_score: 0.5125  Mult_acc_5: 0.2576  Mult_acc_7: 0.1921  MAE: 1.7372  Corr: 0.0317 
2024-06-12 20:32:45:INFO:TRAIN-(cmcm) (2/17/1)>> loss: 0.8376
2024-06-12 20:32:47:INFO:VAL-(cmcm) >>
2024-06-12 20:32:47:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5466  Non0_acc_2: 0.5417  Non0_F1_score: 0.5430  Mult_acc_5: 0.2358  Mult_acc_7: 0.2052  MAE: 1.5130  Corr: 0.0894 
2024-06-12 20:33:02:INFO:TRAIN-(cmcm) (3/18/1)>> loss: 0.8320
2024-06-12 20:33:05:INFO:VAL-(cmcm) >>
2024-06-12 20:33:05:INFO:M: >>  Has0_acc_2: 0.6376  Has0_F1_score: 0.5807  Non0_acc_2: 0.5926  Non0_F1_score: 0.5855  Mult_acc_5: 0.3100  Mult_acc_7: 0.2576  MAE: 1.4023  Corr: 0.2169 
2024-06-12 20:33:06:INFO:Saving checkpoint at epoch 18 to results/models/cmcm-mosi-regression.pth.
2024-06-12 20:33:21:INFO:TRAIN-(cmcm) (1/19/1)>> loss: 0.8290
2024-06-12 20:33:23:INFO:VAL-(cmcm) >>
2024-06-12 20:33:24:INFO:M: >>  Has0_acc_2: 0.6463  Has0_F1_score: 0.5974  Non0_acc_2: 0.6019  Non0_F1_score: 0.5924  Mult_acc_5: 0.3144  Mult_acc_7: 0.2533  MAE: 1.4451  Corr: 0.1951 
2024-06-12 20:33:38:INFO:TRAIN-(cmcm) (2/20/1)>> loss: 0.8205
2024-06-12 20:33:41:INFO:VAL-(cmcm) >>
2024-06-12 20:33:41:INFO:M: >>  Has0_acc_2: 0.6201  Has0_F1_score: 0.5949  Non0_acc_2: 0.6019  Non0_F1_score: 0.5765  Mult_acc_5: 0.2969  Mult_acc_7: 0.2314  MAE: 1.6237  Corr: 0.1379 
2024-06-12 20:33:56:INFO:TRAIN-(cmcm) (3/21/1)>> loss: 0.8135
2024-06-12 20:33:58:INFO:VAL-(cmcm) >>
2024-06-12 20:33:58:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.6015  Non0_acc_2: 0.6019  Non0_F1_score: 0.5981  Mult_acc_5: 0.3144  Mult_acc_7: 0.2576  MAE: 1.5477  Corr: 0.1977 
2024-06-12 20:34:13:INFO:TRAIN-(cmcm) (4/22/1)>> loss: 0.8107
2024-06-12 20:34:16:INFO:VAL-(cmcm) >>
2024-06-12 20:34:16:INFO:M: >>  Has0_acc_2: 0.6245  Has0_F1_score: 0.6098  Non0_acc_2: 0.6111  Non0_F1_score: 0.5991  Mult_acc_5: 0.2751  Mult_acc_7: 0.2140  MAE: 1.5088  Corr: 0.2034 
2024-06-12 20:34:31:INFO:TRAIN-(cmcm) (5/23/1)>> loss: 0.8032
2024-06-12 20:34:34:INFO:VAL-(cmcm) >>
2024-06-12 20:34:34:INFO:M: >>  Has0_acc_2: 0.6332  Has0_F1_score: 0.6009  Non0_acc_2: 0.6157  Non0_F1_score: 0.5855  Mult_acc_5: 0.3013  Mult_acc_7: 0.2314  MAE: 1.5210  Corr: 0.1887 
2024-06-12 20:34:49:INFO:TRAIN-(cmcm) (6/24/1)>> loss: 0.8004
2024-06-12 20:34:51:INFO:VAL-(cmcm) >>
2024-06-12 20:34:51:INFO:M: >>  Has0_acc_2: 0.6201  Has0_F1_score: 0.5949  Non0_acc_2: 0.6111  Non0_F1_score: 0.5863  Mult_acc_5: 0.3188  Mult_acc_7: 0.2358  MAE: 1.5490  Corr: 0.1859 
2024-06-12 20:35:06:INFO:TRAIN-(cmcm) (7/25/1)>> loss: 0.7912
2024-06-12 20:35:09:INFO:VAL-(cmcm) >>
2024-06-12 20:35:09:INFO:M: >>  Has0_acc_2: 0.6376  Has0_F1_score: 0.6297  Non0_acc_2: 0.6343  Non0_F1_score: 0.6274  Mult_acc_5: 0.2882  Mult_acc_7: 0.2227  MAE: 1.4285  Corr: 0.2638 
2024-06-12 20:35:24:INFO:TRAIN-(cmcm) (8/26/1)>> loss: 0.7850
2024-06-12 20:35:26:INFO:VAL-(cmcm) >>
2024-06-12 20:35:26:INFO:M: >>  Has0_acc_2: 0.6376  Has0_F1_score: 0.6193  Non0_acc_2: 0.6343  Non0_F1_score: 0.6192  Mult_acc_5: 0.2795  Mult_acc_7: 0.2271  MAE: 1.4354  Corr: 0.2449 
2024-06-12 20:35:41:INFO:TRAIN-(cmcm) (9/27/1)>> loss: 0.7806
2024-06-12 20:35:44:INFO:VAL-(cmcm) >>
2024-06-12 20:35:44:INFO:M: >>  Has0_acc_2: 0.6157  Has0_F1_score: 0.6104  Non0_acc_2: 0.6111  Non0_F1_score: 0.6065  Mult_acc_5: 0.2795  Mult_acc_7: 0.2183  MAE: 1.4660  Corr: 0.2431 
2024-06-12 20:35:59:INFO:TRAIN-(cmcm) (10/28/1)>> loss: 0.7747
2024-06-12 20:36:01:INFO:VAL-(cmcm) >>
2024-06-12 20:36:01:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5895  Non0_acc_2: 0.6019  Non0_F1_score: 0.6013  Mult_acc_5: 0.2795  Mult_acc_7: 0.2227  MAE: 1.4848  Corr: 0.2267 
2024-06-12 20:36:08:INFO:TEST-(cmcm) >>
2024-06-12 20:36:08:INFO:M: >>  Has0_acc_2: 0.5087  Has0_F1_score: 0.4485  Non0_acc_2: 0.5091  Non0_F1_score: 0.5070  Mult_acc_5: 0.2187  Mult_acc_7: 0.2055  MAE: 1.6629  Corr: 0.0751 
2024-06-12 20:36:09:INFO:Results are added to results/results/mosi-regression-30.csv...
2024-06-12 20:36:09:INFO:Start running cmcm...
2024-06-12 20:36:09:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [0], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 2, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 2222}>
2024-06-12 20:36:09:INFO:Let's use the GPU 0 !
2024-06-12 20:36:09:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 20:36:09:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718195770 HTTP/1.1" 200 235
2024-06-12 20:36:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 20:36:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 20:36:11:INFO:train samples: (1284,)
2024-06-12 20:36:11:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 20:36:11:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718195771 HTTP/1.1" 200 235
2024-06-12 20:36:11:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 20:36:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 20:36:12:INFO:valid samples: (229,)
2024-06-12 20:36:12:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 20:36:13:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718195773 HTTP/1.1" 200 235
2024-06-12 20:36:13:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 20:36:13:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 20:36:14:INFO:test samples: (686,)
2024-06-12 20:36:14:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 20:36:14:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718195774 HTTP/1.1" 200 235
2024-06-12 20:36:14:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 20:36:15:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 20:36:15:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 20:36:15:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718195776 HTTP/1.1" 200 235
2024-06-12 20:36:16:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 20:36:16:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 20:36:16:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-12 20:36:16:WARNING:Try importing flash-attention for faster inference...
2024-06-12 20:36:16:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-12 20:36:16:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-12 20:36:16:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-12 20:36:17:INFO:trainable params: 1310280 || all params: 1838138952 || trainable%: 0.07128296794833386
2024-06-12 20:36:17:INFO:Init labels...
2024-06-12 20:36:17:INFO:Start training...
2024-06-12 20:36:33:INFO:TRAIN-(cmcm) (1/1/2)>> loss: 3.8054
2024-06-12 20:36:36:INFO:VAL-(cmcm) >>
2024-06-12 20:36:36:INFO:M: >>  Has0_acc_2: 0.5633  Has0_F1_score: 0.4969  Non0_acc_2: 0.5185  Non0_F1_score: 0.5054  Mult_acc_5: 0.2882  Mult_acc_7: 0.1266  MAE: 2.4193  Corr: -0.0235 
2024-06-12 20:36:37:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-12 20:36:52:INFO:TRAIN-(cmcm) (1/2/2)>> loss: 1.2187
2024-06-12 20:36:55:INFO:VAL-(cmcm) >>
2024-06-12 20:36:55:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5081  Non0_acc_2: 0.5833  Non0_F1_score: 0.5013  Mult_acc_5: 0.2140  Mult_acc_7: 0.1834  MAE: 1.5162  Corr: 0.0314 
2024-06-12 20:36:56:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-12 20:37:11:INFO:TRAIN-(cmcm) (1/3/2)>> loss: 0.9511
2024-06-12 20:37:13:INFO:VAL-(cmcm) >>
2024-06-12 20:37:13:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.5187  Non0_acc_2: 0.5926  Non0_F1_score: 0.5075  Mult_acc_5: 0.2140  Mult_acc_7: 0.1965  MAE: 1.5250  Corr: 0.0469 
2024-06-12 20:37:28:INFO:TRAIN-(cmcm) (2/4/2)>> loss: 0.9054
2024-06-12 20:37:30:INFO:VAL-(cmcm) >>
2024-06-12 20:37:30:INFO:M: >>  Has0_acc_2: 0.5415  Has0_F1_score: 0.5452  Non0_acc_2: 0.5324  Non0_F1_score: 0.5345  Mult_acc_5: 0.1572  Mult_acc_7: 0.1441  MAE: 1.7516  Corr: 0.0246 
2024-06-12 20:37:45:INFO:TRAIN-(cmcm) (3/5/2)>> loss: 0.9051
2024-06-12 20:37:48:INFO:VAL-(cmcm) >>
2024-06-12 20:37:48:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.4843  Non0_acc_2: 0.5602  Non0_F1_score: 0.4599  Mult_acc_5: 0.2489  Mult_acc_7: 0.2052  MAE: 1.6603  Corr: 0.0324 
2024-06-12 20:38:02:INFO:TRAIN-(cmcm) (4/6/2)>> loss: 0.8876
2024-06-12 20:38:05:INFO:VAL-(cmcm) >>
2024-06-12 20:38:05:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.5713  Non0_acc_2: 0.5787  Non0_F1_score: 0.5806  Mult_acc_5: 0.2707  Mult_acc_7: 0.2183  MAE: 1.6114  Corr: 0.1081 
2024-06-12 20:38:20:INFO:TRAIN-(cmcm) (5/7/2)>> loss: 0.8799
2024-06-12 20:38:22:INFO:VAL-(cmcm) >>
2024-06-12 20:38:22:INFO:M: >>  Has0_acc_2: 0.5459  Has0_F1_score: 0.5476  Non0_acc_2: 0.5093  Non0_F1_score: 0.4949  Mult_acc_5: 0.1834  Mult_acc_7: 0.1616  MAE: 1.6455  Corr: 0.0670 
2024-06-12 20:38:37:INFO:TRAIN-(cmcm) (6/8/2)>> loss: 0.8761
2024-06-12 20:38:39:INFO:VAL-(cmcm) >>
2024-06-12 20:38:39:INFO:M: >>  Has0_acc_2: 0.5546  Has0_F1_score: 0.4910  Non0_acc_2: 0.5231  Non0_F1_score: 0.4759  Mult_acc_5: 0.2009  Mult_acc_7: 0.1834  MAE: 1.6250  Corr: -0.0213 
2024-06-12 20:38:54:INFO:TRAIN-(cmcm) (7/9/2)>> loss: 0.8635
2024-06-12 20:38:57:INFO:VAL-(cmcm) >>
2024-06-12 20:38:57:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5734  Non0_acc_2: 0.5972  Non0_F1_score: 0.5748  Mult_acc_5: 0.2795  Mult_acc_7: 0.2227  MAE: 1.6001  Corr: 0.1094 
2024-06-12 20:39:11:INFO:TRAIN-(cmcm) (8/10/2)>> loss: 0.8653
2024-06-12 20:39:14:INFO:VAL-(cmcm) >>
2024-06-12 20:39:14:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.5690  Non0_acc_2: 0.5926  Non0_F1_score: 0.5931  Mult_acc_5: 0.2489  Mult_acc_7: 0.2009  MAE: 1.7023  Corr: 0.1609 
2024-06-12 20:39:29:INFO:TRAIN-(cmcm) (9/11/2)>> loss: 0.8619
2024-06-12 20:39:31:INFO:VAL-(cmcm) >>
2024-06-12 20:39:31:INFO:M: >>  Has0_acc_2: 0.6201  Has0_F1_score: 0.6236  Non0_acc_2: 0.6157  Non0_F1_score: 0.6178  Mult_acc_5: 0.2664  Mult_acc_7: 0.2227  MAE: 1.6245  Corr: 0.1535 
2024-06-12 20:39:46:INFO:TRAIN-(cmcm) (10/12/2)>> loss: 0.8563
2024-06-12 20:39:48:INFO:VAL-(cmcm) >>
2024-06-12 20:39:48:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.5292  Non0_acc_2: 0.5509  Non0_F1_score: 0.5362  Mult_acc_5: 0.2751  Mult_acc_7: 0.2358  MAE: 1.5398  Corr: 0.0812 
2024-06-12 20:39:56:INFO:TEST-(cmcm) >>
2024-06-12 20:39:56:INFO:M: >>  Has0_acc_2: 0.4650  Has0_F1_score: 0.3829  Non0_acc_2: 0.4527  Non0_F1_score: 0.3779  Mult_acc_5: 0.1866  Mult_acc_7: 0.1822  MAE: 1.6809  Corr: 0.0640 
2024-06-12 20:39:56:INFO:Results are added to results/results/mosi-regression-30.csv...
2024-06-12 20:39:56:INFO:Start running cmcm...
2024-06-12 20:39:56:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [0], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 2, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 3333}>
2024-06-12 20:39:56:INFO:Let's use the GPU 0 !
2024-06-12 20:39:56:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 20:39:57:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718195997 HTTP/1.1" 200 235
2024-06-12 20:39:57:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 20:39:57:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 20:39:58:INFO:train samples: (1284,)
2024-06-12 20:39:58:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 20:39:58:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718195999 HTTP/1.1" 200 235
2024-06-12 20:39:59:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 20:39:59:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 20:40:00:INFO:valid samples: (229,)
2024-06-12 20:40:00:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 20:40:00:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718196000 HTTP/1.1" 200 235
2024-06-12 20:40:00:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 20:40:01:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 20:40:01:INFO:test samples: (686,)
2024-06-12 20:40:01:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 20:40:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718196002 HTTP/1.1" 200 235
2024-06-12 20:40:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 20:40:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 20:40:03:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 20:40:03:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718196003 HTTP/1.1" 200 235
2024-06-12 20:40:03:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 20:40:04:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 20:40:04:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-12 20:40:04:WARNING:Try importing flash-attention for faster inference...
2024-06-12 20:40:04:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-12 20:40:04:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-12 20:40:04:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-12 20:40:05:INFO:trainable params: 1310280 || all params: 1838138952 || trainable%: 0.07128296794833386
2024-06-12 20:40:05:INFO:Init labels...
2024-06-12 20:40:05:INFO:Start training...
2024-06-12 20:40:20:INFO:TRAIN-(cmcm) (1/1/3)>> loss: 3.8003
2024-06-12 20:40:22:INFO:VAL-(cmcm) >>
2024-06-12 20:40:22:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4556  Non0_acc_2: 0.5648  Non0_F1_score: 0.4978  Mult_acc_5: 0.3057  Mult_acc_7: 0.1179  MAE: 2.5049  Corr: -0.0254 
2024-06-12 20:40:23:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-12 20:40:38:INFO:TRAIN-(cmcm) (1/2/3)>> loss: 1.2183
2024-06-12 20:40:41:INFO:VAL-(cmcm) >>
2024-06-12 20:40:41:INFO:M: >>  Has0_acc_2: 0.5590  Has0_F1_score: 0.5090  Non0_acc_2: 0.5509  Non0_F1_score: 0.4960  Mult_acc_5: 0.2620  Mult_acc_7: 0.2096  MAE: 1.6533  Corr: 0.0180 
2024-06-12 20:40:42:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-12 20:40:57:INFO:TRAIN-(cmcm) (1/3/3)>> loss: 0.9360
2024-06-12 20:40:59:INFO:VAL-(cmcm) >>
2024-06-12 20:40:59:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4630  Non0_acc_2: 0.5741  Non0_F1_score: 0.4346  Mult_acc_5: 0.2489  Mult_acc_7: 0.1834  MAE: 1.6918  Corr: -0.0135 
2024-06-12 20:41:14:INFO:TRAIN-(cmcm) (2/4/3)>> loss: 0.9027
2024-06-12 20:41:17:INFO:VAL-(cmcm) >>
2024-06-12 20:41:17:INFO:M: >>  Has0_acc_2: 0.5240  Has0_F1_score: 0.5181  Non0_acc_2: 0.5185  Non0_F1_score: 0.5102  Mult_acc_5: 0.2096  Mult_acc_7: 0.1572  MAE: 1.7643  Corr: -0.0070 
2024-06-12 20:41:31:INFO:TRAIN-(cmcm) (3/5/3)>> loss: 0.8856
2024-06-12 20:41:34:INFO:VAL-(cmcm) >>
2024-06-12 20:41:34:INFO:M: >>  Has0_acc_2: 0.4891  Has0_F1_score: 0.4746  Non0_acc_2: 0.5046  Non0_F1_score: 0.4893  Mult_acc_5: 0.2096  Mult_acc_7: 0.1703  MAE: 1.7223  Corr: 0.0761 
2024-06-12 20:41:49:INFO:TRAIN-(cmcm) (4/6/3)>> loss: 0.8789
2024-06-12 20:41:51:INFO:VAL-(cmcm) >>
2024-06-12 20:41:51:INFO:M: >>  Has0_acc_2: 0.5109  Has0_F1_score: 0.5086  Non0_acc_2: 0.5231  Non0_F1_score: 0.5194  Mult_acc_5: 0.1878  Mult_acc_7: 0.1572  MAE: 1.8477  Corr: 0.0648 
2024-06-12 20:42:06:INFO:TRAIN-(cmcm) (5/7/3)>> loss: 0.8738
2024-06-12 20:42:08:INFO:VAL-(cmcm) >>
2024-06-12 20:42:08:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5888  Non0_acc_2: 0.5926  Non0_F1_score: 0.5855  Mult_acc_5: 0.2838  Mult_acc_7: 0.1965  MAE: 1.6306  Corr: 0.1386 
2024-06-12 20:42:09:INFO:Saving checkpoint at epoch 7 to results/models/cmcm-mosi-regression.pth.
2024-06-12 20:42:24:INFO:TRAIN-(cmcm) (1/8/3)>> loss: 0.8679
2024-06-12 20:42:27:INFO:VAL-(cmcm) >>
2024-06-12 20:42:27:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5449  Non0_acc_2: 0.5556  Non0_F1_score: 0.5272  Mult_acc_5: 0.2489  Mult_acc_7: 0.1790  MAE: 1.6337  Corr: 0.0640 
2024-06-12 20:42:42:INFO:TRAIN-(cmcm) (2/9/3)>> loss: 0.8680
2024-06-12 20:42:44:INFO:VAL-(cmcm) >>
2024-06-12 20:42:44:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.5032  Non0_acc_2: 0.5370  Non0_F1_score: 0.5049  Mult_acc_5: 0.2751  Mult_acc_7: 0.2052  MAE: 1.6171  Corr: 0.0309 
2024-06-12 20:42:45:INFO:Saving checkpoint at epoch 9 to results/models/cmcm-mosi-regression.pth.
2024-06-12 20:43:00:INFO:TRAIN-(cmcm) (1/10/3)>> loss: 0.8613
2024-06-12 20:43:03:INFO:VAL-(cmcm) >>
2024-06-12 20:43:03:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4791  Non0_acc_2: 0.5787  Non0_F1_score: 0.4516  Mult_acc_5: 0.3057  Mult_acc_7: 0.2358  MAE: 1.6333  Corr: 0.0769 
2024-06-12 20:43:17:INFO:TRAIN-(cmcm) (2/11/3)>> loss: 0.8557
2024-06-12 20:43:20:INFO:VAL-(cmcm) >>
2024-06-12 20:43:20:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.5383  Non0_acc_2: 0.5972  Non0_F1_score: 0.5202  Mult_acc_5: 0.2664  Mult_acc_7: 0.2140  MAE: 1.5437  Corr: 0.0785 
2024-06-12 20:43:21:INFO:Saving checkpoint at epoch 11 to results/models/cmcm-mosi-regression.pth.
2024-06-12 20:43:36:INFO:TRAIN-(cmcm) (1/12/3)>> loss: 0.8520
2024-06-12 20:43:38:INFO:VAL-(cmcm) >>
2024-06-12 20:43:38:INFO:M: >>  Has0_acc_2: 0.6245  Has0_F1_score: 0.5962  Non0_acc_2: 0.5972  Non0_F1_score: 0.5727  Mult_acc_5: 0.2620  Mult_acc_7: 0.2096  MAE: 1.5241  Corr: 0.1112 
2024-06-12 20:43:39:INFO:Saving checkpoint at epoch 12 to results/models/cmcm-mosi-regression.pth.
2024-06-12 20:43:54:INFO:TRAIN-(cmcm) (1/13/3)>> loss: 0.8498
2024-06-12 20:43:57:INFO:VAL-(cmcm) >>
2024-06-12 20:43:57:INFO:M: >>  Has0_acc_2: 0.5546  Has0_F1_score: 0.5211  Non0_acc_2: 0.5602  Non0_F1_score: 0.5566  Mult_acc_5: 0.2314  Mult_acc_7: 0.2052  MAE: 1.5695  Corr: 0.0374 
2024-06-12 20:44:11:INFO:TRAIN-(cmcm) (2/14/3)>> loss: 0.8472
2024-06-12 20:44:14:INFO:VAL-(cmcm) >>
2024-06-12 20:44:14:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5053  Non0_acc_2: 0.5648  Non0_F1_score: 0.5019  Mult_acc_5: 0.2664  Mult_acc_7: 0.2096  MAE: 1.6075  Corr: 0.0161 
2024-06-12 20:44:29:INFO:TRAIN-(cmcm) (3/15/3)>> loss: 0.8407
2024-06-12 20:44:31:INFO:VAL-(cmcm) >>
2024-06-12 20:44:31:INFO:M: >>  Has0_acc_2: 0.6157  Has0_F1_score: 0.6170  Non0_acc_2: 0.6204  Non0_F1_score: 0.6198  Mult_acc_5: 0.2271  Mult_acc_7: 0.1790  MAE: 1.4682  Corr: 0.2251 
2024-06-12 20:44:32:INFO:Saving checkpoint at epoch 15 to results/models/cmcm-mosi-regression.pth.
2024-06-12 20:44:47:INFO:TRAIN-(cmcm) (1/16/3)>> loss: 0.8389
2024-06-12 20:44:50:INFO:VAL-(cmcm) >>
2024-06-12 20:44:50:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.5880  Non0_acc_2: 0.5972  Non0_F1_score: 0.5806  Mult_acc_5: 0.2489  Mult_acc_7: 0.2140  MAE: 1.5625  Corr: 0.1238 
2024-06-12 20:45:04:INFO:TRAIN-(cmcm) (2/17/3)>> loss: 0.8340
2024-06-12 20:45:07:INFO:VAL-(cmcm) >>
2024-06-12 20:45:07:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5753  Non0_acc_2: 0.5926  Non0_F1_score: 0.5710  Mult_acc_5: 0.2664  Mult_acc_7: 0.2096  MAE: 1.6346  Corr: 0.1278 
2024-06-12 20:45:22:INFO:TRAIN-(cmcm) (3/18/3)>> loss: 0.8232
2024-06-12 20:45:24:INFO:VAL-(cmcm) >>
2024-06-12 20:45:24:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.5458  Non0_acc_2: 0.5648  Non0_F1_score: 0.5320  Mult_acc_5: 0.2838  Mult_acc_7: 0.2052  MAE: 1.7590  Corr: 0.0654 
2024-06-12 20:45:39:INFO:TRAIN-(cmcm) (4/19/3)>> loss: 0.8152
2024-06-12 20:45:42:INFO:VAL-(cmcm) >>
2024-06-12 20:45:42:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.5352  Non0_acc_2: 0.5880  Non0_F1_score: 0.5138  Mult_acc_5: 0.2533  Mult_acc_7: 0.1965  MAE: 1.6237  Corr: 0.1022 
2024-06-12 20:45:56:INFO:TRAIN-(cmcm) (5/20/3)>> loss: 0.8108
2024-06-12 20:45:59:INFO:VAL-(cmcm) >>
2024-06-12 20:45:59:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.6047  Non0_acc_2: 0.6065  Non0_F1_score: 0.6072  Mult_acc_5: 0.2620  Mult_acc_7: 0.1965  MAE: 1.5494  Corr: 0.1923 
2024-06-12 20:46:14:INFO:TRAIN-(cmcm) (6/21/3)>> loss: 0.8092
2024-06-12 20:46:16:INFO:VAL-(cmcm) >>
2024-06-12 20:46:16:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.5862  Non0_acc_2: 0.6065  Non0_F1_score: 0.5825  Mult_acc_5: 0.2882  Mult_acc_7: 0.2183  MAE: 1.5883  Corr: 0.1761 
2024-06-12 20:46:31:INFO:TRAIN-(cmcm) (7/22/3)>> loss: 0.8047
2024-06-12 20:46:34:INFO:VAL-(cmcm) >>
2024-06-12 20:46:34:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.6042  Non0_acc_2: 0.5741  Non0_F1_score: 0.5763  Mult_acc_5: 0.2402  Mult_acc_7: 0.1965  MAE: 1.5643  Corr: 0.1275 
2024-06-12 20:46:48:INFO:TRAIN-(cmcm) (8/23/3)>> loss: 0.7948
2024-06-12 20:46:51:INFO:VAL-(cmcm) >>
2024-06-12 20:46:51:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.6036  Non0_acc_2: 0.5880  Non0_F1_score: 0.5870  Mult_acc_5: 0.2576  Mult_acc_7: 0.2009  MAE: 1.5817  Corr: 0.1334 
2024-06-12 20:47:06:INFO:TRAIN-(cmcm) (9/24/3)>> loss: 0.7934
2024-06-12 20:47:08:INFO:VAL-(cmcm) >>
2024-06-12 20:47:08:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.6093  Non0_acc_2: 0.5787  Non0_F1_score: 0.5808  Mult_acc_5: 0.2664  Mult_acc_7: 0.1965  MAE: 1.5817  Corr: 0.1421 
2024-06-12 20:47:23:INFO:TRAIN-(cmcm) (10/25/3)>> loss: 0.7839
2024-06-12 20:47:25:INFO:VAL-(cmcm) >>
2024-06-12 20:47:25:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5772  Non0_acc_2: 0.5694  Non0_F1_score: 0.5600  Mult_acc_5: 0.2620  Mult_acc_7: 0.2096  MAE: 1.6136  Corr: 0.0785 
2024-06-12 20:47:33:INFO:TEST-(cmcm) >>
2024-06-12 20:47:33:INFO:M: >>  Has0_acc_2: 0.5977  Has0_F1_score: 0.5987  Non0_acc_2: 0.6052  Non0_F1_score: 0.6075  Mult_acc_5: 0.2507  Mult_acc_7: 0.2332  MAE: 1.4740  Corr: 0.2013 
2024-06-12 20:47:33:INFO:Results are added to results/results/mosi-regression-30.csv...
2024-06-12 20:47:33:INFO:Start running cmcm...
2024-06-12 20:47:33:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [0], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 2, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 4444}>
2024-06-12 20:47:33:INFO:Let's use the GPU 0 !
2024-06-12 20:47:33:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 20:47:34:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718196454 HTTP/1.1" 200 235
2024-06-12 20:47:34:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 20:47:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 20:47:35:INFO:train samples: (1284,)
2024-06-12 20:47:35:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 20:47:36:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718196456 HTTP/1.1" 200 235
2024-06-12 20:47:36:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 20:47:36:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 20:47:37:INFO:valid samples: (229,)
2024-06-12 20:47:37:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 20:47:37:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718196457 HTTP/1.1" 200 235
2024-06-12 20:47:38:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 20:47:38:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 20:47:38:INFO:test samples: (686,)
2024-06-12 20:47:38:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 20:47:39:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718196459 HTTP/1.1" 200 235
2024-06-12 20:47:39:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 20:47:40:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 20:47:40:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 20:47:40:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718196460 HTTP/1.1" 200 235
2024-06-12 20:47:40:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 20:47:41:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 20:47:41:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-12 20:47:41:WARNING:Try importing flash-attention for faster inference...
2024-06-12 20:47:41:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-12 20:47:41:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-12 20:47:41:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-12 20:47:42:INFO:trainable params: 1310280 || all params: 1838138952 || trainable%: 0.07128296794833386
2024-06-12 20:47:42:INFO:Init labels...
2024-06-12 20:47:42:INFO:Start training...
2024-06-12 20:47:57:INFO:TRAIN-(cmcm) (1/1/4)>> loss: 4.3409
2024-06-12 20:47:59:INFO:VAL-(cmcm) >>
2024-06-12 20:47:59:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4259  Non0_F1_score: 0.2544  Mult_acc_5: 0.2140  Mult_acc_7: 0.2140  MAE: 1.4370  Corr: nan 
2024-06-12 20:48:00:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-12 20:48:15:INFO:TRAIN-(cmcm) (1/2/4)>> loss: 2.7615
2024-06-12 20:48:18:INFO:VAL-(cmcm) >>
2024-06-12 20:48:18:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4891  Non0_acc_2: 0.5787  Non0_F1_score: 0.4711  Mult_acc_5: 0.1703  Mult_acc_7: 0.1703  MAE: 1.5811  Corr: -0.0673 
2024-06-12 20:48:33:INFO:TRAIN-(cmcm) (2/3/4)>> loss: 1.0126
2024-06-12 20:48:35:INFO:VAL-(cmcm) >>
2024-06-12 20:48:35:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4577  Non0_acc_2: 0.5741  Non0_F1_score: 0.4346  Mult_acc_5: 0.2358  Mult_acc_7: 0.1616  MAE: 1.6014  Corr: 0.0130 
2024-06-12 20:48:50:INFO:TRAIN-(cmcm) (3/4/4)>> loss: 0.9267
2024-06-12 20:48:52:INFO:VAL-(cmcm) >>
2024-06-12 20:48:52:INFO:M: >>  Has0_acc_2: 0.5459  Has0_F1_score: 0.5476  Non0_acc_2: 0.5602  Non0_F1_score: 0.5592  Mult_acc_5: 0.2838  Mult_acc_7: 0.2140  MAE: 1.6258  Corr: 0.1561 
2024-06-12 20:49:07:INFO:TRAIN-(cmcm) (4/5/4)>> loss: 0.9006
2024-06-12 20:49:10:INFO:VAL-(cmcm) >>
2024-06-12 20:49:10:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.5571  Non0_acc_2: 0.5741  Non0_F1_score: 0.5515  Mult_acc_5: 0.2533  Mult_acc_7: 0.1790  MAE: 1.7966  Corr: 0.0407 
2024-06-12 20:49:24:INFO:TRAIN-(cmcm) (5/6/4)>> loss: 0.8927
2024-06-12 20:49:27:INFO:VAL-(cmcm) >>
2024-06-12 20:49:27:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.5158  Non0_acc_2: 0.5694  Non0_F1_score: 0.4871  Mult_acc_5: 0.1965  Mult_acc_7: 0.1878  MAE: 1.5641  Corr: -0.0044 
2024-06-12 20:49:42:INFO:TRAIN-(cmcm) (6/7/4)>> loss: 0.8838
2024-06-12 20:49:44:INFO:VAL-(cmcm) >>
2024-06-12 20:49:44:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.5673  Non0_acc_2: 0.6157  Non0_F1_score: 0.5777  Mult_acc_5: 0.2707  Mult_acc_7: 0.2052  MAE: 1.5368  Corr: 0.1329 
2024-06-12 20:49:59:INFO:TRAIN-(cmcm) (7/8/4)>> loss: 0.8791
2024-06-12 20:50:02:INFO:VAL-(cmcm) >>
2024-06-12 20:50:02:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.4425  Non0_acc_2: 0.5463  Non0_F1_score: 0.4131  Mult_acc_5: 0.2096  Mult_acc_7: 0.2096  MAE: 1.6123  Corr: -0.0519 
2024-06-12 20:50:17:INFO:TRAIN-(cmcm) (8/9/4)>> loss: 0.8681
2024-06-12 20:50:19:INFO:VAL-(cmcm) >>
2024-06-12 20:50:19:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.5602  Non0_acc_2: 0.5926  Non0_F1_score: 0.5566  Mult_acc_5: 0.2533  Mult_acc_7: 0.2227  MAE: 1.4659  Corr: 0.1284 
2024-06-12 20:50:34:INFO:TRAIN-(cmcm) (9/10/4)>> loss: 0.8642
2024-06-12 20:50:37:INFO:VAL-(cmcm) >>
2024-06-12 20:50:37:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.5711  Non0_acc_2: 0.5694  Non0_F1_score: 0.5626  Mult_acc_5: 0.2358  Mult_acc_7: 0.1747  MAE: 1.6097  Corr: 0.1006 
2024-06-12 20:50:51:INFO:TRAIN-(cmcm) (10/11/4)>> loss: 0.8545
2024-06-12 20:50:54:INFO:VAL-(cmcm) >>
2024-06-12 20:50:54:INFO:M: >>  Has0_acc_2: 0.6157  Has0_F1_score: 0.5934  Non0_acc_2: 0.6111  Non0_F1_score: 0.5885  Mult_acc_5: 0.2838  Mult_acc_7: 0.2227  MAE: 1.6197  Corr: 0.1144 
2024-06-12 20:51:01:INFO:TEST-(cmcm) >>
2024-06-12 20:51:01:INFO:M: >>  Has0_acc_2: 0.4475  Has0_F1_score: 0.2767  Non0_acc_2: 0.5777  Non0_F1_score: 0.4231  Mult_acc_5: 0.1545  Mult_acc_7: 0.1545  MAE: 1.4174  Corr: nan 
2024-06-12 20:51:02:INFO:Results are added to results/results/mosi-regression-30.csv...
2024-06-12 20:51:02:INFO:Start running cmcm...
2024-06-12 20:51:02:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [0], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 2, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 5555}>
2024-06-12 20:51:02:INFO:Let's use the GPU 0 !
2024-06-12 20:51:02:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 20:51:04:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718196662 HTTP/1.1" 200 235
2024-06-12 20:51:05:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 20:51:06:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 20:51:07:INFO:train samples: (1284,)
2024-06-12 20:51:07:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 20:51:07:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718196668 HTTP/1.1" 200 235
2024-06-12 20:51:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 20:51:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 20:51:09:INFO:valid samples: (229,)
2024-06-12 20:51:09:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 20:51:09:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718196669 HTTP/1.1" 200 235
2024-06-12 20:51:09:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 20:51:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 20:51:10:INFO:test samples: (686,)
2024-06-12 20:51:10:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 20:51:11:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718196671 HTTP/1.1" 200 235
2024-06-12 20:51:11:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 20:51:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 20:51:12:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 20:51:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718196673 HTTP/1.1" 200 235
2024-06-12 20:51:13:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 20:51:13:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 20:51:13:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-12 20:51:13:WARNING:Try importing flash-attention for faster inference...
2024-06-12 20:51:13:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-12 20:51:13:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-12 20:51:13:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-12 20:51:14:INFO:trainable params: 1310280 || all params: 1838138952 || trainable%: 0.07128296794833386
2024-06-12 20:51:14:INFO:Init labels...
2024-06-12 20:51:14:INFO:Start training...
2024-06-12 20:51:29:INFO:TRAIN-(cmcm) (1/1/5)>> loss: 2.9262
2024-06-12 20:51:32:INFO:VAL-(cmcm) >>
2024-06-12 20:51:32:INFO:M: >>  Has0_acc_2: 0.5546  Has0_F1_score: 0.5372  Non0_acc_2: 0.5509  Non0_F1_score: 0.5344  Mult_acc_5: 0.2052  Mult_acc_7: 0.1878  MAE: 1.6174  Corr: 0.0012 
2024-06-12 20:51:32:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-12 20:51:48:INFO:TRAIN-(cmcm) (1/2/5)>> loss: 1.0393
2024-06-12 20:51:50:INFO:VAL-(cmcm) >>
2024-06-12 20:51:50:INFO:M: >>  Has0_acc_2: 0.4323  Has0_F1_score: 0.3337  Non0_acc_2: 0.4537  Non0_F1_score: 0.3551  Mult_acc_5: 0.1397  Mult_acc_7: 0.1310  MAE: 1.8506  Corr: 0.0137 
2024-06-12 20:52:05:INFO:TRAIN-(cmcm) (2/3/5)>> loss: 0.9292
2024-06-12 20:52:07:INFO:VAL-(cmcm) >>
2024-06-12 20:52:07:INFO:M: >>  Has0_acc_2: 0.5502  Has0_F1_score: 0.5317  Non0_acc_2: 0.5463  Non0_F1_score: 0.5245  Mult_acc_5: 0.2620  Mult_acc_7: 0.2009  MAE: 1.7739  Corr: -0.0218 
2024-06-12 20:52:22:INFO:TRAIN-(cmcm) (3/4/5)>> loss: 0.8899
2024-06-12 20:52:25:INFO:VAL-(cmcm) >>
2024-06-12 20:52:25:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.4943  Non0_acc_2: 0.5880  Non0_F1_score: 0.4767  Mult_acc_5: 0.2838  Mult_acc_7: 0.2052  MAE: 1.6031  Corr: 0.0611 
2024-06-12 20:52:25:INFO:Saving checkpoint at epoch 4 to results/models/cmcm-mosi-regression.pth.
2024-06-12 20:52:41:INFO:TRAIN-(cmcm) (1/5/5)>> loss: 0.8827
2024-06-12 20:52:43:INFO:VAL-(cmcm) >>
2024-06-12 20:52:43:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.4730  Non0_acc_2: 0.5602  Non0_F1_score: 0.4479  Mult_acc_5: 0.1790  Mult_acc_7: 0.1747  MAE: 1.5637  Corr: -0.0172 
2024-06-12 20:52:44:INFO:Saving checkpoint at epoch 5 to results/models/cmcm-mosi-regression.pth.
2024-06-12 20:52:59:INFO:TRAIN-(cmcm) (1/6/5)>> loss: 0.8874
2024-06-12 20:53:02:INFO:VAL-(cmcm) >>
2024-06-12 20:53:02:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5170  Non0_acc_2: 0.5463  Non0_F1_score: 0.5148  Mult_acc_5: 0.2533  Mult_acc_7: 0.1878  MAE: 1.6130  Corr: 0.0404 
2024-06-12 20:53:16:INFO:TRAIN-(cmcm) (2/7/5)>> loss: 0.8716
2024-06-12 20:53:19:INFO:VAL-(cmcm) >>
2024-06-12 20:53:19:INFO:M: >>  Has0_acc_2: 0.5371  Has0_F1_score: 0.5349  Non0_acc_2: 0.5463  Non0_F1_score: 0.5422  Mult_acc_5: 0.3013  Mult_acc_7: 0.2402  MAE: 1.7012  Corr: 0.1430 
2024-06-12 20:53:34:INFO:TRAIN-(cmcm) (3/8/5)>> loss: 0.8700
2024-06-12 20:53:36:INFO:VAL-(cmcm) >>
2024-06-12 20:53:36:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.4996  Non0_acc_2: 0.5370  Non0_F1_score: 0.4961  Mult_acc_5: 0.1790  Mult_acc_7: 0.1790  MAE: 1.5126  Corr: -0.0161 
2024-06-12 20:53:37:INFO:Saving checkpoint at epoch 8 to results/models/cmcm-mosi-regression.pth.
2024-06-12 20:53:52:INFO:TRAIN-(cmcm) (1/9/5)>> loss: 0.8672
2024-06-12 20:53:55:INFO:VAL-(cmcm) >>
2024-06-12 20:53:55:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5741  Non0_F1_score: 0.4187  Mult_acc_5: 0.2969  Mult_acc_7: 0.2140  MAE: 1.7328  Corr: -0.0060 
2024-06-12 20:54:10:INFO:TRAIN-(cmcm) (2/10/5)>> loss: 0.8648
2024-06-12 20:54:12:INFO:VAL-(cmcm) >>
2024-06-12 20:54:12:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4917  Non0_acc_2: 0.5833  Non0_F1_score: 0.4676  Mult_acc_5: 0.2489  Mult_acc_7: 0.1747  MAE: 1.6726  Corr: 0.0040 
2024-06-12 20:54:27:INFO:TRAIN-(cmcm) (3/11/5)>> loss: 0.8578
2024-06-12 20:54:29:INFO:VAL-(cmcm) >>
2024-06-12 20:54:29:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.4924  Non0_acc_2: 0.5648  Non0_F1_score: 0.4888  Mult_acc_5: 0.2751  Mult_acc_7: 0.2096  MAE: 1.5809  Corr: -0.0044 
2024-06-12 20:54:44:INFO:TRAIN-(cmcm) (4/12/5)>> loss: 0.8528
2024-06-12 20:54:47:INFO:VAL-(cmcm) >>
2024-06-12 20:54:47:INFO:M: >>  Has0_acc_2: 0.5546  Has0_F1_score: 0.5124  Non0_acc_2: 0.5231  Non0_F1_score: 0.4914  Mult_acc_5: 0.2009  Mult_acc_7: 0.1878  MAE: 1.5095  Corr: -0.0051 
2024-06-12 20:54:47:INFO:Saving checkpoint at epoch 12 to results/models/cmcm-mosi-regression.pth.
2024-06-12 20:55:02:INFO:TRAIN-(cmcm) (1/13/5)>> loss: 0.8498
2024-06-12 20:55:05:INFO:VAL-(cmcm) >>
2024-06-12 20:55:05:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.5282  Non0_acc_2: 0.5324  Non0_F1_score: 0.4985  Mult_acc_5: 0.2751  Mult_acc_7: 0.2140  MAE: 1.6397  Corr: 0.0142 
2024-06-12 20:55:20:INFO:TRAIN-(cmcm) (2/14/5)>> loss: 0.8469
2024-06-12 20:55:22:INFO:VAL-(cmcm) >>
2024-06-12 20:55:22:INFO:M: >>  Has0_acc_2: 0.5633  Has0_F1_score: 0.5155  Non0_acc_2: 0.5463  Non0_F1_score: 0.4963  Mult_acc_5: 0.2707  Mult_acc_7: 0.1965  MAE: 1.8940  Corr: -0.0514 
2024-06-12 20:55:37:INFO:TRAIN-(cmcm) (3/15/5)>> loss: 0.8411
2024-06-12 20:55:39:INFO:VAL-(cmcm) >>
2024-06-12 20:55:39:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4830  Non0_acc_2: 0.5880  Non0_F1_score: 0.4767  Mult_acc_5: 0.2707  Mult_acc_7: 0.2183  MAE: 1.5721  Corr: 0.0649 
2024-06-12 20:55:54:INFO:TRAIN-(cmcm) (4/16/5)>> loss: 0.8322
2024-06-12 20:55:57:INFO:VAL-(cmcm) >>
2024-06-12 20:55:57:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4723  Non0_acc_2: 0.5787  Non0_F1_score: 0.4445  Mult_acc_5: 0.3057  Mult_acc_7: 0.2140  MAE: 1.7503  Corr: 0.0783 
2024-06-12 20:56:11:INFO:TRAIN-(cmcm) (5/17/5)>> loss: 0.8280
2024-06-12 20:56:14:INFO:VAL-(cmcm) >>
2024-06-12 20:56:14:INFO:M: >>  Has0_acc_2: 0.6201  Has0_F1_score: 0.5302  Non0_acc_2: 0.5833  Non0_F1_score: 0.5150  Mult_acc_5: 0.2795  Mult_acc_7: 0.2445  MAE: 1.4497  Corr: 0.1336 
2024-06-12 20:56:14:INFO:Saving checkpoint at epoch 17 to results/models/cmcm-mosi-regression.pth.
2024-06-12 20:56:30:INFO:TRAIN-(cmcm) (1/18/5)>> loss: 0.8217
2024-06-12 20:56:32:INFO:VAL-(cmcm) >>
2024-06-12 20:56:32:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.6054  Non0_acc_2: 0.6065  Non0_F1_score: 0.6072  Mult_acc_5: 0.2576  Mult_acc_7: 0.1921  MAE: 1.5909  Corr: 0.1890 
2024-06-12 20:56:47:INFO:TRAIN-(cmcm) (2/19/5)>> loss: 0.8156
2024-06-12 20:56:49:INFO:VAL-(cmcm) >>
2024-06-12 20:56:49:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.5642  Non0_acc_2: 0.5694  Non0_F1_score: 0.5328  Mult_acc_5: 0.2576  Mult_acc_7: 0.1921  MAE: 1.6202  Corr: 0.1087 
2024-06-12 20:57:04:INFO:TRAIN-(cmcm) (3/20/5)>> loss: 0.7981
2024-06-12 20:57:06:INFO:VAL-(cmcm) >>
2024-06-12 20:57:06:INFO:M: >>  Has0_acc_2: 0.5633  Has0_F1_score: 0.5531  Non0_acc_2: 0.5926  Non0_F1_score: 0.5792  Mult_acc_5: 0.2533  Mult_acc_7: 0.1878  MAE: 1.5494  Corr: 0.3205 
2024-06-12 20:57:22:INFO:TRAIN-(cmcm) (4/21/5)>> loss: 0.8008
2024-06-12 20:57:25:INFO:VAL-(cmcm) >>
2024-06-12 20:57:25:INFO:M: >>  Has0_acc_2: 0.6594  Has0_F1_score: 0.6514  Non0_acc_2: 0.6528  Non0_F1_score: 0.6514  Mult_acc_5: 0.2751  Mult_acc_7: 0.2140  MAE: 1.4446  Corr: 0.3025 
2024-06-12 20:57:25:INFO:Saving checkpoint at epoch 21 to results/models/cmcm-mosi-regression.pth.
2024-06-12 20:57:41:INFO:TRAIN-(cmcm) (1/22/5)>> loss: 0.7936
2024-06-12 20:57:43:INFO:VAL-(cmcm) >>
2024-06-12 20:57:43:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.6063  Non0_acc_2: 0.6157  Non0_F1_score: 0.6165  Mult_acc_5: 0.2795  Mult_acc_7: 0.2096  MAE: 1.4739  Corr: 0.2964 
2024-06-12 20:57:58:INFO:TRAIN-(cmcm) (2/23/5)>> loss: 0.7783
2024-06-12 20:58:00:INFO:VAL-(cmcm) >>
2024-06-12 20:58:00:INFO:M: >>  Has0_acc_2: 0.6594  Has0_F1_score: 0.6247  Non0_acc_2: 0.6065  Non0_F1_score: 0.6076  Mult_acc_5: 0.2358  Mult_acc_7: 0.2009  MAE: 1.3761  Corr: 0.2711 
2024-06-12 20:58:01:INFO:Saving checkpoint at epoch 23 to results/models/cmcm-mosi-regression.pth.
2024-06-12 20:58:16:INFO:TRAIN-(cmcm) (1/24/5)>> loss: 0.7655
2024-06-12 20:58:19:INFO:VAL-(cmcm) >>
2024-06-12 20:58:19:INFO:M: >>  Has0_acc_2: 0.6157  Has0_F1_score: 0.6142  Non0_acc_2: 0.6296  Non0_F1_score: 0.6278  Mult_acc_5: 0.2926  Mult_acc_7: 0.2052  MAE: 1.4311  Corr: 0.3115 
2024-06-12 20:58:33:INFO:TRAIN-(cmcm) (2/25/5)>> loss: 0.7602
2024-06-12 20:58:36:INFO:VAL-(cmcm) >>
2024-06-12 20:58:36:INFO:M: >>  Has0_acc_2: 0.6332  Has0_F1_score: 0.6332  Non0_acc_2: 0.6343  Non0_F1_score: 0.6359  Mult_acc_5: 0.2707  Mult_acc_7: 0.1921  MAE: 1.4271  Corr: 0.3263 
2024-06-12 20:58:51:INFO:TRAIN-(cmcm) (3/26/5)>> loss: 0.7484
2024-06-12 20:58:53:INFO:VAL-(cmcm) >>
2024-06-12 20:58:53:INFO:M: >>  Has0_acc_2: 0.6288  Has0_F1_score: 0.5896  Non0_acc_2: 0.6157  Non0_F1_score: 0.5982  Mult_acc_5: 0.2664  Mult_acc_7: 0.2052  MAE: 1.4660  Corr: 0.2419 
2024-06-12 20:59:08:INFO:TRAIN-(cmcm) (4/27/5)>> loss: 0.7436
2024-06-12 20:59:10:INFO:VAL-(cmcm) >>
2024-06-12 20:59:10:INFO:M: >>  Has0_acc_2: 0.6550  Has0_F1_score: 0.6321  Non0_acc_2: 0.6250  Non0_F1_score: 0.6060  Mult_acc_5: 0.2664  Mult_acc_7: 0.2052  MAE: 1.4394  Corr: 0.2860 
2024-06-12 20:59:25:INFO:TRAIN-(cmcm) (5/28/5)>> loss: 0.7330
2024-06-12 20:59:28:INFO:VAL-(cmcm) >>
2024-06-12 20:59:28:INFO:M: >>  Has0_acc_2: 0.6288  Has0_F1_score: 0.6285  Non0_acc_2: 0.6296  Non0_F1_score: 0.6296  Mult_acc_5: 0.2882  Mult_acc_7: 0.2227  MAE: 1.4001  Corr: 0.3256 
2024-06-12 20:59:42:INFO:TRAIN-(cmcm) (6/29/5)>> loss: 0.7301
2024-06-12 20:59:45:INFO:VAL-(cmcm) >>
2024-06-12 20:59:45:INFO:M: >>  Has0_acc_2: 0.6419  Has0_F1_score: 0.6247  Non0_acc_2: 0.6204  Non0_F1_score: 0.6071  Mult_acc_5: 0.2838  Mult_acc_7: 0.2140  MAE: 1.4368  Corr: 0.2971 
2024-06-12 21:00:00:INFO:TRAIN-(cmcm) (7/30/5)>> loss: 0.7267
2024-06-12 21:00:02:INFO:VAL-(cmcm) >>
2024-06-12 21:00:02:INFO:M: >>  Has0_acc_2: 0.6376  Has0_F1_score: 0.6257  Non0_acc_2: 0.6250  Non0_F1_score: 0.6155  Mult_acc_5: 0.2620  Mult_acc_7: 0.1921  MAE: 1.4333  Corr: 0.3093 
2024-06-12 21:00:17:INFO:TRAIN-(cmcm) (8/31/5)>> loss: 0.7293
2024-06-12 21:00:19:INFO:VAL-(cmcm) >>
2024-06-12 21:00:19:INFO:M: >>  Has0_acc_2: 0.6332  Has0_F1_score: 0.6233  Non0_acc_2: 0.6250  Non0_F1_score: 0.6168  Mult_acc_5: 0.2707  Mult_acc_7: 0.2009  MAE: 1.4333  Corr: 0.3021 
2024-06-12 21:00:34:INFO:TRAIN-(cmcm) (9/32/5)>> loss: 0.7290
2024-06-12 21:00:37:INFO:VAL-(cmcm) >>
2024-06-12 21:00:37:INFO:M: >>  Has0_acc_2: 0.6376  Has0_F1_score: 0.6357  Non0_acc_2: 0.6389  Non0_F1_score: 0.6377  Mult_acc_5: 0.2838  Mult_acc_7: 0.2227  MAE: 1.4258  Corr: 0.3141 
2024-06-12 21:00:52:INFO:TRAIN-(cmcm) (10/33/5)>> loss: 0.7309
2024-06-12 21:00:54:INFO:VAL-(cmcm) >>
2024-06-12 21:00:54:INFO:M: >>  Has0_acc_2: 0.6550  Has0_F1_score: 0.6301  Non0_acc_2: 0.6389  Non0_F1_score: 0.6179  Mult_acc_5: 0.2838  Mult_acc_7: 0.2183  MAE: 1.4621  Corr: 0.2909 
2024-06-12 21:01:01:INFO:TEST-(cmcm) >>
2024-06-12 21:01:01:INFO:M: >>  Has0_acc_2: 0.5787  Has0_F1_score: 0.5691  Non0_acc_2: 0.5473  Non0_F1_score: 0.5456  Mult_acc_5: 0.2289  Mult_acc_7: 0.2157  MAE: 1.4698  Corr: 0.1278 
2024-06-12 21:01:02:INFO:Results are added to results/results/mosi-regression-30.csv...
2024-06-12 21:01:02:INFO:Start running cmcm...
2024-06-12 21:01:02:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [0], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 2, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 40, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-06-12 21:01:02:INFO:Let's use the GPU 0 !
2024-06-12 21:01:02:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 21:01:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718197262 HTTP/1.1" 200 235
2024-06-12 21:01:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 21:01:03:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 21:01:04:INFO:train samples: (1284,)
2024-06-12 21:01:04:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 21:01:04:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718197264 HTTP/1.1" 200 235
2024-06-12 21:01:04:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 21:01:05:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 21:01:05:INFO:valid samples: (229,)
2024-06-12 21:01:05:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 21:01:05:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718197266 HTTP/1.1" 200 235
2024-06-12 21:01:06:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 21:01:06:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 21:01:07:INFO:test samples: (686,)
2024-06-12 21:01:07:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 21:01:07:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718197267 HTTP/1.1" 200 235
2024-06-12 21:01:07:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 21:01:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 21:01:08:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 21:01:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718197269 HTTP/1.1" 200 235
2024-06-12 21:01:09:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 21:01:09:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 21:01:09:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-12 21:01:09:WARNING:Try importing flash-attention for faster inference...
2024-06-12 21:01:09:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-12 21:01:09:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-12 21:01:09:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-12 21:01:11:INFO:trainable params: 1310280 || all params: 1838138952 || trainable%: 0.07128296794833386
2024-06-12 21:01:11:INFO:Init labels...
2024-06-12 21:01:11:INFO:Start training...
2024-06-12 21:01:26:INFO:TRAIN-(cmcm) (1/1/1)>> loss: 3.9165
2024-06-12 21:01:28:INFO:VAL-(cmcm) >>
2024-06-12 21:01:28:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4676  Non0_F1_score: 0.4672  Mult_acc_5: 0.2314  Mult_acc_7: 0.1485  MAE: 3.6724  Corr: -0.0207 
2024-06-12 21:01:29:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-12 21:01:44:INFO:TRAIN-(cmcm) (1/2/1)>> loss: 1.3497
2024-06-12 21:01:47:INFO:VAL-(cmcm) >>
2024-06-12 21:01:47:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5424  Non0_acc_2: 0.5602  Non0_F1_score: 0.5283  Mult_acc_5: 0.1703  Mult_acc_7: 0.1659  MAE: 1.5909  Corr: 0.0105 
2024-06-12 21:01:48:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-12 21:02:03:INFO:TRAIN-(cmcm) (1/3/1)>> loss: 0.9613
2024-06-12 21:02:05:INFO:VAL-(cmcm) >>
2024-06-12 21:02:05:INFO:M: >>  Has0_acc_2: 0.4148  Has0_F1_score: 0.2581  Non0_acc_2: 0.4398  Non0_F1_score: 0.2841  Mult_acc_5: 0.1703  Mult_acc_7: 0.1703  MAE: 1.6467  Corr: -0.0284 
2024-06-12 21:02:21:INFO:TRAIN-(cmcm) (2/4/1)>> loss: 0.9119
2024-06-12 21:02:23:INFO:VAL-(cmcm) >>
2024-06-12 21:02:23:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4577  Non0_acc_2: 0.5787  Non0_F1_score: 0.4291  Mult_acc_5: 0.2140  Mult_acc_7: 0.1965  MAE: 1.5667  Corr: 0.0663 
2024-06-12 21:02:24:INFO:Saving checkpoint at epoch 4 to results/models/cmcm-mosi-regression.pth.
2024-06-12 21:02:40:INFO:TRAIN-(cmcm) (1/5/1)>> loss: 0.8901
2024-06-12 21:02:42:INFO:VAL-(cmcm) >>
2024-06-12 21:02:42:INFO:M: >>  Has0_acc_2: 0.5546  Has0_F1_score: 0.5587  Non0_acc_2: 0.5648  Non0_F1_score: 0.5671  Mult_acc_5: 0.2052  Mult_acc_7: 0.2052  MAE: 1.5108  Corr: 0.0500 
2024-06-12 21:02:43:INFO:Saving checkpoint at epoch 5 to results/models/cmcm-mosi-regression.pth.
2024-06-12 21:02:58:INFO:TRAIN-(cmcm) (1/6/1)>> loss: 0.8814
2024-06-12 21:03:01:INFO:VAL-(cmcm) >>
2024-06-12 21:03:01:INFO:M: >>  Has0_acc_2: 0.4934  Has0_F1_score: 0.4816  Non0_acc_2: 0.5000  Non0_F1_score: 0.4854  Mult_acc_5: 0.2358  Mult_acc_7: 0.2009  MAE: 1.6320  Corr: 0.1035 
2024-06-12 21:03:15:INFO:TRAIN-(cmcm) (2/7/1)>> loss: 0.8771
2024-06-12 21:03:18:INFO:VAL-(cmcm) >>
2024-06-12 21:03:18:INFO:M: >>  Has0_acc_2: 0.5240  Has0_F1_score: 0.5267  Non0_acc_2: 0.5278  Non0_F1_score: 0.5284  Mult_acc_5: 0.1616  Mult_acc_7: 0.1485  MAE: 1.6536  Corr: 0.1209 
2024-06-12 21:03:33:INFO:TRAIN-(cmcm) (3/8/1)>> loss: 0.8652
2024-06-12 21:03:35:INFO:VAL-(cmcm) >>
2024-06-12 21:03:35:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.5114  Non0_acc_2: 0.5833  Non0_F1_score: 0.4856  Mult_acc_5: 0.2052  Mult_acc_7: 0.1878  MAE: 1.5835  Corr: 0.0364 
2024-06-12 21:03:51:INFO:TRAIN-(cmcm) (4/9/1)>> loss: 0.8690
2024-06-12 21:03:53:INFO:VAL-(cmcm) >>
2024-06-12 21:03:53:INFO:M: >>  Has0_acc_2: 0.4760  Has0_F1_score: 0.4309  Non0_acc_2: 0.4954  Non0_F1_score: 0.4501  Mult_acc_5: 0.2227  Mult_acc_7: 0.2009  MAE: 1.5809  Corr: 0.0566 
2024-06-12 21:04:08:INFO:TRAIN-(cmcm) (5/10/1)>> loss: 0.8655
2024-06-12 21:04:10:INFO:VAL-(cmcm) >>
2024-06-12 21:04:10:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4577  Non0_acc_2: 0.5787  Non0_F1_score: 0.4291  Mult_acc_5: 0.2314  Mult_acc_7: 0.1965  MAE: 1.5781  Corr: 0.0787 
2024-06-12 21:04:25:INFO:TRAIN-(cmcm) (6/11/1)>> loss: 0.8605
2024-06-12 21:04:28:INFO:VAL-(cmcm) >>
2024-06-12 21:04:28:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4976  Non0_acc_2: 0.5833  Non0_F1_score: 0.4739  Mult_acc_5: 0.2926  Mult_acc_7: 0.2227  MAE: 1.7023  Corr: 0.0136 
2024-06-12 21:04:43:INFO:TRAIN-(cmcm) (7/12/1)>> loss: 0.8567
2024-06-12 21:04:45:INFO:VAL-(cmcm) >>
2024-06-12 21:04:45:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.5571  Non0_acc_2: 0.5741  Non0_F1_score: 0.5515  Mult_acc_5: 0.2926  Mult_acc_7: 0.2096  MAE: 1.7970  Corr: 0.0556 
2024-06-12 21:05:00:INFO:TRAIN-(cmcm) (8/13/1)>> loss: 0.8476
2024-06-12 21:05:02:INFO:VAL-(cmcm) >>
2024-06-12 21:05:02:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5741  Non0_F1_score: 0.4187  Mult_acc_5: 0.1747  Mult_acc_7: 0.1747  MAE: 1.4462  Corr: 0.0276 
2024-06-12 21:05:03:INFO:Saving checkpoint at epoch 13 to results/models/cmcm-mosi-regression.pth.
2024-06-12 21:05:18:INFO:TRAIN-(cmcm) (1/14/1)>> loss: 0.8504
2024-06-12 21:05:21:INFO:VAL-(cmcm) >>
2024-06-12 21:05:21:INFO:M: >>  Has0_acc_2: 0.5590  Has0_F1_score: 0.5321  Non0_acc_2: 0.5509  Non0_F1_score: 0.5210  Mult_acc_5: 0.2183  Mult_acc_7: 0.1747  MAE: 1.7582  Corr: 0.0415 
2024-06-12 21:05:36:INFO:TRAIN-(cmcm) (2/15/1)>> loss: 0.8459
2024-06-12 21:05:38:INFO:VAL-(cmcm) >>
2024-06-12 21:05:38:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.5831  Non0_acc_2: 0.5880  Non0_F1_score: 0.5846  Mult_acc_5: 0.2183  Mult_acc_7: 0.1878  MAE: 1.5152  Corr: 0.1108 
2024-06-12 21:05:53:INFO:TRAIN-(cmcm) (3/16/1)>> loss: 0.8493
2024-06-12 21:05:56:INFO:VAL-(cmcm) >>
2024-06-12 21:05:56:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5053  Non0_acc_2: 0.5648  Non0_F1_score: 0.4791  Mult_acc_5: 0.3013  Mult_acc_7: 0.2227  MAE: 1.7389  Corr: -0.0049 
2024-06-12 21:06:10:INFO:TRAIN-(cmcm) (4/17/1)>> loss: 0.8438
2024-06-12 21:06:13:INFO:VAL-(cmcm) >>
2024-06-12 21:06:13:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.5997  Non0_acc_2: 0.5000  Non0_F1_score: 0.4966  Mult_acc_5: 0.1878  Mult_acc_7: 0.1878  MAE: 1.4943  Corr: 0.0834 
2024-06-12 21:06:28:INFO:TRAIN-(cmcm) (5/18/1)>> loss: 0.8419
2024-06-12 21:06:30:INFO:VAL-(cmcm) >>
2024-06-12 21:06:30:INFO:M: >>  Has0_acc_2: 0.6245  Has0_F1_score: 0.5559  Non0_acc_2: 0.5787  Non0_F1_score: 0.5777  Mult_acc_5: 0.2751  Mult_acc_7: 0.2358  MAE: 1.4608  Corr: 0.0817 
2024-06-12 21:06:45:INFO:TRAIN-(cmcm) (6/19/1)>> loss: 0.8425
2024-06-12 21:06:48:INFO:VAL-(cmcm) >>
2024-06-12 21:06:48:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.5878  Non0_acc_2: 0.5926  Non0_F1_score: 0.5931  Mult_acc_5: 0.3013  Mult_acc_7: 0.2314  MAE: 1.5739  Corr: 0.1937 
2024-06-12 21:07:02:INFO:TRAIN-(cmcm) (7/20/1)>> loss: 0.8336
2024-06-12 21:07:05:INFO:VAL-(cmcm) >>
2024-06-12 21:07:05:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5231  Non0_acc_2: 0.5741  Non0_F1_score: 0.5042  Mult_acc_5: 0.2751  Mult_acc_7: 0.2009  MAE: 1.6926  Corr: 0.0492 
2024-06-12 21:07:20:INFO:TRAIN-(cmcm) (8/21/1)>> loss: 0.8284
2024-06-12 21:07:23:INFO:VAL-(cmcm) >>
2024-06-12 21:07:23:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.5609  Non0_acc_2: 0.6019  Non0_F1_score: 0.5514  Mult_acc_5: 0.2882  Mult_acc_7: 0.2271  MAE: 1.5628  Corr: 0.1250 
2024-06-12 21:07:38:INFO:TRAIN-(cmcm) (9/22/1)>> loss: 0.8235
2024-06-12 21:07:40:INFO:VAL-(cmcm) >>
2024-06-12 21:07:40:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.5874  Non0_acc_2: 0.6019  Non0_F1_score: 0.5880  Mult_acc_5: 0.1921  Mult_acc_7: 0.1616  MAE: 1.6205  Corr: 0.1219 
2024-06-12 21:07:55:INFO:TRAIN-(cmcm) (10/23/1)>> loss: 0.8207
2024-06-12 21:07:58:INFO:VAL-(cmcm) >>
2024-06-12 21:07:58:INFO:M: >>  Has0_acc_2: 0.6157  Has0_F1_score: 0.5990  Non0_acc_2: 0.6204  Non0_F1_score: 0.6002  Mult_acc_5: 0.2838  Mult_acc_7: 0.2271  MAE: 1.4886  Corr: 0.1897 
2024-06-12 21:08:05:INFO:TEST-(cmcm) >>
2024-06-12 21:08:05:INFO:M: >>  Has0_acc_2: 0.4548  Has0_F1_score: 0.2925  Non0_acc_2: 0.4299  Non0_F1_score: 0.2671  Mult_acc_5: 0.1749  Mult_acc_7: 0.1749  MAE: 1.6515  Corr: -0.0544 
2024-06-12 21:08:06:INFO:Results are added to results/results/mosi-regression-40.csv...
2024-06-12 21:08:06:INFO:Start running cmcm...
2024-06-12 21:08:06:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [0], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 2, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 40, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 2222}>
2024-06-12 21:08:06:INFO:Let's use the GPU 0 !
2024-06-12 21:08:06:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 21:08:06:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718197686 HTTP/1.1" 200 235
2024-06-12 21:08:06:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 21:08:07:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 21:08:07:INFO:train samples: (1284,)
2024-06-12 21:08:07:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 21:08:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718197688 HTTP/1.1" 200 235
2024-06-12 21:08:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 21:08:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 21:08:09:INFO:valid samples: (229,)
2024-06-12 21:08:09:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 21:08:09:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718197689 HTTP/1.1" 200 235
2024-06-12 21:08:09:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 21:08:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 21:08:10:INFO:test samples: (686,)
2024-06-12 21:08:10:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 21:08:11:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718197691 HTTP/1.1" 200 235
2024-06-12 21:08:11:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 21:08:11:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 21:08:12:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 21:08:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718197692 HTTP/1.1" 200 235
2024-06-12 21:08:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 21:08:13:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 21:08:13:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-12 21:08:13:WARNING:Try importing flash-attention for faster inference...
2024-06-12 21:08:13:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-12 21:08:13:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-12 21:08:13:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-12 21:08:14:INFO:trainable params: 1310280 || all params: 1838138952 || trainable%: 0.07128296794833386
2024-06-12 21:08:14:INFO:Init labels...
2024-06-12 21:08:14:INFO:Start training...
2024-06-12 21:08:29:INFO:TRAIN-(cmcm) (1/1/2)>> loss: 4.0527
2024-06-12 21:08:31:INFO:VAL-(cmcm) >>
2024-06-12 21:08:31:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4805  Non0_acc_2: 0.4861  Non0_F1_score: 0.4850  Mult_acc_5: 0.2926  Mult_acc_7: 0.1790  MAE: 2.0030  Corr: -0.0077 
2024-06-12 21:08:32:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-12 21:08:47:INFO:TRAIN-(cmcm) (1/2/2)>> loss: 1.6238
2024-06-12 21:08:50:INFO:VAL-(cmcm) >>
2024-06-12 21:08:50:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5698  Non0_acc_2: 0.5833  Non0_F1_score: 0.5688  Mult_acc_5: 0.1878  Mult_acc_7: 0.1441  MAE: 1.6053  Corr: 0.0515 
2024-06-12 21:08:51:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-12 21:09:06:INFO:TRAIN-(cmcm) (1/3/2)>> loss: 0.9723
2024-06-12 21:09:09:INFO:VAL-(cmcm) >>
2024-06-12 21:09:09:INFO:M: >>  Has0_acc_2: 0.5109  Has0_F1_score: 0.5113  Non0_acc_2: 0.5324  Non0_F1_score: 0.5321  Mult_acc_5: 0.1921  Mult_acc_7: 0.1703  MAE: 1.6813  Corr: 0.0446 
2024-06-12 21:09:23:INFO:TRAIN-(cmcm) (2/4/2)>> loss: 0.9271
2024-06-12 21:09:26:INFO:VAL-(cmcm) >>
2024-06-12 21:09:26:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.5690  Non0_acc_2: 0.5833  Non0_F1_score: 0.5492  Mult_acc_5: 0.2576  Mult_acc_7: 0.1921  MAE: 1.6162  Corr: 0.0968 
2024-06-12 21:09:41:INFO:TRAIN-(cmcm) (3/5/2)>> loss: 0.9051
2024-06-12 21:09:43:INFO:VAL-(cmcm) >>
2024-06-12 21:09:43:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.4780  Non0_acc_2: 0.5648  Non0_F1_score: 0.4505  Mult_acc_5: 0.2227  Mult_acc_7: 0.1747  MAE: 1.7363  Corr: -0.0526 
2024-06-12 21:09:58:INFO:TRAIN-(cmcm) (4/6/2)>> loss: 0.8870
2024-06-12 21:10:01:INFO:VAL-(cmcm) >>
2024-06-12 21:10:01:INFO:M: >>  Has0_acc_2: 0.6201  Has0_F1_score: 0.5398  Non0_acc_2: 0.6019  Non0_F1_score: 0.5187  Mult_acc_5: 0.2096  Mult_acc_7: 0.2009  MAE: 1.4781  Corr: 0.0834 
2024-06-12 21:10:02:INFO:Saving checkpoint at epoch 6 to results/models/cmcm-mosi-regression.pth.
2024-06-12 21:10:17:INFO:TRAIN-(cmcm) (1/7/2)>> loss: 0.8779
2024-06-12 21:10:19:INFO:VAL-(cmcm) >>
2024-06-12 21:10:19:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.6054  Non0_acc_2: 0.6019  Non0_F1_score: 0.5950  Mult_acc_5: 0.2533  Mult_acc_7: 0.2183  MAE: 1.5127  Corr: 0.1435 
2024-06-12 21:10:34:INFO:TRAIN-(cmcm) (2/8/2)>> loss: 0.8739
2024-06-12 21:10:37:INFO:VAL-(cmcm) >>
2024-06-12 21:10:37:INFO:M: >>  Has0_acc_2: 0.6507  Has0_F1_score: 0.6244  Non0_acc_2: 0.6204  Non0_F1_score: 0.5962  Mult_acc_5: 0.2227  Mult_acc_7: 0.2052  MAE: 1.4755  Corr: 0.1558 
2024-06-12 21:10:38:INFO:Saving checkpoint at epoch 8 to results/models/cmcm-mosi-regression.pth.
2024-06-12 21:10:53:INFO:TRAIN-(cmcm) (1/9/2)>> loss: 0.8620
2024-06-12 21:10:55:INFO:VAL-(cmcm) >>
2024-06-12 21:10:55:INFO:M: >>  Has0_acc_2: 0.6157  Has0_F1_score: 0.6192  Non0_acc_2: 0.6343  Non0_F1_score: 0.6356  Mult_acc_5: 0.2795  Mult_acc_7: 0.2183  MAE: 1.5826  Corr: 0.2461 
2024-06-12 21:11:10:INFO:TRAIN-(cmcm) (2/10/2)>> loss: 0.8640
2024-06-12 21:11:13:INFO:VAL-(cmcm) >>
2024-06-12 21:11:13:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.5058  Non0_acc_2: 0.5741  Non0_F1_score: 0.4797  Mult_acc_5: 0.2882  Mult_acc_7: 0.2096  MAE: 1.7538  Corr: -0.0113 
2024-06-12 21:11:28:INFO:TRAIN-(cmcm) (3/11/2)>> loss: 0.8773
2024-06-12 21:11:31:INFO:VAL-(cmcm) >>
2024-06-12 21:11:31:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.5500  Non0_acc_2: 0.5741  Non0_F1_score: 0.5364  Mult_acc_5: 0.2969  Mult_acc_7: 0.2271  MAE: 1.6992  Corr: 0.0595 
2024-06-12 21:11:45:INFO:TRAIN-(cmcm) (4/12/2)>> loss: 0.8622
2024-06-12 21:11:48:INFO:VAL-(cmcm) >>
2024-06-12 21:11:48:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.5673  Non0_acc_2: 0.5787  Non0_F1_score: 0.5694  Mult_acc_5: 0.2445  Mult_acc_7: 0.2096  MAE: 1.5341  Corr: 0.0756 
2024-06-12 21:12:03:INFO:TRAIN-(cmcm) (5/13/2)>> loss: 0.8491
2024-06-12 21:12:05:INFO:VAL-(cmcm) >>
2024-06-12 21:12:05:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5003  Non0_acc_2: 0.5787  Non0_F1_score: 0.4932  Mult_acc_5: 0.1790  Mult_acc_7: 0.1659  MAE: 1.5873  Corr: 0.0047 
2024-06-12 21:12:20:INFO:TRAIN-(cmcm) (6/14/2)>> loss: 0.8499
2024-06-12 21:12:23:INFO:VAL-(cmcm) >>
2024-06-12 21:12:23:INFO:M: >>  Has0_acc_2: 0.4934  Has0_F1_score: 0.4183  Non0_acc_2: 0.5231  Non0_F1_score: 0.4523  Mult_acc_5: 0.2096  Mult_acc_7: 0.1703  MAE: 1.8108  Corr: 0.1680 
2024-06-12 21:12:37:INFO:TRAIN-(cmcm) (7/15/2)>> loss: 0.8578
2024-06-12 21:12:40:INFO:VAL-(cmcm) >>
2024-06-12 21:12:40:INFO:M: >>  Has0_acc_2: 0.6245  Has0_F1_score: 0.5774  Non0_acc_2: 0.6019  Non0_F1_score: 0.5548  Mult_acc_5: 0.3100  Mult_acc_7: 0.2271  MAE: 1.6341  Corr: 0.1114 
2024-06-12 21:12:55:INFO:TRAIN-(cmcm) (8/16/2)>> loss: 0.8477
2024-06-12 21:12:57:INFO:VAL-(cmcm) >>
2024-06-12 21:12:57:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5621  Non0_acc_2: 0.5880  Non0_F1_score: 0.5529  Mult_acc_5: 0.2533  Mult_acc_7: 0.2096  MAE: 1.5865  Corr: 0.0717 
2024-06-12 21:13:12:INFO:TRAIN-(cmcm) (9/17/2)>> loss: 0.8475
2024-06-12 21:13:15:INFO:VAL-(cmcm) >>
2024-06-12 21:13:15:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.4905  Non0_acc_2: 0.5648  Non0_F1_score: 0.5654  Mult_acc_5: 0.2314  Mult_acc_7: 0.2052  MAE: 1.3921  Corr: 0.1772 
2024-06-12 21:13:15:INFO:Saving checkpoint at epoch 17 to results/models/cmcm-mosi-regression.pth.
2024-06-12 21:13:31:INFO:TRAIN-(cmcm) (1/18/2)>> loss: 0.8416
2024-06-12 21:13:33:INFO:VAL-(cmcm) >>
2024-06-12 21:13:33:INFO:M: >>  Has0_acc_2: 0.6332  Has0_F1_score: 0.5701  Non0_acc_2: 0.6204  Non0_F1_score: 0.5541  Mult_acc_5: 0.3144  Mult_acc_7: 0.2445  MAE: 1.5988  Corr: 0.1233 
2024-06-12 21:13:48:INFO:TRAIN-(cmcm) (2/19/2)>> loss: 0.8333
2024-06-12 21:13:50:INFO:VAL-(cmcm) >>
2024-06-12 21:13:50:INFO:M: >>  Has0_acc_2: 0.5459  Has0_F1_score: 0.5166  Non0_acc_2: 0.5694  Non0_F1_score: 0.5408  Mult_acc_5: 0.2314  Mult_acc_7: 0.1834  MAE: 1.6567  Corr: 0.2208 
2024-06-12 21:14:05:INFO:TRAIN-(cmcm) (3/20/2)>> loss: 0.8347
2024-06-12 21:14:08:INFO:VAL-(cmcm) >>
2024-06-12 21:14:08:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5670  Non0_acc_2: 0.5926  Non0_F1_score: 0.5869  Mult_acc_5: 0.2096  Mult_acc_7: 0.1572  MAE: 1.6162  Corr: 0.1698 
2024-06-12 21:14:23:INFO:TRAIN-(cmcm) (4/21/2)>> loss: 0.8253
2024-06-12 21:14:25:INFO:VAL-(cmcm) >>
2024-06-12 21:14:25:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.6026  Non0_acc_2: 0.5972  Non0_F1_score: 0.5940  Mult_acc_5: 0.2314  Mult_acc_7: 0.1790  MAE: 1.5846  Corr: 0.1911 
2024-06-12 21:14:40:INFO:TRAIN-(cmcm) (5/22/2)>> loss: 0.8213
2024-06-12 21:14:43:INFO:VAL-(cmcm) >>
2024-06-12 21:14:43:INFO:M: >>  Has0_acc_2: 0.6376  Has0_F1_score: 0.6349  Non0_acc_2: 0.6435  Non0_F1_score: 0.6388  Mult_acc_5: 0.2969  Mult_acc_7: 0.2402  MAE: 1.5232  Corr: 0.2104 
2024-06-12 21:14:57:INFO:TRAIN-(cmcm) (6/23/2)>> loss: 0.8193
2024-06-12 21:15:00:INFO:VAL-(cmcm) >>
2024-06-12 21:15:00:INFO:M: >>  Has0_acc_2: 0.6157  Has0_F1_score: 0.6142  Non0_acc_2: 0.6157  Non0_F1_score: 0.6126  Mult_acc_5: 0.3013  Mult_acc_7: 0.2358  MAE: 1.5782  Corr: 0.1950 
2024-06-12 21:15:15:INFO:TRAIN-(cmcm) (7/24/2)>> loss: 0.8151
2024-06-12 21:15:17:INFO:VAL-(cmcm) >>
2024-06-12 21:15:17:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.5879  Non0_acc_2: 0.5880  Non0_F1_score: 0.5863  Mult_acc_5: 0.2227  Mult_acc_7: 0.1790  MAE: 1.5424  Corr: 0.1894 
2024-06-12 21:15:32:INFO:TRAIN-(cmcm) (8/25/2)>> loss: 0.8062
2024-06-12 21:15:34:INFO:VAL-(cmcm) >>
2024-06-12 21:15:34:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5747  Non0_acc_2: 0.5694  Non0_F1_score: 0.5685  Mult_acc_5: 0.2314  Mult_acc_7: 0.1790  MAE: 1.6437  Corr: 0.1566 
2024-06-12 21:15:49:INFO:TRAIN-(cmcm) (9/26/2)>> loss: 0.8037
2024-06-12 21:15:52:INFO:VAL-(cmcm) >>
2024-06-12 21:15:52:INFO:M: >>  Has0_acc_2: 0.6507  Has0_F1_score: 0.6097  Non0_acc_2: 0.6481  Non0_F1_score: 0.6065  Mult_acc_5: 0.2882  Mult_acc_7: 0.2227  MAE: 1.4800  Corr: 0.2201 
2024-06-12 21:16:07:INFO:TRAIN-(cmcm) (10/27/2)>> loss: 0.7970
2024-06-12 21:16:09:INFO:VAL-(cmcm) >>
2024-06-12 21:16:09:INFO:M: >>  Has0_acc_2: 0.6419  Has0_F1_score: 0.6413  Non0_acc_2: 0.6065  Non0_F1_score: 0.6080  Mult_acc_5: 0.2707  Mult_acc_7: 0.2140  MAE: 1.4835  Corr: 0.2156 
2024-06-12 21:16:16:INFO:TEST-(cmcm) >>
2024-06-12 21:16:16:INFO:M: >>  Has0_acc_2: 0.4796  Has0_F1_score: 0.3597  Non0_acc_2: 0.4741  Non0_F1_score: 0.4771  Mult_acc_5: 0.1720  Mult_acc_7: 0.1706  MAE: 1.5889  Corr: 0.0203 
2024-06-12 21:16:17:INFO:Results are added to results/results/mosi-regression-40.csv...
2024-06-12 21:16:17:INFO:Start running cmcm...
2024-06-12 21:16:17:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [0], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 2, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 40, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 3333}>
2024-06-12 21:16:17:INFO:Let's use the GPU 0 !
2024-06-12 21:16:17:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 21:16:17:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718198177 HTTP/1.1" 200 235
2024-06-12 21:16:17:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 21:16:18:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 21:16:19:INFO:train samples: (1284,)
2024-06-12 21:16:19:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 21:16:19:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718198179 HTTP/1.1" 200 235
2024-06-12 21:16:19:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 21:16:19:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 21:16:20:INFO:valid samples: (229,)
2024-06-12 21:16:20:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 21:16:20:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718198181 HTTP/1.1" 200 235
2024-06-12 21:16:21:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 21:16:21:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 21:16:22:INFO:test samples: (686,)
2024-06-12 21:16:22:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 21:16:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718198182 HTTP/1.1" 200 235
2024-06-12 21:16:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 21:16:23:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 21:16:23:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 21:16:23:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718198183 HTTP/1.1" 200 235
2024-06-12 21:16:23:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 21:16:24:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 21:16:24:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-12 21:16:24:WARNING:Try importing flash-attention for faster inference...
2024-06-12 21:16:24:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-12 21:16:24:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-12 21:16:24:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-12 21:16:25:INFO:trainable params: 1310280 || all params: 1838138952 || trainable%: 0.07128296794833386
2024-06-12 21:16:25:INFO:Init labels...
2024-06-12 21:16:25:INFO:Start training...
2024-06-12 21:16:40:INFO:TRAIN-(cmcm) (1/1/3)>> loss: 3.9162
2024-06-12 21:16:42:INFO:VAL-(cmcm) >>
2024-06-12 21:16:42:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5417  Non0_F1_score: 0.5137  Mult_acc_5: 0.2838  Mult_acc_7: 0.1266  MAE: 2.3555  Corr: 0.0113 
2024-06-12 21:16:43:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-12 21:16:58:INFO:TRAIN-(cmcm) (1/2/3)>> loss: 1.4271
2024-06-12 21:17:01:INFO:VAL-(cmcm) >>
2024-06-12 21:17:01:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.4951  Non0_acc_2: 0.5694  Non0_F1_score: 0.4713  Mult_acc_5: 0.2882  Mult_acc_7: 0.2271  MAE: 1.6616  Corr: 0.0209 
2024-06-12 21:17:01:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-12 21:17:17:INFO:TRAIN-(cmcm) (1/3/3)>> loss: 0.9562
2024-06-12 21:17:19:INFO:VAL-(cmcm) >>
2024-06-12 21:17:19:INFO:M: >>  Has0_acc_2: 0.5153  Has0_F1_score: 0.5114  Non0_acc_2: 0.5324  Non0_F1_score: 0.5277  Mult_acc_5: 0.1572  Mult_acc_7: 0.1572  MAE: 1.6673  Corr: 0.0681 
2024-06-12 21:17:34:INFO:TRAIN-(cmcm) (2/4/3)>> loss: 0.9092
2024-06-12 21:17:37:INFO:VAL-(cmcm) >>
2024-06-12 21:17:37:INFO:M: >>  Has0_acc_2: 0.5546  Has0_F1_score: 0.5332  Non0_acc_2: 0.5231  Non0_F1_score: 0.5035  Mult_acc_5: 0.2664  Mult_acc_7: 0.1921  MAE: 1.7542  Corr: -0.0217 
2024-06-12 21:17:51:INFO:TRAIN-(cmcm) (3/5/3)>> loss: 0.8975
2024-06-12 21:17:54:INFO:VAL-(cmcm) >>
2024-06-12 21:17:54:INFO:M: >>  Has0_acc_2: 0.5546  Has0_F1_score: 0.5589  Non0_acc_2: 0.5556  Non0_F1_score: 0.5580  Mult_acc_5: 0.1703  Mult_acc_7: 0.1659  MAE: 1.5842  Corr: 0.0784 
2024-06-12 21:17:55:INFO:Saving checkpoint at epoch 5 to results/models/cmcm-mosi-regression.pth.
2024-06-12 21:18:10:INFO:TRAIN-(cmcm) (1/6/3)>> loss: 0.8920
2024-06-12 21:18:12:INFO:VAL-(cmcm) >>
2024-06-12 21:18:12:INFO:M: >>  Has0_acc_2: 0.5328  Has0_F1_score: 0.5278  Non0_acc_2: 0.5509  Non0_F1_score: 0.5453  Mult_acc_5: 0.2707  Mult_acc_7: 0.2140  MAE: 1.8708  Corr: 0.1112 
2024-06-12 21:18:27:INFO:TRAIN-(cmcm) (2/7/3)>> loss: 0.8699
2024-06-12 21:18:30:INFO:VAL-(cmcm) >>
2024-06-12 21:18:30:INFO:M: >>  Has0_acc_2: 0.5633  Has0_F1_score: 0.5647  Non0_acc_2: 0.5602  Non0_F1_score: 0.5599  Mult_acc_5: 0.2620  Mult_acc_7: 0.1834  MAE: 1.8110  Corr: 0.0608 
2024-06-12 21:18:44:INFO:TRAIN-(cmcm) (3/8/3)>> loss: 0.8661
2024-06-12 21:18:47:INFO:VAL-(cmcm) >>
2024-06-12 21:18:47:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5477  Non0_acc_2: 0.5787  Non0_F1_score: 0.5370  Mult_acc_5: 0.2445  Mult_acc_7: 0.2009  MAE: 1.6420  Corr: 0.0120 
2024-06-12 21:19:02:INFO:TRAIN-(cmcm) (4/9/3)>> loss: 0.8626
2024-06-12 21:19:04:INFO:VAL-(cmcm) >>
2024-06-12 21:19:04:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4950  Non0_acc_2: 0.5231  Non0_F1_score: 0.5156  Mult_acc_5: 0.2576  Mult_acc_7: 0.2140  MAE: 1.5009  Corr: 0.0402 
2024-06-12 21:19:05:INFO:Saving checkpoint at epoch 9 to results/models/cmcm-mosi-regression.pth.
2024-06-12 21:19:20:INFO:TRAIN-(cmcm) (1/10/3)>> loss: 0.8591
2024-06-12 21:19:23:INFO:VAL-(cmcm) >>
2024-06-12 21:19:23:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4891  Non0_acc_2: 0.5741  Non0_F1_score: 0.4622  Mult_acc_5: 0.3013  Mult_acc_7: 0.2227  MAE: 1.6979  Corr: 0.0327 
2024-06-12 21:19:37:INFO:TRAIN-(cmcm) (2/11/3)>> loss: 0.8569
2024-06-12 21:19:40:INFO:VAL-(cmcm) >>
2024-06-12 21:19:40:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4534  Non0_acc_2: 0.5741  Non0_F1_score: 0.4346  Mult_acc_5: 0.2707  Mult_acc_7: 0.1921  MAE: 1.6132  Corr: 0.0219 
2024-06-12 21:19:55:INFO:TRAIN-(cmcm) (3/12/3)>> loss: 0.8561
2024-06-12 21:19:57:INFO:VAL-(cmcm) >>
2024-06-12 21:19:57:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.4924  Non0_acc_2: 0.5278  Non0_F1_score: 0.5244  Mult_acc_5: 0.2271  Mult_acc_7: 0.1921  MAE: 1.5139  Corr: 0.0680 
2024-06-12 21:20:12:INFO:TRAIN-(cmcm) (4/13/3)>> loss: 0.8471
2024-06-12 21:20:15:INFO:VAL-(cmcm) >>
2024-06-12 21:20:15:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.5717  Non0_acc_2: 0.5231  Non0_F1_score: 0.5146  Mult_acc_5: 0.2445  Mult_acc_7: 0.2052  MAE: 1.5420  Corr: 0.0916 
2024-06-12 21:20:29:INFO:TRAIN-(cmcm) (5/14/3)>> loss: 0.8453
2024-06-12 21:20:32:INFO:VAL-(cmcm) >>
2024-06-12 21:20:32:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5252  Non0_acc_2: 0.5509  Non0_F1_score: 0.5097  Mult_acc_5: 0.1747  Mult_acc_7: 0.1528  MAE: 1.6389  Corr: 0.0621 
2024-06-12 21:20:47:INFO:TRAIN-(cmcm) (6/15/3)>> loss: 0.8476
2024-06-12 21:20:49:INFO:VAL-(cmcm) >>
2024-06-12 21:20:49:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5761  Non0_acc_2: 0.5741  Non0_F1_score: 0.5763  Mult_acc_5: 0.2140  Mult_acc_7: 0.1921  MAE: 1.5905  Corr: 0.1678 
2024-06-12 21:21:04:INFO:TRAIN-(cmcm) (7/16/3)>> loss: 0.8426
2024-06-12 21:21:06:INFO:VAL-(cmcm) >>
2024-06-12 21:21:06:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.5948  Non0_acc_2: 0.6065  Non0_F1_score: 0.6002  Mult_acc_5: 0.2795  Mult_acc_7: 0.2358  MAE: 1.5555  Corr: 0.2175 
2024-06-12 21:21:21:INFO:TRAIN-(cmcm) (8/17/3)>> loss: 0.8374
2024-06-12 21:21:24:INFO:VAL-(cmcm) >>
2024-06-12 21:21:24:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5070  Non0_acc_2: 0.5556  Non0_F1_score: 0.4913  Mult_acc_5: 0.2664  Mult_acc_7: 0.1965  MAE: 1.6691  Corr: 0.0478 
2024-06-12 21:21:38:INFO:TRAIN-(cmcm) (9/18/3)>> loss: 0.8373
2024-06-12 21:21:41:INFO:VAL-(cmcm) >>
2024-06-12 21:21:41:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5346  Non0_acc_2: 0.5694  Non0_F1_score: 0.5167  Mult_acc_5: 0.2664  Mult_acc_7: 0.1921  MAE: 1.7931  Corr: 0.0148 
2024-06-12 21:21:56:INFO:TRAIN-(cmcm) (10/19/3)>> loss: 0.8311
2024-06-12 21:21:58:INFO:VAL-(cmcm) >>
2024-06-12 21:21:58:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4866  Non0_acc_2: 0.5648  Non0_F1_score: 0.4739  Mult_acc_5: 0.2969  Mult_acc_7: 0.2227  MAE: 1.6324  Corr: 0.0790 
2024-06-12 21:22:06:INFO:TEST-(cmcm) >>
2024-06-12 21:22:06:INFO:M: >>  Has0_acc_2: 0.4913  Has0_F1_score: 0.3966  Non0_acc_2: 0.4939  Non0_F1_score: 0.4876  Mult_acc_5: 0.2055  Mult_acc_7: 0.1968  MAE: 1.5764  Corr: 0.0340 
2024-06-12 21:22:06:INFO:Results are added to results/results/mosi-regression-40.csv...
2024-06-12 21:22:06:INFO:Start running cmcm...
2024-06-12 21:22:06:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [0], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 2, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 40, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 4444}>
2024-06-12 21:22:06:INFO:Let's use the GPU 0 !
2024-06-12 21:22:06:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 21:22:06:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718198527 HTTP/1.1" 200 235
2024-06-12 21:22:07:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 21:22:07:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 21:22:08:INFO:train samples: (1284,)
2024-06-12 21:22:08:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 21:22:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718198528 HTTP/1.1" 200 235
2024-06-12 21:22:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 21:22:09:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 21:22:09:INFO:valid samples: (229,)
2024-06-12 21:22:09:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 21:22:09:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718198530 HTTP/1.1" 200 235
2024-06-12 21:22:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 21:22:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 21:22:11:INFO:test samples: (686,)
2024-06-12 21:22:11:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 21:22:11:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718198531 HTTP/1.1" 200 235
2024-06-12 21:22:11:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 21:22:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 21:22:12:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 21:22:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718198533 HTTP/1.1" 200 235
2024-06-12 21:22:13:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 21:22:13:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 21:22:13:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-12 21:22:13:WARNING:Try importing flash-attention for faster inference...
2024-06-12 21:22:13:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-12 21:22:13:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-12 21:22:13:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-12 21:22:15:INFO:trainable params: 1310280 || all params: 1838138952 || trainable%: 0.07128296794833386
2024-06-12 21:22:15:INFO:Init labels...
2024-06-12 21:22:15:INFO:Start training...
2024-06-12 21:22:29:INFO:TRAIN-(cmcm) (1/1/4)>> loss: 4.3598
2024-06-12 21:22:32:INFO:VAL-(cmcm) >>
2024-06-12 21:22:32:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4259  Non0_F1_score: 0.2544  Mult_acc_5: 0.2140  Mult_acc_7: 0.2140  MAE: 1.4370  Corr: nan 
2024-06-12 21:22:33:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-12 21:22:48:INFO:TRAIN-(cmcm) (1/2/4)>> loss: 3.3894
2024-06-12 21:22:50:INFO:VAL-(cmcm) >>
2024-06-12 21:22:50:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4534  Non0_acc_2: 0.5741  Non0_F1_score: 0.4491  Mult_acc_5: 0.3013  Mult_acc_7: 0.1397  MAE: 2.3682  Corr: -0.0077 
2024-06-12 21:23:05:INFO:TRAIN-(cmcm) (2/3/4)>> loss: 1.0649
2024-06-12 21:23:07:INFO:VAL-(cmcm) >>
2024-06-12 21:23:07:INFO:M: >>  Has0_acc_2: 0.6332  Has0_F1_score: 0.5389  Non0_acc_2: 0.6157  Non0_F1_score: 0.5230  Mult_acc_5: 0.2707  Mult_acc_7: 0.1965  MAE: 1.5822  Corr: 0.0356 
2024-06-12 21:23:22:INFO:TRAIN-(cmcm) (3/4/4)>> loss: 0.9511
2024-06-12 21:23:25:INFO:VAL-(cmcm) >>
2024-06-12 21:23:25:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5851  Non0_acc_2: 0.5926  Non0_F1_score: 0.5843  Mult_acc_5: 0.2445  Mult_acc_7: 0.1878  MAE: 1.5245  Corr: 0.1316 
2024-06-12 21:23:39:INFO:TRAIN-(cmcm) (4/5/4)>> loss: 0.9193
2024-06-12 21:23:42:INFO:VAL-(cmcm) >>
2024-06-12 21:23:42:INFO:M: >>  Has0_acc_2: 0.5502  Has0_F1_score: 0.5526  Non0_acc_2: 0.5509  Non0_F1_score: 0.5512  Mult_acc_5: 0.2489  Mult_acc_7: 0.2052  MAE: 1.6202  Corr: 0.0486 
2024-06-12 21:23:57:INFO:TRAIN-(cmcm) (5/6/4)>> loss: 0.8930
2024-06-12 21:23:59:INFO:VAL-(cmcm) >>
2024-06-12 21:23:59:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4723  Non0_acc_2: 0.5787  Non0_F1_score: 0.4445  Mult_acc_5: 0.2489  Mult_acc_7: 0.1790  MAE: 1.6446  Corr: 0.0279 
2024-06-12 21:24:14:INFO:TRAIN-(cmcm) (6/7/4)>> loss: 0.8852
2024-06-12 21:24:16:INFO:VAL-(cmcm) >>
2024-06-12 21:24:16:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5100  Non0_acc_2: 0.5602  Non0_F1_score: 0.4945  Mult_acc_5: 0.2533  Mult_acc_7: 0.1834  MAE: 1.6433  Corr: -0.0242 
2024-06-12 21:24:31:INFO:TRAIN-(cmcm) (7/8/4)>> loss: 0.8779
2024-06-12 21:24:34:INFO:VAL-(cmcm) >>
2024-06-12 21:24:34:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4767  Non0_acc_2: 0.5741  Non0_F1_score: 0.4491  Mult_acc_5: 0.2795  Mult_acc_7: 0.2009  MAE: 1.7223  Corr: -0.0172 
2024-06-12 21:24:49:INFO:TRAIN-(cmcm) (8/9/4)>> loss: 0.8723
2024-06-12 21:24:51:INFO:VAL-(cmcm) >>
2024-06-12 21:24:51:INFO:M: >>  Has0_acc_2: 0.5502  Has0_F1_score: 0.5532  Non0_acc_2: 0.5556  Non0_F1_score: 0.5566  Mult_acc_5: 0.2795  Mult_acc_7: 0.2096  MAE: 1.6171  Corr: 0.1288 
2024-06-12 21:25:06:INFO:TRAIN-(cmcm) (9/10/4)>> loss: 0.8691
2024-06-12 21:25:08:INFO:VAL-(cmcm) >>
2024-06-12 21:25:08:INFO:M: >>  Has0_acc_2: 0.6245  Has0_F1_score: 0.5804  Non0_acc_2: 0.6065  Non0_F1_score: 0.5703  Mult_acc_5: 0.2882  Mult_acc_7: 0.2227  MAE: 1.5036  Corr: 0.1479 
2024-06-12 21:25:23:INFO:TRAIN-(cmcm) (10/11/4)>> loss: 0.8590
2024-06-12 21:25:26:INFO:VAL-(cmcm) >>
2024-06-12 21:25:26:INFO:M: >>  Has0_acc_2: 0.6201  Has0_F1_score: 0.5879  Non0_acc_2: 0.5972  Non0_F1_score: 0.5681  Mult_acc_5: 0.2969  Mult_acc_7: 0.2227  MAE: 1.6232  Corr: 0.0933 
2024-06-12 21:25:33:INFO:TEST-(cmcm) >>
2024-06-12 21:25:33:INFO:M: >>  Has0_acc_2: 0.4475  Has0_F1_score: 0.2767  Non0_acc_2: 0.5777  Non0_F1_score: 0.4231  Mult_acc_5: 0.1545  Mult_acc_7: 0.1545  MAE: 1.4174  Corr: nan 
2024-06-12 21:25:33:INFO:Results are added to results/results/mosi-regression-40.csv...
2024-06-12 21:25:33:INFO:Start running cmcm...
2024-06-12 21:25:33:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [0], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 2, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 40, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 5555}>
2024-06-12 21:25:33:INFO:Let's use the GPU 0 !
2024-06-12 21:25:33:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 21:25:34:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718198734 HTTP/1.1" 200 235
2024-06-12 21:25:34:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 21:25:34:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 21:25:35:INFO:train samples: (1284,)
2024-06-12 21:25:35:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 21:25:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718198735 HTTP/1.1" 200 235
2024-06-12 21:25:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 21:25:36:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 21:25:36:INFO:valid samples: (229,)
2024-06-12 21:25:36:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 21:25:37:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718198737 HTTP/1.1" 200 235
2024-06-12 21:25:37:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 21:25:37:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 21:25:38:INFO:test samples: (686,)
2024-06-12 21:25:38:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 21:25:38:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718198738 HTTP/1.1" 200 235
2024-06-12 21:25:38:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 21:25:39:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 21:25:39:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 21:25:39:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718198740 HTTP/1.1" 200 235
2024-06-12 21:25:40:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 21:25:40:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 21:25:40:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-12 21:25:40:WARNING:Try importing flash-attention for faster inference...
2024-06-12 21:25:40:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-12 21:25:40:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-12 21:25:40:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-12 21:25:42:INFO:trainable params: 1310280 || all params: 1838138952 || trainable%: 0.07128296794833386
2024-06-12 21:25:42:INFO:Init labels...
2024-06-12 21:25:42:INFO:Start training...
2024-06-12 21:25:56:INFO:TRAIN-(cmcm) (1/1/5)>> loss: 3.0563
2024-06-12 21:25:59:INFO:VAL-(cmcm) >>
2024-06-12 21:25:59:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5694  Non0_F1_score: 0.4246  Mult_acc_5: 0.1747  Mult_acc_7: 0.1747  MAE: 1.5148  Corr: -0.0617 
2024-06-12 21:25:59:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-12 21:26:15:INFO:TRAIN-(cmcm) (1/2/5)>> loss: 1.0510
2024-06-12 21:26:17:INFO:VAL-(cmcm) >>
2024-06-12 21:26:17:INFO:M: >>  Has0_acc_2: 0.4847  Has0_F1_score: 0.4589  Non0_acc_2: 0.5000  Non0_F1_score: 0.4730  Mult_acc_5: 0.1528  Mult_acc_7: 0.1528  MAE: 1.6488  Corr: 0.0609 
2024-06-12 21:26:32:INFO:TRAIN-(cmcm) (2/3/5)>> loss: 0.9217
2024-06-12 21:26:34:INFO:VAL-(cmcm) >>
2024-06-12 21:26:34:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.5099  Non0_acc_2: 0.5556  Non0_F1_score: 0.4871  Mult_acc_5: 0.2969  Mult_acc_7: 0.2314  MAE: 1.7525  Corr: -0.0038 
2024-06-12 21:26:49:INFO:TRAIN-(cmcm) (3/4/5)>> loss: 0.8883
2024-06-12 21:26:51:INFO:VAL-(cmcm) >>
2024-06-12 21:26:51:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5602  Non0_F1_score: 0.4275  Mult_acc_5: 0.2052  Mult_acc_7: 0.1965  MAE: 1.4713  Corr: 0.0361 
2024-06-12 21:26:52:INFO:Saving checkpoint at epoch 4 to results/models/cmcm-mosi-regression.pth.
2024-06-12 21:27:07:INFO:TRAIN-(cmcm) (1/5/5)>> loss: 0.8789
2024-06-12 21:27:10:INFO:VAL-(cmcm) >>
2024-06-12 21:27:10:INFO:M: >>  Has0_acc_2: 0.5633  Has0_F1_score: 0.4787  Non0_acc_2: 0.5463  Non0_F1_score: 0.4621  Mult_acc_5: 0.2271  Mult_acc_7: 0.1878  MAE: 1.6944  Corr: -0.0582 
2024-06-12 21:27:25:INFO:TRAIN-(cmcm) (2/6/5)>> loss: 0.8759
2024-06-12 21:27:27:INFO:VAL-(cmcm) >>
2024-06-12 21:27:27:INFO:M: >>  Has0_acc_2: 0.5590  Has0_F1_score: 0.5055  Non0_acc_2: 0.5463  Non0_F1_score: 0.4888  Mult_acc_5: 0.2140  Mult_acc_7: 0.2009  MAE: 1.6429  Corr: -0.0183 
2024-06-12 21:27:42:INFO:TRAIN-(cmcm) (3/7/5)>> loss: 0.8675
2024-06-12 21:27:45:INFO:VAL-(cmcm) >>
2024-06-12 21:27:45:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.5116  Non0_acc_2: 0.5694  Non0_F1_score: 0.4966  Mult_acc_5: 0.2664  Mult_acc_7: 0.1878  MAE: 1.6691  Corr: 0.0038 
2024-06-12 21:27:59:INFO:TRAIN-(cmcm) (4/8/5)>> loss: 0.8635
2024-06-12 21:28:02:INFO:VAL-(cmcm) >>
2024-06-12 21:28:02:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4855  Non0_acc_2: 0.5509  Non0_F1_score: 0.5533  Mult_acc_5: 0.1790  Mult_acc_7: 0.1790  MAE: 1.4733  Corr: 0.0738 
2024-06-12 21:28:17:INFO:TRAIN-(cmcm) (5/9/5)>> loss: 0.8656
2024-06-12 21:28:19:INFO:VAL-(cmcm) >>
2024-06-12 21:28:19:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.4814  Non0_acc_2: 0.5694  Non0_F1_score: 0.4595  Mult_acc_5: 0.3013  Mult_acc_7: 0.2183  MAE: 1.7354  Corr: 0.0026 
2024-06-12 21:28:34:INFO:TRAIN-(cmcm) (6/10/5)>> loss: 0.8655
2024-06-12 21:28:37:INFO:VAL-(cmcm) >>
2024-06-12 21:28:37:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.4584  Non0_acc_2: 0.5648  Non0_F1_score: 0.4299  Mult_acc_5: 0.2838  Mult_acc_7: 0.2052  MAE: 1.7730  Corr: -0.0408 
2024-06-12 21:28:51:INFO:TRAIN-(cmcm) (7/11/5)>> loss: 0.8567
2024-06-12 21:28:54:INFO:VAL-(cmcm) >>
2024-06-12 21:28:54:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4652  Non0_acc_2: 0.5787  Non0_F1_score: 0.4711  Mult_acc_5: 0.3144  Mult_acc_7: 0.2314  MAE: 1.6922  Corr: 0.0655 
2024-06-12 21:29:09:INFO:TRAIN-(cmcm) (8/12/5)>> loss: 0.8574
2024-06-12 21:29:11:INFO:VAL-(cmcm) >>
2024-06-12 21:29:11:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.5348  Non0_acc_2: 0.5509  Non0_F1_score: 0.5282  Mult_acc_5: 0.2183  Mult_acc_7: 0.2096  MAE: 1.5266  Corr: -0.0092 
2024-06-12 21:29:26:INFO:TRAIN-(cmcm) (9/13/5)>> loss: 0.8529
2024-06-12 21:29:29:INFO:VAL-(cmcm) >>
2024-06-12 21:29:29:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.5770  Non0_acc_2: 0.5926  Non0_F1_score: 0.5689  Mult_acc_5: 0.2838  Mult_acc_7: 0.2052  MAE: 1.6285  Corr: 0.0832 
2024-06-12 21:29:43:INFO:TRAIN-(cmcm) (10/14/5)>> loss: 0.8531
2024-06-12 21:29:46:INFO:VAL-(cmcm) >>
2024-06-12 21:29:46:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4855  Non0_acc_2: 0.5741  Non0_F1_score: 0.4622  Mult_acc_5: 0.2969  Mult_acc_7: 0.2183  MAE: 1.6944  Corr: 0.0427 
2024-06-12 21:29:53:INFO:TEST-(cmcm) >>
2024-06-12 21:29:53:INFO:M: >>  Has0_acc_2: 0.4475  Has0_F1_score: 0.2767  Non0_acc_2: 0.4588  Non0_F1_score: 0.3426  Mult_acc_5: 0.1822  Mult_acc_7: 0.1764  MAE: 1.6644  Corr: 0.1468 
2024-06-12 21:29:53:INFO:Results are added to results/results/mosi-regression-40.csv...
2024-06-12 21:29:53:INFO:Start running cmcm...
2024-06-12 21:29:53:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [0], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 2, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 50, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-06-12 21:29:53:INFO:Let's use the GPU 0 !
2024-06-12 21:29:54:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 21:29:54:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718198994 HTTP/1.1" 200 235
2024-06-12 21:29:54:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 21:29:54:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 21:29:55:INFO:train samples: (1284,)
2024-06-12 21:29:55:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 21:29:55:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718198996 HTTP/1.1" 200 235
2024-06-12 21:29:56:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 21:29:56:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 21:29:57:INFO:valid samples: (229,)
2024-06-12 21:29:57:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 21:29:57:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718198997 HTTP/1.1" 200 235
2024-06-12 21:29:57:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 21:29:58:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 21:29:58:INFO:test samples: (686,)
2024-06-12 21:29:58:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 21:29:58:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718198999 HTTP/1.1" 200 235
2024-06-12 21:29:59:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 21:29:59:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 21:30:00:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 21:30:00:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718199000 HTTP/1.1" 200 235
2024-06-12 21:30:00:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 21:30:01:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 21:30:01:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-12 21:30:01:WARNING:Try importing flash-attention for faster inference...
2024-06-12 21:30:01:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-12 21:30:01:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-12 21:30:01:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-12 21:30:02:INFO:trainable params: 1310280 || all params: 1838138952 || trainable%: 0.07128296794833386
2024-06-12 21:30:02:INFO:Init labels...
2024-06-12 21:30:02:INFO:Start training...
2024-06-12 21:30:17:INFO:TRAIN-(cmcm) (1/1/1)>> loss: 4.0001
2024-06-12 21:30:19:INFO:VAL-(cmcm) >>
2024-06-12 21:30:19:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4458  Non0_acc_2: 0.4583  Non0_F1_score: 0.4470  Mult_acc_5: 0.2402  Mult_acc_7: 0.1572  MAE: 1.9052  Corr: -0.0477 
2024-06-12 21:30:20:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-12 21:30:35:INFO:TRAIN-(cmcm) (1/2/1)>> loss: 1.5575
2024-06-12 21:30:38:INFO:VAL-(cmcm) >>
2024-06-12 21:30:38:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.5390  Non0_acc_2: 0.5648  Non0_F1_score: 0.5320  Mult_acc_5: 0.2576  Mult_acc_7: 0.2052  MAE: 1.7612  Corr: 0.0267 
2024-06-12 21:30:38:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-12 21:30:53:INFO:TRAIN-(cmcm) (1/3/1)>> loss: 0.9526
2024-06-12 21:30:56:INFO:VAL-(cmcm) >>
2024-06-12 21:30:56:INFO:M: >>  Has0_acc_2: 0.4367  Has0_F1_score: 0.3509  Non0_acc_2: 0.4537  Non0_F1_score: 0.3603  Mult_acc_5: 0.1659  Mult_acc_7: 0.1572  MAE: 1.7820  Corr: -0.0015 
2024-06-12 21:31:11:INFO:TRAIN-(cmcm) (2/4/1)>> loss: 0.9140
2024-06-12 21:31:13:INFO:VAL-(cmcm) >>
2024-06-12 21:31:13:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4917  Non0_acc_2: 0.5787  Non0_F1_score: 0.4649  Mult_acc_5: 0.2795  Mult_acc_7: 0.2052  MAE: 1.6878  Corr: 0.0446 
2024-06-12 21:31:14:INFO:Saving checkpoint at epoch 4 to results/models/cmcm-mosi-regression.pth.
2024-06-12 21:31:29:INFO:TRAIN-(cmcm) (1/5/1)>> loss: 0.8995
2024-06-12 21:31:32:INFO:VAL-(cmcm) >>
2024-06-12 21:31:32:INFO:M: >>  Has0_acc_2: 0.5328  Has0_F1_score: 0.5195  Non0_acc_2: 0.5093  Non0_F1_score: 0.4753  Mult_acc_5: 0.1659  Mult_acc_7: 0.1616  MAE: 1.5742  Corr: 0.1384 
2024-06-12 21:31:33:INFO:Saving checkpoint at epoch 5 to results/models/cmcm-mosi-regression.pth.
2024-06-12 21:31:48:INFO:TRAIN-(cmcm) (1/6/1)>> loss: 0.8932
2024-06-12 21:31:50:INFO:VAL-(cmcm) >>
2024-06-12 21:31:50:INFO:M: >>  Has0_acc_2: 0.5240  Has0_F1_score: 0.5267  Non0_acc_2: 0.5278  Non0_F1_score: 0.5284  Mult_acc_5: 0.1747  Mult_acc_7: 0.1747  MAE: 1.6117  Corr: 0.0523 
2024-06-12 21:32:05:INFO:TRAIN-(cmcm) (2/7/1)>> loss: 0.8803
2024-06-12 21:32:08:INFO:VAL-(cmcm) >>
2024-06-12 21:32:08:INFO:M: >>  Has0_acc_2: 0.5502  Has0_F1_score: 0.5229  Non0_acc_2: 0.5185  Non0_F1_score: 0.4976  Mult_acc_5: 0.2096  Mult_acc_7: 0.1790  MAE: 1.6228  Corr: -0.0063 
2024-06-12 21:32:22:INFO:TRAIN-(cmcm) (3/8/1)>> loss: 0.8709
2024-06-12 21:32:25:INFO:VAL-(cmcm) >>
2024-06-12 21:32:25:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.4880  Non0_acc_2: 0.5833  Non0_F1_score: 0.4610  Mult_acc_5: 0.2096  Mult_acc_7: 0.1659  MAE: 1.6062  Corr: 0.0811 
2024-06-12 21:32:40:INFO:TRAIN-(cmcm) (4/9/1)>> loss: 0.8727
2024-06-12 21:32:42:INFO:VAL-(cmcm) >>
2024-06-12 21:32:42:INFO:M: >>  Has0_acc_2: 0.5502  Has0_F1_score: 0.5498  Non0_acc_2: 0.5139  Non0_F1_score: 0.5153  Mult_acc_5: 0.2096  Mult_acc_7: 0.2009  MAE: 1.5545  Corr: 0.0602 
2024-06-12 21:32:43:INFO:Saving checkpoint at epoch 9 to results/models/cmcm-mosi-regression.pth.
2024-06-12 21:32:58:INFO:TRAIN-(cmcm) (1/10/1)>> loss: 0.8710
2024-06-12 21:33:01:INFO:VAL-(cmcm) >>
2024-06-12 21:33:01:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.4905  Non0_acc_2: 0.5880  Non0_F1_score: 0.4637  Mult_acc_5: 0.2314  Mult_acc_7: 0.1790  MAE: 1.5883  Corr: 0.0609 
2024-06-12 21:33:15:INFO:TRAIN-(cmcm) (2/11/1)>> loss: 0.8636
2024-06-12 21:33:18:INFO:VAL-(cmcm) >>
2024-06-12 21:33:18:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.4905  Non0_acc_2: 0.5880  Non0_F1_score: 0.4637  Mult_acc_5: 0.3100  Mult_acc_7: 0.2271  MAE: 1.8833  Corr: 0.0331 
2024-06-12 21:33:33:INFO:TRAIN-(cmcm) (3/12/1)>> loss: 0.8678
2024-06-12 21:33:35:INFO:VAL-(cmcm) >>
2024-06-12 21:33:35:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5479  Non0_acc_2: 0.5787  Non0_F1_score: 0.5306  Mult_acc_5: 0.2882  Mult_acc_7: 0.2096  MAE: 1.6966  Corr: 0.0615 
2024-06-12 21:33:50:INFO:TRAIN-(cmcm) (4/13/1)>> loss: 0.8562
2024-06-12 21:33:53:INFO:VAL-(cmcm) >>
2024-06-12 21:33:53:INFO:M: >>  Has0_acc_2: 0.6157  Has0_F1_score: 0.4994  Non0_acc_2: 0.5926  Non0_F1_score: 0.4730  Mult_acc_5: 0.1747  Mult_acc_7: 0.1747  MAE: 1.4501  Corr: 0.0115 
2024-06-12 21:33:53:INFO:Saving checkpoint at epoch 13 to results/models/cmcm-mosi-regression.pth.
2024-06-12 21:34:09:INFO:TRAIN-(cmcm) (1/14/1)>> loss: 0.8546
2024-06-12 21:34:11:INFO:VAL-(cmcm) >>
2024-06-12 21:34:11:INFO:M: >>  Has0_acc_2: 0.5633  Has0_F1_score: 0.5155  Non0_acc_2: 0.5463  Non0_F1_score: 0.4963  Mult_acc_5: 0.2882  Mult_acc_7: 0.2096  MAE: 1.7416  Corr: -0.0361 
2024-06-12 21:34:26:INFO:TRAIN-(cmcm) (2/15/1)>> loss: 0.8537
2024-06-12 21:34:28:INFO:VAL-(cmcm) >>
2024-06-12 21:34:28:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5479  Non0_acc_2: 0.5324  Non0_F1_score: 0.5039  Mult_acc_5: 0.2096  Mult_acc_7: 0.1878  MAE: 1.5651  Corr: 0.0073 
2024-06-12 21:34:43:INFO:TRAIN-(cmcm) (3/16/1)>> loss: 0.8609
2024-06-12 21:34:46:INFO:VAL-(cmcm) >>
2024-06-12 21:34:46:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.5029  Non0_acc_2: 0.5972  Non0_F1_score: 0.5000  Mult_acc_5: 0.2445  Mult_acc_7: 0.1878  MAE: 1.5389  Corr: 0.1113 
2024-06-12 21:35:00:INFO:TRAIN-(cmcm) (4/17/1)>> loss: 0.8523
2024-06-12 21:35:03:INFO:VAL-(cmcm) >>
2024-06-12 21:35:03:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5189  Non0_acc_2: 0.5556  Non0_F1_score: 0.5247  Mult_acc_5: 0.2183  Mult_acc_7: 0.1834  MAE: 1.5577  Corr: 0.0709 
2024-06-12 21:35:18:INFO:TRAIN-(cmcm) (5/18/1)>> loss: 0.8516
2024-06-12 21:35:20:INFO:VAL-(cmcm) >>
2024-06-12 21:35:20:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5031  Non0_acc_2: 0.5880  Non0_F1_score: 0.4993  Mult_acc_5: 0.2795  Mult_acc_7: 0.2183  MAE: 1.6630  Corr: 0.0650 
2024-06-12 21:35:35:INFO:TRAIN-(cmcm) (6/19/1)>> loss: 0.8480
2024-06-12 21:35:38:INFO:VAL-(cmcm) >>
2024-06-12 21:35:38:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.5949  Non0_acc_2: 0.5880  Non0_F1_score: 0.5775  Mult_acc_5: 0.2926  Mult_acc_7: 0.2358  MAE: 1.5241  Corr: 0.1970 
2024-06-12 21:35:52:INFO:TRAIN-(cmcm) (7/20/1)>> loss: 0.8417
2024-06-12 21:35:55:INFO:VAL-(cmcm) >>
2024-06-12 21:35:55:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.5697  Non0_acc_2: 0.5926  Non0_F1_score: 0.5537  Mult_acc_5: 0.2664  Mult_acc_7: 0.2140  MAE: 1.5621  Corr: 0.1474 
2024-06-12 21:36:10:INFO:TRAIN-(cmcm) (8/21/1)>> loss: 0.8374
2024-06-12 21:36:12:INFO:VAL-(cmcm) >>
2024-06-12 21:36:12:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.5352  Non0_acc_2: 0.5880  Non0_F1_score: 0.5138  Mult_acc_5: 0.2969  Mult_acc_7: 0.2314  MAE: 1.6018  Corr: 0.0865 
2024-06-12 21:36:27:INFO:TRAIN-(cmcm) (9/22/1)>> loss: 0.8370
2024-06-12 21:36:30:INFO:VAL-(cmcm) >>
2024-06-12 21:36:30:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5316  Non0_acc_2: 0.5648  Non0_F1_score: 0.5133  Mult_acc_5: 0.2620  Mult_acc_7: 0.1834  MAE: 1.7250  Corr: 0.0478 
2024-06-12 21:36:44:INFO:TRAIN-(cmcm) (10/23/1)>> loss: 0.8326
2024-06-12 21:36:47:INFO:VAL-(cmcm) >>
2024-06-12 21:36:47:INFO:M: >>  Has0_acc_2: 0.6201  Has0_F1_score: 0.5879  Non0_acc_2: 0.6157  Non0_F1_score: 0.5804  Mult_acc_5: 0.2838  Mult_acc_7: 0.2358  MAE: 1.4992  Corr: 0.1365 
2024-06-12 21:36:54:INFO:TEST-(cmcm) >>
2024-06-12 21:36:54:INFO:M: >>  Has0_acc_2: 0.4767  Has0_F1_score: 0.3561  Non0_acc_2: 0.4558  Non0_F1_score: 0.3389  Mult_acc_5: 0.1822  Mult_acc_7: 0.1822  MAE: 1.5874  Corr: 0.1036 
2024-06-12 21:36:55:INFO:Results are added to results/results/mosi-regression-50.csv...
2024-06-12 21:36:55:INFO:Start running cmcm...
2024-06-12 21:36:55:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [0], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 2, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 50, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 2222}>
2024-06-12 21:36:55:INFO:Let's use the GPU 0 !
2024-06-12 21:36:55:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 21:36:55:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718199415 HTTP/1.1" 200 235
2024-06-12 21:36:55:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 21:36:56:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 21:36:56:INFO:train samples: (1284,)
2024-06-12 21:36:56:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 21:36:57:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718199417 HTTP/1.1" 200 235
2024-06-12 21:36:57:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 21:36:57:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 21:36:58:INFO:valid samples: (229,)
2024-06-12 21:36:58:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 21:36:58:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718199418 HTTP/1.1" 200 235
2024-06-12 21:36:58:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 21:36:59:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 21:36:59:INFO:test samples: (686,)
2024-06-12 21:36:59:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 21:37:00:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718199420 HTTP/1.1" 200 235
2024-06-12 21:37:00:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 21:37:01:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 21:37:01:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 21:37:01:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718199421 HTTP/1.1" 200 235
2024-06-12 21:37:01:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 21:37:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 21:37:02:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-12 21:37:02:WARNING:Try importing flash-attention for faster inference...
2024-06-12 21:37:02:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-12 21:37:02:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-12 21:37:02:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-12 21:37:03:INFO:trainable params: 1310280 || all params: 1838138952 || trainable%: 0.07128296794833386
2024-06-12 21:37:03:INFO:Init labels...
2024-06-12 21:37:03:INFO:Start training...
2024-06-12 21:37:18:INFO:TRAIN-(cmcm) (1/1/2)>> loss: 4.1112
2024-06-12 21:37:20:INFO:VAL-(cmcm) >>
2024-06-12 21:37:20:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4259  Non0_F1_score: 0.2544  Mult_acc_5: 0.2140  Mult_acc_7: 0.2140  MAE: 1.4370  Corr: nan 
2024-06-12 21:37:21:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-12 21:37:36:INFO:TRAIN-(cmcm) (1/2/2)>> loss: 1.8974
2024-06-12 21:37:39:INFO:VAL-(cmcm) >>
2024-06-12 21:37:39:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5414  Non0_acc_2: 0.5880  Non0_F1_score: 0.5409  Mult_acc_5: 0.2489  Mult_acc_7: 0.1965  MAE: 1.5734  Corr: 0.1029 
2024-06-12 21:37:54:INFO:TRAIN-(cmcm) (2/3/2)>> loss: 0.9974
2024-06-12 21:37:56:INFO:VAL-(cmcm) >>
2024-06-12 21:37:56:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5346  Non0_acc_2: 0.5741  Non0_F1_score: 0.5164  Mult_acc_5: 0.2882  Mult_acc_7: 0.2140  MAE: 1.6822  Corr: 0.0874 
2024-06-12 21:38:11:INFO:TRAIN-(cmcm) (3/4/2)>> loss: 0.9317
2024-06-12 21:38:13:INFO:VAL-(cmcm) >>
2024-06-12 21:38:13:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.5187  Non0_acc_2: 0.5787  Non0_F1_score: 0.4932  Mult_acc_5: 0.1703  Mult_acc_7: 0.1703  MAE: 1.5632  Corr: 0.0057 
2024-06-12 21:38:28:INFO:TRAIN-(cmcm) (4/5/2)>> loss: 0.9165
2024-06-12 21:38:31:INFO:VAL-(cmcm) >>
2024-06-12 21:38:31:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4577  Non0_acc_2: 0.5787  Non0_F1_score: 0.4291  Mult_acc_5: 0.1921  Mult_acc_7: 0.1878  MAE: 1.4833  Corr: 0.1073 
2024-06-12 21:38:45:INFO:TRAIN-(cmcm) (5/6/2)>> loss: 0.9094
2024-06-12 21:38:48:INFO:VAL-(cmcm) >>
2024-06-12 21:38:48:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.4943  Non0_acc_2: 0.5833  Non0_F1_score: 0.4676  Mult_acc_5: 0.2620  Mult_acc_7: 0.2271  MAE: 1.5643  Corr: 0.0967 
2024-06-12 21:39:03:INFO:TRAIN-(cmcm) (6/7/2)>> loss: 0.8889
2024-06-12 21:39:05:INFO:VAL-(cmcm) >>
2024-06-12 21:39:05:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.5717  Non0_acc_2: 0.5787  Non0_F1_score: 0.5806  Mult_acc_5: 0.1921  Mult_acc_7: 0.1703  MAE: 1.6261  Corr: 0.0988 
2024-06-12 21:39:20:INFO:TRAIN-(cmcm) (7/8/2)>> loss: 0.8759
2024-06-12 21:39:23:INFO:VAL-(cmcm) >>
2024-06-12 21:39:23:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.5655  Non0_acc_2: 0.5833  Non0_F1_score: 0.5492  Mult_acc_5: 0.2052  Mult_acc_7: 0.2052  MAE: 1.5066  Corr: 0.0445 
2024-06-12 21:39:37:INFO:TRAIN-(cmcm) (8/9/2)>> loss: 0.8691
2024-06-12 21:39:40:INFO:VAL-(cmcm) >>
2024-06-12 21:39:40:INFO:M: >>  Has0_acc_2: 0.6376  Has0_F1_score: 0.6044  Non0_acc_2: 0.6296  Non0_F1_score: 0.5943  Mult_acc_5: 0.2445  Mult_acc_7: 0.1965  MAE: 1.5451  Corr: 0.1778 
2024-06-12 21:39:55:INFO:TRAIN-(cmcm) (9/10/2)>> loss: 0.8692
2024-06-12 21:39:57:INFO:VAL-(cmcm) >>
2024-06-12 21:39:57:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5302  Non0_acc_2: 0.5741  Non0_F1_score: 0.5084  Mult_acc_5: 0.2664  Mult_acc_7: 0.2271  MAE: 1.6285  Corr: 0.0196 
2024-06-12 21:40:12:INFO:TRAIN-(cmcm) (10/11/2)>> loss: 0.8742
2024-06-12 21:40:15:INFO:VAL-(cmcm) >>
2024-06-12 21:40:15:INFO:M: >>  Has0_acc_2: 0.5502  Has0_F1_score: 0.5297  Non0_acc_2: 0.5509  Non0_F1_score: 0.5260  Mult_acc_5: 0.2751  Mult_acc_7: 0.2009  MAE: 1.8293  Corr: 0.0199 
2024-06-12 21:40:22:INFO:TEST-(cmcm) >>
2024-06-12 21:40:22:INFO:M: >>  Has0_acc_2: 0.4475  Has0_F1_score: 0.2767  Non0_acc_2: 0.5777  Non0_F1_score: 0.4231  Mult_acc_5: 0.1545  Mult_acc_7: 0.1545  MAE: 1.4174  Corr: nan 
2024-06-12 21:40:22:INFO:Results are added to results/results/mosi-regression-50.csv...
2024-06-12 21:40:22:INFO:Start running cmcm...
2024-06-12 21:40:22:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [0], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 2, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 50, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 3333}>
2024-06-12 21:40:22:INFO:Let's use the GPU 0 !
2024-06-12 21:40:22:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 21:40:23:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718199623 HTTP/1.1" 200 235
2024-06-12 21:40:23:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 21:40:23:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 21:40:24:INFO:train samples: (1284,)
2024-06-12 21:40:24:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 21:40:24:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718199625 HTTP/1.1" 200 235
2024-06-12 21:40:25:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 21:40:25:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 21:40:26:INFO:valid samples: (229,)
2024-06-12 21:40:26:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 21:40:26:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718199626 HTTP/1.1" 200 235
2024-06-12 21:40:26:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 21:40:27:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 21:40:27:INFO:test samples: (686,)
2024-06-12 21:40:27:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 21:40:28:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718199628 HTTP/1.1" 200 235
2024-06-12 21:40:28:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 21:40:28:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 21:40:29:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 21:40:29:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718199629 HTTP/1.1" 200 235
2024-06-12 21:40:29:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 21:40:30:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 21:40:30:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-12 21:40:30:WARNING:Try importing flash-attention for faster inference...
2024-06-12 21:40:30:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-12 21:40:30:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-12 21:40:30:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-12 21:40:31:INFO:trainable params: 1310280 || all params: 1838138952 || trainable%: 0.07128296794833386
2024-06-12 21:40:31:INFO:Init labels...
2024-06-12 21:40:31:INFO:Start training...
2024-06-12 21:40:46:INFO:TRAIN-(cmcm) (1/1/3)>> loss: 4.0139
2024-06-12 21:40:48:INFO:VAL-(cmcm) >>
2024-06-12 21:40:48:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4722  Non0_F1_score: 0.4675  Mult_acc_5: 0.2751  Mult_acc_7: 0.1834  MAE: 1.8704  Corr: -0.0267 
2024-06-12 21:40:49:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-12 21:41:04:INFO:TRAIN-(cmcm) (1/2/3)>> loss: 1.6336
2024-06-12 21:41:07:INFO:VAL-(cmcm) >>
2024-06-12 21:41:07:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.4998  Non0_acc_2: 0.5231  Non0_F1_score: 0.4724  Mult_acc_5: 0.2358  Mult_acc_7: 0.2009  MAE: 1.6167  Corr: -0.0201 
2024-06-12 21:41:07:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-12 21:41:23:INFO:TRAIN-(cmcm) (1/3/3)>> loss: 0.9741
2024-06-12 21:41:25:INFO:VAL-(cmcm) >>
2024-06-12 21:41:25:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.5249  Non0_acc_2: 0.5926  Non0_F1_score: 0.5298  Mult_acc_5: 0.1790  Mult_acc_7: 0.1790  MAE: 1.4202  Corr: 0.1285 
2024-06-12 21:41:26:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-mosi-regression.pth.
2024-06-12 21:41:41:INFO:TRAIN-(cmcm) (1/4/3)>> loss: 0.9097
2024-06-12 21:41:44:INFO:VAL-(cmcm) >>
2024-06-12 21:41:44:INFO:M: >>  Has0_acc_2: 0.5459  Has0_F1_score: 0.5427  Non0_acc_2: 0.5324  Non0_F1_score: 0.5240  Mult_acc_5: 0.2140  Mult_acc_7: 0.1747  MAE: 1.7988  Corr: 0.1268 
2024-06-12 21:41:59:INFO:TRAIN-(cmcm) (2/5/3)>> loss: 0.8997
2024-06-12 21:42:01:INFO:VAL-(cmcm) >>
2024-06-12 21:42:01:INFO:M: >>  Has0_acc_2: 0.4367  Has0_F1_score: 0.3363  Non0_acc_2: 0.4630  Non0_F1_score: 0.3660  Mult_acc_5: 0.1834  Mult_acc_7: 0.1616  MAE: 1.8091  Corr: 0.0861 
2024-06-12 21:42:16:INFO:TRAIN-(cmcm) (3/6/3)>> loss: 0.8849
2024-06-12 21:42:18:INFO:VAL-(cmcm) >>
2024-06-12 21:42:18:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5261  Non0_acc_2: 0.5787  Non0_F1_score: 0.5074  Mult_acc_5: 0.2707  Mult_acc_7: 0.2096  MAE: 1.6900  Corr: 0.0529 
2024-06-12 21:42:33:INFO:TRAIN-(cmcm) (4/7/3)>> loss: 0.8693
2024-06-12 21:42:36:INFO:VAL-(cmcm) >>
2024-06-12 21:42:36:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5800  Non0_acc_2: 0.5833  Non0_F1_score: 0.5804  Mult_acc_5: 0.2838  Mult_acc_7: 0.2009  MAE: 1.6503  Corr: 0.1316 
2024-06-12 21:42:50:INFO:TRAIN-(cmcm) (5/8/3)>> loss: 0.8670
2024-06-12 21:42:53:INFO:VAL-(cmcm) >>
2024-06-12 21:42:53:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5282  Non0_acc_2: 0.5694  Non0_F1_score: 0.5167  Mult_acc_5: 0.2533  Mult_acc_7: 0.1965  MAE: 1.6953  Corr: -0.0348 
2024-06-12 21:43:08:INFO:TRAIN-(cmcm) (6/9/3)>> loss: 0.8640
2024-06-12 21:43:10:INFO:VAL-(cmcm) >>
2024-06-12 21:43:10:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.4951  Non0_acc_2: 0.5463  Non0_F1_score: 0.5266  Mult_acc_5: 0.2052  Mult_acc_7: 0.1659  MAE: 1.5280  Corr: 0.0426 
2024-06-12 21:43:25:INFO:TRAIN-(cmcm) (7/10/3)>> loss: 0.8622
2024-06-12 21:43:27:INFO:VAL-(cmcm) >>
2024-06-12 21:43:27:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.5029  Non0_acc_2: 0.5880  Non0_F1_score: 0.4767  Mult_acc_5: 0.3188  Mult_acc_7: 0.2402  MAE: 1.6630  Corr: 0.0960 
2024-06-12 21:43:42:INFO:TRAIN-(cmcm) (8/11/3)>> loss: 0.8550
2024-06-12 21:43:45:INFO:VAL-(cmcm) >>
2024-06-12 21:43:45:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5209  Non0_acc_2: 0.5648  Non0_F1_score: 0.5019  Mult_acc_5: 0.2620  Mult_acc_7: 0.1878  MAE: 1.6595  Corr: 0.0301 
2024-06-12 21:44:00:INFO:TRAIN-(cmcm) (9/12/3)>> loss: 0.8526
2024-06-12 21:44:02:INFO:VAL-(cmcm) >>
2024-06-12 21:44:02:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4723  Non0_acc_2: 0.5509  Non0_F1_score: 0.4651  Mult_acc_5: 0.2707  Mult_acc_7: 0.2052  MAE: 1.5315  Corr: 0.0862 
2024-06-12 21:44:17:INFO:TRAIN-(cmcm) (10/13/3)>> loss: 0.8462
2024-06-12 21:44:19:INFO:VAL-(cmcm) >>
2024-06-12 21:44:19:INFO:M: >>  Has0_acc_2: 0.5022  Has0_F1_score: 0.4794  Non0_acc_2: 0.5093  Non0_F1_score: 0.4828  Mult_acc_5: 0.2402  Mult_acc_7: 0.2096  MAE: 1.5555  Corr: 0.1895 
2024-06-12 21:44:27:INFO:TEST-(cmcm) >>
2024-06-12 21:44:27:INFO:M: >>  Has0_acc_2: 0.4650  Has0_F1_score: 0.3814  Non0_acc_2: 0.4497  Non0_F1_score: 0.3802  Mult_acc_5: 0.1676  Mult_acc_7: 0.1676  MAE: 1.5627  Corr: 0.0132 
2024-06-12 21:44:27:INFO:Results are added to results/results/mosi-regression-50.csv...
2024-06-12 21:44:27:INFO:Start running cmcm...
2024-06-12 21:44:27:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [0], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 2, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 50, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 4444}>
2024-06-12 21:44:27:INFO:Let's use the GPU 0 !
2024-06-12 21:44:27:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 21:44:27:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718199868 HTTP/1.1" 200 235
2024-06-12 21:44:28:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 21:44:28:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 21:44:29:INFO:train samples: (1284,)
2024-06-12 21:44:29:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 21:44:29:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718199869 HTTP/1.1" 200 235
2024-06-12 21:44:29:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 21:44:30:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 21:44:30:INFO:valid samples: (229,)
2024-06-12 21:44:30:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 21:44:31:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718199871 HTTP/1.1" 200 235
2024-06-12 21:44:31:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 21:44:31:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 21:44:32:INFO:test samples: (686,)
2024-06-12 21:44:32:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 21:44:32:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718199872 HTTP/1.1" 200 235
2024-06-12 21:44:32:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 21:44:33:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 21:44:33:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 21:44:33:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718199874 HTTP/1.1" 200 235
2024-06-12 21:44:34:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 21:44:34:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 21:44:34:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-12 21:44:34:WARNING:Try importing flash-attention for faster inference...
2024-06-12 21:44:34:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-12 21:44:34:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-12 21:44:34:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-12 21:44:35:INFO:trainable params: 1310280 || all params: 1838138952 || trainable%: 0.07128296794833386
2024-06-12 21:44:35:INFO:Init labels...
2024-06-12 21:44:35:INFO:Start training...
2024-06-12 21:44:50:INFO:TRAIN-(cmcm) (1/1/4)>> loss: 4.3710
2024-06-12 21:44:53:INFO:VAL-(cmcm) >>
2024-06-12 21:44:53:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4259  Non0_F1_score: 0.2544  Mult_acc_5: 0.2140  Mult_acc_7: 0.2140  MAE: 1.4370  Corr: nan 
2024-06-12 21:44:53:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-12 21:45:09:INFO:TRAIN-(cmcm) (1/2/4)>> loss: 3.7948
2024-06-12 21:45:11:INFO:VAL-(cmcm) >>
2024-06-12 21:45:11:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4652  Non0_acc_2: 0.4861  Non0_F1_score: 0.4840  Mult_acc_5: 0.2838  Mult_acc_7: 0.1528  MAE: 2.1809  Corr: -0.0282 
2024-06-12 21:45:26:INFO:TRAIN-(cmcm) (2/3/4)>> loss: 1.2823
2024-06-12 21:45:28:INFO:VAL-(cmcm) >>
2024-06-12 21:45:28:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5510  Non0_acc_2: 0.5833  Non0_F1_score: 0.5436  Mult_acc_5: 0.1878  Mult_acc_7: 0.1572  MAE: 1.5586  Corr: 0.0354 
2024-06-12 21:45:43:INFO:TRAIN-(cmcm) (3/4/4)>> loss: 0.9684
2024-06-12 21:45:46:INFO:VAL-(cmcm) >>
2024-06-12 21:45:46:INFO:M: >>  Has0_acc_2: 0.6376  Has0_F1_score: 0.5993  Non0_acc_2: 0.6250  Non0_F1_score: 0.5905  Mult_acc_5: 0.2795  Mult_acc_7: 0.2009  MAE: 1.4892  Corr: 0.1799 
2024-06-12 21:46:00:INFO:TRAIN-(cmcm) (4/5/4)>> loss: 0.9187
2024-06-12 21:46:03:INFO:VAL-(cmcm) >>
2024-06-12 21:46:03:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.5757  Non0_acc_2: 0.6019  Non0_F1_score: 0.6006  Mult_acc_5: 0.2358  Mult_acc_7: 0.2183  MAE: 1.4446  Corr: 0.2246 
2024-06-12 21:46:18:INFO:TRAIN-(cmcm) (5/6/4)>> loss: 0.9022
2024-06-12 21:46:20:INFO:VAL-(cmcm) >>
2024-06-12 21:46:20:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4855  Non0_acc_2: 0.5787  Non0_F1_score: 0.4584  Mult_acc_5: 0.2358  Mult_acc_7: 0.1921  MAE: 1.6306  Corr: -0.0458 
2024-06-12 21:46:35:INFO:TRAIN-(cmcm) (6/7/4)>> loss: 0.8936
2024-06-12 21:46:38:INFO:VAL-(cmcm) >>
2024-06-12 21:46:38:INFO:M: >>  Has0_acc_2: 0.6245  Has0_F1_score: 0.5224  Non0_acc_2: 0.5880  Non0_F1_score: 0.4885  Mult_acc_5: 0.2795  Mult_acc_7: 0.1965  MAE: 1.5638  Corr: 0.1362 
2024-06-12 21:46:52:INFO:TRAIN-(cmcm) (7/8/4)>> loss: 0.8887
2024-06-12 21:46:55:INFO:VAL-(cmcm) >>
2024-06-12 21:46:55:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4652  Non0_acc_2: 0.5787  Non0_F1_score: 0.4445  Mult_acc_5: 0.1747  Mult_acc_7: 0.1747  MAE: 1.5209  Corr: 0.0477 
2024-06-12 21:47:10:INFO:TRAIN-(cmcm) (8/9/4)>> loss: 0.8739
2024-06-12 21:47:12:INFO:VAL-(cmcm) >>
2024-06-12 21:47:12:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.4897  Non0_acc_2: 0.5602  Non0_F1_score: 0.4656  Mult_acc_5: 0.2707  Mult_acc_7: 0.2096  MAE: 1.5602  Corr: 0.0063 
2024-06-12 21:47:27:INFO:TRAIN-(cmcm) (9/10/4)>> loss: 0.8706
2024-06-12 21:47:30:INFO:VAL-(cmcm) >>
2024-06-12 21:47:30:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.6036  Non0_acc_2: 0.5972  Non0_F1_score: 0.5994  Mult_acc_5: 0.2358  Mult_acc_7: 0.2227  MAE: 1.4567  Corr: 0.1821 
2024-06-12 21:47:45:INFO:TRAIN-(cmcm) (10/11/4)>> loss: 0.8582
2024-06-12 21:47:47:INFO:VAL-(cmcm) >>
2024-06-12 21:47:47:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.5425  Non0_acc_2: 0.5972  Non0_F1_score: 0.5332  Mult_acc_5: 0.2795  Mult_acc_7: 0.2314  MAE: 1.6053  Corr: 0.0802 
2024-06-12 21:47:54:INFO:TEST-(cmcm) >>
2024-06-12 21:47:54:INFO:M: >>  Has0_acc_2: 0.4475  Has0_F1_score: 0.2767  Non0_acc_2: 0.5777  Non0_F1_score: 0.4231  Mult_acc_5: 0.1545  Mult_acc_7: 0.1545  MAE: 1.4174  Corr: nan 
2024-06-12 21:47:55:INFO:Results are added to results/results/mosi-regression-50.csv...
2024-06-12 21:47:55:INFO:Start running cmcm...
2024-06-12 21:47:55:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [0], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 2, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 50, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 5555}>
2024-06-12 21:47:55:INFO:Let's use the GPU 0 !
2024-06-12 21:47:55:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 21:47:55:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718200075 HTTP/1.1" 200 235
2024-06-12 21:47:55:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 21:47:56:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 21:47:56:INFO:train samples: (1284,)
2024-06-12 21:47:56:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 21:47:57:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718200077 HTTP/1.1" 200 235
2024-06-12 21:47:57:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 21:47:57:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 21:47:58:INFO:valid samples: (229,)
2024-06-12 21:47:58:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 21:47:58:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718200079 HTTP/1.1" 200 235
2024-06-12 21:47:59:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 21:47:59:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 21:48:00:INFO:test samples: (686,)
2024-06-12 21:48:00:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 21:48:00:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718200080 HTTP/1.1" 200 235
2024-06-12 21:48:00:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 21:48:01:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 21:48:01:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 21:48:01:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718200082 HTTP/1.1" 200 235
2024-06-12 21:48:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 21:48:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 21:48:02:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-12 21:48:02:WARNING:Try importing flash-attention for faster inference...
2024-06-12 21:48:02:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-12 21:48:02:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-12 21:48:02:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-12 21:48:03:INFO:trainable params: 1310280 || all params: 1838138952 || trainable%: 0.07128296794833386
2024-06-12 21:48:03:INFO:Init labels...
2024-06-12 21:48:03:INFO:Start training...
2024-06-12 21:48:19:INFO:TRAIN-(cmcm) (1/1/5)>> loss: 3.1751
2024-06-12 21:48:21:INFO:VAL-(cmcm) >>
2024-06-12 21:48:21:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5556  Non0_F1_score: 0.4913  Mult_acc_5: 0.1790  Mult_acc_7: 0.1747  MAE: 1.4705  Corr: 0.0265 
2024-06-12 21:48:22:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-12 21:48:37:INFO:TRAIN-(cmcm) (1/2/5)>> loss: 1.0268
2024-06-12 21:48:39:INFO:VAL-(cmcm) >>
2024-06-12 21:48:39:INFO:M: >>  Has0_acc_2: 0.4891  Has0_F1_score: 0.4824  Non0_acc_2: 0.5000  Non0_F1_score: 0.4917  Mult_acc_5: 0.1659  Mult_acc_7: 0.1659  MAE: 1.6755  Corr: 0.0405 
2024-06-12 21:48:54:INFO:TRAIN-(cmcm) (2/3/5)>> loss: 0.9195
2024-06-12 21:48:56:INFO:VAL-(cmcm) >>
2024-06-12 21:48:56:INFO:M: >>  Has0_acc_2: 0.4978  Has0_F1_score: 0.4799  Non0_acc_2: 0.5185  Non0_F1_score: 0.4989  Mult_acc_5: 0.1921  Mult_acc_7: 0.1878  MAE: 1.6293  Corr: 0.0743 
2024-06-12 21:49:11:INFO:TRAIN-(cmcm) (3/4/5)>> loss: 0.9023
2024-06-12 21:49:14:INFO:VAL-(cmcm) >>
2024-06-12 21:49:14:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.4897  Non0_acc_2: 0.5648  Non0_F1_score: 0.4627  Mult_acc_5: 0.1878  Mult_acc_7: 0.1790  MAE: 1.5296  Corr: 0.0074 
2024-06-12 21:49:29:INFO:TRAIN-(cmcm) (4/5/5)>> loss: 0.8904
2024-06-12 21:49:31:INFO:VAL-(cmcm) >>
2024-06-12 21:49:31:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.4939  Non0_acc_2: 0.5509  Non0_F1_score: 0.4701  Mult_acc_5: 0.1659  Mult_acc_7: 0.1659  MAE: 1.6359  Corr: -0.0313 
2024-06-12 21:49:46:INFO:TRAIN-(cmcm) (5/6/5)>> loss: 0.8817
2024-06-12 21:49:48:INFO:VAL-(cmcm) >>
2024-06-12 21:49:48:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5247  Non0_acc_2: 0.5602  Non0_F1_score: 0.5026  Mult_acc_5: 0.2838  Mult_acc_7: 0.2052  MAE: 1.7372  Corr: 0.0103 
2024-06-12 21:50:03:INFO:TRAIN-(cmcm) (6/7/5)>> loss: 0.8702
2024-06-12 21:50:06:INFO:VAL-(cmcm) >>
2024-06-12 21:50:06:INFO:M: >>  Has0_acc_2: 0.5197  Has0_F1_score: 0.5178  Non0_acc_2: 0.5185  Non0_F1_score: 0.5140  Mult_acc_5: 0.2533  Mult_acc_7: 0.1790  MAE: 1.8119  Corr: 0.0227 
2024-06-12 21:50:20:INFO:TRAIN-(cmcm) (7/8/5)>> loss: 0.8651
2024-06-12 21:50:23:INFO:VAL-(cmcm) >>
2024-06-12 21:50:23:INFO:M: >>  Has0_acc_2: 0.5633  Has0_F1_score: 0.5379  Non0_acc_2: 0.5556  Non0_F1_score: 0.5272  Mult_acc_5: 0.1616  Mult_acc_7: 0.1572  MAE: 1.6734  Corr: 0.0190 
2024-06-12 21:50:38:INFO:TRAIN-(cmcm) (8/9/5)>> loss: 0.8646
2024-06-12 21:50:41:INFO:VAL-(cmcm) >>
2024-06-12 21:50:41:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.4975  Non0_acc_2: 0.5602  Non0_F1_score: 0.4710  Mult_acc_5: 0.2926  Mult_acc_7: 0.2140  MAE: 1.8036  Corr: -0.0299 
2024-06-12 21:50:55:INFO:TRAIN-(cmcm) (9/10/5)>> loss: 0.8662
2024-06-12 21:50:58:INFO:VAL-(cmcm) >>
2024-06-12 21:50:58:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4978  Non0_acc_2: 0.5741  Non0_F1_score: 0.4797  Mult_acc_5: 0.2926  Mult_acc_7: 0.2140  MAE: 1.7040  Corr: 0.0105 
2024-06-12 21:51:13:INFO:TRAIN-(cmcm) (10/11/5)>> loss: 0.8574
2024-06-12 21:51:15:INFO:VAL-(cmcm) >>
2024-06-12 21:51:15:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4556  Non0_acc_2: 0.5787  Non0_F1_score: 0.4370  Mult_acc_5: 0.2882  Mult_acc_7: 0.2096  MAE: 1.6206  Corr: 0.0748 
2024-06-12 21:51:22:INFO:TEST-(cmcm) >>
2024-06-12 21:51:22:INFO:M: >>  Has0_acc_2: 0.4431  Has0_F1_score: 0.2823  Non0_acc_2: 0.4421  Non0_F1_score: 0.3971  Mult_acc_5: 0.1531  Mult_acc_7: 0.1516  MAE: 1.7023  Corr: -0.0608 
2024-06-12 21:51:23:INFO:Results are added to results/results/mosi-regression-50.csv...
2024-06-12 21:51:23:INFO:Start running cmcm...
2024-06-12 21:51:23:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [0], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 2, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 60, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-06-12 21:51:23:INFO:Let's use the GPU 0 !
2024-06-12 21:51:23:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 21:51:23:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718200283 HTTP/1.1" 200 235
2024-06-12 21:51:23:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 21:51:24:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 21:51:24:INFO:train samples: (1284,)
2024-06-12 21:51:24:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 21:51:25:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718200285 HTTP/1.1" 200 235
2024-06-12 21:51:25:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 21:51:25:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 21:51:26:INFO:valid samples: (229,)
2024-06-12 21:51:26:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 21:51:26:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718200287 HTTP/1.1" 200 235
2024-06-12 21:51:27:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 21:51:27:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 21:51:27:INFO:test samples: (686,)
2024-06-12 21:51:27:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 21:51:28:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718200288 HTTP/1.1" 200 235
2024-06-12 21:51:28:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 21:51:28:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 21:51:29:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 21:51:29:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718200289 HTTP/1.1" 200 235
2024-06-12 21:51:29:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 21:51:30:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 21:51:30:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-12 21:51:30:WARNING:Try importing flash-attention for faster inference...
2024-06-12 21:51:30:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-12 21:51:30:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-12 21:51:30:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-12 21:51:31:INFO:trainable params: 1310280 || all params: 1838138952 || trainable%: 0.07128296794833386
2024-06-12 21:51:31:INFO:Init labels...
2024-06-12 21:51:31:INFO:Start training...
2024-06-12 21:51:46:INFO:TRAIN-(cmcm) (1/1/1)>> loss: 4.0788
2024-06-12 21:51:48:INFO:VAL-(cmcm) >>
2024-06-12 21:51:48:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4907  Non0_F1_score: 0.4367  Mult_acc_5: 0.2707  Mult_acc_7: 0.2052  MAE: 1.5611  Corr: 0.1051 
2024-06-12 21:51:49:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-12 21:52:04:INFO:TRAIN-(cmcm) (1/2/1)>> loss: 1.7916
2024-06-12 21:52:07:INFO:VAL-(cmcm) >>
2024-06-12 21:52:07:INFO:M: >>  Has0_acc_2: 0.5197  Has0_F1_score: 0.5143  Non0_acc_2: 0.5185  Non0_F1_score: 0.5116  Mult_acc_5: 0.2052  Mult_acc_7: 0.1965  MAE: 1.6388  Corr: -0.0409 
2024-06-12 21:52:21:INFO:TRAIN-(cmcm) (2/3/1)>> loss: 0.9741
2024-06-12 21:52:24:INFO:VAL-(cmcm) >>
2024-06-12 21:52:24:INFO:M: >>  Has0_acc_2: 0.5153  Has0_F1_score: 0.5161  Non0_acc_2: 0.5185  Non0_F1_score: 0.5152  Mult_acc_5: 0.1834  Mult_acc_7: 0.1659  MAE: 1.6759  Corr: 0.0633 
2024-06-12 21:52:39:INFO:TRAIN-(cmcm) (3/4/1)>> loss: 0.9251
2024-06-12 21:52:41:INFO:VAL-(cmcm) >>
2024-06-12 21:52:41:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.5220  Non0_acc_2: 0.5463  Non0_F1_score: 0.4997  Mult_acc_5: 0.1572  Mult_acc_7: 0.1528  MAE: 1.6235  Corr: -0.0451 
2024-06-12 21:52:56:INFO:TRAIN-(cmcm) (4/5/1)>> loss: 0.9207
2024-06-12 21:52:58:INFO:VAL-(cmcm) >>
2024-06-12 21:52:58:INFO:M: >>  Has0_acc_2: 0.6245  Has0_F1_score: 0.5381  Non0_acc_2: 0.6019  Non0_F1_score: 0.5137  Mult_acc_5: 0.2882  Mult_acc_7: 0.2183  MAE: 1.5800  Corr: 0.1079 
2024-06-12 21:53:13:INFO:TRAIN-(cmcm) (5/6/1)>> loss: 0.8954
2024-06-12 21:53:16:INFO:VAL-(cmcm) >>
2024-06-12 21:53:16:INFO:M: >>  Has0_acc_2: 0.5590  Has0_F1_score: 0.5445  Non0_acc_2: 0.5463  Non0_F1_score: 0.5305  Mult_acc_5: 0.2271  Mult_acc_7: 0.1790  MAE: 1.7344  Corr: 0.0170 
2024-06-12 21:53:31:INFO:TRAIN-(cmcm) (6/7/1)>> loss: 0.8970
2024-06-12 21:53:33:INFO:VAL-(cmcm) >>
2024-06-12 21:53:33:INFO:M: >>  Has0_acc_2: 0.5371  Has0_F1_score: 0.5389  Non0_acc_2: 0.5509  Non0_F1_score: 0.5512  Mult_acc_5: 0.2489  Mult_acc_7: 0.1834  MAE: 1.7734  Corr: 0.1172 
2024-06-12 21:53:48:INFO:TRAIN-(cmcm) (7/8/1)>> loss: 0.8783
2024-06-12 21:53:50:INFO:VAL-(cmcm) >>
2024-06-12 21:53:50:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4976  Non0_acc_2: 0.5787  Non0_F1_score: 0.4711  Mult_acc_5: 0.2314  Mult_acc_7: 0.1878  MAE: 1.5909  Corr: 0.0281 
2024-06-12 21:54:05:INFO:TRAIN-(cmcm) (8/9/1)>> loss: 0.8744
2024-06-12 21:54:08:INFO:VAL-(cmcm) >>
2024-06-12 21:54:08:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5231  Non0_acc_2: 0.5741  Non0_F1_score: 0.5042  Mult_acc_5: 0.2664  Mult_acc_7: 0.2140  MAE: 1.6363  Corr: 0.0301 
2024-06-12 21:54:22:INFO:TRAIN-(cmcm) (9/10/1)>> loss: 0.8635
2024-06-12 21:54:25:INFO:VAL-(cmcm) >>
2024-06-12 21:54:25:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5031  Non0_acc_2: 0.5741  Non0_F1_score: 0.4797  Mult_acc_5: 0.3057  Mult_acc_7: 0.2271  MAE: 1.6280  Corr: 0.0544 
2024-06-12 21:54:40:INFO:TRAIN-(cmcm) (10/11/1)>> loss: 0.8678
2024-06-12 21:54:42:INFO:VAL-(cmcm) >>
2024-06-12 21:54:42:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4742  Non0_acc_2: 0.5694  Non0_F1_score: 0.4465  Mult_acc_5: 0.2620  Mult_acc_7: 0.1965  MAE: 1.7734  Corr: -0.0091 
2024-06-12 21:54:49:INFO:TEST-(cmcm) >>
2024-06-12 21:54:49:INFO:M: >>  Has0_acc_2: 0.4461  Has0_F1_score: 0.2761  Non0_acc_2: 0.5701  Non0_F1_score: 0.5079  Mult_acc_5: 0.1516  Mult_acc_7: 0.1254  MAE: 1.6869  Corr: 0.0651 
2024-06-12 21:54:50:INFO:Results are added to results/results/mosi-regression-60.csv...
2024-06-12 21:54:50:INFO:Start running cmcm...
2024-06-12 21:54:50:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [0], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 2, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 60, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 2222}>
2024-06-12 21:54:50:INFO:Let's use the GPU 0 !
2024-06-12 21:54:50:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 21:54:50:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718200490 HTTP/1.1" 200 235
2024-06-12 21:54:50:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 21:54:51:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 21:54:51:INFO:train samples: (1284,)
2024-06-12 21:54:51:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 21:54:52:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718200492 HTTP/1.1" 200 235
2024-06-12 21:54:52:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 21:54:52:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 21:54:53:INFO:valid samples: (229,)
2024-06-12 21:54:53:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 21:54:53:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718200493 HTTP/1.1" 200 235
2024-06-12 21:54:53:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 21:54:54:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 21:54:54:INFO:test samples: (686,)
2024-06-12 21:54:54:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 21:54:55:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718200495 HTTP/1.1" 200 235
2024-06-12 21:54:55:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 21:54:55:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 21:54:56:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 21:54:56:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718200496 HTTP/1.1" 200 235
2024-06-12 21:54:56:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 21:54:57:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 21:54:57:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-12 21:54:57:WARNING:Try importing flash-attention for faster inference...
2024-06-12 21:54:57:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-12 21:54:57:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-12 21:54:57:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-12 21:54:58:INFO:trainable params: 1310280 || all params: 1838138952 || trainable%: 0.07128296794833386
2024-06-12 21:54:58:INFO:Init labels...
2024-06-12 21:54:58:INFO:Start training...
2024-06-12 21:55:13:INFO:TRAIN-(cmcm) (1/1/2)>> loss: 4.1235
2024-06-12 21:55:15:INFO:VAL-(cmcm) >>
2024-06-12 21:55:15:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4259  Non0_F1_score: 0.2544  Mult_acc_5: 0.2140  Mult_acc_7: 0.2140  MAE: 1.4370  Corr: nan 
2024-06-12 21:55:16:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-12 21:55:31:INFO:TRAIN-(cmcm) (1/2/2)>> loss: 1.9472
2024-06-12 21:55:33:INFO:VAL-(cmcm) >>
2024-06-12 21:55:33:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.5383  Non0_acc_2: 0.5972  Non0_F1_score: 0.5332  Mult_acc_5: 0.2882  Mult_acc_7: 0.2140  MAE: 1.6245  Corr: 0.1036 
2024-06-12 21:55:48:INFO:TRAIN-(cmcm) (2/3/2)>> loss: 0.9879
2024-06-12 21:55:51:INFO:VAL-(cmcm) >>
2024-06-12 21:55:51:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4630  Non0_acc_2: 0.5741  Non0_F1_score: 0.4346  Mult_acc_5: 0.1703  Mult_acc_7: 0.1703  MAE: 1.5296  Corr: 0.0692 
2024-06-12 21:56:05:INFO:TRAIN-(cmcm) (3/4/2)>> loss: 0.9311
2024-06-12 21:56:08:INFO:VAL-(cmcm) >>
2024-06-12 21:56:08:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.5785  Non0_acc_2: 0.5972  Non0_F1_score: 0.5704  Mult_acc_5: 0.2838  Mult_acc_7: 0.2140  MAE: 1.6027  Corr: 0.1151 
2024-06-12 21:56:22:INFO:TRAIN-(cmcm) (4/5/2)>> loss: 0.9274
2024-06-12 21:56:25:INFO:VAL-(cmcm) >>
2024-06-12 21:56:25:INFO:M: >>  Has0_acc_2: 0.5415  Has0_F1_score: 0.5433  Non0_acc_2: 0.5417  Non0_F1_score: 0.5413  Mult_acc_5: 0.1659  Mult_acc_7: 0.1659  MAE: 1.6095  Corr: 0.0272 
2024-06-12 21:56:40:INFO:TRAIN-(cmcm) (5/6/2)>> loss: 0.9131
2024-06-12 21:56:43:INFO:VAL-(cmcm) >>
2024-06-12 21:56:43:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.5899  Non0_acc_2: 0.6019  Non0_F1_score: 0.5880  Mult_acc_5: 0.2052  Mult_acc_7: 0.2052  MAE: 1.4931  Corr: 0.1136 
2024-06-12 21:56:57:INFO:TRAIN-(cmcm) (6/7/2)>> loss: 0.9007
2024-06-12 21:57:00:INFO:VAL-(cmcm) >>
2024-06-12 21:57:00:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5724  Non0_acc_2: 0.5787  Non0_F1_score: 0.5680  Mult_acc_5: 0.1878  Mult_acc_7: 0.1528  MAE: 1.5864  Corr: 0.0606 
2024-06-12 21:57:15:INFO:TRAIN-(cmcm) (7/8/2)>> loss: 0.8849
2024-06-12 21:57:17:INFO:VAL-(cmcm) >>
2024-06-12 21:57:17:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.5002  Non0_acc_2: 0.5880  Non0_F1_score: 0.4767  Mult_acc_5: 0.2227  Mult_acc_7: 0.1965  MAE: 1.5101  Corr: 0.1172 
2024-06-12 21:57:32:INFO:TRAIN-(cmcm) (8/9/2)>> loss: 0.8791
2024-06-12 21:57:34:INFO:VAL-(cmcm) >>
2024-06-12 21:57:34:INFO:M: >>  Has0_acc_2: 0.6288  Has0_F1_score: 0.5838  Non0_acc_2: 0.6204  Non0_F1_score: 0.5723  Mult_acc_5: 0.3275  Mult_acc_7: 0.2489  MAE: 1.6883  Corr: 0.1427 
2024-06-12 21:57:49:INFO:TRAIN-(cmcm) (9/10/2)>> loss: 0.8717
2024-06-12 21:57:52:INFO:VAL-(cmcm) >>
2024-06-12 21:57:52:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5042  Non0_acc_2: 0.5602  Non0_F1_score: 0.4810  Mult_acc_5: 0.2795  Mult_acc_7: 0.2052  MAE: 1.7407  Corr: 0.0214 
2024-06-12 21:58:06:INFO:TRAIN-(cmcm) (10/11/2)>> loss: 0.8749
2024-06-12 21:58:09:INFO:VAL-(cmcm) >>
2024-06-12 21:58:09:INFO:M: >>  Has0_acc_2: 0.6201  Has0_F1_score: 0.5854  Non0_acc_2: 0.6065  Non0_F1_score: 0.5703  Mult_acc_5: 0.2664  Mult_acc_7: 0.2052  MAE: 1.5717  Corr: 0.1179 
2024-06-12 21:58:16:INFO:TEST-(cmcm) >>
2024-06-12 21:58:16:INFO:M: >>  Has0_acc_2: 0.4475  Has0_F1_score: 0.2767  Non0_acc_2: 0.5777  Non0_F1_score: 0.4231  Mult_acc_5: 0.1545  Mult_acc_7: 0.1545  MAE: 1.4174  Corr: nan 
2024-06-12 21:58:16:INFO:Results are added to results/results/mosi-regression-60.csv...
2024-06-12 21:58:16:INFO:Start running cmcm...
2024-06-12 21:58:16:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [0], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 2, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 60, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 3333}>
2024-06-12 21:58:16:INFO:Let's use the GPU 0 !
2024-06-12 21:58:16:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 21:58:17:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718200697 HTTP/1.1" 200 235
2024-06-12 21:58:17:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 21:58:17:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 21:58:18:INFO:train samples: (1284,)
2024-06-12 21:58:18:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 21:58:18:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718200698 HTTP/1.1" 200 235
2024-06-12 21:58:18:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 21:58:19:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 21:58:19:INFO:valid samples: (229,)
2024-06-12 21:58:19:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 21:58:20:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718200700 HTTP/1.1" 200 235
2024-06-12 21:58:20:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 21:58:21:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 21:58:21:INFO:test samples: (686,)
2024-06-12 21:58:21:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 21:58:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718200702 HTTP/1.1" 200 235
2024-06-12 21:58:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 21:58:23:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 21:58:23:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 21:58:23:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718200704 HTTP/1.1" 200 235
2024-06-12 21:58:24:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 21:58:24:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 21:58:24:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-12 21:58:24:WARNING:Try importing flash-attention for faster inference...
2024-06-12 21:58:24:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-12 21:58:24:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-12 21:58:24:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-12 21:58:25:INFO:trainable params: 1310280 || all params: 1838138952 || trainable%: 0.07128296794833386
2024-06-12 21:58:25:INFO:Init labels...
2024-06-12 21:58:25:INFO:Start training...
2024-06-12 21:58:40:INFO:TRAIN-(cmcm) (1/1/3)>> loss: 4.0685
2024-06-12 21:58:43:INFO:VAL-(cmcm) >>
2024-06-12 21:58:43:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4213  Non0_F1_score: 0.2604  Mult_acc_5: 0.2096  Mult_acc_7: 0.2096  MAE: 1.4729  Corr: -0.0822 
2024-06-12 21:58:43:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-12 21:58:58:INFO:TRAIN-(cmcm) (1/2/3)>> loss: 1.8966
2024-06-12 21:59:01:INFO:VAL-(cmcm) >>
2024-06-12 21:59:01:INFO:M: >>  Has0_acc_2: 0.5066  Has0_F1_score: 0.5061  Non0_acc_2: 0.5000  Non0_F1_score: 0.4975  Mult_acc_5: 0.2489  Mult_acc_7: 0.1790  MAE: 1.7918  Corr: -0.0416 
2024-06-12 21:59:16:INFO:TRAIN-(cmcm) (2/3/3)>> loss: 0.9928
2024-06-12 21:59:18:INFO:VAL-(cmcm) >>
2024-06-12 21:59:18:INFO:M: >>  Has0_acc_2: 0.5371  Has0_F1_score: 0.5416  Non0_acc_2: 0.5463  Non0_F1_score: 0.5488  Mult_acc_5: 0.2183  Mult_acc_7: 0.1834  MAE: 1.6170  Corr: 0.0654 
2024-06-12 21:59:33:INFO:TRAIN-(cmcm) (3/4/3)>> loss: 0.9180
2024-06-12 21:59:36:INFO:VAL-(cmcm) >>
2024-06-12 21:59:36:INFO:M: >>  Has0_acc_2: 0.5328  Has0_F1_score: 0.5373  Non0_acc_2: 0.5463  Non0_F1_score: 0.5488  Mult_acc_5: 0.1878  Mult_acc_7: 0.1528  MAE: 1.6761  Corr: 0.0762 
2024-06-12 21:59:50:INFO:TRAIN-(cmcm) (4/5/3)>> loss: 0.8964
2024-06-12 21:59:53:INFO:VAL-(cmcm) >>
2024-06-12 21:59:53:INFO:M: >>  Has0_acc_2: 0.4061  Has0_F1_score: 0.2397  Non0_acc_2: 0.4306  Non0_F1_score: 0.2645  Mult_acc_5: 0.1397  Mult_acc_7: 0.1397  MAE: 1.9855  Corr: 0.0180 
2024-06-12 22:00:08:INFO:TRAIN-(cmcm) (5/6/3)>> loss: 0.8877
2024-06-12 22:00:10:INFO:VAL-(cmcm) >>
2024-06-12 22:00:10:INFO:M: >>  Has0_acc_2: 0.5633  Has0_F1_score: 0.4926  Non0_acc_2: 0.5417  Non0_F1_score: 0.4733  Mult_acc_5: 0.2664  Mult_acc_7: 0.1965  MAE: 1.8079  Corr: -0.0345 
2024-06-12 22:00:25:INFO:TRAIN-(cmcm) (6/7/3)>> loss: 0.8757
2024-06-12 22:00:28:INFO:VAL-(cmcm) >>
2024-06-12 22:00:28:INFO:M: >>  Has0_acc_2: 0.5415  Has0_F1_score: 0.5459  Non0_acc_2: 0.5509  Non0_F1_score: 0.5532  Mult_acc_5: 0.2271  Mult_acc_7: 0.1528  MAE: 1.8280  Corr: 0.0719 
2024-06-12 22:00:42:INFO:TRAIN-(cmcm) (7/8/3)>> loss: 0.8746
2024-06-12 22:00:45:INFO:VAL-(cmcm) >>
2024-06-12 22:00:45:INFO:M: >>  Has0_acc_2: 0.5546  Has0_F1_score: 0.5538  Non0_acc_2: 0.5509  Non0_F1_score: 0.5482  Mult_acc_5: 0.2314  Mult_acc_7: 0.1747  MAE: 1.7931  Corr: 0.0234 
2024-06-12 22:01:00:INFO:TRAIN-(cmcm) (8/9/3)>> loss: 0.8702
2024-06-12 22:01:02:INFO:VAL-(cmcm) >>
2024-06-12 22:01:02:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5031  Non0_acc_2: 0.5370  Non0_F1_score: 0.4895  Mult_acc_5: 0.2314  Mult_acc_7: 0.1965  MAE: 1.5327  Corr: -0.0190 
2024-06-12 22:01:17:INFO:TRAIN-(cmcm) (9/10/3)>> loss: 0.8606
2024-06-12 22:01:20:INFO:VAL-(cmcm) >>
2024-06-12 22:01:20:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.4943  Non0_acc_2: 0.5833  Non0_F1_score: 0.4676  Mult_acc_5: 0.2795  Mult_acc_7: 0.2052  MAE: 1.6664  Corr: 0.0459 
2024-06-12 22:01:34:INFO:TRAIN-(cmcm) (10/11/3)>> loss: 0.8614
2024-06-12 22:01:37:INFO:VAL-(cmcm) >>
2024-06-12 22:01:37:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.5234  Non0_acc_2: 0.5833  Non0_F1_score: 0.5013  Mult_acc_5: 0.2358  Mult_acc_7: 0.2227  MAE: 1.5366  Corr: -0.0148 
2024-06-12 22:01:44:INFO:TEST-(cmcm) >>
2024-06-12 22:01:44:INFO:M: >>  Has0_acc_2: 0.4475  Has0_F1_score: 0.2767  Non0_acc_2: 0.5777  Non0_F1_score: 0.4285  Mult_acc_5: 0.1545  Mult_acc_7: 0.1545  MAE: 1.4279  Corr: -0.0040 
2024-06-12 22:01:45:INFO:Results are added to results/results/mosi-regression-60.csv...
2024-06-12 22:01:45:INFO:Start running cmcm...
2024-06-12 22:01:45:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [0], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 2, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 60, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 4444}>
2024-06-12 22:01:45:INFO:Let's use the GPU 0 !
2024-06-12 22:01:45:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 22:01:45:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718200905 HTTP/1.1" 200 235
2024-06-12 22:01:46:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 22:01:46:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 22:01:47:INFO:train samples: (1284,)
2024-06-12 22:01:47:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 22:01:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718200907 HTTP/1.1" 200 235
2024-06-12 22:01:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 22:01:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 22:01:48:INFO:valid samples: (229,)
2024-06-12 22:01:48:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 22:01:49:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718200909 HTTP/1.1" 200 235
2024-06-12 22:01:49:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 22:01:49:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 22:01:50:INFO:test samples: (686,)
2024-06-12 22:01:50:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 22:01:50:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718200910 HTTP/1.1" 200 235
2024-06-12 22:01:50:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 22:01:51:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 22:01:51:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 22:01:51:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718200912 HTTP/1.1" 200 235
2024-06-12 22:01:52:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 22:01:52:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 22:01:52:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-12 22:01:52:WARNING:Try importing flash-attention for faster inference...
2024-06-12 22:01:52:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-12 22:01:52:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-12 22:01:52:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-12 22:01:53:INFO:trainable params: 1310280 || all params: 1838138952 || trainable%: 0.07128296794833386
2024-06-12 22:01:53:INFO:Init labels...
2024-06-12 22:01:53:INFO:Start training...
2024-06-12 22:02:08:INFO:TRAIN-(cmcm) (1/1/4)>> loss: 4.3785
2024-06-12 22:02:11:INFO:VAL-(cmcm) >>
2024-06-12 22:02:11:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4259  Non0_F1_score: 0.2544  Mult_acc_5: 0.2140  Mult_acc_7: 0.2140  MAE: 1.4370  Corr: nan 
2024-06-12 22:02:11:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-12 22:02:27:INFO:TRAIN-(cmcm) (1/2/4)>> loss: 3.9785
2024-06-12 22:02:29:INFO:VAL-(cmcm) >>
2024-06-12 22:02:29:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4537  Non0_F1_score: 0.3382  Mult_acc_5: 0.2052  Mult_acc_7: 0.1921  MAE: 1.5324  Corr: 0.0058 
2024-06-12 22:02:44:INFO:TRAIN-(cmcm) (2/3/4)>> loss: 1.5871
2024-06-12 22:02:46:INFO:VAL-(cmcm) >>
2024-06-12 22:02:46:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5606  Non0_acc_2: 0.5880  Non0_F1_score: 0.5671  Mult_acc_5: 0.1616  Mult_acc_7: 0.1616  MAE: 1.6143  Corr: 0.0456 
2024-06-12 22:03:01:INFO:TRAIN-(cmcm) (3/4/4)>> loss: 0.9804
2024-06-12 22:03:04:INFO:VAL-(cmcm) >>
2024-06-12 22:03:04:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.5699  Non0_acc_2: 0.5833  Non0_F1_score: 0.5688  Mult_acc_5: 0.2838  Mult_acc_7: 0.2052  MAE: 1.5761  Corr: 0.1244 
2024-06-12 22:03:19:INFO:TRAIN-(cmcm) (4/5/4)>> loss: 0.9354
2024-06-12 22:03:21:INFO:VAL-(cmcm) >>
2024-06-12 22:03:21:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5742  Non0_acc_2: 0.5880  Non0_F1_score: 0.5887  Mult_acc_5: 0.2183  Mult_acc_7: 0.2052  MAE: 1.4961  Corr: 0.2274 
2024-06-12 22:03:36:INFO:TRAIN-(cmcm) (5/6/4)>> loss: 0.9042
2024-06-12 22:03:39:INFO:VAL-(cmcm) >>
2024-06-12 22:03:39:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5370  Non0_F1_score: 0.4895  Mult_acc_5: 0.2314  Mult_acc_7: 0.2140  MAE: 1.4873  Corr: 0.0377 
2024-06-12 22:03:53:INFO:TRAIN-(cmcm) (6/7/4)>> loss: 0.8962
2024-06-12 22:03:56:INFO:VAL-(cmcm) >>
2024-06-12 22:03:56:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.5739  Non0_acc_2: 0.6019  Non0_F1_score: 0.5718  Mult_acc_5: 0.3188  Mult_acc_7: 0.2402  MAE: 1.5215  Corr: 0.1870 
2024-06-12 22:04:11:INFO:TRAIN-(cmcm) (7/8/4)>> loss: 0.8913
2024-06-12 22:04:13:INFO:VAL-(cmcm) >>
2024-06-12 22:04:13:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.4438  Non0_acc_2: 0.5602  Non0_F1_score: 0.4540  Mult_acc_5: 0.2140  Mult_acc_7: 0.1616  MAE: 1.6346  Corr: -0.0855 
2024-06-12 22:04:28:INFO:TRAIN-(cmcm) (8/9/4)>> loss: 0.8844
2024-06-12 22:04:31:INFO:VAL-(cmcm) >>
2024-06-12 22:04:31:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5930  Non0_acc_2: 0.5972  Non0_F1_score: 0.5988  Mult_acc_5: 0.1878  Mult_acc_7: 0.1616  MAE: 1.5656  Corr: 0.1817 
2024-06-12 22:04:46:INFO:TRAIN-(cmcm) (9/10/4)>> loss: 0.8733
2024-06-12 22:04:48:INFO:VAL-(cmcm) >>
2024-06-12 22:04:48:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5477  Non0_acc_2: 0.5602  Non0_F1_score: 0.5532  Mult_acc_5: 0.2271  Mult_acc_7: 0.1878  MAE: 1.5471  Corr: 0.0480 
2024-06-12 22:05:03:INFO:TRAIN-(cmcm) (10/11/4)>> loss: 0.8668
2024-06-12 22:05:05:INFO:VAL-(cmcm) >>
2024-06-12 22:05:05:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4652  Non0_acc_2: 0.5741  Non0_F1_score: 0.4420  Mult_acc_5: 0.2707  Mult_acc_7: 0.2183  MAE: 1.6807  Corr: -0.0302 
2024-06-12 22:05:13:INFO:TEST-(cmcm) >>
2024-06-12 22:05:13:INFO:M: >>  Has0_acc_2: 0.4475  Has0_F1_score: 0.2767  Non0_acc_2: 0.5777  Non0_F1_score: 0.4231  Mult_acc_5: 0.1545  Mult_acc_7: 0.1545  MAE: 1.4174  Corr: nan 
2024-06-12 22:05:13:INFO:Results are added to results/results/mosi-regression-60.csv...
2024-06-12 22:05:13:INFO:Start running cmcm...
2024-06-12 22:05:13:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [0], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 2, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 60, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 5555}>
2024-06-12 22:05:13:INFO:Let's use the GPU 0 !
2024-06-12 22:05:13:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 22:05:13:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718201114 HTTP/1.1" 200 235
2024-06-12 22:05:14:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 22:05:14:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 22:05:15:INFO:train samples: (1284,)
2024-06-12 22:05:15:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 22:05:15:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718201115 HTTP/1.1" 200 235
2024-06-12 22:05:15:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 22:05:16:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 22:05:16:INFO:valid samples: (229,)
2024-06-12 22:05:16:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 22:05:17:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718201117 HTTP/1.1" 200 235
2024-06-12 22:05:17:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 22:05:17:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 22:05:18:INFO:test samples: (686,)
2024-06-12 22:05:18:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 22:05:18:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718201118 HTTP/1.1" 200 235
2024-06-12 22:05:18:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 22:05:19:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 22:05:19:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 22:05:20:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718201120 HTTP/1.1" 200 235
2024-06-12 22:05:20:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 22:05:20:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 22:05:20:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-12 22:05:20:WARNING:Try importing flash-attention for faster inference...
2024-06-12 22:05:20:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-12 22:05:20:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-12 22:05:20:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-12 22:05:22:INFO:trainable params: 1310280 || all params: 1838138952 || trainable%: 0.07128296794833386
2024-06-12 22:05:22:INFO:Init labels...
2024-06-12 22:05:22:INFO:Start training...
2024-06-12 22:05:36:INFO:TRAIN-(cmcm) (1/1/5)>> loss: 3.3464
2024-06-12 22:05:39:INFO:VAL-(cmcm) >>
2024-06-12 22:05:39:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.5623  Non0_acc_2: 0.5602  Non0_F1_score: 0.5610  Mult_acc_5: 0.1921  Mult_acc_7: 0.1921  MAE: 1.4733  Corr: -0.0036 
2024-06-12 22:05:40:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-12 22:05:55:INFO:TRAIN-(cmcm) (1/2/5)>> loss: 1.0638
2024-06-12 22:05:57:INFO:VAL-(cmcm) >>
2024-06-12 22:05:57:INFO:M: >>  Has0_acc_2: 0.5240  Has0_F1_score: 0.5279  Non0_acc_2: 0.5185  Non0_F1_score: 0.5205  Mult_acc_5: 0.1790  Mult_acc_7: 0.1703  MAE: 1.7149  Corr: 0.0280 
2024-06-12 22:06:12:INFO:TRAIN-(cmcm) (2/3/5)>> loss: 0.9214
2024-06-12 22:06:15:INFO:VAL-(cmcm) >>
2024-06-12 22:06:15:INFO:M: >>  Has0_acc_2: 0.5633  Has0_F1_score: 0.5155  Non0_acc_2: 0.5509  Non0_F1_score: 0.4996  Mult_acc_5: 0.2271  Mult_acc_7: 0.1616  MAE: 1.7175  Corr: -0.0219 
2024-06-12 22:06:29:INFO:TRAIN-(cmcm) (3/4/5)>> loss: 0.8909
2024-06-12 22:06:32:INFO:VAL-(cmcm) >>
2024-06-12 22:06:32:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4891  Non0_acc_2: 0.5787  Non0_F1_score: 0.4827  Mult_acc_5: 0.1659  Mult_acc_7: 0.1659  MAE: 1.4781  Corr: 0.0068 
2024-06-12 22:06:47:INFO:TRAIN-(cmcm) (4/5/5)>> loss: 0.8863
2024-06-12 22:06:49:INFO:VAL-(cmcm) >>
2024-06-12 22:06:49:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4830  Non0_acc_2: 0.5787  Non0_F1_score: 0.4649  Mult_acc_5: 0.2445  Mult_acc_7: 0.2140  MAE: 1.6475  Corr: 0.0333 
2024-06-12 22:07:04:INFO:TRAIN-(cmcm) (5/6/5)>> loss: 0.8812
2024-06-12 22:07:07:INFO:VAL-(cmcm) >>
2024-06-12 22:07:07:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5315  Non0_acc_2: 0.5648  Non0_F1_score: 0.5201  Mult_acc_5: 0.2183  Mult_acc_7: 0.1965  MAE: 1.6759  Corr: 0.0459 
2024-06-12 22:07:22:INFO:TRAIN-(cmcm) (6/7/5)>> loss: 0.8691
2024-06-12 22:07:24:INFO:VAL-(cmcm) >>
2024-06-12 22:07:24:INFO:M: >>  Has0_acc_2: 0.5197  Has0_F1_score: 0.5221  Non0_acc_2: 0.5324  Non0_F1_score: 0.5333  Mult_acc_5: 0.2489  Mult_acc_7: 0.2052  MAE: 1.6554  Corr: 0.0490 
2024-06-12 22:07:39:INFO:TRAIN-(cmcm) (7/8/5)>> loss: 0.8660
2024-06-12 22:07:41:INFO:VAL-(cmcm) >>
2024-06-12 22:07:41:INFO:M: >>  Has0_acc_2: 0.5590  Has0_F1_score: 0.5593  Non0_acc_2: 0.5694  Non0_F1_score: 0.5668  Mult_acc_5: 0.1878  Mult_acc_7: 0.1703  MAE: 1.7069  Corr: 0.0998 
2024-06-12 22:07:56:INFO:TRAIN-(cmcm) (8/9/5)>> loss: 0.8682
2024-06-12 22:07:59:INFO:VAL-(cmcm) >>
2024-06-12 22:07:59:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5129  Non0_acc_2: 0.5694  Non0_F1_score: 0.4871  Mult_acc_5: 0.2402  Mult_acc_7: 0.1965  MAE: 1.6458  Corr: 0.0208 
2024-06-12 22:08:14:INFO:TRAIN-(cmcm) (9/10/5)>> loss: 0.8705
2024-06-12 22:08:16:INFO:VAL-(cmcm) >>
2024-06-12 22:08:16:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5031  Non0_acc_2: 0.5648  Non0_F1_score: 0.4739  Mult_acc_5: 0.2926  Mult_acc_7: 0.2140  MAE: 1.7267  Corr: -0.0149 
2024-06-12 22:08:31:INFO:TRAIN-(cmcm) (10/11/5)>> loss: 0.8618
2024-06-12 22:08:33:INFO:VAL-(cmcm) >>
2024-06-12 22:08:33:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.4718  Non0_acc_2: 0.5741  Non0_F1_score: 0.4558  Mult_acc_5: 0.2052  Mult_acc_7: 0.1921  MAE: 1.5807  Corr: 0.0054 
2024-06-12 22:08:41:INFO:TEST-(cmcm) >>
2024-06-12 22:08:41:INFO:M: >>  Has0_acc_2: 0.4985  Has0_F1_score: 0.4968  Non0_acc_2: 0.5229  Non0_F1_score: 0.5257  Mult_acc_5: 0.1676  Mult_acc_7: 0.1676  MAE: 1.4801  Corr: -0.0360 
2024-06-12 22:08:41:INFO:Results are added to results/results/mosi-regression-60.csv...
2024-06-12 22:08:41:INFO:Start running cmcm...
2024-06-12 22:08:41:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [0], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 2, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 70, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-06-12 22:08:41:INFO:Let's use the GPU 0 !
2024-06-12 22:08:41:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 22:08:42:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718201322 HTTP/1.1" 200 235
2024-06-12 22:08:42:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 22:08:42:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 22:08:43:INFO:train samples: (1284,)
2024-06-12 22:08:43:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 22:08:43:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718201323 HTTP/1.1" 200 235
2024-06-12 22:08:44:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 22:08:44:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 22:08:44:INFO:valid samples: (229,)
2024-06-12 22:08:45:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 22:08:45:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718201325 HTTP/1.1" 200 235
2024-06-12 22:08:45:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 22:08:46:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 22:08:46:INFO:test samples: (686,)
2024-06-12 22:08:46:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 22:08:46:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718201327 HTTP/1.1" 200 235
2024-06-12 22:08:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 22:08:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 22:08:47:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 22:08:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718201328 HTTP/1.1" 200 235
2024-06-12 22:08:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 22:08:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 22:08:48:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-12 22:08:48:WARNING:Try importing flash-attention for faster inference...
2024-06-12 22:08:48:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-12 22:08:48:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-12 22:08:48:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-12 22:08:50:INFO:trainable params: 1310280 || all params: 1838138952 || trainable%: 0.07128296794833386
2024-06-12 22:08:50:INFO:Init labels...
2024-06-12 22:08:50:INFO:Start training...
2024-06-12 22:09:04:INFO:TRAIN-(cmcm) (1/1/1)>> loss: 4.1271
2024-06-12 22:09:07:INFO:VAL-(cmcm) >>
2024-06-12 22:09:07:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4259  Non0_F1_score: 0.2544  Mult_acc_5: 0.2140  Mult_acc_7: 0.2140  MAE: 1.4370  Corr: nan 
2024-06-12 22:09:08:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-12 22:09:23:INFO:TRAIN-(cmcm) (1/2/1)>> loss: 1.9671
2024-06-12 22:09:25:INFO:VAL-(cmcm) >>
2024-06-12 22:09:25:INFO:M: >>  Has0_acc_2: 0.5328  Has0_F1_score: 0.5365  Non0_acc_2: 0.5556  Non0_F1_score: 0.5580  Mult_acc_5: 0.2358  Mult_acc_7: 0.2096  MAE: 1.5798  Corr: 0.0344 
2024-06-12 22:09:40:INFO:TRAIN-(cmcm) (2/3/1)>> loss: 0.9838
2024-06-12 22:09:42:INFO:VAL-(cmcm) >>
2024-06-12 22:09:42:INFO:M: >>  Has0_acc_2: 0.5546  Has0_F1_score: 0.4733  Non0_acc_2: 0.5324  Non0_F1_score: 0.4483  Mult_acc_5: 0.2489  Mult_acc_7: 0.1703  MAE: 1.6900  Corr: -0.0204 
2024-06-12 22:09:57:INFO:TRAIN-(cmcm) (3/4/1)>> loss: 0.9137
2024-06-12 22:10:00:INFO:VAL-(cmcm) >>
2024-06-12 22:10:00:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4556  Non0_acc_2: 0.5741  Non0_F1_score: 0.4269  Mult_acc_5: 0.2707  Mult_acc_7: 0.1965  MAE: 1.7136  Corr: -0.0635 
2024-06-12 22:10:15:INFO:TRAIN-(cmcm) (4/5/1)>> loss: 0.9081
2024-06-12 22:10:17:INFO:VAL-(cmcm) >>
2024-06-12 22:10:17:INFO:M: >>  Has0_acc_2: 0.4934  Has0_F1_score: 0.4609  Non0_acc_2: 0.4861  Non0_F1_score: 0.4333  Mult_acc_5: 0.2052  Mult_acc_7: 0.1965  MAE: 1.5279  Corr: 0.1120 
2024-06-12 22:10:32:INFO:TRAIN-(cmcm) (5/6/1)>> loss: 0.8941
2024-06-12 22:10:34:INFO:VAL-(cmcm) >>
2024-06-12 22:10:34:INFO:M: >>  Has0_acc_2: 0.5153  Has0_F1_score: 0.5076  Non0_acc_2: 0.5278  Non0_F1_score: 0.5186  Mult_acc_5: 0.2358  Mult_acc_7: 0.1878  MAE: 1.6912  Corr: 0.0762 
2024-06-12 22:10:49:INFO:TRAIN-(cmcm) (6/7/1)>> loss: 0.8902
2024-06-12 22:10:52:INFO:VAL-(cmcm) >>
2024-06-12 22:10:52:INFO:M: >>  Has0_acc_2: 0.5153  Has0_F1_score: 0.5199  Non0_acc_2: 0.5231  Non0_F1_score: 0.5258  Mult_acc_5: 0.2445  Mult_acc_7: 0.1790  MAE: 1.8346  Corr: 0.0473 
2024-06-12 22:11:07:INFO:TRAIN-(cmcm) (7/8/1)>> loss: 0.8764
2024-06-12 22:11:09:INFO:VAL-(cmcm) >>
2024-06-12 22:11:09:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4534  Non0_acc_2: 0.5741  Non0_F1_score: 0.4420  Mult_acc_5: 0.2358  Mult_acc_7: 0.2052  MAE: 1.5925  Corr: 0.0524 
2024-06-12 22:11:24:INFO:TRAIN-(cmcm) (8/9/1)>> loss: 0.8723
2024-06-12 22:11:26:INFO:VAL-(cmcm) >>
2024-06-12 22:11:26:INFO:M: >>  Has0_acc_2: 0.5633  Has0_F1_score: 0.5463  Non0_acc_2: 0.5463  Non0_F1_score: 0.5409  Mult_acc_5: 0.1878  Mult_acc_7: 0.1790  MAE: 1.5643  Corr: 0.0215 
2024-06-12 22:11:41:INFO:TRAIN-(cmcm) (9/10/1)>> loss: 0.8654
2024-06-12 22:11:44:INFO:VAL-(cmcm) >>
2024-06-12 22:11:44:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.4705  Non0_acc_2: 0.5556  Non0_F1_score: 0.4780  Mult_acc_5: 0.2664  Mult_acc_7: 0.1878  MAE: 1.7175  Corr: 0.0101 
2024-06-12 22:11:58:INFO:TRAIN-(cmcm) (10/11/1)>> loss: 0.8625
2024-06-12 22:12:01:INFO:VAL-(cmcm) >>
2024-06-12 22:12:01:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.5890  Non0_acc_2: 0.5880  Non0_F1_score: 0.5900  Mult_acc_5: 0.2707  Mult_acc_7: 0.1921  MAE: 1.6835  Corr: 0.1318 
2024-06-12 22:12:08:INFO:TEST-(cmcm) >>
2024-06-12 22:12:08:INFO:M: >>  Has0_acc_2: 0.4475  Has0_F1_score: 0.2767  Non0_acc_2: 0.5808  Non0_F1_score: 0.4300  Mult_acc_5: 0.1531  Mult_acc_7: 0.1531  MAE: 1.4232  Corr: 0.0278 
2024-06-12 22:12:09:INFO:Results are added to results/results/mosi-regression-70.csv...
2024-06-12 22:12:09:INFO:Start running cmcm...
2024-06-12 22:12:09:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [0], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 2, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 70, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 2222}>
2024-06-12 22:12:09:INFO:Let's use the GPU 0 !
2024-06-12 22:12:09:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 22:12:09:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718201529 HTTP/1.1" 200 235
2024-06-12 22:12:09:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 22:12:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 22:12:10:INFO:train samples: (1284,)
2024-06-12 22:12:10:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 22:12:11:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718201531 HTTP/1.1" 200 235
2024-06-12 22:12:11:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 22:12:11:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 22:12:12:INFO:valid samples: (229,)
2024-06-12 22:12:12:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 22:12:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718201532 HTTP/1.1" 200 235
2024-06-12 22:12:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 22:12:13:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 22:12:13:INFO:test samples: (686,)
2024-06-12 22:12:13:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 22:12:14:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718201534 HTTP/1.1" 200 235
2024-06-12 22:12:14:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 22:12:14:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 22:12:15:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 22:12:15:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718201535 HTTP/1.1" 200 235
2024-06-12 22:12:15:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 22:12:16:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 22:12:16:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-12 22:12:16:WARNING:Try importing flash-attention for faster inference...
2024-06-12 22:12:16:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-12 22:12:16:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-12 22:12:16:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-12 22:12:17:INFO:trainable params: 1310280 || all params: 1838138952 || trainable%: 0.07128296794833386
2024-06-12 22:12:17:INFO:Init labels...
2024-06-12 22:12:17:INFO:Start training...
2024-06-12 22:12:32:INFO:TRAIN-(cmcm) (1/1/2)>> loss: 4.1603
2024-06-12 22:12:34:INFO:VAL-(cmcm) >>
2024-06-12 22:12:34:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4259  Non0_F1_score: 0.2544  Mult_acc_5: 0.2140  Mult_acc_7: 0.2140  MAE: 1.4370  Corr: nan 
2024-06-12 22:12:35:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-12 22:12:50:INFO:TRAIN-(cmcm) (1/2/2)>> loss: 2.0723
2024-06-12 22:12:52:INFO:VAL-(cmcm) >>
2024-06-12 22:12:52:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5042  Non0_acc_2: 0.5556  Non0_F1_score: 0.5247  Mult_acc_5: 0.2620  Mult_acc_7: 0.2096  MAE: 1.6359  Corr: 0.0173 
2024-06-12 22:13:07:INFO:TRAIN-(cmcm) (2/3/2)>> loss: 1.0125
2024-06-12 22:13:10:INFO:VAL-(cmcm) >>
2024-06-12 22:13:10:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5704  Non0_acc_2: 0.5602  Non0_F1_score: 0.5592  Mult_acc_5: 0.2314  Mult_acc_7: 0.1834  MAE: 1.5538  Corr: 0.1068 
2024-06-12 22:13:25:INFO:TRAIN-(cmcm) (3/4/2)>> loss: 0.9392
2024-06-12 22:13:27:INFO:VAL-(cmcm) >>
2024-06-12 22:13:27:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.4653  Non0_acc_2: 0.5463  Non0_F1_score: 0.4671  Mult_acc_5: 0.1921  Mult_acc_7: 0.1659  MAE: 1.5183  Corr: -0.0080 
2024-06-12 22:13:42:INFO:TRAIN-(cmcm) (4/5/2)>> loss: 0.9305
2024-06-12 22:13:44:INFO:VAL-(cmcm) >>
2024-06-12 22:13:44:INFO:M: >>  Has0_acc_2: 0.6288  Has0_F1_score: 0.5669  Non0_acc_2: 0.6065  Non0_F1_score: 0.5439  Mult_acc_5: 0.2838  Mult_acc_7: 0.2358  MAE: 1.6621  Corr: 0.1027 
2024-06-12 22:13:59:INFO:TRAIN-(cmcm) (5/6/2)>> loss: 0.9183
2024-06-12 22:14:02:INFO:VAL-(cmcm) >>
2024-06-12 22:14:02:INFO:M: >>  Has0_acc_2: 0.4017  Has0_F1_score: 0.2839  Non0_acc_2: 0.4259  Non0_F1_score: 0.2847  Mult_acc_5: 0.1659  Mult_acc_7: 0.1485  MAE: 2.0139  Corr: -0.0429 
2024-06-12 22:14:17:INFO:TRAIN-(cmcm) (6/7/2)>> loss: 0.9087
2024-06-12 22:14:19:INFO:VAL-(cmcm) >>
2024-06-12 22:14:19:INFO:M: >>  Has0_acc_2: 0.5415  Has0_F1_score: 0.5452  Non0_acc_2: 0.5463  Non0_F1_score: 0.5485  Mult_acc_5: 0.2402  Mult_acc_7: 0.1921  MAE: 1.6331  Corr: 0.0903 
2024-06-12 22:14:34:INFO:TRAIN-(cmcm) (7/8/2)>> loss: 0.8864
2024-06-12 22:14:36:INFO:VAL-(cmcm) >>
2024-06-12 22:14:36:INFO:M: >>  Has0_acc_2: 0.5240  Has0_F1_score: 0.5232  Non0_acc_2: 0.5417  Non0_F1_score: 0.5398  Mult_acc_5: 0.2183  Mult_acc_7: 0.2009  MAE: 1.6340  Corr: 0.0917 
2024-06-12 22:14:51:INFO:TRAIN-(cmcm) (8/9/2)>> loss: 0.8775
2024-06-12 22:14:54:INFO:VAL-(cmcm) >>
2024-06-12 22:14:54:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5734  Non0_acc_2: 0.5880  Non0_F1_score: 0.5650  Mult_acc_5: 0.3057  Mult_acc_7: 0.2271  MAE: 1.6918  Corr: 0.1250 
2024-06-12 22:15:09:INFO:TRAIN-(cmcm) (9/10/2)>> loss: 0.8804
2024-06-12 22:15:11:INFO:VAL-(cmcm) >>
2024-06-12 22:15:11:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.5509  Non0_acc_2: 0.5972  Non0_F1_score: 0.5371  Mult_acc_5: 0.2969  Mult_acc_7: 0.2314  MAE: 1.6892  Corr: 0.0919 
2024-06-12 22:15:26:INFO:TRAIN-(cmcm) (10/11/2)>> loss: 0.8791
2024-06-12 22:15:28:INFO:VAL-(cmcm) >>
2024-06-12 22:15:28:INFO:M: >>  Has0_acc_2: 0.6332  Has0_F1_score: 0.6056  Non0_acc_2: 0.6204  Non0_F1_score: 0.5917  Mult_acc_5: 0.2620  Mult_acc_7: 0.2183  MAE: 1.5656  Corr: 0.1409 
2024-06-12 22:15:36:INFO:TEST-(cmcm) >>
2024-06-12 22:15:36:INFO:M: >>  Has0_acc_2: 0.4475  Has0_F1_score: 0.2767  Non0_acc_2: 0.5777  Non0_F1_score: 0.4231  Mult_acc_5: 0.1545  Mult_acc_7: 0.1545  MAE: 1.4174  Corr: nan 
2024-06-12 22:15:36:INFO:Results are added to results/results/mosi-regression-70.csv...
2024-06-12 22:15:36:INFO:Start running cmcm...
2024-06-12 22:15:36:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [0], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 2, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 70, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 3333}>
2024-06-12 22:15:36:INFO:Let's use the GPU 0 !
2024-06-12 22:15:36:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 22:15:36:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718201737 HTTP/1.1" 200 235
2024-06-12 22:15:37:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 22:15:37:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 22:15:38:INFO:train samples: (1284,)
2024-06-12 22:15:38:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 22:15:38:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718201738 HTTP/1.1" 200 235
2024-06-12 22:15:38:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 22:15:39:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 22:15:39:INFO:valid samples: (229,)
2024-06-12 22:15:39:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 22:15:40:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718201740 HTTP/1.1" 200 235
2024-06-12 22:15:40:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 22:15:41:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 22:15:41:INFO:test samples: (686,)
2024-06-12 22:15:41:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 22:15:41:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718201742 HTTP/1.1" 200 235
2024-06-12 22:15:42:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 22:15:42:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 22:15:42:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 22:15:43:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718201743 HTTP/1.1" 200 235
2024-06-12 22:15:43:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 22:15:43:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 22:15:43:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-12 22:15:43:WARNING:Try importing flash-attention for faster inference...
2024-06-12 22:15:43:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-12 22:15:43:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-12 22:15:43:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-12 22:15:45:INFO:trainable params: 1310280 || all params: 1838138952 || trainable%: 0.07128296794833386
2024-06-12 22:15:45:INFO:Init labels...
2024-06-12 22:15:45:INFO:Start training...
2024-06-12 22:15:59:INFO:TRAIN-(cmcm) (1/1/3)>> loss: 4.1101
2024-06-12 22:16:02:INFO:VAL-(cmcm) >>
2024-06-12 22:16:02:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4259  Non0_F1_score: 0.2544  Mult_acc_5: 0.2140  Mult_acc_7: 0.2140  MAE: 1.4370  Corr: nan 
2024-06-12 22:16:02:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-12 22:16:18:INFO:TRAIN-(cmcm) (1/2/3)>> loss: 2.0923
2024-06-12 22:16:20:INFO:VAL-(cmcm) >>
2024-06-12 22:16:20:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.5166  Non0_acc_2: 0.5880  Non0_F1_score: 0.5044  Mult_acc_5: 0.3057  Mult_acc_7: 0.2314  MAE: 1.6429  Corr: 0.0393 
2024-06-12 22:16:35:INFO:TRAIN-(cmcm) (2/3/3)>> loss: 0.9879
2024-06-12 22:16:37:INFO:VAL-(cmcm) >>
2024-06-12 22:16:37:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.5249  Non0_acc_2: 0.5787  Non0_F1_score: 0.5029  Mult_acc_5: 0.2533  Mult_acc_7: 0.1878  MAE: 1.5717  Corr: 0.0764 
2024-06-12 22:16:52:INFO:TRAIN-(cmcm) (3/4/3)>> loss: 0.9328
2024-06-12 22:16:55:INFO:VAL-(cmcm) >>
2024-06-12 22:16:55:INFO:M: >>  Has0_acc_2: 0.5284  Has0_F1_score: 0.5311  Non0_acc_2: 0.5324  Non0_F1_score: 0.5327  Mult_acc_5: 0.2402  Mult_acc_7: 0.1834  MAE: 1.6878  Corr: 0.0108 
2024-06-12 22:17:10:INFO:TRAIN-(cmcm) (4/5/3)>> loss: 0.9031
2024-06-12 22:17:12:INFO:VAL-(cmcm) >>
2024-06-12 22:17:12:INFO:M: >>  Has0_acc_2: 0.6201  Has0_F1_score: 0.5970  Non0_acc_2: 0.6111  Non0_F1_score: 0.5905  Mult_acc_5: 0.1878  Mult_acc_7: 0.1659  MAE: 1.5044  Corr: 0.1450 
2024-06-12 22:17:27:INFO:TRAIN-(cmcm) (5/6/3)>> loss: 0.8891
2024-06-12 22:17:29:INFO:VAL-(cmcm) >>
2024-06-12 22:17:29:INFO:M: >>  Has0_acc_2: 0.5590  Has0_F1_score: 0.5600  Non0_acc_2: 0.5648  Non0_F1_score: 0.5634  Mult_acc_5: 0.2445  Mult_acc_7: 0.1790  MAE: 1.5800  Corr: 0.1508 
2024-06-12 22:17:44:INFO:TRAIN-(cmcm) (6/7/3)>> loss: 0.8756
2024-06-12 22:17:47:INFO:VAL-(cmcm) >>
2024-06-12 22:17:47:INFO:M: >>  Has0_acc_2: 0.4803  Has0_F1_score: 0.4690  Non0_acc_2: 0.4954  Non0_F1_score: 0.4832  Mult_acc_5: 0.1965  Mult_acc_7: 0.1441  MAE: 1.9813  Corr: 0.0513 
2024-06-12 22:18:02:INFO:TRAIN-(cmcm) (7/8/3)>> loss: 0.8705
2024-06-12 22:18:04:INFO:VAL-(cmcm) >>
2024-06-12 22:18:04:INFO:M: >>  Has0_acc_2: 0.5502  Has0_F1_score: 0.5204  Non0_acc_2: 0.5046  Non0_F1_score: 0.4968  Mult_acc_5: 0.2096  Mult_acc_7: 0.1703  MAE: 1.6459  Corr: -0.0290 
2024-06-12 22:18:19:INFO:TRAIN-(cmcm) (8/9/3)>> loss: 0.8776
2024-06-12 22:18:21:INFO:VAL-(cmcm) >>
2024-06-12 22:18:21:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.5571  Non0_acc_2: 0.5602  Non0_F1_score: 0.5566  Mult_acc_5: 0.1747  Mult_acc_7: 0.1616  MAE: 1.5132  Corr: 0.0543 
2024-06-12 22:18:36:INFO:TRAIN-(cmcm) (9/10/3)>> loss: 0.8672
2024-06-12 22:18:39:INFO:VAL-(cmcm) >>
2024-06-12 22:18:39:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4917  Non0_acc_2: 0.5787  Non0_F1_score: 0.4649  Mult_acc_5: 0.2795  Mult_acc_7: 0.2009  MAE: 1.6250  Corr: 0.0167 
2024-06-12 22:18:53:INFO:TRAIN-(cmcm) (10/11/3)>> loss: 0.8583
2024-06-12 22:18:56:INFO:VAL-(cmcm) >>
2024-06-12 22:18:56:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.4956  Non0_acc_2: 0.5370  Non0_F1_score: 0.4701  Mult_acc_5: 0.2838  Mult_acc_7: 0.2096  MAE: 1.6621  Corr: 0.0280 
2024-06-12 22:19:03:INFO:TEST-(cmcm) >>
2024-06-12 22:19:03:INFO:M: >>  Has0_acc_2: 0.4475  Has0_F1_score: 0.2767  Non0_acc_2: 0.5777  Non0_F1_score: 0.4231  Mult_acc_5: 0.1545  Mult_acc_7: 0.1545  MAE: 1.4174  Corr: nan 
2024-06-12 22:19:04:INFO:Results are added to results/results/mosi-regression-70.csv...
2024-06-12 22:19:04:INFO:Start running cmcm...
2024-06-12 22:19:04:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [0], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 2, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 70, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 4444}>
2024-06-12 22:19:04:INFO:Let's use the GPU 0 !
2024-06-12 22:19:04:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 22:19:04:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718201944 HTTP/1.1" 200 235
2024-06-12 22:19:04:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 22:19:05:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 22:19:06:INFO:train samples: (1284,)
2024-06-12 22:19:06:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 22:19:06:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718201946 HTTP/1.1" 200 235
2024-06-12 22:19:06:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 22:19:07:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 22:19:07:INFO:valid samples: (229,)
2024-06-12 22:19:07:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 22:19:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718201948 HTTP/1.1" 200 235
2024-06-12 22:19:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 22:19:09:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 22:19:09:INFO:test samples: (686,)
2024-06-12 22:19:09:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 22:19:09:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718201950 HTTP/1.1" 200 235
2024-06-12 22:19:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 22:19:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 22:19:11:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 22:19:11:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718201951 HTTP/1.1" 200 235
2024-06-12 22:19:11:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 22:19:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 22:19:12:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-12 22:19:12:WARNING:Try importing flash-attention for faster inference...
2024-06-12 22:19:12:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-12 22:19:12:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-12 22:19:12:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-12 22:19:13:INFO:trainable params: 1310280 || all params: 1838138952 || trainable%: 0.07128296794833386
2024-06-12 22:19:13:INFO:Init labels...
2024-06-12 22:19:13:INFO:Start training...
2024-06-12 22:19:28:INFO:TRAIN-(cmcm) (1/1/4)>> loss: 4.3837
2024-06-12 22:19:30:INFO:VAL-(cmcm) >>
2024-06-12 22:19:30:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4259  Non0_F1_score: 0.2544  Mult_acc_5: 0.2140  Mult_acc_7: 0.2140  MAE: 1.4370  Corr: nan 
2024-06-12 22:19:31:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-12 22:19:46:INFO:TRAIN-(cmcm) (1/2/4)>> loss: 4.0855
2024-06-12 22:19:48:INFO:VAL-(cmcm) >>
2024-06-12 22:19:48:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4074  Non0_F1_score: 0.2542  Mult_acc_5: 0.2183  Mult_acc_7: 0.2183  MAE: 1.4894  Corr: -0.1137 
2024-06-12 22:20:03:INFO:TRAIN-(cmcm) (2/3/4)>> loss: 1.9976
2024-06-12 22:20:06:INFO:VAL-(cmcm) >>
2024-06-12 22:20:06:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.5382  Non0_acc_2: 0.5694  Non0_F1_score: 0.5268  Mult_acc_5: 0.2183  Mult_acc_7: 0.1659  MAE: 1.6267  Corr: 0.0753 
2024-06-12 22:20:20:INFO:TRAIN-(cmcm) (3/4/4)>> loss: 0.9997
2024-06-12 22:20:23:INFO:VAL-(cmcm) >>
2024-06-12 22:20:23:INFO:M: >>  Has0_acc_2: 0.6419  Has0_F1_score: 0.5447  Non0_acc_2: 0.6250  Non0_F1_score: 0.5345  Mult_acc_5: 0.1965  Mult_acc_7: 0.1834  MAE: 1.4379  Corr: 0.0849 
2024-06-12 22:20:38:INFO:TRAIN-(cmcm) (4/5/4)>> loss: 0.9400
2024-06-12 22:20:40:INFO:VAL-(cmcm) >>
2024-06-12 22:20:40:INFO:M: >>  Has0_acc_2: 0.4760  Has0_F1_score: 0.4723  Non0_acc_2: 0.5000  Non0_F1_score: 0.4955  Mult_acc_5: 0.1878  Mult_acc_7: 0.1397  MAE: 1.7894  Corr: 0.0238 
2024-06-12 22:20:55:INFO:TRAIN-(cmcm) (5/6/4)>> loss: 0.9114
2024-06-12 22:20:58:INFO:VAL-(cmcm) >>
2024-06-12 22:20:58:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.4539  Non0_acc_2: 0.5509  Non0_F1_score: 0.4296  Mult_acc_5: 0.2533  Mult_acc_7: 0.1921  MAE: 1.5787  Corr: -0.0196 
2024-06-12 22:21:12:INFO:TRAIN-(cmcm) (6/7/4)>> loss: 0.9000
2024-06-12 22:21:15:INFO:VAL-(cmcm) >>
2024-06-12 22:21:15:INFO:M: >>  Has0_acc_2: 0.6245  Has0_F1_score: 0.5517  Non0_acc_2: 0.6204  Non0_F1_score: 0.5619  Mult_acc_5: 0.2882  Mult_acc_7: 0.2227  MAE: 1.4437  Corr: 0.1635 
2024-06-12 22:21:30:INFO:TRAIN-(cmcm) (7/8/4)>> loss: 0.8969
2024-06-12 22:21:32:INFO:VAL-(cmcm) >>
2024-06-12 22:21:32:INFO:M: >>  Has0_acc_2: 0.6157  Has0_F1_score: 0.5954  Non0_acc_2: 0.6111  Non0_F1_score: 0.5905  Mult_acc_5: 0.2096  Mult_acc_7: 0.1790  MAE: 1.5296  Corr: 0.1393 
2024-06-12 22:21:47:INFO:TRAIN-(cmcm) (8/9/4)>> loss: 0.8869
2024-06-12 22:21:50:INFO:VAL-(cmcm) >>
2024-06-12 22:21:50:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.5798  Non0_acc_2: 0.5972  Non0_F1_score: 0.5704  Mult_acc_5: 0.2620  Mult_acc_7: 0.1878  MAE: 1.6009  Corr: 0.0845 
2024-06-12 22:22:05:INFO:TRAIN-(cmcm) (9/10/4)>> loss: 0.8790
2024-06-12 22:22:07:INFO:VAL-(cmcm) >>
2024-06-12 22:22:07:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5698  Non0_acc_2: 0.5787  Non0_F1_score: 0.5613  Mult_acc_5: 0.2402  Mult_acc_7: 0.2052  MAE: 1.4394  Corr: 0.1357 
2024-06-12 22:22:22:INFO:TRAIN-(cmcm) (10/11/4)>> loss: 0.8695
2024-06-12 22:22:24:INFO:VAL-(cmcm) >>
2024-06-12 22:22:24:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.5602  Non0_acc_2: 0.5833  Non0_F1_score: 0.5492  Mult_acc_5: 0.2882  Mult_acc_7: 0.2140  MAE: 1.6800  Corr: 0.0769 
2024-06-12 22:22:32:INFO:TEST-(cmcm) >>
2024-06-12 22:22:32:INFO:M: >>  Has0_acc_2: 0.4475  Has0_F1_score: 0.2767  Non0_acc_2: 0.5777  Non0_F1_score: 0.4231  Mult_acc_5: 0.1545  Mult_acc_7: 0.1545  MAE: 1.4174  Corr: nan 
2024-06-12 22:22:32:INFO:Results are added to results/results/mosi-regression-70.csv...
2024-06-12 22:22:32:INFO:Start running cmcm...
2024-06-12 22:22:32:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [0], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 2, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 70, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 5555}>
2024-06-12 22:22:32:INFO:Let's use the GPU 0 !
2024-06-12 22:22:32:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 22:22:33:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718202153 HTTP/1.1" 200 235
2024-06-12 22:22:33:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 22:22:33:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 22:22:34:INFO:train samples: (1284,)
2024-06-12 22:22:34:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 22:22:34:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718202155 HTTP/1.1" 200 235
2024-06-12 22:22:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 22:22:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 22:22:36:INFO:valid samples: (229,)
2024-06-12 22:22:36:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 22:22:36:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718202156 HTTP/1.1" 200 235
2024-06-12 22:22:36:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 22:22:37:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 22:22:37:INFO:test samples: (686,)
2024-06-12 22:22:37:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 22:22:37:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718202158 HTTP/1.1" 200 235
2024-06-12 22:22:38:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 22:22:38:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 22:22:39:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 22:22:39:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718202159 HTTP/1.1" 200 235
2024-06-12 22:22:39:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 22:22:40:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 22:22:40:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-12 22:22:40:WARNING:Try importing flash-attention for faster inference...
2024-06-12 22:22:40:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-12 22:22:40:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-12 22:22:40:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-12 22:22:41:INFO:trainable params: 1310280 || all params: 1838138952 || trainable%: 0.07128296794833386
2024-06-12 22:22:41:INFO:Init labels...
2024-06-12 22:22:41:INFO:Start training...
2024-06-12 22:22:56:INFO:TRAIN-(cmcm) (1/1/5)>> loss: 3.4710
2024-06-12 22:22:58:INFO:VAL-(cmcm) >>
2024-06-12 22:22:58:INFO:M: >>  Has0_acc_2: 0.4891  Has0_F1_score: 0.4849  Non0_acc_2: 0.4630  Non0_F1_score: 0.4228  Mult_acc_5: 0.1965  Mult_acc_7: 0.1965  MAE: 1.5676  Corr: -0.0833 
2024-06-12 22:22:59:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-12 22:23:14:INFO:TRAIN-(cmcm) (1/2/5)>> loss: 1.0592
2024-06-12 22:23:16:INFO:VAL-(cmcm) >>
2024-06-12 22:23:16:INFO:M: >>  Has0_acc_2: 0.4803  Has0_F1_score: 0.4803  Non0_acc_2: 0.4861  Non0_F1_score: 0.4841  Mult_acc_5: 0.2140  Mult_acc_7: 0.1834  MAE: 1.7804  Corr: -0.0292 
2024-06-12 22:23:31:INFO:TRAIN-(cmcm) (2/3/5)>> loss: 0.9287
2024-06-12 22:23:34:INFO:VAL-(cmcm) >>
2024-06-12 22:23:34:INFO:M: >>  Has0_acc_2: 0.5546  Has0_F1_score: 0.5587  Non0_acc_2: 0.5556  Non0_F1_score: 0.5574  Mult_acc_5: 0.1965  Mult_acc_7: 0.1878  MAE: 1.5353  Corr: 0.1213 
2024-06-12 22:23:34:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-mosi-regression.pth.
2024-06-12 22:23:49:INFO:TRAIN-(cmcm) (1/4/5)>> loss: 0.8956
2024-06-12 22:23:52:INFO:VAL-(cmcm) >>
2024-06-12 22:23:52:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.4780  Non0_acc_2: 0.5648  Non0_F1_score: 0.4505  Mult_acc_5: 0.2271  Mult_acc_7: 0.1878  MAE: 1.5903  Corr: -0.0127 
2024-06-12 22:24:07:INFO:TRAIN-(cmcm) (2/5/5)>> loss: 0.8940
2024-06-12 22:24:09:INFO:VAL-(cmcm) >>
2024-06-12 22:24:09:INFO:M: >>  Has0_acc_2: 0.5633  Has0_F1_score: 0.5155  Non0_acc_2: 0.5463  Non0_F1_score: 0.4963  Mult_acc_5: 0.1747  Mult_acc_7: 0.1747  MAE: 1.6101  Corr: -0.0012 
2024-06-12 22:24:24:INFO:TRAIN-(cmcm) (3/6/5)>> loss: 0.8836
2024-06-12 22:24:27:INFO:VAL-(cmcm) >>
2024-06-12 22:24:27:INFO:M: >>  Has0_acc_2: 0.5546  Has0_F1_score: 0.5024  Non0_acc_2: 0.5370  Non0_F1_score: 0.4823  Mult_acc_5: 0.1965  Mult_acc_7: 0.1965  MAE: 1.5349  Corr: -0.0471 
2024-06-12 22:24:27:INFO:Saving checkpoint at epoch 6 to results/models/cmcm-mosi-regression.pth.
2024-06-12 22:24:42:INFO:TRAIN-(cmcm) (1/7/5)>> loss: 0.8763
2024-06-12 22:24:45:INFO:VAL-(cmcm) >>
2024-06-12 22:24:45:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5704  Non0_acc_2: 0.5648  Non0_F1_score: 0.5626  Mult_acc_5: 0.1878  Mult_acc_7: 0.1659  MAE: 1.5017  Corr: 0.1022 
2024-06-12 22:24:46:INFO:Saving checkpoint at epoch 7 to results/models/cmcm-mosi-regression.pth.
2024-06-12 22:25:01:INFO:TRAIN-(cmcm) (1/8/5)>> loss: 0.8738
2024-06-12 22:25:04:INFO:VAL-(cmcm) >>
2024-06-12 22:25:04:INFO:M: >>  Has0_acc_2: 0.5066  Has0_F1_score: 0.5103  Non0_acc_2: 0.5278  Non0_F1_score: 0.5123  Mult_acc_5: 0.1528  Mult_acc_7: 0.1485  MAE: 1.6960  Corr: 0.0677 
2024-06-12 22:25:18:INFO:TRAIN-(cmcm) (2/9/5)>> loss: 0.8725
2024-06-12 22:25:21:INFO:VAL-(cmcm) >>
2024-06-12 22:25:21:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5081  Non0_acc_2: 0.5694  Non0_F1_score: 0.4821  Mult_acc_5: 0.3013  Mult_acc_7: 0.2314  MAE: 1.7940  Corr: -0.0265 
2024-06-12 22:25:36:INFO:TRAIN-(cmcm) (3/10/5)>> loss: 0.8808
2024-06-12 22:25:38:INFO:VAL-(cmcm) >>
2024-06-12 22:25:38:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.4897  Non0_acc_2: 0.5648  Non0_F1_score: 0.4627  Mult_acc_5: 0.2838  Mult_acc_7: 0.2052  MAE: 1.7704  Corr: -0.0490 
2024-06-12 22:25:53:INFO:TRAIN-(cmcm) (4/11/5)>> loss: 0.8654
2024-06-12 22:25:55:INFO:VAL-(cmcm) >>
2024-06-12 22:25:55:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4556  Non0_acc_2: 0.5463  Non0_F1_score: 0.5286  Mult_acc_5: 0.2096  Mult_acc_7: 0.1965  MAE: 1.4593  Corr: 0.0356 
2024-06-12 22:25:56:INFO:Saving checkpoint at epoch 11 to results/models/cmcm-mosi-regression.pth.
2024-06-12 22:26:11:INFO:TRAIN-(cmcm) (1/12/5)>> loss: 0.8633
2024-06-12 22:26:14:INFO:VAL-(cmcm) >>
2024-06-12 22:26:14:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5100  Non0_acc_2: 0.5694  Non0_F1_score: 0.4871  Mult_acc_5: 0.2096  Mult_acc_7: 0.2009  MAE: 1.4702  Corr: 0.0315 
2024-06-12 22:26:28:INFO:TRAIN-(cmcm) (2/13/5)>> loss: 0.8564
2024-06-12 22:26:31:INFO:VAL-(cmcm) >>
2024-06-12 22:26:31:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5100  Non0_acc_2: 0.5231  Non0_F1_score: 0.4793  Mult_acc_5: 0.2620  Mult_acc_7: 0.2009  MAE: 1.6263  Corr: 0.0058 
2024-06-12 22:26:46:INFO:TRAIN-(cmcm) (3/14/5)>> loss: 0.8608
2024-06-12 22:26:48:INFO:VAL-(cmcm) >>
2024-06-12 22:26:48:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.5403  Non0_acc_2: 0.5833  Non0_F1_score: 0.5191  Mult_acc_5: 0.2751  Mult_acc_7: 0.2009  MAE: 1.7119  Corr: 0.0744 
2024-06-12 22:27:03:INFO:TRAIN-(cmcm) (4/15/5)>> loss: 0.8509
2024-06-12 22:27:06:INFO:VAL-(cmcm) >>
2024-06-12 22:27:06:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4723  Non0_acc_2: 0.5556  Non0_F1_score: 0.5418  Mult_acc_5: 0.2751  Mult_acc_7: 0.2227  MAE: 1.5200  Corr: 0.0275 
2024-06-12 22:27:20:INFO:TRAIN-(cmcm) (5/16/5)>> loss: 0.8486
2024-06-12 22:27:23:INFO:VAL-(cmcm) >>
2024-06-12 22:27:23:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.4924  Non0_acc_2: 0.5648  Non0_F1_score: 0.4739  Mult_acc_5: 0.2489  Mult_acc_7: 0.1747  MAE: 1.7202  Corr: -0.0082 
2024-06-12 22:27:38:INFO:TRAIN-(cmcm) (6/17/5)>> loss: 0.8439
2024-06-12 22:27:40:INFO:VAL-(cmcm) >>
2024-06-12 22:27:40:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.5332  Non0_acc_2: 0.5880  Non0_F1_score: 0.5182  Mult_acc_5: 0.3057  Mult_acc_7: 0.2445  MAE: 1.5761  Corr: 0.1041 
2024-06-12 22:27:55:INFO:TRAIN-(cmcm) (7/18/5)>> loss: 0.8412
2024-06-12 22:27:58:INFO:VAL-(cmcm) >>
2024-06-12 22:27:58:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5493  Non0_acc_2: 0.5787  Non0_F1_score: 0.5507  Mult_acc_5: 0.2664  Mult_acc_7: 0.2009  MAE: 1.6953  Corr: 0.0459 
2024-06-12 22:28:12:INFO:TRAIN-(cmcm) (8/19/5)>> loss: 0.8378
2024-06-12 22:28:15:INFO:VAL-(cmcm) >>
2024-06-12 22:28:15:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.5841  Non0_acc_2: 0.5880  Non0_F1_score: 0.5671  Mult_acc_5: 0.2882  Mult_acc_7: 0.2140  MAE: 1.6507  Corr: 0.0859 
2024-06-12 22:28:30:INFO:TRAIN-(cmcm) (9/20/5)>> loss: 0.8301
2024-06-12 22:28:32:INFO:VAL-(cmcm) >>
2024-06-12 22:28:32:INFO:M: >>  Has0_acc_2: 0.5022  Has0_F1_score: 0.4593  Non0_acc_2: 0.5231  Non0_F1_score: 0.4804  Mult_acc_5: 0.2140  Mult_acc_7: 0.1878  MAE: 1.5881  Corr: 0.1627 
2024-06-12 22:28:47:INFO:TRAIN-(cmcm) (10/21/5)>> loss: 0.8380
2024-06-12 22:28:49:INFO:VAL-(cmcm) >>
2024-06-12 22:28:49:INFO:M: >>  Has0_acc_2: 0.5415  Has0_F1_score: 0.5355  Non0_acc_2: 0.5463  Non0_F1_score: 0.5361  Mult_acc_5: 0.1921  Mult_acc_7: 0.1659  MAE: 1.7122  Corr: 0.1452 
2024-06-12 22:28:57:INFO:TEST-(cmcm) >>
2024-06-12 22:28:57:INFO:M: >>  Has0_acc_2: 0.4519  Has0_F1_score: 0.2887  Non0_acc_2: 0.5061  Non0_F1_score: 0.4938  Mult_acc_5: 0.1720  Mult_acc_7: 0.1676  MAE: 1.6018  Corr: 0.0789 
2024-06-12 22:28:57:INFO:Results are added to results/results/mosi-regression-70.csv...
2024-06-12 22:28:57:INFO:Start running cmcm...
2024-06-12 22:28:57:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [0], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 2, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 80, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-06-12 22:28:57:INFO:Let's use the GPU 0 !
2024-06-12 22:28:57:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 22:28:58:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718202538 HTTP/1.1" 200 235
2024-06-12 22:28:58:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 22:28:58:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 22:28:59:INFO:train samples: (1284,)
2024-06-12 22:28:59:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 22:28:59:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718202539 HTTP/1.1" 200 235
2024-06-12 22:28:59:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 22:29:00:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 22:29:01:INFO:valid samples: (229,)
2024-06-12 22:29:01:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 22:29:01:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718202542 HTTP/1.1" 200 235
2024-06-12 22:29:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 22:29:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 22:29:03:INFO:test samples: (686,)
2024-06-12 22:29:03:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 22:29:03:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718202543 HTTP/1.1" 200 235
2024-06-12 22:29:03:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 22:29:04:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 22:29:04:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 22:29:04:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718202545 HTTP/1.1" 200 235
2024-06-12 22:29:05:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 22:29:05:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 22:29:05:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-12 22:29:05:WARNING:Try importing flash-attention for faster inference...
2024-06-12 22:29:05:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-12 22:29:05:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-12 22:29:05:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-12 22:29:06:INFO:trainable params: 1310280 || all params: 1838138952 || trainable%: 0.07128296794833386
2024-06-12 22:29:06:INFO:Init labels...
2024-06-12 22:29:06:INFO:Start training...
2024-06-12 22:29:21:INFO:TRAIN-(cmcm) (1/1/1)>> loss: 4.1535
2024-06-12 22:29:24:INFO:VAL-(cmcm) >>
2024-06-12 22:29:24:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4259  Non0_F1_score: 0.2544  Mult_acc_5: 0.2140  Mult_acc_7: 0.2140  MAE: 1.4370  Corr: nan 
2024-06-12 22:29:24:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-12 22:29:39:INFO:TRAIN-(cmcm) (1/2/1)>> loss: 2.1830
2024-06-12 22:29:42:INFO:VAL-(cmcm) >>
2024-06-12 22:29:42:INFO:M: >>  Has0_acc_2: 0.5633  Has0_F1_score: 0.5499  Non0_acc_2: 0.5509  Non0_F1_score: 0.5395  Mult_acc_5: 0.2445  Mult_acc_7: 0.1878  MAE: 1.6140  Corr: 0.0348 
2024-06-12 22:29:57:INFO:TRAIN-(cmcm) (2/3/1)>> loss: 1.0174
2024-06-12 22:29:59:INFO:VAL-(cmcm) >>
2024-06-12 22:29:59:INFO:M: >>  Has0_acc_2: 0.5546  Has0_F1_score: 0.5519  Non0_acc_2: 0.5602  Non0_F1_score: 0.5544  Mult_acc_5: 0.2620  Mult_acc_7: 0.2227  MAE: 1.5608  Corr: 0.0224 
2024-06-12 22:30:14:INFO:TRAIN-(cmcm) (3/4/1)>> loss: 0.9379
2024-06-12 22:30:17:INFO:VAL-(cmcm) >>
2024-06-12 22:30:17:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4723  Non0_acc_2: 0.5787  Non0_F1_score: 0.4445  Mult_acc_5: 0.2838  Mult_acc_7: 0.2183  MAE: 1.7175  Corr: -0.0184 
2024-06-12 22:30:31:INFO:TRAIN-(cmcm) (4/5/1)>> loss: 0.9079
2024-06-12 22:30:34:INFO:VAL-(cmcm) >>
2024-06-12 22:30:34:INFO:M: >>  Has0_acc_2: 0.5109  Has0_F1_score: 0.5010  Non0_acc_2: 0.5231  Non0_F1_score: 0.5101  Mult_acc_5: 0.1834  Mult_acc_7: 0.1616  MAE: 1.7122  Corr: 0.0831 
2024-06-12 22:30:49:INFO:TRAIN-(cmcm) (5/6/1)>> loss: 0.8984
2024-06-12 22:30:51:INFO:VAL-(cmcm) >>
2024-06-12 22:30:51:INFO:M: >>  Has0_acc_2: 0.5284  Has0_F1_score: 0.5324  Non0_acc_2: 0.5324  Non0_F1_score: 0.5342  Mult_acc_5: 0.1790  Mult_acc_7: 0.1790  MAE: 1.6244  Corr: 0.0295 
2024-06-12 22:31:06:INFO:TRAIN-(cmcm) (6/7/1)>> loss: 0.8879
2024-06-12 22:31:08:INFO:VAL-(cmcm) >>
2024-06-12 22:31:08:INFO:M: >>  Has0_acc_2: 0.5371  Has0_F1_score: 0.5371  Non0_acc_2: 0.5185  Non0_F1_score: 0.5191  Mult_acc_5: 0.2445  Mult_acc_7: 0.2314  MAE: 1.4685  Corr: 0.0933 
2024-06-12 22:31:23:INFO:TRAIN-(cmcm) (7/8/1)>> loss: 0.8858
2024-06-12 22:31:26:INFO:VAL-(cmcm) >>
2024-06-12 22:31:26:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5741  Non0_F1_score: 0.4187  Mult_acc_5: 0.2838  Mult_acc_7: 0.2052  MAE: 1.7835  Corr: 0.0709 
2024-06-12 22:31:41:INFO:TRAIN-(cmcm) (8/9/1)>> loss: 0.8728
2024-06-12 22:31:43:INFO:VAL-(cmcm) >>
2024-06-12 22:31:43:INFO:M: >>  Has0_acc_2: 0.5371  Has0_F1_score: 0.5413  Non0_acc_2: 0.4815  Non0_F1_score: 0.4698  Mult_acc_5: 0.1965  Mult_acc_7: 0.1965  MAE: 1.5698  Corr: 0.0748 
2024-06-12 22:31:58:INFO:TRAIN-(cmcm) (9/10/1)>> loss: 0.8728
2024-06-12 22:32:00:INFO:VAL-(cmcm) >>
2024-06-12 22:32:00:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5424  Non0_acc_2: 0.5602  Non0_F1_score: 0.5283  Mult_acc_5: 0.1616  Mult_acc_7: 0.1310  MAE: 1.6410  Corr: -0.0390 
2024-06-12 22:32:15:INFO:TRAIN-(cmcm) (10/11/1)>> loss: 0.8682
2024-06-12 22:32:18:INFO:VAL-(cmcm) >>
2024-06-12 22:32:18:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.5114  Non0_acc_2: 0.5880  Non0_F1_score: 0.4885  Mult_acc_5: 0.2838  Mult_acc_7: 0.2096  MAE: 1.7180  Corr: 0.0537 
2024-06-12 22:32:25:INFO:TEST-(cmcm) >>
2024-06-12 22:32:25:INFO:M: >>  Has0_acc_2: 0.4475  Has0_F1_score: 0.2767  Non0_acc_2: 0.5777  Non0_F1_score: 0.4231  Mult_acc_5: 0.1545  Mult_acc_7: 0.1545  MAE: 1.4174  Corr: nan 
2024-06-12 22:32:25:INFO:Results are added to results/results/mosi-regression-80.csv...
2024-06-12 22:32:25:INFO:Start running cmcm...
2024-06-12 22:32:25:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [0], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 2, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 80, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 2222}>
2024-06-12 22:32:25:INFO:Let's use the GPU 0 !
2024-06-12 22:32:25:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 22:32:26:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718202746 HTTP/1.1" 200 235
2024-06-12 22:32:26:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 22:32:26:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 22:32:27:INFO:train samples: (1284,)
2024-06-12 22:32:27:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 22:32:27:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718202748 HTTP/1.1" 200 235
2024-06-12 22:32:27:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 22:32:28:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 22:32:28:INFO:valid samples: (229,)
2024-06-12 22:32:28:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 22:32:29:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718202749 HTTP/1.1" 200 235
2024-06-12 22:32:29:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 22:32:30:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 22:32:30:INFO:test samples: (686,)
2024-06-12 22:32:30:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 22:32:30:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718202751 HTTP/1.1" 200 235
2024-06-12 22:32:31:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 22:32:31:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 22:32:31:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 22:32:32:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718202752 HTTP/1.1" 200 235
2024-06-12 22:32:32:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 22:32:32:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 22:32:32:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-12 22:32:32:WARNING:Try importing flash-attention for faster inference...
2024-06-12 22:32:32:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-12 22:32:32:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-12 22:32:32:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-12 22:32:33:INFO:trainable params: 1310280 || all params: 1838138952 || trainable%: 0.07128296794833386
2024-06-12 22:32:33:INFO:Init labels...
2024-06-12 22:32:33:INFO:Start training...
2024-06-12 22:32:48:INFO:TRAIN-(cmcm) (1/1/2)>> loss: 4.1869
2024-06-12 22:32:51:INFO:VAL-(cmcm) >>
2024-06-12 22:32:51:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4259  Non0_F1_score: 0.2544  Mult_acc_5: 0.2140  Mult_acc_7: 0.2140  MAE: 1.4370  Corr: nan 
2024-06-12 22:32:51:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-12 22:33:07:INFO:TRAIN-(cmcm) (1/2/2)>> loss: 2.3566
2024-06-12 22:33:09:INFO:VAL-(cmcm) >>
2024-06-12 22:33:09:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.4584  Non0_acc_2: 0.5741  Non0_F1_score: 0.5392  Mult_acc_5: 0.2795  Mult_acc_7: 0.2096  MAE: 1.5966  Corr: 0.0279 
2024-06-12 22:33:24:INFO:TRAIN-(cmcm) (2/3/2)>> loss: 1.0375
2024-06-12 22:33:26:INFO:VAL-(cmcm) >>
2024-06-12 22:33:26:INFO:M: >>  Has0_acc_2: 0.5546  Has0_F1_score: 0.5484  Non0_acc_2: 0.5463  Non0_F1_score: 0.5384  Mult_acc_5: 0.1747  Mult_acc_7: 0.1659  MAE: 1.6414  Corr: 0.0427 
2024-06-12 22:33:41:INFO:TRAIN-(cmcm) (3/4/2)>> loss: 0.9504
2024-06-12 22:33:44:INFO:VAL-(cmcm) >>
2024-06-12 22:33:44:INFO:M: >>  Has0_acc_2: 0.6288  Has0_F1_score: 0.5741  Non0_acc_2: 0.6065  Non0_F1_score: 0.5514  Mult_acc_5: 0.2271  Mult_acc_7: 0.2052  MAE: 1.5232  Corr: 0.0784 
2024-06-12 22:33:58:INFO:TRAIN-(cmcm) (4/5/2)>> loss: 0.9203
2024-06-12 22:34:01:INFO:VAL-(cmcm) >>
2024-06-12 22:34:01:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.5339  Non0_acc_2: 0.5880  Non0_F1_score: 0.5092  Mult_acc_5: 0.2707  Mult_acc_7: 0.2140  MAE: 1.6376  Corr: 0.0901 
2024-06-12 22:34:16:INFO:TRAIN-(cmcm) (5/6/2)>> loss: 0.9016
2024-06-12 22:34:18:INFO:VAL-(cmcm) >>
2024-06-12 22:34:18:INFO:M: >>  Has0_acc_2: 0.4760  Has0_F1_score: 0.4277  Non0_acc_2: 0.4954  Non0_F1_score: 0.4469  Mult_acc_5: 0.2183  Mult_acc_7: 0.1790  MAE: 1.7560  Corr: 0.1031 
2024-06-12 22:34:33:INFO:TRAIN-(cmcm) (6/7/2)>> loss: 0.9064
2024-06-12 22:34:36:INFO:VAL-(cmcm) >>
2024-06-12 22:34:36:INFO:M: >>  Has0_acc_2: 0.4803  Has0_F1_score: 0.4341  Non0_acc_2: 0.4907  Non0_F1_score: 0.4401  Mult_acc_5: 0.1965  Mult_acc_7: 0.1747  MAE: 1.8200  Corr: 0.0734 
2024-06-12 22:34:50:INFO:TRAIN-(cmcm) (7/8/2)>> loss: 0.8963
2024-06-12 22:34:53:INFO:VAL-(cmcm) >>
2024-06-12 22:34:53:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5813  Non0_acc_2: 0.5880  Non0_F1_score: 0.5789  Mult_acc_5: 0.2314  Mult_acc_7: 0.2183  MAE: 1.4750  Corr: 0.1128 
2024-06-12 22:35:08:INFO:TRAIN-(cmcm) (8/9/2)>> loss: 0.8990
2024-06-12 22:35:10:INFO:VAL-(cmcm) >>
2024-06-12 22:35:10:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.4897  Non0_acc_2: 0.5694  Non0_F1_score: 0.4655  Mult_acc_5: 0.3275  Mult_acc_7: 0.2533  MAE: 1.6999  Corr: 0.0056 
2024-06-12 22:35:25:INFO:TRAIN-(cmcm) (9/10/2)>> loss: 0.8860
2024-06-12 22:35:27:INFO:VAL-(cmcm) >>
2024-06-12 22:35:27:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5506  Non0_acc_2: 0.5833  Non0_F1_score: 0.5406  Mult_acc_5: 0.2140  Mult_acc_7: 0.2140  MAE: 1.5549  Corr: 0.0514 
2024-06-12 22:35:42:INFO:TRAIN-(cmcm) (10/11/2)>> loss: 0.8823
2024-06-12 22:35:45:INFO:VAL-(cmcm) >>
2024-06-12 22:35:45:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5888  Non0_acc_2: 0.6019  Non0_F1_score: 0.5937  Mult_acc_5: 0.3188  Mult_acc_7: 0.2533  MAE: 1.5424  Corr: 0.1552 
2024-06-12 22:35:52:INFO:TEST-(cmcm) >>
2024-06-12 22:35:52:INFO:M: >>  Has0_acc_2: 0.4475  Has0_F1_score: 0.2767  Non0_acc_2: 0.5777  Non0_F1_score: 0.4231  Mult_acc_5: 0.1545  Mult_acc_7: 0.1545  MAE: 1.4174  Corr: nan 
2024-06-12 22:35:52:INFO:Results are added to results/results/mosi-regression-80.csv...
2024-06-12 22:35:52:INFO:Start running cmcm...
2024-06-12 22:35:52:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [0], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 2, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 80, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 3333}>
2024-06-12 22:35:52:INFO:Let's use the GPU 0 !
2024-06-12 22:35:52:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 22:35:53:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718202953 HTTP/1.1" 200 235
2024-06-12 22:35:53:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 22:35:53:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 22:35:54:INFO:train samples: (1284,)
2024-06-12 22:35:54:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 22:35:54:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718202955 HTTP/1.1" 200 235
2024-06-12 22:35:55:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 22:35:55:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 22:35:56:INFO:valid samples: (229,)
2024-06-12 22:35:56:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 22:35:56:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718202956 HTTP/1.1" 200 235
2024-06-12 22:35:56:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 22:35:57:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 22:35:57:INFO:test samples: (686,)
2024-06-12 22:35:57:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 22:35:57:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718202958 HTTP/1.1" 200 235
2024-06-12 22:35:58:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 22:35:58:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 22:35:59:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 22:35:59:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718202959 HTTP/1.1" 200 235
2024-06-12 22:35:59:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 22:35:59:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 22:35:59:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-12 22:35:59:WARNING:Try importing flash-attention for faster inference...
2024-06-12 22:35:59:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-12 22:35:59:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-12 22:35:59:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-12 22:36:01:INFO:trainable params: 1310280 || all params: 1838138952 || trainable%: 0.07128296794833386
2024-06-12 22:36:01:INFO:Init labels...
2024-06-12 22:36:01:INFO:Start training...
2024-06-12 22:36:15:INFO:TRAIN-(cmcm) (1/1/3)>> loss: 4.1449
2024-06-12 22:36:18:INFO:VAL-(cmcm) >>
2024-06-12 22:36:18:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4259  Non0_F1_score: 0.2544  Mult_acc_5: 0.2140  Mult_acc_7: 0.2140  MAE: 1.4370  Corr: nan 
2024-06-12 22:36:19:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-12 22:36:34:INFO:TRAIN-(cmcm) (1/2/3)>> loss: 2.2419
2024-06-12 22:36:36:INFO:VAL-(cmcm) >>
2024-06-12 22:36:36:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.5137  Non0_acc_2: 0.5741  Non0_F1_score: 0.4902  Mult_acc_5: 0.1965  Mult_acc_7: 0.1834  MAE: 1.5336  Corr: -0.0044 
2024-06-12 22:36:51:INFO:TRAIN-(cmcm) (2/3/3)>> loss: 1.0099
2024-06-12 22:36:54:INFO:VAL-(cmcm) >>
2024-06-12 22:36:54:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4805  Non0_acc_2: 0.5556  Non0_F1_score: 0.4780  Mult_acc_5: 0.2358  Mult_acc_7: 0.1834  MAE: 1.5228  Corr: 0.0796 
2024-06-12 22:37:08:INFO:TRAIN-(cmcm) (3/4/3)>> loss: 0.9358
2024-06-12 22:37:11:INFO:VAL-(cmcm) >>
2024-06-12 22:37:11:INFO:M: >>  Has0_acc_2: 0.5371  Has0_F1_score: 0.5263  Non0_acc_2: 0.5370  Non0_F1_score: 0.5227  Mult_acc_5: 0.2227  Mult_acc_7: 0.1921  MAE: 1.6525  Corr: 0.0298 
2024-06-12 22:37:26:INFO:TRAIN-(cmcm) (4/5/3)>> loss: 0.9009
2024-06-12 22:37:28:INFO:VAL-(cmcm) >>
2024-06-12 22:37:28:INFO:M: >>  Has0_acc_2: 0.4760  Has0_F1_score: 0.4520  Non0_acc_2: 0.5000  Non0_F1_score: 0.4776  Mult_acc_5: 0.1747  Mult_acc_7: 0.1616  MAE: 1.8280  Corr: 0.0389 
2024-06-12 22:37:43:INFO:TRAIN-(cmcm) (5/6/3)>> loss: 0.8846
2024-06-12 22:37:46:INFO:VAL-(cmcm) >>
2024-06-12 22:37:46:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5704  Non0_acc_2: 0.5787  Non0_F1_score: 0.5743  Mult_acc_5: 0.2576  Mult_acc_7: 0.1790  MAE: 1.7538  Corr: 0.0968 
2024-06-12 22:38:00:INFO:TRAIN-(cmcm) (6/7/3)>> loss: 0.8856
2024-06-12 22:38:03:INFO:VAL-(cmcm) >>
2024-06-12 22:38:03:INFO:M: >>  Has0_acc_2: 0.4192  Has0_F1_score: 0.2740  Non0_acc_2: 0.4444  Non0_F1_score: 0.3008  Mult_acc_5: 0.1878  Mult_acc_7: 0.1179  MAE: 2.6682  Corr: -0.0660 
2024-06-12 22:38:18:INFO:TRAIN-(cmcm) (7/8/3)>> loss: 0.8848
2024-06-12 22:38:20:INFO:VAL-(cmcm) >>
2024-06-12 22:38:20:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.5597  Non0_acc_2: 0.5509  Non0_F1_score: 0.5438  Mult_acc_5: 0.2707  Mult_acc_7: 0.2052  MAE: 1.6686  Corr: 0.0435 
2024-06-12 22:38:35:INFO:TRAIN-(cmcm) (8/9/3)>> loss: 0.8724
2024-06-12 22:38:37:INFO:VAL-(cmcm) >>
2024-06-12 22:38:37:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4830  Non0_acc_2: 0.4630  Non0_F1_score: 0.4525  Mult_acc_5: 0.2052  Mult_acc_7: 0.1921  MAE: 1.4829  Corr: -0.0175 
2024-06-12 22:38:52:INFO:TRAIN-(cmcm) (9/10/3)>> loss: 0.8674
2024-06-12 22:38:55:INFO:VAL-(cmcm) >>
2024-06-12 22:38:55:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.5663  Non0_acc_2: 0.5926  Non0_F1_score: 0.5537  Mult_acc_5: 0.3144  Mult_acc_7: 0.2227  MAE: 1.6215  Corr: 0.1758 
2024-06-12 22:39:10:INFO:TRAIN-(cmcm) (10/11/3)>> loss: 0.8618
2024-06-12 22:39:12:INFO:VAL-(cmcm) >>
2024-06-12 22:39:12:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.5032  Non0_acc_2: 0.5694  Non0_F1_score: 0.5010  Mult_acc_5: 0.2096  Mult_acc_7: 0.1659  MAE: 1.5944  Corr: -0.0387 
2024-06-12 22:39:20:INFO:TEST-(cmcm) >>
2024-06-12 22:39:20:INFO:M: >>  Has0_acc_2: 0.4475  Has0_F1_score: 0.2767  Non0_acc_2: 0.5777  Non0_F1_score: 0.4231  Mult_acc_5: 0.1545  Mult_acc_7: 0.1545  MAE: 1.4174  Corr: nan 
2024-06-12 22:39:20:INFO:Results are added to results/results/mosi-regression-80.csv...
2024-06-12 22:39:20:INFO:Start running cmcm...
2024-06-12 22:39:20:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [0], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 2, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 80, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 4444}>
2024-06-12 22:39:20:INFO:Let's use the GPU 0 !
2024-06-12 22:39:20:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 22:39:20:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718203160 HTTP/1.1" 200 235
2024-06-12 22:39:21:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 22:39:21:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 22:39:22:INFO:train samples: (1284,)
2024-06-12 22:39:22:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 22:39:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718203162 HTTP/1.1" 200 235
2024-06-12 22:39:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 22:39:23:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 22:39:23:INFO:valid samples: (229,)
2024-06-12 22:39:23:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 22:39:24:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718203164 HTTP/1.1" 200 235
2024-06-12 22:39:24:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 22:39:24:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 22:39:25:INFO:test samples: (686,)
2024-06-12 22:39:25:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 22:39:25:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718203165 HTTP/1.1" 200 235
2024-06-12 22:39:25:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 22:39:26:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 22:39:26:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 22:39:27:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718203167 HTTP/1.1" 200 235
2024-06-12 22:39:27:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 22:39:27:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 22:39:27:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-12 22:39:27:WARNING:Try importing flash-attention for faster inference...
2024-06-12 22:39:27:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-12 22:39:27:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-12 22:39:27:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-12 22:39:29:INFO:trainable params: 1310280 || all params: 1838138952 || trainable%: 0.07128296794833386
2024-06-12 22:39:29:INFO:Init labels...
2024-06-12 22:39:29:INFO:Start training...
2024-06-12 22:39:43:INFO:TRAIN-(cmcm) (1/1/4)>> loss: 4.3877
2024-06-12 22:39:46:INFO:VAL-(cmcm) >>
2024-06-12 22:39:46:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4259  Non0_F1_score: 0.2544  Mult_acc_5: 0.2140  Mult_acc_7: 0.2140  MAE: 1.4370  Corr: nan 
2024-06-12 22:39:46:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-12 22:40:02:INFO:TRAIN-(cmcm) (1/2/4)>> loss: 4.1532
2024-06-12 22:40:04:INFO:VAL-(cmcm) >>
2024-06-12 22:40:04:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4213  Non0_F1_score: 0.2525  Mult_acc_5: 0.2140  Mult_acc_7: 0.2140  MAE: 1.4414  Corr: -0.0606 
2024-06-12 22:40:19:INFO:TRAIN-(cmcm) (2/3/4)>> loss: 2.3475
2024-06-12 22:40:21:INFO:VAL-(cmcm) >>
2024-06-12 22:40:21:INFO:M: >>  Has0_acc_2: 0.5633  Has0_F1_score: 0.5482  Non0_acc_2: 0.5648  Non0_F1_score: 0.5478  Mult_acc_5: 0.2096  Mult_acc_7: 0.1703  MAE: 1.6324  Corr: 0.0302 
2024-06-12 22:40:36:INFO:TRAIN-(cmcm) (3/4/4)>> loss: 1.0301
2024-06-12 22:40:39:INFO:VAL-(cmcm) >>
2024-06-12 22:40:39:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.5640  Non0_acc_2: 0.5972  Non0_F1_score: 0.5543  Mult_acc_5: 0.2707  Mult_acc_7: 0.1921  MAE: 1.5241  Corr: 0.0916 
2024-06-12 22:40:53:INFO:TRAIN-(cmcm) (4/5/4)>> loss: 0.9401
2024-06-12 22:40:56:INFO:VAL-(cmcm) >>
2024-06-12 22:40:56:INFO:M: >>  Has0_acc_2: 0.5022  Has0_F1_score: 0.4726  Non0_acc_2: 0.5278  Non0_F1_score: 0.4976  Mult_acc_5: 0.2183  Mult_acc_7: 0.1834  MAE: 1.5567  Corr: 0.0958 
2024-06-12 22:41:11:INFO:TRAIN-(cmcm) (5/6/4)>> loss: 0.9205
2024-06-12 22:41:13:INFO:VAL-(cmcm) >>
2024-06-12 22:41:13:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4577  Non0_acc_2: 0.5833  Non0_F1_score: 0.4393  Mult_acc_5: 0.2576  Mult_acc_7: 0.2096  MAE: 1.5582  Corr: 0.0521 
2024-06-12 22:41:28:INFO:TRAIN-(cmcm) (6/7/4)>> loss: 0.9127
2024-06-12 22:41:31:INFO:VAL-(cmcm) >>
2024-06-12 22:41:31:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4805  Non0_acc_2: 0.5694  Non0_F1_score: 0.4595  Mult_acc_5: 0.2969  Mult_acc_7: 0.2140  MAE: 1.6512  Corr: -0.0195 
2024-06-12 22:41:45:INFO:TRAIN-(cmcm) (7/8/4)>> loss: 0.8991
2024-06-12 22:41:48:INFO:VAL-(cmcm) >>
2024-06-12 22:41:48:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5713  Non0_acc_2: 0.5509  Non0_F1_score: 0.5533  Mult_acc_5: 0.2140  Mult_acc_7: 0.2140  MAE: 1.5126  Corr: 0.1092 
2024-06-12 22:42:03:INFO:TRAIN-(cmcm) (8/9/4)>> loss: 0.8954
2024-06-12 22:42:05:INFO:VAL-(cmcm) >>
2024-06-12 22:42:05:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.5472  Non0_acc_2: 0.5880  Non0_F1_score: 0.5265  Mult_acc_5: 0.2445  Mult_acc_7: 0.1747  MAE: 1.6577  Corr: 0.0508 
2024-06-12 22:42:20:INFO:TRAIN-(cmcm) (9/10/4)>> loss: 0.8868
2024-06-12 22:42:23:INFO:VAL-(cmcm) >>
2024-06-12 22:42:23:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.5187  Non0_acc_2: 0.5787  Non0_F1_score: 0.4932  Mult_acc_5: 0.3100  Mult_acc_7: 0.2271  MAE: 1.7848  Corr: 0.0971 
2024-06-12 22:42:37:INFO:TRAIN-(cmcm) (10/11/4)>> loss: 0.8791
2024-06-12 22:42:40:INFO:VAL-(cmcm) >>
2024-06-12 22:42:40:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.5371  Non0_acc_2: 0.5556  Non0_F1_score: 0.5030  Mult_acc_5: 0.2620  Mult_acc_7: 0.2009  MAE: 1.6791  Corr: 0.0330 
2024-06-12 22:42:47:INFO:TEST-(cmcm) >>
2024-06-12 22:42:47:INFO:M: >>  Has0_acc_2: 0.4475  Has0_F1_score: 0.2767  Non0_acc_2: 0.5777  Non0_F1_score: 0.4231  Mult_acc_5: 0.1545  Mult_acc_7: 0.1545  MAE: 1.4174  Corr: nan 
2024-06-12 22:42:47:INFO:Results are added to results/results/mosi-regression-80.csv...
2024-06-12 22:42:47:INFO:Start running cmcm...
2024-06-12 22:42:47:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [0], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 2, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 80, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 5555}>
2024-06-12 22:42:47:INFO:Let's use the GPU 0 !
2024-06-12 22:42:48:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 22:42:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718203368 HTTP/1.1" 200 235
2024-06-12 22:42:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 22:42:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 22:42:49:INFO:train samples: (1284,)
2024-06-12 22:42:49:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 22:42:50:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718203370 HTTP/1.1" 200 235
2024-06-12 22:42:50:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 22:42:50:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 22:42:51:INFO:valid samples: (229,)
2024-06-12 22:42:51:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 22:42:51:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718203371 HTTP/1.1" 200 235
2024-06-12 22:42:51:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 22:42:52:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 22:42:52:INFO:test samples: (686,)
2024-06-12 22:42:52:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 22:42:53:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718203373 HTTP/1.1" 200 235
2024-06-12 22:42:53:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 22:42:53:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 22:42:54:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 22:42:54:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718203374 HTTP/1.1" 200 235
2024-06-12 22:42:54:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 22:42:54:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 22:42:55:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-12 22:42:55:WARNING:Try importing flash-attention for faster inference...
2024-06-12 22:42:55:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-12 22:42:55:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-12 22:42:55:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-12 22:42:56:INFO:trainable params: 1310280 || all params: 1838138952 || trainable%: 0.07128296794833386
2024-06-12 22:42:56:INFO:Init labels...
2024-06-12 22:42:56:INFO:Start training...
2024-06-12 22:43:11:INFO:TRAIN-(cmcm) (1/1/5)>> loss: 3.6044
2024-06-12 22:43:13:INFO:VAL-(cmcm) >>
2024-06-12 22:43:13:INFO:M: >>  Has0_acc_2: 0.4760  Has0_F1_score: 0.4654  Non0_acc_2: 0.5000  Non0_F1_score: 0.4567  Mult_acc_5: 0.2358  Mult_acc_7: 0.2314  MAE: 1.5156  Corr: 0.0591 
2024-06-12 22:43:14:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-12 22:43:29:INFO:TRAIN-(cmcm) (1/2/5)>> loss: 1.1530
2024-06-12 22:43:31:INFO:VAL-(cmcm) >>
2024-06-12 22:43:31:INFO:M: >>  Has0_acc_2: 0.6288  Has0_F1_score: 0.5974  Non0_acc_2: 0.6111  Non0_F1_score: 0.5793  Mult_acc_5: 0.2096  Mult_acc_7: 0.1834  MAE: 1.5459  Corr: 0.1387 
2024-06-12 22:43:46:INFO:TRAIN-(cmcm) (2/3/5)>> loss: 0.9762
2024-06-12 22:43:49:INFO:VAL-(cmcm) >>
2024-06-12 22:43:49:INFO:M: >>  Has0_acc_2: 0.4891  Has0_F1_score: 0.4810  Non0_acc_2: 0.5046  Non0_F1_score: 0.4957  Mult_acc_5: 0.1616  Mult_acc_7: 0.1572  MAE: 1.6820  Corr: 0.0631 
2024-06-12 22:44:03:INFO:TRAIN-(cmcm) (3/4/5)>> loss: 0.9153
2024-06-12 22:44:06:INFO:VAL-(cmcm) >>
2024-06-12 22:44:06:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4950  Non0_acc_2: 0.5741  Non0_F1_score: 0.4683  Mult_acc_5: 0.1441  Mult_acc_7: 0.1354  MAE: 1.5726  Corr: 0.0175 
2024-06-12 22:44:21:INFO:TRAIN-(cmcm) (4/5/5)>> loss: 0.9144
2024-06-12 22:44:23:INFO:VAL-(cmcm) >>
2024-06-12 22:44:23:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4534  Non0_acc_2: 0.5694  Non0_F1_score: 0.4246  Mult_acc_5: 0.2533  Mult_acc_7: 0.2140  MAE: 1.6197  Corr: 0.0017 
2024-06-12 22:44:38:INFO:TRAIN-(cmcm) (5/6/5)>> loss: 0.9149
2024-06-12 22:44:41:INFO:VAL-(cmcm) >>
2024-06-12 22:44:41:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5372  Non0_acc_2: 0.5602  Non0_F1_score: 0.5228  Mult_acc_5: 0.2052  Mult_acc_7: 0.1834  MAE: 1.6598  Corr: -0.0236 
2024-06-12 22:44:55:INFO:TRAIN-(cmcm) (6/7/5)>> loss: 0.8930
2024-06-12 22:44:58:INFO:VAL-(cmcm) >>
2024-06-12 22:44:58:INFO:M: >>  Has0_acc_2: 0.5590  Has0_F1_score: 0.5244  Non0_acc_2: 0.5463  Non0_F1_score: 0.5092  Mult_acc_5: 0.2926  Mult_acc_7: 0.2096  MAE: 1.7857  Corr: -0.0027 
2024-06-12 22:45:13:INFO:TRAIN-(cmcm) (7/8/5)>> loss: 0.8836
2024-06-12 22:45:15:INFO:VAL-(cmcm) >>
2024-06-12 22:45:15:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.5002  Non0_acc_2: 0.5509  Non0_F1_score: 0.4795  Mult_acc_5: 0.2052  Mult_acc_7: 0.2052  MAE: 1.4432  Corr: 0.0513 
2024-06-12 22:45:16:INFO:Saving checkpoint at epoch 8 to results/models/cmcm-mosi-regression.pth.
2024-06-12 22:45:31:INFO:TRAIN-(cmcm) (1/9/5)>> loss: 0.8898
2024-06-12 22:45:33:INFO:VAL-(cmcm) >>
2024-06-12 22:45:33:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.4584  Non0_acc_2: 0.5648  Non0_F1_score: 0.4299  Mult_acc_5: 0.2751  Mult_acc_7: 0.2009  MAE: 1.7564  Corr: -0.0746 
2024-06-12 22:45:48:INFO:TRAIN-(cmcm) (2/10/5)>> loss: 0.8768
2024-06-12 22:45:51:INFO:VAL-(cmcm) >>
2024-06-12 22:45:51:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4891  Non0_acc_2: 0.5741  Non0_F1_score: 0.4622  Mult_acc_5: 0.2882  Mult_acc_7: 0.2096  MAE: 1.7354  Corr: 0.0073 
2024-06-12 22:46:06:INFO:TRAIN-(cmcm) (3/11/5)>> loss: 0.8712
2024-06-12 22:46:08:INFO:VAL-(cmcm) >>
2024-06-12 22:46:08:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4630  Non0_acc_2: 0.5741  Non0_F1_score: 0.4346  Mult_acc_5: 0.3013  Mult_acc_7: 0.2183  MAE: 1.7092  Corr: 0.0494 
2024-06-12 22:46:23:INFO:TRAIN-(cmcm) (4/12/5)>> loss: 0.8666
2024-06-12 22:46:25:INFO:VAL-(cmcm) >>
2024-06-12 22:46:25:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5439  Non0_acc_2: 0.5602  Non0_F1_score: 0.5256  Mult_acc_5: 0.2402  Mult_acc_7: 0.2271  MAE: 1.4222  Corr: 0.1031 
2024-06-12 22:46:26:INFO:Saving checkpoint at epoch 12 to results/models/cmcm-mosi-regression.pth.
2024-06-12 22:46:41:INFO:TRAIN-(cmcm) (1/13/5)>> loss: 0.8604
2024-06-12 22:46:44:INFO:VAL-(cmcm) >>
2024-06-12 22:46:44:INFO:M: >>  Has0_acc_2: 0.6419  Has0_F1_score: 0.6335  Non0_acc_2: 0.6389  Non0_F1_score: 0.6303  Mult_acc_5: 0.3188  Mult_acc_7: 0.2402  MAE: 1.5568  Corr: 0.2041 
2024-06-12 22:46:59:INFO:TRAIN-(cmcm) (2/14/5)>> loss: 0.8687
2024-06-12 22:47:01:INFO:VAL-(cmcm) >>
2024-06-12 22:47:01:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.5032  Non0_acc_2: 0.5833  Non0_F1_score: 0.4799  Mult_acc_5: 0.2795  Mult_acc_7: 0.2052  MAE: 1.6883  Corr: 0.0504 
2024-06-12 22:47:16:INFO:TRAIN-(cmcm) (3/15/5)>> loss: 0.8633
2024-06-12 22:47:18:INFO:VAL-(cmcm) >>
2024-06-12 22:47:18:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5081  Non0_acc_2: 0.5880  Non0_F1_score: 0.5044  Mult_acc_5: 0.3013  Mult_acc_7: 0.2227  MAE: 1.7075  Corr: 0.0312 
2024-06-12 22:47:33:INFO:TRAIN-(cmcm) (4/16/5)>> loss: 0.8577
2024-06-12 22:47:36:INFO:VAL-(cmcm) >>
2024-06-12 22:47:36:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4556  Non0_acc_2: 0.5741  Non0_F1_score: 0.4346  Mult_acc_5: 0.2969  Mult_acc_7: 0.2183  MAE: 1.7127  Corr: 0.0922 
2024-06-12 22:47:50:INFO:TRAIN-(cmcm) (5/17/5)>> loss: 0.8534
2024-06-12 22:47:53:INFO:VAL-(cmcm) >>
2024-06-12 22:47:53:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4767  Non0_acc_2: 0.5741  Non0_F1_score: 0.4558  Mult_acc_5: 0.2445  Mult_acc_7: 0.2183  MAE: 1.4333  Corr: 0.1039 
2024-06-12 22:48:08:INFO:TRAIN-(cmcm) (6/18/5)>> loss: 0.8493
2024-06-12 22:48:10:INFO:VAL-(cmcm) >>
2024-06-12 22:48:10:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.5629  Non0_acc_2: 0.5787  Non0_F1_score: 0.5429  Mult_acc_5: 0.2664  Mult_acc_7: 0.1921  MAE: 1.7001  Corr: 0.0631 
2024-06-12 22:48:25:INFO:TRAIN-(cmcm) (7/19/5)>> loss: 0.8459
2024-06-12 22:48:28:INFO:VAL-(cmcm) >>
2024-06-12 22:48:28:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.5669  Non0_acc_2: 0.5880  Non0_F1_score: 0.5863  Mult_acc_5: 0.2314  Mult_acc_7: 0.1921  MAE: 1.6014  Corr: 0.1668 
2024-06-12 22:48:43:INFO:TRAIN-(cmcm) (8/20/5)>> loss: 0.8386
2024-06-12 22:48:45:INFO:VAL-(cmcm) >>
2024-06-12 22:48:45:INFO:M: >>  Has0_acc_2: 0.4672  Has0_F1_score: 0.3925  Non0_acc_2: 0.4861  Non0_F1_score: 0.4098  Mult_acc_5: 0.1790  Mult_acc_7: 0.1572  MAE: 1.6768  Corr: 0.1176 
2024-06-12 22:49:00:INFO:TRAIN-(cmcm) (9/21/5)>> loss: 0.8455
2024-06-12 22:49:02:INFO:VAL-(cmcm) >>
2024-06-12 22:49:02:INFO:M: >>  Has0_acc_2: 0.6463  Has0_F1_score: 0.6428  Non0_acc_2: 0.6481  Non0_F1_score: 0.6456  Mult_acc_5: 0.2838  Mult_acc_7: 0.2402  MAE: 1.3926  Corr: 0.2958 
2024-06-12 22:49:03:INFO:Saving checkpoint at epoch 21 to results/models/cmcm-mosi-regression.pth.
2024-06-12 22:49:18:INFO:TRAIN-(cmcm) (1/22/5)>> loss: 0.8444
2024-06-12 22:49:21:INFO:VAL-(cmcm) >>
2024-06-12 22:49:21:INFO:M: >>  Has0_acc_2: 0.4498  Has0_F1_score: 0.3542  Non0_acc_2: 0.4769  Non0_F1_score: 0.3849  Mult_acc_5: 0.1528  Mult_acc_7: 0.1354  MAE: 1.7370  Corr: 0.1217 
2024-06-12 22:49:36:INFO:TRAIN-(cmcm) (2/23/5)>> loss: 0.8385
2024-06-12 22:49:38:INFO:VAL-(cmcm) >>
2024-06-12 22:49:38:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.5512  Non0_acc_2: 0.5417  Non0_F1_score: 0.5347  Mult_acc_5: 0.2445  Mult_acc_7: 0.2140  MAE: 1.4641  Corr: 0.1619 
2024-06-12 22:49:53:INFO:TRAIN-(cmcm) (3/24/5)>> loss: 0.8285
2024-06-12 22:49:56:INFO:VAL-(cmcm) >>
2024-06-12 22:49:56:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.5597  Non0_acc_2: 0.6065  Non0_F1_score: 0.5913  Mult_acc_5: 0.2271  Mult_acc_7: 0.1965  MAE: 1.5206  Corr: 0.2715 
2024-06-12 22:50:10:INFO:TRAIN-(cmcm) (4/25/5)>> loss: 0.8283
2024-06-12 22:50:13:INFO:VAL-(cmcm) >>
2024-06-12 22:50:13:INFO:M: >>  Has0_acc_2: 0.6463  Has0_F1_score: 0.6419  Non0_acc_2: 0.6667  Non0_F1_score: 0.6643  Mult_acc_5: 0.3493  Mult_acc_7: 0.2620  MAE: 1.4533  Corr: 0.3168 
2024-06-12 22:50:28:INFO:TRAIN-(cmcm) (5/26/5)>> loss: 0.8221
2024-06-12 22:50:30:INFO:VAL-(cmcm) >>
2024-06-12 22:50:30:INFO:M: >>  Has0_acc_2: 0.6900  Has0_F1_score: 0.6798  Non0_acc_2: 0.6944  Non0_F1_score: 0.6916  Mult_acc_5: 0.3231  Mult_acc_7: 0.2707  MAE: 1.2582  Corr: 0.4197 
2024-06-12 22:50:31:INFO:Saving checkpoint at epoch 26 to results/models/cmcm-mosi-regression.pth.
2024-06-12 22:50:46:INFO:TRAIN-(cmcm) (1/27/5)>> loss: 0.8189
2024-06-12 22:50:49:INFO:VAL-(cmcm) >>
2024-06-12 22:50:49:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.5889  Non0_acc_2: 0.6389  Non0_F1_score: 0.6308  Mult_acc_5: 0.2838  Mult_acc_7: 0.2445  MAE: 1.4127  Corr: 0.3492 
2024-06-12 22:51:03:INFO:TRAIN-(cmcm) (2/28/5)>> loss: 0.8063
2024-06-12 22:51:06:INFO:VAL-(cmcm) >>
2024-06-12 22:51:06:INFO:M: >>  Has0_acc_2: 0.7031  Has0_F1_score: 0.7059  Non0_acc_2: 0.6898  Non0_F1_score: 0.6904  Mult_acc_5: 0.3362  Mult_acc_7: 0.2969  MAE: 1.2621  Corr: 0.4524 
2024-06-12 22:51:21:INFO:TRAIN-(cmcm) (3/29/5)>> loss: 0.8017
2024-06-12 22:51:23:INFO:VAL-(cmcm) >>
2024-06-12 22:51:23:INFO:M: >>  Has0_acc_2: 0.6725  Has0_F1_score: 0.6665  Non0_acc_2: 0.6806  Non0_F1_score: 0.6772  Mult_acc_5: 0.3362  Mult_acc_7: 0.2751  MAE: 1.3664  Corr: 0.3918 
2024-06-12 22:51:38:INFO:TRAIN-(cmcm) (4/30/5)>> loss: 0.7993
2024-06-12 22:51:41:INFO:VAL-(cmcm) >>
2024-06-12 22:51:41:INFO:M: >>  Has0_acc_2: 0.6987  Has0_F1_score: 0.6994  Non0_acc_2: 0.6296  Non0_F1_score: 0.6254  Mult_acc_5: 0.3319  Mult_acc_7: 0.2882  MAE: 1.2516  Corr: 0.4298 
2024-06-12 22:51:41:INFO:Saving checkpoint at epoch 30 to results/models/cmcm-mosi-regression.pth.
2024-06-12 22:51:56:INFO:TRAIN-(cmcm) (1/31/5)>> loss: 0.7897
2024-06-12 22:51:59:INFO:VAL-(cmcm) >>
2024-06-12 22:51:59:INFO:M: >>  Has0_acc_2: 0.7031  Has0_F1_score: 0.7031  Non0_acc_2: 0.6898  Non0_F1_score: 0.6910  Mult_acc_5: 0.3493  Mult_acc_7: 0.2926  MAE: 1.1830  Corr: 0.4744 
2024-06-12 22:51:59:INFO:Saving checkpoint at epoch 31 to results/models/cmcm-mosi-regression.pth.
2024-06-12 22:52:15:INFO:TRAIN-(cmcm) (1/32/5)>> loss: 0.7813
2024-06-12 22:52:17:INFO:VAL-(cmcm) >>
2024-06-12 22:52:17:INFO:M: >>  Has0_acc_2: 0.6856  Has0_F1_score: 0.6747  Non0_acc_2: 0.6898  Non0_F1_score: 0.6865  Mult_acc_5: 0.3057  Mult_acc_7: 0.2576  MAE: 1.3027  Corr: 0.4122 
2024-06-12 22:52:32:INFO:TRAIN-(cmcm) (2/33/5)>> loss: 0.7760
2024-06-12 22:52:34:INFO:VAL-(cmcm) >>
2024-06-12 22:52:34:INFO:M: >>  Has0_acc_2: 0.7293  Has0_F1_score: 0.7305  Non0_acc_2: 0.7454  Non0_F1_score: 0.7455  Mult_acc_5: 0.3406  Mult_acc_7: 0.2795  MAE: 1.1848  Corr: 0.5059 
2024-06-12 22:52:49:INFO:TRAIN-(cmcm) (3/34/5)>> loss: 0.7847
2024-06-12 22:52:52:INFO:VAL-(cmcm) >>
2024-06-12 22:52:52:INFO:M: >>  Has0_acc_2: 0.7031  Has0_F1_score: 0.7059  Non0_acc_2: 0.7176  Non0_F1_score: 0.7191  Mult_acc_5: 0.3275  Mult_acc_7: 0.2664  MAE: 1.2411  Corr: 0.4273 
2024-06-12 22:53:07:INFO:TRAIN-(cmcm) (4/35/5)>> loss: 0.7678
2024-06-12 22:53:09:INFO:VAL-(cmcm) >>
2024-06-12 22:53:09:INFO:M: >>  Has0_acc_2: 0.7424  Has0_F1_score: 0.7448  Non0_acc_2: 0.7500  Non0_F1_score: 0.7510  Mult_acc_5: 0.3581  Mult_acc_7: 0.3188  MAE: 1.1883  Corr: 0.4871 
2024-06-12 22:53:24:INFO:TRAIN-(cmcm) (5/36/5)>> loss: 0.7553
2024-06-12 22:53:26:INFO:VAL-(cmcm) >>
2024-06-12 22:53:26:INFO:M: >>  Has0_acc_2: 0.7336  Has0_F1_score: 0.7358  Non0_acc_2: 0.7500  Non0_F1_score: 0.7512  Mult_acc_5: 0.3450  Mult_acc_7: 0.2969  MAE: 1.1350  Corr: 0.5346 
2024-06-12 22:53:27:INFO:Saving checkpoint at epoch 36 to results/models/cmcm-mosi-regression.pth.
2024-06-12 22:53:42:INFO:TRAIN-(cmcm) (1/37/5)>> loss: 0.7553
2024-06-12 22:53:45:INFO:VAL-(cmcm) >>
2024-06-12 22:53:45:INFO:M: >>  Has0_acc_2: 0.7162  Has0_F1_score: 0.7188  Non0_acc_2: 0.7454  Non0_F1_score: 0.7468  Mult_acc_5: 0.3668  Mult_acc_7: 0.2926  MAE: 1.1713  Corr: 0.5226 
2024-06-12 22:54:00:INFO:TRAIN-(cmcm) (2/38/5)>> loss: 0.7490
2024-06-12 22:54:02:INFO:VAL-(cmcm) >>
2024-06-12 22:54:02:INFO:M: >>  Has0_acc_2: 0.7380  Has0_F1_score: 0.7299  Non0_acc_2: 0.7639  Non0_F1_score: 0.7552  Mult_acc_5: 0.3974  Mult_acc_7: 0.3057  MAE: 1.1664  Corr: 0.5369 
2024-06-12 22:54:17:INFO:TRAIN-(cmcm) (3/39/5)>> loss: 0.7464
2024-06-12 22:54:19:INFO:VAL-(cmcm) >>
2024-06-12 22:54:19:INFO:M: >>  Has0_acc_2: 0.7380  Has0_F1_score: 0.7289  Non0_acc_2: 0.7546  Non0_F1_score: 0.7492  Mult_acc_5: 0.3799  Mult_acc_7: 0.3231  MAE: 1.1210  Corr: 0.5534 
2024-06-12 22:54:20:INFO:Saving checkpoint at epoch 39 to results/models/cmcm-mosi-regression.pth.
2024-06-12 22:54:35:INFO:TRAIN-(cmcm) (1/40/5)>> loss: 0.7328
2024-06-12 22:54:38:INFO:VAL-(cmcm) >>
2024-06-12 22:54:38:INFO:M: >>  Has0_acc_2: 0.7686  Has0_F1_score: 0.7674  Non0_acc_2: 0.7546  Non0_F1_score: 0.7548  Mult_acc_5: 0.3362  Mult_acc_7: 0.2795  MAE: 1.1599  Corr: 0.5242 
2024-06-12 22:54:53:INFO:TRAIN-(cmcm) (2/41/5)>> loss: 0.7234
2024-06-12 22:54:55:INFO:VAL-(cmcm) >>
2024-06-12 22:54:55:INFO:M: >>  Has0_acc_2: 0.7293  Has0_F1_score: 0.7317  Non0_acc_2: 0.7593  Non0_F1_score: 0.7604  Mult_acc_5: 0.3406  Mult_acc_7: 0.2795  MAE: 1.1804  Corr: 0.5326 
2024-06-12 22:55:10:INFO:TRAIN-(cmcm) (3/42/5)>> loss: 0.7254
2024-06-12 22:55:13:INFO:VAL-(cmcm) >>
2024-06-12 22:55:13:INFO:M: >>  Has0_acc_2: 0.7074  Has0_F1_score: 0.7101  Non0_acc_2: 0.7454  Non0_F1_score: 0.7468  Mult_acc_5: 0.3712  Mult_acc_7: 0.2969  MAE: 1.1455  Corr: 0.5353 
2024-06-12 22:55:27:INFO:TRAIN-(cmcm) (4/43/5)>> loss: 0.7150
2024-06-12 22:55:30:INFO:VAL-(cmcm) >>
2024-06-12 22:55:30:INFO:M: >>  Has0_acc_2: 0.7293  Has0_F1_score: 0.7319  Non0_acc_2: 0.7454  Non0_F1_score: 0.7467  Mult_acc_5: 0.3231  Mult_acc_7: 0.2838  MAE: 1.1988  Corr: 0.4724 
2024-06-12 22:55:45:INFO:TRAIN-(cmcm) (5/44/5)>> loss: 0.7121
2024-06-12 22:55:47:INFO:VAL-(cmcm) >>
2024-06-12 22:55:47:INFO:M: >>  Has0_acc_2: 0.7118  Has0_F1_score: 0.7145  Non0_acc_2: 0.7130  Non0_F1_score: 0.7139  Mult_acc_5: 0.3450  Mult_acc_7: 0.2620  MAE: 1.1778  Corr: 0.5169 
2024-06-12 22:56:02:INFO:TRAIN-(cmcm) (6/45/5)>> loss: 0.7190
2024-06-12 22:56:05:INFO:VAL-(cmcm) >>
2024-06-12 22:56:05:INFO:M: >>  Has0_acc_2: 0.7249  Has0_F1_score: 0.7275  Non0_acc_2: 0.6620  Non0_F1_score: 0.6550  Mult_acc_5: 0.2795  Mult_acc_7: 0.2314  MAE: 1.2485  Corr: 0.4945 
2024-06-12 22:56:19:INFO:TRAIN-(cmcm) (7/46/5)>> loss: 0.6994
2024-06-12 22:56:22:INFO:VAL-(cmcm) >>
2024-06-12 22:56:22:INFO:M: >>  Has0_acc_2: 0.7205  Has0_F1_score: 0.7230  Non0_acc_2: 0.6620  Non0_F1_score: 0.6569  Mult_acc_5: 0.3100  Mult_acc_7: 0.2707  MAE: 1.1761  Corr: 0.4992 
2024-06-12 22:56:37:INFO:TRAIN-(cmcm) (8/47/5)>> loss: 0.6920
2024-06-12 22:56:39:INFO:VAL-(cmcm) >>
2024-06-12 22:56:39:INFO:M: >>  Has0_acc_2: 0.7424  Has0_F1_score: 0.7405  Non0_acc_2: 0.7222  Non0_F1_score: 0.7226  Mult_acc_5: 0.3712  Mult_acc_7: 0.3144  MAE: 1.1354  Corr: 0.5033 
2024-06-12 22:56:54:INFO:TRAIN-(cmcm) (9/48/5)>> loss: 0.6798
2024-06-12 22:56:56:INFO:VAL-(cmcm) >>
2024-06-12 22:56:56:INFO:M: >>  Has0_acc_2: 0.7162  Has0_F1_score: 0.7189  Non0_acc_2: 0.7269  Non0_F1_score: 0.7282  Mult_acc_5: 0.3362  Mult_acc_7: 0.2795  MAE: 1.1547  Corr: 0.5094 
2024-06-12 22:57:11:INFO:TRAIN-(cmcm) (10/49/5)>> loss: 0.6759
2024-06-12 22:57:14:INFO:VAL-(cmcm) >>
2024-06-12 22:57:14:INFO:M: >>  Has0_acc_2: 0.7336  Has0_F1_score: 0.7360  Non0_acc_2: 0.7639  Non0_F1_score: 0.7649  Mult_acc_5: 0.3057  Mult_acc_7: 0.2620  MAE: 1.1298  Corr: 0.5436 
2024-06-12 22:57:21:INFO:TEST-(cmcm) >>
2024-06-12 22:57:21:INFO:M: >>  Has0_acc_2: 0.6516  Has0_F1_score: 0.6469  Non0_acc_2: 0.6707  Non0_F1_score: 0.6709  Mult_acc_5: 0.2755  Mult_acc_7: 0.2493  MAE: 1.3408  Corr: 0.4339 
2024-06-12 22:57:21:INFO:Results are added to results/results/mosi-regression-80.csv...
2024-06-12 22:57:21:INFO:Start running cmcm...
2024-06-12 22:57:21:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [0], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 2, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 90, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-06-12 22:57:21:INFO:Let's use the GPU 0 !
2024-06-12 22:57:21:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 22:57:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718204242 HTTP/1.1" 200 235
2024-06-12 22:57:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 22:57:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 22:57:23:INFO:train samples: (1284,)
2024-06-12 22:57:23:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 22:57:23:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718204244 HTTP/1.1" 200 235
2024-06-12 22:57:24:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 22:57:24:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 22:57:24:INFO:valid samples: (229,)
2024-06-12 22:57:25:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 22:57:25:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718204245 HTTP/1.1" 200 235
2024-06-12 22:57:25:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 22:57:25:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 22:57:26:INFO:test samples: (686,)
2024-06-12 22:57:26:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 22:57:26:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718204246 HTTP/1.1" 200 235
2024-06-12 22:57:26:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 22:57:27:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 22:57:27:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 22:57:28:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718204248 HTTP/1.1" 200 235
2024-06-12 22:57:28:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 22:57:28:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 22:57:28:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-12 22:57:28:WARNING:Try importing flash-attention for faster inference...
2024-06-12 22:57:28:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-12 22:57:28:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-12 22:57:28:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-12 22:57:29:INFO:trainable params: 1310280 || all params: 1838138952 || trainable%: 0.07128296794833386
2024-06-12 22:57:29:INFO:Init labels...
2024-06-12 22:57:29:INFO:Start training...
2024-06-12 22:57:44:INFO:TRAIN-(cmcm) (1/1/1)>> loss: 4.1839
2024-06-12 22:57:47:INFO:VAL-(cmcm) >>
2024-06-12 22:57:47:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4259  Non0_F1_score: 0.2544  Mult_acc_5: 0.2140  Mult_acc_7: 0.2140  MAE: 1.4370  Corr: nan 
2024-06-12 22:57:47:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-12 22:58:02:INFO:TRAIN-(cmcm) (1/2/1)>> loss: 2.3026
2024-06-12 22:58:05:INFO:VAL-(cmcm) >>
2024-06-12 22:58:05:INFO:M: >>  Has0_acc_2: 0.4541  Has0_F1_score: 0.4387  Non0_acc_2: 0.4583  Non0_F1_score: 0.4328  Mult_acc_5: 0.1834  Mult_acc_7: 0.1572  MAE: 1.8436  Corr: -0.0358 
2024-06-12 22:58:20:INFO:TRAIN-(cmcm) (2/3/1)>> loss: 1.0444
2024-06-12 22:58:22:INFO:VAL-(cmcm) >>
2024-06-12 22:58:22:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.5576  Non0_acc_2: 0.5694  Non0_F1_score: 0.5408  Mult_acc_5: 0.2096  Mult_acc_7: 0.1921  MAE: 1.6436  Corr: -0.0127 
2024-06-12 22:58:37:INFO:TRAIN-(cmcm) (3/4/1)>> loss: 0.9670
2024-06-12 22:58:39:INFO:VAL-(cmcm) >>
2024-06-12 22:58:39:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.4769  Non0_acc_2: 0.5880  Non0_F1_score: 0.4494  Mult_acc_5: 0.2402  Mult_acc_7: 0.1747  MAE: 1.6459  Corr: 0.0238 
2024-06-12 22:58:54:INFO:TRAIN-(cmcm) (4/5/1)>> loss: 0.9185
2024-06-12 22:58:57:INFO:VAL-(cmcm) >>
2024-06-12 22:58:57:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4830  Non0_acc_2: 0.5741  Non0_F1_score: 0.4558  Mult_acc_5: 0.2445  Mult_acc_7: 0.1878  MAE: 1.6567  Corr: -0.0268 
2024-06-12 22:59:12:INFO:TRAIN-(cmcm) (5/6/1)>> loss: 0.8956
2024-06-12 22:59:14:INFO:VAL-(cmcm) >>
2024-06-12 22:59:14:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5621  Non0_acc_2: 0.5787  Non0_F1_score: 0.5456  Mult_acc_5: 0.2533  Mult_acc_7: 0.2009  MAE: 1.7301  Corr: 0.0290 
2024-06-12 22:59:29:INFO:TRAIN-(cmcm) (6/7/1)>> loss: 0.8990
2024-06-12 22:59:31:INFO:VAL-(cmcm) >>
2024-06-12 22:59:31:INFO:M: >>  Has0_acc_2: 0.5633  Has0_F1_score: 0.5444  Non0_acc_2: 0.5556  Non0_F1_score: 0.5342  Mult_acc_5: 0.2402  Mult_acc_7: 0.1878  MAE: 1.6957  Corr: 0.0325 
2024-06-12 22:59:46:INFO:TRAIN-(cmcm) (7/8/1)>> loss: 0.8804
2024-06-12 22:59:49:INFO:VAL-(cmcm) >>
2024-06-12 22:59:49:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4742  Non0_acc_2: 0.5602  Non0_F1_score: 0.4414  Mult_acc_5: 0.2795  Mult_acc_7: 0.2358  MAE: 1.6156  Corr: -0.0436 
2024-06-12 23:00:03:INFO:TRAIN-(cmcm) (8/9/1)>> loss: 0.8806
2024-06-12 23:00:06:INFO:VAL-(cmcm) >>
2024-06-12 23:00:06:INFO:M: >>  Has0_acc_2: 0.5633  Has0_F1_score: 0.5402  Non0_acc_2: 0.5509  Non0_F1_score: 0.5304  Mult_acc_5: 0.2096  Mult_acc_7: 0.1703  MAE: 1.6979  Corr: -0.0198 
2024-06-12 23:00:21:INFO:TRAIN-(cmcm) (9/10/1)>> loss: 0.8758
2024-06-12 23:00:23:INFO:VAL-(cmcm) >>
2024-06-12 23:00:23:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.4746  Non0_acc_2: 0.5833  Non0_F1_score: 0.4469  Mult_acc_5: 0.2533  Mult_acc_7: 0.2009  MAE: 1.6542  Corr: 0.0100 
2024-06-12 23:00:38:INFO:TRAIN-(cmcm) (10/11/1)>> loss: 0.8693
2024-06-12 23:00:41:INFO:VAL-(cmcm) >>
2024-06-12 23:00:41:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5741  Non0_F1_score: 0.4187  Mult_acc_5: 0.3013  Mult_acc_7: 0.2183  MAE: 1.8324  Corr: 0.0060 
2024-06-12 23:00:48:INFO:TEST-(cmcm) >>
2024-06-12 23:00:48:INFO:M: >>  Has0_acc_2: 0.4475  Has0_F1_score: 0.2767  Non0_acc_2: 0.5777  Non0_F1_score: 0.4231  Mult_acc_5: 0.1545  Mult_acc_7: 0.1545  MAE: 1.4174  Corr: nan 
2024-06-12 23:00:48:INFO:Results are added to results/results/mosi-regression-90.csv...
2024-06-12 23:00:48:INFO:Start running cmcm...
2024-06-12 23:00:48:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [0], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 2, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 90, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 2222}>
2024-06-12 23:00:48:INFO:Let's use the GPU 0 !
2024-06-12 23:00:48:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 23:00:49:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718204449 HTTP/1.1" 200 235
2024-06-12 23:00:49:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 23:00:49:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 23:00:50:INFO:train samples: (1284,)
2024-06-12 23:00:50:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 23:00:50:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718204450 HTTP/1.1" 200 235
2024-06-12 23:00:50:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 23:00:51:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 23:00:51:INFO:valid samples: (229,)
2024-06-12 23:00:52:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 23:00:52:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718204452 HTTP/1.1" 200 235
2024-06-12 23:00:52:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 23:00:52:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 23:00:53:INFO:test samples: (686,)
2024-06-12 23:00:53:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 23:00:53:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718204453 HTTP/1.1" 200 235
2024-06-12 23:00:54:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 23:00:54:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 23:00:54:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 23:00:55:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718204455 HTTP/1.1" 200 235
2024-06-12 23:00:55:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 23:00:55:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 23:00:55:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-12 23:00:55:WARNING:Try importing flash-attention for faster inference...
2024-06-12 23:00:55:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-12 23:00:55:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-12 23:00:55:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-12 23:00:56:INFO:trainable params: 1310280 || all params: 1838138952 || trainable%: 0.07128296794833386
2024-06-12 23:00:56:INFO:Init labels...
2024-06-12 23:00:56:INFO:Start training...
2024-06-12 23:01:11:INFO:TRAIN-(cmcm) (1/1/2)>> loss: 4.2134
2024-06-12 23:01:14:INFO:VAL-(cmcm) >>
2024-06-12 23:01:14:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4259  Non0_F1_score: 0.2544  Mult_acc_5: 0.2140  Mult_acc_7: 0.2140  MAE: 1.4370  Corr: nan 
2024-06-12 23:01:14:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-12 23:01:29:INFO:TRAIN-(cmcm) (1/2/2)>> loss: 2.6244
2024-06-12 23:01:32:INFO:VAL-(cmcm) >>
2024-06-12 23:01:32:INFO:M: >>  Has0_acc_2: 0.5633  Has0_F1_score: 0.4737  Non0_acc_2: 0.5093  Non0_F1_score: 0.4807  Mult_acc_5: 0.2052  Mult_acc_7: 0.1965  MAE: 1.5462  Corr: -0.0898 
2024-06-12 23:01:47:INFO:TRAIN-(cmcm) (2/3/2)>> loss: 1.0838
2024-06-12 23:01:49:INFO:VAL-(cmcm) >>
2024-06-12 23:01:49:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.5733  Non0_acc_2: 0.5694  Non0_F1_score: 0.5659  Mult_acc_5: 0.2271  Mult_acc_7: 0.1747  MAE: 1.6708  Corr: 0.0700 
2024-06-12 23:02:04:INFO:TRAIN-(cmcm) (3/4/2)>> loss: 0.9620
2024-06-12 23:02:07:INFO:VAL-(cmcm) >>
2024-06-12 23:02:07:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.4897  Non0_acc_2: 0.5648  Non0_F1_score: 0.4684  Mult_acc_5: 0.2533  Mult_acc_7: 0.1878  MAE: 1.6341  Corr: 0.0113 
2024-06-12 23:02:21:INFO:TRAIN-(cmcm) (4/5/2)>> loss: 0.9340
2024-06-12 23:02:24:INFO:VAL-(cmcm) >>
2024-06-12 23:02:24:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4950  Non0_acc_2: 0.5926  Non0_F1_score: 0.5215  Mult_acc_5: 0.2533  Mult_acc_7: 0.1965  MAE: 1.6189  Corr: 0.0386 
2024-06-12 23:02:39:INFO:TRAIN-(cmcm) (5/6/2)>> loss: 0.9442
2024-06-12 23:02:41:INFO:VAL-(cmcm) >>
2024-06-12 23:02:41:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5271  Non0_acc_2: 0.5694  Non0_F1_score: 0.5052  Mult_acc_5: 0.2926  Mult_acc_7: 0.2096  MAE: 1.6983  Corr: 0.0492 
2024-06-12 23:02:56:INFO:TRAIN-(cmcm) (6/7/2)>> loss: 0.9011
2024-06-12 23:02:58:INFO:VAL-(cmcm) >>
2024-06-12 23:02:58:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5870  Non0_acc_2: 0.5880  Non0_F1_score: 0.5836  Mult_acc_5: 0.2707  Mult_acc_7: 0.2227  MAE: 1.5857  Corr: 0.1115 
2024-06-12 23:03:13:INFO:TRAIN-(cmcm) (7/8/2)>> loss: 0.8990
2024-06-12 23:03:16:INFO:VAL-(cmcm) >>
2024-06-12 23:03:16:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4676  Non0_acc_2: 0.5694  Non0_F1_score: 0.4396  Mult_acc_5: 0.1878  Mult_acc_7: 0.1659  MAE: 1.6468  Corr: -0.0100 
2024-06-12 23:03:31:INFO:TRAIN-(cmcm) (8/9/2)>> loss: 0.8849
2024-06-12 23:03:33:INFO:VAL-(cmcm) >>
2024-06-12 23:03:33:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4891  Non0_acc_2: 0.5741  Non0_F1_score: 0.4622  Mult_acc_5: 0.1921  Mult_acc_7: 0.1878  MAE: 1.5241  Corr: 0.0975 
2024-06-12 23:03:48:INFO:TRAIN-(cmcm) (9/10/2)>> loss: 0.8831
2024-06-12 23:03:50:INFO:VAL-(cmcm) >>
2024-06-12 23:03:50:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5003  Non0_acc_2: 0.5648  Non0_F1_score: 0.4739  Mult_acc_5: 0.2969  Mult_acc_7: 0.2183  MAE: 1.7092  Corr: -0.0265 
2024-06-12 23:04:05:INFO:TRAIN-(cmcm) (10/11/2)>> loss: 0.8936
2024-06-12 23:04:08:INFO:VAL-(cmcm) >>
2024-06-12 23:04:08:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.5873  Non0_acc_2: 0.5926  Non0_F1_score: 0.5926  Mult_acc_5: 0.2795  Mult_acc_7: 0.2140  MAE: 1.6311  Corr: 0.1310 
2024-06-12 23:04:15:INFO:TEST-(cmcm) >>
2024-06-12 23:04:15:INFO:M: >>  Has0_acc_2: 0.4475  Has0_F1_score: 0.2767  Non0_acc_2: 0.5777  Non0_F1_score: 0.4231  Mult_acc_5: 0.1545  Mult_acc_7: 0.1545  MAE: 1.4174  Corr: nan 
2024-06-12 23:04:15:INFO:Results are added to results/results/mosi-regression-90.csv...
2024-06-12 23:04:15:INFO:Start running cmcm...
2024-06-12 23:04:15:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [0], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 2, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 90, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 3333}>
2024-06-12 23:04:15:INFO:Let's use the GPU 0 !
2024-06-12 23:04:15:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 23:04:16:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718204656 HTTP/1.1" 200 235
2024-06-12 23:04:16:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 23:04:16:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 23:04:17:INFO:train samples: (1284,)
2024-06-12 23:04:17:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 23:04:17:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718204657 HTTP/1.1" 200 235
2024-06-12 23:04:18:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 23:04:18:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 23:04:19:INFO:valid samples: (229,)
2024-06-12 23:04:19:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 23:04:19:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718204659 HTTP/1.1" 200 235
2024-06-12 23:04:19:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 23:04:20:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 23:04:20:INFO:test samples: (686,)
2024-06-12 23:04:20:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 23:04:20:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718204661 HTTP/1.1" 200 235
2024-06-12 23:04:21:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 23:04:21:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 23:04:21:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 23:04:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718204662 HTTP/1.1" 200 235
2024-06-12 23:04:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 23:04:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 23:04:22:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-12 23:04:22:WARNING:Try importing flash-attention for faster inference...
2024-06-12 23:04:22:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-12 23:04:22:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-12 23:04:22:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-12 23:04:24:INFO:trainable params: 1310280 || all params: 1838138952 || trainable%: 0.07128296794833386
2024-06-12 23:04:24:INFO:Init labels...
2024-06-12 23:04:24:INFO:Start training...
2024-06-12 23:04:38:INFO:TRAIN-(cmcm) (1/1/3)>> loss: 4.1686
2024-06-12 23:04:41:INFO:VAL-(cmcm) >>
2024-06-12 23:04:41:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4259  Non0_F1_score: 0.2544  Mult_acc_5: 0.2140  Mult_acc_7: 0.2140  MAE: 1.4370  Corr: nan 
2024-06-12 23:04:41:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-12 23:04:57:INFO:TRAIN-(cmcm) (1/2/3)>> loss: 2.4073
2024-06-12 23:04:59:INFO:VAL-(cmcm) >>
2024-06-12 23:04:59:INFO:M: >>  Has0_acc_2: 0.5371  Has0_F1_score: 0.5363  Non0_acc_2: 0.5370  Non0_F1_score: 0.5347  Mult_acc_5: 0.1878  Mult_acc_7: 0.1747  MAE: 1.5490  Corr: 0.0494 
2024-06-12 23:05:14:INFO:TRAIN-(cmcm) (2/3/3)>> loss: 1.0164
2024-06-12 23:05:16:INFO:VAL-(cmcm) >>
2024-06-12 23:05:16:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5261  Non0_acc_2: 0.5787  Non0_F1_score: 0.5117  Mult_acc_5: 0.2664  Mult_acc_7: 0.2096  MAE: 1.6726  Corr: 0.0392 
2024-06-12 23:05:31:INFO:TRAIN-(cmcm) (3/4/3)>> loss: 0.9406
2024-06-12 23:05:34:INFO:VAL-(cmcm) >>
2024-06-12 23:05:34:INFO:M: >>  Has0_acc_2: 0.5459  Has0_F1_score: 0.5194  Non0_acc_2: 0.4676  Non0_F1_score: 0.4705  Mult_acc_5: 0.1790  Mult_acc_7: 0.1703  MAE: 1.5820  Corr: 0.0204 
2024-06-12 23:05:48:INFO:TRAIN-(cmcm) (4/5/3)>> loss: 0.9162
2024-06-12 23:05:51:INFO:VAL-(cmcm) >>
2024-06-12 23:05:51:INFO:M: >>  Has0_acc_2: 0.4672  Has0_F1_score: 0.4356  Non0_acc_2: 0.4861  Non0_F1_score: 0.4546  Mult_acc_5: 0.1572  Mult_acc_7: 0.1441  MAE: 1.7817  Corr: 0.0632 
2024-06-12 23:06:06:INFO:TRAIN-(cmcm) (5/6/3)>> loss: 0.9030
2024-06-12 23:06:08:INFO:VAL-(cmcm) >>
2024-06-12 23:06:08:INFO:M: >>  Has0_acc_2: 0.5066  Has0_F1_score: 0.5057  Non0_acc_2: 0.5231  Non0_F1_score: 0.5204  Mult_acc_5: 0.2533  Mult_acc_7: 0.1790  MAE: 1.9197  Corr: 0.0814 
2024-06-12 23:06:23:INFO:TRAIN-(cmcm) (6/7/3)>> loss: 0.8852
2024-06-12 23:06:26:INFO:VAL-(cmcm) >>
2024-06-12 23:06:26:INFO:M: >>  Has0_acc_2: 0.5459  Has0_F1_score: 0.5498  Non0_acc_2: 0.5463  Non0_F1_score: 0.5482  Mult_acc_5: 0.2489  Mult_acc_7: 0.1921  MAE: 1.8228  Corr: 0.0895 
2024-06-12 23:06:40:INFO:TRAIN-(cmcm) (7/8/3)>> loss: 0.8819
2024-06-12 23:06:43:INFO:VAL-(cmcm) >>
2024-06-12 23:06:43:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.5339  Non0_acc_2: 0.5972  Non0_F1_score: 0.5290  Mult_acc_5: 0.2183  Mult_acc_7: 0.1878  MAE: 1.5691  Corr: 0.0430 
2024-06-12 23:06:58:INFO:TRAIN-(cmcm) (8/9/3)>> loss: 0.8800
2024-06-12 23:07:00:INFO:VAL-(cmcm) >>
2024-06-12 23:07:00:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4917  Non0_acc_2: 0.4306  Non0_F1_score: 0.3358  Mult_acc_5: 0.1965  Mult_acc_7: 0.1965  MAE: 1.4528  Corr: 0.0085 
2024-06-12 23:07:15:INFO:TRAIN-(cmcm) (9/10/3)>> loss: 0.8707
2024-06-12 23:07:18:INFO:VAL-(cmcm) >>
2024-06-12 23:07:18:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4855  Non0_acc_2: 0.5787  Non0_F1_score: 0.4584  Mult_acc_5: 0.2402  Mult_acc_7: 0.1878  MAE: 1.6726  Corr: 0.0090 
2024-06-12 23:07:33:INFO:TRAIN-(cmcm) (10/11/3)>> loss: 0.8665
2024-06-12 23:07:35:INFO:VAL-(cmcm) >>
2024-06-12 23:07:35:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5479  Non0_acc_2: 0.5787  Non0_F1_score: 0.5306  Mult_acc_5: 0.3057  Mult_acc_7: 0.2183  MAE: 1.6590  Corr: 0.0866 
2024-06-12 23:07:43:INFO:TEST-(cmcm) >>
2024-06-12 23:07:43:INFO:M: >>  Has0_acc_2: 0.4475  Has0_F1_score: 0.2767  Non0_acc_2: 0.5777  Non0_F1_score: 0.4231  Mult_acc_5: 0.1545  Mult_acc_7: 0.1545  MAE: 1.4174  Corr: nan 
2024-06-12 23:07:43:INFO:Results are added to results/results/mosi-regression-90.csv...
2024-06-12 23:07:43:INFO:Start running cmcm...
2024-06-12 23:07:43:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [0], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 2, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 90, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 4444}>
2024-06-12 23:07:43:INFO:Let's use the GPU 0 !
2024-06-12 23:07:43:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 23:07:44:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718204864 HTTP/1.1" 200 235
2024-06-12 23:07:44:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 23:07:44:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 23:07:45:INFO:train samples: (1284,)
2024-06-12 23:07:45:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 23:07:45:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718204866 HTTP/1.1" 200 235
2024-06-12 23:07:46:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 23:07:46:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 23:07:47:INFO:valid samples: (229,)
2024-06-12 23:07:47:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 23:07:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718204867 HTTP/1.1" 200 235
2024-06-12 23:07:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 23:07:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 23:07:48:INFO:test samples: (686,)
2024-06-12 23:07:48:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 23:07:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718204869 HTTP/1.1" 200 235
2024-06-12 23:07:49:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 23:07:49:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 23:07:50:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 23:07:50:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718204870 HTTP/1.1" 200 235
2024-06-12 23:07:50:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 23:07:51:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 23:07:51:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-12 23:07:51:WARNING:Try importing flash-attention for faster inference...
2024-06-12 23:07:51:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-12 23:07:51:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-12 23:07:51:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-12 23:07:52:INFO:trainable params: 1310280 || all params: 1838138952 || trainable%: 0.07128296794833386
2024-06-12 23:07:52:INFO:Init labels...
2024-06-12 23:07:52:INFO:Start training...
2024-06-12 23:08:07:INFO:TRAIN-(cmcm) (1/1/4)>> loss: 4.3907
2024-06-12 23:08:09:INFO:VAL-(cmcm) >>
2024-06-12 23:08:09:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4259  Non0_F1_score: 0.2544  Mult_acc_5: 0.2140  Mult_acc_7: 0.2140  MAE: 1.4370  Corr: nan 
2024-06-12 23:08:10:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-12 23:08:25:INFO:TRAIN-(cmcm) (1/2/4)>> loss: 4.1979
2024-06-12 23:08:28:INFO:VAL-(cmcm) >>
2024-06-12 23:08:28:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4259  Non0_F1_score: 0.2544  Mult_acc_5: 0.2140  Mult_acc_7: 0.2140  MAE: 1.4370  Corr: nan 
2024-06-12 23:08:43:INFO:TRAIN-(cmcm) (2/3/4)>> loss: 2.7700
2024-06-12 23:08:45:INFO:VAL-(cmcm) >>
2024-06-12 23:08:45:INFO:M: >>  Has0_acc_2: 0.5546  Has0_F1_score: 0.5442  Non0_acc_2: 0.5556  Non0_F1_score: 0.5479  Mult_acc_5: 0.2227  Mult_acc_7: 0.2052  MAE: 1.5222  Corr: -0.0080 
2024-06-12 23:09:00:INFO:TRAIN-(cmcm) (3/4/4)>> loss: 1.0698
2024-06-12 23:09:02:INFO:VAL-(cmcm) >>
2024-06-12 23:09:02:INFO:M: >>  Has0_acc_2: 0.5022  Has0_F1_score: 0.5026  Non0_acc_2: 0.5185  Non0_F1_score: 0.5170  Mult_acc_5: 0.2358  Mult_acc_7: 0.1790  MAE: 1.6551  Corr: 0.0676 
2024-06-12 23:09:17:INFO:TRAIN-(cmcm) (4/5/4)>> loss: 0.9563
2024-06-12 23:09:20:INFO:VAL-(cmcm) >>
2024-06-12 23:09:20:INFO:M: >>  Has0_acc_2: 0.5153  Has0_F1_score: 0.5089  Non0_acc_2: 0.5324  Non0_F1_score: 0.5253  Mult_acc_5: 0.1965  Mult_acc_7: 0.1747  MAE: 1.5541  Corr: 0.1092 
2024-06-12 23:09:35:INFO:TRAIN-(cmcm) (5/6/4)>> loss: 0.9206
2024-06-12 23:09:37:INFO:VAL-(cmcm) >>
2024-06-12 23:09:37:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4791  Non0_acc_2: 0.5833  Non0_F1_score: 0.4542  Mult_acc_5: 0.2751  Mult_acc_7: 0.2271  MAE: 1.5433  Corr: 0.0404 
2024-06-12 23:09:53:INFO:TRAIN-(cmcm) (6/7/4)>> loss: 0.9069
2024-06-12 23:09:55:INFO:VAL-(cmcm) >>
2024-06-12 23:09:55:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.5339  Non0_acc_2: 0.5880  Non0_F1_score: 0.5441  Mult_acc_5: 0.2926  Mult_acc_7: 0.2227  MAE: 1.4983  Corr: 0.1367 
2024-06-12 23:10:12:INFO:TRAIN-(cmcm) (7/8/4)>> loss: 0.9080
2024-06-12 23:10:15:INFO:VAL-(cmcm) >>
2024-06-12 23:10:15:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4630  Non0_acc_2: 0.5741  Non0_F1_score: 0.4346  Mult_acc_5: 0.1878  Mult_acc_7: 0.1790  MAE: 1.5643  Corr: -0.0088 
2024-06-12 23:10:33:INFO:TRAIN-(cmcm) (8/9/4)>> loss: 0.8925
2024-06-12 23:10:35:INFO:VAL-(cmcm) >>
2024-06-12 23:10:35:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.5499  Non0_acc_2: 0.5694  Non0_F1_score: 0.5477  Mult_acc_5: 0.2227  Mult_acc_7: 0.1703  MAE: 1.6844  Corr: 0.0065 
2024-06-12 23:10:51:INFO:TRAIN-(cmcm) (9/10/4)>> loss: 0.8845
2024-06-12 23:10:54:INFO:VAL-(cmcm) >>
2024-06-12 23:10:54:INFO:M: >>  Has0_acc_2: 0.6157  Has0_F1_score: 0.5954  Non0_acc_2: 0.6157  Non0_F1_score: 0.5923  Mult_acc_5: 0.2576  Mult_acc_7: 0.1878  MAE: 1.6363  Corr: 0.0949 
2024-06-12 23:11:11:INFO:TRAIN-(cmcm) (10/11/4)>> loss: 0.8869
2024-06-12 23:11:14:INFO:VAL-(cmcm) >>
2024-06-12 23:11:14:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.5602  Non0_acc_2: 0.5370  Non0_F1_score: 0.5276  Mult_acc_5: 0.2533  Mult_acc_7: 0.2140  MAE: 1.5241  Corr: 0.0698 
2024-06-12 23:11:22:INFO:TEST-(cmcm) >>
2024-06-12 23:11:22:INFO:M: >>  Has0_acc_2: 0.4475  Has0_F1_score: 0.2767  Non0_acc_2: 0.5777  Non0_F1_score: 0.4231  Mult_acc_5: 0.1545  Mult_acc_7: 0.1545  MAE: 1.4174  Corr: nan 
2024-06-12 23:11:22:INFO:Results are added to results/results/mosi-regression-90.csv...
2024-06-12 23:11:22:INFO:Start running cmcm...
2024-06-12 23:11:22:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [0], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 2, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 90, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 5555}>
2024-06-12 23:11:22:INFO:Let's use the GPU 0 !
2024-06-12 23:11:23:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 23:11:23:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718205083 HTTP/1.1" 200 235
2024-06-12 23:11:23:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 23:11:23:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 23:11:24:INFO:train samples: (1284,)
2024-06-12 23:11:25:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 23:11:25:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718205085 HTTP/1.1" 200 235
2024-06-12 23:11:25:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 23:11:26:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 23:11:26:INFO:valid samples: (229,)
2024-06-12 23:11:26:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 23:11:27:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718205087 HTTP/1.1" 200 235
2024-06-12 23:11:27:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 23:11:27:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 23:11:28:INFO:test samples: (686,)
2024-06-12 23:11:28:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 23:11:28:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718205089 HTTP/1.1" 200 235
2024-06-12 23:11:29:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 23:11:29:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 23:11:30:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 23:11:30:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718205090 HTTP/1.1" 200 235
2024-06-12 23:11:30:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 23:11:31:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 23:11:31:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-12 23:11:31:WARNING:Try importing flash-attention for faster inference...
2024-06-12 23:11:31:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-12 23:11:31:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-12 23:11:31:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-12 23:11:33:INFO:trainable params: 1310280 || all params: 1838138952 || trainable%: 0.07128296794833386
2024-06-12 23:11:33:INFO:Init labels...
2024-06-12 23:11:33:INFO:Start training...
2024-06-12 23:11:50:INFO:TRAIN-(cmcm) (1/1/5)>> loss: 3.6972
2024-06-12 23:11:53:INFO:VAL-(cmcm) >>
2024-06-12 23:11:53:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.4710  Non0_acc_2: 0.5417  Non0_F1_score: 0.4688  Mult_acc_5: 0.2183  Mult_acc_7: 0.1354  MAE: 1.9420  Corr: -0.0831 
2024-06-12 23:11:54:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-12 23:12:11:INFO:TRAIN-(cmcm) (1/2/5)>> loss: 1.1543
2024-06-12 23:12:14:INFO:VAL-(cmcm) >>
2024-06-12 23:12:14:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5620  Non0_acc_2: 0.5694  Non0_F1_score: 0.5570  Mult_acc_5: 0.2052  Mult_acc_7: 0.1878  MAE: 1.5244  Corr: 0.0799 
2024-06-12 23:12:15:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-12 23:12:32:INFO:TRAIN-(cmcm) (1/3/5)>> loss: 0.9658
2024-06-12 23:12:35:INFO:VAL-(cmcm) >>
2024-06-12 23:12:35:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.6016  Non0_acc_2: 0.6019  Non0_F1_score: 0.6035  Mult_acc_5: 0.2664  Mult_acc_7: 0.2271  MAE: 1.5691  Corr: 0.1544 
2024-06-12 23:12:52:INFO:TRAIN-(cmcm) (2/4/5)>> loss: 0.9021
2024-06-12 23:12:55:INFO:VAL-(cmcm) >>
2024-06-12 23:12:55:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5833  Non0_F1_score: 0.4393  Mult_acc_5: 0.2707  Mult_acc_7: 0.1921  MAE: 1.6595  Corr: 0.0274 
2024-06-12 23:13:11:INFO:TRAIN-(cmcm) (3/5/5)>> loss: 0.8998
2024-06-12 23:13:15:INFO:VAL-(cmcm) >>
2024-06-12 23:13:15:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4891  Non0_acc_2: 0.5741  Non0_F1_score: 0.4622  Mult_acc_5: 0.2314  Mult_acc_7: 0.1878  MAE: 1.6114  Corr: 0.0363 
2024-06-12 23:13:31:INFO:TRAIN-(cmcm) (4/6/5)>> loss: 0.8933
2024-06-12 23:13:34:INFO:VAL-(cmcm) >>
2024-06-12 23:13:34:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5572  Non0_acc_2: 0.5556  Non0_F1_score: 0.5401  Mult_acc_5: 0.2489  Mult_acc_7: 0.1747  MAE: 1.6878  Corr: 0.0168 
2024-06-12 23:13:51:INFO:TRAIN-(cmcm) (5/7/5)>> loss: 0.8842
2024-06-12 23:13:53:INFO:VAL-(cmcm) >>
2024-06-12 23:13:53:INFO:M: >>  Has0_acc_2: 0.5022  Has0_F1_score: 0.4726  Non0_acc_2: 0.5278  Non0_F1_score: 0.5000  Mult_acc_5: 0.2227  Mult_acc_7: 0.1703  MAE: 1.8878  Corr: 0.1210 
2024-06-12 23:14:10:INFO:TRAIN-(cmcm) (6/8/5)>> loss: 0.8794
2024-06-12 23:14:13:INFO:VAL-(cmcm) >>
2024-06-12 23:14:13:INFO:M: >>  Has0_acc_2: 0.4541  Has0_F1_score: 0.4176  Non0_acc_2: 0.4537  Non0_F1_score: 0.3496  Mult_acc_5: 0.1878  Mult_acc_7: 0.1878  MAE: 1.6667  Corr: 0.0117 
2024-06-12 23:14:30:INFO:TRAIN-(cmcm) (7/9/5)>> loss: 0.8891
2024-06-12 23:14:32:INFO:VAL-(cmcm) >>
2024-06-12 23:14:32:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.5363  Non0_acc_2: 0.5833  Non0_F1_score: 0.5150  Mult_acc_5: 0.2882  Mult_acc_7: 0.2314  MAE: 1.5769  Corr: 0.0525 
2024-06-12 23:14:50:INFO:TRAIN-(cmcm) (8/10/5)>> loss: 0.8815
2024-06-12 23:14:53:INFO:VAL-(cmcm) >>
2024-06-12 23:14:53:INFO:M: >>  Has0_acc_2: 0.6157  Has0_F1_score: 0.5273  Non0_acc_2: 0.6019  Non0_F1_score: 0.5085  Mult_acc_5: 0.3231  Mult_acc_7: 0.2402  MAE: 1.6691  Corr: 0.1135 
2024-06-12 23:15:10:INFO:TRAIN-(cmcm) (9/11/5)>> loss: 0.8806
2024-06-12 23:15:13:INFO:VAL-(cmcm) >>
2024-06-12 23:15:13:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5741  Non0_F1_score: 0.4187  Mult_acc_5: 0.1703  Mult_acc_7: 0.1659  MAE: 1.5322  Corr: -0.0231 
2024-06-12 23:15:30:INFO:TRAIN-(cmcm) (10/12/5)>> loss: 0.8677
2024-06-12 23:15:33:INFO:VAL-(cmcm) >>
2024-06-12 23:15:33:INFO:M: >>  Has0_acc_2: 0.5633  Has0_F1_score: 0.5463  Non0_acc_2: 0.5602  Non0_F1_score: 0.5566  Mult_acc_5: 0.2664  Mult_acc_7: 0.2096  MAE: 1.5446  Corr: 0.0799 
2024-06-12 23:15:42:INFO:TEST-(cmcm) >>
2024-06-12 23:15:42:INFO:M: >>  Has0_acc_2: 0.4898  Has0_F1_score: 0.4748  Non0_acc_2: 0.4848  Non0_F1_score: 0.4725  Mult_acc_5: 0.1837  Mult_acc_7: 0.1837  MAE: 1.6636  Corr: -0.0110 
2024-06-12 23:15:42:INFO:Results are added to results/results/mosi-regression-90.csv...
2024-06-12 23:15:42:INFO:Start running cmcm...
2024-06-12 23:15:42:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [0], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 2, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 100, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-06-12 23:15:42:INFO:Let's use the GPU 0 !
2024-06-12 23:15:43:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 23:15:43:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718205343 HTTP/1.1" 200 235
2024-06-12 23:15:43:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 23:15:44:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 23:15:45:INFO:train samples: (1284,)
2024-06-12 23:15:45:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 23:15:45:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718205345 HTTP/1.1" 200 235
2024-06-12 23:15:45:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 23:15:46:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 23:15:46:INFO:valid samples: (229,)
2024-06-12 23:15:47:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 23:15:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718205347 HTTP/1.1" 200 235
2024-06-12 23:15:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 23:15:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 23:15:48:INFO:test samples: (686,)
2024-06-12 23:15:48:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 23:15:49:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718205349 HTTP/1.1" 200 235
2024-06-12 23:15:49:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 23:15:49:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 23:15:50:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 23:15:50:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718205350 HTTP/1.1" 200 235
2024-06-12 23:15:50:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 23:15:51:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 23:15:51:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-12 23:15:51:WARNING:Try importing flash-attention for faster inference...
2024-06-12 23:15:51:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-12 23:15:51:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-12 23:15:51:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-12 23:15:55:INFO:trainable params: 1310280 || all params: 1838138952 || trainable%: 0.07128296794833386
2024-06-12 23:15:55:INFO:Init labels...
2024-06-12 23:15:55:INFO:Start training...
2024-06-12 23:16:12:INFO:TRAIN-(cmcm) (1/1/1)>> loss: 4.2044
2024-06-12 23:16:16:INFO:VAL-(cmcm) >>
2024-06-12 23:16:16:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4306  Non0_F1_score: 0.2645  Mult_acc_5: 0.2140  Mult_acc_7: 0.2140  MAE: 1.4349  Corr: 0.0599 
2024-06-12 23:16:16:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-12 23:16:34:INFO:TRAIN-(cmcm) (1/2/1)>> loss: 2.4997
2024-06-12 23:16:37:INFO:VAL-(cmcm) >>
2024-06-12 23:16:37:INFO:M: >>  Has0_acc_2: 0.5633  Has0_F1_score: 0.5641  Non0_acc_2: 0.5278  Non0_F1_score: 0.5297  Mult_acc_5: 0.1703  Mult_acc_7: 0.1528  MAE: 1.6001  Corr: -0.0044 
2024-06-12 23:16:54:INFO:TRAIN-(cmcm) (2/3/1)>> loss: 1.0743
2024-06-12 23:16:57:INFO:VAL-(cmcm) >>
2024-06-12 23:16:57:INFO:M: >>  Has0_acc_2: 0.5415  Has0_F1_score: 0.5444  Non0_acc_2: 0.5417  Non0_F1_score: 0.5425  Mult_acc_5: 0.2576  Mult_acc_7: 0.2009  MAE: 1.7423  Corr: -0.0233 
2024-06-12 23:17:13:INFO:TRAIN-(cmcm) (3/4/1)>> loss: 0.9399
2024-06-12 23:17:16:INFO:VAL-(cmcm) >>
2024-06-12 23:17:16:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.5029  Non0_acc_2: 0.5880  Non0_F1_score: 0.4940  Mult_acc_5: 0.2009  Mult_acc_7: 0.1921  MAE: 1.4887  Corr: 0.1139 
2024-06-12 23:17:32:INFO:TRAIN-(cmcm) (4/5/1)>> loss: 0.9160
2024-06-12 23:17:35:INFO:VAL-(cmcm) >>
2024-06-12 23:17:35:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.5013  Non0_acc_2: 0.5556  Non0_F1_score: 0.4780  Mult_acc_5: 0.2402  Mult_acc_7: 0.1834  MAE: 1.6368  Corr: 0.0432 
2024-06-12 23:17:50:INFO:TRAIN-(cmcm) (5/6/1)>> loss: 0.9034
2024-06-12 23:17:54:INFO:VAL-(cmcm) >>
2024-06-12 23:17:54:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5806  Non0_acc_2: 0.5833  Non0_F1_score: 0.5688  Mult_acc_5: 0.1921  Mult_acc_7: 0.1921  MAE: 1.4798  Corr: 0.0989 
2024-06-12 23:18:11:INFO:TRAIN-(cmcm) (6/7/1)>> loss: 0.9053
2024-06-12 23:18:14:INFO:VAL-(cmcm) >>
2024-06-12 23:18:14:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.5140  Non0_acc_2: 0.5602  Non0_F1_score: 0.4945  Mult_acc_5: 0.2926  Mult_acc_7: 0.2140  MAE: 1.7739  Corr: 0.0138 
2024-06-12 23:18:31:INFO:TRAIN-(cmcm) (7/8/1)>> loss: 0.8853
2024-06-12 23:18:34:INFO:VAL-(cmcm) >>
2024-06-12 23:18:34:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4700  Non0_acc_2: 0.5741  Non0_F1_score: 0.4420  Mult_acc_5: 0.2751  Mult_acc_7: 0.2183  MAE: 1.6366  Corr: 0.0831 
2024-06-12 23:18:51:INFO:TRAIN-(cmcm) (8/9/1)>> loss: 0.8822
2024-06-12 23:18:54:INFO:VAL-(cmcm) >>
2024-06-12 23:18:54:INFO:M: >>  Has0_acc_2: 0.5153  Has0_F1_score: 0.5193  Non0_acc_2: 0.4583  Non0_F1_score: 0.4453  Mult_acc_5: 0.2009  Mult_acc_7: 0.1790  MAE: 1.5558  Corr: 0.0538 
2024-06-12 23:19:11:INFO:TRAIN-(cmcm) (9/10/1)>> loss: 0.8760
2024-06-12 23:19:14:INFO:VAL-(cmcm) >>
2024-06-12 23:19:14:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.5507  Non0_acc_2: 0.5694  Non0_F1_score: 0.5432  Mult_acc_5: 0.2664  Mult_acc_7: 0.2052  MAE: 1.5672  Corr: 0.1111 
2024-06-12 23:19:31:INFO:TRAIN-(cmcm) (10/11/1)>> loss: 0.8733
2024-06-12 23:19:34:INFO:VAL-(cmcm) >>
2024-06-12 23:19:34:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4577  Non0_acc_2: 0.5787  Non0_F1_score: 0.4291  Mult_acc_5: 0.2795  Mult_acc_7: 0.2052  MAE: 1.8490  Corr: 0.0339 
2024-06-12 23:19:43:INFO:TEST-(cmcm) >>
2024-06-12 23:19:43:INFO:M: >>  Has0_acc_2: 0.4475  Has0_F1_score: 0.2767  Non0_acc_2: 0.5777  Non0_F1_score: 0.4231  Mult_acc_5: 0.1545  Mult_acc_7: 0.1545  MAE: 1.4181  Corr: 0.0076 
2024-06-12 23:19:44:INFO:Results are added to results/results/mosi-regression-100.csv...
2024-06-12 23:19:44:INFO:Start running cmcm...
2024-06-12 23:19:44:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [0], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 2, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 100, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 2222}>
2024-06-12 23:19:44:INFO:Let's use the GPU 0 !
2024-06-12 23:19:44:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 23:19:44:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718205584 HTTP/1.1" 200 235
2024-06-12 23:19:44:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 23:19:45:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 23:19:46:INFO:train samples: (1284,)
2024-06-12 23:19:46:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 23:19:46:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718205586 HTTP/1.1" 200 235
2024-06-12 23:19:46:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 23:19:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 23:19:47:INFO:valid samples: (229,)
2024-06-12 23:19:48:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 23:19:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718205588 HTTP/1.1" 200 235
2024-06-12 23:19:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 23:19:49:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 23:19:49:INFO:test samples: (686,)
2024-06-12 23:19:49:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 23:19:50:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718205590 HTTP/1.1" 200 235
2024-06-12 23:19:50:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 23:19:50:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 23:19:51:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 23:19:51:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718205591 HTTP/1.1" 200 235
2024-06-12 23:19:52:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 23:19:52:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 23:19:52:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-12 23:19:52:WARNING:Try importing flash-attention for faster inference...
2024-06-12 23:19:52:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-12 23:19:52:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-12 23:19:52:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-12 23:19:56:INFO:trainable params: 1310280 || all params: 1838138952 || trainable%: 0.07128296794833386
2024-06-12 23:19:56:INFO:Init labels...
2024-06-12 23:19:56:INFO:Start training...
2024-06-12 23:20:13:INFO:TRAIN-(cmcm) (1/1/2)>> loss: 4.2287
2024-06-12 23:20:16:INFO:VAL-(cmcm) >>
2024-06-12 23:20:16:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4259  Non0_F1_score: 0.2544  Mult_acc_5: 0.2140  Mult_acc_7: 0.2140  MAE: 1.4370  Corr: nan 
2024-06-12 23:20:17:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-12 23:20:34:INFO:TRAIN-(cmcm) (1/2/2)>> loss: 2.6810
2024-06-12 23:20:37:INFO:VAL-(cmcm) >>
2024-06-12 23:20:37:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.4924  Non0_acc_2: 0.5741  Non0_F1_score: 0.5493  Mult_acc_5: 0.2227  Mult_acc_7: 0.1834  MAE: 1.5820  Corr: -0.0017 
2024-06-12 23:20:53:INFO:TRAIN-(cmcm) (2/3/2)>> loss: 1.0916
2024-06-12 23:20:56:INFO:VAL-(cmcm) >>
2024-06-12 23:20:56:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.5029  Non0_acc_2: 0.5602  Non0_F1_score: 0.4599  Mult_acc_5: 0.2140  Mult_acc_7: 0.2009  MAE: 1.5475  Corr: -0.0516 
2024-06-12 23:21:12:INFO:TRAIN-(cmcm) (3/4/2)>> loss: 0.9658
2024-06-12 23:21:15:INFO:VAL-(cmcm) >>
2024-06-12 23:21:15:INFO:M: >>  Has0_acc_2: 0.6245  Has0_F1_score: 0.5331  Non0_acc_2: 0.6111  Non0_F1_score: 0.5199  Mult_acc_5: 0.2969  Mult_acc_7: 0.2358  MAE: 1.5302  Corr: 0.1560 
2024-06-12 23:21:31:INFO:TRAIN-(cmcm) (4/5/2)>> loss: 0.9293
2024-06-12 23:21:34:INFO:VAL-(cmcm) >>
2024-06-12 23:21:34:INFO:M: >>  Has0_acc_2: 0.6201  Has0_F1_score: 0.5641  Non0_acc_2: 0.6111  Non0_F1_score: 0.5651  Mult_acc_5: 0.2314  Mult_acc_7: 0.2009  MAE: 1.4916  Corr: 0.1123 
2024-06-12 23:21:51:INFO:TRAIN-(cmcm) (5/6/2)>> loss: 0.9079
2024-06-12 23:21:54:INFO:VAL-(cmcm) >>
2024-06-12 23:21:54:INFO:M: >>  Has0_acc_2: 0.4760  Has0_F1_score: 0.4542  Non0_acc_2: 0.4907  Non0_F1_score: 0.4679  Mult_acc_5: 0.1834  Mult_acc_7: 0.1528  MAE: 1.8883  Corr: 0.0551 
2024-06-12 23:22:12:INFO:TRAIN-(cmcm) (6/7/2)>> loss: 0.9239
2024-06-12 23:22:15:INFO:VAL-(cmcm) >>
2024-06-12 23:22:15:INFO:M: >>  Has0_acc_2: 0.5546  Has0_F1_score: 0.5442  Non0_acc_2: 0.5741  Non0_F1_score: 0.5617  Mult_acc_5: 0.1878  Mult_acc_7: 0.1878  MAE: 1.5232  Corr: 0.1716 
2024-06-12 23:22:32:INFO:TRAIN-(cmcm) (7/8/2)>> loss: 0.8999
2024-06-12 23:22:35:INFO:VAL-(cmcm) >>
2024-06-12 23:22:35:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.4562  Non0_acc_2: 0.5602  Non0_F1_score: 0.4275  Mult_acc_5: 0.2009  Mult_acc_7: 0.1572  MAE: 1.6092  Corr: -0.0149 
2024-06-12 23:22:52:INFO:TRAIN-(cmcm) (8/9/2)>> loss: 0.8938
2024-06-12 23:22:54:INFO:VAL-(cmcm) >>
2024-06-12 23:22:54:INFO:M: >>  Has0_acc_2: 0.6201  Has0_F1_score: 0.6143  Non0_acc_2: 0.6111  Non0_F1_score: 0.6044  Mult_acc_5: 0.2533  Mult_acc_7: 0.1921  MAE: 1.6647  Corr: 0.1631 
2024-06-12 23:23:09:INFO:TRAIN-(cmcm) (9/10/2)>> loss: 0.8884
2024-06-12 23:23:12:INFO:VAL-(cmcm) >>
2024-06-12 23:23:12:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.5194  Non0_acc_2: 0.5972  Non0_F1_score: 0.5000  Mult_acc_5: 0.2707  Mult_acc_7: 0.2183  MAE: 1.6791  Corr: 0.0579 
2024-06-12 23:23:27:INFO:TRAIN-(cmcm) (10/11/2)>> loss: 0.8922
2024-06-12 23:23:29:INFO:VAL-(cmcm) >>
2024-06-12 23:23:29:INFO:M: >>  Has0_acc_2: 0.6507  Has0_F1_score: 0.6339  Non0_acc_2: 0.6528  Non0_F1_score: 0.6335  Mult_acc_5: 0.3231  Mult_acc_7: 0.2489  MAE: 1.5263  Corr: 0.2521 
2024-06-12 23:23:36:INFO:TEST-(cmcm) >>
2024-06-12 23:23:36:INFO:M: >>  Has0_acc_2: 0.4475  Has0_F1_score: 0.2767  Non0_acc_2: 0.5793  Non0_F1_score: 0.4266  Mult_acc_5: 0.1560  Mult_acc_7: 0.1560  MAE: 1.4159  Corr: 0.0413 
2024-06-12 23:23:37:INFO:Results are added to results/results/mosi-regression-100.csv...
2024-06-12 23:23:37:INFO:Start running cmcm...
2024-06-12 23:23:37:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [0], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 2, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 100, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 3333}>
2024-06-12 23:23:37:INFO:Let's use the GPU 0 !
2024-06-12 23:23:37:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 23:23:37:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718205817 HTTP/1.1" 200 235
2024-06-12 23:23:37:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 23:23:38:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 23:23:39:INFO:train samples: (1284,)
2024-06-12 23:23:39:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 23:23:39:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718205819 HTTP/1.1" 200 235
2024-06-12 23:23:39:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 23:23:40:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 23:23:40:INFO:valid samples: (229,)
2024-06-12 23:23:41:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 23:23:41:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718205821 HTTP/1.1" 200 235
2024-06-12 23:23:41:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 23:23:42:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 23:23:42:INFO:test samples: (686,)
2024-06-12 23:23:42:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 23:23:43:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718205823 HTTP/1.1" 200 235
2024-06-12 23:23:43:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 23:23:43:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 23:23:44:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 23:23:45:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718205824 HTTP/1.1" 200 235
2024-06-12 23:23:45:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 23:23:46:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 23:23:46:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-12 23:23:46:WARNING:Try importing flash-attention for faster inference...
2024-06-12 23:23:46:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-12 23:23:46:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-12 23:23:46:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-12 23:23:48:INFO:trainable params: 1310280 || all params: 1838138952 || trainable%: 0.07128296794833386
2024-06-12 23:23:48:INFO:Init labels...
2024-06-12 23:23:48:INFO:Start training...
2024-06-12 23:24:03:INFO:TRAIN-(cmcm) (1/1/3)>> loss: 4.1905
2024-06-12 23:24:06:INFO:VAL-(cmcm) >>
2024-06-12 23:24:06:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4259  Non0_F1_score: 0.2544  Mult_acc_5: 0.2140  Mult_acc_7: 0.2140  MAE: 1.4370  Corr: nan 
2024-06-12 23:24:06:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-12 23:24:21:INFO:TRAIN-(cmcm) (1/2/3)>> loss: 2.5691
2024-06-12 23:24:24:INFO:VAL-(cmcm) >>
2024-06-12 23:24:24:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.4562  Non0_acc_2: 0.5648  Non0_F1_score: 0.4371  Mult_acc_5: 0.2009  Mult_acc_7: 0.1878  MAE: 1.5302  Corr: 0.0604 
2024-06-12 23:24:39:INFO:TRAIN-(cmcm) (2/3/3)>> loss: 1.0281
2024-06-12 23:24:41:INFO:VAL-(cmcm) >>
2024-06-12 23:24:41:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.5282  Non0_acc_2: 0.5463  Non0_F1_score: 0.5148  Mult_acc_5: 0.2009  Mult_acc_7: 0.1834  MAE: 1.6049  Corr: -0.0251 
2024-06-12 23:24:56:INFO:TRAIN-(cmcm) (3/4/3)>> loss: 0.9344
2024-06-12 23:24:59:INFO:VAL-(cmcm) >>
2024-06-12 23:24:59:INFO:M: >>  Has0_acc_2: 0.5240  Has0_F1_score: 0.5265  Non0_acc_2: 0.5185  Non0_F1_score: 0.5197  Mult_acc_5: 0.2009  Mult_acc_7: 0.1616  MAE: 1.6817  Corr: -0.0204 
2024-06-12 23:25:13:INFO:TRAIN-(cmcm) (4/5/3)>> loss: 0.9221
2024-06-12 23:25:16:INFO:VAL-(cmcm) >>
2024-06-12 23:25:16:INFO:M: >>  Has0_acc_2: 0.4672  Has0_F1_score: 0.3925  Non0_acc_2: 0.4907  Non0_F1_score: 0.4172  Mult_acc_5: 0.1659  Mult_acc_7: 0.1441  MAE: 1.9223  Corr: 0.1150 
2024-06-12 23:25:31:INFO:TRAIN-(cmcm) (5/6/3)>> loss: 0.9087
2024-06-12 23:25:33:INFO:VAL-(cmcm) >>
2024-06-12 23:25:33:INFO:M: >>  Has0_acc_2: 0.4978  Has0_F1_score: 0.5020  Non0_acc_2: 0.5093  Non0_F1_score: 0.5116  Mult_acc_5: 0.1921  Mult_acc_7: 0.1441  MAE: 1.6991  Corr: 0.0732 
2024-06-12 23:25:48:INFO:TRAIN-(cmcm) (6/7/3)>> loss: 0.8838
2024-06-12 23:25:50:INFO:VAL-(cmcm) >>
2024-06-12 23:25:50:INFO:M: >>  Has0_acc_2: 0.5415  Has0_F1_score: 0.5183  Non0_acc_2: 0.5417  Non0_F1_score: 0.5207  Mult_acc_5: 0.1790  Mult_acc_7: 0.1747  MAE: 1.6611  Corr: -0.0257 
2024-06-12 23:26:05:INFO:TRAIN-(cmcm) (7/8/3)>> loss: 0.8760
2024-06-12 23:26:08:INFO:VAL-(cmcm) >>
2024-06-12 23:26:08:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.4956  Non0_acc_2: 0.5231  Non0_F1_score: 0.4648  Mult_acc_5: 0.2402  Mult_acc_7: 0.2140  MAE: 1.6039  Corr: 0.0047 
2024-06-12 23:26:26:INFO:TRAIN-(cmcm) (8/9/3)>> loss: 0.8840
2024-06-12 23:26:29:INFO:VAL-(cmcm) >>
2024-06-12 23:26:29:INFO:M: >>  Has0_acc_2: 0.5633  Has0_F1_score: 0.5249  Non0_acc_2: 0.4861  Non0_F1_score: 0.4006  Mult_acc_5: 0.2183  Mult_acc_7: 0.2052  MAE: 1.4549  Corr: 0.0754 
2024-06-12 23:26:46:INFO:TRAIN-(cmcm) (9/10/3)>> loss: 0.8740
2024-06-12 23:26:48:INFO:VAL-(cmcm) >>
2024-06-12 23:26:48:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4950  Non0_acc_2: 0.5741  Non0_F1_score: 0.4683  Mult_acc_5: 0.2969  Mult_acc_7: 0.2358  MAE: 1.6132  Corr: 0.0423 
2024-06-12 23:27:06:INFO:TRAIN-(cmcm) (10/11/3)>> loss: 0.8714
2024-06-12 23:27:08:INFO:VAL-(cmcm) >>
2024-06-12 23:27:09:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.4596  Non0_acc_2: 0.5463  Non0_F1_score: 0.4336  Mult_acc_5: 0.2751  Mult_acc_7: 0.1965  MAE: 1.7066  Corr: -0.0734 
2024-06-12 23:27:17:INFO:TEST-(cmcm) >>
2024-06-12 23:27:17:INFO:M: >>  Has0_acc_2: 0.4475  Has0_F1_score: 0.2767  Non0_acc_2: 0.5777  Non0_F1_score: 0.4231  Mult_acc_5: 0.1545  Mult_acc_7: 0.1545  MAE: 1.4174  Corr: nan 
2024-06-12 23:27:17:INFO:Results are added to results/results/mosi-regression-100.csv...
2024-06-12 23:27:17:INFO:Start running cmcm...
2024-06-12 23:27:17:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [0], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 2, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 100, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 4444}>
2024-06-12 23:27:17:INFO:Let's use the GPU 0 !
2024-06-12 23:27:17:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 23:27:18:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718206038 HTTP/1.1" 200 235
2024-06-12 23:27:18:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 23:27:18:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 23:27:19:INFO:train samples: (1284,)
2024-06-12 23:27:19:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 23:27:20:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718206040 HTTP/1.1" 200 235
2024-06-12 23:27:20:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 23:27:20:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 23:27:21:INFO:valid samples: (229,)
2024-06-12 23:27:21:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 23:27:21:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718206042 HTTP/1.1" 200 235
2024-06-12 23:27:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 23:27:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 23:27:23:INFO:test samples: (686,)
2024-06-12 23:27:23:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 23:27:23:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718206043 HTTP/1.1" 200 235
2024-06-12 23:27:23:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 23:27:24:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 23:27:24:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 23:27:25:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718206045 HTTP/1.1" 200 235
2024-06-12 23:27:25:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 23:27:25:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 23:27:25:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-12 23:27:25:WARNING:Try importing flash-attention for faster inference...
2024-06-12 23:27:25:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-12 23:27:25:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-12 23:27:25:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-12 23:27:30:INFO:trainable params: 1310280 || all params: 1838138952 || trainable%: 0.07128296794833386
2024-06-12 23:27:30:INFO:Init labels...
2024-06-12 23:27:30:INFO:Start training...
2024-06-12 23:27:47:INFO:TRAIN-(cmcm) (1/1/4)>> loss: 4.3930
2024-06-12 23:27:50:INFO:VAL-(cmcm) >>
2024-06-12 23:27:50:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4259  Non0_F1_score: 0.2544  Mult_acc_5: 0.2140  Mult_acc_7: 0.2140  MAE: 1.4370  Corr: nan 
2024-06-12 23:27:51:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-12 23:28:08:INFO:TRAIN-(cmcm) (1/2/4)>> loss: 4.2297
2024-06-12 23:28:11:INFO:VAL-(cmcm) >>
2024-06-12 23:28:11:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4259  Non0_F1_score: 0.2544  Mult_acc_5: 0.2140  Mult_acc_7: 0.2140  MAE: 1.4370  Corr: nan 
2024-06-12 23:28:28:INFO:TRAIN-(cmcm) (2/3/4)>> loss: 3.0597
2024-06-12 23:28:31:INFO:VAL-(cmcm) >>
2024-06-12 23:28:31:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.4620  Non0_acc_2: 0.5602  Non0_F1_score: 0.4599  Mult_acc_5: 0.3013  Mult_acc_7: 0.1703  MAE: 2.1271  Corr: -0.0426 
2024-06-12 23:28:48:INFO:TRAIN-(cmcm) (3/4/4)>> loss: 1.1010
2024-06-12 23:28:51:INFO:VAL-(cmcm) >>
2024-06-12 23:28:51:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5724  Non0_acc_2: 0.5741  Non0_F1_score: 0.5640  Mult_acc_5: 0.2009  Mult_acc_7: 0.1790  MAE: 1.5376  Corr: 0.0382 
2024-06-12 23:29:09:INFO:TRAIN-(cmcm) (4/5/4)>> loss: 0.9502
2024-06-12 23:29:11:INFO:VAL-(cmcm) >>
2024-06-12 23:29:11:INFO:M: >>  Has0_acc_2: 0.5371  Has0_F1_score: 0.5415  Non0_acc_2: 0.5556  Non0_F1_score: 0.5574  Mult_acc_5: 0.1747  Mult_acc_7: 0.1528  MAE: 1.6127  Corr: 0.0917 
2024-06-12 23:29:28:INFO:TRAIN-(cmcm) (5/6/4)>> loss: 0.9316
2024-06-12 23:29:31:INFO:VAL-(cmcm) >>
2024-06-12 23:29:31:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4534  Non0_acc_2: 0.5463  Non0_F1_score: 0.4458  Mult_acc_5: 0.2183  Mult_acc_7: 0.1616  MAE: 1.6040  Corr: 0.0034 
2024-06-12 23:29:49:INFO:TRAIN-(cmcm) (6/7/4)>> loss: 0.8991
2024-06-12 23:29:52:INFO:VAL-(cmcm) >>
2024-06-12 23:29:52:INFO:M: >>  Has0_acc_2: 0.6376  Has0_F1_score: 0.5418  Non0_acc_2: 0.6111  Non0_F1_score: 0.5199  Mult_acc_5: 0.3144  Mult_acc_7: 0.2271  MAE: 1.5455  Corr: 0.1799 
2024-06-12 23:30:09:INFO:TRAIN-(cmcm) (7/8/4)>> loss: 0.8962
2024-06-12 23:30:12:INFO:VAL-(cmcm) >>
2024-06-12 23:30:12:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.4746  Non0_acc_2: 0.5833  Non0_F1_score: 0.4469  Mult_acc_5: 0.2052  Mult_acc_7: 0.1747  MAE: 1.6205  Corr: 0.0535 
2024-06-12 23:30:29:INFO:TRAIN-(cmcm) (8/9/4)>> loss: 0.8881
2024-06-12 23:30:31:INFO:VAL-(cmcm) >>
2024-06-12 23:30:31:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.5332  Non0_acc_2: 0.5741  Non0_F1_score: 0.5084  Mult_acc_5: 0.2140  Mult_acc_7: 0.2052  MAE: 1.5515  Corr: -0.0162 
2024-06-12 23:30:47:INFO:TRAIN-(cmcm) (9/10/4)>> loss: 0.8820
2024-06-12 23:30:49:INFO:VAL-(cmcm) >>
2024-06-12 23:30:49:INFO:M: >>  Has0_acc_2: 0.6550  Has0_F1_score: 0.6487  Non0_acc_2: 0.6157  Non0_F1_score: 0.6142  Mult_acc_5: 0.2489  Mult_acc_7: 0.1834  MAE: 1.5825  Corr: 0.1335 
2024-06-12 23:31:04:INFO:TRAIN-(cmcm) (10/11/4)>> loss: 0.8726
2024-06-12 23:31:07:INFO:VAL-(cmcm) >>
2024-06-12 23:31:07:INFO:M: >>  Has0_acc_2: 0.6245  Has0_F1_score: 0.6098  Non0_acc_2: 0.6111  Non0_F1_score: 0.5959  Mult_acc_5: 0.2533  Mult_acc_7: 0.2227  MAE: 1.5213  Corr: 0.1757 
2024-06-12 23:31:14:INFO:TEST-(cmcm) >>
2024-06-12 23:31:14:INFO:M: >>  Has0_acc_2: 0.4475  Has0_F1_score: 0.2767  Non0_acc_2: 0.5777  Non0_F1_score: 0.4231  Mult_acc_5: 0.1545  Mult_acc_7: 0.1545  MAE: 1.4174  Corr: nan 
2024-06-12 23:31:15:INFO:Results are added to results/results/mosi-regression-100.csv...
2024-06-12 23:31:15:INFO:Start running cmcm...
2024-06-12 23:31:15:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [0], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 2, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 100, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 5555}>
2024-06-12 23:31:15:INFO:Let's use the GPU 0 !
2024-06-12 23:31:15:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 23:31:15:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718206275 HTTP/1.1" 200 235
2024-06-12 23:31:15:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 23:31:16:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 23:31:17:INFO:train samples: (1284,)
2024-06-12 23:31:17:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 23:31:17:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718206277 HTTP/1.1" 200 235
2024-06-12 23:31:17:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 23:31:18:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 23:31:18:INFO:valid samples: (229,)
2024-06-12 23:31:18:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 23:31:19:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718206279 HTTP/1.1" 200 235
2024-06-12 23:31:19:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 23:31:19:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 23:31:20:INFO:test samples: (686,)
2024-06-12 23:31:20:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 23:31:20:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718206280 HTTP/1.1" 200 235
2024-06-12 23:31:20:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 23:31:21:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 23:31:21:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-12 23:31:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718206282 HTTP/1.1" 200 235
2024-06-12 23:31:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-12 23:31:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-12 23:31:22:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-12 23:31:22:WARNING:Try importing flash-attention for faster inference...
2024-06-12 23:31:22:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-12 23:31:22:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-12 23:31:22:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-12 23:31:24:INFO:trainable params: 1310280 || all params: 1838138952 || trainable%: 0.07128296794833386
2024-06-12 23:31:24:INFO:Init labels...
2024-06-12 23:31:24:INFO:Start training...
2024-06-12 23:31:39:INFO:TRAIN-(cmcm) (1/1/5)>> loss: 3.8009
2024-06-12 23:31:41:INFO:VAL-(cmcm) >>
2024-06-12 23:31:41:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.4493  Non0_acc_2: 0.5602  Non0_F1_score: 0.4761  Mult_acc_5: 0.2926  Mult_acc_7: 0.1135  MAE: 2.5114  Corr: -0.0434 
2024-06-12 23:31:42:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-12 23:31:58:INFO:TRAIN-(cmcm) (1/2/5)>> loss: 1.2670
2024-06-12 23:32:00:INFO:VAL-(cmcm) >>
2024-06-12 23:32:00:INFO:M: >>  Has0_acc_2: 0.4803  Has0_F1_score: 0.4852  Non0_acc_2: 0.4954  Non0_F1_score: 0.4981  Mult_acc_5: 0.2358  Mult_acc_7: 0.1747  MAE: 1.9459  Corr: -0.0235 
2024-06-12 23:32:01:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-12 23:32:16:INFO:TRAIN-(cmcm) (1/3/5)>> loss: 0.9709
2024-06-12 23:32:19:INFO:VAL-(cmcm) >>
2024-06-12 23:32:19:INFO:M: >>  Has0_acc_2: 0.4498  Has0_F1_score: 0.3808  Non0_acc_2: 0.4769  Non0_F1_score: 0.4118  Mult_acc_5: 0.1703  Mult_acc_7: 0.1528  MAE: 1.8606  Corr: 0.0384 
2024-06-12 23:32:20:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-mosi-regression.pth.
2024-06-12 23:32:35:INFO:TRAIN-(cmcm) (1/4/5)>> loss: 0.9057
2024-06-12 23:32:38:INFO:VAL-(cmcm) >>
2024-06-12 23:32:38:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.4880  Non0_acc_2: 0.5833  Non0_F1_score: 0.4610  Mult_acc_5: 0.3013  Mult_acc_7: 0.2314  MAE: 1.6519  Corr: 0.0304 
2024-06-12 23:32:38:INFO:Saving checkpoint at epoch 4 to results/models/cmcm-mosi-regression.pth.
2024-06-12 23:32:54:INFO:TRAIN-(cmcm) (1/5/5)>> loss: 0.9072
2024-06-12 23:32:57:INFO:VAL-(cmcm) >>
2024-06-12 23:32:57:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.4694  Non0_acc_2: 0.5602  Non0_F1_score: 0.4414  Mult_acc_5: 0.2751  Mult_acc_7: 0.1965  MAE: 1.7468  Corr: -0.0166 
2024-06-12 23:33:12:INFO:TRAIN-(cmcm) (2/6/5)>> loss: 0.8899
2024-06-12 23:33:14:INFO:VAL-(cmcm) >>
2024-06-12 23:33:14:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5344  Non0_acc_2: 0.5556  Non0_F1_score: 0.5163  Mult_acc_5: 0.2183  Mult_acc_7: 0.1790  MAE: 1.6287  Corr: 0.0196 
2024-06-12 23:33:15:INFO:Saving checkpoint at epoch 6 to results/models/cmcm-mosi-regression.pth.
2024-06-12 23:33:31:INFO:TRAIN-(cmcm) (1/7/5)>> loss: 0.8836
2024-06-12 23:33:33:INFO:VAL-(cmcm) >>
2024-06-12 23:33:33:INFO:M: >>  Has0_acc_2: 0.4891  Has0_F1_score: 0.4495  Non0_acc_2: 0.5046  Non0_F1_score: 0.4632  Mult_acc_5: 0.1572  Mult_acc_7: 0.1528  MAE: 1.7458  Corr: 0.1087 
2024-06-12 23:33:49:INFO:TRAIN-(cmcm) (2/8/5)>> loss: 0.8785
2024-06-12 23:33:51:INFO:VAL-(cmcm) >>
2024-06-12 23:33:51:INFO:M: >>  Has0_acc_2: 0.5590  Has0_F1_score: 0.5603  Non0_acc_2: 0.4907  Non0_F1_score: 0.4367  Mult_acc_5: 0.2009  Mult_acc_7: 0.2009  MAE: 1.5440  Corr: 0.1242 
2024-06-12 23:33:52:INFO:Saving checkpoint at epoch 8 to results/models/cmcm-mosi-regression.pth.
2024-06-12 23:34:07:INFO:TRAIN-(cmcm) (1/9/5)>> loss: 0.8885
2024-06-12 23:34:10:INFO:VAL-(cmcm) >>
2024-06-12 23:34:10:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.4645  Non0_acc_2: 0.5509  Non0_F1_score: 0.4362  Mult_acc_5: 0.2751  Mult_acc_7: 0.1965  MAE: 1.7660  Corr: -0.0548 
2024-06-12 23:34:25:INFO:TRAIN-(cmcm) (2/10/5)>> loss: 0.8895
2024-06-12 23:34:28:INFO:VAL-(cmcm) >>
2024-06-12 23:34:28:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5081  Non0_acc_2: 0.5741  Non0_F1_score: 0.4851  Mult_acc_5: 0.1965  Mult_acc_7: 0.1703  MAE: 1.5436  Corr: 0.0725 
2024-06-12 23:34:28:INFO:Saving checkpoint at epoch 10 to results/models/cmcm-mosi-regression.pth.
2024-06-12 23:34:44:INFO:TRAIN-(cmcm) (1/11/5)>> loss: 0.8708
2024-06-12 23:34:46:INFO:VAL-(cmcm) >>
2024-06-12 23:34:46:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4723  Non0_acc_2: 0.5880  Non0_F1_score: 0.4703  Mult_acc_5: 0.2227  Mult_acc_7: 0.2183  MAE: 1.4279  Corr: 0.0243 
2024-06-12 23:34:47:INFO:Saving checkpoint at epoch 11 to results/models/cmcm-mosi-regression.pth.
2024-06-12 23:35:03:INFO:TRAIN-(cmcm) (1/12/5)>> loss: 0.8675
2024-06-12 23:35:05:INFO:VAL-(cmcm) >>
2024-06-12 23:35:05:INFO:M: >>  Has0_acc_2: 0.5459  Has0_F1_score: 0.5218  Non0_acc_2: 0.5370  Non0_F1_score: 0.5101  Mult_acc_5: 0.1921  Mult_acc_7: 0.1921  MAE: 1.5091  Corr: -0.0043 
2024-06-12 23:35:20:INFO:TRAIN-(cmcm) (2/13/5)>> loss: 0.8591
2024-06-12 23:35:23:INFO:VAL-(cmcm) >>
2024-06-12 23:35:23:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.5117  Non0_acc_2: 0.5556  Non0_F1_score: 0.4954  Mult_acc_5: 0.2707  Mult_acc_7: 0.1921  MAE: 1.7311  Corr: -0.0064 
2024-06-12 23:35:38:INFO:TRAIN-(cmcm) (3/14/5)>> loss: 0.8617
2024-06-12 23:35:41:INFO:VAL-(cmcm) >>
2024-06-12 23:35:41:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.4839  Non0_acc_2: 0.5880  Non0_F1_score: 0.4567  Mult_acc_5: 0.2969  Mult_acc_7: 0.2183  MAE: 1.8027  Corr: 0.0600 
2024-06-12 23:35:56:INFO:TRAIN-(cmcm) (4/15/5)>> loss: 0.8541
2024-06-12 23:35:59:INFO:VAL-(cmcm) >>
2024-06-12 23:35:59:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4767  Non0_acc_2: 0.5694  Non0_F1_score: 0.4531  Mult_acc_5: 0.2445  Mult_acc_7: 0.2096  MAE: 1.6481  Corr: -0.0074 
2024-06-12 23:36:14:INFO:TRAIN-(cmcm) (5/16/5)>> loss: 0.8521
2024-06-12 23:36:17:INFO:VAL-(cmcm) >>
2024-06-12 23:36:17:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.4905  Non0_acc_2: 0.5926  Non0_F1_score: 0.4663  Mult_acc_5: 0.3057  Mult_acc_7: 0.2227  MAE: 1.7341  Corr: 0.0594 
2024-06-12 23:36:32:INFO:TRAIN-(cmcm) (6/17/5)>> loss: 0.8525
2024-06-12 23:36:35:INFO:VAL-(cmcm) >>
2024-06-12 23:36:35:INFO:M: >>  Has0_acc_2: 0.6419  Has0_F1_score: 0.5875  Non0_acc_2: 0.6343  Non0_F1_score: 0.5761  Mult_acc_5: 0.2926  Mult_acc_7: 0.2227  MAE: 1.5996  Corr: 0.1522 
2024-06-12 23:36:50:INFO:TRAIN-(cmcm) (7/18/5)>> loss: 0.8481
2024-06-12 23:36:52:INFO:VAL-(cmcm) >>
2024-06-12 23:36:52:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5506  Non0_acc_2: 0.5833  Non0_F1_score: 0.5436  Mult_acc_5: 0.2664  Mult_acc_7: 0.1921  MAE: 1.7368  Corr: 0.0484 
2024-06-12 23:37:08:INFO:TRAIN-(cmcm) (8/19/5)>> loss: 0.8478
2024-06-12 23:37:10:INFO:VAL-(cmcm) >>
2024-06-12 23:37:10:INFO:M: >>  Has0_acc_2: 0.5546  Has0_F1_score: 0.5581  Non0_acc_2: 0.5787  Non0_F1_score: 0.5806  Mult_acc_5: 0.2795  Mult_acc_7: 0.2227  MAE: 1.5401  Corr: 0.1825 
2024-06-12 23:37:25:INFO:TRAIN-(cmcm) (9/20/5)>> loss: 0.8420
2024-06-12 23:37:28:INFO:VAL-(cmcm) >>
2024-06-12 23:37:28:INFO:M: >>  Has0_acc_2: 0.4279  Has0_F1_score: 0.3152  Non0_acc_2: 0.4537  Non0_F1_score: 0.3440  Mult_acc_5: 0.1747  Mult_acc_7: 0.1659  MAE: 1.7305  Corr: 0.0461 
2024-06-12 23:37:43:INFO:TRAIN-(cmcm) (10/21/5)>> loss: 0.8414
2024-06-12 23:37:46:INFO:VAL-(cmcm) >>
2024-06-12 23:37:46:INFO:M: >>  Has0_acc_2: 0.4367  Has0_F1_score: 0.3022  Non0_acc_2: 0.4537  Non0_F1_score: 0.3125  Mult_acc_5: 0.1397  Mult_acc_7: 0.1223  MAE: 1.8982  Corr: 0.0964 
2024-06-12 23:37:53:INFO:TEST-(cmcm) >>
2024-06-12 23:37:53:INFO:M: >>  Has0_acc_2: 0.4563  Has0_F1_score: 0.3028  Non0_acc_2: 0.4543  Non0_F1_score: 0.3321  Mult_acc_5: 0.1516  Mult_acc_7: 0.1516  MAE: 1.5385  Corr: -0.0113 
2024-06-12 23:37:53:INFO:Results are added to results/results/mosi-regression-100.csv...
2024-06-13 10:28:43:INFO:Start running cmcm...
2024-06-13 10:28:43:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 6, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-06-13 10:28:43:INFO:Find gpu: 1, with memory: 378273792 left!
2024-06-13 10:28:43:INFO:Let's use the GPU 1 !
2024-06-13 10:28:43:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 10:28:44:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718245724 HTTP/1.1" 200 235
2024-06-13 10:28:44:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 10:28:45:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 10:28:45:INFO:train samples: (1284,)
2024-06-13 10:28:46:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 10:28:46:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718245726 HTTP/1.1" 200 235
2024-06-13 10:28:46:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 10:28:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 10:28:47:INFO:valid samples: (229,)
2024-06-13 10:28:48:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 10:28:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718245728 HTTP/1.1" 200 235
2024-06-13 10:28:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 10:28:49:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 10:28:49:INFO:test samples: (686,)
2024-06-13 10:28:49:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 10:28:50:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718245730 HTTP/1.1" 200 235
2024-06-13 10:28:50:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 10:28:50:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 10:28:51:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 10:28:51:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718245731 HTTP/1.1" 200 235
2024-06-13 10:28:51:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 10:28:52:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 10:28:52:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-13 10:28:52:WARNING:Try importing flash-attention for faster inference...
2024-06-13 10:28:52:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-13 10:28:52:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-13 10:28:52:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-13 10:28:54:INFO:trainable params: 1310288 || all params: 1838138960 || trainable%: 0.07128340286090232
2024-06-13 10:28:54:INFO:Init labels...
2024-06-13 10:28:54:INFO:Start training...
2024-06-13 10:29:10:INFO:TRAIN-(cmcm) (1/1/1)>> loss: 2.9541
2024-06-13 10:29:12:INFO:VAL-(cmcm) >>
2024-06-13 10:29:12:INFO:M: >>  Has0_acc_2: 0.4279  Has0_F1_score: 0.3499  Non0_acc_2: 0.4537  Non0_F1_score: 0.3793  Mult_acc_5: 0.2314  Mult_acc_7: 0.1921  MAE: 1.8480  Corr: 0.0889 
2024-06-13 10:29:14:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-13 10:29:29:INFO:TRAIN-(cmcm) (1/2/1)>> loss: 0.9444
2024-06-13 10:29:32:INFO:VAL-(cmcm) >>
2024-06-13 10:29:32:INFO:M: >>  Has0_acc_2: 0.4847  Has0_F1_score: 0.4341  Non0_acc_2: 0.5093  Non0_F1_score: 0.4605  Mult_acc_5: 0.1703  Mult_acc_7: 0.1572  MAE: 1.6318  Corr: 0.1602 
2024-06-13 10:29:33:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-13 10:29:48:INFO:TRAIN-(cmcm) (1/3/1)>> loss: 0.9000
2024-06-13 10:29:51:INFO:VAL-(cmcm) >>
2024-06-13 10:29:51:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4577  Non0_acc_2: 0.5787  Non0_F1_score: 0.4291  Mult_acc_5: 0.1572  Mult_acc_7: 0.1572  MAE: 1.4737  Corr: 0.1018 
2024-06-13 10:29:52:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-mosi-regression.pth.
2024-06-13 10:30:07:INFO:TRAIN-(cmcm) (1/4/1)>> loss: 0.9000
2024-06-13 10:30:10:INFO:VAL-(cmcm) >>
2024-06-13 10:30:10:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5694  Non0_F1_score: 0.4166  Mult_acc_5: 0.1921  Mult_acc_7: 0.1921  MAE: 1.4711  Corr: 0.0364 
2024-06-13 10:30:10:INFO:Saving checkpoint at epoch 4 to results/models/cmcm-mosi-regression.pth.
2024-06-13 10:30:26:INFO:TRAIN-(cmcm) (1/5/1)>> loss: 0.8783
2024-06-13 10:30:28:INFO:VAL-(cmcm) >>
2024-06-13 10:30:28:INFO:M: >>  Has0_acc_2: 0.5590  Has0_F1_score: 0.5613  Non0_acc_2: 0.5648  Non0_F1_score: 0.5648  Mult_acc_5: 0.1921  Mult_acc_7: 0.1921  MAE: 1.5737  Corr: 0.0786 
2024-06-13 10:30:43:INFO:TRAIN-(cmcm) (2/6/1)>> loss: 0.8775
2024-06-13 10:30:46:INFO:VAL-(cmcm) >>
2024-06-13 10:30:46:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.5024  Non0_acc_2: 0.4861  Non0_F1_score: 0.4889  Mult_acc_5: 0.1921  Mult_acc_7: 0.1921  MAE: 1.5178  Corr: -0.0471 
2024-06-13 10:31:01:INFO:TRAIN-(cmcm) (3/7/1)>> loss: 0.8619
2024-06-13 10:31:03:INFO:VAL-(cmcm) >>
2024-06-13 10:31:03:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4767  Non0_acc_2: 0.5741  Non0_F1_score: 0.4491  Mult_acc_5: 0.2882  Mult_acc_7: 0.2052  MAE: 1.6708  Corr: 0.0178 
2024-06-13 10:31:18:INFO:TRAIN-(cmcm) (4/8/1)>> loss: 0.8626
2024-06-13 10:31:21:INFO:VAL-(cmcm) >>
2024-06-13 10:31:21:INFO:M: >>  Has0_acc_2: 0.5590  Has0_F1_score: 0.5427  Non0_acc_2: 0.5509  Non0_F1_score: 0.5324  Mult_acc_5: 0.1834  Mult_acc_7: 0.1834  MAE: 1.6283  Corr: -0.0666 
2024-06-13 10:31:36:INFO:TRAIN-(cmcm) (5/9/1)>> loss: 0.8602
2024-06-13 10:31:38:INFO:VAL-(cmcm) >>
2024-06-13 10:31:38:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4534  Non0_acc_2: 0.5694  Non0_F1_score: 0.4246  Mult_acc_5: 0.3013  Mult_acc_7: 0.2227  MAE: 1.8202  Corr: -0.0496 
2024-06-13 10:31:53:INFO:TRAIN-(cmcm) (6/10/1)>> loss: 0.8577
2024-06-13 10:31:56:INFO:VAL-(cmcm) >>
2024-06-13 10:31:56:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5472  Non0_acc_2: 0.5602  Non0_F1_score: 0.5334  Mult_acc_5: 0.2795  Mult_acc_7: 0.2052  MAE: 1.7507  Corr: 0.0113 
2024-06-13 10:32:11:INFO:TRAIN-(cmcm) (7/11/1)>> loss: 0.8599
2024-06-13 10:32:13:INFO:VAL-(cmcm) >>
2024-06-13 10:32:13:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5219  Non0_acc_2: 0.5556  Non0_F1_score: 0.5030  Mult_acc_5: 0.2445  Mult_acc_7: 0.2096  MAE: 1.7385  Corr: 0.0122 
2024-06-13 10:32:28:INFO:TRAIN-(cmcm) (8/12/1)>> loss: 0.8505
2024-06-13 10:32:31:INFO:VAL-(cmcm) >>
2024-06-13 10:32:31:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.4438  Non0_acc_2: 0.5648  Non0_F1_score: 0.4144  Mult_acc_5: 0.2489  Mult_acc_7: 0.1878  MAE: 1.5787  Corr: 0.0298 
2024-06-13 10:32:46:INFO:TRAIN-(cmcm) (9/13/1)>> loss: 0.8501
2024-06-13 10:32:48:INFO:VAL-(cmcm) >>
2024-06-13 10:32:48:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.4947  Non0_acc_2: 0.5602  Non0_F1_score: 0.4710  Mult_acc_5: 0.2009  Mult_acc_7: 0.1747  MAE: 1.6940  Corr: -0.0276 
2024-06-13 10:33:03:INFO:TRAIN-(cmcm) (10/14/1)>> loss: 0.8478
2024-06-13 10:33:06:INFO:VAL-(cmcm) >>
2024-06-13 10:33:06:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5053  Non0_acc_2: 0.5602  Non0_F1_score: 0.4945  Mult_acc_5: 0.1834  Mult_acc_7: 0.1790  MAE: 1.4890  Corr: -0.0091 
2024-06-13 10:33:13:INFO:TEST-(cmcm) >>
2024-06-13 10:33:13:INFO:M: >>  Has0_acc_2: 0.4475  Has0_F1_score: 0.2767  Non0_acc_2: 0.4268  Non0_F1_score: 0.2658  Mult_acc_5: 0.1560  Mult_acc_7: 0.1560  MAE: 1.6748  Corr: 0.0089 
2024-06-13 10:33:14:INFO:Results are added to results/results/mosi-regression-30.csv...
2024-06-13 10:33:14:INFO:Start running cmcm...
2024-06-13 10:33:14:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 6, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 2222}>
2024-06-13 10:33:14:INFO:Let's use the GPU 1 !
2024-06-13 10:33:14:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 10:33:14:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718245995 HTTP/1.1" 200 235
2024-06-13 10:33:15:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 10:33:15:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 10:33:16:INFO:train samples: (1284,)
2024-06-13 10:33:16:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 10:33:17:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718245997 HTTP/1.1" 200 235
2024-06-13 10:33:17:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 10:33:17:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 10:33:18:INFO:valid samples: (229,)
2024-06-13 10:33:18:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 10:33:18:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718245998 HTTP/1.1" 200 235
2024-06-13 10:33:19:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 10:33:19:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 10:33:20:INFO:test samples: (686,)
2024-06-13 10:33:20:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 10:33:20:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718246000 HTTP/1.1" 200 235
2024-06-13 10:33:20:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 10:33:21:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 10:33:21:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 10:33:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718246002 HTTP/1.1" 200 235
2024-06-13 10:33:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 10:33:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 10:33:22:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-13 10:33:22:WARNING:Try importing flash-attention for faster inference...
2024-06-13 10:33:22:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-13 10:33:22:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-13 10:33:22:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-13 10:33:24:INFO:trainable params: 1310288 || all params: 1838138960 || trainable%: 0.07128340286090232
2024-06-13 10:33:24:INFO:Init labels...
2024-06-13 10:33:24:INFO:Start training...
2024-06-13 10:33:39:INFO:TRAIN-(cmcm) (1/1/2)>> loss: 3.1341
2024-06-13 10:33:41:INFO:VAL-(cmcm) >>
2024-06-13 10:33:41:INFO:M: >>  Has0_acc_2: 0.5546  Has0_F1_score: 0.5482  Non0_acc_2: 0.5648  Non0_F1_score: 0.5564  Mult_acc_5: 0.1965  Mult_acc_7: 0.1965  MAE: 1.5296  Corr: 0.0738 
2024-06-13 10:33:43:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-13 10:33:58:INFO:TRAIN-(cmcm) (1/2/2)>> loss: 1.0530
2024-06-13 10:34:00:INFO:VAL-(cmcm) >>
2024-06-13 10:34:00:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4556  Non0_acc_2: 0.5694  Non0_F1_score: 0.4246  Mult_acc_5: 0.2227  Mult_acc_7: 0.1878  MAE: 1.5593  Corr: 0.0063 
2024-06-13 10:34:15:INFO:TRAIN-(cmcm) (2/3/2)>> loss: 0.9603
2024-06-13 10:34:18:INFO:VAL-(cmcm) >>
2024-06-13 10:34:18:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5741  Non0_F1_score: 0.4187  Mult_acc_5: 0.2926  Mult_acc_7: 0.2096  MAE: 1.7092  Corr: -0.0359 
2024-06-13 10:34:33:INFO:TRAIN-(cmcm) (3/4/2)>> loss: 0.9378
2024-06-13 10:34:35:INFO:VAL-(cmcm) >>
2024-06-13 10:34:35:INFO:M: >>  Has0_acc_2: 0.5546  Has0_F1_score: 0.5211  Non0_acc_2: 0.5231  Non0_F1_score: 0.5056  Mult_acc_5: 0.2052  Mult_acc_7: 0.1747  MAE: 1.5497  Corr: 0.0827 
2024-06-13 10:34:50:INFO:TRAIN-(cmcm) (4/5/2)>> loss: 0.8999
2024-06-13 10:34:53:INFO:VAL-(cmcm) >>
2024-06-13 10:34:53:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5346  Non0_acc_2: 0.5648  Non0_F1_score: 0.5097  Mult_acc_5: 0.2795  Mult_acc_7: 0.2096  MAE: 1.6763  Corr: 0.0132 
2024-06-13 10:35:08:INFO:TRAIN-(cmcm) (5/6/2)>> loss: 0.8856
2024-06-13 10:35:10:INFO:VAL-(cmcm) >>
2024-06-13 10:35:10:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5028  Non0_acc_2: 0.5463  Non0_F1_score: 0.4764  Mult_acc_5: 0.1921  Mult_acc_7: 0.1878  MAE: 1.4873  Corr: 0.0191 
2024-06-13 10:35:11:INFO:Saving checkpoint at epoch 6 to results/models/cmcm-mosi-regression.pth.
2024-06-13 10:35:27:INFO:TRAIN-(cmcm) (1/7/2)>> loss: 0.8847
2024-06-13 10:35:29:INFO:VAL-(cmcm) >>
2024-06-13 10:35:29:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.5840  Non0_acc_2: 0.6019  Non0_F1_score: 0.6032  Mult_acc_5: 0.2795  Mult_acc_7: 0.2271  MAE: 1.5130  Corr: 0.1261 
2024-06-13 10:35:44:INFO:TRAIN-(cmcm) (2/8/2)>> loss: 0.8717
2024-06-13 10:35:47:INFO:VAL-(cmcm) >>
2024-06-13 10:35:47:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.4762  Non0_acc_2: 0.5509  Non0_F1_score: 0.4486  Mult_acc_5: 0.2707  Mult_acc_7: 0.2140  MAE: 1.7442  Corr: 0.0058 
2024-06-13 10:36:02:INFO:TRAIN-(cmcm) (3/9/2)>> loss: 0.8665
2024-06-13 10:36:04:INFO:VAL-(cmcm) >>
2024-06-13 10:36:04:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.5024  Non0_acc_2: 0.5602  Non0_F1_score: 0.4761  Mult_acc_5: 0.3013  Mult_acc_7: 0.2183  MAE: 1.7564  Corr: 0.0098 
2024-06-13 10:36:19:INFO:TRAIN-(cmcm) (4/10/2)>> loss: 0.8714
2024-06-13 10:36:22:INFO:VAL-(cmcm) >>
2024-06-13 10:36:22:INFO:M: >>  Has0_acc_2: 0.6201  Has0_F1_score: 0.6105  Non0_acc_2: 0.6111  Non0_F1_score: 0.6019  Mult_acc_5: 0.3100  Mult_acc_7: 0.2314  MAE: 1.6040  Corr: 0.1905 
2024-06-13 10:36:37:INFO:TRAIN-(cmcm) (5/11/2)>> loss: 0.8604
2024-06-13 10:36:40:INFO:VAL-(cmcm) >>
2024-06-13 10:36:40:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5170  Non0_acc_2: 0.5741  Non0_F1_score: 0.5679  Mult_acc_5: 0.2358  Mult_acc_7: 0.2183  MAE: 1.4894  Corr: 0.1001 
2024-06-13 10:36:55:INFO:TRAIN-(cmcm) (6/12/2)>> loss: 0.8491
2024-06-13 10:36:57:INFO:VAL-(cmcm) >>
2024-06-13 10:36:57:INFO:M: >>  Has0_acc_2: 0.6245  Has0_F1_score: 0.5331  Non0_acc_2: 0.6019  Non0_F1_score: 0.5085  Mult_acc_5: 0.2314  Mult_acc_7: 0.2183  MAE: 1.4528  Corr: 0.1965 
2024-06-13 10:36:58:INFO:Saving checkpoint at epoch 12 to results/models/cmcm-mosi-regression.pth.
2024-06-13 10:37:13:INFO:TRAIN-(cmcm) (1/13/2)>> loss: 0.8435
2024-06-13 10:37:16:INFO:VAL-(cmcm) >>
2024-06-13 10:37:16:INFO:M: >>  Has0_acc_2: 0.5153  Has0_F1_score: 0.4750  Non0_acc_2: 0.5417  Non0_F1_score: 0.5034  Mult_acc_5: 0.2096  Mult_acc_7: 0.1747  MAE: 1.5787  Corr: 0.2049 
2024-06-13 10:37:31:INFO:TRAIN-(cmcm) (2/14/2)>> loss: 0.8391
2024-06-13 10:37:33:INFO:VAL-(cmcm) >>
2024-06-13 10:37:33:INFO:M: >>  Has0_acc_2: 0.6201  Has0_F1_score: 0.5398  Non0_acc_2: 0.5972  Non0_F1_score: 0.5155  Mult_acc_5: 0.3319  Mult_acc_7: 0.2751  MAE: 1.4484  Corr: 0.2445 
2024-06-13 10:37:34:INFO:Saving checkpoint at epoch 14 to results/models/cmcm-mosi-regression.pth.
2024-06-13 10:37:50:INFO:TRAIN-(cmcm) (1/15/2)>> loss: 0.8273
2024-06-13 10:37:52:INFO:VAL-(cmcm) >>
2024-06-13 10:37:52:INFO:M: >>  Has0_acc_2: 0.6550  Has0_F1_score: 0.6487  Non0_acc_2: 0.6528  Non0_F1_score: 0.6507  Mult_acc_5: 0.2664  Mult_acc_7: 0.2183  MAE: 1.4030  Corr: 0.2759 
2024-06-13 10:37:53:INFO:Saving checkpoint at epoch 15 to results/models/cmcm-mosi-regression.pth.
2024-06-13 10:38:08:INFO:TRAIN-(cmcm) (1/16/2)>> loss: 0.8258
2024-06-13 10:38:11:INFO:VAL-(cmcm) >>
2024-06-13 10:38:11:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5710  Non0_acc_2: 0.5880  Non0_F1_score: 0.5627  Mult_acc_5: 0.2926  Mult_acc_7: 0.2445  MAE: 1.4829  Corr: 0.3174 
2024-06-13 10:38:26:INFO:TRAIN-(cmcm) (2/17/2)>> loss: 0.8157
2024-06-13 10:38:28:INFO:VAL-(cmcm) >>
2024-06-13 10:38:28:INFO:M: >>  Has0_acc_2: 0.6507  Has0_F1_score: 0.6538  Non0_acc_2: 0.6713  Non0_F1_score: 0.6728  Mult_acc_5: 0.3231  Mult_acc_7: 0.2664  MAE: 1.3148  Corr: 0.3762 
2024-06-13 10:38:29:INFO:Saving checkpoint at epoch 17 to results/models/cmcm-mosi-regression.pth.
2024-06-13 10:38:45:INFO:TRAIN-(cmcm) (1/18/2)>> loss: 0.8023
2024-06-13 10:38:47:INFO:VAL-(cmcm) >>
2024-06-13 10:38:47:INFO:M: >>  Has0_acc_2: 0.6419  Has0_F1_score: 0.6428  Non0_acc_2: 0.6667  Non0_F1_score: 0.6667  Mult_acc_5: 0.3450  Mult_acc_7: 0.2882  MAE: 1.3468  Corr: 0.3894 
2024-06-13 10:39:02:INFO:TRAIN-(cmcm) (2/19/2)>> loss: 0.7950
2024-06-13 10:39:05:INFO:VAL-(cmcm) >>
2024-06-13 10:39:05:INFO:M: >>  Has0_acc_2: 0.6463  Has0_F1_score: 0.6477  Non0_acc_2: 0.6667  Non0_F1_score: 0.6656  Mult_acc_5: 0.3668  Mult_acc_7: 0.2969  MAE: 1.2798  Corr: 0.4076 
2024-06-13 10:39:05:INFO:Saving checkpoint at epoch 19 to results/models/cmcm-mosi-regression.pth.
2024-06-13 10:39:21:INFO:TRAIN-(cmcm) (1/20/2)>> loss: 0.7918
2024-06-13 10:39:23:INFO:VAL-(cmcm) >>
2024-06-13 10:39:23:INFO:M: >>  Has0_acc_2: 0.6507  Has0_F1_score: 0.6507  Non0_acc_2: 0.6528  Non0_F1_score: 0.6514  Mult_acc_5: 0.3843  Mult_acc_7: 0.2969  MAE: 1.2951  Corr: 0.4038 
2024-06-13 10:39:38:INFO:TRAIN-(cmcm) (2/21/2)>> loss: 0.7798
2024-06-13 10:39:41:INFO:VAL-(cmcm) >>
2024-06-13 10:39:41:INFO:M: >>  Has0_acc_2: 0.6376  Has0_F1_score: 0.6399  Non0_acc_2: 0.6713  Non0_F1_score: 0.6715  Mult_acc_5: 0.3581  Mult_acc_7: 0.2926  MAE: 1.3140  Corr: 0.3953 
2024-06-13 10:39:56:INFO:TRAIN-(cmcm) (3/22/2)>> loss: 0.7688
2024-06-13 10:39:58:INFO:VAL-(cmcm) >>
2024-06-13 10:39:58:INFO:M: >>  Has0_acc_2: 0.6463  Has0_F1_score: 0.6489  Non0_acc_2: 0.6667  Non0_F1_score: 0.6685  Mult_acc_5: 0.3712  Mult_acc_7: 0.2838  MAE: 1.3794  Corr: 0.3725 
2024-06-13 10:40:13:INFO:TRAIN-(cmcm) (4/23/2)>> loss: 0.7638
2024-06-13 10:40:16:INFO:VAL-(cmcm) >>
2024-06-13 10:40:16:INFO:M: >>  Has0_acc_2: 0.6550  Has0_F1_score: 0.6568  Non0_acc_2: 0.6620  Non0_F1_score: 0.6623  Mult_acc_5: 0.3319  Mult_acc_7: 0.2751  MAE: 1.2798  Corr: 0.4029 
2024-06-13 10:40:31:INFO:TRAIN-(cmcm) (5/24/2)>> loss: 0.7546
2024-06-13 10:40:34:INFO:VAL-(cmcm) >>
2024-06-13 10:40:34:INFO:M: >>  Has0_acc_2: 0.6769  Has0_F1_score: 0.6799  Non0_acc_2: 0.7037  Non0_F1_score: 0.7047  Mult_acc_5: 0.3712  Mult_acc_7: 0.2969  MAE: 1.2541  Corr: 0.4666 
2024-06-13 10:40:34:INFO:Saving checkpoint at epoch 24 to results/models/cmcm-mosi-regression.pth.
2024-06-13 10:40:50:INFO:TRAIN-(cmcm) (1/25/2)>> loss: 0.7503
2024-06-13 10:40:52:INFO:VAL-(cmcm) >>
2024-06-13 10:40:52:INFO:M: >>  Has0_acc_2: 0.6900  Has0_F1_score: 0.6884  Non0_acc_2: 0.6852  Non0_F1_score: 0.6852  Mult_acc_5: 0.3930  Mult_acc_7: 0.3144  MAE: 1.2344  Corr: 0.4461 
2024-06-13 10:40:53:INFO:Saving checkpoint at epoch 25 to results/models/cmcm-mosi-regression.pth.
2024-06-13 10:41:08:INFO:TRAIN-(cmcm) (1/26/2)>> loss: 0.7428
2024-06-13 10:41:11:INFO:VAL-(cmcm) >>
2024-06-13 10:41:11:INFO:M: >>  Has0_acc_2: 0.6725  Has0_F1_score: 0.6746  Non0_acc_2: 0.6944  Non0_F1_score: 0.6961  Mult_acc_5: 0.3886  Mult_acc_7: 0.3100  MAE: 1.1999  Corr: 0.4596 
2024-06-13 10:41:12:INFO:Saving checkpoint at epoch 26 to results/models/cmcm-mosi-regression.pth.
2024-06-13 10:41:27:INFO:TRAIN-(cmcm) (1/27/2)>> loss: 0.7330
2024-06-13 10:41:30:INFO:VAL-(cmcm) >>
2024-06-13 10:41:30:INFO:M: >>  Has0_acc_2: 0.6987  Has0_F1_score: 0.6984  Non0_acc_2: 0.7037  Non0_F1_score: 0.7028  Mult_acc_5: 0.3974  Mult_acc_7: 0.3144  MAE: 1.2248  Corr: 0.4555 
2024-06-13 10:41:45:INFO:TRAIN-(cmcm) (2/28/2)>> loss: 0.7269
2024-06-13 10:41:47:INFO:VAL-(cmcm) >>
2024-06-13 10:41:47:INFO:M: >>  Has0_acc_2: 0.6812  Has0_F1_score: 0.6789  Non0_acc_2: 0.6852  Non0_F1_score: 0.6842  Mult_acc_5: 0.3843  Mult_acc_7: 0.3013  MAE: 1.2239  Corr: 0.4554 
2024-06-13 10:42:02:INFO:TRAIN-(cmcm) (3/29/2)>> loss: 0.7248
2024-06-13 10:42:05:INFO:VAL-(cmcm) >>
2024-06-13 10:42:05:INFO:M: >>  Has0_acc_2: 0.6812  Has0_F1_score: 0.6820  Non0_acc_2: 0.6944  Non0_F1_score: 0.6957  Mult_acc_5: 0.3974  Mult_acc_7: 0.3144  MAE: 1.1951  Corr: 0.4662 
2024-06-13 10:42:05:INFO:Saving checkpoint at epoch 29 to results/models/cmcm-mosi-regression.pth.
2024-06-13 10:42:21:INFO:TRAIN-(cmcm) (1/30/2)>> loss: 0.7228
2024-06-13 10:42:23:INFO:VAL-(cmcm) >>
2024-06-13 10:42:23:INFO:M: >>  Has0_acc_2: 0.6725  Has0_F1_score: 0.6733  Non0_acc_2: 0.6852  Non0_F1_score: 0.6865  Mult_acc_5: 0.3930  Mult_acc_7: 0.3144  MAE: 1.2187  Corr: 0.4411 
2024-06-13 10:42:38:INFO:TRAIN-(cmcm) (2/31/2)>> loss: 0.7227
2024-06-13 10:42:41:INFO:VAL-(cmcm) >>
2024-06-13 10:42:41:INFO:M: >>  Has0_acc_2: 0.6812  Has0_F1_score: 0.6820  Non0_acc_2: 0.6898  Non0_F1_score: 0.6910  Mult_acc_5: 0.3886  Mult_acc_7: 0.3057  MAE: 1.2082  Corr: 0.4541 
2024-06-13 10:42:56:INFO:TRAIN-(cmcm) (3/32/2)>> loss: 0.7259
2024-06-13 10:42:58:INFO:VAL-(cmcm) >>
2024-06-13 10:42:58:INFO:M: >>  Has0_acc_2: 0.6856  Has0_F1_score: 0.6861  Non0_acc_2: 0.6991  Non0_F1_score: 0.7004  Mult_acc_5: 0.3930  Mult_acc_7: 0.3100  MAE: 1.1816  Corr: 0.4743 
2024-06-13 10:42:59:INFO:Saving checkpoint at epoch 32 to results/models/cmcm-mosi-regression.pth.
2024-06-13 10:43:15:INFO:TRAIN-(cmcm) (1/33/2)>> loss: 0.7268
2024-06-13 10:43:17:INFO:VAL-(cmcm) >>
2024-06-13 10:43:17:INFO:M: >>  Has0_acc_2: 0.6681  Has0_F1_score: 0.6704  Non0_acc_2: 0.6759  Non0_F1_score: 0.6773  Mult_acc_5: 0.3974  Mult_acc_7: 0.3144  MAE: 1.2397  Corr: 0.4374 
2024-06-13 10:43:32:INFO:TRAIN-(cmcm) (2/34/2)>> loss: 0.7309
2024-06-13 10:43:35:INFO:VAL-(cmcm) >>
2024-06-13 10:43:35:INFO:M: >>  Has0_acc_2: 0.6769  Has0_F1_score: 0.6787  Non0_acc_2: 0.6620  Non0_F1_score: 0.6637  Mult_acc_5: 0.3537  Mult_acc_7: 0.2926  MAE: 1.1733  Corr: 0.4849 
2024-06-13 10:43:36:INFO:Saving checkpoint at epoch 34 to results/models/cmcm-mosi-regression.pth.
2024-06-13 10:43:51:INFO:TRAIN-(cmcm) (1/35/2)>> loss: 0.7361
2024-06-13 10:43:54:INFO:VAL-(cmcm) >>
2024-06-13 10:43:54:INFO:M: >>  Has0_acc_2: 0.6769  Has0_F1_score: 0.6783  Non0_acc_2: 0.6667  Non0_F1_score: 0.6683  Mult_acc_5: 0.3799  Mult_acc_7: 0.3144  MAE: 1.2279  Corr: 0.4321 
2024-06-13 10:44:09:INFO:TRAIN-(cmcm) (2/36/2)>> loss: 0.7405
2024-06-13 10:44:11:INFO:VAL-(cmcm) >>
2024-06-13 10:44:11:INFO:M: >>  Has0_acc_2: 0.6638  Has0_F1_score: 0.6484  Non0_acc_2: 0.6713  Non0_F1_score: 0.6618  Mult_acc_5: 0.3843  Mult_acc_7: 0.2926  MAE: 1.2835  Corr: 0.4428 
2024-06-13 10:44:26:INFO:TRAIN-(cmcm) (3/37/2)>> loss: 0.7439
2024-06-13 10:44:29:INFO:VAL-(cmcm) >>
2024-06-13 10:44:29:INFO:M: >>  Has0_acc_2: 0.6638  Has0_F1_score: 0.6670  Non0_acc_2: 0.6759  Non0_F1_score: 0.6777  Mult_acc_5: 0.3668  Mult_acc_7: 0.2882  MAE: 1.2357  Corr: 0.4532 
2024-06-13 10:44:44:INFO:TRAIN-(cmcm) (4/38/2)>> loss: 0.7467
2024-06-13 10:44:47:INFO:VAL-(cmcm) >>
2024-06-13 10:44:47:INFO:M: >>  Has0_acc_2: 0.6900  Has0_F1_score: 0.6498  Non0_acc_2: 0.7037  Non0_F1_score: 0.6894  Mult_acc_5: 0.3799  Mult_acc_7: 0.2969  MAE: 1.2774  Corr: 0.4705 
2024-06-13 10:45:02:INFO:TRAIN-(cmcm) (5/39/2)>> loss: 0.7584
2024-06-13 10:45:04:INFO:VAL-(cmcm) >>
2024-06-13 10:45:04:INFO:M: >>  Has0_acc_2: 0.6900  Has0_F1_score: 0.6727  Non0_acc_2: 0.6944  Non0_F1_score: 0.6797  Mult_acc_5: 0.3406  Mult_acc_7: 0.2795  MAE: 1.2472  Corr: 0.4162 
2024-06-13 10:45:19:INFO:TRAIN-(cmcm) (6/40/2)>> loss: 0.7684
2024-06-13 10:45:22:INFO:VAL-(cmcm) >>
2024-06-13 10:45:22:INFO:M: >>  Has0_acc_2: 0.6769  Has0_F1_score: 0.6779  Non0_acc_2: 0.6759  Non0_F1_score: 0.6770  Mult_acc_5: 0.3712  Mult_acc_7: 0.3057  MAE: 1.2136  Corr: 0.4340 
2024-06-13 10:45:37:INFO:TRAIN-(cmcm) (7/41/2)>> loss: 0.7573
2024-06-13 10:45:39:INFO:VAL-(cmcm) >>
2024-06-13 10:45:39:INFO:M: >>  Has0_acc_2: 0.6812  Has0_F1_score: 0.6720  Non0_acc_2: 0.6898  Non0_F1_score: 0.6784  Mult_acc_5: 0.3930  Mult_acc_7: 0.2969  MAE: 1.3956  Corr: 0.4151 
2024-06-13 10:45:55:INFO:TRAIN-(cmcm) (8/42/2)>> loss: 0.7626
2024-06-13 10:45:57:INFO:VAL-(cmcm) >>
2024-06-13 10:45:57:INFO:M: >>  Has0_acc_2: 0.6943  Has0_F1_score: 0.6970  Non0_acc_2: 0.7176  Non0_F1_score: 0.7190  Mult_acc_5: 0.3668  Mult_acc_7: 0.2926  MAE: 1.2459  Corr: 0.4868 
2024-06-13 10:46:12:INFO:TRAIN-(cmcm) (9/43/2)>> loss: 0.7610
2024-06-13 10:46:15:INFO:VAL-(cmcm) >>
2024-06-13 10:46:15:INFO:M: >>  Has0_acc_2: 0.6725  Has0_F1_score: 0.6754  Non0_acc_2: 0.6667  Non0_F1_score: 0.6678  Mult_acc_5: 0.3231  Mult_acc_7: 0.2664  MAE: 1.2069  Corr: 0.4661 
2024-06-13 10:46:30:INFO:TRAIN-(cmcm) (10/44/2)>> loss: 0.7680
2024-06-13 10:46:32:INFO:VAL-(cmcm) >>
2024-06-13 10:46:32:INFO:M: >>  Has0_acc_2: 0.7162  Has0_F1_score: 0.7032  Non0_acc_2: 0.7130  Non0_F1_score: 0.7145  Mult_acc_5: 0.3231  Mult_acc_7: 0.2707  MAE: 1.1746  Corr: 0.4996 
2024-06-13 10:46:40:INFO:TEST-(cmcm) >>
2024-06-13 10:46:40:INFO:M: >>  Has0_acc_2: 0.6793  Has0_F1_score: 0.6802  Non0_acc_2: 0.6845  Non0_F1_score: 0.6848  Mult_acc_5: 0.2915  Mult_acc_7: 0.2580  MAE: 1.2931  Corr: 0.3782 
2024-06-13 10:46:40:INFO:Results are added to results/results/mosi-regression-30.csv...
2024-06-13 10:46:40:INFO:Start running cmcm...
2024-06-13 10:46:40:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 6, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 3333}>
2024-06-13 10:46:40:INFO:Let's use the GPU 1 !
2024-06-13 10:46:40:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 10:46:41:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718246801 HTTP/1.1" 200 235
2024-06-13 10:46:41:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 10:46:42:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 10:46:42:INFO:train samples: (1284,)
2024-06-13 10:46:43:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 10:46:43:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718246803 HTTP/1.1" 200 235
2024-06-13 10:46:43:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 10:46:44:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 10:46:45:INFO:valid samples: (229,)
2024-06-13 10:46:45:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 10:46:45:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718246805 HTTP/1.1" 200 235
2024-06-13 10:46:45:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 10:46:46:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 10:46:47:INFO:test samples: (686,)
2024-06-13 10:46:47:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 10:46:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718246807 HTTP/1.1" 200 235
2024-06-13 10:46:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 10:46:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 10:46:49:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 10:46:49:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718246809 HTTP/1.1" 200 235
2024-06-13 10:46:49:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 10:46:50:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 10:46:50:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-13 10:46:50:WARNING:Try importing flash-attention for faster inference...
2024-06-13 10:46:50:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-13 10:46:50:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-13 10:46:50:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-13 10:46:51:INFO:trainable params: 1310288 || all params: 1838138960 || trainable%: 0.07128340286090232
2024-06-13 10:46:51:INFO:Init labels...
2024-06-13 10:46:51:INFO:Start training...
2024-06-13 10:47:07:INFO:TRAIN-(cmcm) (1/1/3)>> loss: 3.3081
2024-06-13 10:47:09:INFO:VAL-(cmcm) >>
2024-06-13 10:47:09:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4676  Non0_acc_2: 0.5648  Non0_F1_score: 0.4841  Mult_acc_5: 0.2707  Mult_acc_7: 0.2052  MAE: 1.6795  Corr: 0.0253 
2024-06-13 10:47:10:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-13 10:47:26:INFO:TRAIN-(cmcm) (1/2/3)>> loss: 1.0923
2024-06-13 10:47:29:INFO:VAL-(cmcm) >>
2024-06-13 10:47:29:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.5005  Non0_acc_2: 0.5741  Non0_F1_score: 0.4742  Mult_acc_5: 0.2009  Mult_acc_7: 0.1965  MAE: 1.5715  Corr: 0.0245 
2024-06-13 10:47:30:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-13 10:47:45:INFO:TRAIN-(cmcm) (1/3/3)>> loss: 0.9426
2024-06-13 10:47:48:INFO:VAL-(cmcm) >>
2024-06-13 10:47:48:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.6010  Non0_acc_2: 0.6019  Non0_F1_score: 0.6028  Mult_acc_5: 0.2227  Mult_acc_7: 0.2140  MAE: 1.4842  Corr: 0.1673 
2024-06-13 10:47:49:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-mosi-regression.pth.
2024-06-13 10:48:05:INFO:TRAIN-(cmcm) (1/4/3)>> loss: 0.8935
2024-06-13 10:48:08:INFO:VAL-(cmcm) >>
2024-06-13 10:48:08:INFO:M: >>  Has0_acc_2: 0.4192  Has0_F1_score: 0.2931  Non0_acc_2: 0.4444  Non0_F1_score: 0.3208  Mult_acc_5: 0.1485  Mult_acc_7: 0.1441  MAE: 1.8825  Corr: 0.0238 
2024-06-13 10:48:23:INFO:TRAIN-(cmcm) (2/5/3)>> loss: 0.8747
2024-06-13 10:48:25:INFO:VAL-(cmcm) >>
2024-06-13 10:48:25:INFO:M: >>  Has0_acc_2: 0.5066  Has0_F1_score: 0.5114  Non0_acc_2: 0.4954  Non0_F1_score: 0.4981  Mult_acc_5: 0.2009  Mult_acc_7: 0.1834  MAE: 1.8101  Corr: -0.0355 
2024-06-13 10:48:40:INFO:TRAIN-(cmcm) (3/6/3)>> loss: 0.8683
2024-06-13 10:48:43:INFO:VAL-(cmcm) >>
2024-06-13 10:48:43:INFO:M: >>  Has0_acc_2: 0.6332  Has0_F1_score: 0.5872  Non0_acc_2: 0.6250  Non0_F1_score: 0.5759  Mult_acc_5: 0.3100  Mult_acc_7: 0.2358  MAE: 1.5580  Corr: 0.2208 
2024-06-13 10:48:58:INFO:TRAIN-(cmcm) (4/7/3)>> loss: 0.8588
2024-06-13 10:49:01:INFO:VAL-(cmcm) >>
2024-06-13 10:49:01:INFO:M: >>  Has0_acc_2: 0.6463  Has0_F1_score: 0.6317  Non0_acc_2: 0.6435  Non0_F1_score: 0.6272  Mult_acc_5: 0.3144  Mult_acc_7: 0.2358  MAE: 1.4630  Corr: 0.2339 
2024-06-13 10:49:02:INFO:Saving checkpoint at epoch 7 to results/models/cmcm-mosi-regression.pth.
2024-06-13 10:49:17:INFO:TRAIN-(cmcm) (1/8/3)>> loss: 0.8571
2024-06-13 10:49:20:INFO:VAL-(cmcm) >>
2024-06-13 10:49:20:INFO:M: >>  Has0_acc_2: 0.6332  Has0_F1_score: 0.5662  Non0_acc_2: 0.6204  Non0_F1_score: 0.5541  Mult_acc_5: 0.2140  Mult_acc_7: 0.1921  MAE: 1.4484  Corr: 0.1800 
2024-06-13 10:49:20:INFO:Saving checkpoint at epoch 8 to results/models/cmcm-mosi-regression.pth.
2024-06-13 10:49:36:INFO:TRAIN-(cmcm) (1/9/3)>> loss: 0.8437
2024-06-13 10:49:39:INFO:VAL-(cmcm) >>
2024-06-13 10:49:39:INFO:M: >>  Has0_acc_2: 0.6681  Has0_F1_score: 0.6488  Non0_acc_2: 0.6713  Non0_F1_score: 0.6494  Mult_acc_5: 0.2926  Mult_acc_7: 0.2183  MAE: 1.4114  Corr: 0.3115 
2024-06-13 10:49:40:INFO:Saving checkpoint at epoch 9 to results/models/cmcm-mosi-regression.pth.
2024-06-13 10:49:55:INFO:TRAIN-(cmcm) (1/10/3)>> loss: 0.8326
2024-06-13 10:49:58:INFO:VAL-(cmcm) >>
2024-06-13 10:49:58:INFO:M: >>  Has0_acc_2: 0.6681  Has0_F1_score: 0.6625  Non0_acc_2: 0.6759  Non0_F1_score: 0.6683  Mult_acc_5: 0.2969  Mult_acc_7: 0.2358  MAE: 1.2947  Corr: 0.3584 
2024-06-13 10:49:59:INFO:Saving checkpoint at epoch 10 to results/models/cmcm-mosi-regression.pth.
2024-06-13 10:50:14:INFO:TRAIN-(cmcm) (1/11/3)>> loss: 0.8216
2024-06-13 10:50:17:INFO:VAL-(cmcm) >>
2024-06-13 10:50:17:INFO:M: >>  Has0_acc_2: 0.6376  Has0_F1_score: 0.5610  Non0_acc_2: 0.6574  Non0_F1_score: 0.6196  Mult_acc_5: 0.3537  Mult_acc_7: 0.2795  MAE: 1.3520  Corr: 0.3388 
2024-06-13 10:50:34:INFO:TRAIN-(cmcm) (2/12/3)>> loss: 0.8126
2024-06-13 10:50:37:INFO:VAL-(cmcm) >>
2024-06-13 10:50:37:INFO:M: >>  Has0_acc_2: 0.6856  Has0_F1_score: 0.6887  Non0_acc_2: 0.6667  Non0_F1_score: 0.6671  Mult_acc_5: 0.2664  Mult_acc_7: 0.2358  MAE: 1.2646  Corr: 0.4406 
2024-06-13 10:50:38:INFO:Saving checkpoint at epoch 12 to results/models/cmcm-mosi-regression.pth.
2024-06-13 10:51:00:INFO:TRAIN-(cmcm) (1/13/3)>> loss: 0.8030
2024-06-13 10:51:03:INFO:VAL-(cmcm) >>
2024-06-13 10:51:03:INFO:M: >>  Has0_acc_2: 0.6987  Has0_F1_score: 0.6835  Non0_acc_2: 0.6991  Non0_F1_score: 0.6823  Mult_acc_5: 0.3319  Mult_acc_7: 0.2576  MAE: 1.2538  Corr: 0.4132 
2024-06-13 10:51:04:INFO:Saving checkpoint at epoch 13 to results/models/cmcm-mosi-regression.pth.
2024-06-13 10:51:25:INFO:TRAIN-(cmcm) (1/14/3)>> loss: 0.7958
2024-06-13 10:51:29:INFO:VAL-(cmcm) >>
2024-06-13 10:51:29:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5466  Non0_acc_2: 0.6019  Non0_F1_score: 0.5784  Mult_acc_5: 0.2314  Mult_acc_7: 0.1921  MAE: 1.5263  Corr: 0.3599 
2024-06-13 10:51:50:INFO:TRAIN-(cmcm) (2/15/3)>> loss: 0.8056
2024-06-13 10:51:54:INFO:VAL-(cmcm) >>
2024-06-13 10:51:54:INFO:M: >>  Has0_acc_2: 0.7293  Has0_F1_score: 0.7121  Non0_acc_2: 0.7361  Non0_F1_score: 0.7214  Mult_acc_5: 0.3275  Mult_acc_7: 0.2576  MAE: 1.2368  Corr: 0.4787 
2024-06-13 10:51:54:INFO:Saving checkpoint at epoch 15 to results/models/cmcm-mosi-regression.pth.
2024-06-13 10:52:16:INFO:TRAIN-(cmcm) (1/16/3)>> loss: 0.7845
2024-06-13 10:52:20:INFO:VAL-(cmcm) >>
2024-06-13 10:52:20:INFO:M: >>  Has0_acc_2: 0.6943  Has0_F1_score: 0.6943  Non0_acc_2: 0.7130  Non0_F1_score: 0.7125  Mult_acc_5: 0.3755  Mult_acc_7: 0.2926  MAE: 1.2084  Corr: 0.4755 
2024-06-13 10:52:20:INFO:Saving checkpoint at epoch 16 to results/models/cmcm-mosi-regression.pth.
2024-06-13 10:52:42:INFO:TRAIN-(cmcm) (1/17/3)>> loss: 0.7716
2024-06-13 10:52:45:INFO:VAL-(cmcm) >>
2024-06-13 10:52:45:INFO:M: >>  Has0_acc_2: 0.7249  Has0_F1_score: 0.7269  Non0_acc_2: 0.7500  Non0_F1_score: 0.7503  Mult_acc_5: 0.4017  Mult_acc_7: 0.3144  MAE: 1.1232  Corr: 0.5545 
2024-06-13 10:52:46:INFO:Saving checkpoint at epoch 17 to results/models/cmcm-mosi-regression.pth.
2024-06-13 10:53:08:INFO:TRAIN-(cmcm) (1/18/3)>> loss: 0.7621
2024-06-13 10:53:11:INFO:VAL-(cmcm) >>
2024-06-13 10:53:11:INFO:M: >>  Has0_acc_2: 0.7336  Has0_F1_score: 0.7317  Non0_acc_2: 0.7454  Non0_F1_score: 0.7438  Mult_acc_5: 0.4017  Mult_acc_7: 0.3231  MAE: 1.0961  Corr: 0.5411 
2024-06-13 10:53:12:INFO:Saving checkpoint at epoch 18 to results/models/cmcm-mosi-regression.pth.
2024-06-13 10:53:34:INFO:TRAIN-(cmcm) (1/19/3)>> loss: 0.7502
2024-06-13 10:53:38:INFO:VAL-(cmcm) >>
2024-06-13 10:53:38:INFO:M: >>  Has0_acc_2: 0.7205  Has0_F1_score: 0.7181  Non0_acc_2: 0.6898  Non0_F1_score: 0.6915  Mult_acc_5: 0.3493  Mult_acc_7: 0.2882  MAE: 1.1148  Corr: 0.5418 
2024-06-13 10:53:59:INFO:TRAIN-(cmcm) (2/20/3)>> loss: 0.7397
2024-06-13 10:54:03:INFO:VAL-(cmcm) >>
2024-06-13 10:54:03:INFO:M: >>  Has0_acc_2: 0.6900  Has0_F1_score: 0.6925  Non0_acc_2: 0.7222  Non0_F1_score: 0.7235  Mult_acc_5: 0.3450  Mult_acc_7: 0.2751  MAE: 1.2197  Corr: 0.5176 
2024-06-13 10:54:24:INFO:TRAIN-(cmcm) (3/21/3)>> loss: 0.7286
2024-06-13 10:54:28:INFO:VAL-(cmcm) >>
2024-06-13 10:54:28:INFO:M: >>  Has0_acc_2: 0.7162  Has0_F1_score: 0.7164  Non0_acc_2: 0.7269  Non0_F1_score: 0.7267  Mult_acc_5: 0.3319  Mult_acc_7: 0.2795  MAE: 1.1261  Corr: 0.5411 
2024-06-13 10:54:48:INFO:TRAIN-(cmcm) (4/22/3)>> loss: 0.7171
2024-06-13 10:54:52:INFO:VAL-(cmcm) >>
2024-06-13 10:54:52:INFO:M: >>  Has0_acc_2: 0.6987  Has0_F1_score: 0.6990  Non0_acc_2: 0.7130  Non0_F1_score: 0.7137  Mult_acc_5: 0.3843  Mult_acc_7: 0.3188  MAE: 1.1178  Corr: 0.5310 
2024-06-13 10:55:13:INFO:TRAIN-(cmcm) (5/23/3)>> loss: 0.7143
2024-06-13 10:55:16:INFO:VAL-(cmcm) >>
2024-06-13 10:55:16:INFO:M: >>  Has0_acc_2: 0.7031  Has0_F1_score: 0.7036  Non0_acc_2: 0.6898  Non0_F1_score: 0.6915  Mult_acc_5: 0.3624  Mult_acc_7: 0.2926  MAE: 1.1231  Corr: 0.5275 
2024-06-13 10:55:37:INFO:TRAIN-(cmcm) (6/24/3)>> loss: 0.7004
2024-06-13 10:55:41:INFO:VAL-(cmcm) >>
2024-06-13 10:55:41:INFO:M: >>  Has0_acc_2: 0.7118  Has0_F1_score: 0.7107  Non0_acc_2: 0.7037  Non0_F1_score: 0.7044  Mult_acc_5: 0.3712  Mult_acc_7: 0.3057  MAE: 1.0820  Corr: 0.5569 
2024-06-13 10:55:42:INFO:Saving checkpoint at epoch 24 to results/models/cmcm-mosi-regression.pth.
2024-06-13 10:56:03:INFO:TRAIN-(cmcm) (1/25/3)>> loss: 0.6940
2024-06-13 10:56:07:INFO:VAL-(cmcm) >>
2024-06-13 10:56:07:INFO:M: >>  Has0_acc_2: 0.7031  Has0_F1_score: 0.7059  Non0_acc_2: 0.7130  Non0_F1_score: 0.7144  Mult_acc_5: 0.3624  Mult_acc_7: 0.3013  MAE: 1.1154  Corr: 0.5574 
2024-06-13 10:56:28:INFO:TRAIN-(cmcm) (2/26/3)>> loss: 0.6855
2024-06-13 10:56:31:INFO:VAL-(cmcm) >>
2024-06-13 10:56:31:INFO:M: >>  Has0_acc_2: 0.7118  Has0_F1_score: 0.7118  Non0_acc_2: 0.7176  Non0_F1_score: 0.7181  Mult_acc_5: 0.3712  Mult_acc_7: 0.3057  MAE: 1.0791  Corr: 0.5494 
2024-06-13 10:56:32:INFO:Saving checkpoint at epoch 26 to results/models/cmcm-mosi-regression.pth.
2024-06-13 10:56:53:INFO:TRAIN-(cmcm) (1/27/3)>> loss: 0.6772
2024-06-13 10:56:57:INFO:VAL-(cmcm) >>
2024-06-13 10:56:57:INFO:M: >>  Has0_acc_2: 0.6856  Has0_F1_score: 0.6877  Non0_acc_2: 0.7037  Non0_F1_score: 0.7051  Mult_acc_5: 0.3755  Mult_acc_7: 0.3057  MAE: 1.1123  Corr: 0.5587 
2024-06-13 10:57:18:INFO:TRAIN-(cmcm) (2/28/3)>> loss: 0.6707
2024-06-13 10:57:22:INFO:VAL-(cmcm) >>
2024-06-13 10:57:22:INFO:M: >>  Has0_acc_2: 0.7074  Has0_F1_score: 0.7072  Non0_acc_2: 0.7176  Non0_F1_score: 0.7181  Mult_acc_5: 0.3843  Mult_acc_7: 0.3188  MAE: 1.0931  Corr: 0.5403 
2024-06-13 10:57:42:INFO:TRAIN-(cmcm) (3/29/3)>> loss: 0.6691
2024-06-13 10:57:44:INFO:VAL-(cmcm) >>
2024-06-13 10:57:44:INFO:M: >>  Has0_acc_2: 0.7118  Has0_F1_score: 0.7118  Non0_acc_2: 0.7222  Non0_F1_score: 0.7229  Mult_acc_5: 0.3799  Mult_acc_7: 0.3144  MAE: 1.0905  Corr: 0.5491 
2024-06-13 10:58:03:INFO:TRAIN-(cmcm) (4/30/3)>> loss: 0.6659
2024-06-13 10:58:07:INFO:VAL-(cmcm) >>
2024-06-13 10:58:07:INFO:M: >>  Has0_acc_2: 0.7074  Has0_F1_score: 0.7077  Non0_acc_2: 0.7176  Non0_F1_score: 0.7184  Mult_acc_5: 0.3799  Mult_acc_7: 0.3144  MAE: 1.0975  Corr: 0.5469 
2024-06-13 10:58:28:INFO:TRAIN-(cmcm) (5/31/3)>> loss: 0.6671
2024-06-13 10:58:32:INFO:VAL-(cmcm) >>
2024-06-13 10:58:32:INFO:M: >>  Has0_acc_2: 0.7118  Has0_F1_score: 0.7118  Non0_acc_2: 0.7222  Non0_F1_score: 0.7229  Mult_acc_5: 0.3843  Mult_acc_7: 0.3188  MAE: 1.0870  Corr: 0.5551 
2024-06-13 10:58:53:INFO:TRAIN-(cmcm) (6/32/3)>> loss: 0.6691
2024-06-13 10:58:56:INFO:VAL-(cmcm) >>
2024-06-13 10:58:56:INFO:M: >>  Has0_acc_2: 0.7118  Has0_F1_score: 0.7123  Non0_acc_2: 0.7130  Non0_F1_score: 0.7139  Mult_acc_5: 0.3843  Mult_acc_7: 0.3144  MAE: 1.0817  Corr: 0.5582 
2024-06-13 10:59:17:INFO:TRAIN-(cmcm) (7/33/3)>> loss: 0.6691
2024-06-13 10:59:21:INFO:VAL-(cmcm) >>
2024-06-13 10:59:21:INFO:M: >>  Has0_acc_2: 0.7162  Has0_F1_score: 0.7159  Non0_acc_2: 0.7269  Non0_F1_score: 0.7274  Mult_acc_5: 0.3886  Mult_acc_7: 0.3231  MAE: 1.0678  Corr: 0.5633 
2024-06-13 10:59:22:INFO:Saving checkpoint at epoch 33 to results/models/cmcm-mosi-regression.pth.
2024-06-13 10:59:45:INFO:TRAIN-(cmcm) (1/34/3)>> loss: 0.6719
2024-06-13 10:59:48:INFO:VAL-(cmcm) >>
2024-06-13 10:59:48:INFO:M: >>  Has0_acc_2: 0.7074  Has0_F1_score: 0.7066  Non0_acc_2: 0.7222  Non0_F1_score: 0.7222  Mult_acc_5: 0.3974  Mult_acc_7: 0.3275  MAE: 1.1223  Corr: 0.5201 
2024-06-13 11:00:09:INFO:TRAIN-(cmcm) (2/35/3)>> loss: 0.6729
2024-06-13 11:00:13:INFO:VAL-(cmcm) >>
2024-06-13 11:00:13:INFO:M: >>  Has0_acc_2: 0.7205  Has0_F1_score: 0.7227  Non0_acc_2: 0.7176  Non0_F1_score: 0.7190  Mult_acc_5: 0.3668  Mult_acc_7: 0.3057  MAE: 1.0787  Corr: 0.5805 
2024-06-13 11:00:34:INFO:TRAIN-(cmcm) (3/36/3)>> loss: 0.6806
2024-06-13 11:00:38:INFO:VAL-(cmcm) >>
2024-06-13 11:00:38:INFO:M: >>  Has0_acc_2: 0.6987  Has0_F1_score: 0.7014  Non0_acc_2: 0.7176  Non0_F1_score: 0.7190  Mult_acc_5: 0.3406  Mult_acc_7: 0.2664  MAE: 1.1765  Corr: 0.5411 
2024-06-13 11:00:58:INFO:TRAIN-(cmcm) (4/37/3)>> loss: 0.6848
2024-06-13 11:01:02:INFO:VAL-(cmcm) >>
2024-06-13 11:01:02:INFO:M: >>  Has0_acc_2: 0.7162  Has0_F1_score: 0.7080  Non0_acc_2: 0.6991  Non0_F1_score: 0.6951  Mult_acc_5: 0.4061  Mult_acc_7: 0.3100  MAE: 1.1678  Corr: 0.4902 
2024-06-13 11:01:23:INFO:TRAIN-(cmcm) (5/38/3)>> loss: 0.6932
2024-06-13 11:01:27:INFO:VAL-(cmcm) >>
2024-06-13 11:01:27:INFO:M: >>  Has0_acc_2: 0.7467  Has0_F1_score: 0.7408  Non0_acc_2: 0.7593  Non0_F1_score: 0.7527  Mult_acc_5: 0.4148  Mult_acc_7: 0.3406  MAE: 1.1066  Corr: 0.5642 
2024-06-13 11:01:48:INFO:TRAIN-(cmcm) (6/39/3)>> loss: 0.6965
2024-06-13 11:01:51:INFO:VAL-(cmcm) >>
2024-06-13 11:01:51:INFO:M: >>  Has0_acc_2: 0.6812  Has0_F1_score: 0.6842  Non0_acc_2: 0.6435  Non0_F1_score: 0.6381  Mult_acc_5: 0.2882  Mult_acc_7: 0.2358  MAE: 1.2156  Corr: 0.5301 
2024-06-13 11:02:12:INFO:TRAIN-(cmcm) (7/40/3)>> loss: 0.7072
2024-06-13 11:02:16:INFO:VAL-(cmcm) >>
2024-06-13 11:02:16:INFO:M: >>  Has0_acc_2: 0.7467  Has0_F1_score: 0.7389  Non0_acc_2: 0.7315  Non0_F1_score: 0.7251  Mult_acc_5: 0.4017  Mult_acc_7: 0.3231  MAE: 1.1625  Corr: 0.4970 
2024-06-13 11:02:37:INFO:TRAIN-(cmcm) (8/41/3)>> loss: 0.7106
2024-06-13 11:02:40:INFO:VAL-(cmcm) >>
2024-06-13 11:02:40:INFO:M: >>  Has0_acc_2: 0.7336  Has0_F1_score: 0.7269  Non0_acc_2: 0.7222  Non0_F1_score: 0.7189  Mult_acc_5: 0.3930  Mult_acc_7: 0.3231  MAE: 1.1122  Corr: 0.5266 
2024-06-13 11:03:01:INFO:TRAIN-(cmcm) (9/42/3)>> loss: 0.7014
2024-06-13 11:03:05:INFO:VAL-(cmcm) >>
2024-06-13 11:03:05:INFO:M: >>  Has0_acc_2: 0.7205  Has0_F1_score: 0.7188  Non0_acc_2: 0.7269  Non0_F1_score: 0.7270  Mult_acc_5: 0.3624  Mult_acc_7: 0.2969  MAE: 1.1145  Corr: 0.5361 
2024-06-13 11:03:26:INFO:TRAIN-(cmcm) (10/43/3)>> loss: 0.7213
2024-06-13 11:03:30:INFO:VAL-(cmcm) >>
2024-06-13 11:03:30:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5744  Non0_acc_2: 0.6019  Non0_F1_score: 0.5784  Mult_acc_5: 0.2838  Mult_acc_7: 0.2358  MAE: 1.4069  Corr: 0.4407 
2024-06-13 11:03:40:INFO:TEST-(cmcm) >>
2024-06-13 11:03:40:INFO:M: >>  Has0_acc_2: 0.6997  Has0_F1_score: 0.7004  Non0_acc_2: 0.7287  Non0_F1_score: 0.7272  Mult_acc_5: 0.3309  Mult_acc_7: 0.2813  MAE: 1.1306  Corr: 0.4916 
2024-06-13 11:03:40:INFO:Results are added to results/results/mosi-regression-30.csv...
2024-06-13 11:03:40:INFO:Start running cmcm...
2024-06-13 11:03:40:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 6, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 4444}>
2024-06-13 11:03:40:INFO:Let's use the GPU 1 !
2024-06-13 11:03:40:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 11:03:41:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718247821 HTTP/1.1" 200 235
2024-06-13 11:03:41:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 11:03:42:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 11:03:42:INFO:train samples: (1284,)
2024-06-13 11:03:42:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 11:03:43:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718247823 HTTP/1.1" 200 235
2024-06-13 11:03:43:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 11:03:44:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 11:03:44:INFO:valid samples: (229,)
2024-06-13 11:03:44:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 11:03:45:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718247825 HTTP/1.1" 200 235
2024-06-13 11:03:45:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 11:03:46:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 11:03:46:INFO:test samples: (686,)
2024-06-13 11:03:46:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 11:03:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718247827 HTTP/1.1" 200 235
2024-06-13 11:03:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 11:03:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 11:03:48:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 11:03:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718247828 HTTP/1.1" 200 235
2024-06-13 11:03:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 11:03:49:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 11:03:49:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-13 11:03:49:WARNING:Try importing flash-attention for faster inference...
2024-06-13 11:03:49:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-13 11:03:49:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-13 11:03:49:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-13 11:03:50:INFO:trainable params: 1310288 || all params: 1838138960 || trainable%: 0.07128340286090232
2024-06-13 11:03:50:INFO:Init labels...
2024-06-13 11:03:50:INFO:Start training...
2024-06-13 11:04:11:INFO:TRAIN-(cmcm) (1/1/4)>> loss: 3.8549
2024-06-13 11:04:15:INFO:VAL-(cmcm) >>
2024-06-13 11:04:15:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5648  Non0_F1_score: 0.5292  Mult_acc_5: 0.2620  Mult_acc_7: 0.1965  MAE: 1.7603  Corr: 0.0148 
2024-06-13 11:04:15:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-13 11:04:36:INFO:TRAIN-(cmcm) (1/2/4)>> loss: 1.3269
2024-06-13 11:04:40:INFO:VAL-(cmcm) >>
2024-06-13 11:04:40:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5832  Non0_acc_2: 0.5787  Non0_F1_score: 0.5799  Mult_acc_5: 0.1878  Mult_acc_7: 0.1790  MAE: 1.5646  Corr: 0.0653 
2024-06-13 11:04:40:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-13 11:04:58:INFO:TRAIN-(cmcm) (1/3/4)>> loss: 0.9517
2024-06-13 11:05:02:INFO:VAL-(cmcm) >>
2024-06-13 11:05:02:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.4998  Non0_acc_2: 0.5463  Non0_F1_score: 0.4764  Mult_acc_5: 0.2271  Mult_acc_7: 0.1572  MAE: 1.7136  Corr: -0.0347 
2024-06-13 11:05:23:INFO:TRAIN-(cmcm) (2/4/4)>> loss: 0.9102
2024-06-13 11:05:26:INFO:VAL-(cmcm) >>
2024-06-13 11:05:26:INFO:M: >>  Has0_acc_2: 0.5546  Has0_F1_score: 0.5287  Non0_acc_2: 0.5463  Non0_F1_score: 0.5199  Mult_acc_5: 0.2445  Mult_acc_7: 0.1834  MAE: 1.7494  Corr: 0.0027 
2024-06-13 11:05:47:INFO:TRAIN-(cmcm) (3/5/4)>> loss: 0.9010
2024-06-13 11:05:50:INFO:VAL-(cmcm) >>
2024-06-13 11:05:50:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4767  Non0_acc_2: 0.5741  Non0_F1_score: 0.4491  Mult_acc_5: 0.2227  Mult_acc_7: 0.2009  MAE: 1.5878  Corr: -0.0045 
2024-06-13 11:06:12:INFO:TRAIN-(cmcm) (4/6/4)>> loss: 0.9035
2024-06-13 11:06:15:INFO:VAL-(cmcm) >>
2024-06-13 11:06:15:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.4880  Non0_acc_2: 0.5833  Non0_F1_score: 0.4610  Mult_acc_5: 0.2576  Mult_acc_7: 0.1834  MAE: 1.5992  Corr: 0.0414 
2024-06-13 11:06:36:INFO:TRAIN-(cmcm) (5/7/4)>> loss: 0.8874
2024-06-13 11:06:40:INFO:VAL-(cmcm) >>
2024-06-13 11:06:40:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4676  Non0_acc_2: 0.5787  Non0_F1_score: 0.4445  Mult_acc_5: 0.1747  Mult_acc_7: 0.1703  MAE: 1.5427  Corr: 0.0467 
2024-06-13 11:06:40:INFO:Saving checkpoint at epoch 7 to results/models/cmcm-mosi-regression.pth.
2024-06-13 11:07:01:INFO:TRAIN-(cmcm) (1/8/4)>> loss: 0.8802
2024-06-13 11:07:05:INFO:VAL-(cmcm) >>
2024-06-13 11:07:05:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.4892  Non0_acc_2: 0.5556  Non0_F1_score: 0.4731  Mult_acc_5: 0.1616  Mult_acc_7: 0.1616  MAE: 1.6359  Corr: -0.0234 
2024-06-13 11:07:26:INFO:TRAIN-(cmcm) (2/9/4)>> loss: 0.8769
2024-06-13 11:07:29:INFO:VAL-(cmcm) >>
2024-06-13 11:07:29:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.5137  Non0_acc_2: 0.5833  Non0_F1_score: 0.4911  Mult_acc_5: 0.2576  Mult_acc_7: 0.2009  MAE: 1.6437  Corr: 0.0074 
2024-06-13 11:07:50:INFO:TRAIN-(cmcm) (3/10/4)>> loss: 0.8684
2024-06-13 11:07:54:INFO:VAL-(cmcm) >>
2024-06-13 11:07:54:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5031  Non0_acc_2: 0.5694  Non0_F1_score: 0.4768  Mult_acc_5: 0.2533  Mult_acc_7: 0.1703  MAE: 1.6857  Corr: 0.0222 
2024-06-13 11:08:15:INFO:TRAIN-(cmcm) (4/11/4)>> loss: 0.8549
2024-06-13 11:08:18:INFO:VAL-(cmcm) >>
2024-06-13 11:08:18:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5309  Non0_acc_2: 0.5694  Non0_F1_score: 0.5092  Mult_acc_5: 0.3013  Mult_acc_7: 0.2227  MAE: 1.6975  Corr: 0.0082 
2024-06-13 11:08:39:INFO:TRAIN-(cmcm) (5/12/4)>> loss: 0.8544
2024-06-13 11:08:43:INFO:VAL-(cmcm) >>
2024-06-13 11:08:43:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.5057  Non0_acc_2: 0.5556  Non0_F1_score: 0.4826  Mult_acc_5: 0.2620  Mult_acc_7: 0.2096  MAE: 1.7245  Corr: -0.0424 
2024-06-13 11:09:04:INFO:TRAIN-(cmcm) (6/13/4)>> loss: 0.8462
2024-06-13 11:09:07:INFO:VAL-(cmcm) >>
2024-06-13 11:09:07:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.4880  Non0_acc_2: 0.5787  Non0_F1_score: 0.4584  Mult_acc_5: 0.2751  Mult_acc_7: 0.2445  MAE: 1.5825  Corr: 0.0344 
2024-06-13 11:09:28:INFO:TRAIN-(cmcm) (7/14/4)>> loss: 0.8437
2024-06-13 11:09:32:INFO:VAL-(cmcm) >>
2024-06-13 11:09:32:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5247  Non0_acc_2: 0.5602  Non0_F1_score: 0.5026  Mult_acc_5: 0.2489  Mult_acc_7: 0.2183  MAE: 1.6870  Corr: 0.0029 
2024-06-13 11:09:53:INFO:TRAIN-(cmcm) (8/15/4)>> loss: 0.8392
2024-06-13 11:09:56:INFO:VAL-(cmcm) >>
2024-06-13 11:09:56:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5031  Non0_acc_2: 0.5741  Non0_F1_score: 0.4797  Mult_acc_5: 0.3100  Mult_acc_7: 0.2402  MAE: 1.6545  Corr: 0.0263 
2024-06-13 11:10:17:INFO:TRAIN-(cmcm) (9/16/4)>> loss: 0.8353
2024-06-13 11:10:21:INFO:VAL-(cmcm) >>
2024-06-13 11:10:21:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.5477  Non0_acc_2: 0.5833  Non0_F1_score: 0.5269  Mult_acc_5: 0.2620  Mult_acc_7: 0.1921  MAE: 1.6188  Corr: 0.0479 
2024-06-13 11:10:42:INFO:TRAIN-(cmcm) (10/17/4)>> loss: 0.8335
2024-06-13 11:10:45:INFO:VAL-(cmcm) >>
2024-06-13 11:10:45:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5340  Non0_acc_2: 0.5741  Non0_F1_score: 0.5125  Mult_acc_5: 0.2882  Mult_acc_7: 0.2096  MAE: 1.6756  Corr: 0.0443 
2024-06-13 11:10:56:INFO:TEST-(cmcm) >>
2024-06-13 11:10:56:INFO:M: >>  Has0_acc_2: 0.4621  Has0_F1_score: 0.3321  Non0_acc_2: 0.4421  Non0_F1_score: 0.3171  Mult_acc_5: 0.1706  Mult_acc_7: 0.1691  MAE: 1.8419  Corr: 0.0369 
2024-06-13 11:10:56:INFO:Results are added to results/results/mosi-regression-30.csv...
2024-06-13 11:10:56:INFO:Start running cmcm...
2024-06-13 11:10:56:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 6, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 5555}>
2024-06-13 11:10:56:INFO:Let's use the GPU 1 !
2024-06-13 11:10:56:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 11:10:57:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718248257 HTTP/1.1" 200 235
2024-06-13 11:10:57:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 11:10:58:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 11:10:58:INFO:train samples: (1284,)
2024-06-13 11:10:59:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 11:10:59:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718248259 HTTP/1.1" 200 235
2024-06-13 11:10:59:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 11:11:00:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 11:11:01:INFO:valid samples: (229,)
2024-06-13 11:11:01:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 11:11:01:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718248261 HTTP/1.1" 200 235
2024-06-13 11:11:01:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 11:11:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 11:11:03:INFO:test samples: (686,)
2024-06-13 11:11:03:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 11:11:03:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718248263 HTTP/1.1" 200 235
2024-06-13 11:11:04:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 11:11:04:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 11:11:05:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 11:11:05:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718248265 HTTP/1.1" 200 235
2024-06-13 11:11:05:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 11:11:06:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 11:11:06:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-13 11:11:06:WARNING:Try importing flash-attention for faster inference...
2024-06-13 11:11:06:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-13 11:11:06:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-13 11:11:06:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-13 11:11:07:INFO:trainable params: 1310288 || all params: 1838138960 || trainable%: 0.07128340286090232
2024-06-13 11:11:07:INFO:Init labels...
2024-06-13 11:11:07:INFO:Start training...
2024-06-13 11:11:28:INFO:TRAIN-(cmcm) (1/1/5)>> loss: 2.6139
2024-06-13 11:11:32:INFO:VAL-(cmcm) >>
2024-06-13 11:11:32:INFO:M: >>  Has0_acc_2: 0.5459  Has0_F1_score: 0.5089  Non0_acc_2: 0.5417  Non0_F1_score: 0.5056  Mult_acc_5: 0.1659  Mult_acc_7: 0.1616  MAE: 1.6637  Corr: -0.0135 
2024-06-13 11:11:33:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-13 11:11:51:INFO:TRAIN-(cmcm) (1/2/5)>> loss: 0.9611
2024-06-13 11:11:55:INFO:VAL-(cmcm) >>
2024-06-13 11:11:55:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.5602  Non0_acc_2: 0.5741  Non0_F1_score: 0.5364  Mult_acc_5: 0.1834  Mult_acc_7: 0.1834  MAE: 1.4929  Corr: 0.0389 
2024-06-13 11:11:56:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-13 11:12:17:INFO:TRAIN-(cmcm) (1/3/5)>> loss: 0.9019
2024-06-13 11:12:21:INFO:VAL-(cmcm) >>
2024-06-13 11:12:21:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4556  Non0_acc_2: 0.5833  Non0_F1_score: 0.4676  Mult_acc_5: 0.1834  Mult_acc_7: 0.1834  MAE: 1.4087  Corr: 0.0792 
2024-06-13 11:12:21:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-mosi-regression.pth.
2024-06-13 11:12:43:INFO:TRAIN-(cmcm) (1/4/5)>> loss: 0.8909
2024-06-13 11:12:46:INFO:VAL-(cmcm) >>
2024-06-13 11:12:46:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4791  Non0_acc_2: 0.5787  Non0_F1_score: 0.4516  Mult_acc_5: 0.1747  Mult_acc_7: 0.1747  MAE: 1.5034  Corr: 0.0161 
2024-06-13 11:13:07:INFO:TRAIN-(cmcm) (2/5/5)>> loss: 0.8855
2024-06-13 11:13:11:INFO:VAL-(cmcm) >>
2024-06-13 11:13:11:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5414  Non0_acc_2: 0.5741  Non0_F1_score: 0.5237  Mult_acc_5: 0.2445  Mult_acc_7: 0.2271  MAE: 1.5030  Corr: 0.0965 
2024-06-13 11:13:32:INFO:TRAIN-(cmcm) (3/6/5)>> loss: 0.8704
2024-06-13 11:13:36:INFO:VAL-(cmcm) >>
2024-06-13 11:13:36:INFO:M: >>  Has0_acc_2: 0.5633  Has0_F1_score: 0.5155  Non0_acc_2: 0.5509  Non0_F1_score: 0.4996  Mult_acc_5: 0.2882  Mult_acc_7: 0.2096  MAE: 1.8057  Corr: -0.0134 
2024-06-13 11:13:57:INFO:TRAIN-(cmcm) (4/7/5)>> loss: 0.8648
2024-06-13 11:14:00:INFO:VAL-(cmcm) >>
2024-06-13 11:14:00:INFO:M: >>  Has0_acc_2: 0.6157  Has0_F1_score: 0.5368  Non0_acc_2: 0.5370  Non0_F1_score: 0.5101  Mult_acc_5: 0.2183  Mult_acc_7: 0.2140  MAE: 1.4589  Corr: 0.0914 
2024-06-13 11:14:21:INFO:TRAIN-(cmcm) (5/8/5)>> loss: 0.8652
2024-06-13 11:14:25:INFO:VAL-(cmcm) >>
2024-06-13 11:14:25:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.4840  Non0_acc_2: 0.5648  Non0_F1_score: 0.4568  Mult_acc_5: 0.2926  Mult_acc_7: 0.2096  MAE: 1.7616  Corr: 0.0051 
2024-06-13 11:14:46:INFO:TRAIN-(cmcm) (6/9/5)>> loss: 0.8667
2024-06-13 11:14:50:INFO:VAL-(cmcm) >>
2024-06-13 11:14:50:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.4606  Non0_acc_2: 0.5556  Non0_F1_score: 0.4321  Mult_acc_5: 0.2445  Mult_acc_7: 0.2227  MAE: 1.6708  Corr: -0.0031 
2024-06-13 11:15:11:INFO:TRAIN-(cmcm) (7/10/5)>> loss: 0.8613
2024-06-13 11:15:14:INFO:VAL-(cmcm) >>
2024-06-13 11:15:14:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.5997  Non0_acc_2: 0.5926  Non0_F1_score: 0.5888  Mult_acc_5: 0.2882  Mult_acc_7: 0.2183  MAE: 1.6197  Corr: 0.1097 
2024-06-13 11:15:35:INFO:TRAIN-(cmcm) (8/11/5)>> loss: 0.8512
2024-06-13 11:15:39:INFO:VAL-(cmcm) >>
2024-06-13 11:15:39:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.5890  Non0_acc_2: 0.5972  Non0_F1_score: 0.5994  Mult_acc_5: 0.2751  Mult_acc_7: 0.2314  MAE: 1.4835  Corr: 0.1220 
2024-06-13 11:16:00:INFO:TRAIN-(cmcm) (9/12/5)>> loss: 0.8403
2024-06-13 11:16:03:INFO:VAL-(cmcm) >>
2024-06-13 11:16:03:INFO:M: >>  Has0_acc_2: 0.6550  Has0_F1_score: 0.6497  Non0_acc_2: 0.6389  Non0_F1_score: 0.6363  Mult_acc_5: 0.3013  Mult_acc_7: 0.2358  MAE: 1.5005  Corr: 0.1843 
2024-06-13 11:16:25:INFO:TRAIN-(cmcm) (10/13/5)>> loss: 0.8390
2024-06-13 11:16:28:INFO:VAL-(cmcm) >>
2024-06-13 11:16:28:INFO:M: >>  Has0_acc_2: 0.6157  Has0_F1_score: 0.6194  Non0_acc_2: 0.6296  Non0_F1_score: 0.6316  Mult_acc_5: 0.2751  Mult_acc_7: 0.2227  MAE: 1.5381  Corr: 0.2024 
2024-06-13 11:16:39:INFO:TEST-(cmcm) >>
2024-06-13 11:16:39:INFO:M: >>  Has0_acc_2: 0.4475  Has0_F1_score: 0.2843  Non0_acc_2: 0.4634  Non0_F1_score: 0.3530  Mult_acc_5: 0.1662  Mult_acc_7: 0.1647  MAE: 1.5570  Corr: 0.0597 
2024-06-13 11:16:39:INFO:Results are added to results/results/mosi-regression-30.csv...
2024-06-13 11:16:39:INFO:Start running cmcm...
2024-06-13 11:16:39:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 6, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 40, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-06-13 11:16:39:INFO:Let's use the GPU 1 !
2024-06-13 11:16:39:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 11:16:40:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718248600 HTTP/1.1" 200 235
2024-06-13 11:16:40:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 11:16:40:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 11:16:41:INFO:train samples: (1284,)
2024-06-13 11:16:41:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 11:16:42:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718248602 HTTP/1.1" 200 235
2024-06-13 11:16:42:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 11:16:42:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 11:16:43:INFO:valid samples: (229,)
2024-06-13 11:16:43:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 11:16:44:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718248604 HTTP/1.1" 200 235
2024-06-13 11:16:44:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 11:16:44:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 11:16:45:INFO:test samples: (686,)
2024-06-13 11:16:45:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 11:16:45:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718248606 HTTP/1.1" 200 235
2024-06-13 11:16:46:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 11:16:46:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 11:16:47:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 11:16:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718248607 HTTP/1.1" 200 235
2024-06-13 11:16:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 11:16:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 11:16:48:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-13 11:16:48:WARNING:Try importing flash-attention for faster inference...
2024-06-13 11:16:48:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-13 11:16:48:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-13 11:16:48:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-13 11:16:49:INFO:trainable params: 1310288 || all params: 1838138960 || trainable%: 0.07128340286090232
2024-06-13 11:16:49:INFO:Init labels...
2024-06-13 11:16:49:INFO:Start training...
2024-06-13 11:17:10:INFO:TRAIN-(cmcm) (1/1/1)>> loss: 3.1661
2024-06-13 11:17:14:INFO:VAL-(cmcm) >>
2024-06-13 11:17:14:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4306  Non0_F1_score: 0.2869  Mult_acc_5: 0.2096  Mult_acc_7: 0.2096  MAE: 1.4379  Corr: 0.0128 
2024-06-13 11:17:14:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-13 11:17:36:INFO:TRAIN-(cmcm) (1/2/1)>> loss: 0.9700
2024-06-13 11:17:40:INFO:VAL-(cmcm) >>
2024-06-13 11:17:40:INFO:M: >>  Has0_acc_2: 0.5459  Has0_F1_score: 0.5336  Non0_acc_2: 0.5324  Non0_F1_score: 0.5189  Mult_acc_5: 0.2489  Mult_acc_7: 0.1703  MAE: 1.7350  Corr: -0.0060 
2024-06-13 11:18:01:INFO:TRAIN-(cmcm) (2/3/1)>> loss: 0.9029
2024-06-13 11:18:04:INFO:VAL-(cmcm) >>
2024-06-13 11:18:04:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5741  Non0_F1_score: 0.4187  Mult_acc_5: 0.2140  Mult_acc_7: 0.2052  MAE: 1.5851  Corr: -0.0192 
2024-06-13 11:18:25:INFO:TRAIN-(cmcm) (3/4/1)>> loss: 0.8851
2024-06-13 11:18:29:INFO:VAL-(cmcm) >>
2024-06-13 11:18:29:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.5079  Non0_acc_2: 0.4583  Non0_F1_score: 0.4593  Mult_acc_5: 0.1834  Mult_acc_7: 0.1834  MAE: 1.5969  Corr: -0.0768 
2024-06-13 11:18:50:INFO:TRAIN-(cmcm) (4/5/1)>> loss: 0.8756
2024-06-13 11:18:53:INFO:VAL-(cmcm) >>
2024-06-13 11:18:53:INFO:M: >>  Has0_acc_2: 0.5633  Has0_F1_score: 0.5278  Non0_acc_2: 0.5509  Non0_F1_score: 0.5127  Mult_acc_5: 0.1703  Mult_acc_7: 0.1703  MAE: 1.5956  Corr: -0.0094 
2024-06-13 11:19:14:INFO:TRAIN-(cmcm) (5/6/1)>> loss: 0.8724
2024-06-13 11:19:18:INFO:VAL-(cmcm) >>
2024-06-13 11:19:18:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.4924  Non0_acc_2: 0.5648  Non0_F1_score: 0.4684  Mult_acc_5: 0.3057  Mult_acc_7: 0.2271  MAE: 1.7092  Corr: -0.0088 
2024-06-13 11:19:39:INFO:TRAIN-(cmcm) (6/7/1)>> loss: 0.8626
2024-06-13 11:19:43:INFO:VAL-(cmcm) >>
2024-06-13 11:19:43:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5741  Non0_F1_score: 0.4187  Mult_acc_5: 0.2795  Mult_acc_7: 0.2009  MAE: 1.7154  Corr: 0.0441 
2024-06-13 11:20:04:INFO:TRAIN-(cmcm) (7/8/1)>> loss: 0.8623
2024-06-13 11:20:07:INFO:VAL-(cmcm) >>
2024-06-13 11:20:07:INFO:M: >>  Has0_acc_2: 0.5502  Has0_F1_score: 0.5506  Non0_acc_2: 0.5417  Non0_F1_score: 0.5406  Mult_acc_5: 0.2314  Mult_acc_7: 0.1878  MAE: 1.6545  Corr: 0.0377 
2024-06-13 11:20:29:INFO:TRAIN-(cmcm) (8/9/1)>> loss: 0.8563
2024-06-13 11:20:32:INFO:VAL-(cmcm) >>
2024-06-13 11:20:32:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.4438  Non0_acc_2: 0.5694  Non0_F1_score: 0.4166  Mult_acc_5: 0.2620  Mult_acc_7: 0.1878  MAE: 1.6315  Corr: 0.0081 
2024-06-13 11:20:49:INFO:TRAIN-(cmcm) (9/10/1)>> loss: 0.8566
2024-06-13 11:20:53:INFO:VAL-(cmcm) >>
2024-06-13 11:20:53:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4534  Non0_acc_2: 0.5694  Non0_F1_score: 0.4246  Mult_acc_5: 0.2314  Mult_acc_7: 0.2009  MAE: 1.6289  Corr: 0.0591 
2024-06-13 11:21:14:INFO:TRAIN-(cmcm) (10/11/1)>> loss: 0.8590
2024-06-13 11:21:18:INFO:VAL-(cmcm) >>
2024-06-13 11:21:18:INFO:M: >>  Has0_acc_2: 0.5633  Has0_F1_score: 0.5560  Non0_acc_2: 0.5602  Non0_F1_score: 0.5505  Mult_acc_5: 0.2576  Mult_acc_7: 0.1747  MAE: 1.7909  Corr: 0.0588 
2024-06-13 11:21:28:INFO:TEST-(cmcm) >>
2024-06-13 11:21:28:INFO:M: >>  Has0_acc_2: 0.4490  Has0_F1_score: 0.2799  Non0_acc_2: 0.5686  Non0_F1_score: 0.4413  Mult_acc_5: 0.1531  Mult_acc_7: 0.1531  MAE: 1.4328  Corr: -0.0015 
2024-06-13 11:21:29:INFO:Results are added to results/results/mosi-regression-40.csv...
2024-06-13 11:21:29:INFO:Start running cmcm...
2024-06-13 11:21:29:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 6, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 40, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 2222}>
2024-06-13 11:21:29:INFO:Let's use the GPU 1 !
2024-06-13 11:21:29:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 11:21:29:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718248889 HTTP/1.1" 200 235
2024-06-13 11:21:29:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 11:21:30:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 11:21:31:INFO:train samples: (1284,)
2024-06-13 11:21:31:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 11:21:31:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718248891 HTTP/1.1" 200 235
2024-06-13 11:21:31:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 11:21:32:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 11:21:33:INFO:valid samples: (229,)
2024-06-13 11:21:33:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 11:21:33:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718248893 HTTP/1.1" 200 235
2024-06-13 11:21:33:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 11:21:34:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 11:21:35:INFO:test samples: (686,)
2024-06-13 11:21:35:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 11:21:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718248895 HTTP/1.1" 200 235
2024-06-13 11:21:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 11:21:36:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 11:21:36:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 11:21:37:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718248897 HTTP/1.1" 200 235
2024-06-13 11:21:37:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 11:21:37:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 11:21:37:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-13 11:21:37:WARNING:Try importing flash-attention for faster inference...
2024-06-13 11:21:37:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-13 11:21:37:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-13 11:21:37:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-13 11:21:39:INFO:trainable params: 1310288 || all params: 1838138960 || trainable%: 0.07128340286090232
2024-06-13 11:21:39:INFO:Init labels...
2024-06-13 11:21:39:INFO:Start training...
2024-06-13 11:22:00:INFO:TRAIN-(cmcm) (1/1/2)>> loss: 3.4933
2024-06-13 11:22:04:INFO:VAL-(cmcm) >>
2024-06-13 11:22:04:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4458  Non0_acc_2: 0.5648  Non0_F1_score: 0.4371  Mult_acc_5: 0.2096  Mult_acc_7: 0.2096  MAE: 1.4331  Corr: -0.0367 
2024-06-13 11:22:05:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-13 11:22:26:INFO:TRAIN-(cmcm) (1/2/2)>> loss: 1.0344
2024-06-13 11:22:30:INFO:VAL-(cmcm) >>
2024-06-13 11:22:30:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.4975  Non0_acc_2: 0.5648  Non0_F1_score: 0.4791  Mult_acc_5: 0.1790  Mult_acc_7: 0.1790  MAE: 1.5571  Corr: -0.0341 
2024-06-13 11:22:51:INFO:TRAIN-(cmcm) (2/3/2)>> loss: 0.9704
2024-06-13 11:22:54:INFO:VAL-(cmcm) >>
2024-06-13 11:22:54:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4700  Non0_acc_2: 0.5741  Non0_F1_score: 0.4420  Mult_acc_5: 0.1747  Mult_acc_7: 0.1747  MAE: 1.4632  Corr: -0.0244 
2024-06-13 11:23:15:INFO:TRAIN-(cmcm) (3/4/2)>> loss: 0.9489
2024-06-13 11:23:19:INFO:VAL-(cmcm) >>
2024-06-13 11:23:19:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.5220  Non0_acc_2: 0.5463  Non0_F1_score: 0.5030  Mult_acc_5: 0.2183  Mult_acc_7: 0.1878  MAE: 1.6663  Corr: -0.0043 
2024-06-13 11:23:40:INFO:TRAIN-(cmcm) (4/5/2)>> loss: 0.9180
2024-06-13 11:23:44:INFO:VAL-(cmcm) >>
2024-06-13 11:23:44:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.5109  Non0_acc_2: 0.5741  Non0_F1_score: 0.4851  Mult_acc_5: 0.1659  Mult_acc_7: 0.1659  MAE: 1.4929  Corr: 0.0315 
2024-06-13 11:24:05:INFO:TRAIN-(cmcm) (5/6/2)>> loss: 0.9016
2024-06-13 11:24:08:INFO:VAL-(cmcm) >>
2024-06-13 11:24:08:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.6058  Non0_acc_2: 0.5972  Non0_F1_score: 0.5990  Mult_acc_5: 0.2096  Mult_acc_7: 0.1921  MAE: 1.5363  Corr: 0.1687 
2024-06-13 11:24:29:INFO:TRAIN-(cmcm) (6/7/2)>> loss: 0.8920
2024-06-13 11:24:33:INFO:VAL-(cmcm) >>
2024-06-13 11:24:33:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5564  Non0_acc_2: 0.5648  Non0_F1_score: 0.5417  Mult_acc_5: 0.1834  Mult_acc_7: 0.1747  MAE: 1.5752  Corr: 0.0876 
2024-06-13 11:24:54:INFO:TRAIN-(cmcm) (7/8/2)>> loss: 0.8856
2024-06-13 11:24:57:INFO:VAL-(cmcm) >>
2024-06-13 11:24:57:INFO:M: >>  Has0_acc_2: 0.6550  Has0_F1_score: 0.6393  Non0_acc_2: 0.6574  Non0_F1_score: 0.6425  Mult_acc_5: 0.3013  Mult_acc_7: 0.2183  MAE: 1.5643  Corr: 0.2340 
2024-06-13 11:25:19:INFO:TRAIN-(cmcm) (8/9/2)>> loss: 0.8782
2024-06-13 11:25:22:INFO:VAL-(cmcm) >>
2024-06-13 11:25:22:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.5759  Non0_acc_2: 0.5880  Non0_F1_score: 0.5529  Mult_acc_5: 0.2751  Mult_acc_7: 0.2271  MAE: 1.6455  Corr: 0.0982 
2024-06-13 11:25:43:INFO:TRAIN-(cmcm) (9/10/2)>> loss: 0.8758
2024-06-13 11:25:47:INFO:VAL-(cmcm) >>
2024-06-13 11:25:47:INFO:M: >>  Has0_acc_2: 0.6245  Has0_F1_score: 0.5774  Non0_acc_2: 0.5926  Non0_F1_score: 0.5477  Mult_acc_5: 0.3057  Mult_acc_7: 0.2227  MAE: 1.5713  Corr: 0.1251 
2024-06-13 11:26:08:INFO:TRAIN-(cmcm) (10/11/2)>> loss: 0.8645
2024-06-13 11:26:11:INFO:VAL-(cmcm) >>
2024-06-13 11:26:12:INFO:M: >>  Has0_acc_2: 0.6419  Has0_F1_score: 0.5908  Non0_acc_2: 0.5000  Non0_F1_score: 0.4397  Mult_acc_5: 0.2314  Mult_acc_7: 0.2227  MAE: 1.3986  Corr: 0.1933 
2024-06-13 11:26:12:INFO:Saving checkpoint at epoch 11 to results/models/cmcm-mosi-regression.pth.
2024-06-13 11:26:34:INFO:TRAIN-(cmcm) (1/12/2)>> loss: 0.8527
2024-06-13 11:26:37:INFO:VAL-(cmcm) >>
2024-06-13 11:26:37:INFO:M: >>  Has0_acc_2: 0.6157  Has0_F1_score: 0.5844  Non0_acc_2: 0.6111  Non0_F1_score: 0.5793  Mult_acc_5: 0.2402  Mult_acc_7: 0.2052  MAE: 1.5357  Corr: 0.1508 
2024-06-13 11:26:58:INFO:TRAIN-(cmcm) (2/13/2)>> loss: 0.8458
2024-06-13 11:27:02:INFO:VAL-(cmcm) >>
2024-06-13 11:27:02:INFO:M: >>  Has0_acc_2: 0.6419  Has0_F1_score: 0.6416  Non0_acc_2: 0.6620  Non0_F1_score: 0.6607  Mult_acc_5: 0.2620  Mult_acc_7: 0.2052  MAE: 1.3625  Corr: 0.3536 
2024-06-13 11:27:02:INFO:Saving checkpoint at epoch 13 to results/models/cmcm-mosi-regression.pth.
2024-06-13 11:27:24:INFO:TRAIN-(cmcm) (1/14/2)>> loss: 0.8533
2024-06-13 11:27:28:INFO:VAL-(cmcm) >>
2024-06-13 11:27:28:INFO:M: >>  Has0_acc_2: 0.6419  Has0_F1_score: 0.6080  Non0_acc_2: 0.6389  Non0_F1_score: 0.6093  Mult_acc_5: 0.2926  Mult_acc_7: 0.2489  MAE: 1.4913  Corr: 0.1569 
2024-06-13 11:27:48:INFO:TRAIN-(cmcm) (2/15/2)>> loss: 0.8364
2024-06-13 11:27:52:INFO:VAL-(cmcm) >>
2024-06-13 11:27:52:INFO:M: >>  Has0_acc_2: 0.6507  Has0_F1_score: 0.6425  Non0_acc_2: 0.6574  Non0_F1_score: 0.6468  Mult_acc_5: 0.3100  Mult_acc_7: 0.2445  MAE: 1.4424  Corr: 0.2624 
2024-06-13 11:28:13:INFO:TRAIN-(cmcm) (3/16/2)>> loss: 0.8311
2024-06-13 11:28:17:INFO:VAL-(cmcm) >>
2024-06-13 11:28:17:INFO:M: >>  Has0_acc_2: 0.6812  Has0_F1_score: 0.6667  Non0_acc_2: 0.6574  Non0_F1_score: 0.6569  Mult_acc_5: 0.2314  Mult_acc_7: 0.2271  MAE: 1.2414  Corr: 0.3701 
2024-06-13 11:28:17:INFO:Saving checkpoint at epoch 16 to results/models/cmcm-mosi-regression.pth.
2024-06-13 11:28:39:INFO:TRAIN-(cmcm) (1/17/2)>> loss: 0.8236
2024-06-13 11:28:42:INFO:VAL-(cmcm) >>
2024-06-13 11:28:42:INFO:M: >>  Has0_acc_2: 0.6594  Has0_F1_score: 0.6627  Non0_acc_2: 0.6806  Non0_F1_score: 0.6815  Mult_acc_5: 0.3013  Mult_acc_7: 0.2576  MAE: 1.2536  Corr: 0.3999 
2024-06-13 11:29:01:INFO:TRAIN-(cmcm) (2/18/2)>> loss: 0.8091
2024-06-13 11:29:04:INFO:VAL-(cmcm) >>
2024-06-13 11:29:04:INFO:M: >>  Has0_acc_2: 0.6812  Has0_F1_score: 0.6838  Non0_acc_2: 0.6944  Non0_F1_score: 0.6959  Mult_acc_5: 0.3406  Mult_acc_7: 0.2664  MAE: 1.2368  Corr: 0.4360 
2024-06-13 11:29:05:INFO:Saving checkpoint at epoch 18 to results/models/cmcm-mosi-regression.pth.
2024-06-13 11:29:26:INFO:TRAIN-(cmcm) (1/19/2)>> loss: 0.8032
2024-06-13 11:29:30:INFO:VAL-(cmcm) >>
2024-06-13 11:29:30:INFO:M: >>  Has0_acc_2: 0.6594  Has0_F1_score: 0.6618  Non0_acc_2: 0.6806  Non0_F1_score: 0.6818  Mult_acc_5: 0.3188  Mult_acc_7: 0.2533  MAE: 1.3119  Corr: 0.4201 
2024-06-13 11:29:51:INFO:TRAIN-(cmcm) (2/20/2)>> loss: 0.7975
2024-06-13 11:29:54:INFO:VAL-(cmcm) >>
2024-06-13 11:29:54:INFO:M: >>  Has0_acc_2: 0.6681  Has0_F1_score: 0.6711  Non0_acc_2: 0.6806  Non0_F1_score: 0.6820  Mult_acc_5: 0.3013  Mult_acc_7: 0.2533  MAE: 1.2568  Corr: 0.4260 
2024-06-13 11:30:15:INFO:TRAIN-(cmcm) (3/21/2)>> loss: 0.7895
2024-06-13 11:30:19:INFO:VAL-(cmcm) >>
2024-06-13 11:30:19:INFO:M: >>  Has0_acc_2: 0.6812  Has0_F1_score: 0.6843  Non0_acc_2: 0.7037  Non0_F1_score: 0.7052  Mult_acc_5: 0.3275  Mult_acc_7: 0.2271  MAE: 1.3258  Corr: 0.4549 
2024-06-13 11:30:40:INFO:TRAIN-(cmcm) (4/22/2)>> loss: 0.7840
2024-06-13 11:30:43:INFO:VAL-(cmcm) >>
2024-06-13 11:30:43:INFO:M: >>  Has0_acc_2: 0.6856  Has0_F1_score: 0.6866  Non0_acc_2: 0.6898  Non0_F1_score: 0.6900  Mult_acc_5: 0.3319  Mult_acc_7: 0.2576  MAE: 1.2628  Corr: 0.4171 
2024-06-13 11:31:04:INFO:TRAIN-(cmcm) (5/23/2)>> loss: 0.7751
2024-06-13 11:31:08:INFO:VAL-(cmcm) >>
2024-06-13 11:31:08:INFO:M: >>  Has0_acc_2: 0.6769  Has0_F1_score: 0.6798  Non0_acc_2: 0.6898  Non0_F1_score: 0.6907  Mult_acc_5: 0.2838  Mult_acc_7: 0.2358  MAE: 1.2424  Corr: 0.4583 
2024-06-13 11:31:29:INFO:TRAIN-(cmcm) (6/24/2)>> loss: 0.7668
2024-06-13 11:31:32:INFO:VAL-(cmcm) >>
2024-06-13 11:31:32:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.6073  Non0_acc_2: 0.6250  Non0_F1_score: 0.6228  Mult_acc_5: 0.3057  Mult_acc_7: 0.2445  MAE: 1.3785  Corr: 0.3828 
2024-06-13 11:31:53:INFO:TRAIN-(cmcm) (7/25/2)>> loss: 0.7585
2024-06-13 11:31:57:INFO:VAL-(cmcm) >>
2024-06-13 11:31:57:INFO:M: >>  Has0_acc_2: 0.6594  Has0_F1_score: 0.6600  Non0_acc_2: 0.6759  Non0_F1_score: 0.6749  Mult_acc_5: 0.3581  Mult_acc_7: 0.2795  MAE: 1.3095  Corr: 0.3937 
2024-06-13 11:32:18:INFO:TRAIN-(cmcm) (8/26/2)>> loss: 0.7562
2024-06-13 11:32:21:INFO:VAL-(cmcm) >>
2024-06-13 11:32:21:INFO:M: >>  Has0_acc_2: 0.6856  Has0_F1_score: 0.6837  Non0_acc_2: 0.6991  Non0_F1_score: 0.7002  Mult_acc_5: 0.3799  Mult_acc_7: 0.3013  MAE: 1.1957  Corr: 0.4710 
2024-06-13 11:32:22:INFO:Saving checkpoint at epoch 26 to results/models/cmcm-mosi-regression.pth.
2024-06-13 11:32:43:INFO:TRAIN-(cmcm) (1/27/2)>> loss: 0.7436
2024-06-13 11:32:47:INFO:VAL-(cmcm) >>
2024-06-13 11:32:47:INFO:M: >>  Has0_acc_2: 0.6769  Has0_F1_score: 0.6800  Non0_acc_2: 0.6944  Non0_F1_score: 0.6961  Mult_acc_5: 0.3624  Mult_acc_7: 0.2795  MAE: 1.2673  Corr: 0.4503 
2024-06-13 11:33:08:INFO:TRAIN-(cmcm) (2/28/2)>> loss: 0.7373
2024-06-13 11:33:11:INFO:VAL-(cmcm) >>
2024-06-13 11:33:11:INFO:M: >>  Has0_acc_2: 0.6856  Has0_F1_score: 0.6747  Non0_acc_2: 0.6806  Non0_F1_score: 0.6724  Mult_acc_5: 0.3624  Mult_acc_7: 0.2882  MAE: 1.2669  Corr: 0.4571 
2024-06-13 11:33:32:INFO:TRAIN-(cmcm) (3/29/2)>> loss: 0.7307
2024-06-13 11:33:35:INFO:VAL-(cmcm) >>
2024-06-13 11:33:35:INFO:M: >>  Has0_acc_2: 0.6681  Has0_F1_score: 0.6615  Non0_acc_2: 0.6667  Non0_F1_score: 0.6684  Mult_acc_5: 0.3275  Mult_acc_7: 0.2445  MAE: 1.2420  Corr: 0.4421 
2024-06-13 11:33:56:INFO:TRAIN-(cmcm) (4/30/2)>> loss: 0.7217
2024-06-13 11:34:00:INFO:VAL-(cmcm) >>
2024-06-13 11:34:00:INFO:M: >>  Has0_acc_2: 0.6594  Has0_F1_score: 0.6556  Non0_acc_2: 0.6574  Non0_F1_score: 0.6582  Mult_acc_5: 0.3275  Mult_acc_7: 0.2489  MAE: 1.2558  Corr: 0.4409 
2024-06-13 11:34:21:INFO:TRAIN-(cmcm) (5/31/2)>> loss: 0.7143
2024-06-13 11:34:25:INFO:VAL-(cmcm) >>
2024-06-13 11:34:25:INFO:M: >>  Has0_acc_2: 0.6594  Has0_F1_score: 0.6605  Non0_acc_2: 0.6852  Non0_F1_score: 0.6852  Mult_acc_5: 0.3493  Mult_acc_7: 0.2664  MAE: 1.2551  Corr: 0.4533 
2024-06-13 11:34:45:INFO:TRAIN-(cmcm) (6/32/2)>> loss: 0.7116
2024-06-13 11:34:49:INFO:VAL-(cmcm) >>
2024-06-13 11:34:49:INFO:M: >>  Has0_acc_2: 0.6594  Has0_F1_score: 0.6556  Non0_acc_2: 0.6944  Non0_F1_score: 0.6952  Mult_acc_5: 0.3537  Mult_acc_7: 0.2707  MAE: 1.2350  Corr: 0.4736 
2024-06-13 11:35:10:INFO:TRAIN-(cmcm) (7/33/2)>> loss: 0.7025
2024-06-13 11:35:14:INFO:VAL-(cmcm) >>
2024-06-13 11:35:14:INFO:M: >>  Has0_acc_2: 0.6638  Has0_F1_score: 0.6646  Non0_acc_2: 0.6481  Non0_F1_score: 0.6493  Mult_acc_5: 0.3537  Mult_acc_7: 0.2795  MAE: 1.2820  Corr: 0.4286 
2024-06-13 11:35:34:INFO:TRAIN-(cmcm) (8/34/2)>> loss: 0.6925
2024-06-13 11:35:38:INFO:VAL-(cmcm) >>
2024-06-13 11:35:38:INFO:M: >>  Has0_acc_2: 0.6594  Has0_F1_score: 0.6600  Non0_acc_2: 0.6481  Non0_F1_score: 0.6496  Mult_acc_5: 0.3144  Mult_acc_7: 0.2533  MAE: 1.2777  Corr: 0.4309 
2024-06-13 11:35:59:INFO:TRAIN-(cmcm) (9/35/2)>> loss: 0.6900
2024-06-13 11:36:03:INFO:VAL-(cmcm) >>
2024-06-13 11:36:03:INFO:M: >>  Has0_acc_2: 0.6638  Has0_F1_score: 0.6640  Non0_acc_2: 0.6759  Non0_F1_score: 0.6776  Mult_acc_5: 0.3668  Mult_acc_7: 0.2838  MAE: 1.2311  Corr: 0.4852 
2024-06-13 11:36:24:INFO:TRAIN-(cmcm) (10/36/2)>> loss: 0.6848
2024-06-13 11:36:27:INFO:VAL-(cmcm) >>
2024-06-13 11:36:27:INFO:M: >>  Has0_acc_2: 0.6681  Has0_F1_score: 0.6653  Non0_acc_2: 0.6898  Non0_F1_score: 0.6891  Mult_acc_5: 0.3624  Mult_acc_7: 0.2838  MAE: 1.2301  Corr: 0.4754 
2024-06-13 11:36:38:INFO:TEST-(cmcm) >>
2024-06-13 11:36:38:INFO:M: >>  Has0_acc_2: 0.6735  Has0_F1_score: 0.6728  Non0_acc_2: 0.7073  Non0_F1_score: 0.7089  Mult_acc_5: 0.2945  Mult_acc_7: 0.2668  MAE: 1.2662  Corr: 0.4425 
2024-06-13 11:36:38:INFO:Results are added to results/results/mosi-regression-40.csv...
2024-06-13 11:36:38:INFO:Start running cmcm...
2024-06-13 11:36:38:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 6, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 40, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 3333}>
2024-06-13 11:36:38:INFO:Let's use the GPU 1 !
2024-06-13 11:36:38:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 11:36:38:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718249799 HTTP/1.1" 200 235
2024-06-13 11:36:39:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 11:36:39:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 11:36:40:INFO:train samples: (1284,)
2024-06-13 11:36:40:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 11:36:40:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718249801 HTTP/1.1" 200 235
2024-06-13 11:36:41:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 11:36:41:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 11:36:42:INFO:valid samples: (229,)
2024-06-13 11:36:42:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 11:36:42:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718249802 HTTP/1.1" 200 235
2024-06-13 11:36:43:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 11:36:43:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 11:36:44:INFO:test samples: (686,)
2024-06-13 11:36:44:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 11:36:44:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718249804 HTTP/1.1" 200 235
2024-06-13 11:36:44:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 11:36:45:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 11:36:45:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 11:36:46:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718249806 HTTP/1.1" 200 235
2024-06-13 11:36:46:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 11:36:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 11:36:47:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-13 11:36:47:WARNING:Try importing flash-attention for faster inference...
2024-06-13 11:36:47:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-13 11:36:47:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-13 11:36:47:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-13 11:36:48:INFO:trainable params: 1310288 || all params: 1838138960 || trainable%: 0.07128340286090232
2024-06-13 11:36:48:INFO:Init labels...
2024-06-13 11:36:48:INFO:Start training...
2024-06-13 11:37:06:INFO:TRAIN-(cmcm) (1/1/3)>> loss: 3.5612
2024-06-13 11:37:09:INFO:VAL-(cmcm) >>
2024-06-13 11:37:09:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4556  Non0_acc_2: 0.5787  Non0_F1_score: 0.4370  Mult_acc_5: 0.2882  Mult_acc_7: 0.2227  MAE: 1.8497  Corr: -0.0222 
2024-06-13 11:37:09:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-13 11:37:31:INFO:TRAIN-(cmcm) (1/2/3)>> loss: 1.0425
2024-06-13 11:37:35:INFO:VAL-(cmcm) >>
2024-06-13 11:37:35:INFO:M: >>  Has0_acc_2: 0.5284  Has0_F1_score: 0.4803  Non0_acc_2: 0.4583  Non0_F1_score: 0.3579  Mult_acc_5: 0.1834  Mult_acc_7: 0.1790  MAE: 1.5951  Corr: -0.0406 
2024-06-13 11:37:35:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-13 11:37:56:INFO:TRAIN-(cmcm) (1/3/3)>> loss: 0.9699
2024-06-13 11:38:00:INFO:VAL-(cmcm) >>
2024-06-13 11:38:00:INFO:M: >>  Has0_acc_2: 0.5546  Has0_F1_score: 0.5372  Non0_acc_2: 0.5463  Non0_F1_score: 0.5266  Mult_acc_5: 0.2314  Mult_acc_7: 0.1747  MAE: 1.7835  Corr: -0.0159 
2024-06-13 11:38:21:INFO:TRAIN-(cmcm) (2/4/3)>> loss: 0.9034
2024-06-13 11:38:24:INFO:VAL-(cmcm) >>
2024-06-13 11:38:24:INFO:M: >>  Has0_acc_2: 0.4716  Has0_F1_score: 0.4277  Non0_acc_2: 0.4907  Non0_F1_score: 0.4466  Mult_acc_5: 0.1965  Mult_acc_7: 0.1703  MAE: 1.7429  Corr: 0.0679 
2024-06-13 11:38:45:INFO:TRAIN-(cmcm) (3/5/3)>> loss: 0.8887
2024-06-13 11:38:49:INFO:VAL-(cmcm) >>
2024-06-13 11:38:49:INFO:M: >>  Has0_acc_2: 0.4978  Has0_F1_score: 0.4938  Non0_acc_2: 0.5139  Non0_F1_score: 0.5089  Mult_acc_5: 0.2576  Mult_acc_7: 0.1965  MAE: 1.7803  Corr: 0.1006 
2024-06-13 11:39:10:INFO:TRAIN-(cmcm) (4/6/3)>> loss: 0.8690
2024-06-13 11:39:13:INFO:VAL-(cmcm) >>
2024-06-13 11:39:13:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.5278  Non0_acc_2: 0.5694  Non0_F1_score: 0.5092  Mult_acc_5: 0.2926  Mult_acc_7: 0.2096  MAE: 1.7800  Corr: 0.0487 
2024-06-13 11:39:34:INFO:TRAIN-(cmcm) (5/7/3)>> loss: 0.8649
2024-06-13 11:39:38:INFO:VAL-(cmcm) >>
2024-06-13 11:39:38:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.5681  Non0_acc_2: 0.5787  Non0_F1_score: 0.5594  Mult_acc_5: 0.2882  Mult_acc_7: 0.2140  MAE: 1.6333  Corr: 0.0636 
2024-06-13 11:39:59:INFO:TRAIN-(cmcm) (6/8/3)>> loss: 0.8664
2024-06-13 11:40:02:INFO:VAL-(cmcm) >>
2024-06-13 11:40:02:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5031  Non0_acc_2: 0.5694  Non0_F1_score: 0.4768  Mult_acc_5: 0.2751  Mult_acc_7: 0.2009  MAE: 1.6490  Corr: 0.0623 
2024-06-13 11:40:23:INFO:TRAIN-(cmcm) (7/9/3)>> loss: 0.8615
2024-06-13 11:40:27:INFO:VAL-(cmcm) >>
2024-06-13 11:40:27:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.4840  Non0_acc_2: 0.5694  Non0_F1_score: 0.4595  Mult_acc_5: 0.3057  Mult_acc_7: 0.2271  MAE: 1.7276  Corr: 0.0299 
2024-06-13 11:40:48:INFO:TRAIN-(cmcm) (8/10/3)>> loss: 0.8553
2024-06-13 11:40:51:INFO:VAL-(cmcm) >>
2024-06-13 11:40:51:INFO:M: >>  Has0_acc_2: 0.5502  Has0_F1_score: 0.5405  Non0_acc_2: 0.5370  Non0_F1_score: 0.5261  Mult_acc_5: 0.2620  Mult_acc_7: 0.2052  MAE: 1.7401  Corr: 0.0194 
2024-06-13 11:41:12:INFO:TRAIN-(cmcm) (9/11/3)>> loss: 0.8478
2024-06-13 11:41:16:INFO:VAL-(cmcm) >>
2024-06-13 11:41:16:INFO:M: >>  Has0_acc_2: 0.6725  Has0_F1_score: 0.6733  Non0_acc_2: 0.6389  Non0_F1_score: 0.6408  Mult_acc_5: 0.2620  Mult_acc_7: 0.2096  MAE: 1.4008  Corr: 0.2589 
2024-06-13 11:41:17:INFO:Saving checkpoint at epoch 11 to results/models/cmcm-mosi-regression.pth.
2024-06-13 11:41:38:INFO:TRAIN-(cmcm) (1/12/3)>> loss: 0.8400
2024-06-13 11:41:41:INFO:VAL-(cmcm) >>
2024-06-13 11:41:41:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.5845  Non0_acc_2: 0.5648  Non0_F1_score: 0.5573  Mult_acc_5: 0.2314  Mult_acc_7: 0.2140  MAE: 1.4663  Corr: 0.1032 
2024-06-13 11:42:03:INFO:TRAIN-(cmcm) (2/13/3)>> loss: 0.8381
2024-06-13 11:42:06:INFO:VAL-(cmcm) >>
2024-06-13 11:42:06:INFO:M: >>  Has0_acc_2: 0.6463  Has0_F1_score: 0.6496  Non0_acc_2: 0.6667  Non0_F1_score: 0.6685  Mult_acc_5: 0.2271  Mult_acc_7: 0.2009  MAE: 1.4222  Corr: 0.3436 
2024-06-13 11:42:27:INFO:TRAIN-(cmcm) (3/14/3)>> loss: 0.8326
2024-06-13 11:42:31:INFO:VAL-(cmcm) >>
2024-06-13 11:42:31:INFO:M: >>  Has0_acc_2: 0.6201  Has0_F1_score: 0.6161  Non0_acc_2: 0.5926  Non0_F1_score: 0.5743  Mult_acc_5: 0.2795  Mult_acc_7: 0.2271  MAE: 1.4632  Corr: 0.3489 
2024-06-13 11:42:52:INFO:TRAIN-(cmcm) (4/15/3)>> loss: 0.8234
2024-06-13 11:42:56:INFO:VAL-(cmcm) >>
2024-06-13 11:42:56:INFO:M: >>  Has0_acc_2: 0.6725  Has0_F1_score: 0.6630  Non0_acc_2: 0.6528  Non0_F1_score: 0.6462  Mult_acc_5: 0.3057  Mult_acc_7: 0.2271  MAE: 1.3816  Corr: 0.3468 
2024-06-13 11:42:56:INFO:Saving checkpoint at epoch 15 to results/models/cmcm-mosi-regression.pth.
2024-06-13 11:43:18:INFO:TRAIN-(cmcm) (1/16/3)>> loss: 0.8132
2024-06-13 11:43:21:INFO:VAL-(cmcm) >>
2024-06-13 11:43:21:INFO:M: >>  Has0_acc_2: 0.6812  Has0_F1_score: 0.6542  Non0_acc_2: 0.6759  Non0_F1_score: 0.6494  Mult_acc_5: 0.3319  Mult_acc_7: 0.2533  MAE: 1.4088  Corr: 0.3784 
2024-06-13 11:43:40:INFO:TRAIN-(cmcm) (2/17/3)>> loss: 0.8057
2024-06-13 11:43:44:INFO:VAL-(cmcm) >>
2024-06-13 11:43:44:INFO:M: >>  Has0_acc_2: 0.7118  Has0_F1_score: 0.7142  Non0_acc_2: 0.7222  Non0_F1_score: 0.7234  Mult_acc_5: 0.3362  Mult_acc_7: 0.2707  MAE: 1.1947  Corr: 0.4988 
2024-06-13 11:43:45:INFO:Saving checkpoint at epoch 17 to results/models/cmcm-mosi-regression.pth.
2024-06-13 11:44:06:INFO:TRAIN-(cmcm) (1/18/3)>> loss: 0.7871
2024-06-13 11:44:10:INFO:VAL-(cmcm) >>
2024-06-13 11:44:10:INFO:M: >>  Has0_acc_2: 0.6681  Has0_F1_score: 0.6713  Non0_acc_2: 0.6991  Non0_F1_score: 0.7007  Mult_acc_5: 0.3406  Mult_acc_7: 0.2795  MAE: 1.2778  Corr: 0.4421 
2024-06-13 11:44:31:INFO:TRAIN-(cmcm) (2/19/3)>> loss: 0.7947
2024-06-13 11:44:34:INFO:VAL-(cmcm) >>
2024-06-13 11:44:34:INFO:M: >>  Has0_acc_2: 0.6725  Has0_F1_score: 0.6684  Non0_acc_2: 0.6806  Non0_F1_score: 0.6755  Mult_acc_5: 0.3362  Mult_acc_7: 0.2751  MAE: 1.2567  Corr: 0.4363 
2024-06-13 11:44:55:INFO:TRAIN-(cmcm) (3/20/3)>> loss: 0.7803
2024-06-13 11:44:59:INFO:VAL-(cmcm) >>
2024-06-13 11:44:59:INFO:M: >>  Has0_acc_2: 0.6376  Has0_F1_score: 0.6406  Non0_acc_2: 0.6574  Non0_F1_score: 0.6590  Mult_acc_5: 0.3100  Mult_acc_7: 0.2227  MAE: 1.4721  Corr: 0.3874 
2024-06-13 11:45:20:INFO:TRAIN-(cmcm) (4/21/3)>> loss: 0.7722
2024-06-13 11:45:24:INFO:VAL-(cmcm) >>
2024-06-13 11:45:24:INFO:M: >>  Has0_acc_2: 0.6725  Has0_F1_score: 0.6749  Non0_acc_2: 0.6944  Non0_F1_score: 0.6960  Mult_acc_5: 0.3755  Mult_acc_7: 0.2795  MAE: 1.3368  Corr: 0.4143 
2024-06-13 11:45:44:INFO:TRAIN-(cmcm) (5/22/3)>> loss: 0.7563
2024-06-13 11:45:48:INFO:VAL-(cmcm) >>
2024-06-13 11:45:48:INFO:M: >>  Has0_acc_2: 0.6550  Has0_F1_score: 0.6550  Non0_acc_2: 0.6852  Non0_F1_score: 0.6836  Mult_acc_5: 0.3493  Mult_acc_7: 0.2707  MAE: 1.3637  Corr: 0.4246 
2024-06-13 11:46:09:INFO:TRAIN-(cmcm) (6/23/3)>> loss: 0.7509
2024-06-13 11:46:13:INFO:VAL-(cmcm) >>
2024-06-13 11:46:13:INFO:M: >>  Has0_acc_2: 0.7162  Has0_F1_score: 0.7159  Non0_acc_2: 0.6806  Non0_F1_score: 0.6808  Mult_acc_5: 0.3450  Mult_acc_7: 0.2882  MAE: 1.1899  Corr: 0.4678 
2024-06-13 11:46:13:INFO:Saving checkpoint at epoch 23 to results/models/cmcm-mosi-regression.pth.
2024-06-13 11:46:35:INFO:TRAIN-(cmcm) (1/24/3)>> loss: 0.7410
2024-06-13 11:46:38:INFO:VAL-(cmcm) >>
2024-06-13 11:46:38:INFO:M: >>  Has0_acc_2: 0.6681  Has0_F1_score: 0.6707  Non0_acc_2: 0.6944  Non0_F1_score: 0.6952  Mult_acc_5: 0.3624  Mult_acc_7: 0.2882  MAE: 1.2726  Corr: 0.4345 
2024-06-13 11:46:59:INFO:TRAIN-(cmcm) (2/25/3)>> loss: 0.7336
2024-06-13 11:47:03:INFO:VAL-(cmcm) >>
2024-06-13 11:47:03:INFO:M: >>  Has0_acc_2: 0.6245  Has0_F1_score: 0.6218  Non0_acc_2: 0.6481  Non0_F1_score: 0.6423  Mult_acc_5: 0.3319  Mult_acc_7: 0.2707  MAE: 1.2848  Corr: 0.4200 
2024-06-13 11:47:24:INFO:TRAIN-(cmcm) (3/26/3)>> loss: 0.7284
2024-06-13 11:47:27:INFO:VAL-(cmcm) >>
2024-06-13 11:47:27:INFO:M: >>  Has0_acc_2: 0.6376  Has0_F1_score: 0.6362  Non0_acc_2: 0.6435  Non0_F1_score: 0.6361  Mult_acc_5: 0.2969  Mult_acc_7: 0.2402  MAE: 1.3239  Corr: 0.4249 
2024-06-13 11:47:49:INFO:TRAIN-(cmcm) (4/27/3)>> loss: 0.7171
2024-06-13 11:47:52:INFO:VAL-(cmcm) >>
2024-06-13 11:47:52:INFO:M: >>  Has0_acc_2: 0.6550  Has0_F1_score: 0.6581  Non0_acc_2: 0.6759  Non0_F1_score: 0.6770  Mult_acc_5: 0.3493  Mult_acc_7: 0.2707  MAE: 1.3213  Corr: 0.4265 
2024-06-13 11:48:13:INFO:TRAIN-(cmcm) (5/28/3)>> loss: 0.7089
2024-06-13 11:48:17:INFO:VAL-(cmcm) >>
2024-06-13 11:48:17:INFO:M: >>  Has0_acc_2: 0.7074  Has0_F1_score: 0.7100  Non0_acc_2: 0.7083  Non0_F1_score: 0.7098  Mult_acc_5: 0.3275  Mult_acc_7: 0.2664  MAE: 1.1986  Corr: 0.4865 
2024-06-13 11:48:38:INFO:TRAIN-(cmcm) (6/29/3)>> loss: 0.6988
2024-06-13 11:48:42:INFO:VAL-(cmcm) >>
2024-06-13 11:48:42:INFO:M: >>  Has0_acc_2: 0.6769  Has0_F1_score: 0.6769  Non0_acc_2: 0.6898  Non0_F1_score: 0.6912  Mult_acc_5: 0.3581  Mult_acc_7: 0.2795  MAE: 1.2271  Corr: 0.4544 
2024-06-13 11:49:03:INFO:TRAIN-(cmcm) (7/30/3)>> loss: 0.6902
2024-06-13 11:49:06:INFO:VAL-(cmcm) >>
2024-06-13 11:49:06:INFO:M: >>  Has0_acc_2: 0.7118  Has0_F1_score: 0.7078  Non0_acc_2: 0.7315  Non0_F1_score: 0.7329  Mult_acc_5: 0.3668  Mult_acc_7: 0.2969  MAE: 1.1747  Corr: 0.4924 
2024-06-13 11:49:07:INFO:Saving checkpoint at epoch 30 to results/models/cmcm-mosi-regression.pth.
2024-06-13 11:49:28:INFO:TRAIN-(cmcm) (1/31/3)>> loss: 0.6869
2024-06-13 11:49:32:INFO:VAL-(cmcm) >>
2024-06-13 11:49:32:INFO:M: >>  Has0_acc_2: 0.6638  Has0_F1_score: 0.6657  Non0_acc_2: 0.6667  Non0_F1_score: 0.6656  Mult_acc_5: 0.3275  Mult_acc_7: 0.2576  MAE: 1.3165  Corr: 0.4278 
2024-06-13 11:49:53:INFO:TRAIN-(cmcm) (2/32/3)>> loss: 0.6809
2024-06-13 11:49:57:INFO:VAL-(cmcm) >>
2024-06-13 11:49:57:INFO:M: >>  Has0_acc_2: 0.6550  Has0_F1_score: 0.6584  Non0_acc_2: 0.6713  Non0_F1_score: 0.6706  Mult_acc_5: 0.3100  Mult_acc_7: 0.2445  MAE: 1.3143  Corr: 0.4290 
2024-06-13 11:50:18:INFO:TRAIN-(cmcm) (3/33/3)>> loss: 0.6695
2024-06-13 11:50:21:INFO:VAL-(cmcm) >>
2024-06-13 11:50:21:INFO:M: >>  Has0_acc_2: 0.6681  Has0_F1_score: 0.6702  Non0_acc_2: 0.6759  Non0_F1_score: 0.6759  Mult_acc_5: 0.3188  Mult_acc_7: 0.2445  MAE: 1.3027  Corr: 0.4468 
2024-06-13 11:50:43:INFO:TRAIN-(cmcm) (4/34/3)>> loss: 0.6656
2024-06-13 11:50:46:INFO:VAL-(cmcm) >>
2024-06-13 11:50:46:INFO:M: >>  Has0_acc_2: 0.6681  Has0_F1_score: 0.6713  Non0_acc_2: 0.6852  Non0_F1_score: 0.6859  Mult_acc_5: 0.2969  Mult_acc_7: 0.2402  MAE: 1.2822  Corr: 0.4568 
2024-06-13 11:51:07:INFO:TRAIN-(cmcm) (5/35/3)>> loss: 0.6587
2024-06-13 11:51:11:INFO:VAL-(cmcm) >>
2024-06-13 11:51:11:INFO:M: >>  Has0_acc_2: 0.6900  Has0_F1_score: 0.6897  Non0_acc_2: 0.6991  Non0_F1_score: 0.7002  Mult_acc_5: 0.3450  Mult_acc_7: 0.2795  MAE: 1.2394  Corr: 0.4416 
2024-06-13 11:51:32:INFO:TRAIN-(cmcm) (6/36/3)>> loss: 0.6561
2024-06-13 11:51:36:INFO:VAL-(cmcm) >>
2024-06-13 11:51:36:INFO:M: >>  Has0_acc_2: 0.6594  Has0_F1_score: 0.6626  Non0_acc_2: 0.6806  Non0_F1_score: 0.6821  Mult_acc_5: 0.3144  Mult_acc_7: 0.2489  MAE: 1.2839  Corr: 0.4442 
2024-06-13 11:51:53:INFO:TRAIN-(cmcm) (7/37/3)>> loss: 0.6498
2024-06-13 11:51:57:INFO:VAL-(cmcm) >>
2024-06-13 11:51:57:INFO:M: >>  Has0_acc_2: 0.6725  Has0_F1_score: 0.6756  Non0_acc_2: 0.6991  Non0_F1_score: 0.6993  Mult_acc_5: 0.3100  Mult_acc_7: 0.2445  MAE: 1.2721  Corr: 0.4610 
2024-06-13 11:52:18:INFO:TRAIN-(cmcm) (8/38/3)>> loss: 0.6484
2024-06-13 11:52:22:INFO:VAL-(cmcm) >>
2024-06-13 11:52:22:INFO:M: >>  Has0_acc_2: 0.6681  Has0_F1_score: 0.6709  Non0_acc_2: 0.6759  Non0_F1_score: 0.6773  Mult_acc_5: 0.3057  Mult_acc_7: 0.2402  MAE: 1.2961  Corr: 0.4297 
2024-06-13 11:52:42:INFO:TRAIN-(cmcm) (9/39/3)>> loss: 0.6479
2024-06-13 11:52:46:INFO:VAL-(cmcm) >>
2024-06-13 11:52:46:INFO:M: >>  Has0_acc_2: 0.6769  Has0_F1_score: 0.6798  Non0_acc_2: 0.6898  Non0_F1_score: 0.6910  Mult_acc_5: 0.3057  Mult_acc_7: 0.2445  MAE: 1.2778  Corr: 0.4454 
2024-06-13 11:53:07:INFO:TRAIN-(cmcm) (10/40/3)>> loss: 0.6444
2024-06-13 11:53:11:INFO:VAL-(cmcm) >>
2024-06-13 11:53:11:INFO:M: >>  Has0_acc_2: 0.6725  Has0_F1_score: 0.6753  Non0_acc_2: 0.6806  Non0_F1_score: 0.6820  Mult_acc_5: 0.3057  Mult_acc_7: 0.2402  MAE: 1.2800  Corr: 0.4418 
2024-06-13 11:53:21:INFO:TEST-(cmcm) >>
2024-06-13 11:53:21:INFO:M: >>  Has0_acc_2: 0.6589  Has0_F1_score: 0.6567  Non0_acc_2: 0.6860  Non0_F1_score: 0.6865  Mult_acc_5: 0.3178  Mult_acc_7: 0.2784  MAE: 1.2683  Corr: 0.4119 
2024-06-13 11:53:22:INFO:Results are added to results/results/mosi-regression-40.csv...
2024-06-13 11:53:22:INFO:Start running cmcm...
2024-06-13 11:53:22:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 6, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 40, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 4444}>
2024-06-13 11:53:22:INFO:Let's use the GPU 1 !
2024-06-13 11:53:22:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 11:53:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718250802 HTTP/1.1" 200 235
2024-06-13 11:53:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 11:53:23:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 11:53:24:INFO:train samples: (1284,)
2024-06-13 11:53:24:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 11:53:24:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718250804 HTTP/1.1" 200 235
2024-06-13 11:53:24:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 11:53:25:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 11:53:25:INFO:valid samples: (229,)
2024-06-13 11:53:26:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 11:53:26:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718250806 HTTP/1.1" 200 235
2024-06-13 11:53:26:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 11:53:27:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 11:53:27:INFO:test samples: (686,)
2024-06-13 11:53:27:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 11:53:28:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718250808 HTTP/1.1" 200 235
2024-06-13 11:53:28:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 11:53:29:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 11:53:29:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 11:53:30:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718250810 HTTP/1.1" 200 235
2024-06-13 11:53:30:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 11:53:30:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 11:53:31:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-13 11:53:31:WARNING:Try importing flash-attention for faster inference...
2024-06-13 11:53:31:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-13 11:53:31:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-13 11:53:31:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-13 11:53:32:INFO:trainable params: 1310288 || all params: 1838138960 || trainable%: 0.07128340286090232
2024-06-13 11:53:32:INFO:Init labels...
2024-06-13 11:53:32:INFO:Start training...
2024-06-13 11:53:53:INFO:TRAIN-(cmcm) (1/1/4)>> loss: 4.1735
2024-06-13 11:53:56:INFO:VAL-(cmcm) >>
2024-06-13 11:53:56:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4259  Non0_F1_score: 0.2544  Mult_acc_5: 0.2140  Mult_acc_7: 0.2140  MAE: 1.4370  Corr: nan 
2024-06-13 11:53:57:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-13 11:54:18:INFO:TRAIN-(cmcm) (1/2/4)>> loss: 1.7151
2024-06-13 11:54:22:INFO:VAL-(cmcm) >>
2024-06-13 11:54:22:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.4780  Non0_acc_2: 0.5556  Non0_F1_score: 0.4513  Mult_acc_5: 0.2402  Mult_acc_7: 0.1965  MAE: 1.6187  Corr: -0.0653 
2024-06-13 11:54:43:INFO:TRAIN-(cmcm) (2/3/4)>> loss: 1.0702
2024-06-13 11:54:46:INFO:VAL-(cmcm) >>
2024-06-13 11:54:46:INFO:M: >>  Has0_acc_2: 0.4760  Has0_F1_score: 0.4309  Non0_acc_2: 0.4861  Non0_F1_score: 0.4367  Mult_acc_5: 0.2227  Mult_acc_7: 0.1703  MAE: 2.1485  Corr: 0.0200 
2024-06-13 11:55:08:INFO:TRAIN-(cmcm) (3/4/4)>> loss: 0.9644
2024-06-13 11:55:11:INFO:VAL-(cmcm) >>
2024-06-13 11:55:11:INFO:M: >>  Has0_acc_2: 0.4891  Has0_F1_score: 0.4646  Non0_acc_2: 0.5139  Non0_F1_score: 0.4910  Mult_acc_5: 0.1790  Mult_acc_7: 0.1790  MAE: 1.6274  Corr: 0.0887 
2024-06-13 11:55:32:INFO:TRAIN-(cmcm) (4/5/4)>> loss: 0.9096
2024-06-13 11:55:36:INFO:VAL-(cmcm) >>
2024-06-13 11:55:36:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4458  Non0_acc_2: 0.5694  Non0_F1_score: 0.4166  Mult_acc_5: 0.1790  Mult_acc_7: 0.1790  MAE: 1.5724  Corr: -0.1074 
2024-06-13 11:55:57:INFO:TRAIN-(cmcm) (5/6/4)>> loss: 0.8873
2024-06-13 11:56:00:INFO:VAL-(cmcm) >>
2024-06-13 11:56:00:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4556  Non0_acc_2: 0.5741  Non0_F1_score: 0.4269  Mult_acc_5: 0.1790  Mult_acc_7: 0.1790  MAE: 1.4877  Corr: -0.0030 
2024-06-13 11:56:21:INFO:TRAIN-(cmcm) (6/7/4)>> loss: 0.8788
2024-06-13 11:56:25:INFO:VAL-(cmcm) >>
2024-06-13 11:56:25:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.4817  Non0_acc_2: 0.5556  Non0_F1_score: 0.4571  Mult_acc_5: 0.1834  Mult_acc_7: 0.1747  MAE: 1.5951  Corr: -0.0450 
2024-06-13 11:56:46:INFO:TRAIN-(cmcm) (7/8/4)>> loss: 0.8760
2024-06-13 11:56:50:INFO:VAL-(cmcm) >>
2024-06-13 11:56:50:INFO:M: >>  Has0_acc_2: 0.5371  Has0_F1_score: 0.5051  Non0_acc_2: 0.5231  Non0_F1_score: 0.4886  Mult_acc_5: 0.2664  Mult_acc_7: 0.2096  MAE: 1.7756  Corr: -0.0361 
2024-06-13 11:57:11:INFO:TRAIN-(cmcm) (8/9/4)>> loss: 0.8670
2024-06-13 11:57:14:INFO:VAL-(cmcm) >>
2024-06-13 11:57:14:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.6085  Non0_acc_2: 0.6157  Non0_F1_score: 0.6107  Mult_acc_5: 0.2445  Mult_acc_7: 0.2009  MAE: 1.5167  Corr: 0.1951 
2024-06-13 11:57:35:INFO:TRAIN-(cmcm) (9/10/4)>> loss: 0.8559
2024-06-13 11:57:39:INFO:VAL-(cmcm) >>
2024-06-13 11:57:39:INFO:M: >>  Has0_acc_2: 0.6157  Has0_F1_score: 0.5273  Non0_acc_2: 0.5972  Non0_F1_score: 0.5054  Mult_acc_5: 0.2707  Mult_acc_7: 0.1965  MAE: 1.6372  Corr: 0.0928 
2024-06-13 11:58:00:INFO:TRAIN-(cmcm) (10/11/4)>> loss: 0.8535
2024-06-13 11:58:04:INFO:VAL-(cmcm) >>
2024-06-13 11:58:04:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.5621  Non0_acc_2: 0.5787  Non0_F1_score: 0.5530  Mult_acc_5: 0.3013  Mult_acc_7: 0.2227  MAE: 1.6586  Corr: 0.1045 
2024-06-13 11:58:14:INFO:TEST-(cmcm) >>
2024-06-13 11:58:14:INFO:M: >>  Has0_acc_2: 0.4475  Has0_F1_score: 0.2767  Non0_acc_2: 0.5777  Non0_F1_score: 0.4231  Mult_acc_5: 0.1545  Mult_acc_7: 0.1545  MAE: 1.4174  Corr: nan 
2024-06-13 11:58:15:INFO:Results are added to results/results/mosi-regression-40.csv...
2024-06-13 11:58:15:INFO:Start running cmcm...
2024-06-13 11:58:15:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 6, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 40, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 5555}>
2024-06-13 11:58:15:INFO:Let's use the GPU 1 !
2024-06-13 11:58:15:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 11:58:15:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718251095 HTTP/1.1" 200 235
2024-06-13 11:58:16:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 11:58:16:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 11:58:17:INFO:train samples: (1284,)
2024-06-13 11:58:17:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 11:58:17:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718251097 HTTP/1.1" 200 235
2024-06-13 11:58:17:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 11:58:18:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 11:58:19:INFO:valid samples: (229,)
2024-06-13 11:58:19:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 11:58:19:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718251099 HTTP/1.1" 200 235
2024-06-13 11:58:19:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 11:58:20:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 11:58:21:INFO:test samples: (686,)
2024-06-13 11:58:21:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 11:58:21:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718251101 HTTP/1.1" 200 235
2024-06-13 11:58:21:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 11:58:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 11:58:22:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 11:58:23:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718251103 HTTP/1.1" 200 235
2024-06-13 11:58:23:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 11:58:23:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 11:58:24:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-13 11:58:24:WARNING:Try importing flash-attention for faster inference...
2024-06-13 11:58:24:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-13 11:58:24:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-13 11:58:24:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-13 11:58:25:INFO:trainable params: 1310288 || all params: 1838138960 || trainable%: 0.07128340286090232
2024-06-13 11:58:25:INFO:Init labels...
2024-06-13 11:58:25:INFO:Start training...
2024-06-13 11:58:46:INFO:TRAIN-(cmcm) (1/1/5)>> loss: 2.8008
2024-06-13 11:58:50:INFO:VAL-(cmcm) >>
2024-06-13 11:58:50:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.5317  Non0_acc_2: 0.5602  Non0_F1_score: 0.5599  Mult_acc_5: 0.1878  Mult_acc_7: 0.1878  MAE: 1.4755  Corr: 0.0334 
2024-06-13 11:58:50:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-13 11:59:12:INFO:TRAIN-(cmcm) (1/2/5)>> loss: 0.9810
2024-06-13 11:59:15:INFO:VAL-(cmcm) >>
2024-06-13 11:59:15:INFO:M: >>  Has0_acc_2: 0.6201  Has0_F1_score: 0.5740  Non0_acc_2: 0.6019  Non0_F1_score: 0.5548  Mult_acc_5: 0.1747  Mult_acc_7: 0.1747  MAE: 1.4925  Corr: 0.0819 
2024-06-13 11:59:36:INFO:TRAIN-(cmcm) (2/3/5)>> loss: 0.9066
2024-06-13 11:59:40:INFO:VAL-(cmcm) >>
2024-06-13 11:59:40:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.5137  Non0_acc_2: 0.5787  Non0_F1_score: 0.4881  Mult_acc_5: 0.2052  Mult_acc_7: 0.1790  MAE: 1.5082  Corr: 0.0797 
2024-06-13 12:00:01:INFO:TRAIN-(cmcm) (3/4/5)>> loss: 0.8916
2024-06-13 12:00:04:INFO:VAL-(cmcm) >>
2024-06-13 12:00:04:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5381  Non0_acc_2: 0.5694  Non0_F1_score: 0.5167  Mult_acc_5: 0.1747  Mult_acc_7: 0.1703  MAE: 1.4774  Corr: 0.0544 
2024-06-13 12:00:25:INFO:TRAIN-(cmcm) (4/5/5)>> loss: 0.8883
2024-06-13 12:00:29:INFO:VAL-(cmcm) >>
2024-06-13 12:00:29:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5219  Non0_acc_2: 0.5694  Non0_F1_score: 0.4966  Mult_acc_5: 0.1790  Mult_acc_7: 0.1790  MAE: 1.6484  Corr: -0.0271 
2024-06-13 12:00:50:INFO:TRAIN-(cmcm) (5/6/5)>> loss: 0.8682
2024-06-13 12:00:54:INFO:VAL-(cmcm) >>
2024-06-13 12:00:54:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4723  Non0_acc_2: 0.5787  Non0_F1_score: 0.4445  Mult_acc_5: 0.2445  Mult_acc_7: 0.1747  MAE: 1.5991  Corr: 0.0135 
2024-06-13 12:01:15:INFO:TRAIN-(cmcm) (6/7/5)>> loss: 0.8655
2024-06-13 12:01:18:INFO:VAL-(cmcm) >>
2024-06-13 12:01:18:INFO:M: >>  Has0_acc_2: 0.6245  Has0_F1_score: 0.5168  Non0_acc_2: 0.6019  Non0_F1_score: 0.4913  Mult_acc_5: 0.2838  Mult_acc_7: 0.2227  MAE: 1.5794  Corr: 0.1461 
2024-06-13 12:01:39:INFO:TRAIN-(cmcm) (7/8/5)>> loss: 0.8651
2024-06-13 12:01:43:INFO:VAL-(cmcm) >>
2024-06-13 12:01:43:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.4788  Non0_acc_2: 0.5556  Non0_F1_score: 0.4513  Mult_acc_5: 0.2882  Mult_acc_7: 0.2096  MAE: 1.7774  Corr: -0.0288 
2024-06-13 12:02:01:INFO:TRAIN-(cmcm) (8/9/5)>> loss: 0.8627
2024-06-13 12:02:05:INFO:VAL-(cmcm) >>
2024-06-13 12:02:05:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5081  Non0_acc_2: 0.5741  Non0_F1_score: 0.4902  Mult_acc_5: 0.3275  Mult_acc_7: 0.2489  MAE: 1.6097  Corr: 0.0284 
2024-06-13 12:02:26:INFO:TRAIN-(cmcm) (9/10/5)>> loss: 0.8581
2024-06-13 12:02:30:INFO:VAL-(cmcm) >>
2024-06-13 12:02:30:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.4956  Non0_acc_2: 0.5463  Non0_F1_score: 0.4764  Mult_acc_5: 0.2795  Mult_acc_7: 0.2009  MAE: 1.6678  Corr: 0.0095 
2024-06-13 12:02:51:INFO:TRAIN-(cmcm) (10/11/5)>> loss: 0.8509
2024-06-13 12:02:54:INFO:VAL-(cmcm) >>
2024-06-13 12:02:54:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.6029  Non0_acc_2: 0.6204  Non0_F1_score: 0.6159  Mult_acc_5: 0.3275  Mult_acc_7: 0.2707  MAE: 1.3922  Corr: 0.2289 
2024-06-13 12:02:55:INFO:Saving checkpoint at epoch 11 to results/models/cmcm-mosi-regression.pth.
2024-06-13 12:03:16:INFO:TRAIN-(cmcm) (1/12/5)>> loss: 0.8424
2024-06-13 12:03:20:INFO:VAL-(cmcm) >>
2024-06-13 12:03:20:INFO:M: >>  Has0_acc_2: 0.6550  Has0_F1_score: 0.6497  Non0_acc_2: 0.6528  Non0_F1_score: 0.6462  Mult_acc_5: 0.3362  Mult_acc_7: 0.2533  MAE: 1.4717  Corr: 0.2551 
2024-06-13 12:03:41:INFO:TRAIN-(cmcm) (2/13/5)>> loss: 0.8439
2024-06-13 12:03:45:INFO:VAL-(cmcm) >>
2024-06-13 12:03:45:INFO:M: >>  Has0_acc_2: 0.6507  Has0_F1_score: 0.5975  Non0_acc_2: 0.6343  Non0_F1_score: 0.5797  Mult_acc_5: 0.2969  Mult_acc_7: 0.2271  MAE: 1.4656  Corr: 0.2558 
2024-06-13 12:04:06:INFO:TRAIN-(cmcm) (3/14/5)>> loss: 0.8317
2024-06-13 12:04:09:INFO:VAL-(cmcm) >>
2024-06-13 12:04:09:INFO:M: >>  Has0_acc_2: 0.6638  Has0_F1_score: 0.6651  Non0_acc_2: 0.6528  Non0_F1_score: 0.6547  Mult_acc_5: 0.3362  Mult_acc_7: 0.2751  MAE: 1.3254  Corr: 0.3381 
2024-06-13 12:04:09:INFO:Saving checkpoint at epoch 14 to results/models/cmcm-mosi-regression.pth.
2024-06-13 12:04:31:INFO:TRAIN-(cmcm) (1/15/5)>> loss: 0.8146
2024-06-13 12:04:34:INFO:VAL-(cmcm) >>
2024-06-13 12:04:34:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.5873  Non0_acc_2: 0.6389  Non0_F1_score: 0.6211  Mult_acc_5: 0.2445  Mult_acc_7: 0.1965  MAE: 1.4992  Corr: 0.3823 
2024-06-13 12:04:56:INFO:TRAIN-(cmcm) (2/16/5)>> loss: 0.8054
2024-06-13 12:04:59:INFO:VAL-(cmcm) >>
2024-06-13 12:04:59:INFO:M: >>  Has0_acc_2: 0.6725  Has0_F1_score: 0.6178  Non0_acc_2: 0.6898  Non0_F1_score: 0.6674  Mult_acc_5: 0.3712  Mult_acc_7: 0.2926  MAE: 1.2359  Corr: 0.4358 
2024-06-13 12:04:59:INFO:Saving checkpoint at epoch 16 to results/models/cmcm-mosi-regression.pth.
2024-06-13 12:05:21:INFO:TRAIN-(cmcm) (1/17/5)>> loss: 0.8039
2024-06-13 12:05:25:INFO:VAL-(cmcm) >>
2024-06-13 12:05:25:INFO:M: >>  Has0_acc_2: 0.6812  Has0_F1_score: 0.6832  Non0_acc_2: 0.6204  Non0_F1_score: 0.6198  Mult_acc_5: 0.2969  Mult_acc_7: 0.2402  MAE: 1.2708  Corr: 0.4037 
2024-06-13 12:05:46:INFO:TRAIN-(cmcm) (2/18/5)>> loss: 0.7820
2024-06-13 12:05:49:INFO:VAL-(cmcm) >>
2024-06-13 12:05:49:INFO:M: >>  Has0_acc_2: 0.6900  Has0_F1_score: 0.6637  Non0_acc_2: 0.6852  Non0_F1_score: 0.6594  Mult_acc_5: 0.3537  Mult_acc_7: 0.2533  MAE: 1.3691  Corr: 0.4071 
2024-06-13 12:06:10:INFO:TRAIN-(cmcm) (3/19/5)>> loss: 0.7827
2024-06-13 12:06:14:INFO:VAL-(cmcm) >>
2024-06-13 12:06:14:INFO:M: >>  Has0_acc_2: 0.6943  Has0_F1_score: 0.6943  Non0_acc_2: 0.6991  Non0_F1_score: 0.6989  Mult_acc_5: 0.3537  Mult_acc_7: 0.2969  MAE: 1.2193  Corr: 0.4188 
2024-06-13 12:06:14:INFO:Saving checkpoint at epoch 19 to results/models/cmcm-mosi-regression.pth.
2024-06-13 12:06:36:INFO:TRAIN-(cmcm) (1/20/5)>> loss: 0.7720
2024-06-13 12:06:39:INFO:VAL-(cmcm) >>
2024-06-13 12:06:39:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.5342  Non0_acc_2: 0.5417  Non0_F1_score: 0.4847  Mult_acc_5: 0.2402  Mult_acc_7: 0.2183  MAE: 1.5132  Corr: 0.2839 
2024-06-13 12:07:00:INFO:TRAIN-(cmcm) (2/21/5)>> loss: 0.7714
2024-06-13 12:07:04:INFO:VAL-(cmcm) >>
2024-06-13 12:07:04:INFO:M: >>  Has0_acc_2: 0.6376  Has0_F1_score: 0.6318  Non0_acc_2: 0.5694  Non0_F1_score: 0.5385  Mult_acc_5: 0.2751  Mult_acc_7: 0.2314  MAE: 1.3682  Corr: 0.3736 
2024-06-13 12:07:25:INFO:TRAIN-(cmcm) (3/22/5)>> loss: 0.7554
2024-06-13 12:07:29:INFO:VAL-(cmcm) >>
2024-06-13 12:07:29:INFO:M: >>  Has0_acc_2: 0.7031  Has0_F1_score: 0.7019  Non0_acc_2: 0.5787  Non0_F1_score: 0.5686  Mult_acc_5: 0.3100  Mult_acc_7: 0.2620  MAE: 1.2608  Corr: 0.3724 
2024-06-13 12:07:49:INFO:TRAIN-(cmcm) (4/23/5)>> loss: 0.7411
2024-06-13 12:07:53:INFO:VAL-(cmcm) >>
2024-06-13 12:07:53:INFO:M: >>  Has0_acc_2: 0.6681  Has0_F1_score: 0.6644  Non0_acc_2: 0.6759  Non0_F1_score: 0.6743  Mult_acc_5: 0.3755  Mult_acc_7: 0.2926  MAE: 1.2429  Corr: 0.4223 
2024-06-13 12:08:12:INFO:TRAIN-(cmcm) (5/24/5)>> loss: 0.7417
2024-06-13 12:08:15:INFO:VAL-(cmcm) >>
2024-06-13 12:08:15:INFO:M: >>  Has0_acc_2: 0.7031  Has0_F1_score: 0.6971  Non0_acc_2: 0.6991  Non0_F1_score: 0.6973  Mult_acc_5: 0.3668  Mult_acc_7: 0.2620  MAE: 1.2721  Corr: 0.4376 
2024-06-13 12:08:30:INFO:TRAIN-(cmcm) (6/25/5)>> loss: 0.7291
2024-06-13 12:08:32:INFO:VAL-(cmcm) >>
2024-06-13 12:08:32:INFO:M: >>  Has0_acc_2: 0.7336  Has0_F1_score: 0.7329  Non0_acc_2: 0.6898  Non0_F1_score: 0.6910  Mult_acc_5: 0.2882  Mult_acc_7: 0.2314  MAE: 1.1787  Corr: 0.4899 
2024-06-13 12:08:33:INFO:Saving checkpoint at epoch 25 to results/models/cmcm-mosi-regression.pth.
2024-06-13 12:08:48:INFO:TRAIN-(cmcm) (1/26/5)>> loss: 0.7206
2024-06-13 12:08:51:INFO:VAL-(cmcm) >>
2024-06-13 12:08:51:INFO:M: >>  Has0_acc_2: 0.6681  Has0_F1_score: 0.6713  Non0_acc_2: 0.6620  Non0_F1_score: 0.6637  Mult_acc_5: 0.3057  Mult_acc_7: 0.2314  MAE: 1.3346  Corr: 0.4100 
2024-06-13 12:09:06:INFO:TRAIN-(cmcm) (2/27/5)>> loss: 0.7139
2024-06-13 12:09:08:INFO:VAL-(cmcm) >>
2024-06-13 12:09:08:INFO:M: >>  Has0_acc_2: 0.6856  Has0_F1_score: 0.6874  Non0_acc_2: 0.6620  Non0_F1_score: 0.6633  Mult_acc_5: 0.3231  Mult_acc_7: 0.2576  MAE: 1.1931  Corr: 0.4836 
2024-06-13 12:09:23:INFO:TRAIN-(cmcm) (3/28/5)>> loss: 0.6954
2024-06-13 12:09:26:INFO:VAL-(cmcm) >>
2024-06-13 12:09:26:INFO:M: >>  Has0_acc_2: 0.7205  Has0_F1_score: 0.7194  Non0_acc_2: 0.7315  Non0_F1_score: 0.7306  Mult_acc_5: 0.3581  Mult_acc_7: 0.2620  MAE: 1.2084  Corr: 0.4732 
2024-06-13 12:09:41:INFO:TRAIN-(cmcm) (4/29/5)>> loss: 0.6877
2024-06-13 12:09:43:INFO:VAL-(cmcm) >>
2024-06-13 12:09:43:INFO:M: >>  Has0_acc_2: 0.6769  Has0_F1_score: 0.6800  Non0_acc_2: 0.6620  Non0_F1_score: 0.6635  Mult_acc_5: 0.3188  Mult_acc_7: 0.2489  MAE: 1.2791  Corr: 0.4338 
2024-06-13 12:09:58:INFO:TRAIN-(cmcm) (5/30/5)>> loss: 0.6819
2024-06-13 12:10:01:INFO:VAL-(cmcm) >>
2024-06-13 12:10:01:INFO:M: >>  Has0_acc_2: 0.6943  Has0_F1_score: 0.6972  Non0_acc_2: 0.6667  Non0_F1_score: 0.6671  Mult_acc_5: 0.2926  Mult_acc_7: 0.2358  MAE: 1.3132  Corr: 0.4383 
2024-06-13 12:10:16:INFO:TRAIN-(cmcm) (6/31/5)>> loss: 0.6684
2024-06-13 12:10:18:INFO:VAL-(cmcm) >>
2024-06-13 12:10:18:INFO:M: >>  Has0_acc_2: 0.7031  Has0_F1_score: 0.7031  Non0_acc_2: 0.7083  Non0_F1_score: 0.7089  Mult_acc_5: 0.3362  Mult_acc_7: 0.2533  MAE: 1.2747  Corr: 0.4652 
2024-06-13 12:10:33:INFO:TRAIN-(cmcm) (7/32/5)>> loss: 0.6612
2024-06-13 12:10:36:INFO:VAL-(cmcm) >>
2024-06-13 12:10:36:INFO:M: >>  Has0_acc_2: 0.7031  Has0_F1_score: 0.7053  Non0_acc_2: 0.7176  Non0_F1_score: 0.7191  Mult_acc_5: 0.3362  Mult_acc_7: 0.2751  MAE: 1.2376  Corr: 0.4561 
2024-06-13 12:10:51:INFO:TRAIN-(cmcm) (8/33/5)>> loss: 0.6538
2024-06-13 12:10:53:INFO:VAL-(cmcm) >>
2024-06-13 12:10:53:INFO:M: >>  Has0_acc_2: 0.6900  Has0_F1_score: 0.6930  Non0_acc_2: 0.6944  Non0_F1_score: 0.6961  Mult_acc_5: 0.3493  Mult_acc_7: 0.2882  MAE: 1.2437  Corr: 0.4525 
2024-06-13 12:11:08:INFO:TRAIN-(cmcm) (9/34/5)>> loss: 0.6372
2024-06-13 12:11:11:INFO:VAL-(cmcm) >>
2024-06-13 12:11:11:INFO:M: >>  Has0_acc_2: 0.6638  Has0_F1_score: 0.6670  Non0_acc_2: 0.6806  Non0_F1_score: 0.6821  Mult_acc_5: 0.3537  Mult_acc_7: 0.2882  MAE: 1.2656  Corr: 0.4443 
2024-06-13 12:11:25:INFO:TRAIN-(cmcm) (10/35/5)>> loss: 0.6318
2024-06-13 12:11:28:INFO:VAL-(cmcm) >>
2024-06-13 12:11:28:INFO:M: >>  Has0_acc_2: 0.6987  Has0_F1_score: 0.7016  Non0_acc_2: 0.7037  Non0_F1_score: 0.7052  Mult_acc_5: 0.3624  Mult_acc_7: 0.2969  MAE: 1.2044  Corr: 0.4772 
2024-06-13 12:11:35:INFO:TEST-(cmcm) >>
2024-06-13 12:11:35:INFO:M: >>  Has0_acc_2: 0.6735  Has0_F1_score: 0.6725  Non0_acc_2: 0.6860  Non0_F1_score: 0.6879  Mult_acc_5: 0.3134  Mult_acc_7: 0.2799  MAE: 1.2121  Corr: 0.4374 
2024-06-13 12:11:36:INFO:Results are added to results/results/mosi-regression-40.csv...
2024-06-13 12:11:36:INFO:Start running cmcm...
2024-06-13 12:11:36:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 6, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 50, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-06-13 12:11:36:INFO:Let's use the GPU 1 !
2024-06-13 12:11:36:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 12:11:36:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718251896 HTTP/1.1" 200 235
2024-06-13 12:11:37:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 12:11:37:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 12:11:38:INFO:train samples: (1284,)
2024-06-13 12:11:38:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 12:11:38:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718251898 HTTP/1.1" 200 235
2024-06-13 12:11:39:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 12:11:39:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 12:11:40:INFO:valid samples: (229,)
2024-06-13 12:11:40:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 12:11:40:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718251900 HTTP/1.1" 200 235
2024-06-13 12:11:40:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 12:11:41:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 12:11:42:INFO:test samples: (686,)
2024-06-13 12:11:42:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 12:11:42:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718251902 HTTP/1.1" 200 235
2024-06-13 12:11:42:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 12:11:43:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 12:11:43:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 12:11:44:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718251904 HTTP/1.1" 200 235
2024-06-13 12:11:44:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 12:11:45:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 12:11:45:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-13 12:11:45:WARNING:Try importing flash-attention for faster inference...
2024-06-13 12:11:45:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-13 12:11:45:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-13 12:11:45:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-13 12:11:46:INFO:trainable params: 1310288 || all params: 1838138960 || trainable%: 0.07128340286090232
2024-06-13 12:11:46:INFO:Init labels...
2024-06-13 12:11:46:INFO:Start training...
2024-06-13 12:12:01:INFO:TRAIN-(cmcm) (1/1/1)>> loss: 3.3728
2024-06-13 12:12:03:INFO:VAL-(cmcm) >>
2024-06-13 12:12:03:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4213  Non0_F1_score: 0.2824  Mult_acc_5: 0.2052  Mult_acc_7: 0.2052  MAE: 1.4467  Corr: -0.0080 
2024-06-13 12:12:04:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-13 12:12:19:INFO:TRAIN-(cmcm) (1/2/1)>> loss: 1.0000
2024-06-13 12:12:22:INFO:VAL-(cmcm) >>
2024-06-13 12:12:22:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4855  Non0_acc_2: 0.5787  Non0_F1_score: 0.4584  Mult_acc_5: 0.2445  Mult_acc_7: 0.2140  MAE: 1.6432  Corr: -0.0244 
2024-06-13 12:12:36:INFO:TRAIN-(cmcm) (2/3/1)>> loss: 0.8931
2024-06-13 12:12:39:INFO:VAL-(cmcm) >>
2024-06-13 12:12:39:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5741  Non0_F1_score: 0.4187  Mult_acc_5: 0.1747  Mult_acc_7: 0.1747  MAE: 1.5244  Corr: -0.0152 
2024-06-13 12:12:54:INFO:TRAIN-(cmcm) (3/4/1)>> loss: 0.8847
2024-06-13 12:12:57:INFO:VAL-(cmcm) >>
2024-06-13 12:12:57:INFO:M: >>  Has0_acc_2: 0.4803  Has0_F1_score: 0.4531  Non0_acc_2: 0.4259  Non0_F1_score: 0.2544  Mult_acc_5: 0.1616  Mult_acc_7: 0.1616  MAE: 1.5811  Corr: 0.0680 
2024-06-13 12:13:11:INFO:TRAIN-(cmcm) (4/5/1)>> loss: 0.8812
2024-06-13 12:13:14:INFO:VAL-(cmcm) >>
2024-06-13 12:13:14:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5129  Non0_acc_2: 0.5648  Non0_F1_score: 0.4934  Mult_acc_5: 0.1747  Mult_acc_7: 0.1747  MAE: 1.5803  Corr: -0.0472 
2024-06-13 12:13:29:INFO:TRAIN-(cmcm) (5/6/1)>> loss: 0.8729
2024-06-13 12:13:31:INFO:VAL-(cmcm) >>
2024-06-13 12:13:31:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.4870  Non0_acc_2: 0.5694  Non0_F1_score: 0.4655  Mult_acc_5: 0.3013  Mult_acc_7: 0.2140  MAE: 1.7337  Corr: 0.0366 
2024-06-13 12:13:46:INFO:TRAIN-(cmcm) (6/7/1)>> loss: 0.8623
2024-06-13 12:13:49:INFO:VAL-(cmcm) >>
2024-06-13 12:13:49:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.5204  Non0_acc_2: 0.5787  Non0_F1_score: 0.4982  Mult_acc_5: 0.2926  Mult_acc_7: 0.2096  MAE: 1.7957  Corr: 0.0446 
2024-06-13 12:14:04:INFO:TRAIN-(cmcm) (7/8/1)>> loss: 0.8621
2024-06-13 12:14:06:INFO:VAL-(cmcm) >>
2024-06-13 12:14:06:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5247  Non0_acc_2: 0.5648  Non0_F1_score: 0.5059  Mult_acc_5: 0.2402  Mult_acc_7: 0.1878  MAE: 1.6276  Corr: 0.0099 
2024-06-13 12:14:21:INFO:TRAIN-(cmcm) (8/9/1)>> loss: 0.8598
2024-06-13 12:14:24:INFO:VAL-(cmcm) >>
2024-06-13 12:14:24:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.4968  Non0_acc_2: 0.5556  Non0_F1_score: 0.4731  Mult_acc_5: 0.1616  Mult_acc_7: 0.1616  MAE: 1.5680  Corr: -0.0052 
2024-06-13 12:14:38:INFO:TRAIN-(cmcm) (9/10/1)>> loss: 0.8570
2024-06-13 12:14:41:INFO:VAL-(cmcm) >>
2024-06-13 12:14:41:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5315  Non0_acc_2: 0.5648  Non0_F1_score: 0.5201  Mult_acc_5: 0.2795  Mult_acc_7: 0.2009  MAE: 1.7298  Corr: 0.0325 
2024-06-13 12:14:56:INFO:TRAIN-(cmcm) (10/11/1)>> loss: 0.8629
2024-06-13 12:14:58:INFO:VAL-(cmcm) >>
2024-06-13 12:14:58:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.5187  Non0_acc_2: 0.5509  Non0_F1_score: 0.4996  Mult_acc_5: 0.2751  Mult_acc_7: 0.1878  MAE: 1.8573  Corr: -0.0052 
2024-06-13 12:15:06:INFO:TEST-(cmcm) >>
2024-06-13 12:15:06:INFO:M: >>  Has0_acc_2: 0.4475  Has0_F1_score: 0.2767  Non0_acc_2: 0.5427  Non0_F1_score: 0.4356  Mult_acc_5: 0.1501  Mult_acc_7: 0.1501  MAE: 1.4643  Corr: -0.0968 
2024-06-13 12:15:06:INFO:Results are added to results/results/mosi-regression-50.csv...
2024-06-13 12:15:06:INFO:Start running cmcm...
2024-06-13 12:15:06:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 6, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 50, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 2222}>
2024-06-13 12:15:06:INFO:Let's use the GPU 1 !
2024-06-13 12:15:06:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 12:15:07:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718252107 HTTP/1.1" 200 235
2024-06-13 12:15:07:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 12:15:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 12:15:09:INFO:train samples: (1284,)
2024-06-13 12:15:09:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 12:15:09:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718252109 HTTP/1.1" 200 235
2024-06-13 12:15:09:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 12:15:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 12:15:10:INFO:valid samples: (229,)
2024-06-13 12:15:11:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 12:15:11:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718252111 HTTP/1.1" 200 235
2024-06-13 12:15:11:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 12:15:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 12:15:12:INFO:test samples: (686,)
2024-06-13 12:15:12:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 12:15:13:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718252113 HTTP/1.1" 200 235
2024-06-13 12:15:13:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 12:15:14:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 12:15:14:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 12:15:14:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718252114 HTTP/1.1" 200 235
2024-06-13 12:15:15:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 12:15:15:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 12:15:15:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-13 12:15:15:WARNING:Try importing flash-attention for faster inference...
2024-06-13 12:15:15:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-13 12:15:15:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-13 12:15:15:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-13 12:15:16:INFO:trainable params: 1310288 || all params: 1838138960 || trainable%: 0.07128340286090232
2024-06-13 12:15:16:INFO:Init labels...
2024-06-13 12:15:16:INFO:Start training...
2024-06-13 12:15:31:INFO:TRAIN-(cmcm) (1/1/2)>> loss: 3.4269
2024-06-13 12:15:34:INFO:VAL-(cmcm) >>
2024-06-13 12:15:34:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.4864  Non0_acc_2: 0.5417  Non0_F1_score: 0.4688  Mult_acc_5: 0.1965  Mult_acc_7: 0.1747  MAE: 1.5520  Corr: -0.0549 
2024-06-13 12:15:34:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-13 12:15:49:INFO:TRAIN-(cmcm) (1/2/2)>> loss: 1.0983
2024-06-13 12:15:52:INFO:VAL-(cmcm) >>
2024-06-13 12:15:52:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4978  Non0_acc_2: 0.5741  Non0_F1_score: 0.4742  Mult_acc_5: 0.1878  Mult_acc_7: 0.1878  MAE: 1.4781  Corr: 0.0149 
2024-06-13 12:15:52:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-13 12:16:08:INFO:TRAIN-(cmcm) (1/3/2)>> loss: 0.9641
2024-06-13 12:16:10:INFO:VAL-(cmcm) >>
2024-06-13 12:16:10:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.4653  Non0_acc_2: 0.5602  Non0_F1_score: 0.4540  Mult_acc_5: 0.1616  Mult_acc_7: 0.1616  MAE: 1.4554  Corr: -0.0390 
2024-06-13 12:16:11:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-mosi-regression.pth.
2024-06-13 12:16:26:INFO:TRAIN-(cmcm) (1/4/2)>> loss: 0.9380
2024-06-13 12:16:28:INFO:VAL-(cmcm) >>
2024-06-13 12:16:28:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.4629  Non0_acc_2: 0.5602  Non0_F1_score: 0.4346  Mult_acc_5: 0.2009  Mult_acc_7: 0.1747  MAE: 1.5881  Corr: -0.0374 
2024-06-13 12:16:43:INFO:TRAIN-(cmcm) (2/5/2)>> loss: 0.9197
2024-06-13 12:16:46:INFO:VAL-(cmcm) >>
2024-06-13 12:16:46:INFO:M: >>  Has0_acc_2: 0.5240  Has0_F1_score: 0.5236  Non0_acc_2: 0.5231  Non0_F1_score: 0.5203  Mult_acc_5: 0.2140  Mult_acc_7: 0.1397  MAE: 1.9127  Corr: -0.0285 
2024-06-13 12:17:01:INFO:TRAIN-(cmcm) (3/6/2)>> loss: 0.9153
2024-06-13 12:17:03:INFO:VAL-(cmcm) >>
2024-06-13 12:17:03:INFO:M: >>  Has0_acc_2: 0.5459  Has0_F1_score: 0.5282  Non0_acc_2: 0.5370  Non0_F1_score: 0.5169  Mult_acc_5: 0.1659  Mult_acc_7: 0.1659  MAE: 1.5440  Corr: 0.0215 
2024-06-13 12:17:18:INFO:TRAIN-(cmcm) (4/7/2)>> loss: 0.9039
2024-06-13 12:17:21:INFO:VAL-(cmcm) >>
2024-06-13 12:17:21:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.5382  Non0_acc_2: 0.5648  Non0_F1_score: 0.5168  Mult_acc_5: 0.2795  Mult_acc_7: 0.2096  MAE: 1.7809  Corr: 0.0013 
2024-06-13 12:17:35:INFO:TRAIN-(cmcm) (5/8/2)>> loss: 0.8863
2024-06-13 12:17:38:INFO:VAL-(cmcm) >>
2024-06-13 12:17:38:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.5166  Non0_acc_2: 0.5833  Non0_F1_score: 0.4911  Mult_acc_5: 0.1834  Mult_acc_7: 0.1572  MAE: 1.6270  Corr: -0.0515 
2024-06-13 12:17:53:INFO:TRAIN-(cmcm) (6/9/2)>> loss: 0.8776
2024-06-13 12:17:55:INFO:VAL-(cmcm) >>
2024-06-13 12:17:55:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.4653  Non0_acc_2: 0.5648  Non0_F1_score: 0.4371  Mult_acc_5: 0.2576  Mult_acc_7: 0.1790  MAE: 1.7451  Corr: -0.0177 
2024-06-13 12:18:10:INFO:TRAIN-(cmcm) (7/10/2)>> loss: 0.8743
2024-06-13 12:18:13:INFO:VAL-(cmcm) >>
2024-06-13 12:18:13:INFO:M: >>  Has0_acc_2: 0.5240  Has0_F1_score: 0.5137  Non0_acc_2: 0.5139  Non0_F1_score: 0.5015  Mult_acc_5: 0.2402  Mult_acc_7: 0.1878  MAE: 1.8039  Corr: -0.0111 
2024-06-13 12:18:28:INFO:TRAIN-(cmcm) (8/11/2)>> loss: 0.8690
2024-06-13 12:18:30:INFO:VAL-(cmcm) >>
2024-06-13 12:18:30:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.4513  Non0_acc_2: 0.5278  Non0_F1_score: 0.5166  Mult_acc_5: 0.1921  Mult_acc_7: 0.1878  MAE: 1.4641  Corr: -0.0524 
2024-06-13 12:18:45:INFO:TRAIN-(cmcm) (9/12/2)>> loss: 0.8627
2024-06-13 12:18:48:INFO:VAL-(cmcm) >>
2024-06-13 12:18:48:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5410  Non0_acc_2: 0.5694  Non0_F1_score: 0.5268  Mult_acc_5: 0.2314  Mult_acc_7: 0.2009  MAE: 1.5659  Corr: 0.0385 
2024-06-13 12:19:03:INFO:TRAIN-(cmcm) (10/13/2)>> loss: 0.8583
2024-06-13 12:19:05:INFO:VAL-(cmcm) >>
2024-06-13 12:19:05:INFO:M: >>  Has0_acc_2: 0.5240  Has0_F1_score: 0.5272  Non0_acc_2: 0.5324  Non0_F1_score: 0.5338  Mult_acc_5: 0.2009  Mult_acc_7: 0.1659  MAE: 1.7453  Corr: 0.0608 
2024-06-13 12:19:13:INFO:TEST-(cmcm) >>
2024-06-13 12:19:13:INFO:M: >>  Has0_acc_2: 0.4577  Has0_F1_score: 0.3215  Non0_acc_2: 0.4497  Non0_F1_score: 0.3374  Mult_acc_5: 0.1706  Mult_acc_7: 0.1691  MAE: 1.6347  Corr: -0.0069 
2024-06-13 12:19:13:INFO:Results are added to results/results/mosi-regression-50.csv...
2024-06-13 12:19:13:INFO:Start running cmcm...
2024-06-13 12:19:13:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 6, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 50, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 3333}>
2024-06-13 12:19:13:INFO:Let's use the GPU 1 !
2024-06-13 12:19:13:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 12:19:13:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718252354 HTTP/1.1" 200 235
2024-06-13 12:19:14:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 12:19:14:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 12:19:15:INFO:train samples: (1284,)
2024-06-13 12:19:15:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 12:19:15:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718252356 HTTP/1.1" 200 235
2024-06-13 12:19:16:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 12:19:16:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 12:19:17:INFO:valid samples: (229,)
2024-06-13 12:19:17:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 12:19:17:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718252358 HTTP/1.1" 200 235
2024-06-13 12:19:18:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 12:19:18:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 12:19:19:INFO:test samples: (686,)
2024-06-13 12:19:19:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 12:19:19:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718252359 HTTP/1.1" 200 235
2024-06-13 12:19:19:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 12:19:20:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 12:19:20:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 12:19:21:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718252361 HTTP/1.1" 200 235
2024-06-13 12:19:21:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 12:19:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 12:19:22:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-13 12:19:22:WARNING:Try importing flash-attention for faster inference...
2024-06-13 12:19:22:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-13 12:19:22:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-13 12:19:22:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-13 12:19:23:INFO:trainable params: 1310288 || all params: 1838138960 || trainable%: 0.07128340286090232
2024-06-13 12:19:23:INFO:Init labels...
2024-06-13 12:19:23:INFO:Start training...
2024-06-13 12:19:38:INFO:TRAIN-(cmcm) (1/1/3)>> loss: 3.7343
2024-06-13 12:19:40:INFO:VAL-(cmcm) >>
2024-06-13 12:19:40:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4556  Non0_acc_2: 0.5833  Non0_F1_score: 0.4542  Mult_acc_5: 0.3013  Mult_acc_7: 0.1485  MAE: 2.2713  Corr: 0.1197 
2024-06-13 12:19:41:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-13 12:19:56:INFO:TRAIN-(cmcm) (1/2/3)>> loss: 1.0477
2024-06-13 12:19:59:INFO:VAL-(cmcm) >>
2024-06-13 12:19:59:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5109  Non0_acc_2: 0.5509  Non0_F1_score: 0.4921  Mult_acc_5: 0.2227  Mult_acc_7: 0.1703  MAE: 1.7966  Corr: -0.0346 
2024-06-13 12:20:00:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-13 12:20:15:INFO:TRAIN-(cmcm) (1/3/3)>> loss: 0.9167
2024-06-13 12:20:17:INFO:VAL-(cmcm) >>
2024-06-13 12:20:17:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.5317  Non0_acc_2: 0.5694  Non0_F1_score: 0.5236  Mult_acc_5: 0.1790  Mult_acc_7: 0.1747  MAE: 1.5139  Corr: 0.0629 
2024-06-13 12:20:18:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-mosi-regression.pth.
2024-06-13 12:20:33:INFO:TRAIN-(cmcm) (1/4/3)>> loss: 1.3536
2024-06-13 12:20:36:INFO:VAL-(cmcm) >>
2024-06-13 12:20:36:INFO:M: >>  Has0_acc_2: 0.4017  Has0_F1_score: 0.2718  Non0_acc_2: 0.4259  Non0_F1_score: 0.2624  Mult_acc_5: 0.1397  Mult_acc_7: 0.1397  MAE: 1.9165  Corr: -0.0477 
2024-06-13 12:20:51:INFO:TRAIN-(cmcm) (2/5/3)>> loss: 0.9134
2024-06-13 12:20:53:INFO:VAL-(cmcm) >>
2024-06-13 12:20:53:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.4968  Non0_acc_2: 0.5880  Non0_F1_score: 0.4703  Mult_acc_5: 0.2096  Mult_acc_7: 0.1965  MAE: 1.4860  Corr: 0.0657 
2024-06-13 12:20:54:INFO:Saving checkpoint at epoch 5 to results/models/cmcm-mosi-regression.pth.
2024-06-13 12:21:09:INFO:TRAIN-(cmcm) (1/6/3)>> loss: 0.8841
2024-06-13 12:21:12:INFO:VAL-(cmcm) >>
2024-06-13 12:21:12:INFO:M: >>  Has0_acc_2: 0.4891  Has0_F1_score: 0.4861  Non0_acc_2: 0.5046  Non0_F1_score: 0.5007  Mult_acc_5: 0.2314  Mult_acc_7: 0.1965  MAE: 1.7873  Corr: -0.0027 
2024-06-13 12:21:26:INFO:TRAIN-(cmcm) (2/7/3)>> loss: 0.8770
2024-06-13 12:21:29:INFO:VAL-(cmcm) >>
2024-06-13 12:21:29:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4978  Non0_acc_2: 0.5741  Non0_F1_score: 0.4742  Mult_acc_5: 0.1703  Mult_acc_7: 0.1703  MAE: 1.4833  Corr: 0.0388 
2024-06-13 12:21:30:INFO:Saving checkpoint at epoch 7 to results/models/cmcm-mosi-regression.pth.
2024-06-13 12:21:45:INFO:TRAIN-(cmcm) (1/8/3)>> loss: 0.8702
2024-06-13 12:21:47:INFO:VAL-(cmcm) >>
2024-06-13 12:21:47:INFO:M: >>  Has0_acc_2: 0.5633  Has0_F1_score: 0.4969  Non0_acc_2: 0.5463  Non0_F1_score: 0.4807  Mult_acc_5: 0.2489  Mult_acc_7: 0.2009  MAE: 1.6012  Corr: 0.0279 
2024-06-13 12:22:02:INFO:TRAIN-(cmcm) (2/9/3)>> loss: 0.8630
2024-06-13 12:22:05:INFO:VAL-(cmcm) >>
2024-06-13 12:22:05:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.5363  Non0_acc_2: 0.5787  Non0_F1_score: 0.5117  Mult_acc_5: 0.3188  Mult_acc_7: 0.2358  MAE: 1.6694  Corr: 0.0514 
2024-06-13 12:22:20:INFO:TRAIN-(cmcm) (3/10/3)>> loss: 0.8579
2024-06-13 12:22:22:INFO:VAL-(cmcm) >>
2024-06-13 12:22:22:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5129  Non0_acc_2: 0.5741  Non0_F1_score: 0.4951  Mult_acc_5: 0.2969  Mult_acc_7: 0.2271  MAE: 1.6519  Corr: 0.0204 
2024-06-13 12:22:37:INFO:TRAIN-(cmcm) (4/11/3)>> loss: 0.8602
2024-06-13 12:22:40:INFO:VAL-(cmcm) >>
2024-06-13 12:22:40:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.4718  Non0_acc_2: 0.5741  Non0_F1_score: 0.4683  Mult_acc_5: 0.2140  Mult_acc_7: 0.1878  MAE: 1.5532  Corr: 0.0192 
2024-06-13 12:22:55:INFO:TRAIN-(cmcm) (5/12/3)>> loss: 0.8504
2024-06-13 12:22:57:INFO:VAL-(cmcm) >>
2024-06-13 12:22:57:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.5704  Non0_acc_2: 0.5741  Non0_F1_score: 0.5758  Mult_acc_5: 0.1790  Mult_acc_7: 0.1703  MAE: 1.5270  Corr: 0.1115 
2024-06-13 12:23:12:INFO:TRAIN-(cmcm) (6/13/3)>> loss: 0.8563
2024-06-13 12:23:14:INFO:VAL-(cmcm) >>
2024-06-13 12:23:14:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5175  Non0_acc_2: 0.5741  Non0_F1_score: 0.4951  Mult_acc_5: 0.1703  Mult_acc_7: 0.1703  MAE: 1.5052  Corr: 0.0566 
2024-06-13 12:23:29:INFO:TRAIN-(cmcm) (7/14/3)>> loss: 0.8497
2024-06-13 12:23:32:INFO:VAL-(cmcm) >>
2024-06-13 12:23:32:INFO:M: >>  Has0_acc_2: 0.6157  Has0_F1_score: 0.5868  Non0_acc_2: 0.6019  Non0_F1_score: 0.5718  Mult_acc_5: 0.2969  Mult_acc_7: 0.2402  MAE: 1.5446  Corr: 0.2018 
2024-06-13 12:23:47:INFO:TRAIN-(cmcm) (8/15/3)>> loss: 0.8518
2024-06-13 12:23:49:INFO:VAL-(cmcm) >>
2024-06-13 12:23:49:INFO:M: >>  Has0_acc_2: 0.6245  Has0_F1_score: 0.5673  Non0_acc_2: 0.6204  Non0_F1_score: 0.5655  Mult_acc_5: 0.3144  Mult_acc_7: 0.2402  MAE: 1.5616  Corr: 0.1920 
2024-06-13 12:24:04:INFO:TRAIN-(cmcm) (9/16/3)>> loss: 0.8482
2024-06-13 12:24:07:INFO:VAL-(cmcm) >>
2024-06-13 12:24:07:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.5602  Non0_acc_2: 0.5833  Non0_F1_score: 0.5436  Mult_acc_5: 0.2795  Mult_acc_7: 0.2140  MAE: 1.6267  Corr: 0.1014 
2024-06-13 12:24:22:INFO:TRAIN-(cmcm) (10/17/3)>> loss: 0.8437
2024-06-13 12:24:24:INFO:VAL-(cmcm) >>
2024-06-13 12:24:24:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5346  Non0_acc_2: 0.5741  Non0_F1_score: 0.5164  Mult_acc_5: 0.2707  Mult_acc_7: 0.1965  MAE: 1.7001  Corr: 0.0763 
2024-06-13 12:24:32:INFO:TEST-(cmcm) >>
2024-06-13 12:24:32:INFO:M: >>  Has0_acc_2: 0.4694  Has0_F1_score: 0.3764  Non0_acc_2: 0.4482  Non0_F1_score: 0.3562  Mult_acc_5: 0.1749  Mult_acc_7: 0.1735  MAE: 1.6893  Corr: 0.0309 
2024-06-13 12:24:32:INFO:Results are added to results/results/mosi-regression-50.csv...
2024-06-13 12:24:32:INFO:Start running cmcm...
2024-06-13 12:24:32:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 6, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 50, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 4444}>
2024-06-13 12:24:32:INFO:Let's use the GPU 1 !
2024-06-13 12:24:32:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 12:24:32:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718252673 HTTP/1.1" 200 235
2024-06-13 12:24:33:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 12:24:33:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 12:24:34:INFO:train samples: (1284,)
2024-06-13 12:24:34:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 12:24:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718252675 HTTP/1.1" 200 235
2024-06-13 12:24:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 12:24:36:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 12:24:36:INFO:valid samples: (229,)
2024-06-13 12:24:36:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 12:24:37:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718252677 HTTP/1.1" 200 235
2024-06-13 12:24:37:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 12:24:38:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 12:24:38:INFO:test samples: (686,)
2024-06-13 12:24:38:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 12:24:39:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718252679 HTTP/1.1" 200 235
2024-06-13 12:24:39:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 12:24:40:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 12:24:40:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 12:24:40:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718252680 HTTP/1.1" 200 235
2024-06-13 12:24:41:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 12:24:41:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 12:24:41:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-13 12:24:41:WARNING:Try importing flash-attention for faster inference...
2024-06-13 12:24:41:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-13 12:24:41:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-13 12:24:41:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-13 12:24:42:INFO:trainable params: 1310288 || all params: 1838138960 || trainable%: 0.07128340286090232
2024-06-13 12:24:42:INFO:Init labels...
2024-06-13 12:24:42:INFO:Start training...
2024-06-13 12:24:57:INFO:TRAIN-(cmcm) (1/1/4)>> loss: 4.1261
2024-06-13 12:25:00:INFO:VAL-(cmcm) >>
2024-06-13 12:25:00:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4259  Non0_F1_score: 0.2544  Mult_acc_5: 0.2140  Mult_acc_7: 0.2140  MAE: 1.4370  Corr: nan 
2024-06-13 12:25:00:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-13 12:25:16:INFO:TRAIN-(cmcm) (1/2/4)>> loss: 1.8814
2024-06-13 12:25:18:INFO:VAL-(cmcm) >>
2024-06-13 12:25:18:INFO:M: >>  Has0_acc_2: 0.5371  Has0_F1_score: 0.5051  Non0_acc_2: 0.5185  Non0_F1_score: 0.4878  Mult_acc_5: 0.1790  Mult_acc_7: 0.1572  MAE: 1.6414  Corr: -0.0378 
2024-06-13 12:25:33:INFO:TRAIN-(cmcm) (2/3/4)>> loss: 1.0111
2024-06-13 12:25:36:INFO:VAL-(cmcm) >>
2024-06-13 12:25:36:INFO:M: >>  Has0_acc_2: 0.5284  Has0_F1_score: 0.5174  Non0_acc_2: 0.5231  Non0_F1_score: 0.5110  Mult_acc_5: 0.2314  Mult_acc_7: 0.1659  MAE: 1.6900  Corr: 0.0063 
2024-06-13 12:25:50:INFO:TRAIN-(cmcm) (3/4/4)>> loss: 0.9266
2024-06-13 12:25:53:INFO:VAL-(cmcm) >>
2024-06-13 12:25:53:INFO:M: >>  Has0_acc_2: 0.5502  Has0_F1_score: 0.5494  Non0_acc_2: 0.5648  Non0_F1_score: 0.5627  Mult_acc_5: 0.1921  Mult_acc_7: 0.1659  MAE: 1.5455  Corr: 0.1882 
2024-06-13 12:26:08:INFO:TRAIN-(cmcm) (4/5/4)>> loss: 1.5934
2024-06-13 12:26:10:INFO:VAL-(cmcm) >>
2024-06-13 12:26:10:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4950  Non0_acc_2: 0.5741  Non0_F1_score: 0.4683  Mult_acc_5: 0.2096  Mult_acc_7: 0.2096  MAE: 1.4694  Corr: 0.0327 
2024-06-13 12:26:25:INFO:TRAIN-(cmcm) (5/6/4)>> loss: 0.9158
2024-06-13 12:26:28:INFO:VAL-(cmcm) >>
2024-06-13 12:26:28:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5302  Non0_acc_2: 0.5741  Non0_F1_score: 0.5084  Mult_acc_5: 0.2445  Mult_acc_7: 0.2227  MAE: 1.6467  Corr: 0.0202 
2024-06-13 12:26:43:INFO:TRAIN-(cmcm) (6/7/4)>> loss: 0.8843
2024-06-13 12:26:45:INFO:VAL-(cmcm) >>
2024-06-13 12:26:45:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5741  Non0_F1_score: 0.4187  Mult_acc_5: 0.1703  Mult_acc_7: 0.1703  MAE: 1.5322  Corr: -0.0091 
2024-06-13 12:27:00:INFO:TRAIN-(cmcm) (7/8/4)>> loss: 0.8742
2024-06-13 12:27:03:INFO:VAL-(cmcm) >>
2024-06-13 12:27:03:INFO:M: >>  Has0_acc_2: 0.5590  Has0_F1_score: 0.5427  Non0_acc_2: 0.5556  Non0_F1_score: 0.5362  Mult_acc_5: 0.2620  Mult_acc_7: 0.2140  MAE: 1.6372  Corr: 0.0379 
2024-06-13 12:27:17:INFO:TRAIN-(cmcm) (8/9/4)>> loss: 0.8727
2024-06-13 12:27:20:INFO:VAL-(cmcm) >>
2024-06-13 12:27:20:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.4924  Non0_acc_2: 0.5694  Non0_F1_score: 0.4871  Mult_acc_5: 0.2489  Mult_acc_7: 0.2009  MAE: 1.5807  Corr: 0.0603 
2024-06-13 12:27:35:INFO:TRAIN-(cmcm) (9/10/4)>> loss: 0.8673
2024-06-13 12:27:37:INFO:VAL-(cmcm) >>
2024-06-13 12:27:37:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.5187  Non0_acc_2: 0.5556  Non0_F1_score: 0.5030  Mult_acc_5: 0.2795  Mult_acc_7: 0.2009  MAE: 1.8481  Corr: -0.0279 
2024-06-13 12:27:52:INFO:TRAIN-(cmcm) (10/11/4)>> loss: 0.8592
2024-06-13 12:27:55:INFO:VAL-(cmcm) >>
2024-06-13 12:27:55:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.5975  Non0_acc_2: 0.5926  Non0_F1_score: 0.5905  Mult_acc_5: 0.2926  Mult_acc_7: 0.2314  MAE: 1.5857  Corr: 0.1136 
2024-06-13 12:28:02:INFO:TEST-(cmcm) >>
2024-06-13 12:28:02:INFO:M: >>  Has0_acc_2: 0.4475  Has0_F1_score: 0.2767  Non0_acc_2: 0.5793  Non0_F1_score: 0.4266  Mult_acc_5: 0.1545  Mult_acc_7: 0.1545  MAE: 1.4166  Corr: 0.0461 
2024-06-13 12:28:03:INFO:Results are added to results/results/mosi-regression-50.csv...
2024-06-13 12:28:03:INFO:Start running cmcm...
2024-06-13 12:28:03:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 6, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 50, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 5555}>
2024-06-13 12:28:03:INFO:Let's use the GPU 1 !
2024-06-13 12:28:03:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 12:28:03:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718252883 HTTP/1.1" 200 235
2024-06-13 12:28:04:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 12:28:04:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 12:28:05:INFO:train samples: (1284,)
2024-06-13 12:28:05:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 12:28:05:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718252885 HTTP/1.1" 200 235
2024-06-13 12:28:06:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 12:28:06:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 12:28:07:INFO:valid samples: (229,)
2024-06-13 12:28:07:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 12:28:07:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718252888 HTTP/1.1" 200 235
2024-06-13 12:28:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 12:28:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 12:28:09:INFO:test samples: (686,)
2024-06-13 12:28:09:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 12:28:09:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718252889 HTTP/1.1" 200 235
2024-06-13 12:28:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 12:28:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 12:28:11:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 12:28:11:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718252891 HTTP/1.1" 200 235
2024-06-13 12:28:11:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 12:28:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 12:28:12:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-13 12:28:12:WARNING:Try importing flash-attention for faster inference...
2024-06-13 12:28:12:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-13 12:28:12:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-13 12:28:12:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-13 12:28:13:INFO:trainable params: 1310288 || all params: 1838138960 || trainable%: 0.07128340286090232
2024-06-13 12:28:13:INFO:Init labels...
2024-06-13 12:28:13:INFO:Start training...
2024-06-13 12:28:28:INFO:TRAIN-(cmcm) (1/1/5)>> loss: 3.0210
2024-06-13 12:28:31:INFO:VAL-(cmcm) >>
2024-06-13 12:28:31:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5399  Non0_acc_2: 0.5602  Non0_F1_score: 0.5256  Mult_acc_5: 0.2052  Mult_acc_7: 0.2009  MAE: 1.6266  Corr: 0.0338 
2024-06-13 12:28:31:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-13 12:28:46:INFO:TRAIN-(cmcm) (1/2/5)>> loss: 1.0164
2024-06-13 12:28:49:INFO:VAL-(cmcm) >>
2024-06-13 12:28:49:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.5058  Non0_acc_2: 0.5741  Non0_F1_score: 0.4797  Mult_acc_5: 0.1659  Mult_acc_7: 0.1659  MAE: 1.5271  Corr: 0.0489 
2024-06-13 12:28:49:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-13 12:29:04:INFO:TRAIN-(cmcm) (1/3/5)>> loss: 0.9036
2024-06-13 12:29:07:INFO:VAL-(cmcm) >>
2024-06-13 12:29:07:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4458  Non0_acc_2: 0.5694  Non0_F1_score: 0.4166  Mult_acc_5: 0.1747  Mult_acc_7: 0.1747  MAE: 1.5060  Corr: 0.0371 
2024-06-13 12:29:07:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-mosi-regression.pth.
2024-06-13 12:29:23:INFO:TRAIN-(cmcm) (1/4/5)>> loss: 0.9008
2024-06-13 12:29:25:INFO:VAL-(cmcm) >>
2024-06-13 12:29:25:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4891  Non0_acc_2: 0.5741  Non0_F1_score: 0.4622  Mult_acc_5: 0.1834  Mult_acc_7: 0.1834  MAE: 1.4938  Corr: 0.0158 
2024-06-13 12:29:25:INFO:Saving checkpoint at epoch 4 to results/models/cmcm-mosi-regression.pth.
2024-06-13 12:29:41:INFO:TRAIN-(cmcm) (1/5/5)>> loss: 0.8956
2024-06-13 12:29:43:INFO:VAL-(cmcm) >>
2024-06-13 12:29:43:INFO:M: >>  Has0_acc_2: 0.5459  Has0_F1_score: 0.5117  Non0_acc_2: 0.5278  Non0_F1_score: 0.4921  Mult_acc_5: 0.1659  Mult_acc_7: 0.1659  MAE: 1.7315  Corr: -0.0552 
2024-06-13 12:29:58:INFO:TRAIN-(cmcm) (2/6/5)>> loss: 0.8823
2024-06-13 12:30:01:INFO:VAL-(cmcm) >>
2024-06-13 12:30:01:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5219  Non0_acc_2: 0.5602  Non0_F1_score: 0.5063  Mult_acc_5: 0.3144  Mult_acc_7: 0.2314  MAE: 1.7162  Corr: 0.0143 
2024-06-13 12:30:16:INFO:TRAIN-(cmcm) (3/7/5)>> loss: 0.8685
2024-06-13 12:30:19:INFO:VAL-(cmcm) >>
2024-06-13 12:30:19:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.4730  Non0_acc_2: 0.5602  Non0_F1_score: 0.4540  Mult_acc_5: 0.1921  Mult_acc_7: 0.1921  MAE: 1.5034  Corr: 0.0336 
2024-06-13 12:30:34:INFO:TRAIN-(cmcm) (4/8/5)>> loss: 0.8677
2024-06-13 12:30:36:INFO:VAL-(cmcm) >>
2024-06-13 12:30:36:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.5057  Non0_acc_2: 0.5556  Non0_F1_score: 0.4826  Mult_acc_5: 0.2751  Mult_acc_7: 0.2009  MAE: 1.8149  Corr: -0.0281 
2024-06-13 12:30:51:INFO:TRAIN-(cmcm) (5/9/5)>> loss: 0.8663
2024-06-13 12:30:54:INFO:VAL-(cmcm) >>
2024-06-13 12:30:54:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4805  Non0_acc_2: 0.5694  Non0_F1_score: 0.4713  Mult_acc_5: 0.3057  Mult_acc_7: 0.2227  MAE: 1.7328  Corr: 0.0143 
2024-06-13 12:31:09:INFO:TRAIN-(cmcm) (6/10/5)>> loss: 0.8624
2024-06-13 12:31:11:INFO:VAL-(cmcm) >>
2024-06-13 12:31:11:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.4984  Non0_acc_2: 0.5417  Non0_F1_score: 0.5248  Mult_acc_5: 0.2358  Mult_acc_7: 0.2096  MAE: 1.4790  Corr: 0.0497 
2024-06-13 12:31:12:INFO:Saving checkpoint at epoch 10 to results/models/cmcm-mosi-regression.pth.
2024-06-13 12:31:27:INFO:TRAIN-(cmcm) (1/11/5)>> loss: 0.8537
2024-06-13 12:31:29:INFO:VAL-(cmcm) >>
2024-06-13 12:31:29:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5635  Non0_acc_2: 0.5648  Non0_F1_score: 0.5545  Mult_acc_5: 0.2271  Mult_acc_7: 0.2227  MAE: 1.4785  Corr: 0.0593 
2024-06-13 12:31:30:INFO:Saving checkpoint at epoch 11 to results/models/cmcm-mosi-regression.pth.
2024-06-13 12:31:45:INFO:TRAIN-(cmcm) (1/12/5)>> loss: 0.8562
2024-06-13 12:31:47:INFO:VAL-(cmcm) >>
2024-06-13 12:31:47:INFO:M: >>  Has0_acc_2: 0.5590  Has0_F1_score: 0.5603  Non0_acc_2: 0.5741  Non0_F1_score: 0.5735  Mult_acc_5: 0.2707  Mult_acc_7: 0.2271  MAE: 1.5154  Corr: 0.1636 
2024-06-13 12:32:02:INFO:TRAIN-(cmcm) (2/13/5)>> loss: 0.8417
2024-06-13 12:32:05:INFO:VAL-(cmcm) >>
2024-06-13 12:32:05:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.6075  Non0_acc_2: 0.6065  Non0_F1_score: 0.6013  Mult_acc_5: 0.2969  Mult_acc_7: 0.2358  MAE: 1.6005  Corr: 0.1612 
2024-06-13 12:32:20:INFO:TRAIN-(cmcm) (3/14/5)>> loss: 0.8390
2024-06-13 12:32:22:INFO:VAL-(cmcm) >>
2024-06-13 12:32:22:INFO:M: >>  Has0_acc_2: 0.6550  Has0_F1_score: 0.6475  Non0_acc_2: 0.6528  Non0_F1_score: 0.6482  Mult_acc_5: 0.3406  Mult_acc_7: 0.2926  MAE: 1.3043  Corr: 0.3418 
2024-06-13 12:32:23:INFO:Saving checkpoint at epoch 14 to results/models/cmcm-mosi-regression.pth.
2024-06-13 12:32:38:INFO:TRAIN-(cmcm) (1/15/5)>> loss: 0.8259
2024-06-13 12:32:40:INFO:VAL-(cmcm) >>
2024-06-13 12:32:40:INFO:M: >>  Has0_acc_2: 0.6245  Has0_F1_score: 0.6264  Non0_acc_2: 0.6389  Non0_F1_score: 0.6394  Mult_acc_5: 0.3450  Mult_acc_7: 0.2707  MAE: 1.5232  Corr: 0.3261 
2024-06-13 12:32:55:INFO:TRAIN-(cmcm) (2/16/5)>> loss: 0.8133
2024-06-13 12:32:58:INFO:VAL-(cmcm) >>
2024-06-13 12:32:58:INFO:M: >>  Has0_acc_2: 0.6463  Has0_F1_score: 0.5626  Non0_acc_2: 0.6250  Non0_F1_score: 0.5395  Mult_acc_5: 0.3275  Mult_acc_7: 0.2751  MAE: 1.2638  Corr: 0.4067 
2024-06-13 12:32:58:INFO:Saving checkpoint at epoch 16 to results/models/cmcm-mosi-regression.pth.
2024-06-13 12:33:14:INFO:TRAIN-(cmcm) (1/17/5)>> loss: 0.8111
2024-06-13 12:33:16:INFO:VAL-(cmcm) >>
2024-06-13 12:33:16:INFO:M: >>  Has0_acc_2: 0.6288  Has0_F1_score: 0.6183  Non0_acc_2: 0.6435  Non0_F1_score: 0.6312  Mult_acc_5: 0.2926  Mult_acc_7: 0.2271  MAE: 1.5354  Corr: 0.3684 
2024-06-13 12:33:31:INFO:TRAIN-(cmcm) (2/18/5)>> loss: 0.8010
2024-06-13 12:33:34:INFO:VAL-(cmcm) >>
2024-06-13 12:33:34:INFO:M: >>  Has0_acc_2: 0.6856  Has0_F1_score: 0.6856  Non0_acc_2: 0.7083  Non0_F1_score: 0.7077  Mult_acc_5: 0.3493  Mult_acc_7: 0.2707  MAE: 1.2590  Corr: 0.4698 
2024-06-13 12:33:34:INFO:Saving checkpoint at epoch 18 to results/models/cmcm-mosi-regression.pth.
2024-06-13 12:33:49:INFO:TRAIN-(cmcm) (1/19/5)>> loss: 0.7871
2024-06-13 12:33:52:INFO:VAL-(cmcm) >>
2024-06-13 12:33:52:INFO:M: >>  Has0_acc_2: 0.6376  Has0_F1_score: 0.6406  Non0_acc_2: 0.6435  Non0_F1_score: 0.6371  Mult_acc_5: 0.3144  Mult_acc_7: 0.2489  MAE: 1.2520  Corr: 0.4603 
2024-06-13 12:33:52:INFO:Saving checkpoint at epoch 19 to results/models/cmcm-mosi-regression.pth.
2024-06-13 12:34:07:INFO:TRAIN-(cmcm) (1/20/5)>> loss: 0.7758
2024-06-13 12:34:10:INFO:VAL-(cmcm) >>
2024-06-13 12:34:10:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5744  Non0_acc_2: 0.5880  Non0_F1_score: 0.5535  Mult_acc_5: 0.2664  Mult_acc_7: 0.2140  MAE: 1.4471  Corr: 0.3900 
2024-06-13 12:34:25:INFO:TRAIN-(cmcm) (2/21/5)>> loss: 0.7789
2024-06-13 12:34:28:INFO:VAL-(cmcm) >>
2024-06-13 12:34:28:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5799  Non0_acc_2: 0.5648  Non0_F1_score: 0.5298  Mult_acc_5: 0.2489  Mult_acc_7: 0.1747  MAE: 1.4433  Corr: 0.3796 
2024-06-13 12:34:43:INFO:TRAIN-(cmcm) (3/22/5)>> loss: 0.7625
2024-06-13 12:34:45:INFO:VAL-(cmcm) >>
2024-06-13 12:34:45:INFO:M: >>  Has0_acc_2: 0.6507  Has0_F1_score: 0.6265  Non0_acc_2: 0.6759  Non0_F1_score: 0.6776  Mult_acc_5: 0.3450  Mult_acc_7: 0.2969  MAE: 1.2175  Corr: 0.4275 
2024-06-13 12:34:45:INFO:Saving checkpoint at epoch 22 to results/models/cmcm-mosi-regression.pth.
2024-06-13 12:35:01:INFO:TRAIN-(cmcm) (1/23/5)>> loss: 0.7492
2024-06-13 12:35:03:INFO:VAL-(cmcm) >>
2024-06-13 12:35:03:INFO:M: >>  Has0_acc_2: 0.6681  Has0_F1_score: 0.6704  Non0_acc_2: 0.7083  Non0_F1_score: 0.7096  Mult_acc_5: 0.3493  Mult_acc_7: 0.2707  MAE: 1.2306  Corr: 0.4821 
2024-06-13 12:35:18:INFO:TRAIN-(cmcm) (2/24/5)>> loss: 0.7485
2024-06-13 12:35:21:INFO:VAL-(cmcm) >>
2024-06-13 12:35:21:INFO:M: >>  Has0_acc_2: 0.7031  Has0_F1_score: 0.6998  Non0_acc_2: 0.7593  Non0_F1_score: 0.7596  Mult_acc_5: 0.3886  Mult_acc_7: 0.2926  MAE: 1.1660  Corr: 0.5388 
2024-06-13 12:35:21:INFO:Saving checkpoint at epoch 24 to results/models/cmcm-mosi-regression.pth.
2024-06-13 12:35:36:INFO:TRAIN-(cmcm) (1/25/5)>> loss: 0.7445
2024-06-13 12:35:39:INFO:VAL-(cmcm) >>
2024-06-13 12:35:39:INFO:M: >>  Has0_acc_2: 0.6812  Has0_F1_score: 0.6695  Non0_acc_2: 0.7083  Non0_F1_score: 0.7037  Mult_acc_5: 0.3144  Mult_acc_7: 0.2620  MAE: 1.2018  Corr: 0.4806 
2024-06-13 12:35:53:INFO:TRAIN-(cmcm) (2/26/5)>> loss: 0.7358
2024-06-13 12:35:56:INFO:VAL-(cmcm) >>
2024-06-13 12:35:56:INFO:M: >>  Has0_acc_2: 0.6594  Has0_F1_score: 0.6617  Non0_acc_2: 0.6713  Non0_F1_score: 0.6730  Mult_acc_5: 0.3100  Mult_acc_7: 0.2533  MAE: 1.2346  Corr: 0.4448 
2024-06-13 12:36:11:INFO:TRAIN-(cmcm) (3/27/5)>> loss: 0.7200
2024-06-13 12:36:13:INFO:VAL-(cmcm) >>
2024-06-13 12:36:13:INFO:M: >>  Has0_acc_2: 0.6681  Has0_F1_score: 0.6687  Non0_acc_2: 0.6898  Non0_F1_score: 0.6915  Mult_acc_5: 0.3712  Mult_acc_7: 0.3013  MAE: 1.2385  Corr: 0.4431 
2024-06-13 12:36:28:INFO:TRAIN-(cmcm) (4/28/5)>> loss: 0.7163
2024-06-13 12:36:31:INFO:VAL-(cmcm) >>
2024-06-13 12:36:31:INFO:M: >>  Has0_acc_2: 0.6550  Has0_F1_score: 0.6487  Non0_acc_2: 0.6713  Non0_F1_score: 0.6641  Mult_acc_5: 0.3668  Mult_acc_7: 0.2882  MAE: 1.2398  Corr: 0.4278 
2024-06-13 12:36:46:INFO:TRAIN-(cmcm) (5/29/5)>> loss: 0.7100
2024-06-13 12:36:48:INFO:VAL-(cmcm) >>
2024-06-13 12:36:48:INFO:M: >>  Has0_acc_2: 0.6856  Has0_F1_score: 0.6870  Non0_acc_2: 0.6667  Non0_F1_score: 0.6675  Mult_acc_5: 0.3537  Mult_acc_7: 0.2795  MAE: 1.2507  Corr: 0.4165 
2024-06-13 12:37:03:INFO:TRAIN-(cmcm) (6/30/5)>> loss: 0.7083
2024-06-13 12:37:06:INFO:VAL-(cmcm) >>
2024-06-13 12:37:06:INFO:M: >>  Has0_acc_2: 0.6900  Has0_F1_score: 0.6842  Non0_acc_2: 0.6991  Non0_F1_score: 0.7002  Mult_acc_5: 0.3493  Mult_acc_7: 0.2838  MAE: 1.1896  Corr: 0.4760 
2024-06-13 12:37:21:INFO:TRAIN-(cmcm) (7/31/5)>> loss: 0.6956
2024-06-13 12:37:23:INFO:VAL-(cmcm) >>
2024-06-13 12:37:23:INFO:M: >>  Has0_acc_2: 0.7118  Has0_F1_score: 0.7069  Non0_acc_2: 0.7176  Non0_F1_score: 0.7181  Mult_acc_5: 0.3886  Mult_acc_7: 0.3188  MAE: 1.1721  Corr: 0.4908 
2024-06-13 12:37:38:INFO:TRAIN-(cmcm) (8/32/5)>> loss: 0.6842
2024-06-13 12:37:41:INFO:VAL-(cmcm) >>
2024-06-13 12:37:41:INFO:M: >>  Has0_acc_2: 0.6987  Has0_F1_score: 0.7003  Non0_acc_2: 0.7269  Non0_F1_score: 0.7262  Mult_acc_5: 0.3450  Mult_acc_7: 0.2838  MAE: 1.1966  Corr: 0.5044 
2024-06-13 12:37:56:INFO:TRAIN-(cmcm) (9/33/5)>> loss: 0.6794
2024-06-13 12:37:58:INFO:VAL-(cmcm) >>
2024-06-13 12:37:58:INFO:M: >>  Has0_acc_2: 0.6856  Has0_F1_score: 0.6884  Non0_acc_2: 0.7037  Non0_F1_score: 0.7052  Mult_acc_5: 0.3362  Mult_acc_7: 0.2620  MAE: 1.2533  Corr: 0.4433 
2024-06-13 12:38:13:INFO:TRAIN-(cmcm) (10/34/5)>> loss: 0.6689
2024-06-13 12:38:16:INFO:VAL-(cmcm) >>
2024-06-13 12:38:16:INFO:M: >>  Has0_acc_2: 0.7118  Has0_F1_score: 0.7146  Non0_acc_2: 0.7315  Non0_F1_score: 0.7328  Mult_acc_5: 0.3537  Mult_acc_7: 0.2926  MAE: 1.1857  Corr: 0.4878 
2024-06-13 12:38:23:INFO:TEST-(cmcm) >>
2024-06-13 12:38:23:INFO:M: >>  Has0_acc_2: 0.6910  Has0_F1_score: 0.6914  Non0_acc_2: 0.7348  Non0_F1_score: 0.7354  Mult_acc_5: 0.3601  Mult_acc_7: 0.3003  MAE: 1.1886  Corr: 0.4974 
2024-06-13 12:38:23:INFO:Results are added to results/results/mosi-regression-50.csv...
2024-06-13 12:38:23:INFO:Start running cmcm...
2024-06-13 12:38:23:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 6, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 60, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-06-13 12:38:23:INFO:Let's use the GPU 1 !
2024-06-13 12:38:23:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 12:38:24:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718253504 HTTP/1.1" 200 235
2024-06-13 12:38:24:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 12:38:25:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 12:38:25:INFO:train samples: (1284,)
2024-06-13 12:38:25:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 12:38:26:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718253506 HTTP/1.1" 200 235
2024-06-13 12:38:26:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 12:38:27:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 12:38:27:INFO:valid samples: (229,)
2024-06-13 12:38:28:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 12:38:28:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718253508 HTTP/1.1" 200 235
2024-06-13 12:38:28:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 12:38:29:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 12:38:29:INFO:test samples: (686,)
2024-06-13 12:38:29:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 12:38:30:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718253510 HTTP/1.1" 200 235
2024-06-13 12:38:30:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 12:38:30:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 12:38:31:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 12:38:31:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718253511 HTTP/1.1" 200 235
2024-06-13 12:38:31:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 12:38:32:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 12:38:32:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-13 12:38:32:WARNING:Try importing flash-attention for faster inference...
2024-06-13 12:38:32:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-13 12:38:32:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-13 12:38:32:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-13 12:38:33:INFO:trainable params: 1310288 || all params: 1838138960 || trainable%: 0.07128340286090232
2024-06-13 12:38:33:INFO:Init labels...
2024-06-13 12:38:33:INFO:Start training...
2024-06-13 12:38:48:INFO:TRAIN-(cmcm) (1/1/1)>> loss: 3.5408
2024-06-13 12:38:51:INFO:VAL-(cmcm) >>
2024-06-13 12:38:51:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4167  Non0_F1_score: 0.2801  Mult_acc_5: 0.2140  Mult_acc_7: 0.2140  MAE: 1.4475  Corr: -0.0246 
2024-06-13 12:38:52:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-13 12:39:07:INFO:TRAIN-(cmcm) (1/2/1)>> loss: 1.0633
2024-06-13 12:39:09:INFO:VAL-(cmcm) >>
2024-06-13 12:39:09:INFO:M: >>  Has0_acc_2: 0.5197  Has0_F1_score: 0.5212  Non0_acc_2: 0.5139  Non0_F1_score: 0.5135  Mult_acc_5: 0.2489  Mult_acc_7: 0.1790  MAE: 1.7734  Corr: -0.0282 
2024-06-13 12:39:24:INFO:TRAIN-(cmcm) (2/3/1)>> loss: 0.9010
2024-06-13 12:39:27:INFO:VAL-(cmcm) >>
2024-06-13 12:39:27:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5741  Non0_F1_score: 0.4187  Mult_acc_5: 0.1659  Mult_acc_7: 0.1659  MAE: 1.4624  Corr: 0.0342 
2024-06-13 12:39:42:INFO:TRAIN-(cmcm) (3/4/1)>> loss: 0.8879
2024-06-13 12:39:45:INFO:VAL-(cmcm) >>
2024-06-13 12:39:45:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.4396  Non0_acc_2: 0.5694  Non0_F1_score: 0.4166  Mult_acc_5: 0.3057  Mult_acc_7: 0.2227  MAE: 1.7372  Corr: 0.0039 
2024-06-13 12:39:59:INFO:TRAIN-(cmcm) (4/5/1)>> loss: 0.8746
2024-06-13 12:40:02:INFO:VAL-(cmcm) >>
2024-06-13 12:40:02:INFO:M: >>  Has0_acc_2: 0.4716  Has0_F1_score: 0.4716  Non0_acc_2: 0.4815  Non0_F1_score: 0.4799  Mult_acc_5: 0.2052  Mult_acc_7: 0.1528  MAE: 1.9215  Corr: -0.0042 
2024-06-13 12:40:17:INFO:TRAIN-(cmcm) (5/6/1)>> loss: 0.8815
2024-06-13 12:40:19:INFO:VAL-(cmcm) >>
2024-06-13 12:40:19:INFO:M: >>  Has0_acc_2: 0.6201  Has0_F1_score: 0.5251  Non0_acc_2: 0.5972  Non0_F1_score: 0.5000  Mult_acc_5: 0.2838  Mult_acc_7: 0.2052  MAE: 1.6669  Corr: 0.0413 
2024-06-13 12:40:34:INFO:TRAIN-(cmcm) (6/7/1)>> loss: 0.8631
2024-06-13 12:40:37:INFO:VAL-(cmcm) >>
2024-06-13 12:40:37:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.4843  Non0_acc_2: 0.5648  Non0_F1_score: 0.4627  Mult_acc_5: 0.2882  Mult_acc_7: 0.2096  MAE: 1.7459  Corr: -0.0127 
2024-06-13 12:40:51:INFO:TRAIN-(cmcm) (7/8/1)>> loss: 0.8691
2024-06-13 12:40:54:INFO:VAL-(cmcm) >>
2024-06-13 12:40:54:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.5483  Non0_acc_2: 0.5648  Non0_F1_score: 0.5346  Mult_acc_5: 0.2969  Mult_acc_7: 0.2183  MAE: 1.7040  Corr: 0.0516 
2024-06-13 12:41:09:INFO:TRAIN-(cmcm) (8/9/1)>> loss: 0.8593
2024-06-13 12:41:11:INFO:VAL-(cmcm) >>
2024-06-13 12:41:11:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.4864  Non0_acc_2: 0.5463  Non0_F1_score: 0.4621  Mult_acc_5: 0.2402  Mult_acc_7: 0.1790  MAE: 1.6568  Corr: -0.0231 
2024-06-13 12:41:26:INFO:TRAIN-(cmcm) (9/10/1)>> loss: 0.8580
2024-06-13 12:41:29:INFO:VAL-(cmcm) >>
2024-06-13 12:41:29:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.4897  Non0_acc_2: 0.5648  Non0_F1_score: 0.4627  Mult_acc_5: 0.2838  Mult_acc_7: 0.1965  MAE: 1.8499  Corr: -0.0220 
2024-06-13 12:41:43:INFO:TRAIN-(cmcm) (10/11/1)>> loss: 0.8596
2024-06-13 12:41:46:INFO:VAL-(cmcm) >>
2024-06-13 12:41:46:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5399  Non0_acc_2: 0.5602  Non0_F1_score: 0.5256  Mult_acc_5: 0.2838  Mult_acc_7: 0.1965  MAE: 1.7926  Corr: 0.0428 
2024-06-13 12:41:53:INFO:TEST-(cmcm) >>
2024-06-13 12:41:53:INFO:M: >>  Has0_acc_2: 0.4475  Has0_F1_score: 0.2767  Non0_acc_2: 0.5381  Non0_F1_score: 0.4248  Mult_acc_5: 0.1516  Mult_acc_7: 0.1516  MAE: 1.4646  Corr: -0.1219 
2024-06-13 12:41:54:INFO:Results are added to results/results/mosi-regression-60.csv...
2024-06-13 12:41:54:INFO:Start running cmcm...
2024-06-13 12:41:54:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 6, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 60, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 2222}>
2024-06-13 12:41:54:INFO:Let's use the GPU 1 !
2024-06-13 12:41:54:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 12:41:54:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718253714 HTTP/1.1" 200 235
2024-06-13 12:41:54:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 12:41:55:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 12:41:56:INFO:train samples: (1284,)
2024-06-13 12:41:56:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 12:41:57:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718253717 HTTP/1.1" 200 235
2024-06-13 12:41:57:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 12:41:57:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 12:41:58:INFO:valid samples: (229,)
2024-06-13 12:41:58:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 12:41:59:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718253719 HTTP/1.1" 200 235
2024-06-13 12:41:59:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 12:41:59:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 12:42:00:INFO:test samples: (686,)
2024-06-13 12:42:00:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 12:42:01:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718253721 HTTP/1.1" 200 235
2024-06-13 12:42:01:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 12:42:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 12:42:02:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 12:42:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718253723 HTTP/1.1" 200 235
2024-06-13 12:42:03:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 12:42:03:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 12:42:03:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-13 12:42:03:WARNING:Try importing flash-attention for faster inference...
2024-06-13 12:42:03:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-13 12:42:03:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-13 12:42:03:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-13 12:42:05:INFO:trainable params: 1310288 || all params: 1838138960 || trainable%: 0.07128340286090232
2024-06-13 12:42:05:INFO:Init labels...
2024-06-13 12:42:05:INFO:Start training...
2024-06-13 12:42:20:INFO:TRAIN-(cmcm) (1/1/2)>> loss: 3.5904
2024-06-13 12:42:22:INFO:VAL-(cmcm) >>
2024-06-13 12:42:22:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5146  Non0_acc_2: 0.5509  Non0_F1_score: 0.5236  Mult_acc_5: 0.2882  Mult_acc_7: 0.1354  MAE: 2.3110  Corr: 0.0328 
2024-06-13 12:42:23:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-13 12:42:38:INFO:TRAIN-(cmcm) (1/2/2)>> loss: 1.2695
2024-06-13 12:42:40:INFO:VAL-(cmcm) >>
2024-06-13 12:42:40:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.4653  Non0_acc_2: 0.5602  Non0_F1_score: 0.4414  Mult_acc_5: 0.2096  Mult_acc_7: 0.2052  MAE: 1.4925  Corr: -0.0216 
2024-06-13 12:42:41:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-13 12:42:56:INFO:TRAIN-(cmcm) (1/3/2)>> loss: 0.9997
2024-06-13 12:42:59:INFO:VAL-(cmcm) >>
2024-06-13 12:42:59:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4767  Non0_acc_2: 0.5787  Non0_F1_score: 0.4649  Mult_acc_5: 0.2009  Mult_acc_7: 0.1878  MAE: 1.5785  Corr: -0.0684 
2024-06-13 12:43:13:INFO:TRAIN-(cmcm) (2/4/2)>> loss: 0.9841
2024-06-13 12:43:16:INFO:VAL-(cmcm) >>
2024-06-13 12:43:16:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.4790  Non0_acc_2: 0.5463  Non0_F1_score: 0.4569  Mult_acc_5: 0.2402  Mult_acc_7: 0.2009  MAE: 1.6864  Corr: -0.1106 
2024-06-13 12:43:31:INFO:TRAIN-(cmcm) (3/5/2)>> loss: 0.9479
2024-06-13 12:43:33:INFO:VAL-(cmcm) >>
2024-06-13 12:43:33:INFO:M: >>  Has0_acc_2: 0.4760  Has0_F1_score: 0.4620  Non0_acc_2: 0.4907  Non0_F1_score: 0.4721  Mult_acc_5: 0.1485  Mult_acc_7: 0.1354  MAE: 1.8440  Corr: 0.0209 
2024-06-13 12:43:48:INFO:TRAIN-(cmcm) (4/6/2)>> loss: 0.9372
2024-06-13 12:43:51:INFO:VAL-(cmcm) >>
2024-06-13 12:43:51:INFO:M: >>  Has0_acc_2: 0.5371  Has0_F1_score: 0.5353  Non0_acc_2: 0.5278  Non0_F1_score: 0.5263  Mult_acc_5: 0.1616  Mult_acc_7: 0.1616  MAE: 1.6152  Corr: 0.0079 
2024-06-13 12:44:05:INFO:TRAIN-(cmcm) (5/7/2)>> loss: 0.9259
2024-06-13 12:44:08:INFO:VAL-(cmcm) >>
2024-06-13 12:44:08:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5028  Non0_acc_2: 0.5648  Non0_F1_score: 0.4978  Mult_acc_5: 0.1616  Mult_acc_7: 0.1616  MAE: 1.5777  Corr: -0.0579 
2024-06-13 12:44:23:INFO:TRAIN-(cmcm) (6/8/2)>> loss: 0.8988
2024-06-13 12:44:25:INFO:VAL-(cmcm) >>
2024-06-13 12:44:25:INFO:M: >>  Has0_acc_2: 0.5590  Has0_F1_score: 0.5297  Non0_acc_2: 0.5417  Non0_F1_score: 0.5112  Mult_acc_5: 0.1747  Mult_acc_7: 0.1703  MAE: 1.7165  Corr: -0.0311 
2024-06-13 12:44:40:INFO:TRAIN-(cmcm) (7/9/2)>> loss: 0.8993
2024-06-13 12:44:43:INFO:VAL-(cmcm) >>
2024-06-13 12:44:43:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4652  Non0_acc_2: 0.5787  Non0_F1_score: 0.4370  Mult_acc_5: 0.1921  Mult_acc_7: 0.1878  MAE: 1.5292  Corr: 0.0549 
2024-06-13 12:44:58:INFO:TRAIN-(cmcm) (8/10/2)>> loss: 0.8896
2024-06-13 12:45:01:INFO:VAL-(cmcm) >>
2024-06-13 12:45:01:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5717  Non0_acc_2: 0.5833  Non0_F1_score: 0.5652  Mult_acc_5: 0.2271  Mult_acc_7: 0.1965  MAE: 1.6699  Corr: 0.0540 
2024-06-13 12:45:16:INFO:TRAIN-(cmcm) (9/11/2)>> loss: 0.8784
2024-06-13 12:45:18:INFO:VAL-(cmcm) >>
2024-06-13 12:45:18:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.5292  Non0_acc_2: 0.5741  Non0_F1_score: 0.5201  Mult_acc_5: 0.2009  Mult_acc_7: 0.1878  MAE: 1.5462  Corr: -0.0050 
2024-06-13 12:45:33:INFO:TRAIN-(cmcm) (10/12/2)>> loss: 0.8764
2024-06-13 12:45:36:INFO:VAL-(cmcm) >>
2024-06-13 12:45:36:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.4897  Non0_acc_2: 0.5694  Non0_F1_score: 0.4713  Mult_acc_5: 0.2096  Mult_acc_7: 0.1921  MAE: 1.5720  Corr: -0.0201 
2024-06-13 12:45:44:INFO:TEST-(cmcm) >>
2024-06-13 12:45:44:INFO:M: >>  Has0_acc_2: 0.4606  Has0_F1_score: 0.3251  Non0_acc_2: 0.4619  Non0_F1_score: 0.3594  Mult_acc_5: 0.1735  Mult_acc_7: 0.1676  MAE: 1.6671  Corr: 0.0300 
2024-06-13 12:45:44:INFO:Results are added to results/results/mosi-regression-60.csv...
2024-06-13 12:45:44:INFO:Start running cmcm...
2024-06-13 12:45:44:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 6, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 60, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 3333}>
2024-06-13 12:45:44:INFO:Let's use the GPU 1 !
2024-06-13 12:45:44:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 12:45:44:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718253945 HTTP/1.1" 200 235
2024-06-13 12:45:45:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 12:45:45:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 12:45:46:INFO:train samples: (1284,)
2024-06-13 12:45:46:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 12:45:46:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718253947 HTTP/1.1" 200 235
2024-06-13 12:45:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 12:45:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 12:45:48:INFO:valid samples: (229,)
2024-06-13 12:45:48:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 12:45:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718253949 HTTP/1.1" 200 235
2024-06-13 12:45:49:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 12:45:49:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 12:45:50:INFO:test samples: (686,)
2024-06-13 12:45:50:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 12:45:51:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718253951 HTTP/1.1" 200 235
2024-06-13 12:45:51:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 12:45:52:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 12:45:52:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 12:45:53:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718253953 HTTP/1.1" 200 235
2024-06-13 12:45:53:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 12:45:53:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 12:45:54:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-13 12:45:54:WARNING:Try importing flash-attention for faster inference...
2024-06-13 12:45:54:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-13 12:45:54:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-13 12:45:54:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-13 12:45:55:INFO:trainable params: 1310288 || all params: 1838138960 || trainable%: 0.07128340286090232
2024-06-13 12:45:55:INFO:Init labels...
2024-06-13 12:45:55:INFO:Start training...
2024-06-13 12:46:10:INFO:TRAIN-(cmcm) (1/1/3)>> loss: 3.8340
2024-06-13 12:46:13:INFO:VAL-(cmcm) >>
2024-06-13 12:46:13:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4723  Non0_acc_2: 0.5741  Non0_F1_score: 0.4622  Mult_acc_5: 0.2533  Mult_acc_7: 0.1179  MAE: 2.2739  Corr: 0.0311 
2024-06-13 12:46:13:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-13 12:46:28:INFO:TRAIN-(cmcm) (1/2/3)>> loss: 1.0887
2024-06-13 12:46:31:INFO:VAL-(cmcm) >>
2024-06-13 12:46:31:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.5032  Non0_acc_2: 0.5926  Non0_F1_score: 0.4914  Mult_acc_5: 0.1834  Mult_acc_7: 0.1834  MAE: 1.4667  Corr: -0.0119 
2024-06-13 12:46:32:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-13 12:46:47:INFO:TRAIN-(cmcm) (1/3/3)>> loss: 0.9047
2024-06-13 12:46:49:INFO:VAL-(cmcm) >>
2024-06-13 12:46:49:INFO:M: >>  Has0_acc_2: 0.4585  Has0_F1_score: 0.3867  Non0_acc_2: 0.4861  Non0_F1_score: 0.4182  Mult_acc_5: 0.1659  Mult_acc_7: 0.1659  MAE: 1.6104  Corr: 0.0800 
2024-06-13 12:47:04:INFO:TRAIN-(cmcm) (2/4/3)>> loss: 0.9022
2024-06-13 12:47:07:INFO:VAL-(cmcm) >>
2024-06-13 12:47:07:INFO:M: >>  Has0_acc_2: 0.5022  Has0_F1_score: 0.4921  Non0_acc_2: 0.5231  Non0_F1_score: 0.5066  Mult_acc_5: 0.1616  Mult_acc_7: 0.1485  MAE: 1.7060  Corr: 0.0656 
2024-06-13 12:47:22:INFO:TRAIN-(cmcm) (3/5/3)>> loss: 0.8812
2024-06-13 12:47:24:INFO:VAL-(cmcm) >>
2024-06-13 12:47:24:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.5292  Non0_acc_2: 0.5833  Non0_F1_score: 0.5106  Mult_acc_5: 0.2358  Mult_acc_7: 0.1921  MAE: 1.5800  Corr: 0.1048 
2024-06-13 12:47:39:INFO:TRAIN-(cmcm) (4/6/3)>> loss: 0.8748
2024-06-13 12:47:42:INFO:VAL-(cmcm) >>
2024-06-13 12:47:42:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.5915  Non0_acc_2: 0.5926  Non0_F1_score: 0.5843  Mult_acc_5: 0.2926  Mult_acc_7: 0.2096  MAE: 1.6975  Corr: 0.1364 
2024-06-13 12:47:57:INFO:TRAIN-(cmcm) (5/7/3)>> loss: 0.8659
2024-06-13 12:47:59:INFO:VAL-(cmcm) >>
2024-06-13 12:47:59:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.6015  Non0_acc_2: 0.6157  Non0_F1_score: 0.6073  Mult_acc_5: 0.2314  Mult_acc_7: 0.1965  MAE: 1.5584  Corr: 0.1431 
2024-06-13 12:48:14:INFO:TRAIN-(cmcm) (6/8/3)>> loss: 0.8694
2024-06-13 12:48:17:INFO:VAL-(cmcm) >>
2024-06-13 12:48:17:INFO:M: >>  Has0_acc_2: 0.6288  Has0_F1_score: 0.5669  Non0_acc_2: 0.5694  Non0_F1_score: 0.5702  Mult_acc_5: 0.2402  Mult_acc_7: 0.2314  MAE: 1.3894  Corr: 0.2109 
2024-06-13 12:48:17:INFO:Saving checkpoint at epoch 8 to results/models/cmcm-mosi-regression.pth.
2024-06-13 12:48:32:INFO:TRAIN-(cmcm) (1/9/3)>> loss: 0.8475
2024-06-13 12:48:35:INFO:VAL-(cmcm) >>
2024-06-13 12:48:35:INFO:M: >>  Has0_acc_2: 0.6681  Has0_F1_score: 0.6579  Non0_acc_2: 0.6759  Non0_F1_score: 0.6633  Mult_acc_5: 0.2664  Mult_acc_7: 0.2183  MAE: 1.3630  Corr: 0.3835 
2024-06-13 12:48:35:INFO:Saving checkpoint at epoch 9 to results/models/cmcm-mosi-regression.pth.
2024-06-13 12:48:51:INFO:TRAIN-(cmcm) (1/10/3)>> loss: 0.8522
2024-06-13 12:48:53:INFO:VAL-(cmcm) >>
2024-06-13 12:48:53:INFO:M: >>  Has0_acc_2: 0.6769  Has0_F1_score: 0.6526  Non0_acc_2: 0.6667  Non0_F1_score: 0.6415  Mult_acc_5: 0.3362  Mult_acc_7: 0.2707  MAE: 1.2817  Corr: 0.3805 
2024-06-13 12:48:53:INFO:Saving checkpoint at epoch 10 to results/models/cmcm-mosi-regression.pth.
2024-06-13 12:49:09:INFO:TRAIN-(cmcm) (1/11/3)>> loss: 0.8254
2024-06-13 12:49:11:INFO:VAL-(cmcm) >>
2024-06-13 12:49:11:INFO:M: >>  Has0_acc_2: 0.6769  Has0_F1_score: 0.6363  Non0_acc_2: 0.6713  Non0_F1_score: 0.6282  Mult_acc_5: 0.3930  Mult_acc_7: 0.3013  MAE: 1.2686  Corr: 0.4463 
2024-06-13 12:49:12:INFO:Saving checkpoint at epoch 11 to results/models/cmcm-mosi-regression.pth.
2024-06-13 12:49:27:INFO:TRAIN-(cmcm) (1/12/3)>> loss: 0.8033
2024-06-13 12:49:29:INFO:VAL-(cmcm) >>
2024-06-13 12:49:29:INFO:M: >>  Has0_acc_2: 0.7293  Has0_F1_score: 0.7315  Non0_acc_2: 0.6389  Non0_F1_score: 0.6257  Mult_acc_5: 0.2882  Mult_acc_7: 0.2620  MAE: 1.1729  Corr: 0.5163 
2024-06-13 12:49:30:INFO:Saving checkpoint at epoch 12 to results/models/cmcm-mosi-regression.pth.
2024-06-13 12:49:45:INFO:TRAIN-(cmcm) (1/13/3)>> loss: 0.7965
2024-06-13 12:49:47:INFO:VAL-(cmcm) >>
2024-06-13 12:49:47:INFO:M: >>  Has0_acc_2: 0.7118  Has0_F1_score: 0.7146  Non0_acc_2: 0.7454  Non0_F1_score: 0.7468  Mult_acc_5: 0.2533  Mult_acc_7: 0.2402  MAE: 1.1549  Corr: 0.5527 
2024-06-13 12:49:48:INFO:Saving checkpoint at epoch 13 to results/models/cmcm-mosi-regression.pth.
2024-06-13 12:50:03:INFO:TRAIN-(cmcm) (1/14/3)>> loss: 0.8002
2024-06-13 12:50:06:INFO:VAL-(cmcm) >>
2024-06-13 12:50:06:INFO:M: >>  Has0_acc_2: 0.6769  Has0_F1_score: 0.6789  Non0_acc_2: 0.7083  Non0_F1_score: 0.7092  Mult_acc_5: 0.3799  Mult_acc_7: 0.2795  MAE: 1.2040  Corr: 0.5048 
2024-06-13 12:50:20:INFO:TRAIN-(cmcm) (2/15/3)>> loss: 0.7878
2024-06-13 12:50:23:INFO:VAL-(cmcm) >>
2024-06-13 12:50:23:INFO:M: >>  Has0_acc_2: 0.7205  Has0_F1_score: 0.7205  Non0_acc_2: 0.7315  Non0_F1_score: 0.7318  Mult_acc_5: 0.3930  Mult_acc_7: 0.2882  MAE: 1.1606  Corr: 0.5387 
2024-06-13 12:50:38:INFO:TRAIN-(cmcm) (3/16/3)>> loss: 0.7760
2024-06-13 12:50:40:INFO:VAL-(cmcm) >>
2024-06-13 12:50:40:INFO:M: >>  Has0_acc_2: 0.7598  Has0_F1_score: 0.7586  Non0_acc_2: 0.7824  Non0_F1_score: 0.7796  Mult_acc_5: 0.3886  Mult_acc_7: 0.3188  MAE: 1.0730  Corr: 0.5906 
2024-06-13 12:50:41:INFO:Saving checkpoint at epoch 16 to results/models/cmcm-mosi-regression.pth.
2024-06-13 12:50:56:INFO:TRAIN-(cmcm) (1/17/3)>> loss: 0.7718
2024-06-13 12:50:58:INFO:VAL-(cmcm) >>
2024-06-13 12:50:58:INFO:M: >>  Has0_acc_2: 0.7118  Has0_F1_score: 0.7139  Non0_acc_2: 0.7315  Non0_F1_score: 0.7324  Mult_acc_5: 0.3755  Mult_acc_7: 0.2707  MAE: 1.1664  Corr: 0.5605 
2024-06-13 12:51:13:INFO:TRAIN-(cmcm) (2/18/3)>> loss: 0.7613
2024-06-13 12:51:16:INFO:VAL-(cmcm) >>
2024-06-13 12:51:16:INFO:M: >>  Has0_acc_2: 0.7380  Has0_F1_score: 0.7388  Non0_acc_2: 0.7639  Non0_F1_score: 0.7633  Mult_acc_5: 0.3843  Mult_acc_7: 0.3013  MAE: 1.0689  Corr: 0.6052 
2024-06-13 12:51:16:INFO:Saving checkpoint at epoch 18 to results/models/cmcm-mosi-regression.pth.
2024-06-13 12:51:32:INFO:TRAIN-(cmcm) (1/19/3)>> loss: 0.7536
2024-06-13 12:51:34:INFO:VAL-(cmcm) >>
2024-06-13 12:51:34:INFO:M: >>  Has0_acc_2: 0.7380  Has0_F1_score: 0.7405  Non0_acc_2: 0.7407  Non0_F1_score: 0.7422  Mult_acc_5: 0.3362  Mult_acc_7: 0.2795  MAE: 1.1453  Corr: 0.5717 
2024-06-13 12:51:49:INFO:TRAIN-(cmcm) (2/20/3)>> loss: 0.7407
2024-06-13 12:51:52:INFO:VAL-(cmcm) >>
2024-06-13 12:51:52:INFO:M: >>  Has0_acc_2: 0.7118  Has0_F1_score: 0.7129  Non0_acc_2: 0.7407  Non0_F1_score: 0.7411  Mult_acc_5: 0.3712  Mult_acc_7: 0.2751  MAE: 1.2359  Corr: 0.5734 
2024-06-13 12:52:07:INFO:TRAIN-(cmcm) (3/21/3)>> loss: 0.7348
2024-06-13 12:52:09:INFO:VAL-(cmcm) >>
2024-06-13 12:52:09:INFO:M: >>  Has0_acc_2: 0.7380  Has0_F1_score: 0.7405  Non0_acc_2: 0.7593  Non0_F1_score: 0.7606  Mult_acc_5: 0.3668  Mult_acc_7: 0.2969  MAE: 1.0357  Corr: 0.6443 
2024-06-13 12:52:10:INFO:Saving checkpoint at epoch 21 to results/models/cmcm-mosi-regression.pth.
2024-06-13 12:52:25:INFO:TRAIN-(cmcm) (1/22/3)>> loss: 0.7298
2024-06-13 12:52:28:INFO:VAL-(cmcm) >>
2024-06-13 12:52:28:INFO:M: >>  Has0_acc_2: 0.7642  Has0_F1_score: 0.7663  Non0_acc_2: 0.7685  Non0_F1_score: 0.7691  Mult_acc_5: 0.4061  Mult_acc_7: 0.3275  MAE: 0.9903  Corr: 0.6391 
2024-06-13 12:52:28:INFO:Saving checkpoint at epoch 22 to results/models/cmcm-mosi-regression.pth.
2024-06-13 12:52:43:INFO:TRAIN-(cmcm) (1/23/3)>> loss: 0.7285
2024-06-13 12:52:46:INFO:VAL-(cmcm) >>
2024-06-13 12:52:46:INFO:M: >>  Has0_acc_2: 0.7467  Has0_F1_score: 0.7485  Non0_acc_2: 0.7222  Non0_F1_score: 0.7226  Mult_acc_5: 0.4279  Mult_acc_7: 0.3319  MAE: 1.0488  Corr: 0.6090 
2024-06-13 12:53:01:INFO:TRAIN-(cmcm) (2/24/3)>> loss: 0.7250
2024-06-13 12:53:04:INFO:VAL-(cmcm) >>
2024-06-13 12:53:04:INFO:M: >>  Has0_acc_2: 0.7467  Has0_F1_score: 0.7492  Non0_acc_2: 0.7222  Non0_F1_score: 0.7214  Mult_acc_5: 0.3537  Mult_acc_7: 0.2664  MAE: 1.1287  Corr: 0.6072 
2024-06-13 12:53:19:INFO:TRAIN-(cmcm) (3/25/3)>> loss: 0.7093
2024-06-13 12:53:21:INFO:VAL-(cmcm) >>
2024-06-13 12:53:21:INFO:M: >>  Has0_acc_2: 0.7205  Has0_F1_score: 0.7229  Non0_acc_2: 0.7037  Non0_F1_score: 0.7023  Mult_acc_5: 0.3624  Mult_acc_7: 0.2664  MAE: 1.1545  Corr: 0.5812 
2024-06-13 12:53:36:INFO:TRAIN-(cmcm) (4/26/3)>> loss: 0.7045
2024-06-13 12:53:39:INFO:VAL-(cmcm) >>
2024-06-13 12:53:39:INFO:M: >>  Has0_acc_2: 0.7773  Has0_F1_score: 0.7787  Non0_acc_2: 0.7731  Non0_F1_score: 0.7744  Mult_acc_5: 0.4061  Mult_acc_7: 0.3144  MAE: 1.0283  Corr: 0.6172 
2024-06-13 12:53:54:INFO:TRAIN-(cmcm) (5/27/3)>> loss: 0.6942
2024-06-13 12:53:56:INFO:VAL-(cmcm) >>
2024-06-13 12:53:56:INFO:M: >>  Has0_acc_2: 0.7773  Has0_F1_score: 0.7787  Non0_acc_2: 0.7731  Non0_F1_score: 0.7744  Mult_acc_5: 0.4061  Mult_acc_7: 0.2969  MAE: 1.0451  Corr: 0.6054 
2024-06-13 12:54:11:INFO:TRAIN-(cmcm) (6/28/3)>> loss: 0.6923
2024-06-13 12:54:14:INFO:VAL-(cmcm) >>
2024-06-13 12:54:14:INFO:M: >>  Has0_acc_2: 0.7555  Has0_F1_score: 0.7545  Non0_acc_2: 0.7454  Non0_F1_score: 0.7448  Mult_acc_5: 0.4061  Mult_acc_7: 0.3231  MAE: 1.0392  Corr: 0.6050 
2024-06-13 12:54:29:INFO:TRAIN-(cmcm) (7/29/3)>> loss: 0.6848
2024-06-13 12:54:31:INFO:VAL-(cmcm) >>
2024-06-13 12:54:31:INFO:M: >>  Has0_acc_2: 0.7511  Has0_F1_score: 0.7524  Non0_acc_2: 0.7130  Non0_F1_score: 0.7130  Mult_acc_5: 0.3930  Mult_acc_7: 0.3057  MAE: 1.0471  Corr: 0.6053 
2024-06-13 12:54:46:INFO:TRAIN-(cmcm) (8/30/3)>> loss: 0.6856
2024-06-13 12:54:49:INFO:VAL-(cmcm) >>
2024-06-13 12:54:49:INFO:M: >>  Has0_acc_2: 0.7642  Has0_F1_score: 0.7638  Non0_acc_2: 0.7130  Non0_F1_score: 0.7104  Mult_acc_5: 0.3886  Mult_acc_7: 0.3144  MAE: 1.0135  Corr: 0.6383 
2024-06-13 12:55:04:INFO:TRAIN-(cmcm) (9/31/3)>> loss: 0.6745
2024-06-13 12:55:07:INFO:VAL-(cmcm) >>
2024-06-13 12:55:07:INFO:M: >>  Has0_acc_2: 0.7598  Has0_F1_score: 0.7618  Non0_acc_2: 0.7917  Non0_F1_score: 0.7926  Mult_acc_5: 0.3886  Mult_acc_7: 0.3013  MAE: 1.0471  Corr: 0.6134 
2024-06-13 12:55:22:INFO:TRAIN-(cmcm) (10/32/3)>> loss: 0.6700
2024-06-13 12:55:24:INFO:VAL-(cmcm) >>
2024-06-13 12:55:24:INFO:M: >>  Has0_acc_2: 0.7424  Has0_F1_score: 0.7440  Non0_acc_2: 0.6991  Non0_F1_score: 0.6996  Mult_acc_5: 0.4017  Mult_acc_7: 0.3057  MAE: 1.1122  Corr: 0.5705 
2024-06-13 12:55:32:INFO:TEST-(cmcm) >>
2024-06-13 12:55:32:INFO:M: >>  Has0_acc_2: 0.7332  Has0_F1_score: 0.7318  Non0_acc_2: 0.7546  Non0_F1_score: 0.7521  Mult_acc_5: 0.3528  Mult_acc_7: 0.3090  MAE: 1.0428  Corr: 0.5816 
2024-06-13 12:55:32:INFO:Results are added to results/results/mosi-regression-60.csv...
2024-06-13 12:55:32:INFO:Start running cmcm...
2024-06-13 12:55:32:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 6, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 60, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 4444}>
2024-06-13 12:55:32:INFO:Let's use the GPU 1 !
2024-06-13 12:55:32:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 12:55:33:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718254533 HTTP/1.1" 200 235
2024-06-13 12:55:33:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 12:55:34:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 12:55:34:INFO:train samples: (1284,)
2024-06-13 12:55:35:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 12:55:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718254535 HTTP/1.1" 200 235
2024-06-13 12:55:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 12:55:36:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 12:55:36:INFO:valid samples: (229,)
2024-06-13 12:55:37:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 12:55:37:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718254537 HTTP/1.1" 200 235
2024-06-13 12:55:37:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 12:55:38:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 12:55:39:INFO:test samples: (686,)
2024-06-13 12:55:39:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 12:55:39:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718254539 HTTP/1.1" 200 235
2024-06-13 12:55:40:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 12:55:40:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 12:55:41:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 12:55:41:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718254541 HTTP/1.1" 200 235
2024-06-13 12:55:41:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 12:55:42:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 12:55:42:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-13 12:55:42:WARNING:Try importing flash-attention for faster inference...
2024-06-13 12:55:42:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-13 12:55:42:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-13 12:55:42:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-13 12:55:43:INFO:trainable params: 1310288 || all params: 1838138960 || trainable%: 0.07128340286090232
2024-06-13 12:55:43:INFO:Init labels...
2024-06-13 12:55:43:INFO:Start training...
2024-06-13 12:55:58:INFO:TRAIN-(cmcm) (1/1/4)>> loss: 4.1185
2024-06-13 12:56:01:INFO:VAL-(cmcm) >>
2024-06-13 12:56:01:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4398  Non0_F1_score: 0.2985  Mult_acc_5: 0.2140  Mult_acc_7: 0.2140  MAE: 1.4305  Corr: 0.0713 
2024-06-13 12:56:01:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-13 12:56:17:INFO:TRAIN-(cmcm) (1/2/4)>> loss: 1.8879
2024-06-13 12:56:19:INFO:VAL-(cmcm) >>
2024-06-13 12:56:19:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.4869  Non0_acc_2: 0.5694  Non0_F1_score: 0.4966  Mult_acc_5: 0.2009  Mult_acc_7: 0.2009  MAE: 1.4729  Corr: -0.0092 
2024-06-13 12:56:34:INFO:TRAIN-(cmcm) (2/3/4)>> loss: 1.0082
2024-06-13 12:56:37:INFO:VAL-(cmcm) >>
2024-06-13 12:56:37:INFO:M: >>  Has0_acc_2: 0.4236  Has0_F1_score: 0.3182  Non0_acc_2: 0.4306  Non0_F1_score: 0.2939  Mult_acc_5: 0.1616  Mult_acc_7: 0.1354  MAE: 1.8667  Corr: -0.0396 
2024-06-13 12:56:52:INFO:TRAIN-(cmcm) (3/4/4)>> loss: 0.9669
2024-06-13 12:56:54:INFO:VAL-(cmcm) >>
2024-06-13 12:56:54:INFO:M: >>  Has0_acc_2: 0.4803  Has0_F1_score: 0.4482  Non0_acc_2: 0.4954  Non0_F1_score: 0.4618  Mult_acc_5: 0.2183  Mult_acc_7: 0.1834  MAE: 1.7475  Corr: 0.0587 
2024-06-13 12:57:09:INFO:TRAIN-(cmcm) (4/5/4)>> loss: 0.9158
2024-06-13 12:57:12:INFO:VAL-(cmcm) >>
2024-06-13 12:57:12:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.4718  Non0_acc_2: 0.5648  Non0_F1_score: 0.4440  Mult_acc_5: 0.1790  Mult_acc_7: 0.1703  MAE: 1.6200  Corr: 0.0062 
2024-06-13 12:57:27:INFO:TRAIN-(cmcm) (5/6/4)>> loss: 0.9038
2024-06-13 12:57:30:INFO:VAL-(cmcm) >>
2024-06-13 12:57:30:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.5005  Non0_acc_2: 0.5787  Non0_F1_score: 0.4770  Mult_acc_5: 0.1921  Mult_acc_7: 0.1878  MAE: 1.4833  Corr: 0.0524 
2024-06-13 12:57:45:INFO:TRAIN-(cmcm) (6/7/4)>> loss: 0.8869
2024-06-13 12:57:47:INFO:VAL-(cmcm) >>
2024-06-13 12:57:47:INFO:M: >>  Has0_acc_2: 0.4410  Has0_F1_score: 0.3710  Non0_acc_2: 0.4676  Non0_F1_score: 0.4014  Mult_acc_5: 0.1397  Mult_acc_7: 0.1397  MAE: 1.7851  Corr: 0.0733 
2024-06-13 12:58:02:INFO:TRAIN-(cmcm) (7/8/4)>> loss: 0.8827
2024-06-13 12:58:05:INFO:VAL-(cmcm) >>
2024-06-13 12:58:05:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.4968  Non0_acc_2: 0.5509  Non0_F1_score: 0.4701  Mult_acc_5: 0.1703  Mult_acc_7: 0.1616  MAE: 1.5982  Corr: -0.0300 
2024-06-13 12:58:20:INFO:TRAIN-(cmcm) (8/9/4)>> loss: 0.8715
2024-06-13 12:58:22:INFO:VAL-(cmcm) >>
2024-06-13 12:58:22:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.4764  Non0_acc_2: 0.5463  Non0_F1_score: 0.4515  Mult_acc_5: 0.2664  Mult_acc_7: 0.1878  MAE: 1.7416  Corr: -0.0387 
2024-06-13 12:58:37:INFO:TRAIN-(cmcm) (9/10/4)>> loss: 0.8672
2024-06-13 12:58:40:INFO:VAL-(cmcm) >>
2024-06-13 12:58:40:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.5472  Non0_acc_2: 0.5926  Non0_F1_score: 0.5298  Mult_acc_5: 0.2969  Mult_acc_7: 0.2140  MAE: 1.7009  Corr: 0.0850 
2024-06-13 12:58:55:INFO:TRAIN-(cmcm) (10/11/4)>> loss: 0.8622
2024-06-13 12:58:57:INFO:VAL-(cmcm) >>
2024-06-13 12:58:57:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5261  Non0_acc_2: 0.5787  Non0_F1_score: 0.5074  Mult_acc_5: 0.2926  Mult_acc_7: 0.2140  MAE: 1.6616  Corr: 0.0174 
2024-06-13 12:59:05:INFO:TEST-(cmcm) >>
2024-06-13 12:59:05:INFO:M: >>  Has0_acc_2: 0.4490  Has0_F1_score: 0.2799  Non0_acc_2: 0.5899  Non0_F1_score: 0.4550  Mult_acc_5: 0.1545  Mult_acc_7: 0.1545  MAE: 1.4142  Corr: 0.0434 
2024-06-13 12:59:05:INFO:Results are added to results/results/mosi-regression-60.csv...
2024-06-13 12:59:05:INFO:Start running cmcm...
2024-06-13 12:59:05:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 6, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 60, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 5555}>
2024-06-13 12:59:05:INFO:Let's use the GPU 1 !
2024-06-13 12:59:05:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 12:59:06:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718254746 HTTP/1.1" 200 235
2024-06-13 12:59:06:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 12:59:07:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 12:59:07:INFO:train samples: (1284,)
2024-06-13 12:59:08:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 12:59:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718254748 HTTP/1.1" 200 235
2024-06-13 12:59:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 12:59:09:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 12:59:09:INFO:valid samples: (229,)
2024-06-13 12:59:09:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 12:59:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718254750 HTTP/1.1" 200 235
2024-06-13 12:59:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 12:59:11:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 12:59:11:INFO:test samples: (686,)
2024-06-13 12:59:11:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 12:59:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718254752 HTTP/1.1" 200 235
2024-06-13 12:59:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 12:59:13:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 12:59:13:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 12:59:13:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718254753 HTTP/1.1" 200 235
2024-06-13 12:59:14:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 12:59:14:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 12:59:14:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-13 12:59:14:WARNING:Try importing flash-attention for faster inference...
2024-06-13 12:59:14:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-13 12:59:14:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-13 12:59:14:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-13 12:59:15:INFO:trainable params: 1310288 || all params: 1838138960 || trainable%: 0.07128340286090232
2024-06-13 12:59:15:INFO:Init labels...
2024-06-13 12:59:15:INFO:Start training...
2024-06-13 12:59:30:INFO:TRAIN-(cmcm) (1/1/5)>> loss: 3.0531
2024-06-13 12:59:33:INFO:VAL-(cmcm) >>
2024-06-13 12:59:33:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5252  Non0_acc_2: 0.5463  Non0_F1_score: 0.5030  Mult_acc_5: 0.1834  Mult_acc_7: 0.1790  MAE: 1.7222  Corr: 0.0072 
2024-06-13 12:59:33:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-13 12:59:49:INFO:TRAIN-(cmcm) (1/2/5)>> loss: 1.0199
2024-06-13 12:59:51:INFO:VAL-(cmcm) >>
2024-06-13 12:59:51:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5518  Non0_acc_2: 0.5694  Non0_F1_score: 0.5383  Mult_acc_5: 0.1790  Mult_acc_7: 0.1790  MAE: 1.5384  Corr: 0.0499 
2024-06-13 12:59:52:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-13 13:00:07:INFO:TRAIN-(cmcm) (1/3/5)>> loss: 0.9003
2024-06-13 13:00:09:INFO:VAL-(cmcm) >>
2024-06-13 13:00:09:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4723  Non0_acc_2: 0.5787  Non0_F1_score: 0.4584  Mult_acc_5: 0.1703  Mult_acc_7: 0.1659  MAE: 1.5183  Corr: 0.0090 
2024-06-13 13:00:10:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-mosi-regression.pth.
2024-06-13 13:00:25:INFO:TRAIN-(cmcm) (1/4/5)>> loss: 1.1540
2024-06-13 13:00:28:INFO:VAL-(cmcm) >>
2024-06-13 13:00:28:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4259  Non0_F1_score: 0.2624  Mult_acc_5: 0.2096  Mult_acc_7: 0.2096  MAE: 1.4370  Corr: 0.0208 
2024-06-13 13:00:28:INFO:Saving checkpoint at epoch 4 to results/models/cmcm-mosi-regression.pth.
2024-06-13 13:00:43:INFO:TRAIN-(cmcm) (1/5/5)>> loss: 1.1972
2024-06-13 13:00:46:INFO:VAL-(cmcm) >>
2024-06-13 13:00:46:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.5499  Non0_acc_2: 0.5602  Non0_F1_score: 0.5401  Mult_acc_5: 0.2096  Mult_acc_7: 0.1528  MAE: 1.7918  Corr: 0.0028 
2024-06-13 13:01:01:INFO:TRAIN-(cmcm) (2/6/5)>> loss: 0.8950
2024-06-13 13:01:03:INFO:VAL-(cmcm) >>
2024-06-13 13:01:03:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5772  Non0_acc_2: 0.5833  Non0_F1_score: 0.5652  Mult_acc_5: 0.2358  Mult_acc_7: 0.1747  MAE: 1.6149  Corr: 0.0994 
2024-06-13 13:01:18:INFO:TRAIN-(cmcm) (3/7/5)>> loss: 0.8803
2024-06-13 13:01:21:INFO:VAL-(cmcm) >>
2024-06-13 13:01:21:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.5057  Non0_acc_2: 0.5509  Non0_F1_score: 0.4839  Mult_acc_5: 0.1572  Mult_acc_7: 0.1485  MAE: 1.5580  Corr: 0.0358 
2024-06-13 13:01:36:INFO:TRAIN-(cmcm) (4/8/5)>> loss: 0.8765
2024-06-13 13:01:38:INFO:VAL-(cmcm) >>
2024-06-13 13:01:38:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.4730  Non0_acc_2: 0.5648  Non0_F1_score: 0.4505  Mult_acc_5: 0.3057  Mult_acc_7: 0.2227  MAE: 1.7660  Corr: 0.0104 
2024-06-13 13:01:53:INFO:TRAIN-(cmcm) (5/9/5)>> loss: 0.8717
2024-06-13 13:01:56:INFO:VAL-(cmcm) >>
2024-06-13 13:01:56:INFO:M: >>  Has0_acc_2: 0.5633  Has0_F1_score: 0.4969  Non0_acc_2: 0.5509  Non0_F1_score: 0.4795  Mult_acc_5: 0.2533  Mult_acc_7: 0.1747  MAE: 1.6590  Corr: 0.0244 
2024-06-13 13:02:11:INFO:TRAIN-(cmcm) (6/10/5)>> loss: 0.8653
2024-06-13 13:02:14:INFO:VAL-(cmcm) >>
2024-06-13 13:02:14:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.4943  Non0_acc_2: 0.5787  Non0_F1_score: 0.4770  Mult_acc_5: 0.2489  Mult_acc_7: 0.1790  MAE: 1.5743  Corr: 0.0439 
2024-06-13 13:02:29:INFO:TRAIN-(cmcm) (7/11/5)>> loss: 0.8578
2024-06-13 13:02:31:INFO:VAL-(cmcm) >>
2024-06-13 13:02:31:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5710  Non0_acc_2: 0.5324  Non0_F1_score: 0.5338  Mult_acc_5: 0.2052  Mult_acc_7: 0.1659  MAE: 1.5756  Corr: 0.1095 
2024-06-13 13:02:47:INFO:TRAIN-(cmcm) (8/12/5)>> loss: 0.8565
2024-06-13 13:02:49:INFO:VAL-(cmcm) >>
2024-06-13 13:02:49:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5070  Non0_acc_2: 0.5648  Non0_F1_score: 0.5133  Mult_acc_5: 0.2664  Mult_acc_7: 0.1965  MAE: 1.6018  Corr: 0.0670 
2024-06-13 13:03:04:INFO:TRAIN-(cmcm) (9/13/5)>> loss: 0.8543
2024-06-13 13:03:07:INFO:VAL-(cmcm) >>
2024-06-13 13:03:07:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5053  Non0_acc_2: 0.5694  Non0_F1_score: 0.4821  Mult_acc_5: 0.2751  Mult_acc_7: 0.1921  MAE: 1.7730  Corr: 0.0783 
2024-06-13 13:03:22:INFO:TRAIN-(cmcm) (10/14/5)>> loss: 0.8464
2024-06-13 13:03:24:INFO:VAL-(cmcm) >>
2024-06-13 13:03:24:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.5116  Non0_acc_2: 0.5648  Non0_F1_score: 0.4978  Mult_acc_5: 0.2140  Mult_acc_7: 0.1790  MAE: 1.6464  Corr: 0.0426 
2024-06-13 13:03:32:INFO:TEST-(cmcm) >>
2024-06-13 13:03:32:INFO:M: >>  Has0_acc_2: 0.4475  Has0_F1_score: 0.2767  Non0_acc_2: 0.5793  Non0_F1_score: 0.4345  Mult_acc_5: 0.1545  Mult_acc_7: 0.1545  MAE: 1.7142  Corr: 0.0491 
2024-06-13 13:03:32:INFO:Results are added to results/results/mosi-regression-60.csv...
2024-06-13 13:03:32:INFO:Start running cmcm...
2024-06-13 13:03:32:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 6, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 70, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-06-13 13:03:32:INFO:Let's use the GPU 1 !
2024-06-13 13:03:32:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 13:03:33:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718255013 HTTP/1.1" 200 235
2024-06-13 13:03:33:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 13:03:34:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 13:03:34:INFO:train samples: (1284,)
2024-06-13 13:03:34:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 13:03:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718255015 HTTP/1.1" 200 235
2024-06-13 13:03:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 13:03:36:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 13:03:36:INFO:valid samples: (229,)
2024-06-13 13:03:36:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 13:03:37:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718255017 HTTP/1.1" 200 235
2024-06-13 13:03:37:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 13:03:38:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 13:03:38:INFO:test samples: (686,)
2024-06-13 13:03:38:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 13:03:39:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718255019 HTTP/1.1" 200 235
2024-06-13 13:03:39:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 13:03:40:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 13:03:40:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 13:03:40:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718255020 HTTP/1.1" 200 235
2024-06-13 13:03:41:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 13:03:41:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 13:03:41:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-13 13:03:41:WARNING:Try importing flash-attention for faster inference...
2024-06-13 13:03:41:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-13 13:03:41:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-13 13:03:41:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-13 13:03:43:INFO:trainable params: 1310288 || all params: 1838138960 || trainable%: 0.07128340286090232
2024-06-13 13:03:43:INFO:Init labels...
2024-06-13 13:03:43:INFO:Start training...
2024-06-13 13:03:58:INFO:TRAIN-(cmcm) (1/1/1)>> loss: 3.6552
2024-06-13 13:04:01:INFO:VAL-(cmcm) >>
2024-06-13 13:04:01:INFO:M: >>  Has0_acc_2: 0.5153  Has0_F1_score: 0.5165  Non0_acc_2: 0.4213  Non0_F1_score: 0.2680  Mult_acc_5: 0.1834  Mult_acc_7: 0.1834  MAE: 1.5873  Corr: -0.0093 
2024-06-13 13:04:01:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-13 13:04:17:INFO:TRAIN-(cmcm) (1/2/1)>> loss: 1.0438
2024-06-13 13:04:19:INFO:VAL-(cmcm) >>
2024-06-13 13:04:19:INFO:M: >>  Has0_acc_2: 0.5633  Has0_F1_score: 0.5531  Non0_acc_2: 0.5602  Non0_F1_score: 0.5505  Mult_acc_5: 0.2227  Mult_acc_7: 0.1965  MAE: 1.5528  Corr: 0.0490 
2024-06-13 13:04:20:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-13 13:04:35:INFO:TRAIN-(cmcm) (1/3/1)>> loss: 0.9026
2024-06-13 13:04:38:INFO:VAL-(cmcm) >>
2024-06-13 13:04:38:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4458  Non0_acc_2: 0.5694  Non0_F1_score: 0.4166  Mult_acc_5: 0.1790  Mult_acc_7: 0.1747  MAE: 1.6071  Corr: -0.0124 
2024-06-13 13:04:53:INFO:TRAIN-(cmcm) (2/4/1)>> loss: 0.8904
2024-06-13 13:04:55:INFO:VAL-(cmcm) >>
2024-06-13 13:04:55:INFO:M: >>  Has0_acc_2: 0.4978  Has0_F1_score: 0.4978  Non0_acc_2: 0.5046  Non0_F1_score: 0.5007  Mult_acc_5: 0.1485  Mult_acc_7: 0.1485  MAE: 1.5790  Corr: 0.0076 
2024-06-13 13:05:10:INFO:TRAIN-(cmcm) (3/5/1)>> loss: 0.8820
2024-06-13 13:05:13:INFO:VAL-(cmcm) >>
2024-06-13 13:05:13:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.5760  Non0_acc_2: 0.5694  Non0_F1_score: 0.5677  Mult_acc_5: 0.1790  Mult_acc_7: 0.1790  MAE: 1.5366  Corr: 0.1175 
2024-06-13 13:05:13:INFO:Saving checkpoint at epoch 5 to results/models/cmcm-mosi-regression.pth.
2024-06-13 13:05:29:INFO:TRAIN-(cmcm) (1/6/1)>> loss: 0.8782
2024-06-13 13:05:31:INFO:VAL-(cmcm) >>
2024-06-13 13:05:31:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.4920  Non0_acc_2: 0.5602  Non0_F1_score: 0.4710  Mult_acc_5: 0.1747  Mult_acc_7: 0.1747  MAE: 1.5296  Corr: -0.0077 
2024-06-13 13:05:32:INFO:Saving checkpoint at epoch 6 to results/models/cmcm-mosi-regression.pth.
2024-06-13 13:05:48:INFO:TRAIN-(cmcm) (1/7/1)>> loss: 0.8736
2024-06-13 13:05:50:INFO:VAL-(cmcm) >>
2024-06-13 13:05:50:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4577  Non0_acc_2: 0.5787  Non0_F1_score: 0.4291  Mult_acc_5: 0.2009  Mult_acc_7: 0.1485  MAE: 1.6398  Corr: -0.0149 
2024-06-13 13:06:05:INFO:TRAIN-(cmcm) (2/8/1)>> loss: 0.8738
2024-06-13 13:06:08:INFO:VAL-(cmcm) >>
2024-06-13 13:06:08:INFO:M: >>  Has0_acc_2: 0.5633  Has0_F1_score: 0.5155  Non0_acc_2: 0.4907  Non0_F1_score: 0.4769  Mult_acc_5: 0.1659  Mult_acc_7: 0.1659  MAE: 1.5462  Corr: -0.0424 
2024-06-13 13:06:23:INFO:TRAIN-(cmcm) (3/9/1)>> loss: 0.8639
2024-06-13 13:06:25:INFO:VAL-(cmcm) >>
2024-06-13 13:06:25:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5741  Non0_F1_score: 0.4187  Mult_acc_5: 0.1965  Mult_acc_7: 0.1790  MAE: 1.4772  Corr: 0.0438 
2024-06-13 13:06:26:INFO:Saving checkpoint at epoch 9 to results/models/cmcm-mosi-regression.pth.
2024-06-13 13:06:41:INFO:TRAIN-(cmcm) (1/10/1)>> loss: 0.8636
2024-06-13 13:06:44:INFO:VAL-(cmcm) >>
2024-06-13 13:06:44:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.4755  Non0_acc_2: 0.5648  Non0_F1_score: 0.4505  Mult_acc_5: 0.1616  Mult_acc_7: 0.1616  MAE: 1.6021  Corr: -0.0658 
2024-06-13 13:06:59:INFO:TRAIN-(cmcm) (2/11/1)>> loss: 0.8662
2024-06-13 13:07:01:INFO:VAL-(cmcm) >>
2024-06-13 13:07:01:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.5215  Non0_acc_2: 0.5602  Non0_F1_score: 0.5026  Mult_acc_5: 0.2664  Mult_acc_7: 0.1878  MAE: 1.8088  Corr: -0.0098 
2024-06-13 13:07:16:INFO:TRAIN-(cmcm) (3/12/1)>> loss: 0.8568
2024-06-13 13:07:19:INFO:VAL-(cmcm) >>
2024-06-13 13:07:19:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.4669  Non0_acc_2: 0.5602  Non0_F1_score: 0.4414  Mult_acc_5: 0.1878  Mult_acc_7: 0.1878  MAE: 1.4973  Corr: -0.0182 
2024-06-13 13:07:34:INFO:TRAIN-(cmcm) (4/13/1)>> loss: 0.8544
2024-06-13 13:07:37:INFO:VAL-(cmcm) >>
2024-06-13 13:07:37:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.4788  Non0_acc_2: 0.5602  Non0_F1_score: 0.4540  Mult_acc_5: 0.3013  Mult_acc_7: 0.2140  MAE: 1.7529  Corr: 0.0046 
2024-06-13 13:07:52:INFO:TRAIN-(cmcm) (5/14/1)>> loss: 0.8536
2024-06-13 13:07:54:INFO:VAL-(cmcm) >>
2024-06-13 13:07:54:INFO:M: >>  Has0_acc_2: 0.5546  Has0_F1_score: 0.5092  Non0_acc_2: 0.5417  Non0_F1_score: 0.4929  Mult_acc_5: 0.1790  Mult_acc_7: 0.1790  MAE: 1.5314  Corr: -0.0093 
2024-06-13 13:08:09:INFO:TRAIN-(cmcm) (6/15/1)>> loss: 0.8613
2024-06-13 13:08:12:INFO:VAL-(cmcm) >>
2024-06-13 13:08:12:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4742  Non0_acc_2: 0.5694  Non0_F1_score: 0.4465  Mult_acc_5: 0.3013  Mult_acc_7: 0.2183  MAE: 1.7695  Corr: -0.0156 
2024-06-13 13:08:27:INFO:TRAIN-(cmcm) (7/16/1)>> loss: 0.8549
2024-06-13 13:08:30:INFO:VAL-(cmcm) >>
2024-06-13 13:08:30:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5184  Non0_acc_2: 0.4630  Non0_F1_score: 0.4552  Mult_acc_5: 0.2096  Mult_acc_7: 0.2096  MAE: 1.4964  Corr: -0.0131 
2024-06-13 13:08:45:INFO:TRAIN-(cmcm) (8/17/1)>> loss: 0.8549
2024-06-13 13:08:47:INFO:VAL-(cmcm) >>
2024-06-13 13:08:47:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5053  Non0_acc_2: 0.5370  Non0_F1_score: 0.4992  Mult_acc_5: 0.2707  Mult_acc_7: 0.1921  MAE: 1.6782  Corr: 0.0185 
2024-06-13 13:09:03:INFO:TRAIN-(cmcm) (9/18/1)>> loss: 0.8549
2024-06-13 13:09:05:INFO:VAL-(cmcm) >>
2024-06-13 13:09:05:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5185  Non0_F1_score: 0.5205  Mult_acc_5: 0.2664  Mult_acc_7: 0.2271  MAE: 1.4800  Corr: 0.0345 
2024-06-13 13:09:20:INFO:TRAIN-(cmcm) (10/19/1)>> loss: 0.8530
2024-06-13 13:09:23:INFO:VAL-(cmcm) >>
2024-06-13 13:09:23:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.4653  Non0_acc_2: 0.5694  Non0_F1_score: 0.4396  Mult_acc_5: 0.2926  Mult_acc_7: 0.2096  MAE: 1.6691  Corr: 0.0347 
2024-06-13 13:09:30:INFO:TEST-(cmcm) >>
2024-06-13 13:09:30:INFO:M: >>  Has0_acc_2: 0.4475  Has0_F1_score: 0.2767  Non0_acc_2: 0.4223  Non0_F1_score: 0.2507  Mult_acc_5: 0.1618  Mult_acc_7: 0.1618  MAE: 1.7554  Corr: -0.0368 
2024-06-13 13:09:31:INFO:Results are added to results/results/mosi-regression-70.csv...
2024-06-13 13:09:31:INFO:Start running cmcm...
2024-06-13 13:09:31:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 6, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 70, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 2222}>
2024-06-13 13:09:31:INFO:Let's use the GPU 1 !
2024-06-13 13:09:31:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 13:09:31:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718255371 HTTP/1.1" 200 235
2024-06-13 13:09:32:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 13:09:32:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 13:09:33:INFO:train samples: (1284,)
2024-06-13 13:09:33:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 13:09:34:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718255374 HTTP/1.1" 200 235
2024-06-13 13:09:34:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 13:09:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 13:09:35:INFO:valid samples: (229,)
2024-06-13 13:09:35:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 13:09:36:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718255376 HTTP/1.1" 200 235
2024-06-13 13:09:36:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 13:09:37:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 13:09:37:INFO:test samples: (686,)
2024-06-13 13:09:37:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 13:09:38:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718255378 HTTP/1.1" 200 235
2024-06-13 13:09:38:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 13:09:39:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 13:09:39:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 13:09:39:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718255379 HTTP/1.1" 200 235
2024-06-13 13:09:40:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 13:09:40:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 13:09:40:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-13 13:09:40:WARNING:Try importing flash-attention for faster inference...
2024-06-13 13:09:40:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-13 13:09:40:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-13 13:09:40:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-13 13:09:42:INFO:trainable params: 1310288 || all params: 1838138960 || trainable%: 0.07128340286090232
2024-06-13 13:09:42:INFO:Init labels...
2024-06-13 13:09:42:INFO:Start training...
2024-06-13 13:09:57:INFO:TRAIN-(cmcm) (1/1/2)>> loss: 3.6582
2024-06-13 13:09:59:INFO:VAL-(cmcm) >>
2024-06-13 13:09:59:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.4491  Non0_acc_2: 0.5324  Non0_F1_score: 0.4670  Mult_acc_5: 0.2576  Mult_acc_7: 0.1266  MAE: 2.2908  Corr: -0.0436 
2024-06-13 13:09:59:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-13 13:10:15:INFO:TRAIN-(cmcm) (1/2/2)>> loss: 1.2242
2024-06-13 13:10:17:INFO:VAL-(cmcm) >>
2024-06-13 13:10:17:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.4762  Non0_acc_2: 0.5556  Non0_F1_score: 0.4571  Mult_acc_5: 0.1616  Mult_acc_7: 0.1616  MAE: 1.5156  Corr: -0.0189 
2024-06-13 13:10:18:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-13 13:10:33:INFO:TRAIN-(cmcm) (1/3/2)>> loss: 0.9834
2024-06-13 13:10:36:INFO:VAL-(cmcm) >>
2024-06-13 13:10:36:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.4951  Non0_acc_2: 0.5648  Non0_F1_score: 0.4684  Mult_acc_5: 0.2009  Mult_acc_7: 0.2009  MAE: 1.5628  Corr: -0.0791 
2024-06-13 13:10:51:INFO:TRAIN-(cmcm) (2/4/2)>> loss: 0.9501
2024-06-13 13:10:53:INFO:VAL-(cmcm) >>
2024-06-13 13:10:53:INFO:M: >>  Has0_acc_2: 0.5371  Has0_F1_score: 0.5051  Non0_acc_2: 0.5278  Non0_F1_score: 0.4921  Mult_acc_5: 0.1528  Mult_acc_7: 0.1441  MAE: 1.5899  Corr: -0.0222 
2024-06-13 13:11:08:INFO:TRAIN-(cmcm) (3/5/2)>> loss: 0.9216
2024-06-13 13:11:11:INFO:VAL-(cmcm) >>
2024-06-13 13:11:11:INFO:M: >>  Has0_acc_2: 0.5546  Has0_F1_score: 0.5471  Non0_acc_2: 0.5463  Non0_F1_score: 0.5370  Mult_acc_5: 0.2707  Mult_acc_7: 0.2052  MAE: 1.6402  Corr: -0.0104 
2024-06-13 13:11:26:INFO:TRAIN-(cmcm) (4/6/2)>> loss: 0.9064
2024-06-13 13:11:28:INFO:VAL-(cmcm) >>
2024-06-13 13:11:28:INFO:M: >>  Has0_acc_2: 0.5633  Has0_F1_score: 0.5379  Non0_acc_2: 0.5463  Non0_F1_score: 0.5199  Mult_acc_5: 0.2489  Mult_acc_7: 0.2052  MAE: 1.6970  Corr: -0.0134 
2024-06-13 13:11:43:INFO:TRAIN-(cmcm) (5/7/2)>> loss: 0.8963
2024-06-13 13:11:46:INFO:VAL-(cmcm) >>
2024-06-13 13:11:46:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5231  Non0_acc_2: 0.5741  Non0_F1_score: 0.5084  Mult_acc_5: 0.2664  Mult_acc_7: 0.2096  MAE: 1.6643  Corr: 0.0340 
2024-06-13 13:12:01:INFO:TRAIN-(cmcm) (6/8/2)>> loss: 0.8992
2024-06-13 13:12:04:INFO:VAL-(cmcm) >>
2024-06-13 13:12:04:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.4513  Non0_acc_2: 0.5648  Non0_F1_score: 0.4223  Mult_acc_5: 0.2795  Mult_acc_7: 0.2140  MAE: 1.6947  Corr: -0.0163 
2024-06-13 13:12:19:INFO:TRAIN-(cmcm) (7/9/2)>> loss: 0.8854
2024-06-13 13:12:21:INFO:VAL-(cmcm) >>
2024-06-13 13:12:21:INFO:M: >>  Has0_acc_2: 0.5546  Has0_F1_score: 0.5391  Non0_acc_2: 0.5370  Non0_F1_score: 0.5209  Mult_acc_5: 0.2445  Mult_acc_7: 0.1659  MAE: 1.8625  Corr: -0.0010 
2024-06-13 13:12:36:INFO:TRAIN-(cmcm) (8/10/2)>> loss: 0.8943
2024-06-13 13:12:39:INFO:VAL-(cmcm) >>
2024-06-13 13:12:39:INFO:M: >>  Has0_acc_2: 0.4716  Has0_F1_score: 0.4767  Non0_acc_2: 0.4769  Non0_F1_score: 0.4795  Mult_acc_5: 0.1790  Mult_acc_7: 0.1659  MAE: 1.8302  Corr: -0.0714 
2024-06-13 13:12:54:INFO:TRAIN-(cmcm) (9/11/2)>> loss: 0.8767
2024-06-13 13:12:57:INFO:VAL-(cmcm) >>
2024-06-13 13:12:57:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.5216  Non0_acc_2: 0.5833  Non0_F1_score: 0.4963  Mult_acc_5: 0.2751  Mult_acc_7: 0.2227  MAE: 1.6239  Corr: 0.0378 
2024-06-13 13:13:12:INFO:TRAIN-(cmcm) (10/12/2)>> loss: 0.8770
2024-06-13 13:13:15:INFO:VAL-(cmcm) >>
2024-06-13 13:13:15:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.4968  Non0_acc_2: 0.5556  Non0_F1_score: 0.4731  Mult_acc_5: 0.2183  Mult_acc_7: 0.1965  MAE: 1.6270  Corr: -0.0236 
2024-06-13 13:13:22:INFO:TEST-(cmcm) >>
2024-06-13 13:13:22:INFO:M: >>  Has0_acc_2: 0.4796  Has0_F1_score: 0.3892  Non0_acc_2: 0.4695  Non0_F1_score: 0.3949  Mult_acc_5: 0.1749  Mult_acc_7: 0.1749  MAE: 1.6793  Corr: 0.0337 
2024-06-13 13:13:22:INFO:Results are added to results/results/mosi-regression-70.csv...
2024-06-13 13:13:22:INFO:Start running cmcm...
2024-06-13 13:13:22:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 6, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 70, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 3333}>
2024-06-13 13:13:22:INFO:Let's use the GPU 1 !
2024-06-13 13:13:23:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 13:13:23:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718255603 HTTP/1.1" 200 235
2024-06-13 13:13:23:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 13:13:24:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 13:13:25:INFO:train samples: (1284,)
2024-06-13 13:13:25:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 13:13:25:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718255605 HTTP/1.1" 200 235
2024-06-13 13:13:26:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 13:13:26:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 13:13:27:INFO:valid samples: (229,)
2024-06-13 13:13:27:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 13:13:27:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718255607 HTTP/1.1" 200 235
2024-06-13 13:13:28:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 13:13:28:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 13:13:29:INFO:test samples: (686,)
2024-06-13 13:13:29:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 13:13:29:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718255609 HTTP/1.1" 200 235
2024-06-13 13:13:29:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 13:13:30:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 13:13:30:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 13:13:31:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718255611 HTTP/1.1" 200 235
2024-06-13 13:13:31:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 13:13:32:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 13:13:32:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-13 13:13:32:WARNING:Try importing flash-attention for faster inference...
2024-06-13 13:13:32:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-13 13:13:32:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-13 13:13:32:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-13 13:13:33:INFO:trainable params: 1310288 || all params: 1838138960 || trainable%: 0.07128340286090232
2024-06-13 13:13:33:INFO:Init labels...
2024-06-13 13:13:33:INFO:Start training...
2024-06-13 13:13:48:INFO:TRAIN-(cmcm) (1/1/3)>> loss: 3.9085
2024-06-13 13:13:50:INFO:VAL-(cmcm) >>
2024-06-13 13:13:50:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4791  Non0_acc_2: 0.4815  Non0_F1_score: 0.4839  Mult_acc_5: 0.2271  Mult_acc_7: 0.1703  MAE: 1.8021  Corr: 0.0849 
2024-06-13 13:13:51:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-13 13:14:06:INFO:TRAIN-(cmcm) (1/2/3)>> loss: 1.2657
2024-06-13 13:14:09:INFO:VAL-(cmcm) >>
2024-06-13 13:14:09:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.5234  Non0_acc_2: 0.5787  Non0_F1_score: 0.4982  Mult_acc_5: 0.1790  Mult_acc_7: 0.1790  MAE: 1.5261  Corr: 0.0183 
2024-06-13 13:14:09:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-13 13:14:24:INFO:TRAIN-(cmcm) (1/3/3)>> loss: 0.9382
2024-06-13 13:14:27:INFO:VAL-(cmcm) >>
2024-06-13 13:14:27:INFO:M: >>  Has0_acc_2: 0.5240  Has0_F1_score: 0.5070  Non0_acc_2: 0.5324  Non0_F1_score: 0.5104  Mult_acc_5: 0.1747  Mult_acc_7: 0.1747  MAE: 1.5239  Corr: 0.1120 
2024-06-13 13:14:27:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-mosi-regression.pth.
2024-06-13 13:14:42:INFO:TRAIN-(cmcm) (1/4/3)>> loss: 0.8950
2024-06-13 13:14:45:INFO:VAL-(cmcm) >>
2024-06-13 13:14:45:INFO:M: >>  Has0_acc_2: 0.4891  Has0_F1_score: 0.4575  Non0_acc_2: 0.5046  Non0_F1_score: 0.4717  Mult_acc_5: 0.1834  Mult_acc_7: 0.1790  MAE: 1.6860  Corr: 0.0982 
2024-06-13 13:15:00:INFO:TRAIN-(cmcm) (2/5/3)>> loss: 0.8939
2024-06-13 13:15:02:INFO:VAL-(cmcm) >>
2024-06-13 13:15:02:INFO:M: >>  Has0_acc_2: 0.5415  Has0_F1_score: 0.5459  Non0_acc_2: 0.5463  Non0_F1_score: 0.5487  Mult_acc_5: 0.1659  Mult_acc_7: 0.1528  MAE: 1.6200  Corr: 0.0798 
2024-06-13 13:15:17:INFO:TRAIN-(cmcm) (3/6/3)>> loss: 0.8786
2024-06-13 13:15:20:INFO:VAL-(cmcm) >>
2024-06-13 13:15:20:INFO:M: >>  Has0_acc_2: 0.5502  Has0_F1_score: 0.5091  Non0_acc_2: 0.5370  Non0_F1_score: 0.4929  Mult_acc_5: 0.2707  Mult_acc_7: 0.1921  MAE: 1.7839  Corr: -0.0264 
2024-06-13 13:15:35:INFO:TRAIN-(cmcm) (4/7/3)>> loss: 0.8774
2024-06-13 13:15:38:INFO:VAL-(cmcm) >>
2024-06-13 13:15:38:INFO:M: >>  Has0_acc_2: 0.5459  Has0_F1_score: 0.5144  Non0_acc_2: 0.5324  Non0_F1_score: 0.4985  Mult_acc_5: 0.2096  Mult_acc_7: 0.1921  MAE: 1.6200  Corr: -0.0139 
2024-06-13 13:15:52:INFO:TRAIN-(cmcm) (5/8/3)>> loss: 0.8776
2024-06-13 13:15:55:INFO:VAL-(cmcm) >>
2024-06-13 13:15:55:INFO:M: >>  Has0_acc_2: 0.6332  Has0_F1_score: 0.6338  Non0_acc_2: 0.5926  Non0_F1_score: 0.5889  Mult_acc_5: 0.2445  Mult_acc_7: 0.2052  MAE: 1.5004  Corr: 0.1996 
2024-06-13 13:15:55:INFO:Saving checkpoint at epoch 8 to results/models/cmcm-mosi-regression.pth.
2024-06-13 13:16:11:INFO:TRAIN-(cmcm) (1/9/3)>> loss: 0.8648
2024-06-13 13:16:13:INFO:VAL-(cmcm) >>
2024-06-13 13:16:13:INFO:M: >>  Has0_acc_2: 0.6332  Has0_F1_score: 0.5984  Non0_acc_2: 0.6204  Non0_F1_score: 0.5842  Mult_acc_5: 0.3057  Mult_acc_7: 0.2358  MAE: 1.5276  Corr: 0.1988 
2024-06-13 13:16:28:INFO:TRAIN-(cmcm) (2/10/3)>> loss: 0.8566
2024-06-13 13:16:31:INFO:VAL-(cmcm) >>
2024-06-13 13:16:31:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.4996  Non0_acc_2: 0.5648  Non0_F1_score: 0.4791  Mult_acc_5: 0.2969  Mult_acc_7: 0.2183  MAE: 1.7066  Corr: 0.0637 
2024-06-13 13:16:46:INFO:TRAIN-(cmcm) (3/11/3)>> loss: 0.8478
2024-06-13 13:16:48:INFO:VAL-(cmcm) >>
2024-06-13 13:16:48:INFO:M: >>  Has0_acc_2: 0.6157  Has0_F1_score: 0.4994  Non0_acc_2: 0.6019  Non0_F1_score: 0.5030  Mult_acc_5: 0.3100  Mult_acc_7: 0.2227  MAE: 1.6263  Corr: 0.2181 
2024-06-13 13:17:03:INFO:TRAIN-(cmcm) (4/12/3)>> loss: 0.8391
2024-06-13 13:17:06:INFO:VAL-(cmcm) >>
2024-06-13 13:17:06:INFO:M: >>  Has0_acc_2: 0.6943  Has0_F1_score: 0.6965  Non0_acc_2: 0.7083  Non0_F1_score: 0.7089  Mult_acc_5: 0.3275  Mult_acc_7: 0.2402  MAE: 1.2765  Corr: 0.4383 
2024-06-13 13:17:06:INFO:Saving checkpoint at epoch 12 to results/models/cmcm-mosi-regression.pth.
2024-06-13 13:17:21:INFO:TRAIN-(cmcm) (1/13/3)>> loss: 0.8338
2024-06-13 13:17:24:INFO:VAL-(cmcm) >>
2024-06-13 13:17:24:INFO:M: >>  Has0_acc_2: 0.6725  Has0_F1_score: 0.6426  Non0_acc_2: 0.6620  Non0_F1_score: 0.6355  Mult_acc_5: 0.3231  Mult_acc_7: 0.2620  MAE: 1.4001  Corr: 0.3266 
2024-06-13 13:17:39:INFO:TRAIN-(cmcm) (2/14/3)>> loss: 0.8276
2024-06-13 13:17:41:INFO:VAL-(cmcm) >>
2024-06-13 13:17:41:INFO:M: >>  Has0_acc_2: 0.7118  Has0_F1_score: 0.7142  Non0_acc_2: 0.7222  Non0_F1_score: 0.7234  Mult_acc_5: 0.3581  Mult_acc_7: 0.2838  MAE: 1.1883  Corr: 0.4985 
2024-06-13 13:17:41:INFO:Saving checkpoint at epoch 14 to results/models/cmcm-mosi-regression.pth.
2024-06-13 13:17:57:INFO:TRAIN-(cmcm) (1/15/3)>> loss: 0.8186
2024-06-13 13:17:59:INFO:VAL-(cmcm) >>
2024-06-13 13:17:59:INFO:M: >>  Has0_acc_2: 0.6987  Has0_F1_score: 0.6984  Non0_acc_2: 0.6713  Non0_F1_score: 0.6731  Mult_acc_5: 0.3362  Mult_acc_7: 0.2489  MAE: 1.3191  Corr: 0.4289 
2024-06-13 13:18:14:INFO:TRAIN-(cmcm) (2/16/3)>> loss: 0.8089
2024-06-13 13:18:17:INFO:VAL-(cmcm) >>
2024-06-13 13:18:17:INFO:M: >>  Has0_acc_2: 0.6376  Has0_F1_score: 0.6320  Non0_acc_2: 0.6389  Non0_F1_score: 0.6315  Mult_acc_5: 0.3144  Mult_acc_7: 0.2271  MAE: 1.4664  Corr: 0.3132 
2024-06-13 13:18:32:INFO:TRAIN-(cmcm) (3/17/3)>> loss: 0.8048
2024-06-13 13:18:35:INFO:VAL-(cmcm) >>
2024-06-13 13:18:35:INFO:M: >>  Has0_acc_2: 0.7293  Has0_F1_score: 0.7317  Non0_acc_2: 0.7500  Non0_F1_score: 0.7510  Mult_acc_5: 0.3755  Mult_acc_7: 0.2926  MAE: 1.1206  Corr: 0.5442 
2024-06-13 13:18:35:INFO:Saving checkpoint at epoch 17 to results/models/cmcm-mosi-regression.pth.
2024-06-13 13:18:50:INFO:TRAIN-(cmcm) (1/18/3)>> loss: 0.7984
2024-06-13 13:18:53:INFO:VAL-(cmcm) >>
2024-06-13 13:18:53:INFO:M: >>  Has0_acc_2: 0.7162  Has0_F1_score: 0.7147  Non0_acc_2: 0.7315  Non0_F1_score: 0.7296  Mult_acc_5: 0.3843  Mult_acc_7: 0.2882  MAE: 1.1424  Corr: 0.5225 
2024-06-13 13:19:08:INFO:TRAIN-(cmcm) (2/19/3)>> loss: 0.7851
2024-06-13 13:19:10:INFO:VAL-(cmcm) >>
2024-06-13 13:19:10:INFO:M: >>  Has0_acc_2: 0.7162  Has0_F1_score: 0.7180  Non0_acc_2: 0.7361  Non0_F1_score: 0.7374  Mult_acc_5: 0.3624  Mult_acc_7: 0.2926  MAE: 1.1599  Corr: 0.4936 
2024-06-13 13:19:25:INFO:TRAIN-(cmcm) (3/20/3)>> loss: 0.7884
2024-06-13 13:19:28:INFO:VAL-(cmcm) >>
2024-06-13 13:19:28:INFO:M: >>  Has0_acc_2: 0.6463  Has0_F1_score: 0.6450  Non0_acc_2: 0.6667  Non0_F1_score: 0.6644  Mult_acc_5: 0.3624  Mult_acc_7: 0.2707  MAE: 1.3878  Corr: 0.4585 
2024-06-13 13:19:43:INFO:TRAIN-(cmcm) (4/21/3)>> loss: 0.7764
2024-06-13 13:19:45:INFO:VAL-(cmcm) >>
2024-06-13 13:19:45:INFO:M: >>  Has0_acc_2: 0.7031  Has0_F1_score: 0.6971  Non0_acc_2: 0.7083  Non0_F1_score: 0.7066  Mult_acc_5: 0.3843  Mult_acc_7: 0.2838  MAE: 1.2202  Corr: 0.5027 
2024-06-13 13:20:00:INFO:TRAIN-(cmcm) (5/22/3)>> loss: 0.7652
2024-06-13 13:20:03:INFO:VAL-(cmcm) >>
2024-06-13 13:20:03:INFO:M: >>  Has0_acc_2: 0.7424  Has0_F1_score: 0.7444  Non0_acc_2: 0.7639  Non0_F1_score: 0.7651  Mult_acc_5: 0.3930  Mult_acc_7: 0.3100  MAE: 1.1167  Corr: 0.5562 
2024-06-13 13:20:03:INFO:Saving checkpoint at epoch 22 to results/models/cmcm-mosi-regression.pth.
2024-06-13 13:20:18:INFO:TRAIN-(cmcm) (1/23/3)>> loss: 0.7633
2024-06-13 13:20:21:INFO:VAL-(cmcm) >>
2024-06-13 13:20:21:INFO:M: >>  Has0_acc_2: 0.7293  Has0_F1_score: 0.7319  Non0_acc_2: 0.7546  Non0_F1_score: 0.7560  Mult_acc_5: 0.3362  Mult_acc_7: 0.2882  MAE: 1.1523  Corr: 0.5106 
2024-06-13 13:20:36:INFO:TRAIN-(cmcm) (2/24/3)>> loss: 0.7528
2024-06-13 13:20:39:INFO:VAL-(cmcm) >>
2024-06-13 13:20:39:INFO:M: >>  Has0_acc_2: 0.7249  Has0_F1_score: 0.7276  Non0_acc_2: 0.6944  Non0_F1_score: 0.6902  Mult_acc_5: 0.3712  Mult_acc_7: 0.2969  MAE: 1.1459  Corr: 0.5382 
2024-06-13 13:20:54:INFO:TRAIN-(cmcm) (3/25/3)>> loss: 0.7483
2024-06-13 13:20:56:INFO:VAL-(cmcm) >>
2024-06-13 13:20:56:INFO:M: >>  Has0_acc_2: 0.7031  Has0_F1_score: 0.7052  Non0_acc_2: 0.7222  Non0_F1_score: 0.7232  Mult_acc_5: 0.3581  Mult_acc_7: 0.3100  MAE: 1.2005  Corr: 0.5108 
2024-06-13 13:21:11:INFO:TRAIN-(cmcm) (4/26/3)>> loss: 0.7391
2024-06-13 13:21:14:INFO:VAL-(cmcm) >>
2024-06-13 13:21:14:INFO:M: >>  Has0_acc_2: 0.7118  Has0_F1_score: 0.7141  Non0_acc_2: 0.7176  Non0_F1_score: 0.7170  Mult_acc_5: 0.3581  Mult_acc_7: 0.2795  MAE: 1.1777  Corr: 0.5431 
2024-06-13 13:21:29:INFO:TRAIN-(cmcm) (5/27/3)>> loss: 0.7389
2024-06-13 13:21:31:INFO:VAL-(cmcm) >>
2024-06-13 13:21:31:INFO:M: >>  Has0_acc_2: 0.7249  Has0_F1_score: 0.7275  Non0_acc_2: 0.7315  Non0_F1_score: 0.7328  Mult_acc_5: 0.3712  Mult_acc_7: 0.2664  MAE: 1.1708  Corr: 0.5478 
2024-06-13 13:21:46:INFO:TRAIN-(cmcm) (6/28/3)>> loss: 0.7299
2024-06-13 13:21:49:INFO:VAL-(cmcm) >>
2024-06-13 13:21:49:INFO:M: >>  Has0_acc_2: 0.7555  Has0_F1_score: 0.7521  Non0_acc_2: 0.7546  Non0_F1_score: 0.7559  Mult_acc_5: 0.4017  Mult_acc_7: 0.3188  MAE: 1.0512  Corr: 0.5803 
2024-06-13 13:21:49:INFO:Saving checkpoint at epoch 28 to results/models/cmcm-mosi-regression.pth.
2024-06-13 13:22:05:INFO:TRAIN-(cmcm) (1/29/3)>> loss: 0.7217
2024-06-13 13:22:07:INFO:VAL-(cmcm) >>
2024-06-13 13:22:07:INFO:M: >>  Has0_acc_2: 0.7031  Has0_F1_score: 0.6998  Non0_acc_2: 0.7315  Non0_F1_score: 0.7329  Mult_acc_5: 0.3843  Mult_acc_7: 0.3013  MAE: 1.1389  Corr: 0.5125 
2024-06-13 13:22:22:INFO:TRAIN-(cmcm) (2/30/3)>> loss: 0.7074
2024-06-13 13:22:25:INFO:VAL-(cmcm) >>
2024-06-13 13:22:25:INFO:M: >>  Has0_acc_2: 0.7467  Has0_F1_score: 0.7408  Non0_acc_2: 0.6944  Non0_F1_score: 0.6923  Mult_acc_5: 0.3712  Mult_acc_7: 0.3100  MAE: 1.0887  Corr: 0.5529 
2024-06-13 13:22:40:INFO:TRAIN-(cmcm) (3/31/3)>> loss: 0.7054
2024-06-13 13:22:42:INFO:VAL-(cmcm) >>
2024-06-13 13:22:42:INFO:M: >>  Has0_acc_2: 0.7380  Has0_F1_score: 0.7405  Non0_acc_2: 0.7546  Non0_F1_score: 0.7557  Mult_acc_5: 0.3493  Mult_acc_7: 0.2882  MAE: 1.1363  Corr: 0.5533 
2024-06-13 13:22:58:INFO:TRAIN-(cmcm) (4/32/3)>> loss: 0.6972
2024-06-13 13:23:00:INFO:VAL-(cmcm) >>
2024-06-13 13:23:00:INFO:M: >>  Has0_acc_2: 0.7380  Has0_F1_score: 0.7405  Non0_acc_2: 0.7083  Non0_F1_score: 0.7060  Mult_acc_5: 0.3450  Mult_acc_7: 0.2707  MAE: 1.1678  Corr: 0.5206 
2024-06-13 13:23:15:INFO:TRAIN-(cmcm) (5/33/3)>> loss: 0.6877
2024-06-13 13:23:18:INFO:VAL-(cmcm) >>
2024-06-13 13:23:18:INFO:M: >>  Has0_acc_2: 0.7642  Has0_F1_score: 0.7622  Non0_acc_2: 0.7639  Non0_F1_score: 0.7633  Mult_acc_5: 0.3799  Mult_acc_7: 0.2882  MAE: 1.1250  Corr: 0.5602 
2024-06-13 13:23:33:INFO:TRAIN-(cmcm) (6/34/3)>> loss: 0.7001
2024-06-13 13:23:35:INFO:VAL-(cmcm) >>
2024-06-13 13:23:35:INFO:M: >>  Has0_acc_2: 0.7424  Has0_F1_score: 0.7437  Non0_acc_2: 0.7361  Non0_F1_score: 0.7375  Mult_acc_5: 0.3144  Mult_acc_7: 0.2664  MAE: 1.1685  Corr: 0.5059 
2024-06-13 13:23:50:INFO:TRAIN-(cmcm) (7/35/3)>> loss: 0.6786
2024-06-13 13:23:53:INFO:VAL-(cmcm) >>
2024-06-13 13:23:53:INFO:M: >>  Has0_acc_2: 0.7074  Has0_F1_score: 0.7102  Non0_acc_2: 0.6898  Non0_F1_score: 0.6880  Mult_acc_5: 0.3362  Mult_acc_7: 0.2795  MAE: 1.1979  Corr: 0.5117 
2024-06-13 13:24:08:INFO:TRAIN-(cmcm) (8/36/3)>> loss: 0.6715
2024-06-13 13:24:10:INFO:VAL-(cmcm) >>
2024-06-13 13:24:10:INFO:M: >>  Has0_acc_2: 0.6812  Has0_F1_score: 0.6826  Non0_acc_2: 0.6667  Non0_F1_score: 0.6644  Mult_acc_5: 0.3319  Mult_acc_7: 0.2620  MAE: 1.2258  Corr: 0.5228 
2024-06-13 13:24:25:INFO:TRAIN-(cmcm) (9/37/3)>> loss: 0.6605
2024-06-13 13:24:28:INFO:VAL-(cmcm) >>
2024-06-13 13:24:28:INFO:M: >>  Has0_acc_2: 0.7380  Has0_F1_score: 0.7364  Non0_acc_2: 0.7500  Non0_F1_score: 0.7487  Mult_acc_5: 0.4192  Mult_acc_7: 0.3231  MAE: 1.0717  Corr: 0.5704 
2024-06-13 13:24:43:INFO:TRAIN-(cmcm) (10/38/3)>> loss: 0.6412
2024-06-13 13:24:45:INFO:VAL-(cmcm) >>
2024-06-13 13:24:45:INFO:M: >>  Has0_acc_2: 0.7467  Has0_F1_score: 0.7467  Non0_acc_2: 0.7361  Non0_F1_score: 0.7373  Mult_acc_5: 0.3537  Mult_acc_7: 0.2795  MAE: 1.1424  Corr: 0.5470 
2024-06-13 13:24:53:INFO:TEST-(cmcm) >>
2024-06-13 13:24:53:INFO:M: >>  Has0_acc_2: 0.6749  Has0_F1_score: 0.6734  Non0_acc_2: 0.7027  Non0_F1_score: 0.7045  Mult_acc_5: 0.3192  Mult_acc_7: 0.2784  MAE: 1.2204  Corr: 0.4850 
2024-06-13 13:24:53:INFO:Results are added to results/results/mosi-regression-70.csv...
2024-06-13 13:24:53:INFO:Start running cmcm...
2024-06-13 13:24:53:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 6, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 70, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 4444}>
2024-06-13 13:24:53:INFO:Let's use the GPU 1 !
2024-06-13 13:24:53:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 13:24:53:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718256294 HTTP/1.1" 200 235
2024-06-13 13:24:54:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 13:24:54:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 13:24:55:INFO:train samples: (1284,)
2024-06-13 13:24:55:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 13:24:56:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718256296 HTTP/1.1" 200 235
2024-06-13 13:24:56:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 13:24:56:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 13:24:57:INFO:valid samples: (229,)
2024-06-13 13:24:57:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 13:24:57:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718256298 HTTP/1.1" 200 235
2024-06-13 13:24:58:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 13:24:59:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 13:24:59:INFO:test samples: (686,)
2024-06-13 13:24:59:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 13:25:00:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718256300 HTTP/1.1" 200 235
2024-06-13 13:25:00:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 13:25:01:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 13:25:01:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 13:25:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718256302 HTTP/1.1" 200 235
2024-06-13 13:25:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 13:25:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 13:25:02:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-13 13:25:02:WARNING:Try importing flash-attention for faster inference...
2024-06-13 13:25:02:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-13 13:25:02:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-13 13:25:02:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-13 13:25:04:INFO:trainable params: 1310288 || all params: 1838138960 || trainable%: 0.07128340286090232
2024-06-13 13:25:04:INFO:Init labels...
2024-06-13 13:25:04:INFO:Start training...
2024-06-13 13:25:18:INFO:TRAIN-(cmcm) (1/1/4)>> loss: 4.1774
2024-06-13 13:25:21:INFO:VAL-(cmcm) >>
2024-06-13 13:25:21:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4306  Non0_F1_score: 0.2797  Mult_acc_5: 0.2140  Mult_acc_7: 0.2140  MAE: 1.4349  Corr: 0.0009 
2024-06-13 13:25:22:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-13 13:25:37:INFO:TRAIN-(cmcm) (1/2/4)>> loss: 2.1962
2024-06-13 13:25:39:INFO:VAL-(cmcm) >>
2024-06-13 13:25:39:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5477  Non0_acc_2: 0.5833  Non0_F1_score: 0.5519  Mult_acc_5: 0.2096  Mult_acc_7: 0.2052  MAE: 1.4506  Corr: -0.0031 
2024-06-13 13:25:54:INFO:TRAIN-(cmcm) (2/3/4)>> loss: 1.0335
2024-06-13 13:25:57:INFO:VAL-(cmcm) >>
2024-06-13 13:25:57:INFO:M: >>  Has0_acc_2: 0.5633  Has0_F1_score: 0.5048  Non0_acc_2: 0.5417  Non0_F1_score: 0.4893  Mult_acc_5: 0.2314  Mult_acc_7: 0.2227  MAE: 1.5528  Corr: 0.0436 
2024-06-13 13:26:12:INFO:TRAIN-(cmcm) (3/4/4)>> loss: 0.9223
2024-06-13 13:26:14:INFO:VAL-(cmcm) >>
2024-06-13 13:26:14:INFO:M: >>  Has0_acc_2: 0.5502  Has0_F1_score: 0.4993  Non0_acc_2: 0.5324  Non0_F1_score: 0.4790  Mult_acc_5: 0.1834  Mult_acc_7: 0.1354  MAE: 1.6857  Corr: -0.0296 
2024-06-13 13:26:29:INFO:TRAIN-(cmcm) (4/5/4)>> loss: 0.9560
2024-06-13 13:26:32:INFO:VAL-(cmcm) >>
2024-06-13 13:26:32:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5787  Non0_F1_score: 0.4291  Mult_acc_5: 0.2489  Mult_acc_7: 0.2140  MAE: 1.6034  Corr: 0.1046 
2024-06-13 13:26:47:INFO:TRAIN-(cmcm) (5/6/4)>> loss: 0.9002
2024-06-13 13:26:49:INFO:VAL-(cmcm) >>
2024-06-13 13:26:49:INFO:M: >>  Has0_acc_2: 0.5590  Has0_F1_score: 0.4710  Non0_acc_2: 0.5370  Non0_F1_score: 0.4459  Mult_acc_5: 0.2314  Mult_acc_7: 0.1965  MAE: 1.6612  Corr: -0.0376 
2024-06-13 13:27:04:INFO:TRAIN-(cmcm) (6/7/4)>> loss: 0.8929
2024-06-13 13:27:07:INFO:VAL-(cmcm) >>
2024-06-13 13:27:07:INFO:M: >>  Has0_acc_2: 0.4934  Has0_F1_score: 0.4958  Non0_acc_2: 0.5000  Non0_F1_score: 0.4993  Mult_acc_5: 0.1354  Mult_acc_7: 0.1354  MAE: 1.7130  Corr: -0.0007 
2024-06-13 13:27:22:INFO:TRAIN-(cmcm) (7/8/4)>> loss: 0.8916
2024-06-13 13:27:24:INFO:VAL-(cmcm) >>
2024-06-13 13:27:24:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.4870  Non0_acc_2: 0.5694  Non0_F1_score: 0.4655  Mult_acc_5: 0.1659  Mult_acc_7: 0.1659  MAE: 1.5379  Corr: 0.0045 
2024-06-13 13:27:39:INFO:TRAIN-(cmcm) (8/9/4)>> loss: 0.8824
2024-06-13 13:27:42:INFO:VAL-(cmcm) >>
2024-06-13 13:27:42:INFO:M: >>  Has0_acc_2: 0.5633  Has0_F1_score: 0.4737  Non0_acc_2: 0.5370  Non0_F1_score: 0.4512  Mult_acc_5: 0.1572  Mult_acc_7: 0.1485  MAE: 1.5951  Corr: -0.0386 
2024-06-13 13:27:57:INFO:TRAIN-(cmcm) (9/10/4)>> loss: 0.8669
2024-06-13 13:27:59:INFO:VAL-(cmcm) >>
2024-06-13 13:27:59:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5087  Non0_acc_2: 0.5556  Non0_F1_score: 0.4826  Mult_acc_5: 0.2358  Mult_acc_7: 0.1790  MAE: 1.6551  Corr: -0.0210 
2024-06-13 13:28:14:INFO:TRAIN-(cmcm) (10/11/4)>> loss: 0.8661
2024-06-13 13:28:17:INFO:VAL-(cmcm) >>
2024-06-13 13:28:17:INFO:M: >>  Has0_acc_2: 0.5633  Has0_F1_score: 0.5531  Non0_acc_2: 0.5602  Non0_F1_score: 0.5474  Mult_acc_5: 0.2576  Mult_acc_7: 0.2140  MAE: 1.5811  Corr: 0.0857 
2024-06-13 13:28:24:INFO:TEST-(cmcm) >>
2024-06-13 13:28:24:INFO:M: >>  Has0_acc_2: 0.4475  Has0_F1_score: 0.2767  Non0_acc_2: 0.5701  Non0_F1_score: 0.4467  Mult_acc_5: 0.1545  Mult_acc_7: 0.1545  MAE: 1.4238  Corr: -0.0333 
2024-06-13 13:28:24:INFO:Results are added to results/results/mosi-regression-70.csv...
2024-06-13 13:28:24:INFO:Start running cmcm...
2024-06-13 13:28:24:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 6, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 70, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 5555}>
2024-06-13 13:28:24:INFO:Let's use the GPU 1 !
2024-06-13 13:28:25:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 13:28:25:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718256505 HTTP/1.1" 200 235
2024-06-13 13:28:25:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 13:28:26:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 13:28:27:INFO:train samples: (1284,)
2024-06-13 13:28:27:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 13:28:27:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718256507 HTTP/1.1" 200 235
2024-06-13 13:28:27:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 13:28:28:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 13:28:28:INFO:valid samples: (229,)
2024-06-13 13:28:29:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 13:28:29:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718256509 HTTP/1.1" 200 235
2024-06-13 13:28:29:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 13:28:30:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 13:28:30:INFO:test samples: (686,)
2024-06-13 13:28:30:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 13:28:31:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718256511 HTTP/1.1" 200 235
2024-06-13 13:28:31:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 13:28:32:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 13:28:32:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 13:28:33:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718256513 HTTP/1.1" 200 235
2024-06-13 13:28:33:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 13:28:34:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 13:28:34:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-13 13:28:34:WARNING:Try importing flash-attention for faster inference...
2024-06-13 13:28:34:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-13 13:28:34:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-13 13:28:34:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-13 13:28:35:INFO:trainable params: 1310288 || all params: 1838138960 || trainable%: 0.07128340286090232
2024-06-13 13:28:35:INFO:Init labels...
2024-06-13 13:28:35:INFO:Start training...
2024-06-13 13:28:50:INFO:TRAIN-(cmcm) (1/1/5)>> loss: 3.1854
2024-06-13 13:28:53:INFO:VAL-(cmcm) >>
2024-06-13 13:28:53:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.5317  Non0_acc_2: 0.5602  Non0_F1_score: 0.5380  Mult_acc_5: 0.2358  Mult_acc_7: 0.2227  MAE: 5.8239  Corr: 0.0764 
2024-06-13 13:28:53:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-13 13:29:09:INFO:TRAIN-(cmcm) (1/2/5)>> loss: 1.0246
2024-06-13 13:29:11:INFO:VAL-(cmcm) >>
2024-06-13 13:29:11:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.5187  Non0_acc_2: 0.5463  Non0_F1_score: 0.4963  Mult_acc_5: 0.2314  Mult_acc_7: 0.1965  MAE: 1.6139  Corr: 0.0605 
2024-06-13 13:29:12:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-13 13:29:27:INFO:TRAIN-(cmcm) (1/3/5)>> loss: 0.9187
2024-06-13 13:29:30:INFO:VAL-(cmcm) >>
2024-06-13 13:29:30:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.4943  Non0_acc_2: 0.5787  Non0_F1_score: 0.4649  Mult_acc_5: 0.2227  Mult_acc_7: 0.2096  MAE: 1.5340  Corr: 0.0534 
2024-06-13 13:29:30:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-mosi-regression.pth.
2024-06-13 13:29:46:INFO:TRAIN-(cmcm) (1/4/5)>> loss: 0.9213
2024-06-13 13:29:49:INFO:VAL-(cmcm) >>
2024-06-13 13:29:49:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.5079  Non0_acc_2: 0.5602  Non0_F1_score: 0.4945  Mult_acc_5: 0.2052  Mult_acc_7: 0.1965  MAE: 1.6497  Corr: 0.0103 
2024-06-13 13:30:04:INFO:TRAIN-(cmcm) (2/5/5)>> loss: 0.8855
2024-06-13 13:30:06:INFO:VAL-(cmcm) >>
2024-06-13 13:30:06:INFO:M: >>  Has0_acc_2: 0.5633  Has0_F1_score: 0.5402  Non0_acc_2: 0.5509  Non0_F1_score: 0.5260  Mult_acc_5: 0.2183  Mult_acc_7: 0.1878  MAE: 1.6254  Corr: 0.0769 
2024-06-13 13:30:21:INFO:TRAIN-(cmcm) (3/6/5)>> loss: 0.8744
2024-06-13 13:30:24:INFO:VAL-(cmcm) >>
2024-06-13 13:30:24:INFO:M: >>  Has0_acc_2: 0.5328  Has0_F1_score: 0.5161  Non0_acc_2: 0.5602  Non0_F1_score: 0.5449  Mult_acc_5: 0.2533  Mult_acc_7: 0.1965  MAE: 1.8254  Corr: 0.1647 
2024-06-13 13:30:39:INFO:TRAIN-(cmcm) (4/7/5)>> loss: 0.8668
2024-06-13 13:30:41:INFO:VAL-(cmcm) >>
2024-06-13 13:30:41:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4976  Non0_acc_2: 0.5787  Non0_F1_score: 0.5762  Mult_acc_5: 0.1790  Mult_acc_7: 0.1747  MAE: 1.4152  Corr: 0.1216 
2024-06-13 13:30:42:INFO:Saving checkpoint at epoch 7 to results/models/cmcm-mosi-regression.pth.
2024-06-13 13:30:57:INFO:TRAIN-(cmcm) (1/8/5)>> loss: 0.8716
2024-06-13 13:31:00:INFO:VAL-(cmcm) >>
2024-06-13 13:31:00:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.4584  Non0_acc_2: 0.5648  Non0_F1_score: 0.4299  Mult_acc_5: 0.2620  Mult_acc_7: 0.2009  MAE: 1.7084  Corr: -0.0421 
2024-06-13 13:31:15:INFO:TRAIN-(cmcm) (2/9/5)>> loss: 0.8685
2024-06-13 13:31:18:INFO:VAL-(cmcm) >>
2024-06-13 13:31:18:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4791  Non0_acc_2: 0.5741  Non0_F1_score: 0.4491  Mult_acc_5: 0.1921  Mult_acc_7: 0.1747  MAE: 1.4790  Corr: 0.0621 
2024-06-13 13:31:33:INFO:TRAIN-(cmcm) (3/10/5)>> loss: 0.8621
2024-06-13 13:31:35:INFO:VAL-(cmcm) >>
2024-06-13 13:31:35:INFO:M: >>  Has0_acc_2: 0.6157  Has0_F1_score: 0.4994  Non0_acc_2: 0.5833  Non0_F1_score: 0.5492  Mult_acc_5: 0.2620  Mult_acc_7: 0.2358  MAE: 1.4241  Corr: 0.0875 
2024-06-13 13:31:50:INFO:TRAIN-(cmcm) (4/11/5)>> loss: 0.8597
2024-06-13 13:31:53:INFO:VAL-(cmcm) >>
2024-06-13 13:31:53:INFO:M: >>  Has0_acc_2: 0.6507  Has0_F1_score: 0.6355  Non0_acc_2: 0.6528  Non0_F1_score: 0.6369  Mult_acc_5: 0.1921  Mult_acc_7: 0.1921  MAE: 1.3991  Corr: 0.2281 
2024-06-13 13:31:53:INFO:Saving checkpoint at epoch 11 to results/models/cmcm-mosi-regression.pth.
2024-06-13 13:32:09:INFO:TRAIN-(cmcm) (1/12/5)>> loss: 0.8522
2024-06-13 13:32:11:INFO:VAL-(cmcm) >>
2024-06-13 13:32:11:INFO:M: >>  Has0_acc_2: 0.6550  Has0_F1_score: 0.6525  Non0_acc_2: 0.6620  Non0_F1_score: 0.6576  Mult_acc_5: 0.3450  Mult_acc_7: 0.2707  MAE: 1.4416  Corr: 0.2703 
2024-06-13 13:32:26:INFO:TRAIN-(cmcm) (2/13/5)>> loss: 0.8476
2024-06-13 13:32:29:INFO:VAL-(cmcm) >>
2024-06-13 13:32:29:INFO:M: >>  Has0_acc_2: 0.6507  Has0_F1_score: 0.6533  Non0_acc_2: 0.6713  Non0_F1_score: 0.6719  Mult_acc_5: 0.3144  Mult_acc_7: 0.2489  MAE: 1.4870  Corr: 0.2696 
2024-06-13 13:32:44:INFO:TRAIN-(cmcm) (3/14/5)>> loss: 0.8377
2024-06-13 13:32:46:INFO:VAL-(cmcm) >>
2024-06-13 13:32:46:INFO:M: >>  Has0_acc_2: 0.6332  Has0_F1_score: 0.5336  Non0_acc_2: 0.6157  Non0_F1_score: 0.5230  Mult_acc_5: 0.2969  Mult_acc_7: 0.2271  MAE: 1.5368  Corr: 0.2474 
2024-06-13 13:33:01:INFO:TRAIN-(cmcm) (4/15/5)>> loss: 0.8346
2024-06-13 13:33:04:INFO:VAL-(cmcm) >>
2024-06-13 13:33:04:INFO:M: >>  Has0_acc_2: 0.6157  Has0_F1_score: 0.5643  Non0_acc_2: 0.6065  Non0_F1_score: 0.5514  Mult_acc_5: 0.2838  Mult_acc_7: 0.2052  MAE: 1.5660  Corr: 0.2172 
2024-06-13 13:33:19:INFO:TRAIN-(cmcm) (5/16/5)>> loss: 0.8283
2024-06-13 13:33:21:INFO:VAL-(cmcm) >>
2024-06-13 13:33:21:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.5166  Non0_acc_2: 0.6065  Non0_F1_score: 0.5439  Mult_acc_5: 0.2882  Mult_acc_7: 0.2576  MAE: 1.3682  Corr: 0.2131 
2024-06-13 13:33:22:INFO:Saving checkpoint at epoch 16 to results/models/cmcm-mosi-regression.pth.
2024-06-13 13:33:37:INFO:TRAIN-(cmcm) (1/17/5)>> loss: 0.8275
2024-06-13 13:33:40:INFO:VAL-(cmcm) >>
2024-06-13 13:33:40:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.6143  Non0_acc_2: 0.6157  Non0_F1_score: 0.6160  Mult_acc_5: 0.2795  Mult_acc_7: 0.2183  MAE: 1.5127  Corr: 0.2920 
2024-06-13 13:33:55:INFO:TRAIN-(cmcm) (2/18/5)>> loss: 0.8200
2024-06-13 13:33:57:INFO:VAL-(cmcm) >>
2024-06-13 13:33:57:INFO:M: >>  Has0_acc_2: 0.6332  Has0_F1_score: 0.6325  Non0_acc_2: 0.6389  Non0_F1_score: 0.6371  Mult_acc_5: 0.3100  Mult_acc_7: 0.2445  MAE: 1.4547  Corr: 0.2525 
2024-06-13 13:34:13:INFO:TRAIN-(cmcm) (3/19/5)>> loss: 0.8117
2024-06-13 13:34:15:INFO:VAL-(cmcm) >>
2024-06-13 13:34:15:INFO:M: >>  Has0_acc_2: 0.6507  Has0_F1_score: 0.6539  Non0_acc_2: 0.6435  Non0_F1_score: 0.6454  Mult_acc_5: 0.2795  Mult_acc_7: 0.2445  MAE: 1.3350  Corr: 0.3131 
2024-06-13 13:34:15:INFO:Saving checkpoint at epoch 19 to results/models/cmcm-mosi-regression.pth.
2024-06-13 13:34:31:INFO:TRAIN-(cmcm) (1/20/5)>> loss: 0.8075
2024-06-13 13:34:33:INFO:VAL-(cmcm) >>
2024-06-13 13:34:33:INFO:M: >>  Has0_acc_2: 0.5240  Has0_F1_score: 0.4816  Non0_acc_2: 0.5417  Non0_F1_score: 0.4976  Mult_acc_5: 0.2009  Mult_acc_7: 0.1659  MAE: 1.6830  Corr: 0.2572 
2024-06-13 13:34:48:INFO:TRAIN-(cmcm) (2/21/5)>> loss: 0.8120
2024-06-13 13:34:51:INFO:VAL-(cmcm) >>
2024-06-13 13:34:51:INFO:M: >>  Has0_acc_2: 0.6594  Has0_F1_score: 0.6621  Non0_acc_2: 0.6574  Non0_F1_score: 0.6574  Mult_acc_5: 0.2795  Mult_acc_7: 0.2183  MAE: 1.3123  Corr: 0.3982 
2024-06-13 13:34:51:INFO:Saving checkpoint at epoch 21 to results/models/cmcm-mosi-regression.pth.
2024-06-13 13:35:07:INFO:TRAIN-(cmcm) (1/22/5)>> loss: 0.7950
2024-06-13 13:35:09:INFO:VAL-(cmcm) >>
2024-06-13 13:35:09:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.5965  Non0_acc_2: 0.5926  Non0_F1_score: 0.5858  Mult_acc_5: 0.2533  Mult_acc_7: 0.2271  MAE: 1.3139  Corr: 0.3036 
2024-06-13 13:35:24:INFO:TRAIN-(cmcm) (2/23/5)>> loss: 0.7761
2024-06-13 13:35:27:INFO:VAL-(cmcm) >>
2024-06-13 13:35:27:INFO:M: >>  Has0_acc_2: 0.4541  Has0_F1_score: 0.3518  Non0_acc_2: 0.4861  Non0_F1_score: 0.3856  Mult_acc_5: 0.1616  Mult_acc_7: 0.1441  MAE: 1.7140  Corr: 0.1716 
2024-06-13 13:35:42:INFO:TRAIN-(cmcm) (3/24/5)>> loss: 0.7860
2024-06-13 13:35:45:INFO:VAL-(cmcm) >>
2024-06-13 13:35:45:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.6090  Non0_acc_2: 0.6111  Non0_F1_score: 0.6111  Mult_acc_5: 0.3013  Mult_acc_7: 0.2271  MAE: 1.5145  Corr: 0.3051 
2024-06-13 13:36:00:INFO:TRAIN-(cmcm) (4/25/5)>> loss: 0.7791
2024-06-13 13:36:02:INFO:VAL-(cmcm) >>
2024-06-13 13:36:02:INFO:M: >>  Has0_acc_2: 0.6376  Has0_F1_score: 0.5565  Non0_acc_2: 0.6806  Non0_F1_score: 0.6593  Mult_acc_5: 0.3493  Mult_acc_7: 0.3057  MAE: 1.2241  Corr: 0.4613 
2024-06-13 13:36:03:INFO:Saving checkpoint at epoch 25 to results/models/cmcm-mosi-regression.pth.
2024-06-13 13:36:18:INFO:TRAIN-(cmcm) (1/26/5)>> loss: 0.7764
2024-06-13 13:36:21:INFO:VAL-(cmcm) >>
2024-06-13 13:36:21:INFO:M: >>  Has0_acc_2: 0.6550  Has0_F1_score: 0.6540  Non0_acc_2: 0.6620  Non0_F1_score: 0.6607  Mult_acc_5: 0.3537  Mult_acc_7: 0.2795  MAE: 1.3791  Corr: 0.3732 
2024-06-13 13:36:36:INFO:TRAIN-(cmcm) (2/27/5)>> loss: 0.7693
2024-06-13 13:36:38:INFO:VAL-(cmcm) >>
2024-06-13 13:36:38:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.6140  Non0_acc_2: 0.6296  Non0_F1_score: 0.6309  Mult_acc_5: 0.3188  Mult_acc_7: 0.2445  MAE: 1.4485  Corr: 0.3420 
2024-06-13 13:36:53:INFO:TRAIN-(cmcm) (3/28/5)>> loss: 0.7598
2024-06-13 13:36:56:INFO:VAL-(cmcm) >>
2024-06-13 13:36:56:INFO:M: >>  Has0_acc_2: 0.6725  Has0_F1_score: 0.6488  Non0_acc_2: 0.6713  Non0_F1_score: 0.6513  Mult_acc_5: 0.3755  Mult_acc_7: 0.2838  MAE: 1.3140  Corr: 0.4265 
2024-06-13 13:37:11:INFO:TRAIN-(cmcm) (4/29/5)>> loss: 0.7548
2024-06-13 13:37:14:INFO:VAL-(cmcm) >>
2024-06-13 13:37:14:INFO:M: >>  Has0_acc_2: 0.6463  Has0_F1_score: 0.6497  Non0_acc_2: 0.6528  Non0_F1_score: 0.6545  Mult_acc_5: 0.2751  Mult_acc_7: 0.2358  MAE: 1.3215  Corr: 0.3657 
2024-06-13 13:37:29:INFO:TRAIN-(cmcm) (5/30/5)>> loss: 0.7482
2024-06-13 13:37:31:INFO:VAL-(cmcm) >>
2024-06-13 13:37:31:INFO:M: >>  Has0_acc_2: 0.6419  Has0_F1_score: 0.6171  Non0_acc_2: 0.6481  Non0_F1_score: 0.6257  Mult_acc_5: 0.3712  Mult_acc_7: 0.2707  MAE: 1.3686  Corr: 0.3825 
2024-06-13 13:37:46:INFO:TRAIN-(cmcm) (6/31/5)>> loss: 0.7448
2024-06-13 13:37:49:INFO:VAL-(cmcm) >>
2024-06-13 13:37:49:INFO:M: >>  Has0_acc_2: 0.6463  Has0_F1_score: 0.6163  Non0_acc_2: 0.6389  Non0_F1_score: 0.6179  Mult_acc_5: 0.3712  Mult_acc_7: 0.3013  MAE: 1.2621  Corr: 0.4280 
2024-06-13 13:38:04:INFO:TRAIN-(cmcm) (7/32/5)>> loss: 0.7442
2024-06-13 13:38:06:INFO:VAL-(cmcm) >>
2024-06-13 13:38:06:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.6064  Non0_acc_2: 0.6065  Non0_F1_score: 0.6086  Mult_acc_5: 0.3188  Mult_acc_7: 0.2402  MAE: 1.4721  Corr: 0.2916 
2024-06-13 13:38:21:INFO:TRAIN-(cmcm) (8/33/5)>> loss: 0.7350
2024-06-13 13:38:24:INFO:VAL-(cmcm) >>
2024-06-13 13:38:24:INFO:M: >>  Has0_acc_2: 0.6201  Has0_F1_score: 0.6235  Non0_acc_2: 0.6389  Non0_F1_score: 0.6408  Mult_acc_5: 0.3406  Mult_acc_7: 0.2620  MAE: 1.3481  Corr: 0.3723 
2024-06-13 13:38:39:INFO:TRAIN-(cmcm) (9/34/5)>> loss: 0.7296
2024-06-13 13:38:41:INFO:VAL-(cmcm) >>
2024-06-13 13:38:41:INFO:M: >>  Has0_acc_2: 0.6245  Has0_F1_score: 0.6248  Non0_acc_2: 0.6481  Non0_F1_score: 0.6476  Mult_acc_5: 0.2926  Mult_acc_7: 0.2489  MAE: 1.3402  Corr: 0.4070 
2024-06-13 13:38:56:INFO:TRAIN-(cmcm) (10/35/5)>> loss: 0.7206
2024-06-13 13:38:59:INFO:VAL-(cmcm) >>
2024-06-13 13:38:59:INFO:M: >>  Has0_acc_2: 0.6288  Has0_F1_score: 0.6321  Non0_acc_2: 0.6435  Non0_F1_score: 0.6455  Mult_acc_5: 0.3275  Mult_acc_7: 0.2576  MAE: 1.3149  Corr: 0.3894 
2024-06-13 13:39:07:INFO:TEST-(cmcm) >>
2024-06-13 13:39:07:INFO:M: >>  Has0_acc_2: 0.5160  Has0_F1_score: 0.4411  Non0_acc_2: 0.5473  Non0_F1_score: 0.5278  Mult_acc_5: 0.2172  Mult_acc_7: 0.1983  MAE: 1.5382  Corr: 0.2771 
2024-06-13 13:39:07:INFO:Results are added to results/results/mosi-regression-70.csv...
2024-06-13 13:39:07:INFO:Start running cmcm...
2024-06-13 13:39:07:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 6, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 80, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-06-13 13:39:07:INFO:Let's use the GPU 1 !
2024-06-13 13:39:07:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 13:39:07:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718257147 HTTP/1.1" 200 235
2024-06-13 13:39:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 13:39:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 13:39:09:INFO:train samples: (1284,)
2024-06-13 13:39:09:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 13:39:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718257150 HTTP/1.1" 200 235
2024-06-13 13:39:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 13:39:11:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 13:39:11:INFO:valid samples: (229,)
2024-06-13 13:39:12:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 13:39:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718257152 HTTP/1.1" 200 235
2024-06-13 13:39:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 13:39:13:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 13:39:14:INFO:test samples: (686,)
2024-06-13 13:39:14:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 13:39:14:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718257154 HTTP/1.1" 200 235
2024-06-13 13:39:15:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 13:39:15:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 13:39:16:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 13:39:16:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718257156 HTTP/1.1" 200 235
2024-06-13 13:39:17:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 13:39:17:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 13:39:17:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-13 13:39:17:WARNING:Try importing flash-attention for faster inference...
2024-06-13 13:39:17:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-13 13:39:17:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-13 13:39:17:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-13 13:39:19:INFO:trainable params: 1310288 || all params: 1838138960 || trainable%: 0.07128340286090232
2024-06-13 13:39:19:INFO:Init labels...
2024-06-13 13:39:19:INFO:Start training...
2024-06-13 13:39:34:INFO:TRAIN-(cmcm) (1/1/1)>> loss: 3.7826
2024-06-13 13:39:37:INFO:VAL-(cmcm) >>
2024-06-13 13:39:37:INFO:M: >>  Has0_acc_2: 0.4498  Has0_F1_score: 0.4269  Non0_acc_2: 0.4259  Non0_F1_score: 0.2701  Mult_acc_5: 0.1485  Mult_acc_7: 0.1441  MAE: 1.6991  Corr: 0.0439 
2024-06-13 13:39:37:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-13 13:39:53:INFO:TRAIN-(cmcm) (1/2/1)>> loss: 1.0916
2024-06-13 13:39:55:INFO:VAL-(cmcm) >>
2024-06-13 13:39:55:INFO:M: >>  Has0_acc_2: 0.4061  Has0_F1_score: 0.2541  Non0_acc_2: 0.4306  Non0_F1_score: 0.2797  Mult_acc_5: 0.1441  Mult_acc_7: 0.1310  MAE: 1.9244  Corr: 0.0100 
2024-06-13 13:40:11:INFO:TRAIN-(cmcm) (2/3/1)>> loss: 0.9281
2024-06-13 13:40:13:INFO:VAL-(cmcm) >>
2024-06-13 13:40:13:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5741  Non0_F1_score: 0.4187  Mult_acc_5: 0.2183  Mult_acc_7: 0.1878  MAE: 1.6158  Corr: -0.0501 
2024-06-13 13:40:14:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-mosi-regression.pth.
2024-06-13 13:40:29:INFO:TRAIN-(cmcm) (1/4/1)>> loss: 0.8930
2024-06-13 13:40:32:INFO:VAL-(cmcm) >>
2024-06-13 13:40:32:INFO:M: >>  Has0_acc_2: 0.5633  Has0_F1_score: 0.5379  Non0_acc_2: 0.5463  Non0_F1_score: 0.5199  Mult_acc_5: 0.2009  Mult_acc_7: 0.1965  MAE: 1.5615  Corr: -0.1354 
2024-06-13 13:40:32:INFO:Saving checkpoint at epoch 4 to results/models/cmcm-mosi-regression.pth.
2024-06-13 13:40:48:INFO:TRAIN-(cmcm) (1/5/1)>> loss: 0.8802
2024-06-13 13:40:50:INFO:VAL-(cmcm) >>
2024-06-13 13:40:50:INFO:M: >>  Has0_acc_2: 0.4803  Has0_F1_score: 0.4171  Non0_acc_2: 0.5046  Non0_F1_score: 0.4430  Mult_acc_5: 0.1659  Mult_acc_7: 0.1659  MAE: 1.6536  Corr: 0.1734 
2024-06-13 13:41:05:INFO:TRAIN-(cmcm) (2/6/1)>> loss: 0.8750
2024-06-13 13:41:08:INFO:VAL-(cmcm) >>
2024-06-13 13:41:08:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.5040  Non0_acc_2: 0.5556  Non0_F1_score: 0.4871  Mult_acc_5: 0.2926  Mult_acc_7: 0.2096  MAE: 1.6865  Corr: -0.0088 
2024-06-13 13:41:23:INFO:TRAIN-(cmcm) (3/7/1)>> loss: 0.8690
2024-06-13 13:41:25:INFO:VAL-(cmcm) >>
2024-06-13 13:41:25:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.5071  Non0_acc_2: 0.5694  Non0_F1_score: 0.4871  Mult_acc_5: 0.1965  Mult_acc_7: 0.1878  MAE: 1.5637  Corr: -0.0062 
2024-06-13 13:41:40:INFO:TRAIN-(cmcm) (4/8/1)>> loss: 0.8739
2024-06-13 13:41:43:INFO:VAL-(cmcm) >>
2024-06-13 13:41:43:INFO:M: >>  Has0_acc_2: 0.5459  Has0_F1_score: 0.5117  Non0_acc_2: 0.4722  Non0_F1_score: 0.4722  Mult_acc_5: 0.1834  Mult_acc_7: 0.1747  MAE: 1.6187  Corr: -0.0571 
2024-06-13 13:41:58:INFO:TRAIN-(cmcm) (5/9/1)>> loss: 0.8653
2024-06-13 13:42:01:INFO:VAL-(cmcm) >>
2024-06-13 13:42:01:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5741  Non0_F1_score: 0.4187  Mult_acc_5: 0.1790  Mult_acc_7: 0.1790  MAE: 1.5296  Corr: 0.0051 
2024-06-13 13:42:01:INFO:Saving checkpoint at epoch 9 to results/models/cmcm-mosi-regression.pth.
2024-06-13 13:42:16:INFO:TRAIN-(cmcm) (1/10/1)>> loss: 0.8612
2024-06-13 13:42:19:INFO:VAL-(cmcm) >>
2024-06-13 13:42:19:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4891  Non0_acc_2: 0.5741  Non0_F1_score: 0.4622  Mult_acc_5: 0.2838  Mult_acc_7: 0.2052  MAE: 1.7206  Corr: 0.0293 
2024-06-13 13:42:34:INFO:TRAIN-(cmcm) (2/11/1)>> loss: 0.8651
2024-06-13 13:42:37:INFO:VAL-(cmcm) >>
2024-06-13 13:42:37:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.5795  Non0_acc_2: 0.5787  Non0_F1_score: 0.5799  Mult_acc_5: 0.2271  Mult_acc_7: 0.1790  MAE: 1.7804  Corr: 0.0937 
2024-06-13 13:42:52:INFO:TRAIN-(cmcm) (3/12/1)>> loss: 0.8562
2024-06-13 13:42:54:INFO:VAL-(cmcm) >>
2024-06-13 13:42:54:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4652  Non0_acc_2: 0.5787  Non0_F1_score: 0.4370  Mult_acc_5: 0.2183  Mult_acc_7: 0.2140  MAE: 1.5593  Corr: -0.0427 
2024-06-13 13:43:09:INFO:TRAIN-(cmcm) (4/13/1)>> loss: 0.8481
2024-06-13 13:43:12:INFO:VAL-(cmcm) >>
2024-06-13 13:43:12:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5934  Non0_acc_2: 0.6019  Non0_F1_score: 0.6040  Mult_acc_5: 0.2664  Mult_acc_7: 0.1878  MAE: 1.7538  Corr: 0.1858 
2024-06-13 13:43:27:INFO:TRAIN-(cmcm) (5/14/1)>> loss: 0.8425
2024-06-13 13:43:29:INFO:VAL-(cmcm) >>
2024-06-13 13:43:29:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.5716  Non0_acc_2: 0.5694  Non0_F1_score: 0.5570  Mult_acc_5: 0.1921  Mult_acc_7: 0.1921  MAE: 1.4912  Corr: 0.0626 
2024-06-13 13:43:30:INFO:Saving checkpoint at epoch 14 to results/models/cmcm-mosi-regression.pth.
2024-06-13 13:43:45:INFO:TRAIN-(cmcm) (1/15/1)>> loss: 0.8500
2024-06-13 13:43:48:INFO:VAL-(cmcm) >>
2024-06-13 13:43:48:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4866  Non0_acc_2: 0.5741  Non0_F1_score: 0.4622  Mult_acc_5: 0.2664  Mult_acc_7: 0.2402  MAE: 1.5820  Corr: 0.0210 
2024-06-13 13:44:03:INFO:TRAIN-(cmcm) (2/16/1)>> loss: 0.8387
2024-06-13 13:44:05:INFO:VAL-(cmcm) >>
2024-06-13 13:44:05:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5219  Non0_acc_2: 0.5602  Non0_F1_score: 0.5474  Mult_acc_5: 0.2489  Mult_acc_7: 0.2445  MAE: 1.4248  Corr: 0.1072 
2024-06-13 13:44:06:INFO:Saving checkpoint at epoch 16 to results/models/cmcm-mosi-regression.pth.
2024-06-13 13:44:21:INFO:TRAIN-(cmcm) (1/17/1)>> loss: 0.8347
2024-06-13 13:44:24:INFO:VAL-(cmcm) >>
2024-06-13 13:44:24:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5081  Non0_acc_2: 0.5648  Non0_F1_score: 0.4841  Mult_acc_5: 0.2489  Mult_acc_7: 0.2096  MAE: 1.5809  Corr: 0.0819 
2024-06-13 13:44:39:INFO:TRAIN-(cmcm) (2/18/1)>> loss: 0.8355
2024-06-13 13:44:42:INFO:VAL-(cmcm) >>
2024-06-13 13:44:42:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.6134  Non0_acc_2: 0.6019  Non0_F1_score: 0.6032  Mult_acc_5: 0.2882  Mult_acc_7: 0.2271  MAE: 1.5183  Corr: 0.1901 
2024-06-13 13:44:57:INFO:TRAIN-(cmcm) (3/19/1)>> loss: 0.8293
2024-06-13 13:45:00:INFO:VAL-(cmcm) >>
2024-06-13 13:45:00:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4891  Non0_acc_2: 0.5787  Non0_F1_score: 0.4649  Mult_acc_5: 0.2707  Mult_acc_7: 0.2183  MAE: 1.5948  Corr: 0.0639 
2024-06-13 13:45:15:INFO:TRAIN-(cmcm) (4/20/1)>> loss: 0.8300
2024-06-13 13:45:17:INFO:VAL-(cmcm) >>
2024-06-13 13:45:17:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5261  Non0_acc_2: 0.5741  Non0_F1_score: 0.5042  Mult_acc_5: 0.3013  Mult_acc_7: 0.2271  MAE: 1.6730  Corr: 0.0751 
2024-06-13 13:45:32:INFO:TRAIN-(cmcm) (5/21/1)>> loss: 0.8162
2024-06-13 13:45:35:INFO:VAL-(cmcm) >>
2024-06-13 13:45:35:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.5880  Non0_acc_2: 0.6019  Non0_F1_score: 0.5846  Mult_acc_5: 0.2838  Mult_acc_7: 0.2402  MAE: 1.5960  Corr: 0.1525 
2024-06-13 13:45:50:INFO:TRAIN-(cmcm) (6/22/1)>> loss: 0.8166
2024-06-13 13:45:53:INFO:VAL-(cmcm) >>
2024-06-13 13:45:53:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.5059  Non0_acc_2: 0.5926  Non0_F1_score: 0.5170  Mult_acc_5: 0.2838  Mult_acc_7: 0.2227  MAE: 1.6104  Corr: 0.0482 
2024-06-13 13:46:08:INFO:TRAIN-(cmcm) (7/23/1)>> loss: 0.8139
2024-06-13 13:46:10:INFO:VAL-(cmcm) >>
2024-06-13 13:46:10:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.5690  Non0_acc_2: 0.5926  Non0_F1_score: 0.5566  Mult_acc_5: 0.2969  Mult_acc_7: 0.2227  MAE: 1.6202  Corr: 0.1495 
2024-06-13 13:46:25:INFO:TRAIN-(cmcm) (8/24/1)>> loss: 0.8018
2024-06-13 13:46:28:INFO:VAL-(cmcm) >>
2024-06-13 13:46:28:INFO:M: >>  Has0_acc_2: 0.6376  Has0_F1_score: 0.5936  Non0_acc_2: 0.5787  Non0_F1_score: 0.5732  Mult_acc_5: 0.2751  Mult_acc_7: 0.2533  MAE: 1.4117  Corr: 0.1754 
2024-06-13 13:46:28:INFO:Saving checkpoint at epoch 24 to results/models/cmcm-mosi-regression.pth.
2024-06-13 13:46:44:INFO:TRAIN-(cmcm) (1/25/1)>> loss: 0.8059
2024-06-13 13:46:47:INFO:VAL-(cmcm) >>
2024-06-13 13:46:47:INFO:M: >>  Has0_acc_2: 0.6157  Has0_F1_score: 0.5169  Non0_acc_2: 0.5880  Non0_F1_score: 0.4885  Mult_acc_5: 0.2271  Mult_acc_7: 0.2096  MAE: 1.4501  Corr: 0.0942 
2024-06-13 13:47:02:INFO:TRAIN-(cmcm) (2/26/1)>> loss: 0.8030
2024-06-13 13:47:04:INFO:VAL-(cmcm) >>
2024-06-13 13:47:04:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.5544  Non0_acc_2: 0.5880  Non0_F1_score: 0.5529  Mult_acc_5: 0.3057  Mult_acc_7: 0.2445  MAE: 1.6158  Corr: 0.0976 
2024-06-13 13:47:19:INFO:TRAIN-(cmcm) (3/27/1)>> loss: 0.7932
2024-06-13 13:47:22:INFO:VAL-(cmcm) >>
2024-06-13 13:47:22:INFO:M: >>  Has0_acc_2: 0.6288  Has0_F1_score: 0.6252  Non0_acc_2: 0.6204  Non0_F1_score: 0.6185  Mult_acc_5: 0.3188  Mult_acc_7: 0.2664  MAE: 1.4743  Corr: 0.2177 
2024-06-13 13:47:37:INFO:TRAIN-(cmcm) (4/28/1)>> loss: 0.7929
2024-06-13 13:47:40:INFO:VAL-(cmcm) >>
2024-06-13 13:47:40:INFO:M: >>  Has0_acc_2: 0.6594  Has0_F1_score: 0.6514  Non0_acc_2: 0.6343  Non0_F1_score: 0.6304  Mult_acc_5: 0.3406  Mult_acc_7: 0.2838  MAE: 1.4563  Corr: 0.2397 
2024-06-13 13:47:55:INFO:TRAIN-(cmcm) (5/29/1)>> loss: 0.7857
2024-06-13 13:47:57:INFO:VAL-(cmcm) >>
2024-06-13 13:47:57:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.6138  Non0_acc_2: 0.5833  Non0_F1_score: 0.5827  Mult_acc_5: 0.2707  Mult_acc_7: 0.2314  MAE: 1.4664  Corr: 0.1961 
2024-06-13 13:48:12:INFO:TRAIN-(cmcm) (6/30/1)>> loss: 0.7842
2024-06-13 13:48:15:INFO:VAL-(cmcm) >>
2024-06-13 13:48:15:INFO:M: >>  Has0_acc_2: 0.6157  Has0_F1_score: 0.6122  Non0_acc_2: 0.5880  Non0_F1_score: 0.5605  Mult_acc_5: 0.3057  Mult_acc_7: 0.2620  MAE: 1.4379  Corr: 0.3236 
2024-06-13 13:48:30:INFO:TRAIN-(cmcm) (7/31/1)>> loss: 0.7826
2024-06-13 13:48:33:INFO:VAL-(cmcm) >>
2024-06-13 13:48:33:INFO:M: >>  Has0_acc_2: 0.6550  Has0_F1_score: 0.6132  Non0_acc_2: 0.6389  Non0_F1_score: 0.5962  Mult_acc_5: 0.3231  Mult_acc_7: 0.2620  MAE: 1.4538  Corr: 0.2707 
2024-06-13 13:48:48:INFO:TRAIN-(cmcm) (8/32/1)>> loss: 0.7785
2024-06-13 13:48:51:INFO:VAL-(cmcm) >>
2024-06-13 13:48:51:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.5936  Non0_acc_2: 0.5648  Non0_F1_score: 0.5536  Mult_acc_5: 0.2576  Mult_acc_7: 0.2489  MAE: 1.4392  Corr: 0.1610 
2024-06-13 13:49:06:INFO:TRAIN-(cmcm) (9/33/1)>> loss: 0.7707
2024-06-13 13:49:08:INFO:VAL-(cmcm) >>
2024-06-13 13:49:08:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.6058  Non0_acc_2: 0.6204  Non0_F1_score: 0.6223  Mult_acc_5: 0.2969  Mult_acc_7: 0.2227  MAE: 1.7053  Corr: 0.1894 
2024-06-13 13:49:23:INFO:TRAIN-(cmcm) (10/34/1)>> loss: 0.7651
2024-06-13 13:49:26:INFO:VAL-(cmcm) >>
2024-06-13 13:49:26:INFO:M: >>  Has0_acc_2: 0.6288  Has0_F1_score: 0.6062  Non0_acc_2: 0.6250  Non0_F1_score: 0.6191  Mult_acc_5: 0.3493  Mult_acc_7: 0.2882  MAE: 1.4525  Corr: 0.2251 
2024-06-13 13:49:33:INFO:TEST-(cmcm) >>
2024-06-13 13:49:33:INFO:M: >>  Has0_acc_2: 0.5481  Has0_F1_score: 0.5145  Non0_acc_2: 0.5534  Non0_F1_score: 0.5532  Mult_acc_5: 0.2566  Mult_acc_7: 0.2376  MAE: 1.4651  Corr: 0.1969 
2024-06-13 13:49:34:INFO:Results are added to results/results/mosi-regression-80.csv...
2024-06-13 13:49:34:INFO:Start running cmcm...
2024-06-13 13:49:34:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 6, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 80, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 2222}>
2024-06-13 13:49:34:INFO:Let's use the GPU 1 !
2024-06-13 13:49:34:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 13:49:34:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718257774 HTTP/1.1" 200 235
2024-06-13 13:49:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 13:49:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 13:49:36:INFO:train samples: (1284,)
2024-06-13 13:49:36:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 13:49:37:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718257777 HTTP/1.1" 200 235
2024-06-13 13:49:37:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 13:49:38:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 13:49:38:INFO:valid samples: (229,)
2024-06-13 13:49:38:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 13:49:39:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718257779 HTTP/1.1" 200 235
2024-06-13 13:49:39:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 13:49:40:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 13:49:40:INFO:test samples: (686,)
2024-06-13 13:49:40:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 13:49:41:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718257781 HTTP/1.1" 200 235
2024-06-13 13:49:41:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 13:49:42:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 13:49:42:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 13:49:43:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718257783 HTTP/1.1" 200 235
2024-06-13 13:49:43:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 13:49:44:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 13:49:44:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-13 13:49:44:WARNING:Try importing flash-attention for faster inference...
2024-06-13 13:49:44:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-13 13:49:44:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-13 13:49:44:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-13 13:49:45:INFO:trainable params: 1310288 || all params: 1838138960 || trainable%: 0.07128340286090232
2024-06-13 13:49:45:INFO:Init labels...
2024-06-13 13:49:45:INFO:Start training...
2024-06-13 13:50:00:INFO:TRAIN-(cmcm) (1/1/2)>> loss: 3.7825
2024-06-13 13:50:03:INFO:VAL-(cmcm) >>
2024-06-13 13:50:03:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4577  Non0_acc_2: 0.5509  Non0_F1_score: 0.5097  Mult_acc_5: 0.3057  Mult_acc_7: 0.1485  MAE: 2.3660  Corr: -0.0132 
2024-06-13 13:50:04:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-13 13:50:19:INFO:TRAIN-(cmcm) (1/2/2)>> loss: 1.5134
2024-06-13 13:50:22:INFO:VAL-(cmcm) >>
2024-06-13 13:50:22:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.4968  Non0_acc_2: 0.5556  Non0_F1_score: 0.4731  Mult_acc_5: 0.1659  Mult_acc_7: 0.1659  MAE: 1.5385  Corr: -0.0440 
2024-06-13 13:50:23:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-13 13:50:38:INFO:TRAIN-(cmcm) (1/3/2)>> loss: 1.0365
2024-06-13 13:50:41:INFO:VAL-(cmcm) >>
2024-06-13 13:50:41:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.4736  Non0_acc_2: 0.5509  Non0_F1_score: 0.4543  Mult_acc_5: 0.2052  Mult_acc_7: 0.2052  MAE: 1.4772  Corr: -0.0063 
2024-06-13 13:50:41:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-mosi-regression.pth.
2024-06-13 13:50:57:INFO:TRAIN-(cmcm) (1/4/2)>> loss: 0.9777
2024-06-13 13:50:59:INFO:VAL-(cmcm) >>
2024-06-13 13:50:59:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.5071  Non0_acc_2: 0.5602  Non0_F1_score: 0.4902  Mult_acc_5: 0.1965  Mult_acc_7: 0.1572  MAE: 1.6630  Corr: -0.0424 
2024-06-13 13:51:14:INFO:TRAIN-(cmcm) (2/5/2)>> loss: 0.9772
2024-06-13 13:51:17:INFO:VAL-(cmcm) >>
2024-06-13 13:51:17:INFO:M: >>  Has0_acc_2: 0.5240  Has0_F1_score: 0.5193  Non0_acc_2: 0.5093  Non0_F1_score: 0.5035  Mult_acc_5: 0.2183  Mult_acc_7: 0.1878  MAE: 1.5746  Corr: -0.0104 
2024-06-13 13:51:32:INFO:TRAIN-(cmcm) (3/6/2)>> loss: 0.9347
2024-06-13 13:51:35:INFO:VAL-(cmcm) >>
2024-06-13 13:51:35:INFO:M: >>  Has0_acc_2: 0.4105  Has0_F1_score: 0.2943  Non0_acc_2: 0.4398  Non0_F1_score: 0.3119  Mult_acc_5: 0.1572  Mult_acc_7: 0.1485  MAE: 1.8886  Corr: -0.0294 
2024-06-13 13:51:50:INFO:TRAIN-(cmcm) (4/7/2)>> loss: 0.9347
2024-06-13 13:51:52:INFO:VAL-(cmcm) >>
2024-06-13 13:51:52:INFO:M: >>  Has0_acc_2: 0.5153  Has0_F1_score: 0.5198  Non0_acc_2: 0.5093  Non0_F1_score: 0.5109  Mult_acc_5: 0.2183  Mult_acc_7: 0.1616  MAE: 1.7311  Corr: 0.0752 
2024-06-13 13:52:07:INFO:TRAIN-(cmcm) (5/8/2)>> loss: 0.9107
2024-06-13 13:52:10:INFO:VAL-(cmcm) >>
2024-06-13 13:52:10:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5541  Non0_acc_2: 0.5787  Non0_F1_score: 0.5482  Mult_acc_5: 0.2620  Mult_acc_7: 0.1921  MAE: 1.7778  Corr: 0.0913 
2024-06-13 13:52:24:INFO:TRAIN-(cmcm) (6/9/2)>> loss: 0.9136
2024-06-13 13:52:27:INFO:VAL-(cmcm) >>
2024-06-13 13:52:27:INFO:M: >>  Has0_acc_2: 0.5633  Has0_F1_score: 0.4737  Non0_acc_2: 0.5463  Non0_F1_score: 0.4569  Mult_acc_5: 0.2838  Mult_acc_7: 0.2140  MAE: 1.8394  Corr: -0.0582 
2024-06-13 13:52:42:INFO:TRAIN-(cmcm) (7/10/2)>> loss: 0.9027
2024-06-13 13:52:44:INFO:VAL-(cmcm) >>
2024-06-13 13:52:44:INFO:M: >>  Has0_acc_2: 0.5022  Has0_F1_score: 0.5041  Non0_acc_2: 0.5093  Non0_F1_score: 0.5093  Mult_acc_5: 0.1747  Mult_acc_7: 0.1485  MAE: 1.8427  Corr: 0.0281 
2024-06-13 13:52:59:INFO:TRAIN-(cmcm) (8/11/2)>> loss: 0.8883
2024-06-13 13:53:02:INFO:VAL-(cmcm) >>
2024-06-13 13:53:02:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4723  Non0_acc_2: 0.5833  Non0_F1_score: 0.4542  Mult_acc_5: 0.1790  Mult_acc_7: 0.1790  MAE: 1.4641  Corr: 0.0423 
2024-06-13 13:53:02:INFO:Saving checkpoint at epoch 11 to results/models/cmcm-mosi-regression.pth.
2024-06-13 13:53:18:INFO:TRAIN-(cmcm) (1/12/2)>> loss: 0.8795
2024-06-13 13:53:20:INFO:VAL-(cmcm) >>
2024-06-13 13:53:20:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4700  Non0_acc_2: 0.5694  Non0_F1_score: 0.4396  Mult_acc_5: 0.1747  Mult_acc_7: 0.1616  MAE: 1.5593  Corr: -0.0283 
2024-06-13 13:53:35:INFO:TRAIN-(cmcm) (2/13/2)>> loss: 0.8757
2024-06-13 13:53:38:INFO:VAL-(cmcm) >>
2024-06-13 13:53:38:INFO:M: >>  Has0_acc_2: 0.4760  Has0_F1_score: 0.4368  Non0_acc_2: 0.4861  Non0_F1_score: 0.4432  Mult_acc_5: 0.1747  Mult_acc_7: 0.1572  MAE: 1.7293  Corr: 0.0595 
2024-06-13 13:53:53:INFO:TRAIN-(cmcm) (3/14/2)>> loss: 0.8791
2024-06-13 13:53:55:INFO:VAL-(cmcm) >>
2024-06-13 13:53:55:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.4840  Non0_acc_2: 0.5694  Non0_F1_score: 0.4595  Mult_acc_5: 0.2183  Mult_acc_7: 0.2052  MAE: 1.6008  Corr: -0.0385 
2024-06-13 13:54:10:INFO:TRAIN-(cmcm) (4/15/2)>> loss: 0.8747
2024-06-13 13:54:13:INFO:VAL-(cmcm) >>
2024-06-13 13:54:13:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.5406  Non0_acc_2: 0.5694  Non0_F1_score: 0.5299  Mult_acc_5: 0.1834  Mult_acc_7: 0.1834  MAE: 1.6040  Corr: 0.0240 
2024-06-13 13:54:27:INFO:TRAIN-(cmcm) (5/16/2)>> loss: 0.8774
2024-06-13 13:54:30:INFO:VAL-(cmcm) >>
2024-06-13 13:54:30:INFO:M: >>  Has0_acc_2: 0.5459  Has0_F1_score: 0.4962  Non0_acc_2: 0.5417  Non0_F1_score: 0.5162  Mult_acc_5: 0.1659  Mult_acc_7: 0.1528  MAE: 1.6065  Corr: -0.0697 
2024-06-13 13:54:45:INFO:TRAIN-(cmcm) (6/17/2)>> loss: 0.8673
2024-06-13 13:54:47:INFO:VAL-(cmcm) >>
2024-06-13 13:54:47:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5146  Non0_acc_2: 0.5787  Non0_F1_score: 0.5029  Mult_acc_5: 0.1834  Mult_acc_7: 0.1747  MAE: 1.6196  Corr: -0.0344 
2024-06-13 13:55:02:INFO:TRAIN-(cmcm) (7/18/2)>> loss: 0.8632
2024-06-13 13:55:05:INFO:VAL-(cmcm) >>
2024-06-13 13:55:05:INFO:M: >>  Has0_acc_2: 0.5109  Has0_F1_score: 0.5147  Non0_acc_2: 0.5185  Non0_F1_score: 0.5197  Mult_acc_5: 0.1878  Mult_acc_7: 0.1834  MAE: 1.7034  Corr: -0.0103 
2024-06-13 13:55:20:INFO:TRAIN-(cmcm) (8/19/2)>> loss: 0.8608
2024-06-13 13:55:22:INFO:VAL-(cmcm) >>
2024-06-13 13:55:22:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5710  Non0_acc_2: 0.5694  Non0_F1_score: 0.5585  Mult_acc_5: 0.2009  Mult_acc_7: 0.1834  MAE: 1.5983  Corr: 0.0978 
2024-06-13 13:55:37:INFO:TRAIN-(cmcm) (9/20/2)>> loss: 0.8529
2024-06-13 13:55:40:INFO:VAL-(cmcm) >>
2024-06-13 13:55:40:INFO:M: >>  Has0_acc_2: 0.4978  Has0_F1_score: 0.5007  Non0_acc_2: 0.5046  Non0_F1_score: 0.5043  Mult_acc_5: 0.2314  Mult_acc_7: 0.1834  MAE: 1.9060  Corr: 0.0291 
2024-06-13 13:55:55:INFO:TRAIN-(cmcm) (10/21/2)>> loss: 0.8526
2024-06-13 13:55:57:INFO:VAL-(cmcm) >>
2024-06-13 13:55:57:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5534  Non0_acc_2: 0.5787  Non0_F1_score: 0.5400  Mult_acc_5: 0.2707  Mult_acc_7: 0.1921  MAE: 1.6451  Corr: 0.1042 
2024-06-13 13:56:05:INFO:TEST-(cmcm) >>
2024-06-13 13:56:05:INFO:M: >>  Has0_acc_2: 0.4431  Has0_F1_score: 0.2965  Non0_acc_2: 0.4162  Non0_F1_score: 0.2730  Mult_acc_5: 0.1589  Mult_acc_7: 0.1589  MAE: 1.7385  Corr: -0.0345 
2024-06-13 13:56:05:INFO:Results are added to results/results/mosi-regression-80.csv...
2024-06-13 13:56:05:INFO:Start running cmcm...
2024-06-13 13:56:05:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 6, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 80, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 3333}>
2024-06-13 13:56:05:INFO:Let's use the GPU 1 !
2024-06-13 13:56:05:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 13:56:06:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718258166 HTTP/1.1" 200 235
2024-06-13 13:56:06:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 13:56:07:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 13:56:07:INFO:train samples: (1284,)
2024-06-13 13:56:07:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 13:56:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718258168 HTTP/1.1" 200 235
2024-06-13 13:56:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 13:56:09:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 13:56:09:INFO:valid samples: (229,)
2024-06-13 13:56:09:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 13:56:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718258170 HTTP/1.1" 200 235
2024-06-13 13:56:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 13:56:11:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 13:56:11:INFO:test samples: (686,)
2024-06-13 13:56:11:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 13:56:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718258172 HTTP/1.1" 200 235
2024-06-13 13:56:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 13:56:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 13:56:13:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 13:56:13:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718258173 HTTP/1.1" 200 235
2024-06-13 13:56:14:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 13:56:14:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 13:56:14:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-13 13:56:14:WARNING:Try importing flash-attention for faster inference...
2024-06-13 13:56:14:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-13 13:56:14:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-13 13:56:14:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-13 13:56:15:INFO:trainable params: 1310288 || all params: 1838138960 || trainable%: 0.07128340286090232
2024-06-13 13:56:15:INFO:Init labels...
2024-06-13 13:56:15:INFO:Start training...
2024-06-13 13:56:30:INFO:TRAIN-(cmcm) (1/1/3)>> loss: 4.0007
2024-06-13 13:56:33:INFO:VAL-(cmcm) >>
2024-06-13 13:56:33:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4577  Non0_acc_2: 0.5324  Non0_F1_score: 0.5152  Mult_acc_5: 0.2882  Mult_acc_7: 0.1485  MAE: 2.2411  Corr: 0.0067 
2024-06-13 13:56:33:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-13 13:56:48:INFO:TRAIN-(cmcm) (1/2/3)>> loss: 1.2567
2024-06-13 13:56:51:INFO:VAL-(cmcm) >>
2024-06-13 13:56:51:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.5140  Non0_acc_2: 0.5556  Non0_F1_score: 0.4913  Mult_acc_5: 0.2052  Mult_acc_7: 0.1790  MAE: 1.5571  Corr: 0.0106 
2024-06-13 13:56:51:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-13 13:57:07:INFO:TRAIN-(cmcm) (1/3/3)>> loss: 0.9281
2024-06-13 13:57:09:INFO:VAL-(cmcm) >>
2024-06-13 13:57:09:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.5686  Non0_acc_2: 0.5694  Non0_F1_score: 0.5600  Mult_acc_5: 0.2664  Mult_acc_7: 0.2096  MAE: 1.5475  Corr: 0.0587 
2024-06-13 13:57:10:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-mosi-regression.pth.
2024-06-13 13:57:25:INFO:TRAIN-(cmcm) (1/4/3)>> loss: 0.9021
2024-06-13 13:57:28:INFO:VAL-(cmcm) >>
2024-06-13 13:57:28:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5309  Non0_acc_2: 0.5926  Non0_F1_score: 0.5477  Mult_acc_5: 0.2009  Mult_acc_7: 0.1921  MAE: 1.4580  Corr: 0.0956 
2024-06-13 13:57:28:INFO:Saving checkpoint at epoch 4 to results/models/cmcm-mosi-regression.pth.
2024-06-13 13:57:43:INFO:TRAIN-(cmcm) (1/5/3)>> loss: 0.8855
2024-06-13 13:57:46:INFO:VAL-(cmcm) >>
2024-06-13 13:57:46:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.4814  Non0_acc_2: 0.5648  Non0_F1_score: 0.4568  Mult_acc_5: 0.2009  Mult_acc_7: 0.1921  MAE: 1.4908  Corr: 0.0130 
2024-06-13 13:58:01:INFO:TRAIN-(cmcm) (2/6/3)>> loss: 0.8781
2024-06-13 13:58:03:INFO:VAL-(cmcm) >>
2024-06-13 13:58:03:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5750  Non0_acc_2: 0.5741  Non0_F1_score: 0.5667  Mult_acc_5: 0.2620  Mult_acc_7: 0.1790  MAE: 1.7765  Corr: 0.0702 
2024-06-13 13:58:18:INFO:TRAIN-(cmcm) (3/7/3)>> loss: 0.8812
2024-06-13 13:58:21:INFO:VAL-(cmcm) >>
2024-06-13 13:58:21:INFO:M: >>  Has0_acc_2: 0.5546  Has0_F1_score: 0.5211  Non0_acc_2: 0.5463  Non0_F1_score: 0.5286  Mult_acc_5: 0.2969  Mult_acc_7: 0.2314  MAE: 1.7451  Corr: 0.0130 
2024-06-13 13:58:36:INFO:TRAIN-(cmcm) (4/8/3)>> loss: 0.8788
2024-06-13 13:58:38:INFO:VAL-(cmcm) >>
2024-06-13 13:58:38:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.5116  Non0_acc_2: 0.4491  Non0_F1_score: 0.4031  Mult_acc_5: 0.2402  Mult_acc_7: 0.2314  MAE: 1.5571  Corr: -0.0383 
2024-06-13 13:58:53:INFO:TRAIN-(cmcm) (5/9/3)>> loss: 0.8658
2024-06-13 13:58:56:INFO:VAL-(cmcm) >>
2024-06-13 13:58:56:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.6029  Non0_acc_2: 0.6019  Non0_F1_score: 0.5924  Mult_acc_5: 0.2838  Mult_acc_7: 0.2140  MAE: 1.5564  Corr: 0.1597 
2024-06-13 13:59:10:INFO:TRAIN-(cmcm) (6/10/3)>> loss: 0.8630
2024-06-13 13:59:13:INFO:VAL-(cmcm) >>
2024-06-13 13:59:13:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5087  Non0_acc_2: 0.5648  Non0_F1_score: 0.4888  Mult_acc_5: 0.3144  Mult_acc_7: 0.2489  MAE: 1.4765  Corr: 0.1028 
2024-06-13 13:59:28:INFO:TRAIN-(cmcm) (7/11/3)>> loss: 0.8565
2024-06-13 13:59:30:INFO:VAL-(cmcm) >>
2024-06-13 13:59:30:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.5669  Non0_acc_2: 0.5880  Non0_F1_score: 0.5744  Mult_acc_5: 0.2707  Mult_acc_7: 0.2096  MAE: 1.5154  Corr: 0.1026 
2024-06-13 13:59:45:INFO:TRAIN-(cmcm) (8/12/3)>> loss: 0.8465
2024-06-13 13:59:48:INFO:VAL-(cmcm) >>
2024-06-13 13:59:48:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.5892  Non0_acc_2: 0.5556  Non0_F1_score: 0.5549  Mult_acc_5: 0.2183  Mult_acc_7: 0.1659  MAE: 1.6152  Corr: 0.1392 
2024-06-13 14:00:03:INFO:TRAIN-(cmcm) (9/13/3)>> loss: 0.8461
2024-06-13 14:00:05:INFO:VAL-(cmcm) >>
2024-06-13 14:00:05:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.5806  Non0_acc_2: 0.5926  Non0_F1_score: 0.5689  Mult_acc_5: 0.2227  Mult_acc_7: 0.2009  MAE: 1.5165  Corr: 0.1464 
2024-06-13 14:00:20:INFO:TRAIN-(cmcm) (10/14/3)>> loss: 0.8399
2024-06-13 14:00:23:INFO:VAL-(cmcm) >>
2024-06-13 14:00:23:INFO:M: >>  Has0_acc_2: 0.6245  Has0_F1_score: 0.6157  Non0_acc_2: 0.6528  Non0_F1_score: 0.6444  Mult_acc_5: 0.2576  Mult_acc_7: 0.2096  MAE: 1.3964  Corr: 0.3540 
2024-06-13 14:00:23:INFO:Saving checkpoint at epoch 14 to results/models/cmcm-mosi-regression.pth.
2024-06-13 14:00:38:INFO:TRAIN-(cmcm) (1/15/3)>> loss: 0.8343
2024-06-13 14:00:41:INFO:VAL-(cmcm) >>
2024-06-13 14:00:41:INFO:M: >>  Has0_acc_2: 0.7031  Has0_F1_score: 0.7053  Non0_acc_2: 0.7315  Non0_F1_score: 0.7318  Mult_acc_5: 0.4061  Mult_acc_7: 0.3144  MAE: 1.2519  Corr: 0.4631 
2024-06-13 14:00:41:INFO:Saving checkpoint at epoch 15 to results/models/cmcm-mosi-regression.pth.
2024-06-13 14:00:56:INFO:TRAIN-(cmcm) (1/16/3)>> loss: 0.8204
2024-06-13 14:00:59:INFO:VAL-(cmcm) >>
2024-06-13 14:00:59:INFO:M: >>  Has0_acc_2: 0.6638  Has0_F1_score: 0.6142  Non0_acc_2: 0.6620  Non0_F1_score: 0.6083  Mult_acc_5: 0.3275  Mult_acc_7: 0.2314  MAE: 1.5127  Corr: 0.3485 
2024-06-13 14:01:14:INFO:TRAIN-(cmcm) (2/17/3)>> loss: 0.8171
2024-06-13 14:01:16:INFO:VAL-(cmcm) >>
2024-06-13 14:01:16:INFO:M: >>  Has0_acc_2: 0.6812  Has0_F1_score: 0.6542  Non0_acc_2: 0.6806  Non0_F1_score: 0.6534  Mult_acc_5: 0.3406  Mult_acc_7: 0.2533  MAE: 1.3612  Corr: 0.3760 
2024-06-13 14:01:31:INFO:TRAIN-(cmcm) (3/18/3)>> loss: 0.8046
2024-06-13 14:01:34:INFO:VAL-(cmcm) >>
2024-06-13 14:01:34:INFO:M: >>  Has0_acc_2: 0.7074  Has0_F1_score: 0.7020  Non0_acc_2: 0.7130  Non0_F1_score: 0.7103  Mult_acc_5: 0.3886  Mult_acc_7: 0.3188  MAE: 1.1874  Corr: 0.4773 
2024-06-13 14:01:34:INFO:Saving checkpoint at epoch 18 to results/models/cmcm-mosi-regression.pth.
2024-06-13 14:01:50:INFO:TRAIN-(cmcm) (1/19/3)>> loss: 0.8010
2024-06-13 14:01:52:INFO:VAL-(cmcm) >>
2024-06-13 14:01:52:INFO:M: >>  Has0_acc_2: 0.6201  Has0_F1_score: 0.5140  Non0_acc_2: 0.6528  Non0_F1_score: 0.6440  Mult_acc_5: 0.3493  Mult_acc_7: 0.2795  MAE: 1.3887  Corr: 0.3110 
2024-06-13 14:02:07:INFO:TRAIN-(cmcm) (2/20/3)>> loss: 0.7903
2024-06-13 14:02:10:INFO:VAL-(cmcm) >>
2024-06-13 14:02:10:INFO:M: >>  Has0_acc_2: 0.6900  Has0_F1_score: 0.6888  Non0_acc_2: 0.7222  Non0_F1_score: 0.7209  Mult_acc_5: 0.3319  Mult_acc_7: 0.2664  MAE: 1.3353  Corr: 0.5034 
2024-06-13 14:02:24:INFO:TRAIN-(cmcm) (3/21/3)>> loss: 0.7808
2024-06-13 14:02:27:INFO:VAL-(cmcm) >>
2024-06-13 14:02:27:INFO:M: >>  Has0_acc_2: 0.7249  Has0_F1_score: 0.7271  Non0_acc_2: 0.6898  Non0_F1_score: 0.6904  Mult_acc_5: 0.3406  Mult_acc_7: 0.2882  MAE: 1.1835  Corr: 0.5365 
2024-06-13 14:02:27:INFO:Saving checkpoint at epoch 21 to results/models/cmcm-mosi-regression.pth.
2024-06-13 14:02:43:INFO:TRAIN-(cmcm) (1/22/3)>> loss: 0.7700
2024-06-13 14:02:45:INFO:VAL-(cmcm) >>
2024-06-13 14:02:45:INFO:M: >>  Has0_acc_2: 0.6463  Has0_F1_score: 0.6363  Non0_acc_2: 0.6528  Non0_F1_score: 0.6394  Mult_acc_5: 0.3231  Mult_acc_7: 0.2751  MAE: 1.2423  Corr: 0.5290 
2024-06-13 14:03:00:INFO:TRAIN-(cmcm) (2/23/3)>> loss: 0.7664
2024-06-13 14:03:02:INFO:VAL-(cmcm) >>
2024-06-13 14:03:02:INFO:M: >>  Has0_acc_2: 0.7074  Has0_F1_score: 0.7103  Non0_acc_2: 0.6620  Non0_F1_score: 0.6601  Mult_acc_5: 0.3057  Mult_acc_7: 0.2445  MAE: 1.2245  Corr: 0.4718 
2024-06-13 14:03:17:INFO:TRAIN-(cmcm) (3/24/3)>> loss: 0.7632
2024-06-13 14:03:20:INFO:VAL-(cmcm) >>
2024-06-13 14:03:20:INFO:M: >>  Has0_acc_2: 0.6987  Has0_F1_score: 0.7014  Non0_acc_2: 0.6667  Non0_F1_score: 0.6592  Mult_acc_5: 0.3668  Mult_acc_7: 0.2926  MAE: 1.2564  Corr: 0.4923 
2024-06-13 14:03:35:INFO:TRAIN-(cmcm) (4/25/3)>> loss: 0.7500
2024-06-13 14:03:37:INFO:VAL-(cmcm) >>
2024-06-13 14:03:37:INFO:M: >>  Has0_acc_2: 0.7074  Has0_F1_score: 0.7091  Non0_acc_2: 0.6759  Non0_F1_score: 0.6696  Mult_acc_5: 0.3231  Mult_acc_7: 0.2489  MAE: 1.2564  Corr: 0.5129 
2024-06-13 14:03:52:INFO:TRAIN-(cmcm) (5/26/3)>> loss: 0.7544
2024-06-13 14:03:55:INFO:VAL-(cmcm) >>
2024-06-13 14:03:55:INFO:M: >>  Has0_acc_2: 0.6987  Has0_F1_score: 0.7012  Non0_acc_2: 0.6667  Non0_F1_score: 0.6629  Mult_acc_5: 0.3231  Mult_acc_7: 0.2707  MAE: 1.1568  Corr: 0.5584 
2024-06-13 14:03:55:INFO:Saving checkpoint at epoch 26 to results/models/cmcm-mosi-regression.pth.
2024-06-13 14:04:10:INFO:TRAIN-(cmcm) (1/27/3)>> loss: 0.7434
2024-06-13 14:04:13:INFO:VAL-(cmcm) >>
2024-06-13 14:04:13:INFO:M: >>  Has0_acc_2: 0.6812  Has0_F1_score: 0.6839  Non0_acc_2: 0.6759  Non0_F1_score: 0.6759  Mult_acc_5: 0.3319  Mult_acc_7: 0.2576  MAE: 1.2315  Corr: 0.5045 
2024-06-13 14:04:27:INFO:TRAIN-(cmcm) (2/28/3)>> loss: 0.7372
2024-06-13 14:04:30:INFO:VAL-(cmcm) >>
2024-06-13 14:04:30:INFO:M: >>  Has0_acc_2: 0.7511  Has0_F1_score: 0.7480  Non0_acc_2: 0.6944  Non0_F1_score: 0.6952  Mult_acc_5: 0.3493  Mult_acc_7: 0.2882  MAE: 1.1490  Corr: 0.5206 
2024-06-13 14:04:30:INFO:Saving checkpoint at epoch 28 to results/models/cmcm-mosi-regression.pth.
2024-06-13 14:04:46:INFO:TRAIN-(cmcm) (1/29/3)>> loss: 0.7265
2024-06-13 14:04:48:INFO:VAL-(cmcm) >>
2024-06-13 14:04:48:INFO:M: >>  Has0_acc_2: 0.7336  Has0_F1_score: 0.7358  Non0_acc_2: 0.7176  Non0_F1_score: 0.7187  Mult_acc_5: 0.3974  Mult_acc_7: 0.3100  MAE: 1.1315  Corr: 0.5471 
2024-06-13 14:04:49:INFO:Saving checkpoint at epoch 29 to results/models/cmcm-mosi-regression.pth.
2024-06-13 14:05:04:INFO:TRAIN-(cmcm) (1/30/3)>> loss: 0.7206
2024-06-13 14:05:06:INFO:VAL-(cmcm) >>
2024-06-13 14:05:07:INFO:M: >>  Has0_acc_2: 0.7293  Has0_F1_score: 0.7220  Non0_acc_2: 0.6435  Non0_F1_score: 0.6349  Mult_acc_5: 0.3668  Mult_acc_7: 0.3100  MAE: 1.1499  Corr: 0.4902 
2024-06-13 14:05:21:INFO:TRAIN-(cmcm) (2/31/3)>> loss: 0.7227
2024-06-13 14:05:24:INFO:VAL-(cmcm) >>
2024-06-13 14:05:24:INFO:M: >>  Has0_acc_2: 0.7249  Has0_F1_score: 0.7274  Non0_acc_2: 0.7315  Non0_F1_score: 0.7329  Mult_acc_5: 0.3668  Mult_acc_7: 0.2882  MAE: 1.1280  Corr: 0.5407 
2024-06-13 14:05:24:INFO:Saving checkpoint at epoch 31 to results/models/cmcm-mosi-regression.pth.
2024-06-13 14:05:39:INFO:TRAIN-(cmcm) (1/32/3)>> loss: 0.7116
2024-06-13 14:05:42:INFO:VAL-(cmcm) >>
2024-06-13 14:05:42:INFO:M: >>  Has0_acc_2: 0.6987  Has0_F1_score: 0.7014  Non0_acc_2: 0.6713  Non0_F1_score: 0.6694  Mult_acc_5: 0.3231  Mult_acc_7: 0.2620  MAE: 1.1852  Corr: 0.5040 
2024-06-13 14:05:57:INFO:TRAIN-(cmcm) (2/33/3)>> loss: 0.7123
2024-06-13 14:05:59:INFO:VAL-(cmcm) >>
2024-06-13 14:05:59:INFO:M: >>  Has0_acc_2: 0.7598  Has0_F1_score: 0.7608  Non0_acc_2: 0.7361  Non0_F1_score: 0.7376  Mult_acc_5: 0.3974  Mult_acc_7: 0.3100  MAE: 1.0918  Corr: 0.5449 
2024-06-13 14:06:00:INFO:Saving checkpoint at epoch 33 to results/models/cmcm-mosi-regression.pth.
2024-06-13 14:06:15:INFO:TRAIN-(cmcm) (1/34/3)>> loss: 0.6974
2024-06-13 14:06:17:INFO:VAL-(cmcm) >>
2024-06-13 14:06:17:INFO:M: >>  Has0_acc_2: 0.7511  Has0_F1_score: 0.7527  Non0_acc_2: 0.7778  Non0_F1_score: 0.7778  Mult_acc_5: 0.3144  Mult_acc_7: 0.2576  MAE: 1.0983  Corr: 0.5580 
2024-06-13 14:06:32:INFO:TRAIN-(cmcm) (2/35/3)>> loss: 0.6956
2024-06-13 14:06:35:INFO:VAL-(cmcm) >>
2024-06-13 14:06:35:INFO:M: >>  Has0_acc_2: 0.7031  Has0_F1_score: 0.7059  Non0_acc_2: 0.6528  Non0_F1_score: 0.6500  Mult_acc_5: 0.3493  Mult_acc_7: 0.2838  MAE: 1.2245  Corr: 0.5022 
2024-06-13 14:06:50:INFO:TRAIN-(cmcm) (3/36/3)>> loss: 0.6872
2024-06-13 14:06:52:INFO:VAL-(cmcm) >>
2024-06-13 14:06:52:INFO:M: >>  Has0_acc_2: 0.7118  Has0_F1_score: 0.7143  Non0_acc_2: 0.7176  Non0_F1_score: 0.7187  Mult_acc_5: 0.3537  Mult_acc_7: 0.2838  MAE: 1.1586  Corr: 0.5193 
2024-06-13 14:07:07:INFO:TRAIN-(cmcm) (4/37/3)>> loss: 0.6845
2024-06-13 14:07:09:INFO:VAL-(cmcm) >>
2024-06-13 14:07:09:INFO:M: >>  Has0_acc_2: 0.7467  Has0_F1_score: 0.7457  Non0_acc_2: 0.7593  Non0_F1_score: 0.7589  Mult_acc_5: 0.4061  Mult_acc_7: 0.3057  MAE: 1.1599  Corr: 0.5333 
2024-06-13 14:07:24:INFO:TRAIN-(cmcm) (5/38/3)>> loss: 0.6832
2024-06-13 14:07:27:INFO:VAL-(cmcm) >>
2024-06-13 14:07:27:INFO:M: >>  Has0_acc_2: 0.7336  Has0_F1_score: 0.7350  Non0_acc_2: 0.7546  Non0_F1_score: 0.7559  Mult_acc_5: 0.3799  Mult_acc_7: 0.2751  MAE: 1.1529  Corr: 0.5412 
2024-06-13 14:07:42:INFO:TRAIN-(cmcm) (6/39/3)>> loss: 0.6693
2024-06-13 14:07:44:INFO:VAL-(cmcm) >>
2024-06-13 14:07:44:INFO:M: >>  Has0_acc_2: 0.7293  Has0_F1_score: 0.7276  Non0_acc_2: 0.7083  Non0_F1_score: 0.7096  Mult_acc_5: 0.3712  Mult_acc_7: 0.2969  MAE: 1.1857  Corr: 0.4978 
2024-06-13 14:07:59:INFO:TRAIN-(cmcm) (7/40/3)>> loss: 0.6638
2024-06-13 14:08:01:INFO:VAL-(cmcm) >>
2024-06-13 14:08:01:INFO:M: >>  Has0_acc_2: 0.7205  Has0_F1_score: 0.7218  Non0_acc_2: 0.7454  Non0_F1_score: 0.7465  Mult_acc_5: 0.3668  Mult_acc_7: 0.2838  MAE: 1.1538  Corr: 0.5141 
2024-06-13 14:08:16:INFO:TRAIN-(cmcm) (8/41/3)>> loss: 0.6568
2024-06-13 14:08:19:INFO:VAL-(cmcm) >>
2024-06-13 14:08:19:INFO:M: >>  Has0_acc_2: 0.7424  Has0_F1_score: 0.7442  Non0_acc_2: 0.7083  Non0_F1_score: 0.7089  Mult_acc_5: 0.3712  Mult_acc_7: 0.2969  MAE: 1.1455  Corr: 0.5149 
2024-06-13 14:08:34:INFO:TRAIN-(cmcm) (9/42/3)>> loss: 0.6554
2024-06-13 14:08:36:INFO:VAL-(cmcm) >>
2024-06-13 14:08:36:INFO:M: >>  Has0_acc_2: 0.7031  Has0_F1_score: 0.6842  Non0_acc_2: 0.6991  Non0_F1_score: 0.6892  Mult_acc_5: 0.3712  Mult_acc_7: 0.2751  MAE: 1.2237  Corr: 0.4822 
2024-06-13 14:08:51:INFO:TRAIN-(cmcm) (10/43/3)>> loss: 0.6437
2024-06-13 14:08:53:INFO:VAL-(cmcm) >>
2024-06-13 14:08:53:INFO:M: >>  Has0_acc_2: 0.7118  Has0_F1_score: 0.7123  Non0_acc_2: 0.7130  Non0_F1_score: 0.7145  Mult_acc_5: 0.3886  Mult_acc_7: 0.2926  MAE: 1.1730  Corr: 0.5118 
2024-06-13 14:09:01:INFO:TEST-(cmcm) >>
2024-06-13 14:09:01:INFO:M: >>  Has0_acc_2: 0.7259  Has0_F1_score: 0.7266  Non0_acc_2: 0.7561  Non0_F1_score: 0.7550  Mult_acc_5: 0.3557  Mult_acc_7: 0.3105  MAE: 1.1244  Corr: 0.5416 
2024-06-13 14:09:01:INFO:Results are added to results/results/mosi-regression-80.csv...
2024-06-13 14:09:01:INFO:Start running cmcm...
2024-06-13 14:09:01:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 6, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 80, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 4444}>
2024-06-13 14:09:01:INFO:Let's use the GPU 1 !
2024-06-13 14:09:01:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 14:09:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718258942 HTTP/1.1" 200 235
2024-06-13 14:09:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 14:09:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 14:09:03:INFO:train samples: (1284,)
2024-06-13 14:09:03:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 14:09:03:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718258944 HTTP/1.1" 200 235
2024-06-13 14:09:04:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 14:09:04:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 14:09:05:INFO:valid samples: (229,)
2024-06-13 14:09:05:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 14:09:05:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718258945 HTTP/1.1" 200 235
2024-06-13 14:09:05:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 14:09:06:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 14:09:06:INFO:test samples: (686,)
2024-06-13 14:09:06:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 14:09:07:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718258947 HTTP/1.1" 200 235
2024-06-13 14:09:07:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 14:09:07:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 14:09:08:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 14:09:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718258948 HTTP/1.1" 200 235
2024-06-13 14:09:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 14:09:09:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 14:09:09:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-13 14:09:09:WARNING:Try importing flash-attention for faster inference...
2024-06-13 14:09:09:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-13 14:09:09:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-13 14:09:09:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-13 14:09:10:INFO:trainable params: 1310288 || all params: 1838138960 || trainable%: 0.07128340286090232
2024-06-13 14:09:10:INFO:Init labels...
2024-06-13 14:09:10:INFO:Start training...
2024-06-13 14:09:25:INFO:TRAIN-(cmcm) (1/1/4)>> loss: 4.2319
2024-06-13 14:09:28:INFO:VAL-(cmcm) >>
2024-06-13 14:09:28:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4259  Non0_F1_score: 0.2701  Mult_acc_5: 0.2140  Mult_acc_7: 0.2140  MAE: 1.4370  Corr: -0.0169 
2024-06-13 14:09:28:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-13 14:09:43:INFO:TRAIN-(cmcm) (1/2/4)>> loss: 2.3680
2024-06-13 14:09:46:INFO:VAL-(cmcm) >>
2024-06-13 14:09:46:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.5371  Non0_acc_2: 0.5694  Non0_F1_score: 0.5236  Mult_acc_5: 0.1834  Mult_acc_7: 0.1834  MAE: 1.4711  Corr: 0.0110 
2024-06-13 14:10:01:INFO:TRAIN-(cmcm) (2/3/4)>> loss: 1.0584
2024-06-13 14:10:03:INFO:VAL-(cmcm) >>
2024-06-13 14:10:03:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.4679  Non0_acc_2: 0.5417  Non0_F1_score: 0.4592  Mult_acc_5: 0.1878  Mult_acc_7: 0.1659  MAE: 1.5510  Corr: -0.0133 
2024-06-13 14:10:18:INFO:TRAIN-(cmcm) (3/4/4)>> loss: 0.9345
2024-06-13 14:10:20:INFO:VAL-(cmcm) >>
2024-06-13 14:10:20:INFO:M: >>  Has0_acc_2: 0.4803  Has0_F1_score: 0.4243  Non0_acc_2: 0.5000  Non0_F1_score: 0.4397  Mult_acc_5: 0.1528  Mult_acc_7: 0.1528  MAE: 1.7916  Corr: 0.0835 
2024-06-13 14:10:35:INFO:TRAIN-(cmcm) (4/5/4)>> loss: 0.9200
2024-06-13 14:10:38:INFO:VAL-(cmcm) >>
2024-06-13 14:10:38:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.4513  Non0_acc_2: 0.5602  Non0_F1_score: 0.4275  Mult_acc_5: 0.1659  Mult_acc_7: 0.1616  MAE: 1.5833  Corr: 0.0105 
2024-06-13 14:10:53:INFO:TRAIN-(cmcm) (5/6/4)>> loss: 2.4154
2024-06-13 14:10:55:INFO:VAL-(cmcm) >>
2024-06-13 14:10:55:INFO:M: >>  Has0_acc_2: 0.5153  Has0_F1_score: 0.5129  Non0_acc_2: 0.5046  Non0_F1_score: 0.5016  Mult_acc_5: 0.1790  Mult_acc_7: 0.1528  MAE: 1.7401  Corr: -0.0089 
2024-06-13 14:11:10:INFO:TRAIN-(cmcm) (6/7/4)>> loss: 1.0636
2024-06-13 14:11:12:INFO:VAL-(cmcm) >>
2024-06-13 14:11:12:INFO:M: >>  Has0_acc_2: 0.4192  Has0_F1_score: 0.3443  Non0_acc_2: 0.4352  Non0_F1_score: 0.3583  Mult_acc_5: 0.2009  Mult_acc_7: 0.1659  MAE: 2.0663  Corr: 0.0051 
2024-06-13 14:11:27:INFO:TRAIN-(cmcm) (7/8/4)>> loss: 0.9378
2024-06-13 14:11:30:INFO:VAL-(cmcm) >>
2024-06-13 14:11:30:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.5445  Non0_acc_2: 0.5926  Non0_F1_score: 0.5337  Mult_acc_5: 0.3013  Mult_acc_7: 0.2227  MAE: 1.5905  Corr: 0.1082 
2024-06-13 14:11:45:INFO:TRAIN-(cmcm) (8/9/4)>> loss: 0.8909
2024-06-13 14:11:47:INFO:VAL-(cmcm) >>
2024-06-13 14:11:47:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5927  Non0_acc_2: 0.5972  Non0_F1_score: 0.5984  Mult_acc_5: 0.2664  Mult_acc_7: 0.1878  MAE: 1.6193  Corr: 0.1437 
2024-06-13 14:12:02:INFO:TRAIN-(cmcm) (9/10/4)>> loss: 0.8752
2024-06-13 14:12:04:INFO:VAL-(cmcm) >>
2024-06-13 14:12:04:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4700  Non0_acc_2: 0.5741  Non0_F1_score: 0.4420  Mult_acc_5: 0.2489  Mult_acc_7: 0.2052  MAE: 1.6446  Corr: 0.0140 
2024-06-13 14:12:19:INFO:TRAIN-(cmcm) (10/11/4)>> loss: 0.8655
2024-06-13 14:12:22:INFO:VAL-(cmcm) >>
2024-06-13 14:12:22:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.5086  Non0_acc_2: 0.5972  Non0_F1_score: 0.5054  Mult_acc_5: 0.2969  Mult_acc_7: 0.2489  MAE: 1.6001  Corr: -0.0270 
2024-06-13 14:12:29:INFO:TEST-(cmcm) >>
2024-06-13 14:12:29:INFO:M: >>  Has0_acc_2: 0.4475  Has0_F1_score: 0.2767  Non0_acc_2: 0.5762  Non0_F1_score: 0.4453  Mult_acc_5: 0.1545  Mult_acc_7: 0.1545  MAE: 1.4198  Corr: 0.0023 
2024-06-13 14:12:30:INFO:Results are added to results/results/mosi-regression-80.csv...
2024-06-13 14:12:30:INFO:Start running cmcm...
2024-06-13 14:12:30:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 6, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 80, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 5555}>
2024-06-13 14:12:30:INFO:Let's use the GPU 1 !
2024-06-13 14:12:30:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 14:12:30:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718259150 HTTP/1.1" 200 235
2024-06-13 14:12:30:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 14:12:31:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 14:12:31:INFO:train samples: (1284,)
2024-06-13 14:12:31:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 14:12:32:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718259152 HTTP/1.1" 200 235
2024-06-13 14:12:32:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 14:12:33:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 14:12:33:INFO:valid samples: (229,)
2024-06-13 14:12:33:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 14:12:34:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718259154 HTTP/1.1" 200 235
2024-06-13 14:12:34:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 14:12:34:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 14:12:35:INFO:test samples: (686,)
2024-06-13 14:12:35:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 14:12:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718259155 HTTP/1.1" 200 235
2024-06-13 14:12:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 14:12:36:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 14:12:36:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 14:12:36:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718259157 HTTP/1.1" 200 235
2024-06-13 14:12:37:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 14:12:37:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 14:12:37:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-13 14:12:37:WARNING:Try importing flash-attention for faster inference...
2024-06-13 14:12:37:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-13 14:12:37:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-13 14:12:37:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-13 14:12:38:INFO:trainable params: 1310288 || all params: 1838138960 || trainable%: 0.07128340286090232
2024-06-13 14:12:38:INFO:Init labels...
2024-06-13 14:12:38:INFO:Start training...
2024-06-13 14:12:53:INFO:TRAIN-(cmcm) (1/1/5)>> loss: 3.2459
2024-06-13 14:12:55:INFO:VAL-(cmcm) >>
2024-06-13 14:12:55:INFO:M: >>  Has0_acc_2: 0.5502  Has0_F1_score: 0.5520  Non0_acc_2: 0.5324  Non0_F1_score: 0.5338  Mult_acc_5: 0.2227  Mult_acc_7: 0.2227  MAE: 1.4571  Corr: 0.0586 
2024-06-13 14:12:56:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-13 14:13:11:INFO:TRAIN-(cmcm) (1/2/5)>> loss: 1.0321
2024-06-13 14:13:13:INFO:VAL-(cmcm) >>
2024-06-13 14:13:13:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.5529  Non0_acc_2: 0.5787  Non0_F1_score: 0.5530  Mult_acc_5: 0.1878  Mult_acc_7: 0.1878  MAE: 1.5087  Corr: 0.0692 
2024-06-13 14:13:28:INFO:TRAIN-(cmcm) (2/3/5)>> loss: 0.9072
2024-06-13 14:13:31:INFO:VAL-(cmcm) >>
2024-06-13 14:13:31:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5028  Non0_acc_2: 0.5417  Non0_F1_score: 0.4929  Mult_acc_5: 0.1790  Mult_acc_7: 0.1790  MAE: 1.4938  Corr: 0.0289 
2024-06-13 14:13:46:INFO:TRAIN-(cmcm) (3/4/5)>> loss: 0.9478
2024-06-13 14:13:48:INFO:VAL-(cmcm) >>
2024-06-13 14:13:48:INFO:M: >>  Has0_acc_2: 0.5633  Has0_F1_score: 0.4969  Non0_acc_2: 0.5463  Non0_F1_score: 0.4764  Mult_acc_5: 0.1965  Mult_acc_7: 0.1834  MAE: 1.5698  Corr: -0.0035 
2024-06-13 14:14:03:INFO:TRAIN-(cmcm) (4/5/5)>> loss: 0.8908
2024-06-13 14:14:05:INFO:VAL-(cmcm) >>
2024-06-13 14:14:05:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5410  Non0_acc_2: 0.5694  Non0_F1_score: 0.5268  Mult_acc_5: 0.1703  Mult_acc_7: 0.1703  MAE: 1.5800  Corr: 0.0168 
2024-06-13 14:14:20:INFO:TRAIN-(cmcm) (5/6/5)>> loss: 0.8732
2024-06-13 14:14:23:INFO:VAL-(cmcm) >>
2024-06-13 14:14:23:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.5878  Non0_acc_2: 0.5926  Non0_F1_score: 0.5931  Mult_acc_5: 0.2664  Mult_acc_7: 0.2096  MAE: 1.5983  Corr: 0.1283 
2024-06-13 14:14:37:INFO:TRAIN-(cmcm) (6/7/5)>> loss: 0.8690
2024-06-13 14:14:40:INFO:VAL-(cmcm) >>
2024-06-13 14:14:40:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5309  Non0_acc_2: 0.5694  Non0_F1_score: 0.5131  Mult_acc_5: 0.2009  Mult_acc_7: 0.2009  MAE: 1.4528  Corr: 0.1199 
2024-06-13 14:14:40:INFO:Saving checkpoint at epoch 7 to results/models/cmcm-mosi-regression.pth.
2024-06-13 14:14:55:INFO:TRAIN-(cmcm) (1/8/5)>> loss: 0.8722
2024-06-13 14:14:58:INFO:VAL-(cmcm) >>
2024-06-13 14:14:58:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4917  Non0_acc_2: 0.5787  Non0_F1_score: 0.4649  Mult_acc_5: 0.2620  Mult_acc_7: 0.1921  MAE: 1.7774  Corr: -0.0249 
2024-06-13 14:15:13:INFO:TRAIN-(cmcm) (2/9/5)>> loss: 0.8664
2024-06-13 14:15:15:INFO:VAL-(cmcm) >>
2024-06-13 14:15:15:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.5114  Non0_acc_2: 0.5833  Non0_F1_score: 0.4856  Mult_acc_5: 0.2707  Mult_acc_7: 0.2052  MAE: 1.6595  Corr: 0.0258 
2024-06-13 14:15:30:INFO:TRAIN-(cmcm) (3/10/5)>> loss: 0.8597
2024-06-13 14:15:33:INFO:VAL-(cmcm) >>
2024-06-13 14:15:33:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4607  Non0_acc_2: 0.5509  Non0_F1_score: 0.4749  Mult_acc_5: 0.2271  Mult_acc_7: 0.1878  MAE: 1.5781  Corr: -0.0014 
2024-06-13 14:15:47:INFO:TRAIN-(cmcm) (4/11/5)>> loss: 0.8543
2024-06-13 14:15:50:INFO:VAL-(cmcm) >>
2024-06-13 14:15:50:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.5774  Non0_acc_2: 0.5972  Non0_F1_score: 0.5656  Mult_acc_5: 0.2140  Mult_acc_7: 0.1921  MAE: 1.3864  Corr: 0.2189 
2024-06-13 14:15:50:INFO:Saving checkpoint at epoch 11 to results/models/cmcm-mosi-regression.pth.
2024-06-13 14:16:05:INFO:TRAIN-(cmcm) (1/12/5)>> loss: 0.8509
2024-06-13 14:16:08:INFO:VAL-(cmcm) >>
2024-06-13 14:16:08:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.5263  Non0_acc_2: 0.5926  Non0_F1_score: 0.5298  Mult_acc_5: 0.2664  Mult_acc_7: 0.2096  MAE: 1.5778  Corr: 0.0607 
2024-06-13 14:16:23:INFO:TRAIN-(cmcm) (2/13/5)>> loss: 0.8528
2024-06-13 14:16:25:INFO:VAL-(cmcm) >>
2024-06-13 14:16:25:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.5927  Non0_acc_2: 0.5833  Non0_F1_score: 0.5784  Mult_acc_5: 0.2795  Mult_acc_7: 0.2052  MAE: 1.5468  Corr: 0.1761 
2024-06-13 14:16:40:INFO:TRAIN-(cmcm) (3/14/5)>> loss: 0.8421
2024-06-13 14:16:43:INFO:VAL-(cmcm) >>
2024-06-13 14:16:43:INFO:M: >>  Has0_acc_2: 0.6201  Has0_F1_score: 0.6153  Non0_acc_2: 0.6204  Non0_F1_score: 0.6138  Mult_acc_5: 0.3057  Mult_acc_7: 0.2358  MAE: 1.5114  Corr: 0.2019 
2024-06-13 14:16:57:INFO:TRAIN-(cmcm) (4/15/5)>> loss: 0.8482
2024-06-13 14:17:00:INFO:VAL-(cmcm) >>
2024-06-13 14:17:00:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.5032  Non0_acc_2: 0.5787  Non0_F1_score: 0.4770  Mult_acc_5: 0.2751  Mult_acc_7: 0.2140  MAE: 1.6232  Corr: 0.0561 
2024-06-13 14:17:15:INFO:TRAIN-(cmcm) (5/16/5)>> loss: 0.8334
2024-06-13 14:17:17:INFO:VAL-(cmcm) >>
2024-06-13 14:17:17:INFO:M: >>  Has0_acc_2: 0.6157  Has0_F1_score: 0.5368  Non0_acc_2: 0.6111  Non0_F1_score: 0.5390  Mult_acc_5: 0.2838  Mult_acc_7: 0.2183  MAE: 1.5603  Corr: 0.1787 
2024-06-13 14:17:32:INFO:TRAIN-(cmcm) (6/17/5)>> loss: 0.8386
2024-06-13 14:17:34:INFO:VAL-(cmcm) >>
2024-06-13 14:17:34:INFO:M: >>  Has0_acc_2: 0.6157  Has0_F1_score: 0.5456  Non0_acc_2: 0.5972  Non0_F1_score: 0.5409  Mult_acc_5: 0.2707  Mult_acc_7: 0.1921  MAE: 1.6001  Corr: 0.1197 
2024-06-13 14:17:49:INFO:TRAIN-(cmcm) (7/18/5)>> loss: 0.8234
2024-06-13 14:17:52:INFO:VAL-(cmcm) >>
2024-06-13 14:17:52:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.5856  Non0_acc_2: 0.5972  Non0_F1_score: 0.5727  Mult_acc_5: 0.2664  Mult_acc_7: 0.2227  MAE: 1.5241  Corr: 0.1902 
2024-06-13 14:18:07:INFO:TRAIN-(cmcm) (8/19/5)>> loss: 0.8184
2024-06-13 14:18:09:INFO:VAL-(cmcm) >>
2024-06-13 14:18:09:INFO:M: >>  Has0_acc_2: 0.5633  Has0_F1_score: 0.5517  Non0_acc_2: 0.5417  Non0_F1_score: 0.5135  Mult_acc_5: 0.2140  Mult_acc_7: 0.1878  MAE: 1.5049  Corr: 0.2659 
2024-06-13 14:18:24:INFO:TRAIN-(cmcm) (9/20/5)>> loss: 0.8096
2024-06-13 14:18:26:INFO:VAL-(cmcm) >>
2024-06-13 14:18:26:INFO:M: >>  Has0_acc_2: 0.4934  Has0_F1_score: 0.4498  Non0_acc_2: 0.5093  Non0_F1_score: 0.4605  Mult_acc_5: 0.2052  Mult_acc_7: 0.1921  MAE: 1.6743  Corr: 0.1234 
2024-06-13 14:18:41:INFO:TRAIN-(cmcm) (10/21/5)>> loss: 0.8059
2024-06-13 14:18:44:INFO:VAL-(cmcm) >>
2024-06-13 14:18:44:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5670  Non0_acc_2: 0.5926  Non0_F1_score: 0.5869  Mult_acc_5: 0.2620  Mult_acc_7: 0.2271  MAE: 1.4852  Corr: 0.2507 
2024-06-13 14:18:51:INFO:TEST-(cmcm) >>
2024-06-13 14:18:51:INFO:M: >>  Has0_acc_2: 0.5802  Has0_F1_score: 0.5741  Non0_acc_2: 0.5732  Non0_F1_score: 0.5689  Mult_acc_5: 0.2055  Mult_acc_7: 0.2041  MAE: 1.3882  Corr: 0.1511 
2024-06-13 14:18:52:INFO:Results are added to results/results/mosi-regression-80.csv...
2024-06-13 14:18:52:INFO:Start running cmcm...
2024-06-13 14:18:52:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 6, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 90, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-06-13 14:18:52:INFO:Let's use the GPU 1 !
2024-06-13 14:18:52:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 14:18:52:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718259532 HTTP/1.1" 200 235
2024-06-13 14:18:52:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 14:18:53:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 14:18:53:INFO:train samples: (1284,)
2024-06-13 14:18:53:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 14:18:54:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718259534 HTTP/1.1" 200 235
2024-06-13 14:18:54:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 14:18:55:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 14:18:55:INFO:valid samples: (229,)
2024-06-13 14:18:55:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 14:18:55:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718259536 HTTP/1.1" 200 235
2024-06-13 14:18:56:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 14:18:56:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 14:18:57:INFO:test samples: (686,)
2024-06-13 14:18:57:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 14:18:57:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718259537 HTTP/1.1" 200 235
2024-06-13 14:18:57:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 14:18:58:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 14:18:58:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 14:18:59:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718259539 HTTP/1.1" 200 235
2024-06-13 14:18:59:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 14:18:59:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 14:18:59:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-13 14:18:59:WARNING:Try importing flash-attention for faster inference...
2024-06-13 14:18:59:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-13 14:18:59:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-13 14:18:59:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-13 14:19:00:INFO:trainable params: 1310288 || all params: 1838138960 || trainable%: 0.07128340286090232
2024-06-13 14:19:00:INFO:Init labels...
2024-06-13 14:19:00:INFO:Start training...
2024-06-13 14:19:15:INFO:TRAIN-(cmcm) (1/1/1)>> loss: 3.8636
2024-06-13 14:19:18:INFO:VAL-(cmcm) >>
2024-06-13 14:19:18:INFO:M: >>  Has0_acc_2: 0.3843  Has0_F1_score: 0.2303  Non0_acc_2: 0.4167  Non0_F1_score: 0.2584  Mult_acc_5: 0.2052  Mult_acc_7: 0.2009  MAE: 1.6715  Corr: -0.0996 
2024-06-13 14:19:18:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-13 14:19:33:INFO:TRAIN-(cmcm) (1/2/1)>> loss: 1.1043
2024-06-13 14:19:36:INFO:VAL-(cmcm) >>
2024-06-13 14:19:36:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4607  Non0_acc_2: 0.5694  Non0_F1_score: 0.4323  Mult_acc_5: 0.2271  Mult_acc_7: 0.1747  MAE: 1.7337  Corr: -0.1330 
2024-06-13 14:19:51:INFO:TRAIN-(cmcm) (2/3/1)>> loss: 0.9306
2024-06-13 14:19:53:INFO:VAL-(cmcm) >>
2024-06-13 14:19:53:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5787  Non0_F1_score: 0.4291  Mult_acc_5: 0.1921  Mult_acc_7: 0.1921  MAE: 1.4881  Corr: -0.0533 
2024-06-13 14:19:54:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-mosi-regression.pth.
2024-06-13 14:20:09:INFO:TRAIN-(cmcm) (1/4/1)>> loss: 0.8882
2024-06-13 14:20:12:INFO:VAL-(cmcm) >>
2024-06-13 14:20:12:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.4645  Non0_acc_2: 0.5509  Non0_F1_score: 0.4362  Mult_acc_5: 0.2707  Mult_acc_7: 0.1965  MAE: 1.6586  Corr: -0.0368 
2024-06-13 14:20:27:INFO:TRAIN-(cmcm) (2/5/1)>> loss: 0.8799
2024-06-13 14:20:29:INFO:VAL-(cmcm) >>
2024-06-13 14:20:29:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.4996  Non0_acc_2: 0.5648  Non0_F1_score: 0.4791  Mult_acc_5: 0.1703  Mult_acc_7: 0.1703  MAE: 1.5602  Corr: -0.0101 
2024-06-13 14:20:44:INFO:TRAIN-(cmcm) (3/6/1)>> loss: 0.8755
2024-06-13 14:20:46:INFO:VAL-(cmcm) >>
2024-06-13 14:20:46:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5586  Non0_acc_2: 0.5694  Non0_F1_score: 0.5455  Mult_acc_5: 0.2795  Mult_acc_7: 0.2009  MAE: 1.6582  Corr: 0.0507 
2024-06-13 14:21:01:INFO:TRAIN-(cmcm) (4/7/1)>> loss: 0.8704
2024-06-13 14:21:04:INFO:VAL-(cmcm) >>
2024-06-13 14:21:04:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4652  Non0_acc_2: 0.5787  Non0_F1_score: 0.4370  Mult_acc_5: 0.2926  Mult_acc_7: 0.2183  MAE: 1.7206  Corr: 0.0436 
2024-06-13 14:21:18:INFO:TRAIN-(cmcm) (5/8/1)>> loss: 0.8705
2024-06-13 14:21:21:INFO:VAL-(cmcm) >>
2024-06-13 14:21:21:INFO:M: >>  Has0_acc_2: 0.5633  Has0_F1_score: 0.5331  Non0_acc_2: 0.4306  Non0_F1_score: 0.2797  Mult_acc_5: 0.2052  Mult_acc_7: 0.2052  MAE: 1.5423  Corr: 0.0001 
2024-06-13 14:21:36:INFO:TRAIN-(cmcm) (6/9/1)>> loss: 0.8648
2024-06-13 14:21:38:INFO:VAL-(cmcm) >>
2024-06-13 14:21:38:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5741  Non0_F1_score: 0.4187  Mult_acc_5: 0.2838  Mult_acc_7: 0.2052  MAE: 1.7215  Corr: -0.0632 
2024-06-13 14:21:53:INFO:TRAIN-(cmcm) (7/10/1)>> loss: 0.8616
2024-06-13 14:21:56:INFO:VAL-(cmcm) >>
2024-06-13 14:21:56:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.4939  Non0_acc_2: 0.5556  Non0_F1_score: 0.4731  Mult_acc_5: 0.2358  Mult_acc_7: 0.2052  MAE: 1.5881  Corr: 0.0164 
2024-06-13 14:22:10:INFO:TRAIN-(cmcm) (8/11/1)>> loss: 0.8620
2024-06-13 14:22:13:INFO:VAL-(cmcm) >>
2024-06-13 14:22:13:INFO:M: >>  Has0_acc_2: 0.5546  Has0_F1_score: 0.5263  Non0_acc_2: 0.5370  Non0_F1_score: 0.5075  Mult_acc_5: 0.2707  Mult_acc_7: 0.1921  MAE: 1.8568  Corr: -0.0222 
2024-06-13 14:22:28:INFO:TRAIN-(cmcm) (9/12/1)>> loss: 0.8524
2024-06-13 14:22:30:INFO:VAL-(cmcm) >>
2024-06-13 14:22:30:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5741  Non0_F1_score: 0.4187  Mult_acc_5: 0.1703  Mult_acc_7: 0.1703  MAE: 1.4309  Corr: 0.0059 
2024-06-13 14:22:31:INFO:Saving checkpoint at epoch 12 to results/models/cmcm-mosi-regression.pth.
2024-06-13 14:22:46:INFO:TRAIN-(cmcm) (1/13/1)>> loss: 0.8527
2024-06-13 14:22:49:INFO:VAL-(cmcm) >>
2024-06-13 14:22:49:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5189  Non0_acc_2: 0.5741  Non0_F1_score: 0.4997  Mult_acc_5: 0.2969  Mult_acc_7: 0.2183  MAE: 1.7621  Corr: 0.0226 
2024-06-13 14:23:04:INFO:TRAIN-(cmcm) (2/14/1)>> loss: 0.8544
2024-06-13 14:23:06:INFO:VAL-(cmcm) >>
2024-06-13 14:23:06:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.5215  Non0_acc_2: 0.5509  Non0_F1_score: 0.4960  Mult_acc_5: 0.1878  Mult_acc_7: 0.1834  MAE: 1.5091  Corr: 0.0262 
2024-06-13 14:23:21:INFO:TRAIN-(cmcm) (3/15/1)>> loss: 0.8552
2024-06-13 14:23:23:INFO:VAL-(cmcm) >>
2024-06-13 14:23:23:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5381  Non0_acc_2: 0.5185  Non0_F1_score: 0.5197  Mult_acc_5: 0.2183  Mult_acc_7: 0.1878  MAE: 1.5606  Corr: 0.0122 
2024-06-13 14:23:38:INFO:TRAIN-(cmcm) (4/16/1)>> loss: 0.8489
2024-06-13 14:23:41:INFO:VAL-(cmcm) >>
2024-06-13 14:23:41:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.5220  Non0_acc_2: 0.5509  Non0_F1_score: 0.5031  Mult_acc_5: 0.2620  Mult_acc_7: 0.2096  MAE: 1.7362  Corr: -0.0101 
2024-06-13 14:23:56:INFO:TRAIN-(cmcm) (5/17/1)>> loss: 0.8451
2024-06-13 14:23:58:INFO:VAL-(cmcm) >>
2024-06-13 14:23:58:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.5406  Non0_acc_2: 0.5417  Non0_F1_score: 0.5440  Mult_acc_5: 0.2664  Mult_acc_7: 0.2009  MAE: 1.6031  Corr: 0.0465 
2024-06-13 14:24:13:INFO:TRAIN-(cmcm) (6/18/1)>> loss: 0.8465
2024-06-13 14:24:16:INFO:VAL-(cmcm) >>
2024-06-13 14:24:16:INFO:M: >>  Has0_acc_2: 0.5546  Has0_F1_score: 0.5538  Non0_acc_2: 0.5556  Non0_F1_score: 0.5533  Mult_acc_5: 0.2096  Mult_acc_7: 0.1659  MAE: 1.6043  Corr: 0.0313 
2024-06-13 14:24:30:INFO:TRAIN-(cmcm) (7/19/1)>> loss: 0.8438
2024-06-13 14:24:33:INFO:VAL-(cmcm) >>
2024-06-13 14:24:33:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.4975  Non0_acc_2: 0.5694  Non0_F1_score: 0.4768  Mult_acc_5: 0.3057  Mult_acc_7: 0.2227  MAE: 1.7014  Corr: 0.0236 
2024-06-13 14:24:48:INFO:TRAIN-(cmcm) (8/20/1)>> loss: 0.8385
2024-06-13 14:24:50:INFO:VAL-(cmcm) >>
2024-06-13 14:24:50:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.5086  Non0_acc_2: 0.5926  Non0_F1_score: 0.4856  Mult_acc_5: 0.3144  Mult_acc_7: 0.2358  MAE: 1.5983  Corr: 0.1138 
2024-06-13 14:25:05:INFO:TRAIN-(cmcm) (9/21/1)>> loss: 0.8338
2024-06-13 14:25:08:INFO:VAL-(cmcm) >>
2024-06-13 14:25:08:INFO:M: >>  Has0_acc_2: 0.6157  Has0_F1_score: 0.6164  Non0_acc_2: 0.6157  Non0_F1_score: 0.6149  Mult_acc_5: 0.2751  Mult_acc_7: 0.2052  MAE: 1.6420  Corr: 0.1489 
2024-06-13 14:25:23:INFO:TRAIN-(cmcm) (10/22/1)>> loss: 0.8287
2024-06-13 14:25:25:INFO:VAL-(cmcm) >>
2024-06-13 14:25:25:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4978  Non0_acc_2: 0.5741  Non0_F1_score: 0.4851  Mult_acc_5: 0.2969  Mult_acc_7: 0.2227  MAE: 1.6560  Corr: 0.0259 
2024-06-13 14:25:33:INFO:TEST-(cmcm) >>
2024-06-13 14:25:33:INFO:M: >>  Has0_acc_2: 0.4475  Has0_F1_score: 0.2767  Non0_acc_2: 0.4223  Non0_F1_score: 0.2507  Mult_acc_5: 0.1618  Mult_acc_7: 0.1618  MAE: 1.6118  Corr: -0.0331 
2024-06-13 14:25:33:INFO:Results are added to results/results/mosi-regression-90.csv...
2024-06-13 14:25:33:INFO:Start running cmcm...
2024-06-13 14:25:33:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 6, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 90, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 2222}>
2024-06-13 14:25:33:INFO:Let's use the GPU 1 !
2024-06-13 14:25:33:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 14:25:34:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718259934 HTTP/1.1" 200 235
2024-06-13 14:25:34:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 14:25:34:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 14:25:35:INFO:train samples: (1284,)
2024-06-13 14:25:35:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 14:25:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718259936 HTTP/1.1" 200 235
2024-06-13 14:25:36:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 14:25:36:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 14:25:36:INFO:valid samples: (229,)
2024-06-13 14:25:37:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 14:25:37:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718259937 HTTP/1.1" 200 235
2024-06-13 14:25:37:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 14:25:38:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 14:25:38:INFO:test samples: (686,)
2024-06-13 14:25:38:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 14:25:39:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718259939 HTTP/1.1" 200 235
2024-06-13 14:25:39:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 14:25:39:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 14:25:40:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 14:25:40:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718259940 HTTP/1.1" 200 235
2024-06-13 14:25:40:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 14:25:41:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 14:25:41:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-13 14:25:41:WARNING:Try importing flash-attention for faster inference...
2024-06-13 14:25:41:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-13 14:25:41:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-13 14:25:41:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-13 14:25:42:INFO:trainable params: 1310288 || all params: 1838138960 || trainable%: 0.07128340286090232
2024-06-13 14:25:42:INFO:Init labels...
2024-06-13 14:25:42:INFO:Start training...
2024-06-13 14:25:57:INFO:TRAIN-(cmcm) (1/1/2)>> loss: 3.8174
2024-06-13 14:25:59:INFO:VAL-(cmcm) >>
2024-06-13 14:25:59:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4458  Non0_acc_2: 0.5694  Non0_F1_score: 0.4920  Mult_acc_5: 0.3013  Mult_acc_7: 0.1179  MAE: 2.4402  Corr: 0.0167 
2024-06-13 14:26:00:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-13 14:26:15:INFO:TRAIN-(cmcm) (1/2/2)>> loss: 1.2825
2024-06-13 14:26:18:INFO:VAL-(cmcm) >>
2024-06-13 14:26:18:INFO:M: >>  Has0_acc_2: 0.5546  Has0_F1_score: 0.5457  Non0_acc_2: 0.5463  Non0_F1_score: 0.5356  Mult_acc_5: 0.1965  Mult_acc_7: 0.1965  MAE: 1.5222  Corr: 0.0145 
2024-06-13 14:26:18:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-13 14:26:33:INFO:TRAIN-(cmcm) (1/3/2)>> loss: 1.0001
2024-06-13 14:26:36:INFO:VAL-(cmcm) >>
2024-06-13 14:26:36:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.4513  Non0_acc_2: 0.5648  Non0_F1_score: 0.4223  Mult_acc_5: 0.1834  Mult_acc_7: 0.1834  MAE: 1.5471  Corr: -0.0860 
2024-06-13 14:26:51:INFO:TRAIN-(cmcm) (2/4/2)>> loss: 0.9524
2024-06-13 14:26:53:INFO:VAL-(cmcm) >>
2024-06-13 14:26:53:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4923  Non0_acc_2: 0.5694  Non0_F1_score: 0.4655  Mult_acc_5: 0.2402  Mult_acc_7: 0.1659  MAE: 1.7302  Corr: -0.0305 
2024-06-13 14:27:08:INFO:TRAIN-(cmcm) (3/5/2)>> loss: 0.9397
2024-06-13 14:27:11:INFO:VAL-(cmcm) >>
2024-06-13 14:27:11:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.5013  Non0_acc_2: 0.5556  Non0_F1_score: 0.4780  Mult_acc_5: 0.1572  Mult_acc_7: 0.1572  MAE: 1.5659  Corr: -0.0073 
2024-06-13 14:27:25:INFO:TRAIN-(cmcm) (4/6/2)>> loss: 0.9257
2024-06-13 14:27:28:INFO:VAL-(cmcm) >>
2024-06-13 14:27:28:INFO:M: >>  Has0_acc_2: 0.4891  Has0_F1_score: 0.4923  Non0_acc_2: 0.4861  Non0_F1_score: 0.4871  Mult_acc_5: 0.1397  Mult_acc_7: 0.1397  MAE: 1.6909  Corr: -0.0168 
2024-06-13 14:27:43:INFO:TRAIN-(cmcm) (5/7/2)>> loss: 0.9075
2024-06-13 14:27:45:INFO:VAL-(cmcm) >>
2024-06-13 14:27:45:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.5178  Non0_acc_2: 0.5602  Non0_F1_score: 0.5026  Mult_acc_5: 0.1790  Mult_acc_7: 0.1616  MAE: 1.6807  Corr: -0.1222 
2024-06-13 14:28:00:INFO:TRAIN-(cmcm) (6/8/2)>> loss: 0.8966
2024-06-13 14:28:03:INFO:VAL-(cmcm) >>
2024-06-13 14:28:03:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.4438  Non0_acc_2: 0.5648  Non0_F1_score: 0.4144  Mult_acc_5: 0.2882  Mult_acc_7: 0.2052  MAE: 1.7293  Corr: -0.0508 
2024-06-13 14:28:17:INFO:TRAIN-(cmcm) (7/9/2)>> loss: 0.8920
2024-06-13 14:28:20:INFO:VAL-(cmcm) >>
2024-06-13 14:28:20:INFO:M: >>  Has0_acc_2: 0.5415  Has0_F1_score: 0.5084  Non0_acc_2: 0.5278  Non0_F1_score: 0.4921  Mult_acc_5: 0.2707  Mult_acc_7: 0.1921  MAE: 2.0140  Corr: -0.0611 
2024-06-13 14:28:35:INFO:TRAIN-(cmcm) (8/10/2)>> loss: 0.8924
2024-06-13 14:28:37:INFO:VAL-(cmcm) >>
2024-06-13 14:28:37:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.5882  Non0_acc_2: 0.5972  Non0_F1_score: 0.5980  Mult_acc_5: 0.2402  Mult_acc_7: 0.2009  MAE: 1.6302  Corr: 0.1514 
2024-06-13 14:28:52:INFO:TRAIN-(cmcm) (9/11/2)>> loss: 0.8862
2024-06-13 14:28:55:INFO:VAL-(cmcm) >>
2024-06-13 14:28:55:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.4653  Non0_acc_2: 0.5648  Non0_F1_score: 0.4371  Mult_acc_5: 0.1921  Mult_acc_7: 0.1703  MAE: 1.5909  Corr: -0.0365 
2024-06-13 14:29:09:INFO:TRAIN-(cmcm) (10/12/2)>> loss: 0.8842
2024-06-13 14:29:12:INFO:VAL-(cmcm) >>
2024-06-13 14:29:12:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.5140  Non0_acc_2: 0.5648  Non0_F1_score: 0.5019  Mult_acc_5: 0.1659  Mult_acc_7: 0.1659  MAE: 1.6126  Corr: -0.0162 
2024-06-13 14:29:19:INFO:TEST-(cmcm) >>
2024-06-13 14:29:19:INFO:M: >>  Has0_acc_2: 0.4927  Has0_F1_score: 0.4905  Non0_acc_2: 0.4848  Non0_F1_score: 0.4845  Mult_acc_5: 0.2012  Mult_acc_7: 0.1997  MAE: 1.6163  Corr: -0.0297 
2024-06-13 14:29:20:INFO:Results are added to results/results/mosi-regression-90.csv...
2024-06-13 14:29:20:INFO:Start running cmcm...
2024-06-13 14:29:20:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 6, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 90, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 3333}>
2024-06-13 14:29:20:INFO:Let's use the GPU 1 !
2024-06-13 14:29:20:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 14:29:20:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718260160 HTTP/1.1" 200 235
2024-06-13 14:29:20:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 14:29:21:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 14:29:21:INFO:train samples: (1284,)
2024-06-13 14:29:22:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 14:29:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718260162 HTTP/1.1" 200 235
2024-06-13 14:29:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 14:29:23:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 14:29:23:INFO:valid samples: (229,)
2024-06-13 14:29:23:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 14:29:23:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718260164 HTTP/1.1" 200 235
2024-06-13 14:29:24:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 14:29:24:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 14:29:25:INFO:test samples: (686,)
2024-06-13 14:29:25:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 14:29:25:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718260165 HTTP/1.1" 200 235
2024-06-13 14:29:25:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 14:29:26:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 14:29:26:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 14:29:26:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718260167 HTTP/1.1" 200 235
2024-06-13 14:29:27:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 14:29:27:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 14:29:27:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-13 14:29:27:WARNING:Try importing flash-attention for faster inference...
2024-06-13 14:29:27:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-13 14:29:27:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-13 14:29:27:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-13 14:29:28:INFO:trainable params: 1310288 || all params: 1838138960 || trainable%: 0.07128340286090232
2024-06-13 14:29:28:INFO:Init labels...
2024-06-13 14:29:28:INFO:Start training...
2024-06-13 14:29:43:INFO:TRAIN-(cmcm) (1/1/3)>> loss: 4.0674
2024-06-13 14:29:46:INFO:VAL-(cmcm) >>
2024-06-13 14:29:46:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4722  Non0_F1_score: 0.4529  Mult_acc_5: 0.2358  Mult_acc_7: 0.1965  MAE: 1.8031  Corr: -0.0236 
2024-06-13 14:29:46:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-13 14:30:01:INFO:TRAIN-(cmcm) (1/2/3)>> loss: 1.3841
2024-06-13 14:30:04:INFO:VAL-(cmcm) >>
2024-06-13 14:30:04:INFO:M: >>  Has0_acc_2: 0.4760  Has0_F1_score: 0.4772  Non0_acc_2: 0.4954  Non0_F1_score: 0.4644  Mult_acc_5: 0.2052  Mult_acc_7: 0.2052  MAE: 1.4825  Corr: 0.0363 
2024-06-13 14:30:04:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-13 14:30:19:INFO:TRAIN-(cmcm) (1/3/3)>> loss: 0.9338
2024-06-13 14:30:22:INFO:VAL-(cmcm) >>
2024-06-13 14:30:22:INFO:M: >>  Has0_acc_2: 0.5415  Has0_F1_score: 0.5160  Non0_acc_2: 0.5324  Non0_F1_score: 0.5039  Mult_acc_5: 0.2096  Mult_acc_7: 0.1747  MAE: 1.7484  Corr: -0.0060 
2024-06-13 14:30:36:INFO:TRAIN-(cmcm) (2/4/3)>> loss: 0.9017
2024-06-13 14:30:39:INFO:VAL-(cmcm) >>
2024-06-13 14:30:39:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.5642  Non0_acc_2: 0.5787  Non0_F1_score: 0.5734  Mult_acc_5: 0.1921  Mult_acc_7: 0.1921  MAE: 1.5790  Corr: 0.1558 
2024-06-13 14:30:54:INFO:TRAIN-(cmcm) (3/5/3)>> loss: 0.8905
2024-06-13 14:30:56:INFO:VAL-(cmcm) >>
2024-06-13 14:30:56:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5175  Non0_acc_2: 0.5787  Non0_F1_score: 0.5029  Mult_acc_5: 0.1528  Mult_acc_7: 0.1528  MAE: 1.5772  Corr: 0.0171 
2024-06-13 14:31:11:INFO:TRAIN-(cmcm) (4/6/3)>> loss: 0.8813
2024-06-13 14:31:14:INFO:VAL-(cmcm) >>
2024-06-13 14:31:14:INFO:M: >>  Has0_acc_2: 0.5415  Has0_F1_score: 0.5111  Non0_acc_2: 0.5278  Non0_F1_score: 0.4950  Mult_acc_5: 0.2751  Mult_acc_7: 0.2052  MAE: 1.7835  Corr: -0.0355 
2024-06-13 14:31:28:INFO:TRAIN-(cmcm) (5/7/3)>> loss: 0.8748
2024-06-13 14:31:31:INFO:VAL-(cmcm) >>
2024-06-13 14:31:31:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.5669  Non0_acc_2: 0.5972  Non0_F1_score: 0.5543  Mult_acc_5: 0.2140  Mult_acc_7: 0.1878  MAE: 1.4720  Corr: 0.1348 
2024-06-13 14:31:31:INFO:Saving checkpoint at epoch 7 to results/models/cmcm-mosi-regression.pth.
2024-06-13 14:31:46:INFO:TRAIN-(cmcm) (1/8/3)>> loss: 0.8757
2024-06-13 14:31:49:INFO:VAL-(cmcm) >>
2024-06-13 14:31:49:INFO:M: >>  Has0_acc_2: 0.6681  Has0_F1_score: 0.6552  Non0_acc_2: 0.6481  Non0_F1_score: 0.6410  Mult_acc_5: 0.2882  Mult_acc_7: 0.2314  MAE: 1.3857  Corr: 0.2924 
2024-06-13 14:31:49:INFO:Saving checkpoint at epoch 8 to results/models/cmcm-mosi-regression.pth.
2024-06-13 14:32:05:INFO:TRAIN-(cmcm) (1/9/3)>> loss: 0.8771
2024-06-13 14:32:07:INFO:VAL-(cmcm) >>
2024-06-13 14:32:07:INFO:M: >>  Has0_acc_2: 0.6681  Has0_F1_score: 0.6265  Non0_acc_2: 0.6574  Non0_F1_score: 0.6140  Mult_acc_5: 0.3231  Mult_acc_7: 0.2533  MAE: 1.4599  Corr: 0.3166 
2024-06-13 14:32:22:INFO:TRAIN-(cmcm) (2/10/3)>> loss: 0.8641
2024-06-13 14:32:24:INFO:VAL-(cmcm) >>
2024-06-13 14:32:24:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5587  Non0_acc_2: 0.5880  Non0_F1_score: 0.5529  Mult_acc_5: 0.2838  Mult_acc_7: 0.2052  MAE: 1.6909  Corr: 0.1109 
2024-06-13 14:32:39:INFO:TRAIN-(cmcm) (3/11/3)>> loss: 0.8482
2024-06-13 14:32:42:INFO:VAL-(cmcm) >>
2024-06-13 14:32:42:INFO:M: >>  Has0_acc_2: 0.6550  Has0_F1_score: 0.6042  Non0_acc_2: 0.6574  Non0_F1_score: 0.6169  Mult_acc_5: 0.3057  Mult_acc_7: 0.2314  MAE: 1.5052  Corr: 0.2532 
2024-06-13 14:32:57:INFO:TRAIN-(cmcm) (4/12/3)>> loss: 0.8324
2024-06-13 14:32:59:INFO:VAL-(cmcm) >>
2024-06-13 14:32:59:INFO:M: >>  Has0_acc_2: 0.6376  Has0_F1_score: 0.6318  Non0_acc_2: 0.6435  Non0_F1_score: 0.6325  Mult_acc_5: 0.2926  Mult_acc_7: 0.2707  MAE: 1.2462  Corr: 0.4320 
2024-06-13 14:32:59:INFO:Saving checkpoint at epoch 12 to results/models/cmcm-mosi-regression.pth.
2024-06-13 14:33:14:INFO:TRAIN-(cmcm) (1/13/3)>> loss: 0.8286
2024-06-13 14:33:17:INFO:VAL-(cmcm) >>
2024-06-13 14:33:17:INFO:M: >>  Has0_acc_2: 0.6812  Has0_F1_score: 0.6809  Non0_acc_2: 0.6944  Non0_F1_score: 0.6923  Mult_acc_5: 0.3406  Mult_acc_7: 0.2751  MAE: 1.2711  Corr: 0.4129 
2024-06-13 14:33:32:INFO:TRAIN-(cmcm) (2/14/3)>> loss: 0.8266
2024-06-13 14:33:34:INFO:VAL-(cmcm) >>
2024-06-13 14:33:34:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.5781  Non0_acc_2: 0.6296  Non0_F1_score: 0.6114  Mult_acc_5: 0.2882  Mult_acc_7: 0.2445  MAE: 1.3611  Corr: 0.4094 
2024-06-13 14:33:49:INFO:TRAIN-(cmcm) (3/15/3)>> loss: 0.8123
2024-06-13 14:33:52:INFO:VAL-(cmcm) >>
2024-06-13 14:33:52:INFO:M: >>  Has0_acc_2: 0.7205  Has0_F1_score: 0.6995  Non0_acc_2: 0.7269  Non0_F1_score: 0.7144  Mult_acc_5: 0.3581  Mult_acc_7: 0.3013  MAE: 1.2239  Corr: 0.4537 
2024-06-13 14:33:52:INFO:Saving checkpoint at epoch 15 to results/models/cmcm-mosi-regression.pth.
2024-06-13 14:34:07:INFO:TRAIN-(cmcm) (1/16/3)>> loss: 0.8083
2024-06-13 14:34:10:INFO:VAL-(cmcm) >>
2024-06-13 14:34:10:INFO:M: >>  Has0_acc_2: 0.6769  Has0_F1_score: 0.6779  Non0_acc_2: 0.7037  Non0_F1_score: 0.7028  Mult_acc_5: 0.3581  Mult_acc_7: 0.2751  MAE: 1.2713  Corr: 0.4200 
2024-06-13 14:34:24:INFO:TRAIN-(cmcm) (2/17/3)>> loss: 0.7918
2024-06-13 14:34:27:INFO:VAL-(cmcm) >>
2024-06-13 14:34:27:INFO:M: >>  Has0_acc_2: 0.7162  Has0_F1_score: 0.7176  Non0_acc_2: 0.7361  Non0_F1_score: 0.7359  Mult_acc_5: 0.3581  Mult_acc_7: 0.2838  MAE: 1.1512  Corr: 0.5125 
2024-06-13 14:34:27:INFO:Saving checkpoint at epoch 17 to results/models/cmcm-mosi-regression.pth.
2024-06-13 14:34:42:INFO:TRAIN-(cmcm) (1/18/3)>> loss: 0.7879
2024-06-13 14:34:45:INFO:VAL-(cmcm) >>
2024-06-13 14:34:45:INFO:M: >>  Has0_acc_2: 0.7205  Has0_F1_score: 0.7140  Non0_acc_2: 0.7361  Non0_F1_score: 0.7274  Mult_acc_5: 0.3712  Mult_acc_7: 0.2838  MAE: 1.1861  Corr: 0.4911 
2024-06-13 14:35:00:INFO:TRAIN-(cmcm) (2/19/3)>> loss: 0.7839
2024-06-13 14:35:02:INFO:VAL-(cmcm) >>
2024-06-13 14:35:02:INFO:M: >>  Has0_acc_2: 0.7118  Has0_F1_score: 0.6965  Non0_acc_2: 0.7269  Non0_F1_score: 0.7217  Mult_acc_5: 0.3581  Mult_acc_7: 0.2707  MAE: 1.1385  Corr: 0.5055 
2024-06-13 14:35:03:INFO:Saving checkpoint at epoch 19 to results/models/cmcm-mosi-regression.pth.
2024-06-13 14:35:18:INFO:TRAIN-(cmcm) (1/20/3)>> loss: 0.7819
2024-06-13 14:35:20:INFO:VAL-(cmcm) >>
2024-06-13 14:35:20:INFO:M: >>  Has0_acc_2: 0.7118  Has0_F1_score: 0.7140  Non0_acc_2: 0.7407  Non0_F1_score: 0.7416  Mult_acc_5: 0.3886  Mult_acc_7: 0.2882  MAE: 1.1817  Corr: 0.5337 
2024-06-13 14:35:35:INFO:TRAIN-(cmcm) (2/21/3)>> loss: 0.7716
2024-06-13 14:35:38:INFO:VAL-(cmcm) >>
2024-06-13 14:35:38:INFO:M: >>  Has0_acc_2: 0.6987  Has0_F1_score: 0.6976  Non0_acc_2: 0.6343  Non0_F1_score: 0.6170  Mult_acc_5: 0.3013  Mult_acc_7: 0.2314  MAE: 1.2886  Corr: 0.5383 
2024-06-13 14:35:52:INFO:TRAIN-(cmcm) (3/22/3)>> loss: 0.7669
2024-06-13 14:35:55:INFO:VAL-(cmcm) >>
2024-06-13 14:35:55:INFO:M: >>  Has0_acc_2: 0.6943  Has0_F1_score: 0.6962  Non0_acc_2: 0.7222  Non0_F1_score: 0.7232  Mult_acc_5: 0.3712  Mult_acc_7: 0.2707  MAE: 1.1651  Corr: 0.5513 
2024-06-13 14:36:10:INFO:TRAIN-(cmcm) (4/23/3)>> loss: 0.7555
2024-06-13 14:36:12:INFO:VAL-(cmcm) >>
2024-06-13 14:36:12:INFO:M: >>  Has0_acc_2: 0.7031  Has0_F1_score: 0.7052  Non0_acc_2: 0.7315  Non0_F1_score: 0.7326  Mult_acc_5: 0.3450  Mult_acc_7: 0.2795  MAE: 1.1520  Corr: 0.5164 
2024-06-13 14:36:27:INFO:TRAIN-(cmcm) (5/24/3)>> loss: 0.7479
2024-06-13 14:36:30:INFO:VAL-(cmcm) >>
2024-06-13 14:36:30:INFO:M: >>  Has0_acc_2: 0.7074  Has0_F1_score: 0.7074  Non0_acc_2: 0.7361  Non0_F1_score: 0.7355  Mult_acc_5: 0.3537  Mult_acc_7: 0.2620  MAE: 1.1577  Corr: 0.5624 
2024-06-13 14:36:44:INFO:TRAIN-(cmcm) (6/25/3)>> loss: 0.7505
2024-06-13 14:36:47:INFO:VAL-(cmcm) >>
2024-06-13 14:36:47:INFO:M: >>  Has0_acc_2: 0.6638  Has0_F1_score: 0.6594  Non0_acc_2: 0.6852  Non0_F1_score: 0.6781  Mult_acc_5: 0.3450  Mult_acc_7: 0.2707  MAE: 1.2193  Corr: 0.5316 
2024-06-13 14:37:02:INFO:TRAIN-(cmcm) (7/26/3)>> loss: 0.7444
2024-06-13 14:37:04:INFO:VAL-(cmcm) >>
2024-06-13 14:37:04:INFO:M: >>  Has0_acc_2: 0.6987  Has0_F1_score: 0.7004  Non0_acc_2: 0.6806  Non0_F1_score: 0.6757  Mult_acc_5: 0.3668  Mult_acc_7: 0.2969  MAE: 1.1576  Corr: 0.5645 
2024-06-13 14:37:19:INFO:TRAIN-(cmcm) (8/27/3)>> loss: 0.7428
2024-06-13 14:37:22:INFO:VAL-(cmcm) >>
2024-06-13 14:37:22:INFO:M: >>  Has0_acc_2: 0.7205  Has0_F1_score: 0.7212  Non0_acc_2: 0.7037  Non0_F1_score: 0.6979  Mult_acc_5: 0.2926  Mult_acc_7: 0.2402  MAE: 1.1874  Corr: 0.5734 
2024-06-13 14:37:36:INFO:TRAIN-(cmcm) (9/28/3)>> loss: 0.7277
2024-06-13 14:37:39:INFO:VAL-(cmcm) >>
2024-06-13 14:37:39:INFO:M: >>  Has0_acc_2: 0.7380  Has0_F1_score: 0.7388  Non0_acc_2: 0.7824  Non0_F1_score: 0.7834  Mult_acc_5: 0.3624  Mult_acc_7: 0.2926  MAE: 1.0704  Corr: 0.5765 
2024-06-13 14:37:39:INFO:Saving checkpoint at epoch 28 to results/models/cmcm-mosi-regression.pth.
2024-06-13 14:37:54:INFO:TRAIN-(cmcm) (1/29/3)>> loss: 0.7173
2024-06-13 14:37:57:INFO:VAL-(cmcm) >>
2024-06-13 14:37:57:INFO:M: >>  Has0_acc_2: 0.7336  Has0_F1_score: 0.7362  Non0_acc_2: 0.7500  Non0_F1_score: 0.7513  Mult_acc_5: 0.3886  Mult_acc_7: 0.3100  MAE: 1.0602  Corr: 0.6006 
2024-06-13 14:37:57:INFO:Saving checkpoint at epoch 29 to results/models/cmcm-mosi-regression.pth.
2024-06-13 14:38:12:INFO:TRAIN-(cmcm) (1/30/3)>> loss: 0.7187
2024-06-13 14:38:15:INFO:VAL-(cmcm) >>
2024-06-13 14:38:15:INFO:M: >>  Has0_acc_2: 0.6900  Has0_F1_score: 0.6772  Non0_acc_2: 0.6991  Non0_F1_score: 0.7006  Mult_acc_5: 0.3668  Mult_acc_7: 0.3144  MAE: 1.1135  Corr: 0.5147 
2024-06-13 14:38:30:INFO:TRAIN-(cmcm) (2/31/3)>> loss: 0.7142
2024-06-13 14:38:32:INFO:VAL-(cmcm) >>
2024-06-13 14:38:32:INFO:M: >>  Has0_acc_2: 0.7205  Has0_F1_score: 0.7227  Non0_acc_2: 0.7454  Non0_F1_score: 0.7465  Mult_acc_5: 0.3450  Mult_acc_7: 0.2620  MAE: 1.1713  Corr: 0.5501 
2024-06-13 14:38:47:INFO:TRAIN-(cmcm) (3/32/3)>> loss: 0.7108
2024-06-13 14:38:50:INFO:VAL-(cmcm) >>
2024-06-13 14:38:50:INFO:M: >>  Has0_acc_2: 0.6987  Has0_F1_score: 0.6999  Non0_acc_2: 0.7037  Non0_F1_score: 0.7052  Mult_acc_5: 0.3450  Mult_acc_7: 0.2751  MAE: 1.1702  Corr: 0.5160 
2024-06-13 14:39:04:INFO:TRAIN-(cmcm) (4/33/3)>> loss: 0.7043
2024-06-13 14:39:07:INFO:VAL-(cmcm) >>
2024-06-13 14:39:07:INFO:M: >>  Has0_acc_2: 0.7162  Has0_F1_score: 0.7169  Non0_acc_2: 0.7407  Non0_F1_score: 0.7407  Mult_acc_5: 0.4192  Mult_acc_7: 0.3231  MAE: 1.1520  Corr: 0.5167 
2024-06-13 14:39:22:INFO:TRAIN-(cmcm) (5/34/3)>> loss: 0.7015
2024-06-13 14:39:24:INFO:VAL-(cmcm) >>
2024-06-13 14:39:24:INFO:M: >>  Has0_acc_2: 0.7293  Has0_F1_score: 0.7308  Non0_acc_2: 0.7500  Non0_F1_score: 0.7500  Mult_acc_5: 0.3886  Mult_acc_7: 0.3013  MAE: 1.0857  Corr: 0.5862 
2024-06-13 14:39:39:INFO:TRAIN-(cmcm) (6/35/3)>> loss: 0.6876
2024-06-13 14:39:42:INFO:VAL-(cmcm) >>
2024-06-13 14:39:42:INFO:M: >>  Has0_acc_2: 0.7118  Has0_F1_score: 0.7140  Non0_acc_2: 0.7083  Non0_F1_score: 0.7099  Mult_acc_5: 0.3275  Mult_acc_7: 0.2664  MAE: 1.1445  Corr: 0.5428 
2024-06-13 14:39:56:INFO:TRAIN-(cmcm) (7/36/3)>> loss: 0.6884
2024-06-13 14:39:59:INFO:VAL-(cmcm) >>
2024-06-13 14:39:59:INFO:M: >>  Has0_acc_2: 0.6856  Has0_F1_score: 0.6819  Non0_acc_2: 0.7130  Non0_F1_score: 0.7090  Mult_acc_5: 0.3668  Mult_acc_7: 0.2707  MAE: 1.2813  Corr: 0.5378 
2024-06-13 14:40:14:INFO:TRAIN-(cmcm) (8/37/3)>> loss: 0.6885
2024-06-13 14:40:16:INFO:VAL-(cmcm) >>
2024-06-13 14:40:16:INFO:M: >>  Has0_acc_2: 0.7555  Has0_F1_score: 0.7555  Non0_acc_2: 0.7778  Non0_F1_score: 0.7767  Mult_acc_5: 0.3843  Mult_acc_7: 0.2926  MAE: 1.0948  Corr: 0.5708 
2024-06-13 14:40:31:INFO:TRAIN-(cmcm) (9/38/3)>> loss: 0.6780
2024-06-13 14:40:34:INFO:VAL-(cmcm) >>
2024-06-13 14:40:34:INFO:M: >>  Has0_acc_2: 0.7205  Has0_F1_score: 0.7205  Non0_acc_2: 0.7361  Non0_F1_score: 0.7355  Mult_acc_5: 0.3450  Mult_acc_7: 0.2838  MAE: 1.1739  Corr: 0.5159 
2024-06-13 14:40:48:INFO:TRAIN-(cmcm) (10/39/3)>> loss: 0.6706
2024-06-13 14:40:51:INFO:VAL-(cmcm) >>
2024-06-13 14:40:51:INFO:M: >>  Has0_acc_2: 0.6987  Has0_F1_score: 0.7016  Non0_acc_2: 0.7176  Non0_F1_score: 0.7188  Mult_acc_5: 0.3406  Mult_acc_7: 0.2751  MAE: 1.1602  Corr: 0.5321 
2024-06-13 14:40:58:INFO:TEST-(cmcm) >>
2024-06-13 14:40:58:INFO:M: >>  Has0_acc_2: 0.7376  Has0_F1_score: 0.7367  Non0_acc_2: 0.7454  Non0_F1_score: 0.7442  Mult_acc_5: 0.3819  Mult_acc_7: 0.3324  MAE: 1.1007  Corr: 0.5370 
2024-06-13 14:40:59:INFO:Results are added to results/results/mosi-regression-90.csv...
2024-06-13 14:40:59:INFO:Start running cmcm...
2024-06-13 14:40:59:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 6, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 90, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 4444}>
2024-06-13 14:40:59:INFO:Let's use the GPU 1 !
2024-06-13 14:40:59:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 14:40:59:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718260859 HTTP/1.1" 200 235
2024-06-13 14:40:59:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 14:41:00:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 14:41:01:INFO:train samples: (1284,)
2024-06-13 14:41:01:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 14:41:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718260862 HTTP/1.1" 200 235
2024-06-13 14:41:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 14:41:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 14:41:03:INFO:valid samples: (229,)
2024-06-13 14:41:03:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 14:41:03:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718260863 HTTP/1.1" 200 235
2024-06-13 14:41:03:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 14:41:04:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 14:41:04:INFO:test samples: (686,)
2024-06-13 14:41:04:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 14:41:05:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718260865 HTTP/1.1" 200 235
2024-06-13 14:41:05:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 14:41:05:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 14:41:06:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 14:41:06:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718260866 HTTP/1.1" 200 235
2024-06-13 14:41:06:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 14:41:07:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 14:41:07:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-13 14:41:07:WARNING:Try importing flash-attention for faster inference...
2024-06-13 14:41:07:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-13 14:41:07:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-13 14:41:07:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-13 14:41:08:INFO:trainable params: 1310288 || all params: 1838138960 || trainable%: 0.07128340286090232
2024-06-13 14:41:08:INFO:Init labels...
2024-06-13 14:41:08:INFO:Start training...
2024-06-13 14:41:23:INFO:TRAIN-(cmcm) (1/1/4)>> loss: 4.2088
2024-06-13 14:41:25:INFO:VAL-(cmcm) >>
2024-06-13 14:41:25:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4213  Non0_F1_score: 0.2753  Mult_acc_5: 0.2140  Mult_acc_7: 0.2140  MAE: 1.4401  Corr: -0.0618 
2024-06-13 14:41:26:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-13 14:41:41:INFO:TRAIN-(cmcm) (1/2/4)>> loss: 2.3759
2024-06-13 14:41:43:INFO:VAL-(cmcm) >>
2024-06-13 14:41:43:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4556  Non0_acc_2: 0.5556  Non0_F1_score: 0.4913  Mult_acc_5: 0.2576  Mult_acc_7: 0.1572  MAE: 2.0162  Corr: 0.0300 
2024-06-13 14:41:58:INFO:TRAIN-(cmcm) (2/3/4)>> loss: 1.1247
2024-06-13 14:42:01:INFO:VAL-(cmcm) >>
2024-06-13 14:42:01:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5344  Non0_acc_2: 0.5602  Non0_F1_score: 0.5283  Mult_acc_5: 0.2096  Mult_acc_7: 0.2096  MAE: 1.5449  Corr: 0.0202 
2024-06-13 14:42:15:INFO:TRAIN-(cmcm) (3/4/4)>> loss: 0.9549
2024-06-13 14:42:18:INFO:VAL-(cmcm) >>
2024-06-13 14:42:18:INFO:M: >>  Has0_acc_2: 0.5590  Has0_F1_score: 0.5619  Non0_acc_2: 0.5741  Non0_F1_score: 0.5751  Mult_acc_5: 0.2795  Mult_acc_7: 0.2183  MAE: 1.6069  Corr: 0.1327 
2024-06-13 14:42:33:INFO:TRAIN-(cmcm) (4/5/4)>> loss: 0.9180
2024-06-13 14:42:35:INFO:VAL-(cmcm) >>
2024-06-13 14:42:35:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4917  Non0_acc_2: 0.5787  Non0_F1_score: 0.4827  Mult_acc_5: 0.2140  Mult_acc_7: 0.1703  MAE: 1.5890  Corr: 0.0645 
2024-06-13 14:42:50:INFO:TRAIN-(cmcm) (5/6/4)>> loss: 0.9046
2024-06-13 14:42:53:INFO:VAL-(cmcm) >>
2024-06-13 14:42:53:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4830  Non0_acc_2: 0.5787  Non0_F1_score: 0.4584  Mult_acc_5: 0.1965  Mult_acc_7: 0.1703  MAE: 1.6363  Corr: 0.0042 
2024-06-13 14:43:08:INFO:TRAIN-(cmcm) (6/7/4)>> loss: 0.9039
2024-06-13 14:43:10:INFO:VAL-(cmcm) >>
2024-06-13 14:43:10:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4534  Non0_acc_2: 0.5694  Non0_F1_score: 0.4246  Mult_acc_5: 0.1616  Mult_acc_7: 0.1441  MAE: 1.5890  Corr: -0.0558 
2024-06-13 14:43:25:INFO:TRAIN-(cmcm) (7/8/4)>> loss: 0.8855
2024-06-13 14:43:28:INFO:VAL-(cmcm) >>
2024-06-13 14:43:28:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.5382  Non0_acc_2: 0.5694  Non0_F1_score: 0.5203  Mult_acc_5: 0.2838  Mult_acc_7: 0.2096  MAE: 1.6861  Corr: 0.0022 
2024-06-13 14:43:42:INFO:TRAIN-(cmcm) (8/9/4)>> loss: 0.8979
2024-06-13 14:43:45:INFO:VAL-(cmcm) >>
2024-06-13 14:43:45:INFO:M: >>  Has0_acc_2: 0.5633  Has0_F1_score: 0.5305  Non0_acc_2: 0.5648  Non0_F1_score: 0.5346  Mult_acc_5: 0.1703  Mult_acc_7: 0.1703  MAE: 1.5606  Corr: 0.0340 
2024-06-13 14:44:00:INFO:TRAIN-(cmcm) (9/10/4)>> loss: 0.8757
2024-06-13 14:44:02:INFO:VAL-(cmcm) >>
2024-06-13 14:44:02:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4676  Non0_acc_2: 0.5694  Non0_F1_score: 0.4396  Mult_acc_5: 0.2707  Mult_acc_7: 0.2052  MAE: 1.7162  Corr: -0.0112 
2024-06-13 14:44:17:INFO:TRAIN-(cmcm) (10/11/4)>> loss: 0.8703
2024-06-13 14:44:20:INFO:VAL-(cmcm) >>
2024-06-13 14:44:20:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.5215  Non0_acc_2: 0.5602  Non0_F1_score: 0.5026  Mult_acc_5: 0.2533  Mult_acc_7: 0.1878  MAE: 1.7036  Corr: 0.0270 
2024-06-13 14:44:27:INFO:TEST-(cmcm) >>
2024-06-13 14:44:27:INFO:M: >>  Has0_acc_2: 0.4475  Has0_F1_score: 0.2767  Non0_acc_2: 0.5640  Non0_F1_score: 0.4411  Mult_acc_5: 0.1545  Mult_acc_7: 0.1531  MAE: 1.7150  Corr: 0.0370 
2024-06-13 14:44:28:INFO:Results are added to results/results/mosi-regression-90.csv...
2024-06-13 14:44:28:INFO:Start running cmcm...
2024-06-13 14:44:28:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 6, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 90, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 5555}>
2024-06-13 14:44:28:INFO:Let's use the GPU 1 !
2024-06-13 14:44:28:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 14:44:28:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718261068 HTTP/1.1" 200 235
2024-06-13 14:44:28:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 14:44:29:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 14:44:29:INFO:train samples: (1284,)
2024-06-13 14:44:29:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 14:44:30:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718261070 HTTP/1.1" 200 235
2024-06-13 14:44:30:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 14:44:30:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 14:44:31:INFO:valid samples: (229,)
2024-06-13 14:44:31:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 14:44:31:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718261072 HTTP/1.1" 200 235
2024-06-13 14:44:32:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 14:44:32:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 14:44:33:INFO:test samples: (686,)
2024-06-13 14:44:33:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 14:44:33:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718261073 HTTP/1.1" 200 235
2024-06-13 14:44:33:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 14:44:34:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 14:44:34:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 14:44:34:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718261074 HTTP/1.1" 200 235
2024-06-13 14:44:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 14:44:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 14:44:35:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-13 14:44:35:WARNING:Try importing flash-attention for faster inference...
2024-06-13 14:44:35:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-13 14:44:35:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-13 14:44:35:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-13 14:44:36:INFO:trainable params: 1310288 || all params: 1838138960 || trainable%: 0.07128340286090232
2024-06-13 14:44:36:INFO:Init labels...
2024-06-13 14:44:36:INFO:Start training...
2024-06-13 14:44:51:INFO:TRAIN-(cmcm) (1/1/5)>> loss: 3.3933
2024-06-13 14:44:54:INFO:VAL-(cmcm) >>
2024-06-13 14:44:54:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5509  Non0_F1_score: 0.4960  Mult_acc_5: 0.2489  Mult_acc_7: 0.1528  MAE: 1.9874  Corr: 0.0120 
2024-06-13 14:44:54:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-13 14:45:09:INFO:TRAIN-(cmcm) (1/2/5)>> loss: 1.1051
2024-06-13 14:45:12:INFO:VAL-(cmcm) >>
2024-06-13 14:45:12:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.5483  Non0_acc_2: 0.5602  Non0_F1_score: 0.5309  Mult_acc_5: 0.1878  Mult_acc_7: 0.1878  MAE: 1.5379  Corr: 0.0270 
2024-06-13 14:45:13:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-13 14:45:28:INFO:TRAIN-(cmcm) (1/3/5)>> loss: 0.9170
2024-06-13 14:45:30:INFO:VAL-(cmcm) >>
2024-06-13 14:45:30:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.5117  Non0_acc_2: 0.5509  Non0_F1_score: 0.4921  Mult_acc_5: 0.2533  Mult_acc_7: 0.1878  MAE: 1.8455  Corr: -0.0367 
2024-06-13 14:45:45:INFO:TRAIN-(cmcm) (2/4/5)>> loss: 0.8967
2024-06-13 14:45:48:INFO:VAL-(cmcm) >>
2024-06-13 14:45:48:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.4996  Non0_acc_2: 0.5648  Non0_F1_score: 0.4791  Mult_acc_5: 0.2620  Mult_acc_7: 0.1965  MAE: 1.7127  Corr: -0.0075 
2024-06-13 14:46:02:INFO:TRAIN-(cmcm) (3/5/5)>> loss: 0.8868
2024-06-13 14:46:05:INFO:VAL-(cmcm) >>
2024-06-13 14:46:05:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.5240  Non0_acc_2: 0.5694  Non0_F1_score: 0.5052  Mult_acc_5: 0.1921  Mult_acc_7: 0.1834  MAE: 1.5021  Corr: 0.0356 
2024-06-13 14:46:05:INFO:Saving checkpoint at epoch 5 to results/models/cmcm-mosi-regression.pth.
2024-06-13 14:46:21:INFO:TRAIN-(cmcm) (1/6/5)>> loss: 0.8836
2024-06-13 14:46:23:INFO:VAL-(cmcm) >>
2024-06-13 14:46:23:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5761  Non0_acc_2: 0.5833  Non0_F1_score: 0.5853  Mult_acc_5: 0.2096  Mult_acc_7: 0.1834  MAE: 1.6095  Corr: 0.1013 
2024-06-13 14:46:38:INFO:TRAIN-(cmcm) (2/7/5)>> loss: 0.8751
2024-06-13 14:46:41:INFO:VAL-(cmcm) >>
2024-06-13 14:46:41:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.4951  Non0_acc_2: 0.5139  Non0_F1_score: 0.4988  Mult_acc_5: 0.1965  Mult_acc_7: 0.1965  MAE: 1.4453  Corr: 0.0549 
2024-06-13 14:46:41:INFO:Saving checkpoint at epoch 7 to results/models/cmcm-mosi-regression.pth.
2024-06-13 14:46:56:INFO:TRAIN-(cmcm) (1/8/5)>> loss: 0.8906
2024-06-13 14:46:59:INFO:VAL-(cmcm) >>
2024-06-13 14:46:59:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5129  Non0_acc_2: 0.5694  Non0_F1_score: 0.4920  Mult_acc_5: 0.2402  Mult_acc_7: 0.1878  MAE: 1.6279  Corr: 0.0308 
2024-06-13 14:47:14:INFO:TRAIN-(cmcm) (2/9/5)>> loss: 0.8780
2024-06-13 14:47:16:INFO:VAL-(cmcm) >>
2024-06-13 14:47:16:INFO:M: >>  Has0_acc_2: 0.5590  Has0_F1_score: 0.5187  Non0_acc_2: 0.5509  Non0_F1_score: 0.5097  Mult_acc_5: 0.2052  Mult_acc_7: 0.1528  MAE: 1.7126  Corr: 0.0238 
2024-06-13 14:47:31:INFO:TRAIN-(cmcm) (3/10/5)>> loss: 0.8692
2024-06-13 14:47:34:INFO:VAL-(cmcm) >>
2024-06-13 14:47:34:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4534  Non0_acc_2: 0.5694  Non0_F1_score: 0.4246  Mult_acc_5: 0.1747  Mult_acc_7: 0.1747  MAE: 1.5384  Corr: -0.0319 
2024-06-13 14:47:48:INFO:TRAIN-(cmcm) (4/11/5)>> loss: 0.8624
2024-06-13 14:47:51:INFO:VAL-(cmcm) >>
2024-06-13 14:47:51:INFO:M: >>  Has0_acc_2: 0.5546  Has0_F1_score: 0.5519  Non0_acc_2: 0.5463  Non0_F1_score: 0.5421  Mult_acc_5: 0.2227  Mult_acc_7: 0.2227  MAE: 1.4943  Corr: 0.0649 
2024-06-13 14:48:06:INFO:TRAIN-(cmcm) (5/12/5)>> loss: 0.8617
2024-06-13 14:48:08:INFO:VAL-(cmcm) >>
2024-06-13 14:48:08:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.4920  Non0_acc_2: 0.5556  Non0_F1_score: 0.4731  Mult_acc_5: 0.2576  Mult_acc_7: 0.1965  MAE: 1.7014  Corr: -0.0324 
2024-06-13 14:48:23:INFO:TRAIN-(cmcm) (6/13/5)>> loss: 0.8597
2024-06-13 14:48:26:INFO:VAL-(cmcm) >>
2024-06-13 14:48:26:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.5425  Non0_acc_2: 0.5972  Non0_F1_score: 0.5247  Mult_acc_5: 0.3057  Mult_acc_7: 0.2271  MAE: 1.6988  Corr: 0.0794 
2024-06-13 14:48:41:INFO:TRAIN-(cmcm) (7/14/5)>> loss: 0.8569
2024-06-13 14:48:43:INFO:VAL-(cmcm) >>
2024-06-13 14:48:43:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.5371  Non0_acc_2: 0.5741  Non0_F1_score: 0.5125  Mult_acc_5: 0.2533  Mult_acc_7: 0.2183  MAE: 1.5490  Corr: 0.1218 
2024-06-13 14:48:58:INFO:TRAIN-(cmcm) (8/15/5)>> loss: 0.8461
2024-06-13 14:49:01:INFO:VAL-(cmcm) >>
2024-06-13 14:49:01:INFO:M: >>  Has0_acc_2: 0.6681  Has0_F1_score: 0.6522  Non0_acc_2: 0.6620  Non0_F1_score: 0.6450  Mult_acc_5: 0.3712  Mult_acc_7: 0.2882  MAE: 1.4809  Corr: 0.2932 
2024-06-13 14:49:16:INFO:TRAIN-(cmcm) (9/16/5)>> loss: 0.8305
2024-06-13 14:49:18:INFO:VAL-(cmcm) >>
2024-06-13 14:49:18:INFO:M: >>  Has0_acc_2: 0.6550  Has0_F1_score: 0.6009  Non0_acc_2: 0.6389  Non0_F1_score: 0.5867  Mult_acc_5: 0.3231  Mult_acc_7: 0.2358  MAE: 1.4468  Corr: 0.3551 
2024-06-13 14:49:33:INFO:TRAIN-(cmcm) (10/17/5)>> loss: 0.8262
2024-06-13 14:49:35:INFO:VAL-(cmcm) >>
2024-06-13 14:49:35:INFO:M: >>  Has0_acc_2: 0.6900  Has0_F1_score: 0.6929  Non0_acc_2: 0.5880  Non0_F1_score: 0.5667  Mult_acc_5: 0.2838  Mult_acc_7: 0.2402  MAE: 1.3235  Corr: 0.3969 
2024-06-13 14:49:36:INFO:Saving checkpoint at epoch 17 to results/models/cmcm-mosi-regression.pth.
2024-06-13 14:49:51:INFO:TRAIN-(cmcm) (1/18/5)>> loss: 0.8003
2024-06-13 14:49:54:INFO:VAL-(cmcm) >>
2024-06-13 14:49:54:INFO:M: >>  Has0_acc_2: 0.6769  Has0_F1_score: 0.6771  Non0_acc_2: 0.7083  Non0_F1_score: 0.7081  Mult_acc_5: 0.3799  Mult_acc_7: 0.2969  MAE: 1.2228  Corr: 0.5006 
2024-06-13 14:49:55:INFO:Saving checkpoint at epoch 18 to results/models/cmcm-mosi-regression.pth.
2024-06-13 14:50:10:INFO:TRAIN-(cmcm) (1/19/5)>> loss: 0.7931
2024-06-13 14:50:13:INFO:VAL-(cmcm) >>
2024-06-13 14:50:13:INFO:M: >>  Has0_acc_2: 0.6769  Has0_F1_score: 0.6799  Non0_acc_2: 0.7083  Non0_F1_score: 0.7096  Mult_acc_5: 0.3144  Mult_acc_7: 0.2576  MAE: 1.1324  Corr: 0.5279 
2024-06-13 14:50:13:INFO:Saving checkpoint at epoch 19 to results/models/cmcm-mosi-regression.pth.
2024-06-13 14:50:28:INFO:TRAIN-(cmcm) (1/20/5)>> loss: 0.7990
2024-06-13 14:50:31:INFO:VAL-(cmcm) >>
2024-06-13 14:50:31:INFO:M: >>  Has0_acc_2: 0.5459  Has0_F1_score: 0.5012  Non0_acc_2: 0.5509  Non0_F1_score: 0.4951  Mult_acc_5: 0.2445  Mult_acc_7: 0.2052  MAE: 1.5608  Corr: 0.3927 
2024-06-13 14:50:46:INFO:TRAIN-(cmcm) (2/21/5)>> loss: 0.7956
2024-06-13 14:50:48:INFO:VAL-(cmcm) >>
2024-06-13 14:50:48:INFO:M: >>  Has0_acc_2: 0.6332  Has0_F1_score: 0.6221  Non0_acc_2: 0.6667  Non0_F1_score: 0.6531  Mult_acc_5: 0.2838  Mult_acc_7: 0.2358  MAE: 1.3525  Corr: 0.4905 
2024-06-13 14:51:03:INFO:TRAIN-(cmcm) (3/22/5)>> loss: 0.7793
2024-06-13 14:51:06:INFO:VAL-(cmcm) >>
2024-06-13 14:51:06:INFO:M: >>  Has0_acc_2: 0.7074  Has0_F1_score: 0.6979  Non0_acc_2: 0.7083  Non0_F1_score: 0.7077  Mult_acc_5: 0.3362  Mult_acc_7: 0.2882  MAE: 1.1267  Corr: 0.5192 
2024-06-13 14:51:06:INFO:Saving checkpoint at epoch 22 to results/models/cmcm-mosi-regression.pth.
2024-06-13 14:51:21:INFO:TRAIN-(cmcm) (1/23/5)>> loss: 0.7691
2024-06-13 14:51:24:INFO:VAL-(cmcm) >>
2024-06-13 14:51:24:INFO:M: >>  Has0_acc_2: 0.7249  Has0_F1_score: 0.7251  Non0_acc_2: 0.7593  Non0_F1_score: 0.7589  Mult_acc_5: 0.3624  Mult_acc_7: 0.2707  MAE: 1.1464  Corr: 0.5627 
2024-06-13 14:51:39:INFO:TRAIN-(cmcm) (2/24/5)>> loss: 0.7659
2024-06-13 14:51:41:INFO:VAL-(cmcm) >>
2024-06-13 14:51:41:INFO:M: >>  Has0_acc_2: 0.7031  Has0_F1_score: 0.6902  Non0_acc_2: 0.7176  Non0_F1_score: 0.7131  Mult_acc_5: 0.3581  Mult_acc_7: 0.2751  MAE: 1.1603  Corr: 0.5174 
2024-06-13 14:51:56:INFO:TRAIN-(cmcm) (3/25/5)>> loss: 0.7540
2024-06-13 14:51:59:INFO:VAL-(cmcm) >>
2024-06-13 14:51:59:INFO:M: >>  Has0_acc_2: 0.7424  Has0_F1_score: 0.7368  Non0_acc_2: 0.7731  Non0_F1_score: 0.7726  Mult_acc_5: 0.3493  Mult_acc_7: 0.2838  MAE: 1.0809  Corr: 0.5784 
2024-06-13 14:51:59:INFO:Saving checkpoint at epoch 25 to results/models/cmcm-mosi-regression.pth.
2024-06-13 14:52:14:INFO:TRAIN-(cmcm) (1/26/5)>> loss: 0.7472
2024-06-13 14:52:17:INFO:VAL-(cmcm) >>
2024-06-13 14:52:17:INFO:M: >>  Has0_acc_2: 0.7118  Has0_F1_score: 0.7144  Non0_acc_2: 0.7176  Non0_F1_score: 0.7188  Mult_acc_5: 0.3930  Mult_acc_7: 0.3188  MAE: 1.0829  Corr: 0.5658 
2024-06-13 14:52:32:INFO:TRAIN-(cmcm) (2/27/5)>> loss: 0.7375
2024-06-13 14:52:34:INFO:VAL-(cmcm) >>
2024-06-13 14:52:34:INFO:M: >>  Has0_acc_2: 0.7424  Has0_F1_score: 0.7440  Non0_acc_2: 0.7176  Non0_F1_score: 0.7188  Mult_acc_5: 0.3755  Mult_acc_7: 0.3013  MAE: 1.1075  Corr: 0.5653 
2024-06-13 14:52:49:INFO:TRAIN-(cmcm) (3/28/5)>> loss: 0.7357
2024-06-13 14:52:52:INFO:VAL-(cmcm) >>
2024-06-13 14:52:52:INFO:M: >>  Has0_acc_2: 0.7293  Has0_F1_score: 0.7317  Non0_acc_2: 0.7593  Non0_F1_score: 0.7603  Mult_acc_5: 0.4017  Mult_acc_7: 0.3188  MAE: 1.0848  Corr: 0.5718 
2024-06-13 14:53:06:INFO:TRAIN-(cmcm) (4/29/5)>> loss: 0.7327
2024-06-13 14:53:09:INFO:VAL-(cmcm) >>
2024-06-13 14:53:09:INFO:M: >>  Has0_acc_2: 0.7249  Has0_F1_score: 0.7229  Non0_acc_2: 0.6667  Non0_F1_score: 0.6656  Mult_acc_5: 0.3581  Mult_acc_7: 0.2838  MAE: 1.1647  Corr: 0.5001 
2024-06-13 14:53:24:INFO:TRAIN-(cmcm) (5/30/5)>> loss: 0.7290
2024-06-13 14:53:26:INFO:VAL-(cmcm) >>
2024-06-13 14:53:26:INFO:M: >>  Has0_acc_2: 0.7118  Has0_F1_score: 0.7143  Non0_acc_2: 0.7315  Non0_F1_score: 0.7321  Mult_acc_5: 0.3755  Mult_acc_7: 0.2926  MAE: 1.1686  Corr: 0.5555 
2024-06-13 14:53:41:INFO:TRAIN-(cmcm) (6/31/5)>> loss: 0.7157
2024-06-13 14:53:44:INFO:VAL-(cmcm) >>
2024-06-13 14:53:44:INFO:M: >>  Has0_acc_2: 0.6856  Has0_F1_score: 0.6821  Non0_acc_2: 0.6944  Non0_F1_score: 0.6900  Mult_acc_5: 0.3930  Mult_acc_7: 0.3275  MAE: 1.1065  Corr: 0.5569 
2024-06-13 14:53:59:INFO:TRAIN-(cmcm) (7/32/5)>> loss: 0.7156
2024-06-13 14:54:01:INFO:VAL-(cmcm) >>
2024-06-13 14:54:01:INFO:M: >>  Has0_acc_2: 0.7424  Has0_F1_score: 0.7440  Non0_acc_2: 0.7731  Non0_F1_score: 0.7740  Mult_acc_5: 0.3843  Mult_acc_7: 0.2926  MAE: 1.0822  Corr: 0.5813 
2024-06-13 14:54:16:INFO:TRAIN-(cmcm) (8/33/5)>> loss: 0.7076
2024-06-13 14:54:19:INFO:VAL-(cmcm) >>
2024-06-13 14:54:19:INFO:M: >>  Has0_acc_2: 0.7511  Has0_F1_score: 0.7504  Non0_acc_2: 0.7639  Non0_F1_score: 0.7633  Mult_acc_5: 0.3930  Mult_acc_7: 0.2795  MAE: 1.0844  Corr: 0.6013 
2024-06-13 14:54:34:INFO:TRAIN-(cmcm) (9/34/5)>> loss: 0.7111
2024-06-13 14:54:36:INFO:VAL-(cmcm) >>
2024-06-13 14:54:36:INFO:M: >>  Has0_acc_2: 0.7249  Has0_F1_score: 0.7235  Non0_acc_2: 0.7407  Non0_F1_score: 0.7383  Mult_acc_5: 0.3974  Mult_acc_7: 0.3144  MAE: 1.0756  Corr: 0.5709 
2024-06-13 14:54:37:INFO:Saving checkpoint at epoch 34 to results/models/cmcm-mosi-regression.pth.
2024-06-13 14:54:52:INFO:TRAIN-(cmcm) (1/35/5)>> loss: 0.7074
2024-06-13 14:54:54:INFO:VAL-(cmcm) >>
2024-06-13 14:54:54:INFO:M: >>  Has0_acc_2: 0.7380  Has0_F1_score: 0.7388  Non0_acc_2: 0.7500  Non0_F1_score: 0.7508  Mult_acc_5: 0.3886  Mult_acc_7: 0.3231  MAE: 1.0695  Corr: 0.5783 
2024-06-13 14:54:55:INFO:Saving checkpoint at epoch 35 to results/models/cmcm-mosi-regression.pth.
2024-06-13 14:55:10:INFO:TRAIN-(cmcm) (1/36/5)>> loss: 0.6945
2024-06-13 14:55:13:INFO:VAL-(cmcm) >>
2024-06-13 14:55:13:INFO:M: >>  Has0_acc_2: 0.7031  Has0_F1_score: 0.6998  Non0_acc_2: 0.7407  Non0_F1_score: 0.7404  Mult_acc_5: 0.3974  Mult_acc_7: 0.2969  MAE: 1.1228  Corr: 0.5812 
2024-06-13 14:55:28:INFO:TRAIN-(cmcm) (2/37/5)>> loss: 0.6951
2024-06-13 14:55:30:INFO:VAL-(cmcm) >>
2024-06-13 14:55:30:INFO:M: >>  Has0_acc_2: 0.7205  Has0_F1_score: 0.7221  Non0_acc_2: 0.7546  Non0_F1_score: 0.7554  Mult_acc_5: 0.4017  Mult_acc_7: 0.3144  MAE: 1.1145  Corr: 0.5801 
2024-06-13 14:55:45:INFO:TRAIN-(cmcm) (3/38/5)>> loss: 0.6847
2024-06-13 14:55:48:INFO:VAL-(cmcm) >>
2024-06-13 14:55:48:INFO:M: >>  Has0_acc_2: 0.7380  Has0_F1_score: 0.7364  Non0_acc_2: 0.7731  Non0_F1_score: 0.7738  Mult_acc_5: 0.4061  Mult_acc_7: 0.3231  MAE: 1.0499  Corr: 0.6057 
2024-06-13 14:55:48:INFO:Saving checkpoint at epoch 38 to results/models/cmcm-mosi-regression.pth.
2024-06-13 14:56:03:INFO:TRAIN-(cmcm) (1/39/5)>> loss: 0.6776
2024-06-13 14:56:06:INFO:VAL-(cmcm) >>
2024-06-13 14:56:06:INFO:M: >>  Has0_acc_2: 0.7467  Has0_F1_score: 0.7457  Non0_acc_2: 0.7639  Non0_F1_score: 0.7614  Mult_acc_5: 0.4105  Mult_acc_7: 0.3188  MAE: 1.0630  Corr: 0.5908 
2024-06-13 14:56:21:INFO:TRAIN-(cmcm) (2/40/5)>> loss: 0.6912
2024-06-13 14:56:23:INFO:VAL-(cmcm) >>
2024-06-13 14:56:23:INFO:M: >>  Has0_acc_2: 0.7205  Has0_F1_score: 0.7232  Non0_acc_2: 0.7407  Non0_F1_score: 0.7421  Mult_acc_5: 0.3843  Mult_acc_7: 0.3188  MAE: 1.1280  Corr: 0.5710 
2024-06-13 14:56:38:INFO:TRAIN-(cmcm) (3/41/5)>> loss: 0.6760
2024-06-13 14:56:41:INFO:VAL-(cmcm) >>
2024-06-13 14:56:41:INFO:M: >>  Has0_acc_2: 0.7293  Has0_F1_score: 0.7319  Non0_acc_2: 0.7639  Non0_F1_score: 0.7652  Mult_acc_5: 0.3712  Mult_acc_7: 0.2795  MAE: 1.1324  Corr: 0.5766 
2024-06-13 14:56:56:INFO:TRAIN-(cmcm) (4/42/5)>> loss: 0.6922
2024-06-13 14:56:58:INFO:VAL-(cmcm) >>
2024-06-13 14:56:58:INFO:M: >>  Has0_acc_2: 0.7162  Has0_F1_score: 0.7185  Non0_acc_2: 0.7454  Non0_F1_score: 0.7467  Mult_acc_5: 0.3974  Mult_acc_7: 0.3231  MAE: 1.0777  Corr: 0.5771 
2024-06-13 14:57:13:INFO:TRAIN-(cmcm) (5/43/5)>> loss: 0.6623
2024-06-13 14:57:16:INFO:VAL-(cmcm) >>
2024-06-13 14:57:16:INFO:M: >>  Has0_acc_2: 0.7074  Has0_F1_score: 0.7102  Non0_acc_2: 0.7176  Non0_F1_score: 0.7170  Mult_acc_5: 0.3537  Mult_acc_7: 0.2882  MAE: 1.1676  Corr: 0.5370 
2024-06-13 14:57:30:INFO:TRAIN-(cmcm) (6/44/5)>> loss: 0.6619
2024-06-13 14:57:33:INFO:VAL-(cmcm) >>
2024-06-13 14:57:33:INFO:M: >>  Has0_acc_2: 0.7074  Has0_F1_score: 0.7101  Non0_acc_2: 0.7037  Non0_F1_score: 0.7044  Mult_acc_5: 0.3843  Mult_acc_7: 0.3013  MAE: 1.1162  Corr: 0.5786 
2024-06-13 14:57:48:INFO:TRAIN-(cmcm) (7/45/5)>> loss: 0.6504
2024-06-13 14:57:50:INFO:VAL-(cmcm) >>
2024-06-13 14:57:50:INFO:M: >>  Has0_acc_2: 0.7031  Has0_F1_score: 0.7048  Non0_acc_2: 0.7315  Non0_F1_score: 0.7321  Mult_acc_5: 0.4105  Mult_acc_7: 0.3275  MAE: 1.0643  Corr: 0.5846 
2024-06-13 14:58:05:INFO:TRAIN-(cmcm) (8/46/5)>> loss: 0.6547
2024-06-13 14:58:08:INFO:VAL-(cmcm) >>
2024-06-13 14:58:08:INFO:M: >>  Has0_acc_2: 0.7293  Has0_F1_score: 0.7308  Non0_acc_2: 0.7593  Non0_F1_score: 0.7596  Mult_acc_5: 0.4061  Mult_acc_7: 0.3188  MAE: 1.0707  Corr: 0.5769 
2024-06-13 14:58:22:INFO:TRAIN-(cmcm) (9/47/5)>> loss: 0.6471
2024-06-13 14:58:25:INFO:VAL-(cmcm) >>
2024-06-13 14:58:25:INFO:M: >>  Has0_acc_2: 0.7467  Has0_F1_score: 0.7489  Non0_acc_2: 0.7361  Non0_F1_score: 0.7371  Mult_acc_5: 0.3755  Mult_acc_7: 0.3013  MAE: 1.0870  Corr: 0.5588 
2024-06-13 14:58:40:INFO:TRAIN-(cmcm) (10/48/5)>> loss: 0.6367
2024-06-13 14:58:42:INFO:VAL-(cmcm) >>
2024-06-13 14:58:42:INFO:M: >>  Has0_acc_2: 0.7205  Has0_F1_score: 0.7232  Non0_acc_2: 0.7407  Non0_F1_score: 0.7418  Mult_acc_5: 0.3406  Mult_acc_7: 0.2620  MAE: 1.1472  Corr: 0.5816 
2024-06-13 14:58:50:INFO:TEST-(cmcm) >>
2024-06-13 14:58:50:INFO:M: >>  Has0_acc_2: 0.6822  Has0_F1_score: 0.6808  Non0_acc_2: 0.7256  Non0_F1_score: 0.7272  Mult_acc_5: 0.3411  Mult_acc_7: 0.3047  MAE: 1.1585  Corr: 0.5109 
2024-06-13 14:58:50:INFO:Results are added to results/results/mosi-regression-90.csv...
2024-06-13 14:58:50:INFO:Start running cmcm...
2024-06-13 14:58:50:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 6, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 100, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-06-13 14:58:50:INFO:Let's use the GPU 1 !
2024-06-13 14:58:50:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 14:58:51:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718261931 HTTP/1.1" 200 235
2024-06-13 14:58:51:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 14:58:51:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 14:58:52:INFO:train samples: (1284,)
2024-06-13 14:58:52:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 14:58:53:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718261933 HTTP/1.1" 200 235
2024-06-13 14:58:53:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 14:58:54:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 14:58:54:INFO:valid samples: (229,)
2024-06-13 14:58:54:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 14:58:54:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718261935 HTTP/1.1" 200 235
2024-06-13 14:58:55:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 14:58:55:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 14:58:56:INFO:test samples: (686,)
2024-06-13 14:58:56:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 14:58:56:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718261936 HTTP/1.1" 200 235
2024-06-13 14:58:57:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 14:58:57:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 14:58:58:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 14:58:58:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718261938 HTTP/1.1" 200 235
2024-06-13 14:58:58:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 14:58:59:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 14:58:59:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-13 14:58:59:WARNING:Try importing flash-attention for faster inference...
2024-06-13 14:58:59:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-13 14:58:59:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-13 14:58:59:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-13 14:59:00:INFO:trainable params: 1310288 || all params: 1838138960 || trainable%: 0.07128340286090232
2024-06-13 14:59:00:INFO:Init labels...
2024-06-13 14:59:00:INFO:Start training...
2024-06-13 14:59:15:INFO:TRAIN-(cmcm) (1/1/1)>> loss: 3.9808
2024-06-13 14:59:18:INFO:VAL-(cmcm) >>
2024-06-13 14:59:18:INFO:M: >>  Has0_acc_2: 0.5022  Has0_F1_score: 0.4998  Non0_acc_2: 0.5093  Non0_F1_score: 0.5048  Mult_acc_5: 0.2271  Mult_acc_7: 0.1179  MAE: 3.2685  Corr: 0.1515 
2024-06-13 14:59:18:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-13 14:59:34:INFO:TRAIN-(cmcm) (1/2/1)>> loss: 1.2015
2024-06-13 14:59:36:INFO:VAL-(cmcm) >>
2024-06-13 14:59:36:INFO:M: >>  Has0_acc_2: 0.5590  Has0_F1_score: 0.5479  Non0_acc_2: 0.5463  Non0_F1_score: 0.5340  Mult_acc_5: 0.2052  Mult_acc_7: 0.1834  MAE: 1.6384  Corr: -0.0030 
2024-06-13 14:59:37:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-13 14:59:52:INFO:TRAIN-(cmcm) (1/3/1)>> loss: 0.9276
2024-06-13 14:59:54:INFO:VAL-(cmcm) >>
2024-06-13 14:59:54:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5741  Non0_F1_score: 0.4187  Mult_acc_5: 0.2795  Mult_acc_7: 0.2140  MAE: 1.7276  Corr: -0.0331 
2024-06-13 15:00:09:INFO:TRAIN-(cmcm) (2/4/1)>> loss: 0.9103
2024-06-13 15:00:12:INFO:VAL-(cmcm) >>
2024-06-13 15:00:12:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4652  Non0_acc_2: 0.5787  Non0_F1_score: 0.4370  Mult_acc_5: 0.1747  Mult_acc_7: 0.1747  MAE: 1.5060  Corr: 0.0314 
2024-06-13 15:00:12:INFO:Saving checkpoint at epoch 4 to results/models/cmcm-mosi-regression.pth.
2024-06-13 15:00:27:INFO:TRAIN-(cmcm) (1/5/1)>> loss: 0.8883
2024-06-13 15:00:30:INFO:VAL-(cmcm) >>
2024-06-13 15:00:30:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4556  Non0_acc_2: 0.5741  Non0_F1_score: 0.4269  Mult_acc_5: 0.1834  Mult_acc_7: 0.1485  MAE: 1.6459  Corr: -0.0738 
2024-06-13 15:00:45:INFO:TRAIN-(cmcm) (2/6/1)>> loss: 0.8827
2024-06-13 15:00:47:INFO:VAL-(cmcm) >>
2024-06-13 15:00:47:INFO:M: >>  Has0_acc_2: 0.5502  Has0_F1_score: 0.5121  Non0_acc_2: 0.5370  Non0_F1_score: 0.4961  Mult_acc_5: 0.2620  Mult_acc_7: 0.1878  MAE: 1.6970  Corr: -0.0207 
2024-06-13 15:01:02:INFO:TRAIN-(cmcm) (3/7/1)>> loss: 0.8776
2024-06-13 15:01:05:INFO:VAL-(cmcm) >>
2024-06-13 15:01:05:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.5057  Non0_acc_2: 0.5602  Non0_F1_score: 0.4857  Mult_acc_5: 0.2838  Mult_acc_7: 0.2052  MAE: 1.7555  Corr: -0.0215 
2024-06-13 15:01:20:INFO:TRAIN-(cmcm) (4/8/1)>> loss: 0.8782
2024-06-13 15:01:22:INFO:VAL-(cmcm) >>
2024-06-13 15:01:22:INFO:M: >>  Has0_acc_2: 0.5590  Has0_F1_score: 0.5479  Non0_acc_2: 0.5556  Non0_F1_score: 0.5418  Mult_acc_5: 0.1834  Mult_acc_7: 0.1834  MAE: 1.5724  Corr: 0.0169 
2024-06-13 15:01:37:INFO:TRAIN-(cmcm) (5/9/1)>> loss: 0.8694
2024-06-13 15:01:40:INFO:VAL-(cmcm) >>
2024-06-13 15:01:40:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.4869  Non0_acc_2: 0.5509  Non0_F1_score: 0.4598  Mult_acc_5: 0.1659  Mult_acc_7: 0.1659  MAE: 1.5488  Corr: -0.0138 
2024-06-13 15:01:55:INFO:TRAIN-(cmcm) (6/10/1)>> loss: 0.8679
2024-06-13 15:01:57:INFO:VAL-(cmcm) >>
2024-06-13 15:01:57:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.4920  Non0_acc_2: 0.5602  Non0_F1_score: 0.4710  Mult_acc_5: 0.2926  Mult_acc_7: 0.2140  MAE: 1.7983  Corr: -0.0300 
2024-06-13 15:02:12:INFO:TRAIN-(cmcm) (7/11/1)>> loss: 0.8692
2024-06-13 15:02:15:INFO:VAL-(cmcm) >>
2024-06-13 15:02:15:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5087  Non0_acc_2: 0.5648  Non0_F1_score: 0.4888  Mult_acc_5: 0.2882  Mult_acc_7: 0.2096  MAE: 1.7721  Corr: -0.0193 
2024-06-13 15:02:30:INFO:TRAIN-(cmcm) (8/12/1)>> loss: 0.8612
2024-06-13 15:02:33:INFO:VAL-(cmcm) >>
2024-06-13 15:02:33:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.5029  Non0_acc_2: 0.5926  Non0_F1_score: 0.4856  Mult_acc_5: 0.1747  Mult_acc_7: 0.1747  MAE: 1.4292  Corr: 0.0354 
2024-06-13 15:02:33:INFO:Saving checkpoint at epoch 12 to results/models/cmcm-mosi-regression.pth.
2024-06-13 15:02:48:INFO:TRAIN-(cmcm) (1/13/1)>> loss: 0.8582
2024-06-13 15:02:51:INFO:VAL-(cmcm) >>
2024-06-13 15:02:51:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.5166  Non0_acc_2: 0.5833  Non0_F1_score: 0.4911  Mult_acc_5: 0.3013  Mult_acc_7: 0.2140  MAE: 1.7285  Corr: 0.0508 
2024-06-13 15:03:06:INFO:TRAIN-(cmcm) (2/14/1)>> loss: 0.8554
2024-06-13 15:03:09:INFO:VAL-(cmcm) >>
2024-06-13 15:03:09:INFO:M: >>  Has0_acc_2: 0.5415  Has0_F1_score: 0.5459  Non0_acc_2: 0.5463  Non0_F1_score: 0.5488  Mult_acc_5: 0.2052  Mult_acc_7: 0.1790  MAE: 1.5782  Corr: 0.0718 
2024-06-13 15:03:23:INFO:TRAIN-(cmcm) (3/15/1)>> loss: 0.8637
2024-06-13 15:03:26:INFO:VAL-(cmcm) >>
2024-06-13 15:03:26:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4577  Non0_acc_2: 0.5787  Non0_F1_score: 0.4291  Mult_acc_5: 0.3013  Mult_acc_7: 0.2096  MAE: 1.7643  Corr: 0.0498 
2024-06-13 15:03:41:INFO:TRAIN-(cmcm) (4/16/1)>> loss: 0.8536
2024-06-13 15:03:43:INFO:VAL-(cmcm) >>
2024-06-13 15:03:43:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5042  Non0_acc_2: 0.5926  Non0_F1_score: 0.5666  Mult_acc_5: 0.2664  Mult_acc_7: 0.2227  MAE: 1.4197  Corr: 0.1434 
2024-06-13 15:03:44:INFO:Saving checkpoint at epoch 16 to results/models/cmcm-mosi-regression.pth.
2024-06-13 15:03:59:INFO:TRAIN-(cmcm) (1/17/1)>> loss: 0.8543
2024-06-13 15:04:02:INFO:VAL-(cmcm) >>
2024-06-13 15:04:02:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4577  Non0_acc_2: 0.5694  Non0_F1_score: 0.4246  Mult_acc_5: 0.2969  Mult_acc_7: 0.2183  MAE: 1.6673  Corr: 0.0400 
2024-06-13 15:04:17:INFO:TRAIN-(cmcm) (2/18/1)>> loss: 0.8554
2024-06-13 15:04:19:INFO:VAL-(cmcm) >>
2024-06-13 15:04:19:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4767  Non0_acc_2: 0.5417  Non0_F1_score: 0.5425  Mult_acc_5: 0.2664  Mult_acc_7: 0.2140  MAE: 1.4231  Corr: 0.1485 
2024-06-13 15:04:34:INFO:TRAIN-(cmcm) (3/19/1)>> loss: 0.8526
2024-06-13 15:04:37:INFO:VAL-(cmcm) >>
2024-06-13 15:04:37:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.4939  Non0_acc_2: 0.5602  Non0_F1_score: 0.4761  Mult_acc_5: 0.2664  Mult_acc_7: 0.1878  MAE: 1.7817  Corr: -0.0233 
2024-06-13 15:04:52:INFO:TRAIN-(cmcm) (4/20/1)>> loss: 0.9129
2024-06-13 15:04:54:INFO:VAL-(cmcm) >>
2024-06-13 15:04:54:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5741  Non0_F1_score: 0.4187  Mult_acc_5: 0.2533  Mult_acc_7: 0.2227  MAE: 1.6497  Corr: -0.0451 
2024-06-13 15:05:09:INFO:TRAIN-(cmcm) (5/21/1)>> loss: 0.8679
2024-06-13 15:05:12:INFO:VAL-(cmcm) >>
2024-06-13 15:05:12:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4866  Non0_acc_2: 0.5648  Non0_F1_score: 0.4627  Mult_acc_5: 0.2664  Mult_acc_7: 0.1965  MAE: 1.7494  Corr: -0.0064 
2024-06-13 15:05:27:INFO:TRAIN-(cmcm) (6/22/1)>> loss: 0.8605
2024-06-13 15:05:29:INFO:VAL-(cmcm) >>
2024-06-13 15:05:29:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.5117  Non0_acc_2: 0.5509  Non0_F1_score: 0.4921  Mult_acc_5: 0.2838  Mult_acc_7: 0.2052  MAE: 1.7071  Corr: -0.0045 
2024-06-13 15:05:44:INFO:TRAIN-(cmcm) (7/23/1)>> loss: 0.8565
2024-06-13 15:05:47:INFO:VAL-(cmcm) >>
2024-06-13 15:05:47:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.5040  Non0_acc_2: 0.5509  Non0_F1_score: 0.4921  Mult_acc_5: 0.2795  Mult_acc_7: 0.2009  MAE: 1.7468  Corr: 0.0027 
2024-06-13 15:06:02:INFO:TRAIN-(cmcm) (8/24/1)>> loss: 0.8521
2024-06-13 15:06:05:INFO:VAL-(cmcm) >>
2024-06-13 15:06:05:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.5116  Non0_acc_2: 0.5370  Non0_F1_score: 0.4992  Mult_acc_5: 0.1616  Mult_acc_7: 0.1616  MAE: 1.5174  Corr: 0.0004 
2024-06-13 15:06:20:INFO:TRAIN-(cmcm) (9/25/1)>> loss: 0.8537
2024-06-13 15:06:22:INFO:VAL-(cmcm) >>
2024-06-13 15:06:22:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5146  Non0_acc_2: 0.5509  Non0_F1_score: 0.5534  Mult_acc_5: 0.2620  Mult_acc_7: 0.2052  MAE: 1.4781  Corr: 0.0625 
2024-06-13 15:06:37:INFO:TRAIN-(cmcm) (10/26/1)>> loss: 0.8504
2024-06-13 15:06:40:INFO:VAL-(cmcm) >>
2024-06-13 15:06:40:INFO:M: >>  Has0_acc_2: 0.5459  Has0_F1_score: 0.5301  Non0_acc_2: 0.5324  Non0_F1_score: 0.5152  Mult_acc_5: 0.2838  Mult_acc_7: 0.2096  MAE: 1.7368  Corr: -0.0172 
2024-06-13 15:06:47:INFO:TEST-(cmcm) >>
2024-06-13 15:06:47:INFO:M: >>  Has0_acc_2: 0.4898  Has0_F1_score: 0.4203  Non0_acc_2: 0.4649  Non0_F1_score: 0.4274  Mult_acc_5: 0.1837  Mult_acc_7: 0.1749  MAE: 1.6269  Corr: 0.0104 
2024-06-13 15:06:48:INFO:Results are added to results/results/mosi-regression-100.csv...
2024-06-13 15:06:48:INFO:Start running cmcm...
2024-06-13 15:06:48:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 6, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 100, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 2222}>
2024-06-13 15:06:48:INFO:Let's use the GPU 1 !
2024-06-13 15:06:48:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 15:06:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718262408 HTTP/1.1" 200 235
2024-06-13 15:06:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 15:06:49:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 15:06:50:INFO:train samples: (1284,)
2024-06-13 15:06:50:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 15:06:50:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718262410 HTTP/1.1" 200 235
2024-06-13 15:06:50:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 15:06:51:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 15:06:51:INFO:valid samples: (229,)
2024-06-13 15:06:51:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 15:06:52:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718262412 HTTP/1.1" 200 235
2024-06-13 15:06:52:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 15:06:52:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 15:06:53:INFO:test samples: (686,)
2024-06-13 15:06:53:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 15:06:53:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718262413 HTTP/1.1" 200 235
2024-06-13 15:06:53:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 15:06:54:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 15:06:54:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 15:06:55:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718262415 HTTP/1.1" 200 235
2024-06-13 15:06:55:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 15:06:55:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 15:06:55:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-13 15:06:55:WARNING:Try importing flash-attention for faster inference...
2024-06-13 15:06:55:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-13 15:06:55:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-13 15:06:55:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-13 15:06:57:INFO:trainable params: 1310288 || all params: 1838138960 || trainable%: 0.07128340286090232
2024-06-13 15:06:57:INFO:Init labels...
2024-06-13 15:06:57:INFO:Start training...
2024-06-13 15:07:12:INFO:TRAIN-(cmcm) (1/1/2)>> loss: 3.8986
2024-06-13 15:07:14:INFO:VAL-(cmcm) >>
2024-06-13 15:07:14:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5509  Non0_F1_score: 0.4881  Mult_acc_5: 0.2314  Mult_acc_7: 0.1747  MAE: 1.7095  Corr: -0.0139 
2024-06-13 15:07:14:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-13 15:07:30:INFO:TRAIN-(cmcm) (1/2/2)>> loss: 1.3897
2024-06-13 15:07:32:INFO:VAL-(cmcm) >>
2024-06-13 15:07:32:INFO:M: >>  Has0_acc_2: 0.5459  Has0_F1_score: 0.5144  Non0_acc_2: 0.5278  Non0_F1_score: 0.4950  Mult_acc_5: 0.1485  Mult_acc_7: 0.1441  MAE: 1.6593  Corr: -0.0026 
2024-06-13 15:07:32:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-13 15:07:48:INFO:TRAIN-(cmcm) (1/3/2)>> loss: 0.9909
2024-06-13 15:07:50:INFO:VAL-(cmcm) >>
2024-06-13 15:07:50:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.5032  Non0_acc_2: 0.5787  Non0_F1_score: 0.4881  Mult_acc_5: 0.2009  Mult_acc_7: 0.1965  MAE: 1.4296  Corr: 0.0695 
2024-06-13 15:07:51:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-mosi-regression.pth.
2024-06-13 15:08:06:INFO:TRAIN-(cmcm) (1/4/2)>> loss: 0.9515
2024-06-13 15:08:08:INFO:VAL-(cmcm) >>
2024-06-13 15:08:08:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.4736  Non0_acc_2: 0.5602  Non0_F1_score: 0.4710  Mult_acc_5: 0.2052  Mult_acc_7: 0.1747  MAE: 1.5903  Corr: -0.0552 
2024-06-13 15:08:23:INFO:TRAIN-(cmcm) (2/5/2)>> loss: 0.9266
2024-06-13 15:08:26:INFO:VAL-(cmcm) >>
2024-06-13 15:08:26:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5741  Non0_F1_score: 0.4187  Mult_acc_5: 0.2926  Mult_acc_7: 0.2140  MAE: 1.7721  Corr: 0.0191 
2024-06-13 15:08:41:INFO:TRAIN-(cmcm) (3/6/2)>> loss: 0.9243
2024-06-13 15:08:44:INFO:VAL-(cmcm) >>
2024-06-13 15:08:44:INFO:M: >>  Has0_acc_2: 0.5240  Has0_F1_score: 0.5286  Non0_acc_2: 0.5231  Non0_F1_score: 0.5253  Mult_acc_5: 0.1878  Mult_acc_7: 0.1747  MAE: 1.6743  Corr: -0.0091 
2024-06-13 15:08:59:INFO:TRAIN-(cmcm) (4/7/2)>> loss: 0.9073
2024-06-13 15:09:02:INFO:VAL-(cmcm) >>
2024-06-13 15:09:02:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.4943  Non0_acc_2: 0.5833  Non0_F1_score: 0.4676  Mult_acc_5: 0.2227  Mult_acc_7: 0.2227  MAE: 1.4598  Corr: 0.0721 
2024-06-13 15:09:17:INFO:TRAIN-(cmcm) (5/8/2)>> loss: 0.8990
2024-06-13 15:09:19:INFO:VAL-(cmcm) >>
2024-06-13 15:09:19:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4652  Non0_acc_2: 0.5787  Non0_F1_score: 0.4370  Mult_acc_5: 0.1747  Mult_acc_7: 0.1747  MAE: 1.5065  Corr: 0.0291 
2024-06-13 15:09:34:INFO:TRAIN-(cmcm) (6/9/2)>> loss: 0.8844
2024-06-13 15:09:37:INFO:VAL-(cmcm) >>
2024-06-13 15:09:37:INFO:M: >>  Has0_acc_2: 0.5590  Has0_F1_score: 0.5367  Non0_acc_2: 0.5509  Non0_F1_score: 0.5260  Mult_acc_5: 0.2620  Mult_acc_7: 0.1790  MAE: 1.8193  Corr: -0.0030 
2024-06-13 15:09:52:INFO:TRAIN-(cmcm) (7/10/2)>> loss: 0.8942
2024-06-13 15:09:54:INFO:VAL-(cmcm) >>
2024-06-13 15:09:54:INFO:M: >>  Has0_acc_2: 0.4236  Has0_F1_score: 0.3947  Non0_acc_2: 0.4306  Non0_F1_score: 0.3985  Mult_acc_5: 0.1790  Mult_acc_7: 0.1354  MAE: 2.0528  Corr: -0.0423 
2024-06-13 15:10:09:INFO:TRAIN-(cmcm) (8/11/2)>> loss: 0.8815
2024-06-13 15:10:12:INFO:VAL-(cmcm) >>
2024-06-13 15:10:12:INFO:M: >>  Has0_acc_2: 0.5633  Has0_F1_score: 0.5305  Non0_acc_2: 0.5417  Non0_F1_score: 0.5085  Mult_acc_5: 0.2140  Mult_acc_7: 0.1965  MAE: 1.5890  Corr: 0.0258 
2024-06-13 15:10:27:INFO:TRAIN-(cmcm) (9/12/2)>> loss: 0.8709
2024-06-13 15:10:29:INFO:VAL-(cmcm) >>
2024-06-13 15:10:29:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.4694  Non0_acc_2: 0.5602  Non0_F1_score: 0.4414  Mult_acc_5: 0.1747  Mult_acc_7: 0.1747  MAE: 1.6012  Corr: -0.0499 
2024-06-13 15:10:44:INFO:TRAIN-(cmcm) (10/13/2)>> loss: 0.8658
2024-06-13 15:10:47:INFO:VAL-(cmcm) >>
2024-06-13 15:10:47:INFO:M: >>  Has0_acc_2: 0.4847  Has0_F1_score: 0.4843  Non0_acc_2: 0.5000  Non0_F1_score: 0.4985  Mult_acc_5: 0.2271  Mult_acc_7: 0.1834  MAE: 1.6991  Corr: -0.0004 
2024-06-13 15:10:54:INFO:TEST-(cmcm) >>
2024-06-13 15:10:54:INFO:M: >>  Has0_acc_2: 0.4767  Has0_F1_score: 0.3673  Non0_acc_2: 0.4802  Non0_F1_score: 0.3975  Mult_acc_5: 0.1924  Mult_acc_7: 0.1910  MAE: 1.5395  Corr: 0.0043 
2024-06-13 15:10:54:INFO:Results are added to results/results/mosi-regression-100.csv...
2024-06-13 15:10:54:INFO:Start running cmcm...
2024-06-13 15:10:54:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 6, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 100, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 3333}>
2024-06-13 15:10:54:INFO:Let's use the GPU 1 !
2024-06-13 15:10:55:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 15:10:58:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718262655 HTTP/1.1" 200 235
2024-06-13 15:10:58:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 15:10:58:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 15:10:59:INFO:train samples: (1284,)
2024-06-13 15:10:59:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 15:11:00:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718262660 HTTP/1.1" 200 235
2024-06-13 15:11:00:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 15:11:01:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 15:11:01:INFO:valid samples: (229,)
2024-06-13 15:11:02:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 15:11:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718262662 HTTP/1.1" 200 235
2024-06-13 15:11:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 15:11:03:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 15:11:03:INFO:test samples: (686,)
2024-06-13 15:11:03:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 15:11:04:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718262664 HTTP/1.1" 200 235
2024-06-13 15:11:04:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 15:11:04:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 15:11:05:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 15:11:05:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718262665 HTTP/1.1" 200 235
2024-06-13 15:11:05:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 15:11:06:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 15:11:06:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-13 15:11:06:WARNING:Try importing flash-attention for faster inference...
2024-06-13 15:11:06:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-13 15:11:06:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-13 15:11:06:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-13 15:11:07:INFO:trainable params: 1310288 || all params: 1838138960 || trainable%: 0.07128340286090232
2024-06-13 15:11:07:INFO:Init labels...
2024-06-13 15:11:07:INFO:Start training...
2024-06-13 15:11:22:INFO:TRAIN-(cmcm) (1/1/3)>> loss: 4.1115
2024-06-13 15:11:25:INFO:VAL-(cmcm) >>
2024-06-13 15:11:25:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4676  Non0_F1_score: 0.4672  Mult_acc_5: 0.2358  Mult_acc_7: 0.1703  MAE: 1.9555  Corr: -0.0275 
2024-06-13 15:11:25:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-13 15:11:41:INFO:TRAIN-(cmcm) (1/2/3)>> loss: 1.4255
2024-06-13 15:11:44:INFO:VAL-(cmcm) >>
2024-06-13 15:11:44:INFO:M: >>  Has0_acc_2: 0.5371  Has0_F1_score: 0.5395  Non0_acc_2: 0.5417  Non0_F1_score: 0.5406  Mult_acc_5: 0.2009  Mult_acc_7: 0.1572  MAE: 1.7656  Corr: 0.0496 
2024-06-13 15:11:44:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-13 15:12:00:INFO:TRAIN-(cmcm) (1/3/3)>> loss: 0.9486
2024-06-13 15:12:02:INFO:VAL-(cmcm) >>
2024-06-13 15:12:02:INFO:M: >>  Has0_acc_2: 0.5022  Has0_F1_score: 0.4702  Non0_acc_2: 0.5231  Non0_F1_score: 0.4914  Mult_acc_5: 0.2402  Mult_acc_7: 0.1921  MAE: 1.9091  Corr: 0.1113 
2024-06-13 15:12:17:INFO:TRAIN-(cmcm) (2/4/3)>> loss: 0.9075
2024-06-13 15:12:20:INFO:VAL-(cmcm) >>
2024-06-13 15:12:20:INFO:M: >>  Has0_acc_2: 0.3930  Has0_F1_score: 0.2341  Non0_acc_2: 0.4259  Non0_F1_score: 0.2544  Mult_acc_5: 0.1354  Mult_acc_7: 0.1266  MAE: 1.9515  Corr: -0.0159 
2024-06-13 15:12:35:INFO:TRAIN-(cmcm) (3/5/3)>> loss: 0.9221
2024-06-13 15:12:37:INFO:VAL-(cmcm) >>
2024-06-13 15:12:37:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.4470  Non0_acc_2: 0.5509  Non0_F1_score: 0.4227  Mult_acc_5: 0.1616  Mult_acc_7: 0.1616  MAE: 1.4846  Corr: 0.0280 
2024-06-13 15:12:38:INFO:Saving checkpoint at epoch 5 to results/models/cmcm-mosi-regression.pth.
2024-06-13 15:12:53:INFO:TRAIN-(cmcm) (1/6/3)>> loss: 0.8845
2024-06-13 15:12:56:INFO:VAL-(cmcm) >>
2024-06-13 15:12:56:INFO:M: >>  Has0_acc_2: 0.5590  Has0_F1_score: 0.5244  Non0_acc_2: 0.5509  Non0_F1_score: 0.5127  Mult_acc_5: 0.2052  Mult_acc_7: 0.1703  MAE: 1.7708  Corr: -0.0043 
2024-06-13 15:13:11:INFO:TRAIN-(cmcm) (2/7/3)>> loss: 0.8853
2024-06-13 15:13:13:INFO:VAL-(cmcm) >>
2024-06-13 15:13:13:INFO:M: >>  Has0_acc_2: 0.5590  Has0_F1_score: 0.5055  Non0_acc_2: 0.5648  Non0_F1_score: 0.5320  Mult_acc_5: 0.1659  Mult_acc_7: 0.1659  MAE: 1.5322  Corr: 0.0335 
2024-06-13 15:13:28:INFO:TRAIN-(cmcm) (3/8/3)>> loss: 0.8841
2024-06-13 15:13:31:INFO:VAL-(cmcm) >>
2024-06-13 15:13:31:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.5158  Non0_acc_2: 0.5694  Non0_F1_score: 0.4871  Mult_acc_5: 0.1834  Mult_acc_7: 0.1703  MAE: 1.5226  Corr: -0.0086 
2024-06-13 15:13:46:INFO:TRAIN-(cmcm) (4/9/3)>> loss: 0.8732
2024-06-13 15:13:48:INFO:VAL-(cmcm) >>
2024-06-13 15:13:48:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4607  Non0_acc_2: 0.5787  Non0_F1_score: 0.4445  Mult_acc_5: 0.2838  Mult_acc_7: 0.2009  MAE: 1.7040  Corr: 0.0495 
2024-06-13 15:14:03:INFO:TRAIN-(cmcm) (5/10/3)>> loss: 0.8704
2024-06-13 15:14:06:INFO:VAL-(cmcm) >>
2024-06-13 15:14:06:INFO:M: >>  Has0_acc_2: 0.5546  Has0_F1_score: 0.5183  Non0_acc_2: 0.5509  Non0_F1_score: 0.5156  Mult_acc_5: 0.2140  Mult_acc_7: 0.1703  MAE: 1.6008  Corr: 0.0617 
2024-06-13 15:14:21:INFO:TRAIN-(cmcm) (6/11/3)>> loss: 0.8637
2024-06-13 15:14:24:INFO:VAL-(cmcm) >>
2024-06-13 15:14:24:INFO:M: >>  Has0_acc_2: 0.6288  Has0_F1_score: 0.5706  Non0_acc_2: 0.5972  Non0_F1_score: 0.5840  Mult_acc_5: 0.2620  Mult_acc_7: 0.2140  MAE: 1.4218  Corr: 0.1907 
2024-06-13 15:14:24:INFO:Saving checkpoint at epoch 11 to results/models/cmcm-mosi-regression.pth.
2024-06-13 15:14:39:INFO:TRAIN-(cmcm) (1/12/3)>> loss: 0.8500
2024-06-13 15:14:42:INFO:VAL-(cmcm) >>
2024-06-13 15:14:42:INFO:M: >>  Has0_acc_2: 0.6245  Has0_F1_score: 0.6143  Non0_acc_2: 0.5880  Non0_F1_score: 0.5892  Mult_acc_5: 0.2009  Mult_acc_7: 0.1921  MAE: 1.4095  Corr: 0.1787 
2024-06-13 15:14:42:INFO:Saving checkpoint at epoch 12 to results/models/cmcm-mosi-regression.pth.
2024-06-13 15:14:58:INFO:TRAIN-(cmcm) (1/13/3)>> loss: 0.8496
2024-06-13 15:15:00:INFO:VAL-(cmcm) >>
2024-06-13 15:15:00:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.5997  Non0_acc_2: 0.6157  Non0_F1_score: 0.6107  Mult_acc_5: 0.2140  Mult_acc_7: 0.2009  MAE: 1.5612  Corr: 0.1856 
2024-06-13 15:15:15:INFO:TRAIN-(cmcm) (2/14/3)>> loss: 0.8397
2024-06-13 15:15:18:INFO:VAL-(cmcm) >>
2024-06-13 15:15:18:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.5974  Non0_acc_2: 0.6250  Non0_F1_score: 0.6193  Mult_acc_5: 0.2620  Mult_acc_7: 0.2096  MAE: 1.4804  Corr: 0.2936 
2024-06-13 15:15:33:INFO:TRAIN-(cmcm) (3/15/3)>> loss: 0.8391
2024-06-13 15:15:35:INFO:VAL-(cmcm) >>
2024-06-13 15:15:35:INFO:M: >>  Has0_acc_2: 0.6769  Has0_F1_score: 0.6741  Non0_acc_2: 0.6944  Non0_F1_score: 0.6908  Mult_acc_5: 0.2882  Mult_acc_7: 0.2533  MAE: 1.2301  Corr: 0.4514 
2024-06-13 15:15:36:INFO:Saving checkpoint at epoch 15 to results/models/cmcm-mosi-regression.pth.
2024-06-13 15:15:51:INFO:TRAIN-(cmcm) (1/16/3)>> loss: 0.8316
2024-06-13 15:15:53:INFO:VAL-(cmcm) >>
2024-06-13 15:15:53:INFO:M: >>  Has0_acc_2: 0.6157  Has0_F1_score: 0.5456  Non0_acc_2: 0.6157  Non0_F1_score: 0.5423  Mult_acc_5: 0.3144  Mult_acc_7: 0.2314  MAE: 1.6084  Corr: 0.1977 
2024-06-13 15:16:08:INFO:TRAIN-(cmcm) (2/17/3)>> loss: 0.8263
2024-06-13 15:16:11:INFO:VAL-(cmcm) >>
2024-06-13 15:16:11:INFO:M: >>  Has0_acc_2: 0.6900  Has0_F1_score: 0.6832  Non0_acc_2: 0.6991  Non0_F1_score: 0.6903  Mult_acc_5: 0.3712  Mult_acc_7: 0.2795  MAE: 1.3071  Corr: 0.4216 
2024-06-13 15:16:26:INFO:TRAIN-(cmcm) (3/18/3)>> loss: 0.8124
2024-06-13 15:16:29:INFO:VAL-(cmcm) >>
2024-06-13 15:16:29:INFO:M: >>  Has0_acc_2: 0.7031  Has0_F1_score: 0.6873  Non0_acc_2: 0.6898  Non0_F1_score: 0.6840  Mult_acc_5: 0.3755  Mult_acc_7: 0.3144  MAE: 1.2503  Corr: 0.4210 
2024-06-13 15:16:44:INFO:TRAIN-(cmcm) (4/19/3)>> loss: 0.8096
2024-06-13 15:16:47:INFO:VAL-(cmcm) >>
2024-06-13 15:16:47:INFO:M: >>  Has0_acc_2: 0.6943  Has0_F1_score: 0.6713  Non0_acc_2: 0.6991  Non0_F1_score: 0.7007  Mult_acc_5: 0.2969  Mult_acc_7: 0.2576  MAE: 1.2576  Corr: 0.4166 
2024-06-13 15:17:02:INFO:TRAIN-(cmcm) (5/20/3)>> loss: 0.7951
2024-06-13 15:17:04:INFO:VAL-(cmcm) >>
2024-06-13 15:17:04:INFO:M: >>  Has0_acc_2: 0.7074  Has0_F1_score: 0.7086  Non0_acc_2: 0.7315  Non0_F1_score: 0.7306  Mult_acc_5: 0.3537  Mult_acc_7: 0.2620  MAE: 1.2957  Corr: 0.4499 
2024-06-13 15:17:19:INFO:TRAIN-(cmcm) (6/21/3)>> loss: 0.7902
2024-06-13 15:17:22:INFO:VAL-(cmcm) >>
2024-06-13 15:17:22:INFO:M: >>  Has0_acc_2: 0.6943  Has0_F1_score: 0.6849  Non0_acc_2: 0.6898  Non0_F1_score: 0.6830  Mult_acc_5: 0.3668  Mult_acc_7: 0.2926  MAE: 1.2092  Corr: 0.4580 
2024-06-13 15:17:22:INFO:Saving checkpoint at epoch 21 to results/models/cmcm-mosi-regression.pth.
2024-06-13 15:17:38:INFO:TRAIN-(cmcm) (1/22/3)>> loss: 0.7784
2024-06-13 15:17:40:INFO:VAL-(cmcm) >>
2024-06-13 15:17:40:INFO:M: >>  Has0_acc_2: 0.6812  Has0_F1_score: 0.6839  Non0_acc_2: 0.7083  Non0_F1_score: 0.7098  Mult_acc_5: 0.3319  Mult_acc_7: 0.2795  MAE: 1.1864  Corr: 0.5114 
2024-06-13 15:17:41:INFO:Saving checkpoint at epoch 22 to results/models/cmcm-mosi-regression.pth.
2024-06-13 15:17:56:INFO:TRAIN-(cmcm) (1/23/3)>> loss: 0.7783
2024-06-13 15:17:59:INFO:VAL-(cmcm) >>
2024-06-13 15:17:59:INFO:M: >>  Has0_acc_2: 0.6900  Has0_F1_score: 0.6925  Non0_acc_2: 0.7037  Non0_F1_score: 0.7052  Mult_acc_5: 0.3712  Mult_acc_7: 0.3013  MAE: 1.1973  Corr: 0.4798 
2024-06-13 15:18:14:INFO:TRAIN-(cmcm) (2/24/3)>> loss: 0.7708
2024-06-13 15:18:16:INFO:VAL-(cmcm) >>
2024-06-13 15:18:16:INFO:M: >>  Has0_acc_2: 0.7598  Has0_F1_score: 0.7618  Non0_acc_2: 0.7593  Non0_F1_score: 0.7606  Mult_acc_5: 0.3843  Mult_acc_7: 0.3188  MAE: 1.0857  Corr: 0.5688 
2024-06-13 15:18:17:INFO:Saving checkpoint at epoch 24 to results/models/cmcm-mosi-regression.pth.
2024-06-13 15:18:32:INFO:TRAIN-(cmcm) (1/25/3)>> loss: 0.7594
2024-06-13 15:18:34:INFO:VAL-(cmcm) >>
2024-06-13 15:18:34:INFO:M: >>  Has0_acc_2: 0.6943  Has0_F1_score: 0.6971  Non0_acc_2: 0.6435  Non0_F1_score: 0.6399  Mult_acc_5: 0.3537  Mult_acc_7: 0.2882  MAE: 1.2302  Corr: 0.4839 
2024-06-13 15:18:49:INFO:TRAIN-(cmcm) (2/26/3)>> loss: 0.7476
2024-06-13 15:18:52:INFO:VAL-(cmcm) >>
2024-06-13 15:18:52:INFO:M: >>  Has0_acc_2: 0.6987  Has0_F1_score: 0.7016  Non0_acc_2: 0.6898  Non0_F1_score: 0.6891  Mult_acc_5: 0.3406  Mult_acc_7: 0.2707  MAE: 1.2433  Corr: 0.4675 
2024-06-13 15:19:07:INFO:TRAIN-(cmcm) (3/27/3)>> loss: 0.7451
2024-06-13 15:19:10:INFO:VAL-(cmcm) >>
2024-06-13 15:19:10:INFO:M: >>  Has0_acc_2: 0.7031  Has0_F1_score: 0.7012  Non0_acc_2: 0.6296  Non0_F1_score: 0.6245  Mult_acc_5: 0.3057  Mult_acc_7: 0.2620  MAE: 1.2283  Corr: 0.4524 
2024-06-13 15:19:25:INFO:TRAIN-(cmcm) (4/28/3)>> loss: 0.7435
2024-06-13 15:19:27:INFO:VAL-(cmcm) >>
2024-06-13 15:19:27:INFO:M: >>  Has0_acc_2: 0.7118  Has0_F1_score: 0.7131  Non0_acc_2: 0.7037  Non0_F1_score: 0.7052  Mult_acc_5: 0.3799  Mult_acc_7: 0.3013  MAE: 1.1992  Corr: 0.4682 
2024-06-13 15:19:42:INFO:TRAIN-(cmcm) (5/29/3)>> loss: 0.7387
2024-06-13 15:19:45:INFO:VAL-(cmcm) >>
2024-06-13 15:19:45:INFO:M: >>  Has0_acc_2: 0.7118  Has0_F1_score: 0.7018  Non0_acc_2: 0.7222  Non0_F1_score: 0.7189  Mult_acc_5: 0.3886  Mult_acc_7: 0.2795  MAE: 1.2376  Corr: 0.4926 
2024-06-13 15:20:00:INFO:TRAIN-(cmcm) (6/30/3)>> loss: 0.7362
2024-06-13 15:20:03:INFO:VAL-(cmcm) >>
2024-06-13 15:20:03:INFO:M: >>  Has0_acc_2: 0.7336  Has0_F1_score: 0.7329  Non0_acc_2: 0.7130  Non0_F1_score: 0.7142  Mult_acc_5: 0.3581  Mult_acc_7: 0.3013  MAE: 1.1376  Corr: 0.5239 
2024-06-13 15:20:18:INFO:TRAIN-(cmcm) (7/31/3)>> loss: 0.7249
2024-06-13 15:20:20:INFO:VAL-(cmcm) >>
2024-06-13 15:20:20:INFO:M: >>  Has0_acc_2: 0.7074  Has0_F1_score: 0.7029  Non0_acc_2: 0.7269  Non0_F1_score: 0.7199  Mult_acc_5: 0.3537  Mult_acc_7: 0.2882  MAE: 1.1621  Corr: 0.4890 
2024-06-13 15:20:35:INFO:TRAIN-(cmcm) (8/32/3)>> loss: 0.7201
2024-06-13 15:20:38:INFO:VAL-(cmcm) >>
2024-06-13 15:20:38:INFO:M: >>  Has0_acc_2: 0.7380  Has0_F1_score: 0.7370  Non0_acc_2: 0.6759  Non0_F1_score: 0.6775  Mult_acc_5: 0.3493  Mult_acc_7: 0.2838  MAE: 1.1555  Corr: 0.5091 
2024-06-13 15:20:53:INFO:TRAIN-(cmcm) (9/33/3)>> loss: 0.7086
2024-06-13 15:20:55:INFO:VAL-(cmcm) >>
2024-06-13 15:20:55:INFO:M: >>  Has0_acc_2: 0.7293  Has0_F1_score: 0.7220  Non0_acc_2: 0.7407  Non0_F1_score: 0.7377  Mult_acc_5: 0.3843  Mult_acc_7: 0.3013  MAE: 1.1638  Corr: 0.5054 
2024-06-13 15:21:10:INFO:TRAIN-(cmcm) (10/34/3)>> loss: 0.6997
2024-06-13 15:21:13:INFO:VAL-(cmcm) >>
2024-06-13 15:21:13:INFO:M: >>  Has0_acc_2: 0.6943  Has0_F1_score: 0.6749  Non0_acc_2: 0.7130  Non0_F1_score: 0.6913  Mult_acc_5: 0.3755  Mult_acc_7: 0.2969  MAE: 1.1634  Corr: 0.5073 
2024-06-13 15:21:20:INFO:TEST-(cmcm) >>
2024-06-13 15:21:20:INFO:M: >>  Has0_acc_2: 0.7114  Has0_F1_score: 0.7118  Non0_acc_2: 0.7424  Non0_F1_score: 0.7416  Mult_acc_5: 0.3397  Mult_acc_7: 0.2959  MAE: 1.1402  Corr: 0.5052 
2024-06-13 15:21:21:INFO:Results are added to results/results/mosi-regression-100.csv...
2024-06-13 15:21:21:INFO:Start running cmcm...
2024-06-13 15:21:21:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 6, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 100, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 4444}>
2024-06-13 15:21:21:INFO:Let's use the GPU 1 !
2024-06-13 15:21:21:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 15:21:21:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718263281 HTTP/1.1" 200 235
2024-06-13 15:21:21:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 15:21:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 15:21:23:INFO:train samples: (1284,)
2024-06-13 15:21:23:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 15:21:23:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718263283 HTTP/1.1" 200 235
2024-06-13 15:21:23:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 15:21:24:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 15:21:25:INFO:valid samples: (229,)
2024-06-13 15:21:25:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 15:21:25:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718263285 HTTP/1.1" 200 235
2024-06-13 15:21:25:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 15:21:26:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 15:21:26:INFO:test samples: (686,)
2024-06-13 15:21:26:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 15:21:27:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718263287 HTTP/1.1" 200 235
2024-06-13 15:21:27:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 15:21:27:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 15:21:28:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 15:21:28:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718263288 HTTP/1.1" 200 235
2024-06-13 15:21:28:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 15:21:29:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 15:21:29:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-13 15:21:29:WARNING:Try importing flash-attention for faster inference...
2024-06-13 15:21:29:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-13 15:21:29:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-13 15:21:29:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-13 15:21:30:INFO:trainable params: 1310288 || all params: 1838138960 || trainable%: 0.07128340286090232
2024-06-13 15:21:30:INFO:Init labels...
2024-06-13 15:21:30:INFO:Start training...
2024-06-13 15:21:45:INFO:TRAIN-(cmcm) (1/1/4)>> loss: 4.2508
2024-06-13 15:21:48:INFO:VAL-(cmcm) >>
2024-06-13 15:21:48:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4306  Non0_F1_score: 0.2797  Mult_acc_5: 0.2140  Mult_acc_7: 0.2140  MAE: 1.4349  Corr: -0.0027 
2024-06-13 15:21:48:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-13 15:22:04:INFO:TRAIN-(cmcm) (1/2/4)>> loss: 2.6165
2024-06-13 15:22:06:INFO:VAL-(cmcm) >>
2024-06-13 15:22:06:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.4788  Non0_acc_2: 0.5509  Non0_F1_score: 0.5065  Mult_acc_5: 0.2882  Mult_acc_7: 0.1572  MAE: 2.1555  Corr: 0.0648 
2024-06-13 15:22:21:INFO:TRAIN-(cmcm) (2/3/4)>> loss: 1.1557
2024-06-13 15:22:24:INFO:VAL-(cmcm) >>
2024-06-13 15:22:24:INFO:M: >>  Has0_acc_2: 0.4978  Has0_F1_score: 0.5024  Non0_acc_2: 0.4954  Non0_F1_score: 0.4981  Mult_acc_5: 0.1790  Mult_acc_7: 0.1485  MAE: 1.7420  Corr: -0.0590 
2024-06-13 15:22:39:INFO:TRAIN-(cmcm) (3/4/4)>> loss: 0.9679
2024-06-13 15:22:42:INFO:VAL-(cmcm) >>
2024-06-13 15:22:42:INFO:M: >>  Has0_acc_2: 0.4454  Has0_F1_score: 0.3818  Non0_acc_2: 0.4583  Non0_F1_score: 0.3910  Mult_acc_5: 0.1441  Mult_acc_7: 0.1441  MAE: 1.7455  Corr: 0.0226 
2024-06-13 15:22:57:INFO:TRAIN-(cmcm) (4/5/4)>> loss: 0.9199
2024-06-13 15:22:59:INFO:VAL-(cmcm) >>
2024-06-13 15:22:59:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4534  Non0_acc_2: 0.5694  Non0_F1_score: 0.4246  Mult_acc_5: 0.2664  Mult_acc_7: 0.1921  MAE: 1.6844  Corr: -0.0030 
2024-06-13 15:23:14:INFO:TRAIN-(cmcm) (5/6/4)>> loss: 0.9103
2024-06-13 15:23:17:INFO:VAL-(cmcm) >>
2024-06-13 15:23:17:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.4840  Non0_acc_2: 0.5509  Non0_F1_score: 0.4543  Mult_acc_5: 0.2707  Mult_acc_7: 0.2009  MAE: 1.6376  Corr: -0.0304 
2024-06-13 15:23:32:INFO:TRAIN-(cmcm) (6/7/4)>> loss: 0.9254
2024-06-13 15:23:34:INFO:VAL-(cmcm) >>
2024-06-13 15:23:34:INFO:M: >>  Has0_acc_2: 0.5109  Has0_F1_score: 0.5096  Non0_acc_2: 0.5185  Non0_F1_score: 0.5152  Mult_acc_5: 0.1703  Mult_acc_7: 0.1659  MAE: 1.5611  Corr: 0.1555 
2024-06-13 15:23:49:INFO:TRAIN-(cmcm) (7/8/4)>> loss: 0.9175
2024-06-13 15:23:52:INFO:VAL-(cmcm) >>
2024-06-13 15:23:52:INFO:M: >>  Has0_acc_2: 0.5633  Has0_F1_score: 0.5121  Non0_acc_2: 0.5370  Non0_F1_score: 0.4860  Mult_acc_5: 0.2140  Mult_acc_7: 0.2052  MAE: 1.6791  Corr: -0.0180 
2024-06-13 15:24:07:INFO:TRAIN-(cmcm) (8/9/4)>> loss: 0.8844
2024-06-13 15:24:09:INFO:VAL-(cmcm) >>
2024-06-13 15:24:09:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.4562  Non0_acc_2: 0.5694  Non0_F1_score: 0.4595  Mult_acc_5: 0.2882  Mult_acc_7: 0.2227  MAE: 1.6178  Corr: 0.0153 
2024-06-13 15:24:24:INFO:TRAIN-(cmcm) (9/10/4)>> loss: 0.8775
2024-06-13 15:24:27:INFO:VAL-(cmcm) >>
2024-06-13 15:24:27:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.5338  Non0_acc_2: 0.5509  Non0_F1_score: 0.5156  Mult_acc_5: 0.2183  Mult_acc_7: 0.1965  MAE: 1.5606  Corr: -0.0355 
2024-06-13 15:24:42:INFO:TRAIN-(cmcm) (10/11/4)>> loss: 0.8777
2024-06-13 15:24:44:INFO:VAL-(cmcm) >>
2024-06-13 15:24:44:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5466  Non0_acc_2: 0.5556  Non0_F1_score: 0.5320  Mult_acc_5: 0.2227  Mult_acc_7: 0.1834  MAE: 1.6117  Corr: 0.0218 
2024-06-13 15:24:52:INFO:TEST-(cmcm) >>
2024-06-13 15:24:52:INFO:M: >>  Has0_acc_2: 0.4475  Has0_F1_score: 0.2767  Non0_acc_2: 0.5686  Non0_F1_score: 0.4366  Mult_acc_5: 0.1531  Mult_acc_7: 0.1531  MAE: 1.5698  Corr: 0.0066 
2024-06-13 15:24:52:INFO:Results are added to results/results/mosi-regression-100.csv...
2024-06-13 15:24:52:INFO:Start running cmcm...
2024-06-13 15:24:52:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 6, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 100, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 5555}>
2024-06-13 15:24:52:INFO:Let's use the GPU 1 !
2024-06-13 15:24:52:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 15:24:53:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718263493 HTTP/1.1" 200 235
2024-06-13 15:24:53:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 15:24:53:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 15:24:54:INFO:train samples: (1284,)
2024-06-13 15:24:54:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 15:24:54:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718263494 HTTP/1.1" 200 235
2024-06-13 15:24:54:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 15:24:55:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 15:24:56:INFO:valid samples: (229,)
2024-06-13 15:24:56:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 15:24:56:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718263496 HTTP/1.1" 200 235
2024-06-13 15:24:56:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 15:24:57:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 15:24:58:INFO:test samples: (686,)
2024-06-13 15:24:58:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 15:24:58:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718263498 HTTP/1.1" 200 235
2024-06-13 15:24:58:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 15:24:59:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 15:24:59:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 15:25:00:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718263500 HTTP/1.1" 200 235
2024-06-13 15:25:01:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 15:25:01:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 15:25:01:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-13 15:25:01:WARNING:Try importing flash-attention for faster inference...
2024-06-13 15:25:01:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-13 15:25:01:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-13 15:25:01:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-13 15:25:02:INFO:trainable params: 1310288 || all params: 1838138960 || trainable%: 0.07128340286090232
2024-06-13 15:25:02:INFO:Init labels...
2024-06-13 15:25:02:INFO:Start training...
2024-06-13 15:25:18:INFO:TRAIN-(cmcm) (1/1/5)>> loss: 3.3634
2024-06-13 15:25:20:INFO:VAL-(cmcm) >>
2024-06-13 15:25:20:INFO:M: >>  Has0_acc_2: 0.5459  Has0_F1_score: 0.4889  Non0_acc_2: 0.5046  Non0_F1_score: 0.4835  Mult_acc_5: 0.2140  Mult_acc_7: 0.2140  MAE: 1.4541  Corr: 0.0500 
2024-06-13 15:25:21:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-13 15:25:36:INFO:TRAIN-(cmcm) (1/2/5)>> loss: 1.0914
2024-06-13 15:25:39:INFO:VAL-(cmcm) >>
2024-06-13 15:25:39:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5595  Non0_acc_2: 0.5833  Non0_F1_score: 0.5465  Mult_acc_5: 0.1834  Mult_acc_7: 0.1834  MAE: 1.4746  Corr: 0.1080 
2024-06-13 15:25:54:INFO:TRAIN-(cmcm) (2/3/5)>> loss: 0.9217
2024-06-13 15:25:56:INFO:VAL-(cmcm) >>
2024-06-13 15:25:56:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.4924  Non0_acc_2: 0.5648  Non0_F1_score: 0.4684  Mult_acc_5: 0.2445  Mult_acc_7: 0.2009  MAE: 1.6071  Corr: -0.0001 
2024-06-13 15:26:11:INFO:TRAIN-(cmcm) (3/4/5)>> loss: 0.9165
2024-06-13 15:26:14:INFO:VAL-(cmcm) >>
2024-06-13 15:26:14:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5741  Non0_F1_score: 0.4187  Mult_acc_5: 0.3013  Mult_acc_7: 0.2183  MAE: 1.7005  Corr: 0.2099 
2024-06-13 15:26:29:INFO:TRAIN-(cmcm) (4/5/5)>> loss: 0.8885
2024-06-13 15:26:31:INFO:VAL-(cmcm) >>
2024-06-13 15:26:31:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.5608  Non0_acc_2: 0.5602  Non0_F1_score: 0.5440  Mult_acc_5: 0.2489  Mult_acc_7: 0.2052  MAE: 1.5975  Corr: 0.0811 
2024-06-13 15:26:46:INFO:TRAIN-(cmcm) (5/6/5)>> loss: 0.8691
2024-06-13 15:26:49:INFO:VAL-(cmcm) >>
2024-06-13 15:26:49:INFO:M: >>  Has0_acc_2: 0.5546  Has0_F1_score: 0.5578  Non0_acc_2: 0.5509  Non0_F1_score: 0.5506  Mult_acc_5: 0.2358  Mult_acc_7: 0.1834  MAE: 1.6232  Corr: 0.1258 
2024-06-13 15:27:04:INFO:TRAIN-(cmcm) (6/7/5)>> loss: 0.8677
2024-06-13 15:27:06:INFO:VAL-(cmcm) >>
2024-06-13 15:27:06:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.6088  Non0_acc_2: 0.5648  Non0_F1_score: 0.5666  Mult_acc_5: 0.2183  Mult_acc_7: 0.2183  MAE: 1.4366  Corr: 0.1807 
2024-06-13 15:27:07:INFO:Saving checkpoint at epoch 7 to results/models/cmcm-mosi-regression.pth.
2024-06-13 15:27:22:INFO:TRAIN-(cmcm) (1/8/5)>> loss: 0.8745
2024-06-13 15:27:25:INFO:VAL-(cmcm) >>
2024-06-13 15:27:25:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.5013  Non0_acc_2: 0.5602  Non0_F1_score: 0.4810  Mult_acc_5: 0.2838  Mult_acc_7: 0.2052  MAE: 1.8210  Corr: -0.0201 
2024-06-13 15:27:39:INFO:TRAIN-(cmcm) (2/9/5)>> loss: 0.8722
2024-06-13 15:27:42:INFO:VAL-(cmcm) >>
2024-06-13 15:27:42:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4577  Non0_acc_2: 0.5787  Non0_F1_score: 0.4291  Mult_acc_5: 0.2926  Mult_acc_7: 0.2271  MAE: 1.6791  Corr: 0.0590 
2024-06-13 15:27:57:INFO:TRAIN-(cmcm) (3/10/5)>> loss: 0.8705
2024-06-13 15:27:59:INFO:VAL-(cmcm) >>
2024-06-13 15:27:59:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5741  Non0_F1_score: 0.4187  Mult_acc_5: 0.2314  Mult_acc_7: 0.2009  MAE: 1.6331  Corr: 0.0159 
2024-06-13 15:28:14:INFO:TRAIN-(cmcm) (4/11/5)>> loss: 0.8595
2024-06-13 15:28:17:INFO:VAL-(cmcm) >>
2024-06-13 15:28:17:INFO:M: >>  Has0_acc_2: 0.5153  Has0_F1_score: 0.4721  Non0_acc_2: 0.5509  Non0_F1_score: 0.5107  Mult_acc_5: 0.1790  Mult_acc_7: 0.1747  MAE: 1.4995  Corr: 0.1491 
2024-06-13 15:28:32:INFO:TRAIN-(cmcm) (5/12/5)>> loss: 0.8485
2024-06-13 15:28:34:INFO:VAL-(cmcm) >>
2024-06-13 15:28:34:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.6046  Non0_acc_2: 0.6111  Non0_F1_score: 0.6065  Mult_acc_5: 0.3057  Mult_acc_7: 0.2402  MAE: 1.5664  Corr: 0.1768 
2024-06-13 15:28:49:INFO:TRAIN-(cmcm) (6/13/5)>> loss: 0.8533
2024-06-13 15:28:52:INFO:VAL-(cmcm) >>
2024-06-13 15:28:52:INFO:M: >>  Has0_acc_2: 0.6245  Has0_F1_score: 0.6238  Non0_acc_2: 0.6157  Non0_F1_score: 0.6142  Mult_acc_5: 0.3231  Mult_acc_7: 0.2533  MAE: 1.5686  Corr: 0.1712 
2024-06-13 15:29:07:INFO:TRAIN-(cmcm) (7/14/5)>> loss: 0.8438
2024-06-13 15:29:10:INFO:VAL-(cmcm) >>
2024-06-13 15:29:10:INFO:M: >>  Has0_acc_2: 0.6376  Has0_F1_score: 0.6297  Non0_acc_2: 0.6296  Non0_F1_score: 0.6262  Mult_acc_5: 0.2664  Mult_acc_7: 0.2445  MAE: 1.3318  Corr: 0.3424 
2024-06-13 15:29:10:INFO:Saving checkpoint at epoch 14 to results/models/cmcm-mosi-regression.pth.
2024-06-13 15:29:25:INFO:TRAIN-(cmcm) (1/15/5)>> loss: 0.8324
2024-06-13 15:29:28:INFO:VAL-(cmcm) >>
2024-06-13 15:29:28:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.6146  Non0_acc_2: 0.6250  Non0_F1_score: 0.6267  Mult_acc_5: 0.3057  Mult_acc_7: 0.2445  MAE: 1.4328  Corr: 0.3173 
2024-06-13 15:29:43:INFO:TRAIN-(cmcm) (2/16/5)>> loss: 0.8136
2024-06-13 15:29:46:INFO:VAL-(cmcm) >>
2024-06-13 15:29:46:INFO:M: >>  Has0_acc_2: 0.6550  Has0_F1_score: 0.6211  Non0_acc_2: 0.6343  Non0_F1_score: 0.6007  Mult_acc_5: 0.3100  Mult_acc_7: 0.2620  MAE: 1.3123  Corr: 0.3589 
2024-06-13 15:29:46:INFO:Saving checkpoint at epoch 16 to results/models/cmcm-mosi-regression.pth.
2024-06-13 15:30:01:INFO:TRAIN-(cmcm) (1/17/5)>> loss: 0.8141
2024-06-13 15:30:04:INFO:VAL-(cmcm) >>
2024-06-13 15:30:04:INFO:M: >>  Has0_acc_2: 0.6245  Has0_F1_score: 0.6262  Non0_acc_2: 0.6250  Non0_F1_score: 0.6253  Mult_acc_5: 0.2533  Mult_acc_7: 0.2227  MAE: 1.4039  Corr: 0.3230 
2024-06-13 15:30:19:INFO:TRAIN-(cmcm) (2/18/5)>> loss: 0.8002
2024-06-13 15:30:21:INFO:VAL-(cmcm) >>
2024-06-13 15:30:21:INFO:M: >>  Has0_acc_2: 0.6725  Has0_F1_score: 0.6722  Non0_acc_2: 0.6944  Non0_F1_score: 0.6923  Mult_acc_5: 0.3406  Mult_acc_7: 0.2751  MAE: 1.3258  Corr: 0.3847 
2024-06-13 15:30:36:INFO:TRAIN-(cmcm) (3/19/5)>> loss: 0.7932
2024-06-13 15:30:39:INFO:VAL-(cmcm) >>
2024-06-13 15:30:39:INFO:M: >>  Has0_acc_2: 0.6550  Has0_F1_score: 0.6559  Non0_acc_2: 0.6667  Non0_F1_score: 0.6675  Mult_acc_5: 0.3144  Mult_acc_7: 0.2664  MAE: 1.2446  Corr: 0.3759 
2024-06-13 15:30:39:INFO:Saving checkpoint at epoch 19 to results/models/cmcm-mosi-regression.pth.
2024-06-13 15:30:55:INFO:TRAIN-(cmcm) (1/20/5)>> loss: 0.7861
2024-06-13 15:30:57:INFO:VAL-(cmcm) >>
2024-06-13 15:30:57:INFO:M: >>  Has0_acc_2: 0.5546  Has0_F1_score: 0.5136  Non0_acc_2: 0.5185  Non0_F1_score: 0.4449  Mult_acc_5: 0.2314  Mult_acc_7: 0.2009  MAE: 1.5947  Corr: 0.2379 
2024-06-13 15:31:12:INFO:TRAIN-(cmcm) (2/21/5)>> loss: 0.7818
2024-06-13 15:31:15:INFO:VAL-(cmcm) >>
2024-06-13 15:31:15:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.5963  Non0_acc_2: 0.5880  Non0_F1_score: 0.5737  Mult_acc_5: 0.2707  Mult_acc_7: 0.2183  MAE: 1.3774  Corr: 0.3394 
2024-06-13 15:31:30:INFO:TRAIN-(cmcm) (3/22/5)>> loss: 0.7785
2024-06-13 15:31:32:INFO:VAL-(cmcm) >>
2024-06-13 15:31:32:INFO:M: >>  Has0_acc_2: 0.6725  Has0_F1_score: 0.6242  Non0_acc_2: 0.6389  Non0_F1_score: 0.6409  Mult_acc_5: 0.3406  Mult_acc_7: 0.2751  MAE: 1.2602  Corr: 0.3880 
2024-06-13 15:31:47:INFO:TRAIN-(cmcm) (4/23/5)>> loss: 0.7644
2024-06-13 15:31:50:INFO:VAL-(cmcm) >>
2024-06-13 15:31:50:INFO:M: >>  Has0_acc_2: 0.6638  Has0_F1_score: 0.6659  Non0_acc_2: 0.6991  Non0_F1_score: 0.7004  Mult_acc_5: 0.3537  Mult_acc_7: 0.2751  MAE: 1.3014  Corr: 0.4303 
2024-06-13 15:32:05:INFO:TRAIN-(cmcm) (5/24/5)>> loss: 0.7606
2024-06-13 15:32:07:INFO:VAL-(cmcm) >>
2024-06-13 15:32:07:INFO:M: >>  Has0_acc_2: 0.6812  Has0_F1_score: 0.6815  Non0_acc_2: 0.6944  Non0_F1_score: 0.6955  Mult_acc_5: 0.3581  Mult_acc_7: 0.2882  MAE: 1.2844  Corr: 0.4406 
2024-06-13 15:32:22:INFO:TRAIN-(cmcm) (6/25/5)>> loss: 0.7547
2024-06-13 15:32:25:INFO:VAL-(cmcm) >>
2024-06-13 15:32:25:INFO:M: >>  Has0_acc_2: 0.6900  Has0_F1_score: 0.6798  Non0_acc_2: 0.6852  Non0_F1_score: 0.6815  Mult_acc_5: 0.3624  Mult_acc_7: 0.3013  MAE: 1.1791  Corr: 0.4776 
2024-06-13 15:32:25:INFO:Saving checkpoint at epoch 25 to results/models/cmcm-mosi-regression.pth.
2024-06-13 15:32:41:INFO:TRAIN-(cmcm) (1/26/5)>> loss: 0.7642
2024-06-13 15:32:43:INFO:VAL-(cmcm) >>
2024-06-13 15:32:43:INFO:M: >>  Has0_acc_2: 0.6943  Has0_F1_score: 0.6957  Non0_acc_2: 0.6944  Non0_F1_score: 0.6961  Mult_acc_5: 0.3450  Mult_acc_7: 0.2707  MAE: 1.2114  Corr: 0.4729 
2024-06-13 15:32:58:INFO:TRAIN-(cmcm) (2/27/5)>> loss: 0.7398
2024-06-13 15:33:01:INFO:VAL-(cmcm) >>
2024-06-13 15:33:01:INFO:M: >>  Has0_acc_2: 0.7118  Has0_F1_score: 0.7123  Non0_acc_2: 0.7315  Non0_F1_score: 0.7301  Mult_acc_5: 0.3974  Mult_acc_7: 0.3188  MAE: 1.1650  Corr: 0.4934 
2024-06-13 15:33:01:INFO:Saving checkpoint at epoch 27 to results/models/cmcm-mosi-regression.pth.
2024-06-13 15:33:16:INFO:TRAIN-(cmcm) (1/28/5)>> loss: 0.7367
2024-06-13 15:33:19:INFO:VAL-(cmcm) >>
2024-06-13 15:33:19:INFO:M: >>  Has0_acc_2: 0.7162  Has0_F1_score: 0.7100  Non0_acc_2: 0.7083  Non0_F1_score: 0.7059  Mult_acc_5: 0.3799  Mult_acc_7: 0.3100  MAE: 1.2057  Corr: 0.4663 
2024-06-13 15:33:34:INFO:TRAIN-(cmcm) (2/29/5)>> loss: 0.7285
2024-06-13 15:33:36:INFO:VAL-(cmcm) >>
2024-06-13 15:33:36:INFO:M: >>  Has0_acc_2: 0.6943  Has0_F1_score: 0.6953  Non0_acc_2: 0.7546  Non0_F1_score: 0.7556  Mult_acc_5: 0.3668  Mult_acc_7: 0.3100  MAE: 1.1379  Corr: 0.5095 
2024-06-13 15:33:37:INFO:Saving checkpoint at epoch 29 to results/models/cmcm-mosi-regression.pth.
2024-06-13 15:33:52:INFO:TRAIN-(cmcm) (1/30/5)>> loss: 0.7319
2024-06-13 15:33:55:INFO:VAL-(cmcm) >>
2024-06-13 15:33:55:INFO:M: >>  Has0_acc_2: 0.7031  Has0_F1_score: 0.7059  Non0_acc_2: 0.7407  Non0_F1_score: 0.7421  Mult_acc_5: 0.3231  Mult_acc_7: 0.2620  MAE: 1.2095  Corr: 0.4855 
2024-06-13 15:34:10:INFO:TRAIN-(cmcm) (2/31/5)>> loss: 0.7301
2024-06-13 15:34:13:INFO:VAL-(cmcm) >>
2024-06-13 15:34:13:INFO:M: >>  Has0_acc_2: 0.6856  Has0_F1_score: 0.6487  Non0_acc_2: 0.6806  Non0_F1_score: 0.6554  Mult_acc_5: 0.3712  Mult_acc_7: 0.2969  MAE: 1.2573  Corr: 0.5141 
2024-06-13 15:34:28:INFO:TRAIN-(cmcm) (3/32/5)>> loss: 0.7196
2024-06-13 15:34:30:INFO:VAL-(cmcm) >>
2024-06-13 15:34:30:INFO:M: >>  Has0_acc_2: 0.6943  Has0_F1_score: 0.6938  Non0_acc_2: 0.7037  Non0_F1_score: 0.7033  Mult_acc_5: 0.3930  Mult_acc_7: 0.3144  MAE: 1.1909  Corr: 0.4721 
2024-06-13 15:34:45:INFO:TRAIN-(cmcm) (4/33/5)>> loss: 0.7116
2024-06-13 15:34:48:INFO:VAL-(cmcm) >>
2024-06-13 15:34:48:INFO:M: >>  Has0_acc_2: 0.6943  Has0_F1_score: 0.6971  Non0_acc_2: 0.7083  Non0_F1_score: 0.7096  Mult_acc_5: 0.3624  Mult_acc_7: 0.2969  MAE: 1.2244  Corr: 0.5004 
2024-06-13 15:35:03:INFO:TRAIN-(cmcm) (5/34/5)>> loss: 0.7074
2024-06-13 15:35:05:INFO:VAL-(cmcm) >>
2024-06-13 15:35:05:INFO:M: >>  Has0_acc_2: 0.7031  Has0_F1_score: 0.7054  Non0_acc_2: 0.7176  Non0_F1_score: 0.7184  Mult_acc_5: 0.3319  Mult_acc_7: 0.2795  MAE: 1.2309  Corr: 0.4772 
2024-06-13 15:35:20:INFO:TRAIN-(cmcm) (6/35/5)>> loss: 0.7046
2024-06-13 15:35:23:INFO:VAL-(cmcm) >>
2024-06-13 15:35:23:INFO:M: >>  Has0_acc_2: 0.7205  Has0_F1_score: 0.7232  Non0_acc_2: 0.7454  Non0_F1_score: 0.7467  Mult_acc_5: 0.3493  Mult_acc_7: 0.2882  MAE: 1.1324  Corr: 0.5265 
2024-06-13 15:35:23:INFO:Saving checkpoint at epoch 35 to results/models/cmcm-mosi-regression.pth.
2024-06-13 15:35:39:INFO:TRAIN-(cmcm) (1/36/5)>> loss: 0.6964
2024-06-13 15:35:41:INFO:VAL-(cmcm) >>
2024-06-13 15:35:41:INFO:M: >>  Has0_acc_2: 0.7118  Has0_F1_score: 0.7127  Non0_acc_2: 0.7407  Non0_F1_score: 0.7407  Mult_acc_5: 0.3930  Mult_acc_7: 0.3100  MAE: 1.1948  Corr: 0.5107 
2024-06-13 15:35:56:INFO:TRAIN-(cmcm) (2/37/5)>> loss: 0.6899
2024-06-13 15:35:59:INFO:VAL-(cmcm) >>
2024-06-13 15:35:59:INFO:M: >>  Has0_acc_2: 0.6725  Has0_F1_score: 0.6733  Non0_acc_2: 0.6898  Non0_F1_score: 0.6891  Mult_acc_5: 0.3450  Mult_acc_7: 0.2751  MAE: 1.2673  Corr: 0.4226 
2024-06-13 15:36:14:INFO:TRAIN-(cmcm) (3/38/5)>> loss: 0.6992
2024-06-13 15:36:16:INFO:VAL-(cmcm) >>
2024-06-13 15:36:16:INFO:M: >>  Has0_acc_2: 0.7249  Has0_F1_score: 0.7159  Non0_acc_2: 0.7037  Non0_F1_score: 0.7052  Mult_acc_5: 0.3493  Mult_acc_7: 0.2969  MAE: 1.1951  Corr: 0.4825 
2024-06-13 15:36:31:INFO:TRAIN-(cmcm) (4/39/5)>> loss: 0.6893
2024-06-13 15:36:34:INFO:VAL-(cmcm) >>
2024-06-13 15:36:34:INFO:M: >>  Has0_acc_2: 0.7162  Has0_F1_score: 0.7159  Non0_acc_2: 0.7407  Non0_F1_score: 0.7383  Mult_acc_5: 0.3799  Mult_acc_7: 0.3144  MAE: 1.1695  Corr: 0.5106 
2024-06-13 15:36:49:INFO:TRAIN-(cmcm) (5/40/5)>> loss: 0.6774
2024-06-13 15:36:51:INFO:VAL-(cmcm) >>
2024-06-13 15:36:51:INFO:M: >>  Has0_acc_2: 0.7205  Has0_F1_score: 0.7221  Non0_acc_2: 0.7361  Non0_F1_score: 0.7374  Mult_acc_5: 0.3712  Mult_acc_7: 0.3100  MAE: 1.1274  Corr: 0.5450 
2024-06-13 15:36:52:INFO:Saving checkpoint at epoch 40 to results/models/cmcm-mosi-regression.pth.
2024-06-13 15:37:07:INFO:TRAIN-(cmcm) (1/41/5)>> loss: 0.6714
2024-06-13 15:37:10:INFO:VAL-(cmcm) >>
2024-06-13 15:37:10:INFO:M: >>  Has0_acc_2: 0.7380  Has0_F1_score: 0.7380  Non0_acc_2: 0.7685  Non0_F1_score: 0.7669  Mult_acc_5: 0.3930  Mult_acc_7: 0.3144  MAE: 1.1416  Corr: 0.5399 
2024-06-13 15:37:25:INFO:TRAIN-(cmcm) (2/42/5)>> loss: 0.6746
2024-06-13 15:37:28:INFO:VAL-(cmcm) >>
2024-06-13 15:37:28:INFO:M: >>  Has0_acc_2: 0.6376  Has0_F1_score: 0.6381  Non0_acc_2: 0.6204  Non0_F1_score: 0.6118  Mult_acc_5: 0.3144  Mult_acc_7: 0.2795  MAE: 1.3017  Corr: 0.4155 
2024-06-13 15:37:43:INFO:TRAIN-(cmcm) (3/43/5)>> loss: 0.6695
2024-06-13 15:37:46:INFO:VAL-(cmcm) >>
2024-06-13 15:37:46:INFO:M: >>  Has0_acc_2: 0.6987  Has0_F1_score: 0.7016  Non0_acc_2: 0.6991  Non0_F1_score: 0.6996  Mult_acc_5: 0.3231  Mult_acc_7: 0.2620  MAE: 1.2464  Corr: 0.4652 
2024-06-13 15:38:01:INFO:TRAIN-(cmcm) (4/44/5)>> loss: 0.6710
2024-06-13 15:38:03:INFO:VAL-(cmcm) >>
2024-06-13 15:38:03:INFO:M: >>  Has0_acc_2: 0.7118  Has0_F1_score: 0.7131  Non0_acc_2: 0.7454  Non0_F1_score: 0.7463  Mult_acc_5: 0.3275  Mult_acc_7: 0.2751  MAE: 1.1870  Corr: 0.5031 
2024-06-13 15:38:18:INFO:TRAIN-(cmcm) (5/45/5)>> loss: 0.6653
2024-06-13 15:38:21:INFO:VAL-(cmcm) >>
2024-06-13 15:38:21:INFO:M: >>  Has0_acc_2: 0.7074  Has0_F1_score: 0.7101  Non0_acc_2: 0.6806  Non0_F1_score: 0.6780  Mult_acc_5: 0.3144  Mult_acc_7: 0.2489  MAE: 1.2139  Corr: 0.4853 
2024-06-13 15:38:36:INFO:TRAIN-(cmcm) (6/46/5)>> loss: 0.6707
2024-06-13 15:38:39:INFO:VAL-(cmcm) >>
2024-06-13 15:38:39:INFO:M: >>  Has0_acc_2: 0.7031  Has0_F1_score: 0.7040  Non0_acc_2: 0.7222  Non0_F1_score: 0.7229  Mult_acc_5: 0.3974  Mult_acc_7: 0.3231  MAE: 1.1782  Corr: 0.4936 
2024-06-13 15:38:54:INFO:TRAIN-(cmcm) (7/47/5)>> loss: 0.6519
2024-06-13 15:38:56:INFO:VAL-(cmcm) >>
2024-06-13 15:38:56:INFO:M: >>  Has0_acc_2: 0.7118  Has0_F1_score: 0.7144  Non0_acc_2: 0.7407  Non0_F1_score: 0.7420  Mult_acc_5: 0.3755  Mult_acc_7: 0.3231  MAE: 1.1638  Corr: 0.4913 
2024-06-13 15:39:11:INFO:TRAIN-(cmcm) (8/48/5)>> loss: 0.6453
2024-06-13 15:39:14:INFO:VAL-(cmcm) >>
2024-06-13 15:39:14:INFO:M: >>  Has0_acc_2: 0.7205  Has0_F1_score: 0.7218  Non0_acc_2: 0.7454  Non0_F1_score: 0.7452  Mult_acc_5: 0.3493  Mult_acc_7: 0.2838  MAE: 1.1485  Corr: 0.5291 
2024-06-13 15:39:29:INFO:TRAIN-(cmcm) (9/49/5)>> loss: 0.6477
2024-06-13 15:39:31:INFO:VAL-(cmcm) >>
2024-06-13 15:39:31:INFO:M: >>  Has0_acc_2: 0.6987  Has0_F1_score: 0.7010  Non0_acc_2: 0.6852  Non0_F1_score: 0.6816  Mult_acc_5: 0.3406  Mult_acc_7: 0.2620  MAE: 1.3044  Corr: 0.4605 
2024-06-13 15:39:46:INFO:TRAIN-(cmcm) (10/50/5)>> loss: 0.6421
2024-06-13 15:39:49:INFO:VAL-(cmcm) >>
2024-06-13 15:39:49:INFO:M: >>  Has0_acc_2: 0.7162  Has0_F1_score: 0.7176  Non0_acc_2: 0.7454  Non0_F1_score: 0.7452  Mult_acc_5: 0.4105  Mult_acc_7: 0.3362  MAE: 1.2014  Corr: 0.4873 
2024-06-13 15:39:57:INFO:TEST-(cmcm) >>
2024-06-13 15:39:57:INFO:M: >>  Has0_acc_2: 0.6676  Has0_F1_score: 0.6685  Non0_acc_2: 0.6875  Non0_F1_score: 0.6873  Mult_acc_5: 0.3324  Mult_acc_7: 0.2945  MAE: 1.2121  Corr: 0.4323 
2024-06-13 15:39:57:INFO:Results are added to results/results/mosi-regression-100.csv...
2024-06-13 16:07:33:INFO:Start running cmcm...
2024-06-13 16:07:33:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 6, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-06-13 16:07:33:INFO:Find gpu: 1, with memory: 378273792 left!
2024-06-13 16:07:33:INFO:Let's use the GPU 1 !
2024-06-13 16:07:33:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 16:07:33:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718266053 HTTP/1.1" 200 235
2024-06-13 16:07:33:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 16:07:34:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 16:07:35:INFO:train samples: (1284,)
2024-06-13 16:07:35:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 16:07:36:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718266056 HTTP/1.1" 200 235
2024-06-13 16:07:36:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 16:07:36:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 16:07:37:INFO:valid samples: (229,)
2024-06-13 16:07:37:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 16:07:38:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718266058 HTTP/1.1" 200 235
2024-06-13 16:07:38:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 16:07:38:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 16:07:39:INFO:test samples: (686,)
2024-06-13 16:07:39:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 16:07:39:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718266060 HTTP/1.1" 200 235
2024-06-13 16:07:40:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 16:07:40:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 16:07:41:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 16:07:41:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718266061 HTTP/1.1" 200 235
2024-06-13 16:07:41:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 16:07:41:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 16:07:42:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-13 16:07:42:WARNING:Try importing flash-attention for faster inference...
2024-06-13 16:07:42:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-13 16:07:42:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-13 16:07:42:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-13 16:07:44:INFO:trainable params: 1310288 || all params: 1838138960 || trainable%: 0.07128340286090232
2024-06-13 16:07:44:INFO:Init labels...
2024-06-13 16:07:44:INFO:Start training...
2024-06-13 16:08:00:INFO:TRAIN-(cmcm) (1/1/1)>> loss: 1.7960
2024-06-13 16:08:02:INFO:VAL-(cmcm) >>
2024-06-13 16:08:02:INFO:M: >>  Has0_acc_2: 0.5328  Has0_F1_score: 0.5365  Non0_acc_2: 0.5324  Non0_F1_score: 0.5342  Mult_acc_5: 0.2052  Mult_acc_7: 0.1921  MAE: 1.6044  Corr: 0.0622 
2024-06-13 16:08:04:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-13 16:08:19:INFO:TRAIN-(cmcm) (1/2/1)>> loss: 0.9116
2024-06-13 16:08:22:INFO:VAL-(cmcm) >>
2024-06-13 16:08:22:INFO:M: >>  Has0_acc_2: 0.4891  Has0_F1_score: 0.4575  Non0_acc_2: 0.5139  Non0_F1_score: 0.4789  Mult_acc_5: 0.2096  Mult_acc_7: 0.1834  MAE: 1.6541  Corr: 0.1191 
2024-06-13 16:08:37:INFO:TRAIN-(cmcm) (2/3/1)>> loss: 0.8807
2024-06-13 16:08:40:INFO:VAL-(cmcm) >>
2024-06-13 16:08:40:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.4880  Non0_acc_2: 0.5833  Non0_F1_score: 0.4610  Mult_acc_5: 0.1790  Mult_acc_7: 0.1790  MAE: 1.5087  Corr: 0.0428 
2024-06-13 16:08:41:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-mosi-regression.pth.
2024-06-13 16:08:56:INFO:TRAIN-(cmcm) (1/4/1)>> loss: 0.8745
2024-06-13 16:08:59:INFO:VAL-(cmcm) >>
2024-06-13 16:08:59:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5741  Non0_F1_score: 0.4187  Mult_acc_5: 0.2271  Mult_acc_7: 0.2009  MAE: 1.6123  Corr: 0.0645 
2024-06-13 16:09:14:INFO:TRAIN-(cmcm) (2/5/1)>> loss: 0.8676
2024-06-13 16:09:16:INFO:VAL-(cmcm) >>
2024-06-13 16:09:16:INFO:M: >>  Has0_acc_2: 0.5371  Has0_F1_score: 0.5343  Non0_acc_2: 0.5370  Non0_F1_score: 0.5316  Mult_acc_5: 0.1878  Mult_acc_7: 0.1834  MAE: 1.6436  Corr: -0.0081 
2024-06-13 16:09:31:INFO:TRAIN-(cmcm) (3/6/1)>> loss: 0.8652
2024-06-13 16:09:34:INFO:VAL-(cmcm) >>
2024-06-13 16:09:34:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.5109  Non0_acc_2: 0.5741  Non0_F1_score: 0.4851  Mult_acc_5: 0.2926  Mult_acc_7: 0.2052  MAE: 1.7451  Corr: 0.0461 
2024-06-13 16:09:49:INFO:TRAIN-(cmcm) (4/7/1)>> loss: 0.8589
2024-06-13 16:09:51:INFO:VAL-(cmcm) >>
2024-06-13 16:09:51:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.4880  Non0_acc_2: 0.5833  Non0_F1_score: 0.4610  Mult_acc_5: 0.3013  Mult_acc_7: 0.2183  MAE: 1.7616  Corr: 0.0465 
2024-06-13 16:10:06:INFO:TRAIN-(cmcm) (5/8/1)>> loss: 0.8594
2024-06-13 16:10:09:INFO:VAL-(cmcm) >>
2024-06-13 16:10:09:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.5251  Non0_acc_2: 0.5648  Non0_F1_score: 0.5097  Mult_acc_5: 0.1790  Mult_acc_7: 0.1747  MAE: 1.5191  Corr: 0.0247 
2024-06-13 16:10:24:INFO:TRAIN-(cmcm) (6/9/1)>> loss: 0.8561
2024-06-13 16:10:27:INFO:VAL-(cmcm) >>
2024-06-13 16:10:27:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.5002  Non0_acc_2: 0.5833  Non0_F1_score: 0.4739  Mult_acc_5: 0.3275  Mult_acc_7: 0.2445  MAE: 1.6953  Corr: 0.0550 
2024-06-13 16:10:42:INFO:TRAIN-(cmcm) (7/10/1)>> loss: 0.8532
2024-06-13 16:10:44:INFO:VAL-(cmcm) >>
2024-06-13 16:10:44:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4630  Non0_acc_2: 0.5741  Non0_F1_score: 0.4346  Mult_acc_5: 0.3057  Mult_acc_7: 0.2227  MAE: 1.7520  Corr: -0.0026 
2024-06-13 16:10:59:INFO:TRAIN-(cmcm) (8/11/1)>> loss: 0.8545
2024-06-13 16:11:02:INFO:VAL-(cmcm) >>
2024-06-13 16:11:02:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5399  Non0_acc_2: 0.5602  Non0_F1_score: 0.5256  Mult_acc_5: 0.2751  Mult_acc_7: 0.1921  MAE: 1.7900  Corr: 0.0135 
2024-06-13 16:11:17:INFO:TRAIN-(cmcm) (9/12/1)>> loss: 0.8457
2024-06-13 16:11:20:INFO:VAL-(cmcm) >>
2024-06-13 16:11:20:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4652  Non0_acc_2: 0.5741  Non0_F1_score: 0.4346  Mult_acc_5: 0.2402  Mult_acc_7: 0.1834  MAE: 1.5372  Corr: 0.0180 
2024-06-13 16:11:35:INFO:TRAIN-(cmcm) (10/13/1)>> loss: 0.8433
2024-06-13 16:11:37:INFO:VAL-(cmcm) >>
2024-06-13 16:11:37:INFO:M: >>  Has0_acc_2: 0.6157  Has0_F1_score: 0.5891  Non0_acc_2: 0.6111  Non0_F1_score: 0.5818  Mult_acc_5: 0.2838  Mult_acc_7: 0.2009  MAE: 1.6673  Corr: 0.1289 
2024-06-13 16:11:45:INFO:TEST-(cmcm) >>
2024-06-13 16:11:45:INFO:M: >>  Has0_acc_2: 0.4606  Has0_F1_score: 0.3208  Non0_acc_2: 0.4360  Non0_F1_score: 0.2966  Mult_acc_5: 0.1691  Mult_acc_7: 0.1691  MAE: 1.7944  Corr: 0.0684 
2024-06-13 16:11:46:INFO:Results are added to results/results/mosi-regression-30.csv...
2024-06-13 16:11:46:INFO:Start running cmcm...
2024-06-13 16:11:46:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 6, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 2222}>
2024-06-13 16:11:46:INFO:Let's use the GPU 1 !
2024-06-13 16:11:46:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 16:11:46:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718266306 HTTP/1.1" 200 235
2024-06-13 16:11:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 16:11:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 16:11:48:INFO:train samples: (1284,)
2024-06-13 16:11:48:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 16:11:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718266308 HTTP/1.1" 200 235
2024-06-13 16:11:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 16:11:49:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 16:11:49:INFO:valid samples: (229,)
2024-06-13 16:11:49:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 16:11:50:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718266310 HTTP/1.1" 200 235
2024-06-13 16:11:50:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 16:11:50:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 16:11:51:INFO:test samples: (686,)
2024-06-13 16:11:51:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 16:11:51:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718266311 HTTP/1.1" 200 235
2024-06-13 16:11:51:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 16:11:52:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 16:11:52:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 16:11:52:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718266313 HTTP/1.1" 200 235
2024-06-13 16:11:53:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 16:11:53:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 16:11:53:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-13 16:11:53:WARNING:Try importing flash-attention for faster inference...
2024-06-13 16:11:53:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-13 16:11:53:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-13 16:11:53:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-13 16:11:54:INFO:trainable params: 1310288 || all params: 1838138960 || trainable%: 0.07128340286090232
2024-06-13 16:11:54:INFO:Init labels...
2024-06-13 16:11:54:INFO:Start training...
2024-06-13 16:12:09:INFO:TRAIN-(cmcm) (1/1/2)>> loss: 2.0803
2024-06-13 16:12:12:INFO:VAL-(cmcm) >>
2024-06-13 16:12:12:INFO:M: >>  Has0_acc_2: 0.4323  Has0_F1_score: 0.3612  Non0_acc_2: 0.4537  Non0_F1_score: 0.3603  Mult_acc_5: 0.2227  Mult_acc_7: 0.2140  MAE: 1.5069  Corr: 0.1391 
2024-06-13 16:12:13:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-13 16:12:29:INFO:TRAIN-(cmcm) (1/2/2)>> loss: 0.9989
2024-06-13 16:12:31:INFO:VAL-(cmcm) >>
2024-06-13 16:12:31:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4630  Non0_acc_2: 0.5741  Non0_F1_score: 0.4346  Mult_acc_5: 0.2838  Mult_acc_7: 0.2183  MAE: 1.6833  Corr: 0.0075 
2024-06-13 16:12:46:INFO:TRAIN-(cmcm) (2/3/2)>> loss: 0.8889
2024-06-13 16:12:49:INFO:VAL-(cmcm) >>
2024-06-13 16:12:49:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5170  Non0_acc_2: 0.5602  Non0_F1_score: 0.4945  Mult_acc_5: 0.1878  Mult_acc_7: 0.1790  MAE: 1.5459  Corr: -0.0099 
2024-06-13 16:13:04:INFO:TRAIN-(cmcm) (3/4/2)>> loss: 0.8832
2024-06-13 16:13:06:INFO:VAL-(cmcm) >>
2024-06-13 16:13:06:INFO:M: >>  Has0_acc_2: 0.5459  Has0_F1_score: 0.5352  Non0_acc_2: 0.5417  Non0_F1_score: 0.5284  Mult_acc_5: 0.2489  Mult_acc_7: 0.1703  MAE: 1.8547  Corr: 0.0151 
2024-06-13 16:13:21:INFO:TRAIN-(cmcm) (4/5/2)>> loss: 0.8713
2024-06-13 16:13:24:INFO:VAL-(cmcm) >>
2024-06-13 16:13:24:INFO:M: >>  Has0_acc_2: 0.5022  Has0_F1_score: 0.4815  Non0_acc_2: 0.5139  Non0_F1_score: 0.4910  Mult_acc_5: 0.2402  Mult_acc_7: 0.1747  MAE: 1.9970  Corr: 0.0863 
2024-06-13 16:13:39:INFO:TRAIN-(cmcm) (5/6/2)>> loss: 0.8645
2024-06-13 16:13:42:INFO:VAL-(cmcm) >>
2024-06-13 16:13:42:INFO:M: >>  Has0_acc_2: 0.5415  Has0_F1_score: 0.5205  Non0_acc_2: 0.5278  Non0_F1_score: 0.5094  Mult_acc_5: 0.1790  Mult_acc_7: 0.1659  MAE: 1.5628  Corr: 0.0653 
2024-06-13 16:13:56:INFO:TRAIN-(cmcm) (6/7/2)>> loss: 0.8523
2024-06-13 16:13:59:INFO:VAL-(cmcm) >>
2024-06-13 16:13:59:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5611  Non0_acc_2: 0.5787  Non0_F1_score: 0.5613  Mult_acc_5: 0.2227  Mult_acc_7: 0.1965  MAE: 1.4903  Corr: 0.1636 
2024-06-13 16:14:00:INFO:Saving checkpoint at epoch 7 to results/models/cmcm-mosi-regression.pth.
2024-06-13 16:14:15:INFO:TRAIN-(cmcm) (1/8/2)>> loss: 0.8310
2024-06-13 16:14:18:INFO:VAL-(cmcm) >>
2024-06-13 16:14:18:INFO:M: >>  Has0_acc_2: 0.7293  Has0_F1_score: 0.7220  Non0_acc_2: 0.7361  Non0_F1_score: 0.7274  Mult_acc_5: 0.3843  Mult_acc_7: 0.2926  MAE: 1.2320  Corr: 0.4794 
2024-06-13 16:14:19:INFO:Saving checkpoint at epoch 8 to results/models/cmcm-mosi-regression.pth.
2024-06-13 16:14:34:INFO:TRAIN-(cmcm) (1/9/2)>> loss: 0.8296
2024-06-13 16:14:37:INFO:VAL-(cmcm) >>
2024-06-13 16:14:37:INFO:M: >>  Has0_acc_2: 0.6681  Has0_F1_score: 0.6604  Non0_acc_2: 0.6713  Non0_F1_score: 0.6618  Mult_acc_5: 0.3537  Mult_acc_7: 0.2576  MAE: 1.4276  Corr: 0.3518 
2024-06-13 16:14:52:INFO:TRAIN-(cmcm) (2/10/2)>> loss: 0.8437
2024-06-13 16:14:54:INFO:VAL-(cmcm) >>
2024-06-13 16:14:54:INFO:M: >>  Has0_acc_2: 0.7293  Has0_F1_score: 0.7301  Non0_acc_2: 0.7361  Non0_F1_score: 0.7363  Mult_acc_5: 0.3712  Mult_acc_7: 0.2576  MAE: 1.2455  Corr: 0.5076 
2024-06-13 16:15:09:INFO:TRAIN-(cmcm) (3/11/2)>> loss: 0.8112
2024-06-13 16:15:12:INFO:VAL-(cmcm) >>
2024-06-13 16:15:12:INFO:M: >>  Has0_acc_2: 0.6987  Has0_F1_score: 0.6732  Non0_acc_2: 0.7083  Non0_F1_score: 0.7099  Mult_acc_5: 0.3450  Mult_acc_7: 0.2751  MAE: 1.1733  Corr: 0.4810 
2024-06-13 16:15:12:INFO:Saving checkpoint at epoch 11 to results/models/cmcm-mosi-regression.pth.
2024-06-13 16:15:28:INFO:TRAIN-(cmcm) (1/12/2)>> loss: 0.7871
2024-06-13 16:15:30:INFO:VAL-(cmcm) >>
2024-06-13 16:15:30:INFO:M: >>  Has0_acc_2: 0.7380  Has0_F1_score: 0.7327  Non0_acc_2: 0.7407  Non0_F1_score: 0.7346  Mult_acc_5: 0.3799  Mult_acc_7: 0.2882  MAE: 1.1630  Corr: 0.5105 
2024-06-13 16:15:31:INFO:Saving checkpoint at epoch 12 to results/models/cmcm-mosi-regression.pth.
2024-06-13 16:15:47:INFO:TRAIN-(cmcm) (1/13/2)>> loss: 0.7781
2024-06-13 16:15:49:INFO:VAL-(cmcm) >>
2024-06-13 16:15:49:INFO:M: >>  Has0_acc_2: 0.6856  Has0_F1_score: 0.6859  Non0_acc_2: 0.7130  Non0_F1_score: 0.7125  Mult_acc_5: 0.3493  Mult_acc_7: 0.2664  MAE: 1.1992  Corr: 0.5202 
2024-06-13 16:16:04:INFO:TRAIN-(cmcm) (2/14/2)>> loss: 0.7649
2024-06-13 16:16:07:INFO:VAL-(cmcm) >>
2024-06-13 16:16:07:INFO:M: >>  Has0_acc_2: 0.7118  Has0_F1_score: 0.7093  Non0_acc_2: 0.7176  Non0_F1_score: 0.7146  Mult_acc_5: 0.3974  Mult_acc_7: 0.3013  MAE: 1.1913  Corr: 0.4847 
2024-06-13 16:16:22:INFO:TRAIN-(cmcm) (3/15/2)>> loss: 0.7614
2024-06-13 16:16:24:INFO:VAL-(cmcm) >>
2024-06-13 16:16:24:INFO:M: >>  Has0_acc_2: 0.7511  Has0_F1_score: 0.7524  Non0_acc_2: 0.7639  Non0_F1_score: 0.7651  Mult_acc_5: 0.3930  Mult_acc_7: 0.2926  MAE: 1.1424  Corr: 0.5462 
2024-06-13 16:16:25:INFO:Saving checkpoint at epoch 15 to results/models/cmcm-mosi-regression.pth.
2024-06-13 16:16:40:INFO:TRAIN-(cmcm) (1/16/2)>> loss: 0.7498
2024-06-13 16:16:43:INFO:VAL-(cmcm) >>
2024-06-13 16:16:43:INFO:M: >>  Has0_acc_2: 0.7162  Has0_F1_score: 0.7189  Non0_acc_2: 0.6991  Non0_F1_score: 0.6945  Mult_acc_5: 0.3319  Mult_acc_7: 0.2751  MAE: 1.1485  Corr: 0.5215 
2024-06-13 16:16:58:INFO:TRAIN-(cmcm) (2/17/2)>> loss: 0.7408
2024-06-13 16:17:01:INFO:VAL-(cmcm) >>
2024-06-13 16:17:01:INFO:M: >>  Has0_acc_2: 0.6900  Has0_F1_score: 0.6917  Non0_acc_2: 0.6806  Non0_F1_score: 0.6793  Mult_acc_5: 0.3188  Mult_acc_7: 0.2576  MAE: 1.2385  Corr: 0.5072 
2024-06-13 16:17:16:INFO:TRAIN-(cmcm) (3/18/2)>> loss: 0.7243
2024-06-13 16:17:18:INFO:VAL-(cmcm) >>
2024-06-13 16:17:18:INFO:M: >>  Has0_acc_2: 0.7205  Has0_F1_score: 0.7174  Non0_acc_2: 0.6944  Non0_F1_score: 0.6959  Mult_acc_5: 0.3450  Mult_acc_7: 0.2838  MAE: 1.1830  Corr: 0.4878 
2024-06-13 16:17:33:INFO:TRAIN-(cmcm) (4/19/2)>> loss: 0.7134
2024-06-13 16:17:36:INFO:VAL-(cmcm) >>
2024-06-13 16:17:36:INFO:M: >>  Has0_acc_2: 0.7467  Has0_F1_score: 0.7472  Non0_acc_2: 0.7593  Non0_F1_score: 0.7585  Mult_acc_5: 0.3712  Mult_acc_7: 0.2969  MAE: 1.1119  Corr: 0.5490 
2024-06-13 16:17:36:INFO:Saving checkpoint at epoch 19 to results/models/cmcm-mosi-regression.pth.
2024-06-13 16:17:52:INFO:TRAIN-(cmcm) (1/20/2)>> loss: 0.7044
2024-06-13 16:17:54:INFO:VAL-(cmcm) >>
2024-06-13 16:17:54:INFO:M: >>  Has0_acc_2: 0.6987  Has0_F1_score: 0.6972  Non0_acc_2: 0.7130  Non0_F1_score: 0.7103  Mult_acc_5: 0.3843  Mult_acc_7: 0.3144  MAE: 1.1883  Corr: 0.4823 
2024-06-13 16:18:10:INFO:TRAIN-(cmcm) (2/21/2)>> loss: 0.6948
2024-06-13 16:18:12:INFO:VAL-(cmcm) >>
2024-06-13 16:18:12:INFO:M: >>  Has0_acc_2: 0.6987  Has0_F1_score: 0.6820  Non0_acc_2: 0.7083  Non0_F1_score: 0.7037  Mult_acc_5: 0.4148  Mult_acc_7: 0.3275  MAE: 1.1612  Corr: 0.4812 
2024-06-13 16:18:27:INFO:TRAIN-(cmcm) (3/22/2)>> loss: 0.6749
2024-06-13 16:18:30:INFO:VAL-(cmcm) >>
2024-06-13 16:18:30:INFO:M: >>  Has0_acc_2: 0.7249  Has0_F1_score: 0.7241  Non0_acc_2: 0.7361  Non0_F1_score: 0.7350  Mult_acc_5: 0.3930  Mult_acc_7: 0.3144  MAE: 1.1638  Corr: 0.5240 
2024-06-13 16:18:45:INFO:TRAIN-(cmcm) (4/23/2)>> loss: 0.6656
2024-06-13 16:18:47:INFO:VAL-(cmcm) >>
2024-06-13 16:18:47:INFO:M: >>  Has0_acc_2: 0.7336  Has0_F1_score: 0.7329  Non0_acc_2: 0.7269  Non0_F1_score: 0.7282  Mult_acc_5: 0.4061  Mult_acc_7: 0.3362  MAE: 1.1346  Corr: 0.5138 
2024-06-13 16:19:02:INFO:TRAIN-(cmcm) (5/24/2)>> loss: 0.6507
2024-06-13 16:19:05:INFO:VAL-(cmcm) >>
2024-06-13 16:19:05:INFO:M: >>  Has0_acc_2: 0.7074  Has0_F1_score: 0.7103  Non0_acc_2: 0.7037  Non0_F1_score: 0.7047  Mult_acc_5: 0.4061  Mult_acc_7: 0.3450  MAE: 1.1721  Corr: 0.5037 
2024-06-13 16:19:20:INFO:TRAIN-(cmcm) (6/25/2)>> loss: 0.6375
2024-06-13 16:19:22:INFO:VAL-(cmcm) >>
2024-06-13 16:19:22:INFO:M: >>  Has0_acc_2: 0.7118  Has0_F1_score: 0.7050  Non0_acc_2: 0.7361  Non0_F1_score: 0.7327  Mult_acc_5: 0.4279  Mult_acc_7: 0.3581  MAE: 1.1433  Corr: 0.5265 
2024-06-13 16:19:38:INFO:TRAIN-(cmcm) (7/26/2)>> loss: 0.6214
2024-06-13 16:19:40:INFO:VAL-(cmcm) >>
2024-06-13 16:19:40:INFO:M: >>  Has0_acc_2: 0.7293  Has0_F1_score: 0.7301  Non0_acc_2: 0.7407  Non0_F1_score: 0.7420  Mult_acc_5: 0.3974  Mult_acc_7: 0.3362  MAE: 1.0966  Corr: 0.5332 
2024-06-13 16:19:41:INFO:Saving checkpoint at epoch 26 to results/models/cmcm-mosi-regression.pth.
2024-06-13 16:19:56:INFO:TRAIN-(cmcm) (1/27/2)>> loss: 0.6092
2024-06-13 16:19:59:INFO:VAL-(cmcm) >>
2024-06-13 16:19:59:INFO:M: >>  Has0_acc_2: 0.7162  Has0_F1_score: 0.7173  Non0_acc_2: 0.7361  Non0_F1_score: 0.7366  Mult_acc_5: 0.3974  Mult_acc_7: 0.3231  MAE: 1.1590  Corr: 0.5119 
2024-06-13 16:20:14:INFO:TRAIN-(cmcm) (2/28/2)>> loss: 0.5942
2024-06-13 16:20:17:INFO:VAL-(cmcm) >>
2024-06-13 16:20:17:INFO:M: >>  Has0_acc_2: 0.7336  Has0_F1_score: 0.7323  Non0_acc_2: 0.7269  Non0_F1_score: 0.7274  Mult_acc_5: 0.3930  Mult_acc_7: 0.3275  MAE: 1.1119  Corr: 0.5367 
2024-06-13 16:20:32:INFO:TRAIN-(cmcm) (3/29/2)>> loss: 0.5876
2024-06-13 16:20:34:INFO:VAL-(cmcm) >>
2024-06-13 16:20:34:INFO:M: >>  Has0_acc_2: 0.7162  Has0_F1_score: 0.7153  Non0_acc_2: 0.7176  Non0_F1_score: 0.7181  Mult_acc_5: 0.3930  Mult_acc_7: 0.3275  MAE: 1.1328  Corr: 0.5223 
2024-06-13 16:20:50:INFO:TRAIN-(cmcm) (4/30/2)>> loss: 0.5836
2024-06-13 16:20:52:INFO:VAL-(cmcm) >>
2024-06-13 16:20:52:INFO:M: >>  Has0_acc_2: 0.7293  Has0_F1_score: 0.7276  Non0_acc_2: 0.7222  Non0_F1_score: 0.7222  Mult_acc_5: 0.3886  Mult_acc_7: 0.3231  MAE: 1.1223  Corr: 0.5305 
2024-06-13 16:21:08:INFO:TRAIN-(cmcm) (5/31/2)>> loss: 0.5837
2024-06-13 16:21:10:INFO:VAL-(cmcm) >>
2024-06-13 16:21:10:INFO:M: >>  Has0_acc_2: 0.7249  Has0_F1_score: 0.7235  Non0_acc_2: 0.7222  Non0_F1_score: 0.7222  Mult_acc_5: 0.3930  Mult_acc_7: 0.3275  MAE: 1.1206  Corr: 0.5315 
2024-06-13 16:21:25:INFO:TRAIN-(cmcm) (6/32/2)>> loss: 0.5838
2024-06-13 16:21:28:INFO:VAL-(cmcm) >>
2024-06-13 16:21:28:INFO:M: >>  Has0_acc_2: 0.7249  Has0_F1_score: 0.7229  Non0_acc_2: 0.7176  Non0_F1_score: 0.7178  Mult_acc_5: 0.3930  Mult_acc_7: 0.3275  MAE: 1.1197  Corr: 0.5268 
2024-06-13 16:21:43:INFO:TRAIN-(cmcm) (7/33/2)>> loss: 0.5876
2024-06-13 16:21:45:INFO:VAL-(cmcm) >>
2024-06-13 16:21:45:INFO:M: >>  Has0_acc_2: 0.7336  Has0_F1_score: 0.7310  Non0_acc_2: 0.7222  Non0_F1_score: 0.7208  Mult_acc_5: 0.4148  Mult_acc_7: 0.3362  MAE: 1.1271  Corr: 0.5271 
2024-06-13 16:22:00:INFO:TRAIN-(cmcm) (8/34/2)>> loss: 0.5915
2024-06-13 16:22:03:INFO:VAL-(cmcm) >>
2024-06-13 16:22:03:INFO:M: >>  Has0_acc_2: 0.7074  Has0_F1_score: 0.7096  Non0_acc_2: 0.7361  Non0_F1_score: 0.7375  Mult_acc_5: 0.3624  Mult_acc_7: 0.3013  MAE: 1.1507  Corr: 0.5182 
2024-06-13 16:22:18:INFO:TRAIN-(cmcm) (9/35/2)>> loss: 0.6041
2024-06-13 16:22:20:INFO:VAL-(cmcm) >>
2024-06-13 16:22:20:INFO:M: >>  Has0_acc_2: 0.7205  Has0_F1_score: 0.7194  Non0_acc_2: 0.7361  Non0_F1_score: 0.7355  Mult_acc_5: 0.3886  Mult_acc_7: 0.3144  MAE: 1.1656  Corr: 0.5271 
2024-06-13 16:22:35:INFO:TRAIN-(cmcm) (10/36/2)>> loss: 0.6232
2024-06-13 16:22:38:INFO:VAL-(cmcm) >>
2024-06-13 16:22:38:INFO:M: >>  Has0_acc_2: 0.7205  Has0_F1_score: 0.7214  Non0_acc_2: 0.7269  Non0_F1_score: 0.7270  Mult_acc_5: 0.4410  Mult_acc_7: 0.3755  MAE: 1.0778  Corr: 0.5549 
2024-06-13 16:22:39:INFO:Saving checkpoint at epoch 36 to results/models/cmcm-mosi-regression.pth.
2024-06-13 16:22:54:INFO:TRAIN-(cmcm) (1/37/2)>> loss: 0.6286
2024-06-13 16:22:57:INFO:VAL-(cmcm) >>
2024-06-13 16:22:57:INFO:M: >>  Has0_acc_2: 0.7074  Has0_F1_score: 0.7053  Non0_acc_2: 0.7176  Non0_F1_score: 0.7159  Mult_acc_5: 0.3843  Mult_acc_7: 0.3057  MAE: 1.2149  Corr: 0.4846 
2024-06-13 16:23:12:INFO:TRAIN-(cmcm) (2/38/2)>> loss: 0.6416
2024-06-13 16:23:14:INFO:VAL-(cmcm) >>
2024-06-13 16:23:14:INFO:M: >>  Has0_acc_2: 0.6987  Has0_F1_score: 0.6949  Non0_acc_2: 0.6991  Non0_F1_score: 0.6959  Mult_acc_5: 0.3799  Mult_acc_7: 0.3057  MAE: 1.1935  Corr: 0.4883 
2024-06-13 16:23:29:INFO:TRAIN-(cmcm) (3/39/2)>> loss: 0.6663
2024-06-13 16:23:32:INFO:VAL-(cmcm) >>
2024-06-13 16:23:32:INFO:M: >>  Has0_acc_2: 0.7293  Has0_F1_score: 0.7105  Non0_acc_2: 0.7361  Non0_F1_score: 0.7303  Mult_acc_5: 0.4061  Mult_acc_7: 0.3319  MAE: 1.1445  Corr: 0.5134 
2024-06-13 16:23:47:INFO:TRAIN-(cmcm) (4/40/2)>> loss: 0.6682
2024-06-13 16:23:49:INFO:VAL-(cmcm) >>
2024-06-13 16:23:49:INFO:M: >>  Has0_acc_2: 0.7074  Has0_F1_score: 0.7020  Non0_acc_2: 0.7083  Non0_F1_score: 0.7071  Mult_acc_5: 0.3712  Mult_acc_7: 0.2926  MAE: 1.1708  Corr: 0.4778 
2024-06-13 16:24:04:INFO:TRAIN-(cmcm) (5/41/2)>> loss: 0.6767
2024-06-13 16:24:07:INFO:VAL-(cmcm) >>
2024-06-13 16:24:07:INFO:M: >>  Has0_acc_2: 0.7074  Has0_F1_score: 0.7082  Non0_acc_2: 0.7176  Non0_F1_score: 0.7174  Mult_acc_5: 0.3668  Mult_acc_7: 0.3057  MAE: 1.2005  Corr: 0.4794 
2024-06-13 16:24:22:INFO:TRAIN-(cmcm) (6/42/2)>> loss: 0.6683
2024-06-13 16:24:24:INFO:VAL-(cmcm) >>
2024-06-13 16:24:24:INFO:M: >>  Has0_acc_2: 0.6987  Has0_F1_score: 0.7013  Non0_acc_2: 0.7083  Non0_F1_score: 0.7096  Mult_acc_5: 0.4105  Mult_acc_7: 0.3450  MAE: 1.1874  Corr: 0.4795 
2024-06-13 16:24:39:INFO:TRAIN-(cmcm) (7/43/2)>> loss: 0.6715
2024-06-13 16:24:42:INFO:VAL-(cmcm) >>
2024-06-13 16:24:42:INFO:M: >>  Has0_acc_2: 0.6856  Has0_F1_score: 0.6856  Non0_acc_2: 0.6759  Non0_F1_score: 0.6764  Mult_acc_5: 0.3930  Mult_acc_7: 0.3275  MAE: 1.2424  Corr: 0.4127 
2024-06-13 16:24:57:INFO:TRAIN-(cmcm) (8/44/2)>> loss: 0.6790
2024-06-13 16:24:59:INFO:VAL-(cmcm) >>
2024-06-13 16:24:59:INFO:M: >>  Has0_acc_2: 0.7205  Has0_F1_score: 0.7012  Non0_acc_2: 0.7500  Non0_F1_score: 0.7464  Mult_acc_5: 0.4105  Mult_acc_7: 0.3231  MAE: 1.1210  Corr: 0.5252 
2024-06-13 16:25:14:INFO:TRAIN-(cmcm) (9/45/2)>> loss: 0.6986
2024-06-13 16:25:17:INFO:VAL-(cmcm) >>
2024-06-13 16:25:17:INFO:M: >>  Has0_acc_2: 0.7336  Has0_F1_score: 0.7350  Non0_acc_2: 0.7407  Non0_F1_score: 0.7418  Mult_acc_5: 0.4017  Mult_acc_7: 0.3275  MAE: 1.1197  Corr: 0.5436 
2024-06-13 16:25:32:INFO:TRAIN-(cmcm) (10/46/2)>> loss: 0.6912
2024-06-13 16:25:34:INFO:VAL-(cmcm) >>
2024-06-13 16:25:34:INFO:M: >>  Has0_acc_2: 0.6769  Has0_F1_score: 0.6783  Non0_acc_2: 0.6898  Non0_F1_score: 0.6904  Mult_acc_5: 0.3930  Mult_acc_7: 0.3144  MAE: 1.2161  Corr: 0.4709 
2024-06-13 16:25:42:INFO:TEST-(cmcm) >>
2024-06-13 16:25:42:INFO:M: >>  Has0_acc_2: 0.7187  Has0_F1_score: 0.7193  Non0_acc_2: 0.7424  Non0_F1_score: 0.7435  Mult_acc_5: 0.3484  Mult_acc_7: 0.3090  MAE: 1.0910  Corr: 0.5399 
2024-06-13 16:25:42:INFO:Results are added to results/results/mosi-regression-30.csv...
2024-06-13 16:25:42:INFO:Start running cmcm...
2024-06-13 16:25:42:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 6, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 3333}>
2024-06-13 16:25:42:INFO:Let's use the GPU 1 !
2024-06-13 16:25:42:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 16:25:43:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718267143 HTTP/1.1" 200 235
2024-06-13 16:25:43:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 16:25:43:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 16:25:44:INFO:train samples: (1284,)
2024-06-13 16:25:44:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 16:25:44:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718267144 HTTP/1.1" 200 235
2024-06-13 16:25:45:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 16:25:45:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 16:25:45:INFO:valid samples: (229,)
2024-06-13 16:25:46:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 16:25:46:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718267146 HTTP/1.1" 200 235
2024-06-13 16:25:46:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 16:25:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 16:25:47:INFO:test samples: (686,)
2024-06-13 16:25:47:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 16:25:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718267148 HTTP/1.1" 200 235
2024-06-13 16:25:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 16:25:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 16:25:49:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 16:25:49:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718267149 HTTP/1.1" 200 235
2024-06-13 16:25:49:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 16:25:50:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 16:25:50:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-13 16:25:50:WARNING:Try importing flash-attention for faster inference...
2024-06-13 16:25:50:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-13 16:25:50:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-13 16:25:50:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-13 16:25:51:INFO:trainable params: 1310288 || all params: 1838138960 || trainable%: 0.07128340286090232
2024-06-13 16:25:51:INFO:Init labels...
2024-06-13 16:25:51:INFO:Start training...
2024-06-13 16:26:06:INFO:TRAIN-(cmcm) (1/1/3)>> loss: 2.1029
2024-06-13 16:26:09:INFO:VAL-(cmcm) >>
2024-06-13 16:26:09:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.4864  Non0_acc_2: 0.5509  Non0_F1_score: 0.4839  Mult_acc_5: 0.2751  Mult_acc_7: 0.2009  MAE: 1.7018  Corr: -0.0161 
2024-06-13 16:26:10:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-13 16:26:25:INFO:TRAIN-(cmcm) (1/2/3)>> loss: 0.9402
2024-06-13 16:26:28:INFO:VAL-(cmcm) >>
2024-06-13 16:26:28:INFO:M: >>  Has0_acc_2: 0.4891  Has0_F1_score: 0.4373  Non0_acc_2: 0.5185  Non0_F1_score: 0.4707  Mult_acc_5: 0.2009  Mult_acc_7: 0.1703  MAE: 1.6817  Corr: 0.1321 
2024-06-13 16:26:28:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-13 16:26:44:INFO:TRAIN-(cmcm) (1/3/3)>> loss: 0.8993
2024-06-13 16:26:46:INFO:VAL-(cmcm) >>
2024-06-13 16:26:46:INFO:M: >>  Has0_acc_2: 0.5066  Has0_F1_score: 0.5106  Non0_acc_2: 0.5185  Non0_F1_score: 0.5208  Mult_acc_5: 0.2271  Mult_acc_7: 0.1659  MAE: 1.8228  Corr: 0.0327 
2024-06-13 16:27:01:INFO:TRAIN-(cmcm) (2/4/3)>> loss: 0.8764
2024-06-13 16:27:04:INFO:VAL-(cmcm) >>
2024-06-13 16:27:04:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.5470  Non0_acc_2: 0.5833  Non0_F1_score: 0.5608  Mult_acc_5: 0.2140  Mult_acc_7: 0.1878  MAE: 1.6167  Corr: 0.2354 
2024-06-13 16:27:05:INFO:Saving checkpoint at epoch 4 to results/models/cmcm-mosi-regression.pth.
2024-06-13 16:27:20:INFO:TRAIN-(cmcm) (1/5/3)>> loss: 0.8686
2024-06-13 16:27:23:INFO:VAL-(cmcm) >>
2024-06-13 16:27:23:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.4705  Non0_acc_2: 0.5509  Non0_F1_score: 0.4425  Mult_acc_5: 0.2926  Mult_acc_7: 0.2271  MAE: 1.7110  Corr: 0.0190 
2024-06-13 16:27:38:INFO:TRAIN-(cmcm) (2/6/3)>> loss: 0.8604
2024-06-13 16:27:41:INFO:VAL-(cmcm) >>
2024-06-13 16:27:41:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.5699  Non0_acc_2: 0.5741  Non0_F1_score: 0.5575  Mult_acc_5: 0.2969  Mult_acc_7: 0.2183  MAE: 1.7612  Corr: 0.1030 
2024-06-13 16:27:56:INFO:TRAIN-(cmcm) (3/7/3)>> loss: 0.8580
2024-06-13 16:27:58:INFO:VAL-(cmcm) >>
2024-06-13 16:27:58:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.5800  Non0_acc_2: 0.5787  Non0_F1_score: 0.5720  Mult_acc_5: 0.2533  Mult_acc_7: 0.1965  MAE: 1.5759  Corr: 0.1344 
2024-06-13 16:27:59:INFO:Saving checkpoint at epoch 7 to results/models/cmcm-mosi-regression.pth.
2024-06-13 16:28:14:INFO:TRAIN-(cmcm) (1/8/3)>> loss: 0.8533
2024-06-13 16:28:17:INFO:VAL-(cmcm) >>
2024-06-13 16:28:17:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.5032  Non0_acc_2: 0.5741  Non0_F1_score: 0.4742  Mult_acc_5: 0.2707  Mult_acc_7: 0.1965  MAE: 1.5320  Corr: 0.1540 
2024-06-13 16:28:18:INFO:Saving checkpoint at epoch 8 to results/models/cmcm-mosi-regression.pth.
2024-06-13 16:28:33:INFO:TRAIN-(cmcm) (1/9/3)>> loss: 0.8379
2024-06-13 16:28:36:INFO:VAL-(cmcm) >>
2024-06-13 16:28:36:INFO:M: >>  Has0_acc_2: 0.6376  Has0_F1_score: 0.5653  Non0_acc_2: 0.6157  Non0_F1_score: 0.5423  Mult_acc_5: 0.3362  Mult_acc_7: 0.2533  MAE: 1.6350  Corr: 0.1932 
2024-06-13 16:28:51:INFO:TRAIN-(cmcm) (2/10/3)>> loss: 0.8322
2024-06-13 16:28:53:INFO:VAL-(cmcm) >>
2024-06-13 16:28:53:INFO:M: >>  Has0_acc_2: 0.6245  Has0_F1_score: 0.5708  Non0_acc_2: 0.6111  Non0_F1_score: 0.5549  Mult_acc_5: 0.3362  Mult_acc_7: 0.2533  MAE: 1.5424  Corr: 0.2015 
2024-06-13 16:29:08:INFO:TRAIN-(cmcm) (3/11/3)>> loss: 0.8348
2024-06-13 16:29:11:INFO:VAL-(cmcm) >>
2024-06-13 16:29:11:INFO:M: >>  Has0_acc_2: 0.6681  Has0_F1_score: 0.6566  Non0_acc_2: 0.6620  Non0_F1_score: 0.6535  Mult_acc_5: 0.3319  Mult_acc_7: 0.2489  MAE: 1.3887  Corr: 0.3174 
2024-06-13 16:29:12:INFO:Saving checkpoint at epoch 11 to results/models/cmcm-mosi-regression.pth.
2024-06-13 16:29:27:INFO:TRAIN-(cmcm) (1/12/3)>> loss: 0.8113
2024-06-13 16:29:30:INFO:VAL-(cmcm) >>
2024-06-13 16:29:30:INFO:M: >>  Has0_acc_2: 0.6987  Has0_F1_score: 0.7000  Non0_acc_2: 0.6898  Non0_F1_score: 0.6874  Mult_acc_5: 0.3493  Mult_acc_7: 0.3013  MAE: 1.1599  Corr: 0.4814 
2024-06-13 16:29:31:INFO:Saving checkpoint at epoch 12 to results/models/cmcm-mosi-regression.pth.
2024-06-13 16:29:46:INFO:TRAIN-(cmcm) (1/13/3)>> loss: 0.8010
2024-06-13 16:29:49:INFO:VAL-(cmcm) >>
2024-06-13 16:29:49:INFO:M: >>  Has0_acc_2: 0.6725  Has0_F1_score: 0.6543  Non0_acc_2: 0.6713  Non0_F1_score: 0.6513  Mult_acc_5: 0.2969  Mult_acc_7: 0.2576  MAE: 1.2410  Corr: 0.4238 
2024-06-13 16:30:04:INFO:TRAIN-(cmcm) (2/14/3)>> loss: 0.7923
2024-06-13 16:30:06:INFO:VAL-(cmcm) >>
2024-06-13 16:30:06:INFO:M: >>  Has0_acc_2: 0.6943  Has0_F1_score: 0.6970  Non0_acc_2: 0.7130  Non0_F1_score: 0.7143  Mult_acc_5: 0.3231  Mult_acc_7: 0.2620  MAE: 1.2171  Corr: 0.5000 
2024-06-13 16:30:21:INFO:TRAIN-(cmcm) (3/15/3)>> loss: 0.7737
2024-06-13 16:30:24:INFO:VAL-(cmcm) >>
2024-06-13 16:30:24:INFO:M: >>  Has0_acc_2: 0.7424  Has0_F1_score: 0.7421  Non0_acc_2: 0.7731  Non0_F1_score: 0.7738  Mult_acc_5: 0.3624  Mult_acc_7: 0.2795  MAE: 1.1254  Corr: 0.5526 
2024-06-13 16:30:25:INFO:Saving checkpoint at epoch 15 to results/models/cmcm-mosi-regression.pth.
2024-06-13 16:30:40:INFO:TRAIN-(cmcm) (1/16/3)>> loss: 0.7695
2024-06-13 16:30:43:INFO:VAL-(cmcm) >>
2024-06-13 16:30:43:INFO:M: >>  Has0_acc_2: 0.6594  Has0_F1_score: 0.6138  Non0_acc_2: 0.6481  Non0_F1_score: 0.6005  Mult_acc_5: 0.3624  Mult_acc_7: 0.2795  MAE: 1.4106  Corr: 0.4024 
2024-06-13 16:30:58:INFO:TRAIN-(cmcm) (2/17/3)>> loss: 0.7679
2024-06-13 16:31:01:INFO:VAL-(cmcm) >>
2024-06-13 16:31:01:INFO:M: >>  Has0_acc_2: 0.6856  Has0_F1_score: 0.6863  Non0_acc_2: 0.7130  Non0_F1_score: 0.7130  Mult_acc_5: 0.3013  Mult_acc_7: 0.2358  MAE: 1.1778  Corr: 0.5158 
2024-06-13 16:31:16:INFO:TRAIN-(cmcm) (3/18/3)>> loss: 0.7428
2024-06-13 16:31:18:INFO:VAL-(cmcm) >>
2024-06-13 16:31:18:INFO:M: >>  Has0_acc_2: 0.6987  Has0_F1_score: 0.6820  Non0_acc_2: 0.7130  Non0_F1_score: 0.6947  Mult_acc_5: 0.3974  Mult_acc_7: 0.3144  MAE: 1.1398  Corr: 0.5337 
2024-06-13 16:31:33:INFO:TRAIN-(cmcm) (4/19/3)>> loss: 0.7276
2024-06-13 16:31:36:INFO:VAL-(cmcm) >>
2024-06-13 16:31:36:INFO:M: >>  Has0_acc_2: 0.7031  Has0_F1_score: 0.6998  Non0_acc_2: 0.6759  Non0_F1_score: 0.6770  Mult_acc_5: 0.3712  Mult_acc_7: 0.2926  MAE: 1.2017  Corr: 0.4638 
2024-06-13 16:31:51:INFO:TRAIN-(cmcm) (5/20/3)>> loss: 0.7180
2024-06-13 16:31:53:INFO:VAL-(cmcm) >>
2024-06-13 16:31:53:INFO:M: >>  Has0_acc_2: 0.7424  Has0_F1_score: 0.7405  Non0_acc_2: 0.7685  Non0_F1_score: 0.7652  Mult_acc_5: 0.3799  Mult_acc_7: 0.2882  MAE: 1.1512  Corr: 0.5292 
2024-06-13 16:32:08:INFO:TRAIN-(cmcm) (6/21/3)>> loss: 0.7036
2024-06-13 16:32:11:INFO:VAL-(cmcm) >>
2024-06-13 16:32:11:INFO:M: >>  Has0_acc_2: 0.7424  Has0_F1_score: 0.7391  Non0_acc_2: 0.7361  Non0_F1_score: 0.7359  Mult_acc_5: 0.3319  Mult_acc_7: 0.2533  MAE: 1.1411  Corr: 0.5224 
2024-06-13 16:32:26:INFO:TRAIN-(cmcm) (7/22/3)>> loss: 0.6908
2024-06-13 16:32:29:INFO:VAL-(cmcm) >>
2024-06-13 16:32:29:INFO:M: >>  Has0_acc_2: 0.7249  Has0_F1_score: 0.7198  Non0_acc_2: 0.7361  Non0_F1_score: 0.7327  Mult_acc_5: 0.3843  Mult_acc_7: 0.2882  MAE: 1.1468  Corr: 0.5325 
2024-06-13 16:32:44:INFO:TRAIN-(cmcm) (8/23/3)>> loss: 0.6778
2024-06-13 16:32:46:INFO:VAL-(cmcm) >>
2024-06-13 16:32:46:INFO:M: >>  Has0_acc_2: 0.7511  Has0_F1_score: 0.7504  Non0_acc_2: 0.7407  Non0_F1_score: 0.7421  Mult_acc_5: 0.3930  Mult_acc_7: 0.3057  MAE: 1.1293  Corr: 0.5350 
2024-06-13 16:33:01:INFO:TRAIN-(cmcm) (9/24/3)>> loss: 0.6586
2024-06-13 16:33:04:INFO:VAL-(cmcm) >>
2024-06-13 16:33:04:INFO:M: >>  Has0_acc_2: 0.7205  Has0_F1_score: 0.7181  Non0_acc_2: 0.7407  Non0_F1_score: 0.7394  Mult_acc_5: 0.3843  Mult_acc_7: 0.3231  MAE: 1.1184  Corr: 0.5301 
2024-06-13 16:33:05:INFO:Saving checkpoint at epoch 24 to results/models/cmcm-mosi-regression.pth.
2024-06-13 16:33:21:INFO:TRAIN-(cmcm) (1/25/3)>> loss: 0.6374
2024-06-13 16:33:23:INFO:VAL-(cmcm) >>
2024-06-13 16:33:23:INFO:M: >>  Has0_acc_2: 0.7205  Has0_F1_score: 0.7214  Non0_acc_2: 0.7407  Non0_F1_score: 0.7416  Mult_acc_5: 0.3886  Mult_acc_7: 0.3188  MAE: 1.1293  Corr: 0.5239 
2024-06-13 16:33:38:INFO:TRAIN-(cmcm) (2/26/3)>> loss: 0.6210
2024-06-13 16:33:41:INFO:VAL-(cmcm) >>
2024-06-13 16:33:41:INFO:M: >>  Has0_acc_2: 0.7162  Has0_F1_score: 0.7164  Non0_acc_2: 0.7361  Non0_F1_score: 0.7375  Mult_acc_5: 0.3537  Mult_acc_7: 0.2969  MAE: 1.1455  Corr: 0.5253 
2024-06-13 16:33:56:INFO:TRAIN-(cmcm) (3/27/3)>> loss: 0.6052
2024-06-13 16:33:58:INFO:VAL-(cmcm) >>
2024-06-13 16:33:58:INFO:M: >>  Has0_acc_2: 0.7293  Has0_F1_score: 0.7269  Non0_acc_2: 0.7500  Non0_F1_score: 0.7492  Mult_acc_5: 0.3755  Mult_acc_7: 0.3100  MAE: 1.1320  Corr: 0.5323 
2024-06-13 16:34:13:INFO:TRAIN-(cmcm) (4/28/3)>> loss: 0.5888
2024-06-13 16:34:16:INFO:VAL-(cmcm) >>
2024-06-13 16:34:16:INFO:M: >>  Has0_acc_2: 0.7205  Has0_F1_score: 0.7181  Non0_acc_2: 0.7407  Non0_F1_score: 0.7404  Mult_acc_5: 0.3668  Mult_acc_7: 0.3057  MAE: 1.1437  Corr: 0.5139 
2024-06-13 16:34:31:INFO:TRAIN-(cmcm) (5/29/3)>> loss: 0.5808
2024-06-13 16:34:34:INFO:VAL-(cmcm) >>
2024-06-13 16:34:34:INFO:M: >>  Has0_acc_2: 0.7249  Has0_F1_score: 0.7215  Non0_acc_2: 0.7407  Non0_F1_score: 0.7394  Mult_acc_5: 0.3712  Mult_acc_7: 0.3100  MAE: 1.1333  Corr: 0.5295 
2024-06-13 16:34:49:INFO:TRAIN-(cmcm) (6/30/3)>> loss: 0.5734
2024-06-13 16:34:51:INFO:VAL-(cmcm) >>
2024-06-13 16:34:51:INFO:M: >>  Has0_acc_2: 0.7336  Has0_F1_score: 0.7303  Non0_acc_2: 0.7454  Non0_F1_score: 0.7443  Mult_acc_5: 0.3624  Mult_acc_7: 0.3013  MAE: 1.1402  Corr: 0.5245 
2024-06-13 16:35:06:INFO:TRAIN-(cmcm) (7/31/3)>> loss: 0.5727
2024-06-13 16:35:09:INFO:VAL-(cmcm) >>
2024-06-13 16:35:09:INFO:M: >>  Has0_acc_2: 0.7336  Has0_F1_score: 0.7303  Non0_acc_2: 0.7454  Non0_F1_score: 0.7443  Mult_acc_5: 0.3624  Mult_acc_7: 0.3013  MAE: 1.1368  Corr: 0.5293 
2024-06-13 16:35:24:INFO:TRAIN-(cmcm) (8/32/3)>> loss: 0.5786
2024-06-13 16:35:27:INFO:VAL-(cmcm) >>
2024-06-13 16:35:27:INFO:M: >>  Has0_acc_2: 0.7249  Has0_F1_score: 0.7222  Non0_acc_2: 0.7315  Non0_F1_score: 0.7311  Mult_acc_5: 0.3581  Mult_acc_7: 0.2969  MAE: 1.1446  Corr: 0.5238 
2024-06-13 16:35:42:INFO:TRAIN-(cmcm) (9/33/3)>> loss: 0.5773
2024-06-13 16:35:44:INFO:VAL-(cmcm) >>
2024-06-13 16:35:44:INFO:M: >>  Has0_acc_2: 0.7336  Has0_F1_score: 0.7323  Non0_acc_2: 0.7454  Non0_F1_score: 0.7448  Mult_acc_5: 0.3493  Mult_acc_7: 0.2882  MAE: 1.1455  Corr: 0.5322 
2024-06-13 16:35:59:INFO:TRAIN-(cmcm) (10/34/3)>> loss: 0.5857
2024-06-13 16:36:02:INFO:VAL-(cmcm) >>
2024-06-13 16:36:02:INFO:M: >>  Has0_acc_2: 0.7293  Has0_F1_score: 0.7282  Non0_acc_2: 0.7407  Non0_F1_score: 0.7416  Mult_acc_5: 0.3799  Mult_acc_7: 0.3275  MAE: 1.1237  Corr: 0.5379 
2024-06-13 16:36:09:INFO:TEST-(cmcm) >>
2024-06-13 16:36:09:INFO:M: >>  Has0_acc_2: 0.7070  Has0_F1_score: 0.7076  Non0_acc_2: 0.7241  Non0_F1_score: 0.7257  Mult_acc_5: 0.3542  Mult_acc_7: 0.3090  MAE: 1.1231  Corr: 0.5250 
2024-06-13 16:36:10:INFO:Results are added to results/results/mosi-regression-30.csv...
2024-06-13 16:36:10:INFO:Start running cmcm...
2024-06-13 16:36:10:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 6, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 4444}>
2024-06-13 16:36:10:INFO:Let's use the GPU 1 !
2024-06-13 16:36:10:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 16:36:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718267770 HTTP/1.1" 200 235
2024-06-13 16:36:11:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 16:36:11:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 16:36:12:INFO:train samples: (1284,)
2024-06-13 16:36:12:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 16:36:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718267772 HTTP/1.1" 200 235
2024-06-13 16:36:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 16:36:13:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 16:36:13:INFO:valid samples: (229,)
2024-06-13 16:36:13:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 16:36:14:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718267774 HTTP/1.1" 200 235
2024-06-13 16:36:14:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 16:36:14:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 16:36:15:INFO:test samples: (686,)
2024-06-13 16:36:15:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 16:36:15:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718267775 HTTP/1.1" 200 235
2024-06-13 16:36:15:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 16:36:16:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 16:36:16:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 16:36:17:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718267777 HTTP/1.1" 200 235
2024-06-13 16:36:17:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 16:36:17:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 16:36:17:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-13 16:36:17:WARNING:Try importing flash-attention for faster inference...
2024-06-13 16:36:17:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-13 16:36:17:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-13 16:36:17:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-13 16:36:19:INFO:trainable params: 1310288 || all params: 1838138960 || trainable%: 0.07128340286090232
2024-06-13 16:36:19:INFO:Init labels...
2024-06-13 16:36:19:INFO:Start training...
2024-06-13 16:36:34:INFO:TRAIN-(cmcm) (1/1/4)>> loss: 3.2720
2024-06-13 16:36:36:INFO:VAL-(cmcm) >>
2024-06-13 16:36:36:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.4352  Non0_F1_score: 0.2743  Mult_acc_5: 0.2140  Mult_acc_7: 0.2140  MAE: 1.4283  Corr: 0.1076 
2024-06-13 16:36:37:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-13 16:36:52:INFO:TRAIN-(cmcm) (1/2/4)>> loss: 2.0334
2024-06-13 16:36:55:INFO:VAL-(cmcm) >>
2024-06-13 16:36:55:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5787  Non0_F1_score: 0.4370  Mult_acc_5: 0.1965  Mult_acc_7: 0.1790  MAE: 1.5449  Corr: -0.0497 
2024-06-13 16:37:10:INFO:TRAIN-(cmcm) (2/3/4)>> loss: 0.8979
2024-06-13 16:37:13:INFO:VAL-(cmcm) >>
2024-06-13 16:37:13:INFO:M: >>  Has0_acc_2: 0.5546  Has0_F1_score: 0.5332  Non0_acc_2: 0.5417  Non0_F1_score: 0.5185  Mult_acc_5: 0.2533  Mult_acc_7: 0.1834  MAE: 1.7730  Corr: 0.0010 
2024-06-13 16:37:28:INFO:TRAIN-(cmcm) (3/4/4)>> loss: 0.8767
2024-06-13 16:37:30:INFO:VAL-(cmcm) >>
2024-06-13 16:37:30:INFO:M: >>  Has0_acc_2: 0.4803  Has0_F1_score: 0.4794  Non0_acc_2: 0.4907  Non0_F1_score: 0.4883  Mult_acc_5: 0.2358  Mult_acc_7: 0.1965  MAE: 1.7638  Corr: 0.0415 
2024-06-13 16:37:45:INFO:TRAIN-(cmcm) (4/5/4)>> loss: 0.8680
2024-06-13 16:37:48:INFO:VAL-(cmcm) >>
2024-06-13 16:37:48:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4700  Non0_acc_2: 0.5694  Non0_F1_score: 0.4396  Mult_acc_5: 0.2882  Mult_acc_7: 0.2227  MAE: 1.6532  Corr: 0.0526 
2024-06-13 16:38:03:INFO:TRAIN-(cmcm) (5/6/4)>> loss: 0.8667
2024-06-13 16:38:06:INFO:VAL-(cmcm) >>
2024-06-13 16:38:06:INFO:M: >>  Has0_acc_2: 0.6157  Has0_F1_score: 0.5113  Non0_acc_2: 0.5926  Non0_F1_score: 0.4856  Mult_acc_5: 0.2795  Mult_acc_7: 0.1965  MAE: 1.7023  Corr: 0.0226 
2024-06-13 16:38:21:INFO:TRAIN-(cmcm) (6/7/4)>> loss: 0.8548
2024-06-13 16:38:23:INFO:VAL-(cmcm) >>
2024-06-13 16:38:23:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4556  Non0_acc_2: 0.5741  Non0_F1_score: 0.4269  Mult_acc_5: 0.1616  Mult_acc_7: 0.1616  MAE: 1.5860  Corr: -0.0284 
2024-06-13 16:38:38:INFO:TRAIN-(cmcm) (7/8/4)>> loss: 0.8516
2024-06-13 16:38:41:INFO:VAL-(cmcm) >>
2024-06-13 16:38:41:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.5606  Non0_acc_2: 0.5926  Non0_F1_score: 0.5566  Mult_acc_5: 0.2969  Mult_acc_7: 0.2620  MAE: 1.5053  Corr: 0.1081 
2024-06-13 16:38:56:INFO:TRAIN-(cmcm) (8/9/4)>> loss: 0.8545
2024-06-13 16:38:59:INFO:VAL-(cmcm) >>
2024-06-13 16:38:59:INFO:M: >>  Has0_acc_2: 0.5590  Has0_F1_score: 0.5295  Non0_acc_2: 0.5880  Non0_F1_score: 0.5605  Mult_acc_5: 0.2140  Mult_acc_7: 0.1965  MAE: 1.5363  Corr: 0.2552 
2024-06-13 16:39:14:INFO:TRAIN-(cmcm) (9/10/4)>> loss: 0.8397
2024-06-13 16:39:16:INFO:VAL-(cmcm) >>
2024-06-13 16:39:16:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.5292  Non0_acc_2: 0.5972  Non0_F1_score: 0.5247  Mult_acc_5: 0.3188  Mult_acc_7: 0.2314  MAE: 1.5651  Corr: 0.1492 
2024-06-13 16:39:31:INFO:TRAIN-(cmcm) (10/11/4)>> loss: 0.8185
2024-06-13 16:39:34:INFO:VAL-(cmcm) >>
2024-06-13 16:39:34:INFO:M: >>  Has0_acc_2: 0.7031  Has0_F1_score: 0.7053  Non0_acc_2: 0.7176  Non0_F1_score: 0.7191  Mult_acc_5: 0.4105  Mult_acc_7: 0.3319  MAE: 1.1800  Corr: 0.4382 
2024-06-13 16:39:34:INFO:Saving checkpoint at epoch 11 to results/models/cmcm-mosi-regression.pth.
2024-06-13 16:39:50:INFO:TRAIN-(cmcm) (1/12/4)>> loss: 0.8053
2024-06-13 16:39:53:INFO:VAL-(cmcm) >>
2024-06-13 16:39:53:INFO:M: >>  Has0_acc_2: 0.7249  Has0_F1_score: 0.7256  Non0_acc_2: 0.7407  Non0_F1_score: 0.7407  Mult_acc_5: 0.3886  Mult_acc_7: 0.2882  MAE: 1.1878  Corr: 0.4706 
2024-06-13 16:40:08:INFO:TRAIN-(cmcm) (2/13/4)>> loss: 0.7872
2024-06-13 16:40:10:INFO:VAL-(cmcm) >>
2024-06-13 16:40:10:INFO:M: >>  Has0_acc_2: 0.7031  Has0_F1_score: 0.7054  Non0_acc_2: 0.6852  Non0_F1_score: 0.6823  Mult_acc_5: 0.3188  Mult_acc_7: 0.2707  MAE: 1.1756  Corr: 0.4952 
2024-06-13 16:40:11:INFO:Saving checkpoint at epoch 13 to results/models/cmcm-mosi-regression.pth.
2024-06-13 16:40:26:INFO:TRAIN-(cmcm) (1/14/4)>> loss: 0.7809
2024-06-13 16:40:29:INFO:VAL-(cmcm) >>
2024-06-13 16:40:29:INFO:M: >>  Has0_acc_2: 0.7555  Has0_F1_score: 0.7470  Non0_acc_2: 0.7593  Non0_F1_score: 0.7499  Mult_acc_5: 0.3799  Mult_acc_7: 0.2838  MAE: 1.2485  Corr: 0.4868 
2024-06-13 16:40:44:INFO:TRAIN-(cmcm) (2/15/4)>> loss: 0.7777
2024-06-13 16:40:47:INFO:VAL-(cmcm) >>
2024-06-13 16:40:47:INFO:M: >>  Has0_acc_2: 0.7336  Has0_F1_score: 0.7334  Non0_acc_2: 0.7315  Non0_F1_score: 0.7311  Mult_acc_5: 0.3624  Mult_acc_7: 0.2707  MAE: 1.1647  Corr: 0.4995 
2024-06-13 16:40:47:INFO:Saving checkpoint at epoch 15 to results/models/cmcm-mosi-regression.pth.
2024-06-13 16:41:02:INFO:TRAIN-(cmcm) (1/16/4)>> loss: 0.7588
2024-06-13 16:41:05:INFO:VAL-(cmcm) >>
2024-06-13 16:41:05:INFO:M: >>  Has0_acc_2: 0.6769  Has0_F1_score: 0.6781  Non0_acc_2: 0.7037  Non0_F1_score: 0.7037  Mult_acc_5: 0.3493  Mult_acc_7: 0.2707  MAE: 1.3267  Corr: 0.4326 
2024-06-13 16:41:20:INFO:TRAIN-(cmcm) (2/17/4)>> loss: 0.7605
2024-06-13 16:41:23:INFO:VAL-(cmcm) >>
2024-06-13 16:41:23:INFO:M: >>  Has0_acc_2: 0.7118  Has0_F1_score: 0.7060  Non0_acc_2: 0.7130  Non0_F1_score: 0.7062  Mult_acc_5: 0.3668  Mult_acc_7: 0.2751  MAE: 1.2734  Corr: 0.4537 
2024-06-13 16:41:38:INFO:TRAIN-(cmcm) (3/18/4)>> loss: 0.7443
2024-06-13 16:41:40:INFO:VAL-(cmcm) >>
2024-06-13 16:41:40:INFO:M: >>  Has0_acc_2: 0.7249  Has0_F1_score: 0.7198  Non0_acc_2: 0.7546  Non0_F1_score: 0.7559  Mult_acc_5: 0.3886  Mult_acc_7: 0.3100  MAE: 1.1057  Corr: 0.5385 
2024-06-13 16:41:41:INFO:Saving checkpoint at epoch 18 to results/models/cmcm-mosi-regression.pth.
2024-06-13 16:41:56:INFO:TRAIN-(cmcm) (1/19/4)>> loss: 0.7171
2024-06-13 16:41:59:INFO:VAL-(cmcm) >>
2024-06-13 16:41:59:INFO:M: >>  Has0_acc_2: 0.7467  Has0_F1_score: 0.7463  Non0_acc_2: 0.7593  Non0_F1_score: 0.7605  Mult_acc_5: 0.3974  Mult_acc_7: 0.3144  MAE: 1.0560  Corr: 0.5771 
2024-06-13 16:41:59:INFO:Saving checkpoint at epoch 19 to results/models/cmcm-mosi-regression.pth.
2024-06-13 16:42:15:INFO:TRAIN-(cmcm) (1/20/4)>> loss: 0.7102
2024-06-13 16:42:17:INFO:VAL-(cmcm) >>
2024-06-13 16:42:17:INFO:M: >>  Has0_acc_2: 0.7205  Has0_F1_score: 0.7119  Non0_acc_2: 0.6991  Non0_F1_score: 0.6925  Mult_acc_5: 0.3930  Mult_acc_7: 0.3144  MAE: 1.1506  Corr: 0.5037 
2024-06-13 16:42:32:INFO:TRAIN-(cmcm) (2/21/4)>> loss: 0.6984
2024-06-13 16:42:35:INFO:VAL-(cmcm) >>
2024-06-13 16:42:35:INFO:M: >>  Has0_acc_2: 0.7293  Has0_F1_score: 0.7311  Non0_acc_2: 0.7361  Non0_F1_score: 0.7369  Mult_acc_5: 0.3930  Mult_acc_7: 0.2838  MAE: 1.1599  Corr: 0.5382 
2024-06-13 16:42:50:INFO:TRAIN-(cmcm) (3/22/4)>> loss: 0.6896
2024-06-13 16:42:52:INFO:VAL-(cmcm) >>
2024-06-13 16:42:52:INFO:M: >>  Has0_acc_2: 0.7293  Has0_F1_score: 0.7311  Non0_acc_2: 0.7546  Non0_F1_score: 0.7551  Mult_acc_5: 0.4279  Mult_acc_7: 0.3188  MAE: 1.1044  Corr: 0.5595 
2024-06-13 16:43:07:INFO:TRAIN-(cmcm) (4/23/4)>> loss: 0.6675
2024-06-13 16:43:10:INFO:VAL-(cmcm) >>
2024-06-13 16:43:10:INFO:M: >>  Has0_acc_2: 0.7249  Has0_F1_score: 0.7276  Non0_acc_2: 0.7361  Non0_F1_score: 0.7375  Mult_acc_5: 0.3668  Mult_acc_7: 0.3057  MAE: 1.1455  Corr: 0.5437 
2024-06-13 16:43:25:INFO:TRAIN-(cmcm) (5/24/4)>> loss: 0.6475
2024-06-13 16:43:28:INFO:VAL-(cmcm) >>
2024-06-13 16:43:28:INFO:M: >>  Has0_acc_2: 0.7205  Has0_F1_score: 0.7229  Non0_acc_2: 0.7454  Non0_F1_score: 0.7467  Mult_acc_5: 0.3799  Mult_acc_7: 0.2882  MAE: 1.1075  Corr: 0.5791 
2024-06-13 16:43:42:INFO:TRAIN-(cmcm) (6/25/4)>> loss: 0.6191
2024-06-13 16:43:45:INFO:VAL-(cmcm) >>
2024-06-13 16:43:45:INFO:M: >>  Has0_acc_2: 0.6856  Has0_F1_score: 0.6837  Non0_acc_2: 0.7176  Non0_F1_score: 0.7187  Mult_acc_5: 0.3712  Mult_acc_7: 0.2795  MAE: 1.1464  Corr: 0.5464 
2024-06-13 16:44:00:INFO:TRAIN-(cmcm) (7/26/4)>> loss: 0.5971
2024-06-13 16:44:03:INFO:VAL-(cmcm) >>
2024-06-13 16:44:03:INFO:M: >>  Has0_acc_2: 0.7031  Has0_F1_score: 0.7019  Non0_acc_2: 0.7176  Non0_F1_score: 0.7174  Mult_acc_5: 0.4192  Mult_acc_7: 0.3188  MAE: 1.1442  Corr: 0.5276 
2024-06-13 16:44:18:INFO:TRAIN-(cmcm) (8/27/4)>> loss: 0.5799
2024-06-13 16:44:20:INFO:VAL-(cmcm) >>
2024-06-13 16:44:20:INFO:M: >>  Has0_acc_2: 0.6812  Has0_F1_score: 0.6753  Non0_acc_2: 0.7037  Non0_F1_score: 0.7022  Mult_acc_5: 0.3799  Mult_acc_7: 0.2838  MAE: 1.1477  Corr: 0.5346 
2024-06-13 16:44:35:INFO:TRAIN-(cmcm) (9/28/4)>> loss: 0.5630
2024-06-13 16:44:38:INFO:VAL-(cmcm) >>
2024-06-13 16:44:38:INFO:M: >>  Has0_acc_2: 0.6856  Has0_F1_score: 0.6812  Non0_acc_2: 0.7130  Non0_F1_score: 0.7130  Mult_acc_5: 0.3581  Mult_acc_7: 0.2795  MAE: 1.1533  Corr: 0.5235 
2024-06-13 16:44:53:INFO:TRAIN-(cmcm) (10/29/4)>> loss: 0.5495
2024-06-13 16:44:55:INFO:VAL-(cmcm) >>
2024-06-13 16:44:55:INFO:M: >>  Has0_acc_2: 0.6812  Has0_F1_score: 0.6763  Non0_acc_2: 0.6944  Non0_F1_score: 0.6940  Mult_acc_5: 0.3537  Mult_acc_7: 0.2751  MAE: 1.1625  Corr: 0.5144 
2024-06-13 16:45:03:INFO:TEST-(cmcm) >>
2024-06-13 16:45:03:INFO:M: >>  Has0_acc_2: 0.6749  Has0_F1_score: 0.6757  Non0_acc_2: 0.7165  Non0_F1_score: 0.7170  Mult_acc_5: 0.3032  Mult_acc_7: 0.2755  MAE: 1.2138  Corr: 0.4526 
2024-06-13 16:45:03:INFO:Results are added to results/results/mosi-regression-30.csv...
2024-06-13 16:45:03:INFO:Start running cmcm...
2024-06-13 16:45:03:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 6, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 5555}>
2024-06-13 16:45:03:INFO:Let's use the GPU 1 !
2024-06-13 16:45:03:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 16:45:04:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718268304 HTTP/1.1" 200 235
2024-06-13 16:45:04:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 16:45:04:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 16:45:05:INFO:train samples: (1284,)
2024-06-13 16:45:06:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 16:45:06:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718268306 HTTP/1.1" 200 235
2024-06-13 16:45:06:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 16:45:07:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 16:45:07:INFO:valid samples: (229,)
2024-06-13 16:45:07:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 16:45:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718268308 HTTP/1.1" 200 235
2024-06-13 16:45:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 16:45:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 16:45:09:INFO:test samples: (686,)
2024-06-13 16:45:09:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 16:45:09:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718268310 HTTP/1.1" 200 235
2024-06-13 16:45:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 16:45:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 16:45:11:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 16:45:11:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718268311 HTTP/1.1" 200 235
2024-06-13 16:45:11:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 16:45:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 16:45:12:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-13 16:45:12:WARNING:Try importing flash-attention for faster inference...
2024-06-13 16:45:12:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-13 16:45:12:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-13 16:45:12:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-13 16:45:13:INFO:trainable params: 1310288 || all params: 1838138960 || trainable%: 0.07128340286090232
2024-06-13 16:45:13:INFO:Init labels...
2024-06-13 16:45:13:INFO:Start training...
2024-06-13 16:45:28:INFO:TRAIN-(cmcm) (1/1/5)>> loss: 1.7508
2024-06-13 16:45:31:INFO:VAL-(cmcm) >>
2024-06-13 16:45:31:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5728  Non0_acc_2: 0.5833  Non0_F1_score: 0.5812  Mult_acc_5: 0.1834  Mult_acc_7: 0.1834  MAE: 1.5480  Corr: 0.1134 
2024-06-13 16:45:31:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-13 16:45:47:INFO:TRAIN-(cmcm) (1/2/5)>> loss: 0.9236
2024-06-13 16:45:49:INFO:VAL-(cmcm) >>
2024-06-13 16:45:49:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4923  Non0_acc_2: 0.5694  Non0_F1_score: 0.4655  Mult_acc_5: 0.1747  Mult_acc_7: 0.1747  MAE: 1.5034  Corr: 0.0021 
2024-06-13 16:45:49:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-13 16:46:05:INFO:TRAIN-(cmcm) (1/3/5)>> loss: 0.8889
2024-06-13 16:46:07:INFO:VAL-(cmcm) >>
2024-06-13 16:46:07:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4458  Non0_acc_2: 0.5648  Non0_F1_score: 0.4299  Mult_acc_5: 0.2445  Mult_acc_7: 0.2052  MAE: 1.5750  Corr: 0.0285 
2024-06-13 16:46:22:INFO:TRAIN-(cmcm) (2/4/5)>> loss: 0.8943
2024-06-13 16:46:25:INFO:VAL-(cmcm) >>
2024-06-13 16:46:25:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.5140  Non0_acc_2: 0.5648  Non0_F1_score: 0.4978  Mult_acc_5: 0.2926  Mult_acc_7: 0.2140  MAE: 1.7171  Corr: 0.0125 
2024-06-13 16:46:40:INFO:TRAIN-(cmcm) (3/5/5)>> loss: 0.8772
2024-06-13 16:46:42:INFO:VAL-(cmcm) >>
2024-06-13 16:46:42:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.5317  Non0_acc_2: 0.5648  Non0_F1_score: 0.5168  Mult_acc_5: 0.2838  Mult_acc_7: 0.2183  MAE: 1.6586  Corr: 0.0239 
2024-06-13 16:46:57:INFO:TRAIN-(cmcm) (4/6/5)>> loss: 0.8646
2024-06-13 16:47:00:INFO:VAL-(cmcm) >>
2024-06-13 16:47:00:INFO:M: >>  Has0_acc_2: 0.5459  Has0_F1_score: 0.5487  Non0_acc_2: 0.5556  Non0_F1_score: 0.5556  Mult_acc_5: 0.2009  Mult_acc_7: 0.1703  MAE: 1.8030  Corr: 0.0842 
2024-06-13 16:47:16:INFO:TRAIN-(cmcm) (5/7/5)>> loss: 0.8603
2024-06-13 16:47:18:INFO:VAL-(cmcm) >>
2024-06-13 16:47:18:INFO:M: >>  Has0_acc_2: 0.5502  Has0_F1_score: 0.5522  Non0_acc_2: 0.5463  Non0_F1_score: 0.5422  Mult_acc_5: 0.1921  Mult_acc_7: 0.1834  MAE: 1.5606  Corr: 0.1242 
2024-06-13 16:47:33:INFO:TRAIN-(cmcm) (6/8/5)>> loss: 0.8653
2024-06-13 16:47:36:INFO:VAL-(cmcm) >>
2024-06-13 16:47:36:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4805  Non0_acc_2: 0.5694  Non0_F1_score: 0.4531  Mult_acc_5: 0.2926  Mult_acc_7: 0.2140  MAE: 1.7721  Corr: 0.0162 
2024-06-13 16:47:51:INFO:TRAIN-(cmcm) (7/9/5)>> loss: 0.8623
2024-06-13 16:47:53:INFO:VAL-(cmcm) >>
2024-06-13 16:47:53:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4458  Non0_acc_2: 0.5694  Non0_F1_score: 0.4166  Mult_acc_5: 0.2969  Mult_acc_7: 0.2140  MAE: 1.7232  Corr: 0.0420 
2024-06-13 16:48:09:INFO:TRAIN-(cmcm) (8/10/5)>> loss: 0.8544
2024-06-13 16:48:11:INFO:VAL-(cmcm) >>
2024-06-13 16:48:11:INFO:M: >>  Has0_acc_2: 0.6376  Has0_F1_score: 0.5518  Non0_acc_2: 0.6435  Non0_F1_score: 0.5832  Mult_acc_5: 0.2096  Mult_acc_7: 0.2009  MAE: 1.3816  Corr: 0.1881 
2024-06-13 16:48:11:INFO:Saving checkpoint at epoch 10 to results/models/cmcm-mosi-regression.pth.
2024-06-13 16:48:27:INFO:TRAIN-(cmcm) (1/11/5)>> loss: 0.8442
2024-06-13 16:48:29:INFO:VAL-(cmcm) >>
2024-06-13 16:48:29:INFO:M: >>  Has0_acc_2: 0.6594  Has0_F1_score: 0.6413  Non0_acc_2: 0.6620  Non0_F1_score: 0.6432  Mult_acc_5: 0.2445  Mult_acc_7: 0.2009  MAE: 1.2957  Corr: 0.3310 
2024-06-13 16:48:30:INFO:Saving checkpoint at epoch 11 to results/models/cmcm-mosi-regression.pth.
2024-06-13 16:48:45:INFO:TRAIN-(cmcm) (1/12/5)>> loss: 0.8373
2024-06-13 16:48:48:INFO:VAL-(cmcm) >>
2024-06-13 16:48:48:INFO:M: >>  Has0_acc_2: 0.6856  Has0_F1_score: 0.6821  Non0_acc_2: 0.6898  Non0_F1_score: 0.6849  Mult_acc_5: 0.3755  Mult_acc_7: 0.2882  MAE: 1.2983  Corr: 0.3951 
2024-06-13 16:49:03:INFO:TRAIN-(cmcm) (2/13/5)>> loss: 0.8338
2024-06-13 16:49:05:INFO:VAL-(cmcm) >>
2024-06-13 16:49:05:INFO:M: >>  Has0_acc_2: 0.6507  Has0_F1_score: 0.6532  Non0_acc_2: 0.6296  Non0_F1_score: 0.6254  Mult_acc_5: 0.2926  Mult_acc_7: 0.2314  MAE: 1.4271  Corr: 0.3993 
2024-06-13 16:49:20:INFO:TRAIN-(cmcm) (3/14/5)>> loss: 0.8225
2024-06-13 16:49:23:INFO:VAL-(cmcm) >>
2024-06-13 16:49:23:INFO:M: >>  Has0_acc_2: 0.7031  Has0_F1_score: 0.7036  Non0_acc_2: 0.7500  Non0_F1_score: 0.7500  Mult_acc_5: 0.3799  Mult_acc_7: 0.3013  MAE: 1.1887  Corr: 0.5190 
2024-06-13 16:49:23:INFO:Saving checkpoint at epoch 14 to results/models/cmcm-mosi-regression.pth.
2024-06-13 16:49:38:INFO:TRAIN-(cmcm) (1/15/5)>> loss: 0.8050
2024-06-13 16:49:41:INFO:VAL-(cmcm) >>
2024-06-13 16:49:41:INFO:M: >>  Has0_acc_2: 0.6507  Has0_F1_score: 0.6528  Non0_acc_2: 0.6574  Non0_F1_score: 0.6557  Mult_acc_5: 0.3057  Mult_acc_7: 0.2533  MAE: 1.3781  Corr: 0.4177 
2024-06-13 16:49:56:INFO:TRAIN-(cmcm) (2/16/5)>> loss: 0.7943
2024-06-13 16:49:59:INFO:VAL-(cmcm) >>
2024-06-13 16:49:59:INFO:M: >>  Has0_acc_2: 0.7598  Has0_F1_score: 0.7520  Non0_acc_2: 0.7593  Non0_F1_score: 0.7509  Mult_acc_5: 0.4061  Mult_acc_7: 0.3406  MAE: 1.0992  Corr: 0.5529 
2024-06-13 16:49:59:INFO:Saving checkpoint at epoch 16 to results/models/cmcm-mosi-regression.pth.
2024-06-13 16:50:14:INFO:TRAIN-(cmcm) (1/17/5)>> loss: 0.7850
2024-06-13 16:50:17:INFO:VAL-(cmcm) >>
2024-06-13 16:50:17:INFO:M: >>  Has0_acc_2: 0.6987  Has0_F1_score: 0.7011  Non0_acc_2: 0.6481  Non0_F1_score: 0.6366  Mult_acc_5: 0.3493  Mult_acc_7: 0.3057  MAE: 1.2349  Corr: 0.5145 
2024-06-13 16:50:32:INFO:TRAIN-(cmcm) (2/18/5)>> loss: 0.7719
2024-06-13 16:50:35:INFO:VAL-(cmcm) >>
2024-06-13 16:50:35:INFO:M: >>  Has0_acc_2: 0.6856  Has0_F1_score: 0.6887  Non0_acc_2: 0.7130  Non0_F1_score: 0.7144  Mult_acc_5: 0.3886  Mult_acc_7: 0.3057  MAE: 1.1800  Corr: 0.5150 
2024-06-13 16:50:50:INFO:TRAIN-(cmcm) (3/19/5)>> loss: 0.7588
2024-06-13 16:50:52:INFO:VAL-(cmcm) >>
2024-06-13 16:50:52:INFO:M: >>  Has0_acc_2: 0.7118  Has0_F1_score: 0.7144  Non0_acc_2: 0.7593  Non0_F1_score: 0.7606  Mult_acc_5: 0.3930  Mult_acc_7: 0.3188  MAE: 1.0759  Corr: 0.5735 
2024-06-13 16:50:53:INFO:Saving checkpoint at epoch 19 to results/models/cmcm-mosi-regression.pth.
2024-06-13 16:51:08:INFO:TRAIN-(cmcm) (1/20/5)>> loss: 0.7548
2024-06-13 16:51:10:INFO:VAL-(cmcm) >>
2024-06-13 16:51:10:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.5481  Non0_acc_2: 0.5648  Non0_F1_score: 0.5216  Mult_acc_5: 0.2533  Mult_acc_7: 0.2096  MAE: 1.5114  Corr: 0.4236 
2024-06-13 16:51:25:INFO:TRAIN-(cmcm) (2/21/5)>> loss: 0.7546
2024-06-13 16:51:28:INFO:VAL-(cmcm) >>
2024-06-13 16:51:28:INFO:M: >>  Has0_acc_2: 0.7205  Has0_F1_score: 0.7158  Non0_acc_2: 0.7407  Non0_F1_score: 0.7407  Mult_acc_5: 0.3843  Mult_acc_7: 0.3013  MAE: 1.0564  Corr: 0.6123 
2024-06-13 16:51:29:INFO:Saving checkpoint at epoch 21 to results/models/cmcm-mosi-regression.pth.
2024-06-13 16:51:44:INFO:TRAIN-(cmcm) (1/22/5)>> loss: 0.7290
2024-06-13 16:51:46:INFO:VAL-(cmcm) >>
2024-06-13 16:51:46:INFO:M: >>  Has0_acc_2: 0.7031  Has0_F1_score: 0.6858  Non0_acc_2: 0.7176  Non0_F1_score: 0.7154  Mult_acc_5: 0.3450  Mult_acc_7: 0.2882  MAE: 1.0825  Corr: 0.5650 
2024-06-13 16:52:02:INFO:TRAIN-(cmcm) (2/23/5)>> loss: 0.7118
2024-06-13 16:52:04:INFO:VAL-(cmcm) >>
2024-06-13 16:52:04:INFO:M: >>  Has0_acc_2: 0.7118  Has0_F1_score: 0.7142  Non0_acc_2: 0.7407  Non0_F1_score: 0.7421  Mult_acc_5: 0.4236  Mult_acc_7: 0.3406  MAE: 1.0838  Corr: 0.5723 
2024-06-13 16:52:19:INFO:TRAIN-(cmcm) (3/24/5)>> loss: 0.7126
2024-06-13 16:52:22:INFO:VAL-(cmcm) >>
2024-06-13 16:52:22:INFO:M: >>  Has0_acc_2: 0.7336  Has0_F1_score: 0.7317  Non0_acc_2: 0.7407  Non0_F1_score: 0.7416  Mult_acc_5: 0.4017  Mult_acc_7: 0.3188  MAE: 1.1023  Corr: 0.5455 
2024-06-13 16:52:37:INFO:TRAIN-(cmcm) (4/25/5)>> loss: 0.6914
2024-06-13 16:52:39:INFO:VAL-(cmcm) >>
2024-06-13 16:52:39:INFO:M: >>  Has0_acc_2: 0.7074  Has0_F1_score: 0.7020  Non0_acc_2: 0.7500  Non0_F1_score: 0.7506  Mult_acc_5: 0.3886  Mult_acc_7: 0.3100  MAE: 1.0619  Corr: 0.5770 
2024-06-13 16:52:54:INFO:TRAIN-(cmcm) (5/26/5)>> loss: 0.6854
2024-06-13 16:52:57:INFO:VAL-(cmcm) >>
2024-06-13 16:52:57:INFO:M: >>  Has0_acc_2: 0.7380  Has0_F1_score: 0.7384  Non0_acc_2: 0.7593  Non0_F1_score: 0.7601  Mult_acc_5: 0.4192  Mult_acc_7: 0.3450  MAE: 1.0846  Corr: 0.5764 
2024-06-13 16:53:12:INFO:TRAIN-(cmcm) (6/27/5)>> loss: 0.6740
2024-06-13 16:53:14:INFO:VAL-(cmcm) >>
2024-06-13 16:53:14:INFO:M: >>  Has0_acc_2: 0.7380  Has0_F1_score: 0.7395  Non0_acc_2: 0.7731  Non0_F1_score: 0.7738  Mult_acc_5: 0.4105  Mult_acc_7: 0.3275  MAE: 1.0525  Corr: 0.6024 
2024-06-13 16:53:15:INFO:Saving checkpoint at epoch 27 to results/models/cmcm-mosi-regression.pth.
2024-06-13 16:53:30:INFO:TRAIN-(cmcm) (1/28/5)>> loss: 0.6679
2024-06-13 16:53:33:INFO:VAL-(cmcm) >>
2024-06-13 16:53:33:INFO:M: >>  Has0_acc_2: 0.7424  Has0_F1_score: 0.7442  Non0_acc_2: 0.7778  Non0_F1_score: 0.7787  Mult_acc_5: 0.4061  Mult_acc_7: 0.3275  MAE: 1.0392  Corr: 0.6048 
2024-06-13 16:53:33:INFO:Saving checkpoint at epoch 28 to results/models/cmcm-mosi-regression.pth.
2024-06-13 16:53:49:INFO:TRAIN-(cmcm) (1/29/5)>> loss: 0.6610
2024-06-13 16:53:51:INFO:VAL-(cmcm) >>
2024-06-13 16:53:51:INFO:M: >>  Has0_acc_2: 0.7424  Has0_F1_score: 0.7437  Non0_acc_2: 0.7685  Non0_F1_score: 0.7695  Mult_acc_5: 0.4061  Mult_acc_7: 0.3231  MAE: 1.0637  Corr: 0.5938 
2024-06-13 16:54:06:INFO:TRAIN-(cmcm) (2/30/5)>> loss: 0.6597
2024-06-13 16:54:09:INFO:VAL-(cmcm) >>
2024-06-13 16:54:09:INFO:M: >>  Has0_acc_2: 0.7424  Has0_F1_score: 0.7437  Non0_acc_2: 0.7685  Non0_F1_score: 0.7695  Mult_acc_5: 0.4105  Mult_acc_7: 0.3275  MAE: 1.0471  Corr: 0.6066 
2024-06-13 16:54:24:INFO:TRAIN-(cmcm) (3/31/5)>> loss: 0.6582
2024-06-13 16:54:26:INFO:VAL-(cmcm) >>
2024-06-13 16:54:26:INFO:M: >>  Has0_acc_2: 0.7511  Has0_F1_score: 0.7524  Non0_acc_2: 0.7778  Non0_F1_score: 0.7788  Mult_acc_5: 0.4148  Mult_acc_7: 0.3319  MAE: 1.0384  Corr: 0.6046 
2024-06-13 16:54:27:INFO:Saving checkpoint at epoch 31 to results/models/cmcm-mosi-regression.pth.
2024-06-13 16:54:42:INFO:TRAIN-(cmcm) (1/32/5)>> loss: 0.6591
2024-06-13 16:54:45:INFO:VAL-(cmcm) >>
2024-06-13 16:54:45:INFO:M: >>  Has0_acc_2: 0.7380  Has0_F1_score: 0.7392  Non0_acc_2: 0.7778  Non0_F1_score: 0.7783  Mult_acc_5: 0.3974  Mult_acc_7: 0.3100  MAE: 1.0686  Corr: 0.5961 
2024-06-13 16:55:00:INFO:TRAIN-(cmcm) (2/33/5)>> loss: 0.6615
2024-06-13 16:55:02:INFO:VAL-(cmcm) >>
2024-06-13 16:55:02:INFO:M: >>  Has0_acc_2: 0.7467  Has0_F1_score: 0.7482  Non0_acc_2: 0.7824  Non0_F1_score: 0.7830  Mult_acc_5: 0.4236  Mult_acc_7: 0.3450  MAE: 1.0219  Corr: 0.6129 
2024-06-13 16:55:03:INFO:Saving checkpoint at epoch 33 to results/models/cmcm-mosi-regression.pth.
2024-06-13 16:55:18:INFO:TRAIN-(cmcm) (1/34/5)>> loss: 0.6662
2024-06-13 16:55:20:INFO:VAL-(cmcm) >>
2024-06-13 16:55:20:INFO:M: >>  Has0_acc_2: 0.7467  Has0_F1_score: 0.7479  Non0_acc_2: 0.7778  Non0_F1_score: 0.7781  Mult_acc_5: 0.4148  Mult_acc_7: 0.3275  MAE: 1.0520  Corr: 0.6005 
2024-06-13 16:55:35:INFO:TRAIN-(cmcm) (2/35/5)>> loss: 0.6727
2024-06-13 16:55:38:INFO:VAL-(cmcm) >>
2024-06-13 16:55:38:INFO:M: >>  Has0_acc_2: 0.6987  Has0_F1_score: 0.7016  Non0_acc_2: 0.7130  Non0_F1_score: 0.7130  Mult_acc_5: 0.3668  Mult_acc_7: 0.2969  MAE: 1.1512  Corr: 0.5183 
2024-06-13 16:55:53:INFO:TRAIN-(cmcm) (3/36/5)>> loss: 0.6840
2024-06-13 16:55:56:INFO:VAL-(cmcm) >>
2024-06-13 16:55:56:INFO:M: >>  Has0_acc_2: 0.7380  Has0_F1_score: 0.7213  Non0_acc_2: 0.7315  Non0_F1_score: 0.7144  Mult_acc_5: 0.3930  Mult_acc_7: 0.2838  MAE: 1.1210  Corr: 0.5711 
2024-06-13 16:56:10:INFO:TRAIN-(cmcm) (4/37/5)>> loss: 0.7010
2024-06-13 16:56:13:INFO:VAL-(cmcm) >>
2024-06-13 16:56:13:INFO:M: >>  Has0_acc_2: 0.7118  Has0_F1_score: 0.7131  Non0_acc_2: 0.7361  Non0_F1_score: 0.7355  Mult_acc_5: 0.3843  Mult_acc_7: 0.2838  MAE: 1.1250  Corr: 0.5601 
2024-06-13 16:56:28:INFO:TRAIN-(cmcm) (5/38/5)>> loss: 0.7048
2024-06-13 16:56:31:INFO:VAL-(cmcm) >>
2024-06-13 16:56:31:INFO:M: >>  Has0_acc_2: 0.6812  Has0_F1_score: 0.6342  Non0_acc_2: 0.7130  Non0_F1_score: 0.7018  Mult_acc_5: 0.3755  Mult_acc_7: 0.3100  MAE: 1.1293  Corr: 0.5385 
2024-06-13 16:56:46:INFO:TRAIN-(cmcm) (6/39/5)>> loss: 0.7052
2024-06-13 16:56:48:INFO:VAL-(cmcm) >>
2024-06-13 16:56:48:INFO:M: >>  Has0_acc_2: 0.7336  Has0_F1_score: 0.7295  Non0_acc_2: 0.7546  Non0_F1_score: 0.7484  Mult_acc_5: 0.4148  Mult_acc_7: 0.3231  MAE: 1.0918  Corr: 0.5645 
2024-06-13 16:57:03:INFO:TRAIN-(cmcm) (7/40/5)>> loss: 0.7348
2024-06-13 16:57:06:INFO:VAL-(cmcm) >>
2024-06-13 16:57:06:INFO:M: >>  Has0_acc_2: 0.7336  Has0_F1_score: 0.7360  Non0_acc_2: 0.7593  Non0_F1_score: 0.7604  Mult_acc_5: 0.3450  Mult_acc_7: 0.3057  MAE: 1.0628  Corr: 0.5724 
2024-06-13 16:57:21:INFO:TRAIN-(cmcm) (8/41/5)>> loss: 0.7203
2024-06-13 16:57:24:INFO:VAL-(cmcm) >>
2024-06-13 16:57:24:INFO:M: >>  Has0_acc_2: 0.7293  Has0_F1_score: 0.7220  Non0_acc_2: 0.7407  Non0_F1_score: 0.7317  Mult_acc_5: 0.4236  Mult_acc_7: 0.3188  MAE: 1.0519  Corr: 0.5935 
2024-06-13 16:57:39:INFO:TRAIN-(cmcm) (9/42/5)>> loss: 0.7362
2024-06-13 16:57:42:INFO:VAL-(cmcm) >>
2024-06-13 16:57:42:INFO:M: >>  Has0_acc_2: 0.6900  Has0_F1_score: 0.6711  Non0_acc_2: 0.7130  Non0_F1_score: 0.6947  Mult_acc_5: 0.3843  Mult_acc_7: 0.3100  MAE: 1.1542  Corr: 0.4942 
2024-06-13 16:57:57:INFO:TRAIN-(cmcm) (10/43/5)>> loss: 0.7304
2024-06-13 16:57:59:INFO:VAL-(cmcm) >>
2024-06-13 16:57:59:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.5965  Non0_acc_2: 0.6389  Non0_F1_score: 0.6284  Mult_acc_5: 0.3624  Mult_acc_7: 0.2838  MAE: 1.2926  Corr: 0.4522 
2024-06-13 16:58:07:INFO:TEST-(cmcm) >>
2024-06-13 16:58:07:INFO:M: >>  Has0_acc_2: 0.7055  Has0_F1_score: 0.7061  Non0_acc_2: 0.7287  Non0_F1_score: 0.7293  Mult_acc_5: 0.3571  Mult_acc_7: 0.3251  MAE: 1.1195  Corr: 0.5023 
2024-06-13 16:58:07:INFO:Results are added to results/results/mosi-regression-30.csv...
2024-06-13 16:58:07:INFO:Start running cmcm...
2024-06-13 16:58:07:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 6, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 40, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-06-13 16:58:07:INFO:Let's use the GPU 1 !
2024-06-13 16:58:07:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 16:58:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718269088 HTTP/1.1" 200 235
2024-06-13 16:58:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 16:58:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 16:58:09:INFO:train samples: (1284,)
2024-06-13 16:58:09:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 16:58:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718269090 HTTP/1.1" 200 235
2024-06-13 16:58:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 16:58:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 16:58:11:INFO:valid samples: (229,)
2024-06-13 16:58:11:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 16:58:11:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718269091 HTTP/1.1" 200 235
2024-06-13 16:58:11:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 16:58:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 16:58:12:INFO:test samples: (686,)
2024-06-13 16:58:12:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 16:58:13:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718269093 HTTP/1.1" 200 235
2024-06-13 16:58:13:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 16:58:13:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 16:58:14:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 16:58:14:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718269094 HTTP/1.1" 200 235
2024-06-13 16:58:14:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 16:58:15:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 16:58:15:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-13 16:58:15:WARNING:Try importing flash-attention for faster inference...
2024-06-13 16:58:15:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-13 16:58:15:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-13 16:58:15:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-13 16:58:16:INFO:trainable params: 1310288 || all params: 1838138960 || trainable%: 0.07128340286090232
2024-06-13 16:58:16:INFO:Init labels...
2024-06-13 16:58:16:INFO:Start training...
2024-06-13 16:58:31:INFO:TRAIN-(cmcm) (1/1/1)>> loss: 1.9762
2024-06-13 16:58:34:INFO:VAL-(cmcm) >>
2024-06-13 16:58:34:INFO:M: >>  Has0_acc_2: 0.5546  Has0_F1_score: 0.4910  Non0_acc_2: 0.5370  Non0_F1_score: 0.4701  Mult_acc_5: 0.2140  Mult_acc_7: 0.1747  MAE: 1.6752  Corr: -0.0357 
2024-06-13 16:58:34:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-13 16:58:50:INFO:TRAIN-(cmcm) (1/2/1)>> loss: 0.9022
2024-06-13 16:58:52:INFO:VAL-(cmcm) >>
2024-06-13 16:58:52:INFO:M: >>  Has0_acc_2: 0.4017  Has0_F1_score: 0.2303  Non0_acc_2: 0.4259  Non0_F1_score: 0.2544  Mult_acc_5: 0.1397  Mult_acc_7: 0.1397  MAE: 1.7532  Corr: 0.0156 
2024-06-13 16:59:07:INFO:TRAIN-(cmcm) (2/3/1)>> loss: 0.8959
2024-06-13 16:59:10:INFO:VAL-(cmcm) >>
2024-06-13 16:59:10:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5741  Non0_F1_score: 0.4187  Mult_acc_5: 0.1659  Mult_acc_7: 0.1659  MAE: 1.4768  Corr: 0.0335 
2024-06-13 16:59:10:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-mosi-regression.pth.
2024-06-13 16:59:26:INFO:TRAIN-(cmcm) (1/4/1)>> loss: 0.8847
2024-06-13 16:59:28:INFO:VAL-(cmcm) >>
2024-06-13 16:59:28:INFO:M: >>  Has0_acc_2: 0.5197  Has0_F1_score: 0.5224  Non0_acc_2: 0.5000  Non0_F1_score: 0.5012  Mult_acc_5: 0.1878  Mult_acc_7: 0.1878  MAE: 1.5178  Corr: 0.0152 
2024-06-13 16:59:44:INFO:TRAIN-(cmcm) (2/5/1)>> loss: 0.8763
2024-06-13 16:59:46:INFO:VAL-(cmcm) >>
2024-06-13 16:59:46:INFO:M: >>  Has0_acc_2: 0.4672  Has0_F1_score: 0.4043  Non0_acc_2: 0.4907  Non0_F1_score: 0.4293  Mult_acc_5: 0.1354  Mult_acc_7: 0.1354  MAE: 1.7558  Corr: 0.1040 
2024-06-13 17:00:01:INFO:TRAIN-(cmcm) (3/6/1)>> loss: 0.8723
2024-06-13 17:00:04:INFO:VAL-(cmcm) >>
2024-06-13 17:00:04:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5410  Non0_acc_2: 0.5648  Non0_F1_score: 0.5233  Mult_acc_5: 0.2140  Mult_acc_7: 0.1965  MAE: 1.5746  Corr: 0.0326 
2024-06-13 17:00:19:INFO:TRAIN-(cmcm) (4/7/1)>> loss: 0.8670
2024-06-13 17:00:21:INFO:VAL-(cmcm) >>
2024-06-13 17:00:21:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4891  Non0_acc_2: 0.5741  Non0_F1_score: 0.4622  Mult_acc_5: 0.2882  Mult_acc_7: 0.2314  MAE: 1.6713  Corr: 0.0193 
2024-06-13 17:00:37:INFO:TRAIN-(cmcm) (5/8/1)>> loss: 0.8660
2024-06-13 17:00:39:INFO:VAL-(cmcm) >>
2024-06-13 17:00:39:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.5314  Non0_acc_2: 0.5694  Non0_F1_score: 0.5131  Mult_acc_5: 0.2707  Mult_acc_7: 0.2096  MAE: 1.7180  Corr: 0.0032 
2024-06-13 17:00:54:INFO:TRAIN-(cmcm) (6/9/1)>> loss: 0.8599
2024-06-13 17:00:57:INFO:VAL-(cmcm) >>
2024-06-13 17:00:57:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4458  Non0_acc_2: 0.5648  Non0_F1_score: 0.4299  Mult_acc_5: 0.2620  Mult_acc_7: 0.2009  MAE: 1.6328  Corr: -0.0104 
2024-06-13 17:01:12:INFO:TRAIN-(cmcm) (7/10/1)>> loss: 0.8568
2024-06-13 17:01:14:INFO:VAL-(cmcm) >>
2024-06-13 17:01:14:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.5029  Non0_acc_2: 0.5880  Non0_F1_score: 0.4767  Mult_acc_5: 0.3057  Mult_acc_7: 0.2271  MAE: 1.6983  Corr: 0.0633 
2024-06-13 17:01:29:INFO:TRAIN-(cmcm) (8/11/1)>> loss: 0.8531
2024-06-13 17:01:32:INFO:VAL-(cmcm) >>
2024-06-13 17:01:32:INFO:M: >>  Has0_acc_2: 0.5633  Has0_F1_score: 0.5356  Non0_acc_2: 0.5509  Non0_F1_score: 0.5210  Mult_acc_5: 0.2664  Mult_acc_7: 0.1834  MAE: 1.8027  Corr: 0.0311 
2024-06-13 17:01:47:INFO:TRAIN-(cmcm) (9/12/1)>> loss: 0.8481
2024-06-13 17:01:50:INFO:VAL-(cmcm) >>
2024-06-13 17:01:50:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4577  Non0_acc_2: 0.5787  Non0_F1_score: 0.4370  Mult_acc_5: 0.2751  Mult_acc_7: 0.2140  MAE: 1.5293  Corr: 0.0971 
2024-06-13 17:02:05:INFO:TRAIN-(cmcm) (10/13/1)>> loss: 0.8429
2024-06-13 17:02:07:INFO:VAL-(cmcm) >>
2024-06-13 17:02:07:INFO:M: >>  Has0_acc_2: 0.6463  Has0_F1_score: 0.6398  Non0_acc_2: 0.6528  Non0_F1_score: 0.6440  Mult_acc_5: 0.3275  Mult_acc_7: 0.2402  MAE: 1.5245  Corr: 0.2365 
2024-06-13 17:02:15:INFO:TEST-(cmcm) >>
2024-06-13 17:02:15:INFO:M: >>  Has0_acc_2: 0.4475  Has0_F1_score: 0.2767  Non0_acc_2: 0.4284  Non0_F1_score: 0.2639  Mult_acc_5: 0.1662  Mult_acc_7: 0.1662  MAE: 1.7347  Corr: 0.1315 
2024-06-13 17:02:15:INFO:Results are added to results/results/mosi-regression-40.csv...
2024-06-13 17:02:15:INFO:Start running cmcm...
2024-06-13 17:02:15:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 6, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 40, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 2222}>
2024-06-13 17:02:15:INFO:Let's use the GPU 1 !
2024-06-13 17:02:15:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 17:02:16:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718269336 HTTP/1.1" 200 235
2024-06-13 17:02:16:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 17:02:16:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 17:02:17:INFO:train samples: (1284,)
2024-06-13 17:02:17:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 17:02:17:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718269338 HTTP/1.1" 200 235
2024-06-13 17:02:18:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 17:02:18:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 17:02:19:INFO:valid samples: (229,)
2024-06-13 17:02:19:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 17:02:19:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718269339 HTTP/1.1" 200 235
2024-06-13 17:02:19:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 17:02:20:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 17:02:20:INFO:test samples: (686,)
2024-06-13 17:02:20:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 17:02:21:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718269341 HTTP/1.1" 200 235
2024-06-13 17:02:21:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 17:02:21:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 17:02:22:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 17:02:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718269342 HTTP/1.1" 200 235
2024-06-13 17:02:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 17:02:23:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 17:02:23:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-13 17:02:23:WARNING:Try importing flash-attention for faster inference...
2024-06-13 17:02:23:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-13 17:02:23:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-13 17:02:23:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-13 17:02:24:INFO:trainable params: 1310288 || all params: 1838138960 || trainable%: 0.07128340286090232
2024-06-13 17:02:24:INFO:Init labels...
2024-06-13 17:02:24:INFO:Start training...
2024-06-13 17:02:39:INFO:TRAIN-(cmcm) (1/1/2)>> loss: 2.0013
2024-06-13 17:02:41:INFO:VAL-(cmcm) >>
2024-06-13 17:02:41:INFO:M: >>  Has0_acc_2: 0.4323  Has0_F1_score: 0.3526  Non0_acc_2: 0.4398  Non0_F1_score: 0.3517  Mult_acc_5: 0.1747  Mult_acc_7: 0.1485  MAE: 1.9646  Corr: 0.0285 
2024-06-13 17:02:42:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-13 17:02:57:INFO:TRAIN-(cmcm) (1/2/2)>> loss: 0.9279
2024-06-13 17:03:00:INFO:VAL-(cmcm) >>
2024-06-13 17:03:00:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5741  Non0_F1_score: 0.4187  Mult_acc_5: 0.1965  Mult_acc_7: 0.1921  MAE: 1.5366  Corr: -0.0233 
2024-06-13 17:03:01:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-13 17:03:16:INFO:TRAIN-(cmcm) (1/3/2)>> loss: 0.9072
2024-06-13 17:03:18:INFO:VAL-(cmcm) >>
2024-06-13 17:03:18:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5247  Non0_acc_2: 0.5694  Non0_F1_score: 0.5092  Mult_acc_5: 0.1790  Mult_acc_7: 0.1790  MAE: 1.5139  Corr: -0.0012 
2024-06-13 17:03:19:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-mosi-regression.pth.
2024-06-13 17:03:34:INFO:TRAIN-(cmcm) (1/4/2)>> loss: 0.8856
2024-06-13 17:03:37:INFO:VAL-(cmcm) >>
2024-06-13 17:03:37:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4950  Non0_acc_2: 0.5741  Non0_F1_score: 0.4683  Mult_acc_5: 0.2140  Mult_acc_7: 0.1616  MAE: 1.5555  Corr: 0.0592 
2024-06-13 17:03:52:INFO:TRAIN-(cmcm) (2/5/2)>> loss: 0.8787
2024-06-13 17:03:55:INFO:VAL-(cmcm) >>
2024-06-13 17:03:55:INFO:M: >>  Has0_acc_2: 0.5240  Has0_F1_score: 0.5222  Non0_acc_2: 0.5324  Non0_F1_score: 0.5287  Mult_acc_5: 0.2489  Mult_acc_7: 0.1747  MAE: 1.8957  Corr: 0.1102 
2024-06-13 17:04:10:INFO:TRAIN-(cmcm) (3/6/2)>> loss: 0.8714
2024-06-13 17:04:12:INFO:VAL-(cmcm) >>
2024-06-13 17:04:12:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.5414  Non0_acc_2: 0.5370  Non0_F1_score: 0.5347  Mult_acc_5: 0.2271  Mult_acc_7: 0.2227  MAE: 1.5453  Corr: 0.0305 
2024-06-13 17:04:27:INFO:TRAIN-(cmcm) (4/7/2)>> loss: 0.8664
2024-06-13 17:04:30:INFO:VAL-(cmcm) >>
2024-06-13 17:04:30:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.4880  Non0_acc_2: 0.5833  Non0_F1_score: 0.4799  Mult_acc_5: 0.2838  Mult_acc_7: 0.2358  MAE: 1.5820  Corr: 0.1200 
2024-06-13 17:04:45:INFO:TRAIN-(cmcm) (5/8/2)>> loss: 0.8592
2024-06-13 17:04:48:INFO:VAL-(cmcm) >>
2024-06-13 17:04:48:INFO:M: >>  Has0_acc_2: 0.6376  Has0_F1_score: 0.5874  Non0_acc_2: 0.6204  Non0_F1_score: 0.5690  Mult_acc_5: 0.3319  Mult_acc_7: 0.2445  MAE: 1.6023  Corr: 0.2154 
2024-06-13 17:05:03:INFO:TRAIN-(cmcm) (6/9/2)>> loss: 0.8496
2024-06-13 17:05:05:INFO:VAL-(cmcm) >>
2024-06-13 17:05:05:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4891  Non0_acc_2: 0.5741  Non0_F1_score: 0.4622  Mult_acc_5: 0.2009  Mult_acc_7: 0.1965  MAE: 1.6506  Corr: -0.0005 
2024-06-13 17:05:21:INFO:TRAIN-(cmcm) (7/10/2)>> loss: 0.8539
2024-06-13 17:05:23:INFO:VAL-(cmcm) >>
2024-06-13 17:05:23:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4917  Non0_acc_2: 0.5833  Non0_F1_score: 0.4676  Mult_acc_5: 0.3013  Mult_acc_7: 0.2183  MAE: 1.7171  Corr: 0.1120 
2024-06-13 17:05:38:INFO:TRAIN-(cmcm) (8/11/2)>> loss: 0.8437
2024-06-13 17:05:41:INFO:VAL-(cmcm) >>
2024-06-13 17:05:41:INFO:M: >>  Has0_acc_2: 0.6201  Has0_F1_score: 0.6197  Non0_acc_2: 0.6204  Non0_F1_score: 0.6185  Mult_acc_5: 0.2402  Mult_acc_7: 0.2052  MAE: 1.5191  Corr: 0.1676 
2024-06-13 17:05:56:INFO:TRAIN-(cmcm) (9/12/2)>> loss: 0.8328
2024-06-13 17:05:59:INFO:VAL-(cmcm) >>
2024-06-13 17:05:59:INFO:M: >>  Has0_acc_2: 0.6201  Has0_F1_score: 0.5567  Non0_acc_2: 0.6065  Non0_F1_score: 0.5399  Mult_acc_5: 0.2533  Mult_acc_7: 0.1878  MAE: 1.5442  Corr: 0.1719 
2024-06-13 17:06:14:INFO:TRAIN-(cmcm) (10/13/2)>> loss: 0.8275
2024-06-13 17:06:16:INFO:VAL-(cmcm) >>
2024-06-13 17:06:16:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.5873  Non0_acc_2: 0.6343  Non0_F1_score: 0.6154  Mult_acc_5: 0.2664  Mult_acc_7: 0.2489  MAE: 1.3231  Corr: 0.4178 
2024-06-13 17:06:17:INFO:Saving checkpoint at epoch 13 to results/models/cmcm-mosi-regression.pth.
2024-06-13 17:06:33:INFO:TRAIN-(cmcm) (1/14/2)>> loss: 0.8262
2024-06-13 17:06:35:INFO:VAL-(cmcm) >>
2024-06-13 17:06:35:INFO:M: >>  Has0_acc_2: 0.6507  Has0_F1_score: 0.5941  Non0_acc_2: 0.6389  Non0_F1_score: 0.5796  Mult_acc_5: 0.3057  Mult_acc_7: 0.2183  MAE: 1.5774  Corr: 0.2838 
2024-06-13 17:06:50:INFO:TRAIN-(cmcm) (2/15/2)>> loss: 0.8109
2024-06-13 17:06:53:INFO:VAL-(cmcm) >>
2024-06-13 17:06:53:INFO:M: >>  Has0_acc_2: 0.6812  Has0_F1_score: 0.6772  Non0_acc_2: 0.6852  Non0_F1_score: 0.6797  Mult_acc_5: 0.2926  Mult_acc_7: 0.2314  MAE: 1.3219  Corr: 0.3657 
2024-06-13 17:06:54:INFO:Saving checkpoint at epoch 15 to results/models/cmcm-mosi-regression.pth.
2024-06-13 17:07:09:INFO:TRAIN-(cmcm) (1/16/2)>> loss: 0.8115
2024-06-13 17:07:12:INFO:VAL-(cmcm) >>
2024-06-13 17:07:12:INFO:M: >>  Has0_acc_2: 0.6463  Has0_F1_score: 0.6450  Non0_acc_2: 0.6204  Non0_F1_score: 0.6118  Mult_acc_5: 0.3057  Mult_acc_7: 0.2838  MAE: 1.2826  Corr: 0.3638 
2024-06-13 17:07:12:INFO:Saving checkpoint at epoch 16 to results/models/cmcm-mosi-regression.pth.
2024-06-13 17:07:28:INFO:TRAIN-(cmcm) (1/17/2)>> loss: 0.7977
2024-06-13 17:07:30:INFO:VAL-(cmcm) >>
2024-06-13 17:07:30:INFO:M: >>  Has0_acc_2: 0.6812  Has0_F1_score: 0.6772  Non0_acc_2: 0.6806  Non0_F1_score: 0.6772  Mult_acc_5: 0.3537  Mult_acc_7: 0.2751  MAE: 1.2975  Corr: 0.3821 
2024-06-13 17:07:45:INFO:TRAIN-(cmcm) (2/18/2)>> loss: 0.7877
2024-06-13 17:07:48:INFO:VAL-(cmcm) >>
2024-06-13 17:07:48:INFO:M: >>  Has0_acc_2: 0.6725  Has0_F1_score: 0.6746  Non0_acc_2: 0.6991  Non0_F1_score: 0.6989  Mult_acc_5: 0.3886  Mult_acc_7: 0.3319  MAE: 1.1258  Corr: 0.5091 
2024-06-13 17:07:49:INFO:Saving checkpoint at epoch 18 to results/models/cmcm-mosi-regression.pth.
2024-06-13 17:08:04:INFO:TRAIN-(cmcm) (1/19/2)>> loss: 0.7796
2024-06-13 17:08:07:INFO:VAL-(cmcm) >>
2024-06-13 17:08:07:INFO:M: >>  Has0_acc_2: 0.6987  Has0_F1_score: 0.6994  Non0_acc_2: 0.7083  Non0_F1_score: 0.7077  Mult_acc_5: 0.3319  Mult_acc_7: 0.2926  MAE: 1.2650  Corr: 0.4288 
2024-06-13 17:08:22:INFO:TRAIN-(cmcm) (2/20/2)>> loss: 0.7663
2024-06-13 17:08:25:INFO:VAL-(cmcm) >>
2024-06-13 17:08:25:INFO:M: >>  Has0_acc_2: 0.7249  Has0_F1_score: 0.7256  Non0_acc_2: 0.7361  Non0_F1_score: 0.7355  Mult_acc_5: 0.3799  Mult_acc_7: 0.3144  MAE: 1.1271  Corr: 0.5186 
2024-06-13 17:08:40:INFO:TRAIN-(cmcm) (3/21/2)>> loss: 0.7631
2024-06-13 17:08:42:INFO:VAL-(cmcm) >>
2024-06-13 17:08:42:INFO:M: >>  Has0_acc_2: 0.7074  Has0_F1_score: 0.6743  Non0_acc_2: 0.6991  Non0_F1_score: 0.6647  Mult_acc_5: 0.3537  Mult_acc_7: 0.3057  MAE: 1.1966  Corr: 0.4492 
2024-06-13 17:08:58:INFO:TRAIN-(cmcm) (4/22/2)>> loss: 0.7507
2024-06-13 17:09:01:INFO:VAL-(cmcm) >>
2024-06-13 17:09:01:INFO:M: >>  Has0_acc_2: 0.7162  Has0_F1_score: 0.7164  Non0_acc_2: 0.7130  Non0_F1_score: 0.7137  Mult_acc_5: 0.3581  Mult_acc_7: 0.2882  MAE: 1.2154  Corr: 0.4774 
2024-06-13 17:09:16:INFO:TRAIN-(cmcm) (5/23/2)>> loss: 0.7505
2024-06-13 17:09:19:INFO:VAL-(cmcm) >>
2024-06-13 17:09:19:INFO:M: >>  Has0_acc_2: 0.6245  Has0_F1_score: 0.6131  Non0_acc_2: 0.6296  Non0_F1_score: 0.6130  Mult_acc_5: 0.2707  Mult_acc_7: 0.2271  MAE: 1.3746  Corr: 0.3998 
2024-06-13 17:09:34:INFO:TRAIN-(cmcm) (6/24/2)>> loss: 0.7456
2024-06-13 17:09:36:INFO:VAL-(cmcm) >>
2024-06-13 17:09:36:INFO:M: >>  Has0_acc_2: 0.6681  Has0_F1_score: 0.6714  Non0_acc_2: 0.6620  Non0_F1_score: 0.6633  Mult_acc_5: 0.3537  Mult_acc_7: 0.2882  MAE: 1.2782  Corr: 0.4332 
2024-06-13 17:09:52:INFO:TRAIN-(cmcm) (7/25/2)>> loss: 0.7324
2024-06-13 17:09:54:INFO:VAL-(cmcm) >>
2024-06-13 17:09:54:INFO:M: >>  Has0_acc_2: 0.6900  Has0_F1_score: 0.6676  Non0_acc_2: 0.6944  Non0_F1_score: 0.6766  Mult_acc_5: 0.3712  Mult_acc_7: 0.2926  MAE: 1.3079  Corr: 0.3970 
2024-06-13 17:10:09:INFO:TRAIN-(cmcm) (8/26/2)>> loss: 0.7308
2024-06-13 17:10:12:INFO:VAL-(cmcm) >>
2024-06-13 17:10:12:INFO:M: >>  Has0_acc_2: 0.6812  Has0_F1_score: 0.6651  Non0_acc_2: 0.6806  Non0_F1_score: 0.6793  Mult_acc_5: 0.3624  Mult_acc_7: 0.3013  MAE: 1.2143  Corr: 0.4408 
2024-06-13 17:10:27:INFO:TRAIN-(cmcm) (9/27/2)>> loss: 0.7145
2024-06-13 17:10:30:INFO:VAL-(cmcm) >>
2024-06-13 17:10:30:INFO:M: >>  Has0_acc_2: 0.7031  Has0_F1_score: 0.7048  Non0_acc_2: 0.7083  Non0_F1_score: 0.7092  Mult_acc_5: 0.3362  Mult_acc_7: 0.2838  MAE: 1.2327  Corr: 0.4591 
2024-06-13 17:10:45:INFO:TRAIN-(cmcm) (10/28/2)>> loss: 0.6946
2024-06-13 17:10:47:INFO:VAL-(cmcm) >>
2024-06-13 17:10:47:INFO:M: >>  Has0_acc_2: 0.7336  Has0_F1_score: 0.7202  Non0_acc_2: 0.7269  Non0_F1_score: 0.7199  Mult_acc_5: 0.3799  Mult_acc_7: 0.3144  MAE: 1.2127  Corr: 0.4737 
2024-06-13 17:10:55:INFO:TEST-(cmcm) >>
2024-06-13 17:10:55:INFO:M: >>  Has0_acc_2: 0.6866  Has0_F1_score: 0.6869  Non0_acc_2: 0.6936  Non0_F1_score: 0.6945  Mult_acc_5: 0.2915  Mult_acc_7: 0.2653  MAE: 1.2147  Corr: 0.4415 
2024-06-13 17:10:55:INFO:Results are added to results/results/mosi-regression-40.csv...
2024-06-13 17:10:55:INFO:Start running cmcm...
2024-06-13 17:10:55:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 6, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 40, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 3333}>
2024-06-13 17:10:55:INFO:Let's use the GPU 1 !
2024-06-13 17:10:55:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 17:10:56:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718269856 HTTP/1.1" 200 235
2024-06-13 17:10:56:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 17:10:56:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 17:10:57:INFO:train samples: (1284,)
2024-06-13 17:10:57:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 17:10:57:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718269857 HTTP/1.1" 200 235
2024-06-13 17:10:58:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 17:10:58:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 17:10:59:INFO:valid samples: (229,)
2024-06-13 17:10:59:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 17:10:59:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718269859 HTTP/1.1" 200 235
2024-06-13 17:10:59:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 17:11:00:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 17:11:00:INFO:test samples: (686,)
2024-06-13 17:11:00:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 17:11:01:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718269861 HTTP/1.1" 200 235
2024-06-13 17:11:01:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 17:11:01:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 17:11:02:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 17:11:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718269862 HTTP/1.1" 200 235
2024-06-13 17:11:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 17:11:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 17:11:03:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-13 17:11:03:WARNING:Try importing flash-attention for faster inference...
2024-06-13 17:11:03:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-13 17:11:03:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-13 17:11:03:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-13 17:11:04:INFO:trainable params: 1310288 || all params: 1838138960 || trainable%: 0.07128340286090232
2024-06-13 17:11:04:INFO:Init labels...
2024-06-13 17:11:04:INFO:Start training...
2024-06-13 17:11:19:INFO:TRAIN-(cmcm) (1/1/3)>> loss: 2.2122
2024-06-13 17:11:21:INFO:VAL-(cmcm) >>
2024-06-13 17:11:21:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4866  Non0_acc_2: 0.5694  Non0_F1_score: 0.4655  Mult_acc_5: 0.2707  Mult_acc_7: 0.1965  MAE: 1.7014  Corr: -0.0123 
2024-06-13 17:11:22:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-13 17:11:37:INFO:TRAIN-(cmcm) (1/2/3)>> loss: 0.9398
2024-06-13 17:11:40:INFO:VAL-(cmcm) >>
2024-06-13 17:11:40:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5741  Non0_F1_score: 0.4187  Mult_acc_5: 0.2576  Mult_acc_7: 0.1921  MAE: 1.6953  Corr: -0.0026 
2024-06-13 17:11:40:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-13 17:11:56:INFO:TRAIN-(cmcm) (1/3/3)>> loss: 0.9069
2024-06-13 17:11:58:INFO:VAL-(cmcm) >>
2024-06-13 17:11:58:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5477  Non0_acc_2: 0.5741  Non0_F1_score: 0.5303  Mult_acc_5: 0.2838  Mult_acc_7: 0.2140  MAE: 1.6940  Corr: 0.0255 
2024-06-13 17:11:59:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-mosi-regression.pth.
2024-06-13 17:12:14:INFO:TRAIN-(cmcm) (1/4/3)>> loss: 0.9626
2024-06-13 17:12:17:INFO:VAL-(cmcm) >>
2024-06-13 17:12:17:INFO:M: >>  Has0_acc_2: 0.4934  Has0_F1_score: 0.4763  Non0_acc_2: 0.5093  Non0_F1_score: 0.4913  Mult_acc_5: 0.1790  Mult_acc_7: 0.1616  MAE: 1.8136  Corr: 0.0552 
2024-06-13 17:12:32:INFO:TRAIN-(cmcm) (2/5/3)>> loss: 0.8825
2024-06-13 17:12:34:INFO:VAL-(cmcm) >>
2024-06-13 17:12:34:INFO:M: >>  Has0_acc_2: 0.6157  Has0_F1_score: 0.4863  Non0_acc_2: 0.5926  Non0_F1_score: 0.4592  Mult_acc_5: 0.2620  Mult_acc_7: 0.1965  MAE: 1.6699  Corr: 0.0508 
2024-06-13 17:12:35:INFO:Saving checkpoint at epoch 5 to results/models/cmcm-mosi-regression.pth.
2024-06-13 17:12:50:INFO:TRAIN-(cmcm) (1/6/3)>> loss: 0.8624
2024-06-13 17:12:53:INFO:VAL-(cmcm) >>
2024-06-13 17:12:53:INFO:M: >>  Has0_acc_2: 0.5633  Has0_F1_score: 0.5499  Non0_acc_2: 0.5602  Non0_F1_score: 0.5440  Mult_acc_5: 0.2489  Mult_acc_7: 0.1790  MAE: 1.8267  Corr: 0.0319 
2024-06-13 17:13:08:INFO:TRAIN-(cmcm) (2/7/3)>> loss: 0.8583
2024-06-13 17:13:11:INFO:VAL-(cmcm) >>
2024-06-13 17:13:11:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5737  Non0_acc_2: 0.5787  Non0_F1_score: 0.5694  Mult_acc_5: 0.2707  Mult_acc_7: 0.1965  MAE: 1.7071  Corr: 0.0686 
2024-06-13 17:13:26:INFO:TRAIN-(cmcm) (3/8/3)>> loss: 0.8561
2024-06-13 17:13:29:INFO:VAL-(cmcm) >>
2024-06-13 17:13:29:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.4897  Non0_acc_2: 0.5741  Non0_F1_score: 0.4902  Mult_acc_5: 0.2926  Mult_acc_7: 0.2183  MAE: 1.5913  Corr: 0.1033 
2024-06-13 17:13:29:INFO:Saving checkpoint at epoch 8 to results/models/cmcm-mosi-regression.pth.
2024-06-13 17:13:45:INFO:TRAIN-(cmcm) (1/9/3)>> loss: 0.8463
2024-06-13 17:13:47:INFO:VAL-(cmcm) >>
2024-06-13 17:13:47:INFO:M: >>  Has0_acc_2: 0.6288  Has0_F1_score: 0.5741  Non0_acc_2: 0.6204  Non0_F1_score: 0.5619  Mult_acc_5: 0.3275  Mult_acc_7: 0.2402  MAE: 1.5267  Corr: 0.2616 
2024-06-13 17:13:48:INFO:Saving checkpoint at epoch 9 to results/models/cmcm-mosi-regression.pth.
2024-06-13 17:14:03:INFO:TRAIN-(cmcm) (1/10/3)>> loss: 0.8404
2024-06-13 17:14:06:INFO:VAL-(cmcm) >>
2024-06-13 17:14:06:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.5383  Non0_acc_2: 0.6065  Non0_F1_score: 0.5439  Mult_acc_5: 0.3057  Mult_acc_7: 0.2227  MAE: 1.5817  Corr: 0.2089 
2024-06-13 17:14:21:INFO:TRAIN-(cmcm) (2/11/3)>> loss: 0.8314
2024-06-13 17:14:23:INFO:VAL-(cmcm) >>
2024-06-13 17:14:23:INFO:M: >>  Has0_acc_2: 0.6288  Has0_F1_score: 0.5548  Non0_acc_2: 0.6250  Non0_F1_score: 0.5533  Mult_acc_5: 0.3275  Mult_acc_7: 0.2402  MAE: 1.5241  Corr: 0.3024 
2024-06-13 17:14:24:INFO:Saving checkpoint at epoch 11 to results/models/cmcm-mosi-regression.pth.
2024-06-13 17:14:39:INFO:TRAIN-(cmcm) (1/12/3)>> loss: 0.8190
2024-06-13 17:14:42:INFO:VAL-(cmcm) >>
2024-06-13 17:14:42:INFO:M: >>  Has0_acc_2: 0.6157  Has0_F1_score: 0.6041  Non0_acc_2: 0.6389  Non0_F1_score: 0.6194  Mult_acc_5: 0.2402  Mult_acc_7: 0.1965  MAE: 1.3765  Corr: 0.4227 
2024-06-13 17:14:42:INFO:Saving checkpoint at epoch 12 to results/models/cmcm-mosi-regression.pth.
2024-06-13 17:14:58:INFO:TRAIN-(cmcm) (1/13/3)>> loss: 0.8126
2024-06-13 17:15:00:INFO:VAL-(cmcm) >>
2024-06-13 17:15:00:INFO:M: >>  Has0_acc_2: 0.6463  Has0_F1_score: 0.6453  Non0_acc_2: 0.6574  Non0_F1_score: 0.6542  Mult_acc_5: 0.3362  Mult_acc_7: 0.2533  MAE: 1.3411  Corr: 0.3652 
2024-06-13 17:15:01:INFO:Saving checkpoint at epoch 13 to results/models/cmcm-mosi-regression.pth.
2024-06-13 17:15:16:INFO:TRAIN-(cmcm) (1/14/3)>> loss: 0.8138
2024-06-13 17:15:19:INFO:VAL-(cmcm) >>
2024-06-13 17:15:19:INFO:M: >>  Has0_acc_2: 0.6507  Has0_F1_score: 0.6533  Non0_acc_2: 0.6620  Non0_F1_score: 0.6636  Mult_acc_5: 0.2969  Mult_acc_7: 0.2271  MAE: 1.4254  Corr: 0.3225 
2024-06-13 17:15:34:INFO:TRAIN-(cmcm) (2/15/3)>> loss: 0.8039
2024-06-13 17:15:37:INFO:VAL-(cmcm) >>
2024-06-13 17:15:37:INFO:M: >>  Has0_acc_2: 0.6769  Has0_F1_score: 0.6613  Non0_acc_2: 0.6713  Non0_F1_score: 0.6547  Mult_acc_5: 0.3319  Mult_acc_7: 0.2445  MAE: 1.4651  Corr: 0.3513 
2024-06-13 17:15:52:INFO:TRAIN-(cmcm) (3/16/3)>> loss: 0.7870
2024-06-13 17:15:54:INFO:VAL-(cmcm) >>
2024-06-13 17:15:54:INFO:M: >>  Has0_acc_2: 0.6594  Has0_F1_score: 0.6271  Non0_acc_2: 0.6620  Non0_F1_score: 0.6286  Mult_acc_5: 0.3144  Mult_acc_7: 0.2227  MAE: 1.4560  Corr: 0.3971 
2024-06-13 17:16:09:INFO:TRAIN-(cmcm) (4/17/3)>> loss: 0.7733
2024-06-13 17:16:12:INFO:VAL-(cmcm) >>
2024-06-13 17:16:12:INFO:M: >>  Has0_acc_2: 0.6856  Has0_F1_score: 0.6803  Non0_acc_2: 0.6944  Non0_F1_score: 0.6872  Mult_acc_5: 0.3712  Mult_acc_7: 0.2882  MAE: 1.2547  Corr: 0.4336 
2024-06-13 17:16:12:INFO:Saving checkpoint at epoch 17 to results/models/cmcm-mosi-regression.pth.
2024-06-13 17:16:28:INFO:TRAIN-(cmcm) (1/18/3)>> loss: 0.7584
2024-06-13 17:16:30:INFO:VAL-(cmcm) >>
2024-06-13 17:16:30:INFO:M: >>  Has0_acc_2: 0.6900  Has0_F1_score: 0.6785  Non0_acc_2: 0.6898  Non0_F1_score: 0.6879  Mult_acc_5: 0.3100  Mult_acc_7: 0.2445  MAE: 1.2809  Corr: 0.4212 
2024-06-13 17:16:46:INFO:TRAIN-(cmcm) (2/19/3)>> loss: 0.7516
2024-06-13 17:16:48:INFO:VAL-(cmcm) >>
2024-06-13 17:16:48:INFO:M: >>  Has0_acc_2: 0.7031  Has0_F1_score: 0.7053  Non0_acc_2: 0.6713  Non0_F1_score: 0.6623  Mult_acc_5: 0.3275  Mult_acc_7: 0.2620  MAE: 1.2031  Corr: 0.5091 
2024-06-13 17:16:49:INFO:Saving checkpoint at epoch 19 to results/models/cmcm-mosi-regression.pth.
2024-06-13 17:17:04:INFO:TRAIN-(cmcm) (1/20/3)>> loss: 0.7531
2024-06-13 17:17:07:INFO:VAL-(cmcm) >>
2024-06-13 17:17:07:INFO:M: >>  Has0_acc_2: 0.7074  Has0_F1_score: 0.7096  Non0_acc_2: 0.7361  Non0_F1_score: 0.7373  Mult_acc_5: 0.3668  Mult_acc_7: 0.2795  MAE: 1.2848  Corr: 0.5048 
2024-06-13 17:17:22:INFO:TRAIN-(cmcm) (2/21/3)>> loss: 0.7354
2024-06-13 17:17:24:INFO:VAL-(cmcm) >>
2024-06-13 17:17:24:INFO:M: >>  Has0_acc_2: 0.6943  Has0_F1_score: 0.6924  Non0_acc_2: 0.6620  Non0_F1_score: 0.6623  Mult_acc_5: 0.3362  Mult_acc_7: 0.2751  MAE: 1.2420  Corr: 0.4322 
2024-06-13 17:17:39:INFO:TRAIN-(cmcm) (3/22/3)>> loss: 0.7212
2024-06-13 17:17:42:INFO:VAL-(cmcm) >>
2024-06-13 17:17:42:INFO:M: >>  Has0_acc_2: 0.6900  Has0_F1_score: 0.6916  Non0_acc_2: 0.7037  Non0_F1_score: 0.7049  Mult_acc_5: 0.3319  Mult_acc_7: 0.2620  MAE: 1.2306  Corr: 0.4529 
2024-06-13 17:17:57:INFO:TRAIN-(cmcm) (4/23/3)>> loss: 0.7139
2024-06-13 17:17:59:INFO:VAL-(cmcm) >>
2024-06-13 17:17:59:INFO:M: >>  Has0_acc_2: 0.6725  Has0_F1_score: 0.6728  Non0_acc_2: 0.6759  Non0_F1_score: 0.6764  Mult_acc_5: 0.3231  Mult_acc_7: 0.2489  MAE: 1.2769  Corr: 0.4364 
2024-06-13 17:18:14:INFO:TRAIN-(cmcm) (5/24/3)>> loss: 0.6994
2024-06-13 17:18:17:INFO:VAL-(cmcm) >>
2024-06-13 17:18:17:INFO:M: >>  Has0_acc_2: 0.6856  Has0_F1_score: 0.6886  Non0_acc_2: 0.6898  Non0_F1_score: 0.6880  Mult_acc_5: 0.3406  Mult_acc_7: 0.2707  MAE: 1.2053  Corr: 0.5136 
2024-06-13 17:18:32:INFO:TRAIN-(cmcm) (6/25/3)>> loss: 0.6929
2024-06-13 17:18:35:INFO:VAL-(cmcm) >>
2024-06-13 17:18:35:INFO:M: >>  Has0_acc_2: 0.7074  Has0_F1_score: 0.7053  Non0_acc_2: 0.6898  Non0_F1_score: 0.6904  Mult_acc_5: 0.3362  Mult_acc_7: 0.2620  MAE: 1.2424  Corr: 0.4440 
2024-06-13 17:18:50:INFO:TRAIN-(cmcm) (7/26/3)>> loss: 0.6849
2024-06-13 17:18:52:INFO:VAL-(cmcm) >>
2024-06-13 17:18:52:INFO:M: >>  Has0_acc_2: 0.7118  Has0_F1_score: 0.7135  Non0_acc_2: 0.6991  Non0_F1_score: 0.7007  Mult_acc_5: 0.3581  Mult_acc_7: 0.2926  MAE: 1.1551  Corr: 0.5022 
2024-06-13 17:18:53:INFO:Saving checkpoint at epoch 26 to results/models/cmcm-mosi-regression.pth.
2024-06-13 17:19:08:INFO:TRAIN-(cmcm) (1/27/3)>> loss: 0.6732
2024-06-13 17:19:11:INFO:VAL-(cmcm) >>
2024-06-13 17:19:11:INFO:M: >>  Has0_acc_2: 0.6900  Has0_F1_score: 0.6907  Non0_acc_2: 0.7037  Non0_F1_score: 0.7053  Mult_acc_5: 0.3624  Mult_acc_7: 0.2882  MAE: 1.2088  Corr: 0.4772 
2024-06-13 17:19:26:INFO:TRAIN-(cmcm) (2/28/3)>> loss: 0.6543
2024-06-13 17:19:28:INFO:VAL-(cmcm) >>
2024-06-13 17:19:28:INFO:M: >>  Has0_acc_2: 0.6900  Has0_F1_score: 0.6916  Non0_acc_2: 0.6944  Non0_F1_score: 0.6959  Mult_acc_5: 0.3406  Mult_acc_7: 0.2751  MAE: 1.1953  Corr: 0.4700 
2024-06-13 17:19:43:INFO:TRAIN-(cmcm) (3/29/3)>> loss: 0.6404
2024-06-13 17:19:46:INFO:VAL-(cmcm) >>
2024-06-13 17:19:46:INFO:M: >>  Has0_acc_2: 0.6769  Has0_F1_score: 0.6669  Non0_acc_2: 0.6667  Non0_F1_score: 0.6662  Mult_acc_5: 0.3712  Mult_acc_7: 0.2969  MAE: 1.2525  Corr: 0.4244 
2024-06-13 17:20:01:INFO:TRAIN-(cmcm) (4/30/3)>> loss: 0.6231
2024-06-13 17:20:04:INFO:VAL-(cmcm) >>
2024-06-13 17:20:04:INFO:M: >>  Has0_acc_2: 0.6681  Has0_F1_score: 0.6615  Non0_acc_2: 0.6898  Non0_F1_score: 0.6915  Mult_acc_5: 0.3843  Mult_acc_7: 0.3100  MAE: 1.2254  Corr: 0.4382 
2024-06-13 17:20:19:INFO:TRAIN-(cmcm) (5/31/3)>> loss: 0.6104
2024-06-13 17:20:21:INFO:VAL-(cmcm) >>
2024-06-13 17:20:21:INFO:M: >>  Has0_acc_2: 0.6856  Has0_F1_score: 0.6882  Non0_acc_2: 0.6806  Non0_F1_score: 0.6815  Mult_acc_5: 0.3231  Mult_acc_7: 0.2664  MAE: 1.2520  Corr: 0.4078 
2024-06-13 17:20:36:INFO:TRAIN-(cmcm) (6/32/3)>> loss: 0.6003
2024-06-13 17:20:39:INFO:VAL-(cmcm) >>
2024-06-13 17:20:39:INFO:M: >>  Has0_acc_2: 0.6812  Has0_F1_score: 0.6820  Non0_acc_2: 0.6759  Non0_F1_score: 0.6777  Mult_acc_5: 0.3319  Mult_acc_7: 0.2707  MAE: 1.2791  Corr: 0.4065 
2024-06-13 17:20:54:INFO:TRAIN-(cmcm) (7/33/3)>> loss: 0.5805
2024-06-13 17:20:56:INFO:VAL-(cmcm) >>
2024-06-13 17:20:56:INFO:M: >>  Has0_acc_2: 0.6943  Has0_F1_score: 0.6953  Non0_acc_2: 0.6759  Non0_F1_score: 0.6770  Mult_acc_5: 0.3450  Mult_acc_7: 0.2795  MAE: 1.2389  Corr: 0.4332 
2024-06-13 17:21:11:INFO:TRAIN-(cmcm) (8/34/3)>> loss: 0.5599
2024-06-13 17:21:14:INFO:VAL-(cmcm) >>
2024-06-13 17:21:14:INFO:M: >>  Has0_acc_2: 0.6812  Has0_F1_score: 0.6820  Non0_acc_2: 0.6852  Non0_F1_score: 0.6863  Mult_acc_5: 0.3406  Mult_acc_7: 0.2795  MAE: 1.2555  Corr: 0.4229 
2024-06-13 17:21:29:INFO:TRAIN-(cmcm) (9/35/3)>> loss: 0.5452
2024-06-13 17:21:32:INFO:VAL-(cmcm) >>
2024-06-13 17:21:32:INFO:M: >>  Has0_acc_2: 0.6987  Has0_F1_score: 0.6965  Non0_acc_2: 0.6759  Non0_F1_score: 0.6749  Mult_acc_5: 0.3668  Mult_acc_7: 0.2926  MAE: 1.2127  Corr: 0.4438 
2024-06-13 17:21:47:INFO:TRAIN-(cmcm) (10/36/3)>> loss: 0.5301
2024-06-13 17:21:49:INFO:VAL-(cmcm) >>
2024-06-13 17:21:49:INFO:M: >>  Has0_acc_2: 0.7031  Has0_F1_score: 0.6998  Non0_acc_2: 0.6806  Non0_F1_score: 0.6803  Mult_acc_5: 0.3843  Mult_acc_7: 0.3144  MAE: 1.2320  Corr: 0.4369 
2024-06-13 17:21:57:INFO:TEST-(cmcm) >>
2024-06-13 17:21:57:INFO:M: >>  Has0_acc_2: 0.6924  Has0_F1_score: 0.6932  Non0_acc_2: 0.6936  Non0_F1_score: 0.6940  Mult_acc_5: 0.2886  Mult_acc_7: 0.2595  MAE: 1.2143  Corr: 0.4304 
2024-06-13 17:21:57:INFO:Results are added to results/results/mosi-regression-40.csv...
2024-06-13 17:21:57:INFO:Start running cmcm...
2024-06-13 17:21:57:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 6, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 40, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 4444}>
2024-06-13 17:21:57:INFO:Let's use the GPU 1 !
2024-06-13 17:21:57:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 17:21:58:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718270518 HTTP/1.1" 200 235
2024-06-13 17:21:58:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 17:21:58:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 17:21:59:INFO:train samples: (1284,)
2024-06-13 17:21:59:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 17:22:00:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718270520 HTTP/1.1" 200 235
2024-06-13 17:22:00:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 17:22:01:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 17:22:01:INFO:valid samples: (229,)
2024-06-13 17:22:01:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 17:22:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718270522 HTTP/1.1" 200 235
2024-06-13 17:22:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 17:22:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 17:22:03:INFO:test samples: (686,)
2024-06-13 17:22:03:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 17:22:03:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718270523 HTTP/1.1" 200 235
2024-06-13 17:22:03:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 17:22:04:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 17:22:04:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 17:22:05:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718270525 HTTP/1.1" 200 235
2024-06-13 17:22:05:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 17:22:05:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 17:22:05:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-13 17:22:05:WARNING:Try importing flash-attention for faster inference...
2024-06-13 17:22:05:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-13 17:22:05:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-13 17:22:05:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-13 17:22:07:INFO:trainable params: 1310288 || all params: 1838138960 || trainable%: 0.07128340286090232
2024-06-13 17:22:07:INFO:Init labels...
2024-06-13 17:22:07:INFO:Start training...
2024-06-13 17:22:22:INFO:TRAIN-(cmcm) (1/1/4)>> loss: 2.4083
2024-06-13 17:22:24:INFO:VAL-(cmcm) >>
2024-06-13 17:22:24:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5734  Non0_acc_2: 0.5926  Non0_F1_score: 0.5689  Mult_acc_5: 0.1965  Mult_acc_7: 0.1921  MAE: 1.5781  Corr: 0.0949 
2024-06-13 17:22:25:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-13 17:22:40:INFO:TRAIN-(cmcm) (1/2/4)>> loss: 1.0037
2024-06-13 17:22:43:INFO:VAL-(cmcm) >>
2024-06-13 17:22:43:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4556  Non0_acc_2: 0.5741  Non0_F1_score: 0.4269  Mult_acc_5: 0.1921  Mult_acc_7: 0.1878  MAE: 1.5619  Corr: -0.0567 
2024-06-13 17:22:43:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-13 17:22:59:INFO:TRAIN-(cmcm) (1/3/4)>> loss: 0.9705
2024-06-13 17:23:01:INFO:VAL-(cmcm) >>
2024-06-13 17:23:01:INFO:M: >>  Has0_acc_2: 0.5022  Has0_F1_score: 0.4726  Non0_acc_2: 0.5139  Non0_F1_score: 0.4815  Mult_acc_5: 0.1965  Mult_acc_7: 0.1747  MAE: 1.7340  Corr: 0.0905 
2024-06-13 17:23:16:INFO:TRAIN-(cmcm) (2/4/4)>> loss: 0.9151
2024-06-13 17:23:19:INFO:VAL-(cmcm) >>
2024-06-13 17:23:19:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5684  Non0_acc_2: 0.5741  Non0_F1_score: 0.5679  Mult_acc_5: 0.1965  Mult_acc_7: 0.1965  MAE: 1.5314  Corr: 0.0651 
2024-06-13 17:23:19:INFO:Saving checkpoint at epoch 4 to results/models/cmcm-mosi-regression.pth.
2024-06-13 17:23:35:INFO:TRAIN-(cmcm) (1/5/4)>> loss: 0.9110
2024-06-13 17:23:37:INFO:VAL-(cmcm) >>
2024-06-13 17:23:37:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4534  Non0_acc_2: 0.5694  Non0_F1_score: 0.4246  Mult_acc_5: 0.1616  Mult_acc_7: 0.1616  MAE: 1.5279  Corr: -0.0555 
2024-06-13 17:23:38:INFO:Saving checkpoint at epoch 5 to results/models/cmcm-mosi-regression.pth.
2024-06-13 17:23:53:INFO:TRAIN-(cmcm) (1/6/4)>> loss: 0.8839
2024-06-13 17:23:56:INFO:VAL-(cmcm) >>
2024-06-13 17:23:56:INFO:M: >>  Has0_acc_2: 0.6157  Has0_F1_score: 0.4930  Non0_acc_2: 0.5926  Non0_F1_score: 0.4663  Mult_acc_5: 0.3100  Mult_acc_7: 0.2183  MAE: 1.6228  Corr: 0.1424 
2024-06-13 17:24:11:INFO:TRAIN-(cmcm) (2/7/4)>> loss: 0.8882
2024-06-13 17:24:14:INFO:VAL-(cmcm) >>
2024-06-13 17:24:14:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.5005  Non0_acc_2: 0.5741  Non0_F1_score: 0.4742  Mult_acc_5: 0.1747  Mult_acc_7: 0.1747  MAE: 1.5301  Corr: 0.0569 
2024-06-13 17:24:29:INFO:TRAIN-(cmcm) (3/8/4)>> loss: 0.8870
2024-06-13 17:24:31:INFO:VAL-(cmcm) >>
2024-06-13 17:24:31:INFO:M: >>  Has0_acc_2: 0.5633  Has0_F1_score: 0.4969  Non0_acc_2: 0.5463  Non0_F1_score: 0.4764  Mult_acc_5: 0.1572  Mult_acc_7: 0.1485  MAE: 1.6616  Corr: 0.0002 
2024-06-13 17:24:46:INFO:TRAIN-(cmcm) (4/9/4)>> loss: 0.8724
2024-06-13 17:24:49:INFO:VAL-(cmcm) >>
2024-06-13 17:24:49:INFO:M: >>  Has0_acc_2: 0.6681  Has0_F1_score: 0.6696  Non0_acc_2: 0.5926  Non0_F1_score: 0.5644  Mult_acc_5: 0.1965  Mult_acc_7: 0.1965  MAE: 1.3606  Corr: 0.3431 
2024-06-13 17:24:49:INFO:Saving checkpoint at epoch 9 to results/models/cmcm-mosi-regression.pth.
2024-06-13 17:25:05:INFO:TRAIN-(cmcm) (1/10/4)>> loss: 0.8565
2024-06-13 17:25:07:INFO:VAL-(cmcm) >>
2024-06-13 17:25:07:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.5629  Non0_acc_2: 0.5972  Non0_F1_score: 0.5574  Mult_acc_5: 0.2358  Mult_acc_7: 0.1878  MAE: 1.5983  Corr: 0.1220 
2024-06-13 17:25:22:INFO:TRAIN-(cmcm) (2/11/4)>> loss: 0.8436
2024-06-13 17:25:25:INFO:VAL-(cmcm) >>
2024-06-13 17:25:25:INFO:M: >>  Has0_acc_2: 0.6376  Has0_F1_score: 0.5936  Non0_acc_2: 0.6250  Non0_F1_score: 0.5791  Mult_acc_5: 0.3362  Mult_acc_7: 0.2445  MAE: 1.5468  Corr: 0.2461 
2024-06-13 17:25:40:INFO:TRAIN-(cmcm) (3/12/4)>> loss: 0.8375
2024-06-13 17:25:42:INFO:VAL-(cmcm) >>
2024-06-13 17:25:42:INFO:M: >>  Has0_acc_2: 0.6419  Has0_F1_score: 0.6027  Non0_acc_2: 0.6389  Non0_F1_score: 0.5991  Mult_acc_5: 0.3275  Mult_acc_7: 0.2445  MAE: 1.4699  Corr: 0.3034 
2024-06-13 17:25:57:INFO:TRAIN-(cmcm) (4/13/4)>> loss: 0.8381
2024-06-13 17:26:00:INFO:VAL-(cmcm) >>
2024-06-13 17:26:00:INFO:M: >>  Has0_acc_2: 0.6507  Has0_F1_score: 0.6222  Non0_acc_2: 0.6528  Non0_F1_score: 0.6316  Mult_acc_5: 0.3013  Mult_acc_7: 0.2271  MAE: 1.3018  Corr: 0.4071 
2024-06-13 17:26:01:INFO:Saving checkpoint at epoch 13 to results/models/cmcm-mosi-regression.pth.
2024-06-13 17:26:16:INFO:TRAIN-(cmcm) (1/14/4)>> loss: 0.8170
2024-06-13 17:26:18:INFO:VAL-(cmcm) >>
2024-06-13 17:26:18:INFO:M: >>  Has0_acc_2: 0.6900  Has0_F1_score: 0.6877  Non0_acc_2: 0.7083  Non0_F1_score: 0.7066  Mult_acc_5: 0.3581  Mult_acc_7: 0.2838  MAE: 1.2184  Corr: 0.4591 
2024-06-13 17:26:19:INFO:Saving checkpoint at epoch 14 to results/models/cmcm-mosi-regression.pth.
2024-06-13 17:26:34:INFO:TRAIN-(cmcm) (1/15/4)>> loss: 0.8012
2024-06-13 17:26:37:INFO:VAL-(cmcm) >>
2024-06-13 17:26:37:INFO:M: >>  Has0_acc_2: 0.6943  Has0_F1_score: 0.6796  Non0_acc_2: 0.6991  Non0_F1_score: 0.6867  Mult_acc_5: 0.3624  Mult_acc_7: 0.2707  MAE: 1.3210  Corr: 0.4262 
2024-06-13 17:26:52:INFO:TRAIN-(cmcm) (2/16/4)>> loss: 0.7886
2024-06-13 17:26:54:INFO:VAL-(cmcm) >>
2024-06-13 17:26:54:INFO:M: >>  Has0_acc_2: 0.6943  Has0_F1_score: 0.6964  Non0_acc_2: 0.7037  Non0_F1_score: 0.7044  Mult_acc_5: 0.3493  Mult_acc_7: 0.2751  MAE: 1.1826  Corr: 0.4910 
2024-06-13 17:26:55:INFO:Saving checkpoint at epoch 16 to results/models/cmcm-mosi-regression.pth.
2024-06-13 17:27:10:INFO:TRAIN-(cmcm) (1/17/4)>> loss: 0.7916
2024-06-13 17:27:13:INFO:VAL-(cmcm) >>
2024-06-13 17:27:13:INFO:M: >>  Has0_acc_2: 0.6987  Has0_F1_score: 0.7015  Non0_acc_2: 0.7130  Non0_F1_score: 0.7143  Mult_acc_5: 0.3406  Mult_acc_7: 0.2664  MAE: 1.2795  Corr: 0.4672 
2024-06-13 17:27:28:INFO:TRAIN-(cmcm) (2/18/4)>> loss: 0.7717
2024-06-13 17:27:30:INFO:VAL-(cmcm) >>
2024-06-13 17:27:30:INFO:M: >>  Has0_acc_2: 0.6376  Has0_F1_score: 0.5874  Non0_acc_2: 0.7083  Non0_F1_score: 0.6950  Mult_acc_5: 0.3668  Mult_acc_7: 0.2751  MAE: 1.2424  Corr: 0.4818 
2024-06-13 17:27:45:INFO:TRAIN-(cmcm) (3/19/4)>> loss: 0.7599
2024-06-13 17:27:48:INFO:VAL-(cmcm) >>
2024-06-13 17:27:48:INFO:M: >>  Has0_acc_2: 0.6681  Has0_F1_score: 0.6644  Non0_acc_2: 0.6852  Non0_F1_score: 0.6836  Mult_acc_5: 0.3275  Mult_acc_7: 0.2838  MAE: 1.1970  Corr: 0.4250 
2024-06-13 17:28:03:INFO:TRAIN-(cmcm) (4/20/4)>> loss: 0.7475
2024-06-13 17:28:06:INFO:VAL-(cmcm) >>
2024-06-13 17:28:06:INFO:M: >>  Has0_acc_2: 0.6638  Has0_F1_score: 0.6230  Non0_acc_2: 0.6435  Non0_F1_score: 0.6288  Mult_acc_5: 0.3319  Mult_acc_7: 0.2795  MAE: 1.2704  Corr: 0.3893 
2024-06-13 17:28:21:INFO:TRAIN-(cmcm) (5/21/4)>> loss: 0.7488
2024-06-13 17:28:23:INFO:VAL-(cmcm) >>
2024-06-13 17:28:23:INFO:M: >>  Has0_acc_2: 0.6943  Has0_F1_score: 0.6892  Non0_acc_2: 0.7083  Non0_F1_score: 0.7037  Mult_acc_5: 0.3668  Mult_acc_7: 0.2882  MAE: 1.2761  Corr: 0.4284 
2024-06-13 17:28:38:INFO:TRAIN-(cmcm) (6/22/4)>> loss: 0.7321
2024-06-13 17:28:41:INFO:VAL-(cmcm) >>
2024-06-13 17:28:41:INFO:M: >>  Has0_acc_2: 0.7380  Has0_F1_score: 0.7364  Non0_acc_2: 0.7639  Non0_F1_score: 0.7620  Mult_acc_5: 0.3275  Mult_acc_7: 0.2533  MAE: 1.2267  Corr: 0.4509 
2024-06-13 17:28:56:INFO:TRAIN-(cmcm) (7/23/4)>> loss: 0.7204
2024-06-13 17:28:58:INFO:VAL-(cmcm) >>
2024-06-13 17:28:58:INFO:M: >>  Has0_acc_2: 0.6638  Has0_F1_score: 0.6484  Non0_acc_2: 0.6944  Non0_F1_score: 0.6861  Mult_acc_5: 0.2969  Mult_acc_7: 0.2314  MAE: 1.2795  Corr: 0.4158 
2024-06-13 17:29:13:INFO:TRAIN-(cmcm) (8/24/4)>> loss: 0.7120
2024-06-13 17:29:16:INFO:VAL-(cmcm) >>
2024-06-13 17:29:16:INFO:M: >>  Has0_acc_2: 0.7074  Has0_F1_score: 0.7101  Non0_acc_2: 0.7222  Non0_F1_score: 0.7235  Mult_acc_5: 0.3624  Mult_acc_7: 0.2838  MAE: 1.2302  Corr: 0.4833 
2024-06-13 17:29:31:INFO:TRAIN-(cmcm) (9/25/4)>> loss: 0.6927
2024-06-13 17:29:33:INFO:VAL-(cmcm) >>
2024-06-13 17:29:33:INFO:M: >>  Has0_acc_2: 0.7162  Has0_F1_score: 0.7057  Non0_acc_2: 0.6944  Non0_F1_score: 0.6882  Mult_acc_5: 0.3493  Mult_acc_7: 0.2620  MAE: 1.3018  Corr: 0.4341 
2024-06-13 17:29:48:INFO:TRAIN-(cmcm) (10/26/4)>> loss: 0.6796
2024-06-13 17:29:51:INFO:VAL-(cmcm) >>
2024-06-13 17:29:51:INFO:M: >>  Has0_acc_2: 0.7162  Has0_F1_score: 0.7173  Non0_acc_2: 0.7315  Non0_F1_score: 0.7324  Mult_acc_5: 0.3188  Mult_acc_7: 0.2533  MAE: 1.1991  Corr: 0.4711 
2024-06-13 17:29:58:INFO:TEST-(cmcm) >>
2024-06-13 17:29:58:INFO:M: >>  Has0_acc_2: 0.6953  Has0_F1_score: 0.6934  Non0_acc_2: 0.7104  Non0_F1_score: 0.7096  Mult_acc_5: 0.2857  Mult_acc_7: 0.2536  MAE: 1.2118  Corr: 0.4209 
2024-06-13 17:29:59:INFO:Results are added to results/results/mosi-regression-40.csv...
2024-06-13 17:29:59:INFO:Start running cmcm...
2024-06-13 17:29:59:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 6, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 40, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 5555}>
2024-06-13 17:29:59:INFO:Let's use the GPU 1 !
2024-06-13 17:29:59:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 17:29:59:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718270999 HTTP/1.1" 200 235
2024-06-13 17:29:59:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 17:30:00:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 17:30:00:INFO:train samples: (1284,)
2024-06-13 17:30:01:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 17:30:01:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718271001 HTTP/1.1" 200 235
2024-06-13 17:30:01:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 17:30:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 17:30:02:INFO:valid samples: (229,)
2024-06-13 17:30:02:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 17:30:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718271003 HTTP/1.1" 200 235
2024-06-13 17:30:03:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 17:30:03:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 17:30:04:INFO:test samples: (686,)
2024-06-13 17:30:04:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 17:30:04:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718271004 HTTP/1.1" 200 235
2024-06-13 17:30:04:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 17:30:05:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 17:30:05:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 17:30:05:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718271006 HTTP/1.1" 200 235
2024-06-13 17:30:06:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 17:30:06:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 17:30:06:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-13 17:30:06:WARNING:Try importing flash-attention for faster inference...
2024-06-13 17:30:06:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-13 17:30:06:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-13 17:30:06:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-13 17:30:07:INFO:trainable params: 1310288 || all params: 1838138960 || trainable%: 0.07128340286090232
2024-06-13 17:30:07:INFO:Init labels...
2024-06-13 17:30:07:INFO:Start training...
2024-06-13 17:30:22:INFO:TRAIN-(cmcm) (1/1/5)>> loss: 1.8029
2024-06-13 17:30:25:INFO:VAL-(cmcm) >>
2024-06-13 17:30:25:INFO:M: >>  Has0_acc_2: 0.5284  Has0_F1_score: 0.5321  Non0_acc_2: 0.5417  Non0_F1_score: 0.5437  Mult_acc_5: 0.1834  Mult_acc_7: 0.1834  MAE: 1.5798  Corr: 0.0857 
2024-06-13 17:30:25:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-13 17:30:41:INFO:TRAIN-(cmcm) (1/2/5)>> loss: 1.7342
2024-06-13 17:30:43:INFO:VAL-(cmcm) >>
2024-06-13 17:30:43:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.5527  Non0_acc_2: 0.5556  Non0_F1_score: 0.5272  Mult_acc_5: 0.1834  Mult_acc_7: 0.1834  MAE: 1.5440  Corr: 0.0141 
2024-06-13 17:30:44:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-13 17:30:59:INFO:TRAIN-(cmcm) (1/3/5)>> loss: 0.9452
2024-06-13 17:31:02:INFO:VAL-(cmcm) >>
2024-06-13 17:31:02:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4630  Non0_acc_2: 0.5741  Non0_F1_score: 0.4346  Mult_acc_5: 0.2140  Mult_acc_7: 0.1747  MAE: 1.5541  Corr: -0.0329 
2024-06-13 17:31:17:INFO:TRAIN-(cmcm) (2/4/5)>> loss: 0.9003
2024-06-13 17:31:19:INFO:VAL-(cmcm) >>
2024-06-13 17:31:19:INFO:M: >>  Has0_acc_2: 0.5633  Has0_F1_score: 0.4571  Non0_acc_2: 0.5417  Non0_F1_score: 0.4310  Mult_acc_5: 0.2489  Mult_acc_7: 0.2009  MAE: 1.6851  Corr: -0.0536 
2024-06-13 17:31:34:INFO:TRAIN-(cmcm) (3/5/5)>> loss: 0.8865
2024-06-13 17:31:37:INFO:VAL-(cmcm) >>
2024-06-13 17:31:37:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.5317  Non0_acc_2: 0.5278  Non0_F1_score: 0.5027  Mult_acc_5: 0.2227  Mult_acc_7: 0.2052  MAE: 1.6590  Corr: -0.0262 
2024-06-13 17:31:52:INFO:TRAIN-(cmcm) (4/6/5)>> loss: 0.8701
2024-06-13 17:31:54:INFO:VAL-(cmcm) >>
2024-06-13 17:31:54:INFO:M: >>  Has0_acc_2: 0.5415  Has0_F1_score: 0.5381  Non0_acc_2: 0.5417  Non0_F1_score: 0.5357  Mult_acc_5: 0.1747  Mult_acc_7: 0.1747  MAE: 1.6239  Corr: 0.0032 
2024-06-13 17:32:10:INFO:TRAIN-(cmcm) (5/7/5)>> loss: 0.8684
2024-06-13 17:32:12:INFO:VAL-(cmcm) >>
2024-06-13 17:32:12:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.4746  Non0_acc_2: 0.5185  Non0_F1_score: 0.5185  Mult_acc_5: 0.1703  Mult_acc_7: 0.1703  MAE: 1.4707  Corr: -0.0143 
2024-06-13 17:32:13:INFO:Saving checkpoint at epoch 7 to results/models/cmcm-mosi-regression.pth.
2024-06-13 17:32:28:INFO:TRAIN-(cmcm) (1/8/5)>> loss: 0.8685
2024-06-13 17:32:31:INFO:VAL-(cmcm) >>
2024-06-13 17:32:31:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.4534  Non0_acc_2: 0.5463  Non0_F1_score: 0.4271  Mult_acc_5: 0.2664  Mult_acc_7: 0.2183  MAE: 1.7218  Corr: -0.0631 
2024-06-13 17:32:46:INFO:TRAIN-(cmcm) (2/9/5)>> loss: 0.8623
2024-06-13 17:32:48:INFO:VAL-(cmcm) >>
2024-06-13 17:32:48:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.4596  Non0_acc_2: 0.5417  Non0_F1_score: 0.4310  Mult_acc_5: 0.2795  Mult_acc_7: 0.2009  MAE: 1.8376  Corr: -0.0813 
2024-06-13 17:33:03:INFO:TRAIN-(cmcm) (3/10/5)>> loss: 0.8645
2024-06-13 17:33:06:INFO:VAL-(cmcm) >>
2024-06-13 17:33:06:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.4780  Non0_acc_2: 0.5694  Non0_F1_score: 0.4595  Mult_acc_5: 0.2926  Mult_acc_7: 0.2271  MAE: 1.6493  Corr: 0.0057 
2024-06-13 17:33:21:INFO:TRAIN-(cmcm) (4/11/5)>> loss: 0.8583
2024-06-13 17:33:23:INFO:VAL-(cmcm) >>
2024-06-13 17:33:23:INFO:M: >>  Has0_acc_2: 0.5502  Has0_F1_score: 0.5091  Non0_acc_2: 0.4583  Non0_F1_score: 0.4453  Mult_acc_5: 0.1965  Mult_acc_7: 0.1921  MAE: 1.4781  Corr: -0.0251 
2024-06-13 17:33:38:INFO:TRAIN-(cmcm) (5/12/5)>> loss: 0.8545
2024-06-13 17:33:41:INFO:VAL-(cmcm) >>
2024-06-13 17:33:41:INFO:M: >>  Has0_acc_2: 0.5633  Has0_F1_score: 0.5463  Non0_acc_2: 0.5556  Non0_F1_score: 0.5362  Mult_acc_5: 0.2445  Mult_acc_7: 0.2140  MAE: 1.6301  Corr: 0.0091 
2024-06-13 17:33:56:INFO:TRAIN-(cmcm) (6/13/5)>> loss: 0.8568
2024-06-13 17:33:59:INFO:VAL-(cmcm) >>
2024-06-13 17:33:59:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4700  Non0_acc_2: 0.5741  Non0_F1_score: 0.4420  Mult_acc_5: 0.2969  Mult_acc_7: 0.2140  MAE: 1.7669  Corr: -0.0157 
2024-06-13 17:34:14:INFO:TRAIN-(cmcm) (7/14/5)>> loss: 0.8519
2024-06-13 17:34:16:INFO:VAL-(cmcm) >>
2024-06-13 17:34:16:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4830  Non0_acc_2: 0.5694  Non0_F1_score: 0.4768  Mult_acc_5: 0.2140  Mult_acc_7: 0.1747  MAE: 1.5729  Corr: 0.0420 
2024-06-13 17:34:31:INFO:TRAIN-(cmcm) (8/15/5)>> loss: 0.8477
2024-06-13 17:34:34:INFO:VAL-(cmcm) >>
2024-06-13 17:34:34:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5741  Non0_F1_score: 0.4187  Mult_acc_5: 0.2969  Mult_acc_7: 0.2140  MAE: 1.7005  Corr: -0.0346 
2024-06-13 17:34:49:INFO:TRAIN-(cmcm) (9/16/5)>> loss: 0.8482
2024-06-13 17:34:51:INFO:VAL-(cmcm) >>
2024-06-13 17:34:51:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4976  Non0_acc_2: 0.5787  Non0_F1_score: 0.4711  Mult_acc_5: 0.2358  Mult_acc_7: 0.1616  MAE: 1.6900  Corr: 0.0272 
2024-06-13 17:35:06:INFO:TRAIN-(cmcm) (10/17/5)>> loss: 0.8415
2024-06-13 17:35:09:INFO:VAL-(cmcm) >>
2024-06-13 17:35:09:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.5158  Non0_acc_2: 0.5880  Non0_F1_score: 0.5441  Mult_acc_5: 0.2533  Mult_acc_7: 0.1834  MAE: 1.5691  Corr: 0.0727 
2024-06-13 17:35:16:INFO:TEST-(cmcm) >>
2024-06-13 17:35:16:INFO:M: >>  Has0_acc_2: 0.4461  Has0_F1_score: 0.3112  Non0_acc_2: 0.4390  Non0_F1_score: 0.4291  Mult_acc_5: 0.1691  Mult_acc_7: 0.1691  MAE: 1.5793  Corr: -0.0557 
2024-06-13 17:35:17:INFO:Results are added to results/results/mosi-regression-40.csv...
2024-06-13 17:35:17:INFO:Start running cmcm...
2024-06-13 17:35:17:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 6, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 50, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-06-13 17:35:17:INFO:Let's use the GPU 1 !
2024-06-13 17:35:17:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 17:35:17:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718271317 HTTP/1.1" 200 235
2024-06-13 17:35:17:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 17:35:18:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 17:35:18:INFO:train samples: (1284,)
2024-06-13 17:35:19:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 17:35:19:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718271319 HTTP/1.1" 200 235
2024-06-13 17:35:19:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 17:35:19:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 17:35:20:INFO:valid samples: (229,)
2024-06-13 17:35:20:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 17:35:20:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718271321 HTTP/1.1" 200 235
2024-06-13 17:35:21:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 17:35:21:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 17:35:22:INFO:test samples: (686,)
2024-06-13 17:35:22:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 17:35:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718271322 HTTP/1.1" 200 235
2024-06-13 17:35:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 17:35:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 17:35:23:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 17:35:23:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718271323 HTTP/1.1" 200 235
2024-06-13 17:35:23:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 17:35:24:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 17:35:24:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-13 17:35:24:WARNING:Try importing flash-attention for faster inference...
2024-06-13 17:35:24:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-13 17:35:24:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-13 17:35:24:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-13 17:35:25:INFO:trainable params: 1310288 || all params: 1838138960 || trainable%: 0.07128340286090232
2024-06-13 17:35:25:INFO:Init labels...
2024-06-13 17:35:25:INFO:Start training...
2024-06-13 17:35:40:INFO:TRAIN-(cmcm) (1/1/1)>> loss: 2.0200
2024-06-13 17:35:43:INFO:VAL-(cmcm) >>
2024-06-13 17:35:43:INFO:M: >>  Has0_acc_2: 0.4017  Has0_F1_score: 0.2303  Non0_acc_2: 0.4259  Non0_F1_score: 0.2544  Mult_acc_5: 0.2140  Mult_acc_7: 0.2140  MAE: 1.4763  Corr: nan 
2024-06-13 17:35:43:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-13 17:35:58:INFO:TRAIN-(cmcm) (1/2/1)>> loss: 0.8996
2024-06-13 17:36:01:INFO:VAL-(cmcm) >>
2024-06-13 17:36:01:INFO:M: >>  Has0_acc_2: 0.4017  Has0_F1_score: 0.2303  Non0_acc_2: 0.4259  Non0_F1_score: 0.2544  Mult_acc_5: 0.1878  Mult_acc_7: 0.1485  MAE: 2.0432  Corr: 0.0075 
2024-06-13 17:36:16:INFO:TRAIN-(cmcm) (2/3/1)>> loss: 0.8880
2024-06-13 17:36:18:INFO:VAL-(cmcm) >>
2024-06-13 17:36:18:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.4674  Non0_acc_2: 0.5833  Non0_F1_score: 0.4393  Mult_acc_5: 0.1747  Mult_acc_7: 0.1747  MAE: 1.5209  Corr: -0.0151 
2024-06-13 17:36:33:INFO:TRAIN-(cmcm) (3/4/1)>> loss: 0.9491
2024-06-13 17:36:36:INFO:VAL-(cmcm) >>
2024-06-13 17:36:36:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5741  Non0_F1_score: 0.4187  Mult_acc_5: 0.1834  Mult_acc_7: 0.1790  MAE: 1.5113  Corr: -0.0121 
2024-06-13 17:36:51:INFO:TRAIN-(cmcm) (4/5/1)>> loss: 0.8835
2024-06-13 17:36:54:INFO:VAL-(cmcm) >>
2024-06-13 17:36:54:INFO:M: >>  Has0_acc_2: 0.5066  Has0_F1_score: 0.5105  Non0_acc_2: 0.5093  Non0_F1_score: 0.5109  Mult_acc_5: 0.1878  Mult_acc_7: 0.1878  MAE: 1.6222  Corr: -0.0146 
2024-06-13 17:37:09:INFO:TRAIN-(cmcm) (5/6/1)>> loss: 0.8817
2024-06-13 17:37:11:INFO:VAL-(cmcm) >>
2024-06-13 17:37:11:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.4920  Non0_acc_2: 0.5509  Non0_F1_score: 0.4651  Mult_acc_5: 0.2838  Mult_acc_7: 0.2052  MAE: 1.8132  Corr: -0.0423 
2024-06-13 17:37:26:INFO:TRAIN-(cmcm) (6/7/1)>> loss: 0.8639
2024-06-13 17:37:29:INFO:VAL-(cmcm) >>
2024-06-13 17:37:29:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4723  Non0_acc_2: 0.5787  Non0_F1_score: 0.4445  Mult_acc_5: 0.2183  Mult_acc_7: 0.2096  MAE: 1.5835  Corr: 0.0057 
2024-06-13 17:37:44:INFO:TRAIN-(cmcm) (7/8/1)>> loss: 0.8670
2024-06-13 17:37:46:INFO:VAL-(cmcm) >>
2024-06-13 17:37:46:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4950  Non0_acc_2: 0.5741  Non0_F1_score: 0.4683  Mult_acc_5: 0.2314  Mult_acc_7: 0.2227  MAE: 1.5659  Corr: 0.0050 
2024-06-13 17:38:01:INFO:TRAIN-(cmcm) (8/9/1)>> loss: 0.8623
2024-06-13 17:38:04:INFO:VAL-(cmcm) >>
2024-06-13 17:38:04:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4630  Non0_acc_2: 0.5741  Non0_F1_score: 0.4346  Mult_acc_5: 0.2751  Mult_acc_7: 0.2009  MAE: 1.6887  Corr: -0.0003 
2024-06-13 17:38:19:INFO:TRAIN-(cmcm) (9/10/1)>> loss: 0.8610
2024-06-13 17:38:21:INFO:VAL-(cmcm) >>
2024-06-13 17:38:21:INFO:M: >>  Has0_acc_2: 0.5590  Has0_F1_score: 0.5156  Non0_acc_2: 0.5463  Non0_F1_score: 0.4997  Mult_acc_5: 0.2926  Mult_acc_7: 0.2096  MAE: 1.7765  Corr: 0.0021 
2024-06-13 17:38:36:INFO:TRAIN-(cmcm) (10/11/1)>> loss: 0.8635
2024-06-13 17:38:39:INFO:VAL-(cmcm) >>
2024-06-13 17:38:39:INFO:M: >>  Has0_acc_2: 0.5633  Has0_F1_score: 0.5048  Non0_acc_2: 0.5509  Non0_F1_score: 0.4881  Mult_acc_5: 0.2751  Mult_acc_7: 0.1921  MAE: 1.8237  Corr: -0.0069 
2024-06-13 17:38:46:INFO:TEST-(cmcm) >>
2024-06-13 17:38:46:INFO:M: >>  Has0_acc_2: 0.5539  Has0_F1_score: 0.3965  Non0_acc_2: 0.5777  Non0_F1_score: 0.4231  Mult_acc_5: 0.1545  Mult_acc_7: 0.1545  MAE: 1.3964  Corr: 0.0251 
2024-06-13 17:38:47:INFO:Results are added to results/results/mosi-regression-50.csv...
2024-06-13 17:38:47:INFO:Start running cmcm...
2024-06-13 17:38:47:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 6, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 50, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 2222}>
2024-06-13 17:38:47:INFO:Let's use the GPU 1 !
2024-06-13 17:38:47:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 17:38:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718271527 HTTP/1.1" 200 235
2024-06-13 17:38:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 17:38:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 17:38:49:INFO:train samples: (1284,)
2024-06-13 17:38:49:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 17:38:49:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718271529 HTTP/1.1" 200 235
2024-06-13 17:38:49:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 17:38:50:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 17:38:50:INFO:valid samples: (229,)
2024-06-13 17:38:50:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 17:38:51:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718271531 HTTP/1.1" 200 235
2024-06-13 17:38:51:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 17:38:51:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 17:38:52:INFO:test samples: (686,)
2024-06-13 17:38:52:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 17:38:52:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718271532 HTTP/1.1" 200 235
2024-06-13 17:38:52:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 17:38:53:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 17:38:53:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 17:38:53:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718271534 HTTP/1.1" 200 235
2024-06-13 17:38:54:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 17:38:54:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 17:38:54:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-13 17:38:54:WARNING:Try importing flash-attention for faster inference...
2024-06-13 17:38:54:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-13 17:38:54:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-13 17:38:54:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-13 17:38:55:INFO:trainable params: 1310288 || all params: 1838138960 || trainable%: 0.07128340286090232
2024-06-13 17:38:55:INFO:Init labels...
2024-06-13 17:38:55:INFO:Start training...
2024-06-13 17:39:10:INFO:TRAIN-(cmcm) (1/1/2)>> loss: 2.1448
2024-06-13 17:39:13:INFO:VAL-(cmcm) >>
2024-06-13 17:39:13:INFO:M: >>  Has0_acc_2: 0.4847  Has0_F1_score: 0.4743  Non0_acc_2: 0.4907  Non0_F1_score: 0.4759  Mult_acc_5: 0.1747  Mult_acc_7: 0.1747  MAE: 1.5816  Corr: -0.0106 
2024-06-13 17:39:13:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-13 17:39:28:INFO:TRAIN-(cmcm) (1/2/2)>> loss: 0.9848
2024-06-13 17:39:31:INFO:VAL-(cmcm) >>
2024-06-13 17:39:31:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4723  Non0_acc_2: 0.5787  Non0_F1_score: 0.4445  Mult_acc_5: 0.2052  Mult_acc_7: 0.1921  MAE: 1.5296  Corr: -0.0044 
2024-06-13 17:39:32:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-13 17:39:47:INFO:TRAIN-(cmcm) (1/3/2)>> loss: 0.9459
2024-06-13 17:39:49:INFO:VAL-(cmcm) >>
2024-06-13 17:39:49:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5231  Non0_acc_2: 0.5694  Non0_F1_score: 0.5010  Mult_acc_5: 0.2751  Mult_acc_7: 0.1965  MAE: 1.6490  Corr: 0.0188 
2024-06-13 17:40:04:INFO:TRAIN-(cmcm) (2/4/2)>> loss: 0.9164
2024-06-13 17:40:07:INFO:VAL-(cmcm) >>
2024-06-13 17:40:07:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5147  Non0_acc_2: 0.5556  Non0_F1_score: 0.4954  Mult_acc_5: 0.2926  Mult_acc_7: 0.2096  MAE: 1.7704  Corr: 0.0219 
2024-06-13 17:40:22:INFO:TRAIN-(cmcm) (3/5/2)>> loss: 0.9095
2024-06-13 17:40:24:INFO:VAL-(cmcm) >>
2024-06-13 17:40:24:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.5311  Non0_acc_2: 0.5509  Non0_F1_score: 0.5127  Mult_acc_5: 0.2009  Mult_acc_7: 0.2009  MAE: 1.5477  Corr: 0.0042 
2024-06-13 17:40:39:INFO:TRAIN-(cmcm) (4/6/2)>> loss: 0.8902
2024-06-13 17:40:42:INFO:VAL-(cmcm) >>
2024-06-13 17:40:42:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5424  Non0_acc_2: 0.5602  Non0_F1_score: 0.5283  Mult_acc_5: 0.1878  Mult_acc_7: 0.1878  MAE: 1.5983  Corr: 0.0473 
2024-06-13 17:40:57:INFO:TRAIN-(cmcm) (5/7/2)>> loss: 0.8909
2024-06-13 17:40:59:INFO:VAL-(cmcm) >>
2024-06-13 17:40:59:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5710  Non0_acc_2: 0.5741  Non0_F1_score: 0.5625  Mult_acc_5: 0.2227  Mult_acc_7: 0.2096  MAE: 1.6023  Corr: 0.0747 
2024-06-13 17:41:14:INFO:TRAIN-(cmcm) (6/8/2)>> loss: 0.8745
2024-06-13 17:41:17:INFO:VAL-(cmcm) >>
2024-06-13 17:41:17:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4742  Non0_acc_2: 0.5694  Non0_F1_score: 0.4465  Mult_acc_5: 0.3057  Mult_acc_7: 0.2227  MAE: 1.7084  Corr: 0.0465 
2024-06-13 17:41:32:INFO:TRAIN-(cmcm) (7/9/2)>> loss: 0.8766
2024-06-13 17:41:34:INFO:VAL-(cmcm) >>
2024-06-13 17:41:34:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5175  Non0_acc_2: 0.5787  Non0_F1_score: 0.4982  Mult_acc_5: 0.3013  Mult_acc_7: 0.2227  MAE: 1.7416  Corr: 0.0268 
2024-06-13 17:41:49:INFO:TRAIN-(cmcm) (8/10/2)>> loss: 0.8731
2024-06-13 17:41:52:INFO:VAL-(cmcm) >>
2024-06-13 17:41:52:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.5750  Non0_acc_2: 0.6019  Non0_F1_score: 0.5666  Mult_acc_5: 0.3100  Mult_acc_7: 0.2183  MAE: 1.6691  Corr: 0.1368 
2024-06-13 17:42:07:INFO:TRAIN-(cmcm) (9/11/2)>> loss: 0.8595
2024-06-13 17:42:09:INFO:VAL-(cmcm) >>
2024-06-13 17:42:09:INFO:M: >>  Has0_acc_2: 0.6376  Has0_F1_score: 0.5771  Non0_acc_2: 0.6343  Non0_F1_score: 0.5723  Mult_acc_5: 0.2489  Mult_acc_7: 0.2271  MAE: 1.4322  Corr: 0.1923 
2024-06-13 17:42:10:INFO:Saving checkpoint at epoch 11 to results/models/cmcm-mosi-regression.pth.
2024-06-13 17:42:25:INFO:TRAIN-(cmcm) (1/12/2)>> loss: 0.8532
2024-06-13 17:42:28:INFO:VAL-(cmcm) >>
2024-06-13 17:42:28:INFO:M: >>  Has0_acc_2: 0.6332  Has0_F1_score: 0.5488  Non0_acc_2: 0.6250  Non0_F1_score: 0.5443  Mult_acc_5: 0.2402  Mult_acc_7: 0.2096  MAE: 1.4970  Corr: 0.2238 
2024-06-13 17:42:43:INFO:TRAIN-(cmcm) (2/13/2)>> loss: 0.8472
2024-06-13 17:42:45:INFO:VAL-(cmcm) >>
2024-06-13 17:42:45:INFO:M: >>  Has0_acc_2: 0.6201  Has0_F1_score: 0.6141  Non0_acc_2: 0.6389  Non0_F1_score: 0.6319  Mult_acc_5: 0.2533  Mult_acc_7: 0.2183  MAE: 1.4341  Corr: 0.3355 
2024-06-13 17:43:00:INFO:TRAIN-(cmcm) (3/14/2)>> loss: 0.8429
2024-06-13 17:43:03:INFO:VAL-(cmcm) >>
2024-06-13 17:43:03:INFO:M: >>  Has0_acc_2: 0.6463  Has0_F1_score: 0.5836  Non0_acc_2: 0.6296  Non0_F1_score: 0.5650  Mult_acc_5: 0.3188  Mult_acc_7: 0.2314  MAE: 1.4328  Corr: 0.3501 
2024-06-13 17:43:18:INFO:TRAIN-(cmcm) (4/15/2)>> loss: 0.8249
2024-06-13 17:43:20:INFO:VAL-(cmcm) >>
2024-06-13 17:43:20:INFO:M: >>  Has0_acc_2: 0.6900  Has0_F1_score: 0.6930  Non0_acc_2: 0.7083  Non0_F1_score: 0.7099  Mult_acc_5: 0.3057  Mult_acc_7: 0.2576  MAE: 1.2713  Corr: 0.4532 
2024-06-13 17:43:21:INFO:Saving checkpoint at epoch 15 to results/models/cmcm-mosi-regression.pth.
2024-06-13 17:43:36:INFO:TRAIN-(cmcm) (1/16/2)>> loss: 0.8200
2024-06-13 17:43:38:INFO:VAL-(cmcm) >>
2024-06-13 17:43:38:INFO:M: >>  Has0_acc_2: 0.6856  Has0_F1_score: 0.6886  Non0_acc_2: 0.6667  Non0_F1_score: 0.6611  Mult_acc_5: 0.2926  Mult_acc_7: 0.2620  MAE: 1.2704  Corr: 0.4290 
2024-06-13 17:43:39:INFO:Saving checkpoint at epoch 16 to results/models/cmcm-mosi-regression.pth.
2024-06-13 17:43:54:INFO:TRAIN-(cmcm) (1/17/2)>> loss: 0.8061
2024-06-13 17:43:57:INFO:VAL-(cmcm) >>
2024-06-13 17:43:57:INFO:M: >>  Has0_acc_2: 0.7074  Has0_F1_score: 0.7098  Non0_acc_2: 0.7083  Non0_F1_score: 0.7094  Mult_acc_5: 0.2707  Mult_acc_7: 0.2445  MAE: 1.2183  Corr: 0.4764 
2024-06-13 17:43:57:INFO:Saving checkpoint at epoch 17 to results/models/cmcm-mosi-regression.pth.
2024-06-13 17:44:13:INFO:TRAIN-(cmcm) (1/18/2)>> loss: 0.7921
2024-06-13 17:44:15:INFO:VAL-(cmcm) >>
2024-06-13 17:44:15:INFO:M: >>  Has0_acc_2: 0.6856  Has0_F1_score: 0.6812  Non0_acc_2: 0.6991  Non0_F1_score: 0.6943  Mult_acc_5: 0.3057  Mult_acc_7: 0.2576  MAE: 1.2682  Corr: 0.4444 
2024-06-13 17:44:30:INFO:TRAIN-(cmcm) (2/19/2)>> loss: 0.7853
2024-06-13 17:44:33:INFO:VAL-(cmcm) >>
2024-06-13 17:44:33:INFO:M: >>  Has0_acc_2: 0.6943  Has0_F1_score: 0.6917  Non0_acc_2: 0.6991  Non0_F1_score: 0.6951  Mult_acc_5: 0.3188  Mult_acc_7: 0.2969  MAE: 1.2008  Corr: 0.4517 
2024-06-13 17:44:33:INFO:Saving checkpoint at epoch 19 to results/models/cmcm-mosi-regression.pth.
2024-06-13 17:44:49:INFO:TRAIN-(cmcm) (1/20/2)>> loss: 0.7723
2024-06-13 17:44:51:INFO:VAL-(cmcm) >>
2024-06-13 17:44:51:INFO:M: >>  Has0_acc_2: 0.6987  Has0_F1_score: 0.6931  Non0_acc_2: 0.7037  Non0_F1_score: 0.6967  Mult_acc_5: 0.3057  Mult_acc_7: 0.2751  MAE: 1.2558  Corr: 0.4434 
2024-06-13 17:45:06:INFO:TRAIN-(cmcm) (2/21/2)>> loss: 0.7709
2024-06-13 17:45:09:INFO:VAL-(cmcm) >>
2024-06-13 17:45:09:INFO:M: >>  Has0_acc_2: 0.6507  Has0_F1_score: 0.6008  Non0_acc_2: 0.6435  Non0_F1_score: 0.5936  Mult_acc_5: 0.3668  Mult_acc_7: 0.3013  MAE: 1.2651  Corr: 0.4370 
2024-06-13 17:45:24:INFO:TRAIN-(cmcm) (3/22/2)>> loss: 0.7571
2024-06-13 17:45:26:INFO:VAL-(cmcm) >>
2024-06-13 17:45:26:INFO:M: >>  Has0_acc_2: 0.6943  Has0_F1_score: 0.6953  Non0_acc_2: 0.6944  Non0_F1_score: 0.6955  Mult_acc_5: 0.3362  Mult_acc_7: 0.2664  MAE: 1.2704  Corr: 0.4329 
2024-06-13 17:45:41:INFO:TRAIN-(cmcm) (4/23/2)>> loss: 0.7481
2024-06-13 17:45:44:INFO:VAL-(cmcm) >>
2024-06-13 17:45:44:INFO:M: >>  Has0_acc_2: 0.6856  Has0_F1_score: 0.6885  Non0_acc_2: 0.6296  Non0_F1_score: 0.6254  Mult_acc_5: 0.2969  Mult_acc_7: 0.2489  MAE: 1.3095  Corr: 0.4448 
2024-06-13 17:45:59:INFO:TRAIN-(cmcm) (5/24/2)>> loss: 0.7550
2024-06-13 17:46:01:INFO:VAL-(cmcm) >>
2024-06-13 17:46:01:INFO:M: >>  Has0_acc_2: 0.6900  Has0_F1_score: 0.6919  Non0_acc_2: 0.6898  Non0_F1_score: 0.6907  Mult_acc_5: 0.3493  Mult_acc_7: 0.2795  MAE: 1.2790  Corr: 0.4460 
2024-06-13 17:46:16:INFO:TRAIN-(cmcm) (6/25/2)>> loss: 0.7419
2024-06-13 17:46:19:INFO:VAL-(cmcm) >>
2024-06-13 17:46:19:INFO:M: >>  Has0_acc_2: 0.7074  Has0_F1_score: 0.7038  Non0_acc_2: 0.7130  Non0_F1_score: 0.7088  Mult_acc_5: 0.3712  Mult_acc_7: 0.3013  MAE: 1.2078  Corr: 0.4658 
2024-06-13 17:46:34:INFO:TRAIN-(cmcm) (7/26/2)>> loss: 0.7359
2024-06-13 17:46:36:INFO:VAL-(cmcm) >>
2024-06-13 17:46:36:INFO:M: >>  Has0_acc_2: 0.6987  Has0_F1_score: 0.6863  Non0_acc_2: 0.6667  Non0_F1_score: 0.6667  Mult_acc_5: 0.3624  Mult_acc_7: 0.3231  MAE: 1.1925  Corr: 0.4559 
2024-06-13 17:46:37:INFO:Saving checkpoint at epoch 26 to results/models/cmcm-mosi-regression.pth.
2024-06-13 17:46:52:INFO:TRAIN-(cmcm) (1/27/2)>> loss: 0.7323
2024-06-13 17:46:55:INFO:VAL-(cmcm) >>
2024-06-13 17:46:55:INFO:M: >>  Has0_acc_2: 0.7031  Has0_F1_score: 0.7057  Non0_acc_2: 0.7176  Non0_F1_score: 0.7190  Mult_acc_5: 0.3799  Mult_acc_7: 0.3100  MAE: 1.2532  Corr: 0.4657 
2024-06-13 17:47:09:INFO:TRAIN-(cmcm) (2/28/2)>> loss: 0.7194
2024-06-13 17:47:12:INFO:VAL-(cmcm) >>
2024-06-13 17:47:12:INFO:M: >>  Has0_acc_2: 0.6900  Has0_F1_score: 0.6861  Non0_acc_2: 0.6991  Non0_F1_score: 0.6943  Mult_acc_5: 0.3799  Mult_acc_7: 0.3100  MAE: 1.1835  Corr: 0.4923 
2024-06-13 17:47:13:INFO:Saving checkpoint at epoch 28 to results/models/cmcm-mosi-regression.pth.
2024-06-13 17:47:28:INFO:TRAIN-(cmcm) (1/29/2)>> loss: 0.7090
2024-06-13 17:47:30:INFO:VAL-(cmcm) >>
2024-06-13 17:47:30:INFO:M: >>  Has0_acc_2: 0.6943  Has0_F1_score: 0.6948  Non0_acc_2: 0.6991  Non0_F1_score: 0.7006  Mult_acc_5: 0.3886  Mult_acc_7: 0.3188  MAE: 1.2270  Corr: 0.4606 
2024-06-13 17:47:45:INFO:TRAIN-(cmcm) (2/30/2)>> loss: 0.6968
2024-06-13 17:47:48:INFO:VAL-(cmcm) >>
2024-06-13 17:47:48:INFO:M: >>  Has0_acc_2: 0.7205  Has0_F1_score: 0.7205  Non0_acc_2: 0.7222  Non0_F1_score: 0.7235  Mult_acc_5: 0.3624  Mult_acc_7: 0.3188  MAE: 1.1982  Corr: 0.4775 
2024-06-13 17:48:03:INFO:TRAIN-(cmcm) (3/31/2)>> loss: 0.6851
2024-06-13 17:48:06:INFO:VAL-(cmcm) >>
2024-06-13 17:48:06:INFO:M: >>  Has0_acc_2: 0.7118  Has0_F1_score: 0.7123  Non0_acc_2: 0.7269  Non0_F1_score: 0.7267  Mult_acc_5: 0.3493  Mult_acc_7: 0.2969  MAE: 1.2004  Corr: 0.4755 
2024-06-13 17:48:21:INFO:TRAIN-(cmcm) (4/32/2)>> loss: 0.6760
2024-06-13 17:48:23:INFO:VAL-(cmcm) >>
2024-06-13 17:48:23:INFO:M: >>  Has0_acc_2: 0.6943  Has0_F1_score: 0.6917  Non0_acc_2: 0.7130  Non0_F1_score: 0.7145  Mult_acc_5: 0.3581  Mult_acc_7: 0.3057  MAE: 1.2209  Corr: 0.4404 
2024-06-13 17:48:38:INFO:TRAIN-(cmcm) (5/33/2)>> loss: 0.6655
2024-06-13 17:48:41:INFO:VAL-(cmcm) >>
2024-06-13 17:48:41:INFO:M: >>  Has0_acc_2: 0.7162  Has0_F1_score: 0.7109  Non0_acc_2: 0.7269  Non0_F1_score: 0.7217  Mult_acc_5: 0.3886  Mult_acc_7: 0.3362  MAE: 1.1580  Corr: 0.4926 
2024-06-13 17:48:41:INFO:Saving checkpoint at epoch 33 to results/models/cmcm-mosi-regression.pth.
2024-06-13 17:48:57:INFO:TRAIN-(cmcm) (1/34/2)>> loss: 0.6429
2024-06-13 17:48:59:INFO:VAL-(cmcm) >>
2024-06-13 17:48:59:INFO:M: >>  Has0_acc_2: 0.6943  Has0_F1_score: 0.6938  Non0_acc_2: 0.6898  Non0_F1_score: 0.6907  Mult_acc_5: 0.3581  Mult_acc_7: 0.3057  MAE: 1.2309  Corr: 0.4640 
2024-06-13 17:49:14:INFO:TRAIN-(cmcm) (2/35/2)>> loss: 0.6395
2024-06-13 17:49:17:INFO:VAL-(cmcm) >>
2024-06-13 17:49:17:INFO:M: >>  Has0_acc_2: 0.7031  Has0_F1_score: 0.6980  Non0_acc_2: 0.6991  Non0_F1_score: 0.6989  Mult_acc_5: 0.4061  Mult_acc_7: 0.3362  MAE: 1.2196  Corr: 0.4604 
2024-06-13 17:49:32:INFO:TRAIN-(cmcm) (3/36/2)>> loss: 0.6126
2024-06-13 17:49:34:INFO:VAL-(cmcm) >>
2024-06-13 17:49:34:INFO:M: >>  Has0_acc_2: 0.7074  Has0_F1_score: 0.7089  Non0_acc_2: 0.7130  Non0_F1_score: 0.7137  Mult_acc_5: 0.3799  Mult_acc_7: 0.3231  MAE: 1.2223  Corr: 0.4813 
2024-06-13 17:49:50:INFO:TRAIN-(cmcm) (4/37/2)>> loss: 0.6088
2024-06-13 17:49:53:INFO:VAL-(cmcm) >>
2024-06-13 17:49:53:INFO:M: >>  Has0_acc_2: 0.6856  Has0_F1_score: 0.6803  Non0_acc_2: 0.6991  Non0_F1_score: 0.6984  Mult_acc_5: 0.3755  Mult_acc_7: 0.3100  MAE: 1.2154  Corr: 0.4757 
2024-06-13 17:50:08:INFO:TRAIN-(cmcm) (5/38/2)>> loss: 0.5832
2024-06-13 17:50:11:INFO:VAL-(cmcm) >>
2024-06-13 17:50:11:INFO:M: >>  Has0_acc_2: 0.6987  Has0_F1_score: 0.6972  Non0_acc_2: 0.6991  Non0_F1_score: 0.6996  Mult_acc_5: 0.3537  Mult_acc_7: 0.2838  MAE: 1.2384  Corr: 0.4470 
2024-06-13 17:50:25:INFO:TRAIN-(cmcm) (6/39/2)>> loss: 0.5712
2024-06-13 17:50:28:INFO:VAL-(cmcm) >>
2024-06-13 17:50:28:INFO:M: >>  Has0_acc_2: 0.6987  Has0_F1_score: 0.6965  Non0_acc_2: 0.6991  Non0_F1_score: 0.7004  Mult_acc_5: 0.3406  Mult_acc_7: 0.2838  MAE: 1.2187  Corr: 0.4645 
2024-06-13 17:50:43:INFO:TRAIN-(cmcm) (7/40/2)>> loss: 0.5436
2024-06-13 17:50:46:INFO:VAL-(cmcm) >>
2024-06-13 17:50:46:INFO:M: >>  Has0_acc_2: 0.7205  Has0_F1_score: 0.7194  Non0_acc_2: 0.7222  Non0_F1_score: 0.7222  Mult_acc_5: 0.3581  Mult_acc_7: 0.3057  MAE: 1.1772  Corr: 0.5065 
2024-06-13 17:51:01:INFO:TRAIN-(cmcm) (8/41/2)>> loss: 0.5319
2024-06-13 17:51:03:INFO:VAL-(cmcm) >>
2024-06-13 17:51:03:INFO:M: >>  Has0_acc_2: 0.6856  Has0_F1_score: 0.6866  Non0_acc_2: 0.6898  Non0_F1_score: 0.6912  Mult_acc_5: 0.3537  Mult_acc_7: 0.2882  MAE: 1.2711  Corr: 0.4604 
2024-06-13 17:51:18:INFO:TRAIN-(cmcm) (9/42/2)>> loss: 0.5100
2024-06-13 17:51:21:INFO:VAL-(cmcm) >>
2024-06-13 17:51:21:INFO:M: >>  Has0_acc_2: 0.7074  Has0_F1_score: 0.7001  Non0_acc_2: 0.7222  Non0_F1_score: 0.7208  Mult_acc_5: 0.3624  Mult_acc_7: 0.2969  MAE: 1.1737  Corr: 0.5110 
2024-06-13 17:51:36:INFO:TRAIN-(cmcm) (10/43/2)>> loss: 0.4889
2024-06-13 17:51:38:INFO:VAL-(cmcm) >>
2024-06-13 17:51:38:INFO:M: >>  Has0_acc_2: 0.7074  Has0_F1_score: 0.7053  Non0_acc_2: 0.7176  Non0_F1_score: 0.7181  Mult_acc_5: 0.3799  Mult_acc_7: 0.2969  MAE: 1.1964  Corr: 0.5027 
2024-06-13 17:51:46:INFO:TEST-(cmcm) >>
2024-06-13 17:51:46:INFO:M: >>  Has0_acc_2: 0.6837  Has0_F1_score: 0.6831  Non0_acc_2: 0.6936  Non0_F1_score: 0.6944  Mult_acc_5: 0.3178  Mult_acc_7: 0.2828  MAE: 1.1868  Corr: 0.5009 
2024-06-13 17:51:46:INFO:Results are added to results/results/mosi-regression-50.csv...
2024-06-13 17:51:46:INFO:Start running cmcm...
2024-06-13 17:51:46:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 6, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 50, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 3333}>
2024-06-13 17:51:46:INFO:Let's use the GPU 1 !
2024-06-13 17:51:46:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 17:51:46:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718272307 HTTP/1.1" 200 235
2024-06-13 17:51:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 17:51:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 17:51:48:INFO:train samples: (1284,)
2024-06-13 17:51:48:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 17:51:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718272308 HTTP/1.1" 200 235
2024-06-13 17:51:49:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 17:51:49:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 17:51:50:INFO:valid samples: (229,)
2024-06-13 17:51:50:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 17:51:50:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718272310 HTTP/1.1" 200 235
2024-06-13 17:51:50:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 17:51:51:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 17:51:51:INFO:test samples: (686,)
2024-06-13 17:51:51:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 17:51:52:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718272312 HTTP/1.1" 200 235
2024-06-13 17:51:52:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 17:51:52:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 17:51:53:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 17:51:53:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718272313 HTTP/1.1" 200 235
2024-06-13 17:51:53:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 17:51:54:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 17:51:54:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-13 17:51:54:WARNING:Try importing flash-attention for faster inference...
2024-06-13 17:51:54:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-13 17:51:54:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-13 17:51:54:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-13 17:51:55:INFO:trainable params: 1310288 || all params: 1838138960 || trainable%: 0.07128340286090232
2024-06-13 17:51:55:INFO:Init labels...
2024-06-13 17:51:55:INFO:Start training...
2024-06-13 17:52:10:INFO:TRAIN-(cmcm) (1/1/3)>> loss: 2.2834
2024-06-13 17:52:12:INFO:VAL-(cmcm) >>
2024-06-13 17:52:12:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.4780  Non0_acc_2: 0.5648  Non0_F1_score: 0.4505  Mult_acc_5: 0.3275  Mult_acc_7: 0.2489  MAE: 1.6730  Corr: 0.0544 
2024-06-13 17:52:13:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-13 17:52:28:INFO:TRAIN-(cmcm) (1/2/3)>> loss: 0.9189
2024-06-13 17:52:31:INFO:VAL-(cmcm) >>
2024-06-13 17:52:31:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4723  Non0_acc_2: 0.5787  Non0_F1_score: 0.4584  Mult_acc_5: 0.1616  Mult_acc_7: 0.1616  MAE: 1.5669  Corr: 0.0247 
2024-06-13 17:52:31:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-13 17:52:47:INFO:TRAIN-(cmcm) (1/3/3)>> loss: 0.9315
2024-06-13 17:52:49:INFO:VAL-(cmcm) >>
2024-06-13 17:52:49:INFO:M: >>  Has0_acc_2: 0.5371  Has0_F1_score: 0.5051  Non0_acc_2: 0.5278  Non0_F1_score: 0.4921  Mult_acc_5: 0.1572  Mult_acc_7: 0.1572  MAE: 1.6506  Corr: -0.0308 
2024-06-13 17:53:04:INFO:TRAIN-(cmcm) (2/4/3)>> loss: 0.8929
2024-06-13 17:53:07:INFO:VAL-(cmcm) >>
2024-06-13 17:53:07:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.5743  Non0_acc_2: 0.5741  Non0_F1_score: 0.5710  Mult_acc_5: 0.1790  Mult_acc_7: 0.1790  MAE: 1.5405  Corr: 0.0681 
2024-06-13 17:53:07:INFO:Saving checkpoint at epoch 4 to results/models/cmcm-mosi-regression.pth.
2024-06-13 17:53:23:INFO:TRAIN-(cmcm) (1/5/3)>> loss: 0.8763
2024-06-13 17:53:25:INFO:VAL-(cmcm) >>
2024-06-13 17:53:25:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.5862  Non0_acc_2: 0.5926  Non0_F1_score: 0.5920  Mult_acc_5: 0.1965  Mult_acc_7: 0.1965  MAE: 1.5126  Corr: 0.1184 
2024-06-13 17:53:26:INFO:Saving checkpoint at epoch 5 to results/models/cmcm-mosi-regression.pth.
2024-06-13 17:53:41:INFO:TRAIN-(cmcm) (1/6/3)>> loss: 0.8658
2024-06-13 17:53:44:INFO:VAL-(cmcm) >>
2024-06-13 17:53:44:INFO:M: >>  Has0_acc_2: 0.5590  Has0_F1_score: 0.5632  Non0_acc_2: 0.5694  Non0_F1_score: 0.5717  Mult_acc_5: 0.1878  Mult_acc_7: 0.1747  MAE: 1.6598  Corr: 0.0933 
2024-06-13 17:53:59:INFO:TRAIN-(cmcm) (2/7/3)>> loss: 0.8651
2024-06-13 17:54:01:INFO:VAL-(cmcm) >>
2024-06-13 17:54:01:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.4939  Non0_acc_2: 0.5648  Non0_F1_score: 0.4791  Mult_acc_5: 0.1790  Mult_acc_7: 0.1747  MAE: 1.5191  Corr: 0.0238 
2024-06-13 17:54:16:INFO:TRAIN-(cmcm) (3/8/3)>> loss: 0.8652
2024-06-13 17:54:19:INFO:VAL-(cmcm) >>
2024-06-13 17:54:19:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.5187  Non0_acc_2: 0.5648  Non0_F1_score: 0.5059  Mult_acc_5: 0.2402  Mult_acc_7: 0.1878  MAE: 1.5795  Corr: 0.0418 
2024-06-13 17:54:34:INFO:TRAIN-(cmcm) (4/9/3)>> loss: 0.8560
2024-06-13 17:54:36:INFO:VAL-(cmcm) >>
2024-06-13 17:54:36:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4700  Non0_acc_2: 0.5741  Non0_F1_score: 0.4420  Mult_acc_5: 0.3100  Mult_acc_7: 0.2271  MAE: 1.7162  Corr: 0.0164 
2024-06-13 17:54:51:INFO:TRAIN-(cmcm) (5/10/3)>> loss: 0.8496
2024-06-13 17:54:54:INFO:VAL-(cmcm) >>
2024-06-13 17:54:54:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.5141  Non0_acc_2: 0.5926  Non0_F1_score: 0.4914  Mult_acc_5: 0.3100  Mult_acc_7: 0.2271  MAE: 1.7258  Corr: 0.0984 
2024-06-13 17:55:09:INFO:TRAIN-(cmcm) (6/11/3)>> loss: 0.8497
2024-06-13 17:55:11:INFO:VAL-(cmcm) >>
2024-06-13 17:55:11:INFO:M: >>  Has0_acc_2: 0.5459  Has0_F1_score: 0.5117  Non0_acc_2: 0.5417  Non0_F1_score: 0.5085  Mult_acc_5: 0.2445  Mult_acc_7: 0.1921  MAE: 1.5918  Corr: 0.0470 
2024-06-13 17:55:26:INFO:TRAIN-(cmcm) (7/12/3)>> loss: 0.8410
2024-06-13 17:55:29:INFO:VAL-(cmcm) >>
2024-06-13 17:55:29:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5970  Non0_acc_2: 0.5880  Non0_F1_score: 0.5882  Mult_acc_5: 0.2838  Mult_acc_7: 0.2314  MAE: 1.4446  Corr: 0.2087 
2024-06-13 17:55:29:INFO:Saving checkpoint at epoch 12 to results/models/cmcm-mosi-regression.pth.
2024-06-13 17:55:45:INFO:TRAIN-(cmcm) (1/13/3)>> loss: 0.8356
2024-06-13 17:55:47:INFO:VAL-(cmcm) >>
2024-06-13 17:55:47:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.5332  Non0_acc_2: 0.5926  Non0_F1_score: 0.5298  Mult_acc_5: 0.2445  Mult_acc_7: 0.2096  MAE: 1.3979  Corr: 0.1789 
2024-06-13 17:55:48:INFO:Saving checkpoint at epoch 13 to results/models/cmcm-mosi-regression.pth.
2024-06-13 17:56:03:INFO:TRAIN-(cmcm) (1/14/3)>> loss: 0.8257
2024-06-13 17:56:06:INFO:VAL-(cmcm) >>
2024-06-13 17:56:06:INFO:M: >>  Has0_acc_2: 0.6507  Has0_F1_score: 0.6385  Non0_acc_2: 0.6389  Non0_F1_score: 0.6291  Mult_acc_5: 0.3013  Mult_acc_7: 0.2358  MAE: 1.4503  Corr: 0.2875 
2024-06-13 17:56:21:INFO:TRAIN-(cmcm) (2/15/3)>> loss: 0.8246
2024-06-13 17:56:23:INFO:VAL-(cmcm) >>
2024-06-13 17:56:23:INFO:M: >>  Has0_acc_2: 0.6245  Has0_F1_score: 0.6203  Non0_acc_2: 0.6389  Non0_F1_score: 0.6337  Mult_acc_5: 0.2751  Mult_acc_7: 0.2314  MAE: 1.4462  Corr: 0.2911 
2024-06-13 17:56:38:INFO:TRAIN-(cmcm) (3/16/3)>> loss: 0.8132
2024-06-13 17:56:41:INFO:VAL-(cmcm) >>
2024-06-13 17:56:41:INFO:M: >>  Has0_acc_2: 0.6332  Has0_F1_score: 0.5488  Non0_acc_2: 0.6343  Non0_F1_score: 0.5601  Mult_acc_5: 0.2882  Mult_acc_7: 0.2227  MAE: 1.4734  Corr: 0.2886 
2024-06-13 17:56:56:INFO:TRAIN-(cmcm) (4/17/3)>> loss: 0.8074
2024-06-13 17:56:58:INFO:VAL-(cmcm) >>
2024-06-13 17:56:58:INFO:M: >>  Has0_acc_2: 0.6769  Has0_F1_score: 0.6693  Non0_acc_2: 0.6713  Non0_F1_score: 0.6630  Mult_acc_5: 0.3231  Mult_acc_7: 0.2489  MAE: 1.4189  Corr: 0.3295 
2024-06-13 17:57:13:INFO:TRAIN-(cmcm) (5/18/3)>> loss: 0.7963
2024-06-13 17:57:16:INFO:VAL-(cmcm) >>
2024-06-13 17:57:16:INFO:M: >>  Has0_acc_2: 0.6419  Has0_F1_score: 0.5641  Non0_acc_2: 0.6435  Non0_F1_score: 0.5968  Mult_acc_5: 0.3362  Mult_acc_7: 0.2533  MAE: 1.3931  Corr: 0.3070 
2024-06-13 17:57:16:INFO:Saving checkpoint at epoch 18 to results/models/cmcm-mosi-regression.pth.
2024-06-13 17:57:32:INFO:TRAIN-(cmcm) (1/19/3)>> loss: 0.7775
2024-06-13 17:57:34:INFO:VAL-(cmcm) >>
2024-06-13 17:57:34:INFO:M: >>  Has0_acc_2: 0.6288  Has0_F1_score: 0.5630  Non0_acc_2: 0.6944  Non0_F1_score: 0.6908  Mult_acc_5: 0.3668  Mult_acc_7: 0.3144  MAE: 1.1986  Corr: 0.4007 
2024-06-13 17:57:35:INFO:Saving checkpoint at epoch 19 to results/models/cmcm-mosi-regression.pth.
2024-06-13 17:57:50:INFO:TRAIN-(cmcm) (1/20/3)>> loss: 0.7757
2024-06-13 17:57:53:INFO:VAL-(cmcm) >>
2024-06-13 17:57:53:INFO:M: >>  Has0_acc_2: 0.6376  Has0_F1_score: 0.6394  Non0_acc_2: 0.6528  Non0_F1_score: 0.6525  Mult_acc_5: 0.3144  Mult_acc_7: 0.2183  MAE: 1.4384  Corr: 0.3366 
2024-06-13 17:58:08:INFO:TRAIN-(cmcm) (2/21/3)>> loss: 0.7665
2024-06-13 17:58:10:INFO:VAL-(cmcm) >>
2024-06-13 17:58:10:INFO:M: >>  Has0_acc_2: 0.6725  Has0_F1_score: 0.6654  Non0_acc_2: 0.6528  Non0_F1_score: 0.6520  Mult_acc_5: 0.3319  Mult_acc_7: 0.2664  MAE: 1.2750  Corr: 0.3972 
2024-06-13 17:58:25:INFO:TRAIN-(cmcm) (3/22/3)>> loss: 0.7558
2024-06-13 17:58:28:INFO:VAL-(cmcm) >>
2024-06-13 17:58:28:INFO:M: >>  Has0_acc_2: 0.6638  Has0_F1_score: 0.6665  Non0_acc_2: 0.6991  Non0_F1_score: 0.7002  Mult_acc_5: 0.3974  Mult_acc_7: 0.3188  MAE: 1.2436  Corr: 0.4536 
2024-06-13 17:58:43:INFO:TRAIN-(cmcm) (4/23/3)>> loss: 0.7630
2024-06-13 17:58:45:INFO:VAL-(cmcm) >>
2024-06-13 17:58:45:INFO:M: >>  Has0_acc_2: 0.6507  Has0_F1_score: 0.6540  Non0_acc_2: 0.6713  Non0_F1_score: 0.6730  Mult_acc_5: 0.3100  Mult_acc_7: 0.2533  MAE: 1.2851  Corr: 0.4140 
2024-06-13 17:59:00:INFO:TRAIN-(cmcm) (5/24/3)>> loss: 0.7504
2024-06-13 17:59:03:INFO:VAL-(cmcm) >>
2024-06-13 17:59:03:INFO:M: >>  Has0_acc_2: 0.7074  Has0_F1_score: 0.6954  Non0_acc_2: 0.7037  Non0_F1_score: 0.7009  Mult_acc_5: 0.4061  Mult_acc_7: 0.3231  MAE: 1.2132  Corr: 0.4744 
2024-06-13 17:59:18:INFO:TRAIN-(cmcm) (6/25/3)>> loss: 0.7327
2024-06-13 17:59:21:INFO:VAL-(cmcm) >>
2024-06-13 17:59:21:INFO:M: >>  Has0_acc_2: 0.6725  Has0_F1_score: 0.6753  Non0_acc_2: 0.6944  Non0_F1_score: 0.6959  Mult_acc_5: 0.3319  Mult_acc_7: 0.2620  MAE: 1.2493  Corr: 0.4449 
2024-06-13 17:59:36:INFO:TRAIN-(cmcm) (7/26/3)>> loss: 0.7266
2024-06-13 17:59:38:INFO:VAL-(cmcm) >>
2024-06-13 17:59:38:INFO:M: >>  Has0_acc_2: 0.6856  Has0_F1_score: 0.6837  Non0_acc_2: 0.6991  Non0_F1_score: 0.6973  Mult_acc_5: 0.3057  Mult_acc_7: 0.2402  MAE: 1.2453  Corr: 0.4458 
2024-06-13 17:59:53:INFO:TRAIN-(cmcm) (8/27/3)>> loss: 0.7150
2024-06-13 17:59:56:INFO:VAL-(cmcm) >>
2024-06-13 17:59:56:INFO:M: >>  Has0_acc_2: 0.6681  Has0_F1_score: 0.6625  Non0_acc_2: 0.6667  Non0_F1_score: 0.6618  Mult_acc_5: 0.3537  Mult_acc_7: 0.3013  MAE: 1.2654  Corr: 0.3473 
2024-06-13 18:00:11:INFO:TRAIN-(cmcm) (9/28/3)>> loss: 0.7072
2024-06-13 18:00:14:INFO:VAL-(cmcm) >>
2024-06-13 18:00:14:INFO:M: >>  Has0_acc_2: 0.7293  Has0_F1_score: 0.7121  Non0_acc_2: 0.7130  Non0_F1_score: 0.7109  Mult_acc_5: 0.3493  Mult_acc_7: 0.3013  MAE: 1.1392  Corr: 0.4740 
2024-06-13 18:00:14:INFO:Saving checkpoint at epoch 28 to results/models/cmcm-mosi-regression.pth.
2024-06-13 18:00:30:INFO:TRAIN-(cmcm) (1/29/3)>> loss: 0.6903
2024-06-13 18:00:32:INFO:VAL-(cmcm) >>
2024-06-13 18:00:32:INFO:M: >>  Has0_acc_2: 0.6550  Has0_F1_score: 0.6009  Non0_acc_2: 0.6667  Non0_F1_score: 0.6415  Mult_acc_5: 0.3537  Mult_acc_7: 0.2926  MAE: 1.3515  Corr: 0.3773 
2024-06-13 18:00:47:INFO:TRAIN-(cmcm) (2/30/3)>> loss: 0.6816
2024-06-13 18:00:50:INFO:VAL-(cmcm) >>
2024-06-13 18:00:50:INFO:M: >>  Has0_acc_2: 0.6812  Has0_F1_score: 0.6618  Non0_acc_2: 0.6713  Non0_F1_score: 0.6723  Mult_acc_5: 0.3362  Mult_acc_7: 0.2926  MAE: 1.2178  Corr: 0.4244 
2024-06-13 18:01:05:INFO:TRAIN-(cmcm) (3/31/3)>> loss: 0.6779
2024-06-13 18:01:08:INFO:VAL-(cmcm) >>
2024-06-13 18:01:08:INFO:M: >>  Has0_acc_2: 0.6812  Has0_F1_score: 0.6829  Non0_acc_2: 0.6898  Non0_F1_score: 0.6910  Mult_acc_5: 0.3188  Mult_acc_7: 0.2882  MAE: 1.2244  Corr: 0.4378 
2024-06-13 18:01:23:INFO:TRAIN-(cmcm) (4/32/3)>> loss: 0.6676
2024-06-13 18:01:25:INFO:VAL-(cmcm) >>
2024-06-13 18:01:25:INFO:M: >>  Has0_acc_2: 0.6900  Has0_F1_score: 0.6772  Non0_acc_2: 0.6713  Non0_F1_score: 0.6678  Mult_acc_5: 0.2926  Mult_acc_7: 0.2576  MAE: 1.2322  Corr: 0.3950 
2024-06-13 18:01:40:INFO:TRAIN-(cmcm) (5/33/3)>> loss: 0.6449
2024-06-13 18:01:43:INFO:VAL-(cmcm) >>
2024-06-13 18:01:43:INFO:M: >>  Has0_acc_2: 0.7031  Has0_F1_score: 0.6915  Non0_acc_2: 0.7222  Non0_F1_score: 0.7136  Mult_acc_5: 0.3930  Mult_acc_7: 0.3013  MAE: 1.2184  Corr: 0.4689 
2024-06-13 18:01:58:INFO:TRAIN-(cmcm) (6/34/3)>> loss: 0.6456
2024-06-13 18:02:00:INFO:VAL-(cmcm) >>
2024-06-13 18:02:00:INFO:M: >>  Has0_acc_2: 0.6725  Has0_F1_score: 0.6630  Non0_acc_2: 0.6944  Non0_F1_score: 0.6900  Mult_acc_5: 0.3668  Mult_acc_7: 0.3275  MAE: 1.2030  Corr: 0.4316 
2024-06-13 18:02:16:INFO:TRAIN-(cmcm) (7/35/3)>> loss: 0.6226
2024-06-13 18:02:18:INFO:VAL-(cmcm) >>
2024-06-13 18:02:18:INFO:M: >>  Has0_acc_2: 0.6856  Has0_F1_score: 0.6656  Non0_acc_2: 0.6898  Non0_F1_score: 0.6900  Mult_acc_5: 0.3319  Mult_acc_7: 0.3013  MAE: 1.2191  Corr: 0.4167 
2024-06-13 18:02:33:INFO:TRAIN-(cmcm) (8/36/3)>> loss: 0.6182
2024-06-13 18:02:36:INFO:VAL-(cmcm) >>
2024-06-13 18:02:36:INFO:M: >>  Has0_acc_2: 0.6900  Has0_F1_score: 0.6869  Non0_acc_2: 0.7037  Non0_F1_score: 0.7016  Mult_acc_5: 0.3537  Mult_acc_7: 0.3100  MAE: 1.2720  Corr: 0.3929 
2024-06-13 18:02:51:INFO:TRAIN-(cmcm) (9/37/3)>> loss: 0.5917
2024-06-13 18:02:53:INFO:VAL-(cmcm) >>
2024-06-13 18:02:53:INFO:M: >>  Has0_acc_2: 0.6681  Has0_F1_score: 0.6505  Non0_acc_2: 0.6620  Non0_F1_score: 0.6466  Mult_acc_5: 0.3668  Mult_acc_7: 0.3231  MAE: 1.2903  Corr: 0.3672 
2024-06-13 18:03:08:INFO:TRAIN-(cmcm) (10/38/3)>> loss: 0.5800
2024-06-13 18:03:11:INFO:VAL-(cmcm) >>
2024-06-13 18:03:11:INFO:M: >>  Has0_acc_2: 0.7031  Has0_F1_score: 0.6989  Non0_acc_2: 0.6852  Non0_F1_score: 0.6852  Mult_acc_5: 0.3668  Mult_acc_7: 0.3057  MAE: 1.2453  Corr: 0.4286 
2024-06-13 18:03:18:INFO:TEST-(cmcm) >>
2024-06-13 18:03:18:INFO:M: >>  Has0_acc_2: 0.6385  Has0_F1_score: 0.6353  Non0_acc_2: 0.6585  Non0_F1_score: 0.6590  Mult_acc_5: 0.2915  Mult_acc_7: 0.2668  MAE: 1.2934  Corr: 0.3557 
2024-06-13 18:03:19:INFO:Results are added to results/results/mosi-regression-50.csv...
2024-06-13 18:03:19:INFO:Start running cmcm...
2024-06-13 18:03:19:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 6, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 50, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 4444}>
2024-06-13 18:03:19:INFO:Let's use the GPU 1 !
2024-06-13 18:03:19:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 18:03:19:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718272999 HTTP/1.1" 200 235
2024-06-13 18:03:19:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 18:03:20:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 18:03:20:INFO:train samples: (1284,)
2024-06-13 18:03:20:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 18:03:21:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718273001 HTTP/1.1" 200 235
2024-06-13 18:03:21:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 18:03:21:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 18:03:22:INFO:valid samples: (229,)
2024-06-13 18:03:22:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 18:03:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718273003 HTTP/1.1" 200 235
2024-06-13 18:03:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 18:03:23:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 18:03:23:INFO:test samples: (686,)
2024-06-13 18:03:23:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 18:03:24:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718273004 HTTP/1.1" 200 235
2024-06-13 18:03:24:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 18:03:24:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 18:03:25:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 18:03:25:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718273005 HTTP/1.1" 200 235
2024-06-13 18:03:25:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 18:03:26:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 18:03:26:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-13 18:03:26:WARNING:Try importing flash-attention for faster inference...
2024-06-13 18:03:26:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-13 18:03:26:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-13 18:03:26:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-13 18:03:27:INFO:trainable params: 1310288 || all params: 1838138960 || trainable%: 0.07128340286090232
2024-06-13 18:03:27:INFO:Init labels...
2024-06-13 18:03:27:INFO:Start training...
2024-06-13 18:03:43:INFO:TRAIN-(cmcm) (1/1/4)>> loss: 2.4739
2024-06-13 18:03:45:INFO:VAL-(cmcm) >>
2024-06-13 18:03:45:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.5244  Non0_acc_2: 0.5926  Non0_F1_score: 0.5075  Mult_acc_5: 0.2140  Mult_acc_7: 0.1834  MAE: 1.4881  Corr: 0.0934 
2024-06-13 18:03:46:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-13 18:04:01:INFO:TRAIN-(cmcm) (1/2/4)>> loss: 1.0181
2024-06-13 18:04:04:INFO:VAL-(cmcm) >>
2024-06-13 18:04:04:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4577  Non0_acc_2: 0.5833  Non0_F1_score: 0.4542  Mult_acc_5: 0.2751  Mult_acc_7: 0.2271  MAE: 1.6057  Corr: -0.0392 
2024-06-13 18:04:19:INFO:TRAIN-(cmcm) (2/3/4)>> loss: 0.9027
2024-06-13 18:04:22:INFO:VAL-(cmcm) >>
2024-06-13 18:04:22:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4742  Non0_acc_2: 0.5741  Non0_F1_score: 0.4558  Mult_acc_5: 0.2445  Mult_acc_7: 0.1878  MAE: 1.5765  Corr: 0.0461 
2024-06-13 18:04:37:INFO:TRAIN-(cmcm) (3/4/4)>> loss: 0.8785
2024-06-13 18:04:39:INFO:VAL-(cmcm) >>
2024-06-13 18:04:39:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5661  Non0_acc_2: 0.5648  Non0_F1_score: 0.5573  Mult_acc_5: 0.3057  Mult_acc_7: 0.2358  MAE: 1.6285  Corr: 0.0772 
2024-06-13 18:04:54:INFO:TRAIN-(cmcm) (4/5/4)>> loss: 0.8750
2024-06-13 18:04:57:INFO:VAL-(cmcm) >>
2024-06-13 18:04:57:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4577  Non0_acc_2: 0.5787  Non0_F1_score: 0.4291  Mult_acc_5: 0.2969  Mult_acc_7: 0.2140  MAE: 1.7372  Corr: 0.0059 
2024-06-13 18:05:12:INFO:TRAIN-(cmcm) (5/6/4)>> loss: 0.8638
2024-06-13 18:05:14:INFO:VAL-(cmcm) >>
2024-06-13 18:05:14:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.5954  Non0_acc_2: 0.6111  Non0_F1_score: 0.5924  Mult_acc_5: 0.2838  Mult_acc_7: 0.1878  MAE: 1.6769  Corr: 0.1461 
2024-06-13 18:05:29:INFO:TRAIN-(cmcm) (6/7/4)>> loss: 0.8485
2024-06-13 18:05:32:INFO:VAL-(cmcm) >>
2024-06-13 18:05:32:INFO:M: >>  Has0_acc_2: 0.6943  Has0_F1_score: 0.6796  Non0_acc_2: 0.6944  Non0_F1_score: 0.6782  Mult_acc_5: 0.2183  Mult_acc_7: 0.2183  MAE: 1.3030  Corr: 0.3349 
2024-06-13 18:05:33:INFO:Saving checkpoint at epoch 7 to results/models/cmcm-mosi-regression.pth.
2024-06-13 18:05:48:INFO:TRAIN-(cmcm) (1/8/4)>> loss: 0.8390
2024-06-13 18:05:51:INFO:VAL-(cmcm) >>
2024-06-13 18:05:51:INFO:M: >>  Has0_acc_2: 0.6201  Has0_F1_score: 0.6153  Non0_acc_2: 0.6296  Non0_F1_score: 0.6232  Mult_acc_5: 0.3144  Mult_acc_7: 0.2489  MAE: 1.4424  Corr: 0.2491 
2024-06-13 18:06:05:INFO:TRAIN-(cmcm) (2/9/4)>> loss: 0.8246
2024-06-13 18:06:08:INFO:VAL-(cmcm) >>
2024-06-13 18:06:08:INFO:M: >>  Has0_acc_2: 0.6900  Has0_F1_score: 0.6902  Non0_acc_2: 0.6574  Non0_F1_score: 0.6588  Mult_acc_5: 0.2795  Mult_acc_7: 0.2664  MAE: 1.2886  Corr: 0.3641 
2024-06-13 18:06:09:INFO:Saving checkpoint at epoch 9 to results/models/cmcm-mosi-regression.pth.
2024-06-13 18:06:24:INFO:TRAIN-(cmcm) (1/10/4)>> loss: 0.8039
2024-06-13 18:06:26:INFO:VAL-(cmcm) >>
2024-06-13 18:06:26:INFO:M: >>  Has0_acc_2: 0.6812  Has0_F1_score: 0.6476  Non0_acc_2: 0.6667  Non0_F1_score: 0.6435  Mult_acc_5: 0.3231  Mult_acc_7: 0.2402  MAE: 1.3126  Corr: 0.4050 
2024-06-13 18:06:42:INFO:TRAIN-(cmcm) (2/11/4)>> loss: 0.8056
2024-06-13 18:06:44:INFO:VAL-(cmcm) >>
2024-06-13 18:06:44:INFO:M: >>  Has0_acc_2: 0.7336  Has0_F1_score: 0.7350  Non0_acc_2: 0.7454  Non0_F1_score: 0.7459  Mult_acc_5: 0.3624  Mult_acc_7: 0.3057  MAE: 1.1110  Corr: 0.5421 
2024-06-13 18:06:45:INFO:Saving checkpoint at epoch 11 to results/models/cmcm-mosi-regression.pth.
2024-06-13 18:07:00:INFO:TRAIN-(cmcm) (1/12/4)>> loss: 0.7969
2024-06-13 18:07:03:INFO:VAL-(cmcm) >>
2024-06-13 18:07:03:INFO:M: >>  Has0_acc_2: 0.6725  Has0_F1_score: 0.6469  Non0_acc_2: 0.6944  Non0_F1_score: 0.6750  Mult_acc_5: 0.3406  Mult_acc_7: 0.2707  MAE: 1.2782  Corr: 0.4349 
2024-06-13 18:07:18:INFO:TRAIN-(cmcm) (2/13/4)>> loss: 0.7829
2024-06-13 18:07:20:INFO:VAL-(cmcm) >>
2024-06-13 18:07:20:INFO:M: >>  Has0_acc_2: 0.6769  Has0_F1_score: 0.6597  Non0_acc_2: 0.7083  Non0_F1_score: 0.6963  Mult_acc_5: 0.3668  Mult_acc_7: 0.2926  MAE: 1.1398  Corr: 0.5529 
2024-06-13 18:07:35:INFO:TRAIN-(cmcm) (3/14/4)>> loss: 0.7768
2024-06-13 18:07:38:INFO:VAL-(cmcm) >>
2024-06-13 18:07:38:INFO:M: >>  Has0_acc_2: 0.6900  Has0_F1_score: 0.6657  Non0_acc_2: 0.7037  Non0_F1_score: 0.6894  Mult_acc_5: 0.3668  Mult_acc_7: 0.2882  MAE: 1.2730  Corr: 0.4304 
2024-06-13 18:07:53:INFO:TRAIN-(cmcm) (4/15/4)>> loss: 0.7675
2024-06-13 18:07:56:INFO:VAL-(cmcm) >>
2024-06-13 18:07:56:INFO:M: >>  Has0_acc_2: 0.7249  Has0_F1_score: 0.7266  Non0_acc_2: 0.7500  Non0_F1_score: 0.7514  Mult_acc_5: 0.3712  Mult_acc_7: 0.2838  MAE: 1.1555  Corr: 0.5168 
2024-06-13 18:08:11:INFO:TRAIN-(cmcm) (5/16/4)>> loss: 0.7485
2024-06-13 18:08:13:INFO:VAL-(cmcm) >>
2024-06-13 18:08:13:INFO:M: >>  Has0_acc_2: 0.6856  Has0_F1_score: 0.6866  Non0_acc_2: 0.7083  Non0_F1_score: 0.7085  Mult_acc_5: 0.3930  Mult_acc_7: 0.3013  MAE: 1.2232  Corr: 0.4884 
2024-06-13 18:08:28:INFO:TRAIN-(cmcm) (6/17/4)>> loss: 0.7592
2024-06-13 18:08:31:INFO:VAL-(cmcm) >>
2024-06-13 18:08:31:INFO:M: >>  Has0_acc_2: 0.6900  Has0_F1_score: 0.6925  Non0_acc_2: 0.7315  Non0_F1_score: 0.7328  Mult_acc_5: 0.3537  Mult_acc_7: 0.2707  MAE: 1.1699  Corr: 0.5109 
2024-06-13 18:08:46:INFO:TRAIN-(cmcm) (7/18/4)>> loss: 0.7550
2024-06-13 18:08:48:INFO:VAL-(cmcm) >>
2024-06-13 18:08:48:INFO:M: >>  Has0_acc_2: 0.7118  Has0_F1_score: 0.7093  Non0_acc_2: 0.7454  Non0_F1_score: 0.7461  Mult_acc_5: 0.3755  Mult_acc_7: 0.2795  MAE: 1.1263  Corr: 0.5280 
2024-06-13 18:09:03:INFO:TRAIN-(cmcm) (8/19/4)>> loss: 0.7368
2024-06-13 18:09:06:INFO:VAL-(cmcm) >>
2024-06-13 18:09:06:INFO:M: >>  Has0_acc_2: 0.6987  Has0_F1_score: 0.7006  Non0_acc_2: 0.7222  Non0_F1_score: 0.7235  Mult_acc_5: 0.2795  Mult_acc_7: 0.2445  MAE: 1.1809  Corr: 0.4872 
2024-06-13 18:09:21:INFO:TRAIN-(cmcm) (9/20/4)>> loss: 0.7227
2024-06-13 18:09:23:INFO:VAL-(cmcm) >>
2024-06-13 18:09:23:INFO:M: >>  Has0_acc_2: 0.6288  Has0_F1_score: 0.5807  Non0_acc_2: 0.6806  Non0_F1_score: 0.6659  Mult_acc_5: 0.3624  Mult_acc_7: 0.2795  MAE: 1.2844  Corr: 0.4213 
2024-06-13 18:09:38:INFO:TRAIN-(cmcm) (10/21/4)>> loss: 0.7214
2024-06-13 18:09:41:INFO:VAL-(cmcm) >>
2024-06-13 18:09:41:INFO:M: >>  Has0_acc_2: 0.6594  Has0_F1_score: 0.6430  Non0_acc_2: 0.6898  Non0_F1_score: 0.6819  Mult_acc_5: 0.3406  Mult_acc_7: 0.2402  MAE: 1.3451  Corr: 0.4078 
2024-06-13 18:09:48:INFO:TEST-(cmcm) >>
2024-06-13 18:09:48:INFO:M: >>  Has0_acc_2: 0.6837  Has0_F1_score: 0.6817  Non0_acc_2: 0.7165  Non0_F1_score: 0.7146  Mult_acc_5: 0.3076  Mult_acc_7: 0.2843  MAE: 1.1509  Corr: 0.4489 
2024-06-13 18:09:49:INFO:Results are added to results/results/mosi-regression-50.csv...
2024-06-13 18:09:49:INFO:Start running cmcm...
2024-06-13 18:09:49:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 6, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 50, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 5555}>
2024-06-13 18:09:49:INFO:Let's use the GPU 1 !
2024-06-13 18:09:49:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 18:09:49:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718273389 HTTP/1.1" 200 235
2024-06-13 18:09:49:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 18:09:50:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 18:09:50:INFO:train samples: (1284,)
2024-06-13 18:09:51:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 18:09:51:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718273391 HTTP/1.1" 200 235
2024-06-13 18:09:51:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 18:09:51:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 18:09:52:INFO:valid samples: (229,)
2024-06-13 18:09:52:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 18:09:52:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718273393 HTTP/1.1" 200 235
2024-06-13 18:09:53:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 18:09:53:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 18:09:54:INFO:test samples: (686,)
2024-06-13 18:09:54:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 18:09:54:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718273394 HTTP/1.1" 200 235
2024-06-13 18:09:54:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 18:09:55:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 18:09:55:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 18:09:56:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718273396 HTTP/1.1" 200 235
2024-06-13 18:09:56:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 18:09:56:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 18:09:56:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-13 18:09:56:WARNING:Try importing flash-attention for faster inference...
2024-06-13 18:09:56:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-13 18:09:56:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-13 18:09:56:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-13 18:09:57:INFO:trainable params: 1310288 || all params: 1838138960 || trainable%: 0.07128340286090232
2024-06-13 18:09:57:INFO:Init labels...
2024-06-13 18:09:57:INFO:Start training...
2024-06-13 18:10:12:INFO:TRAIN-(cmcm) (1/1/5)>> loss: 1.8427
2024-06-13 18:10:15:INFO:VAL-(cmcm) >>
2024-06-13 18:10:15:INFO:M: >>  Has0_acc_2: 0.5109  Has0_F1_score: 0.5100  Non0_acc_2: 0.5046  Non0_F1_score: 0.5016  Mult_acc_5: 0.1878  Mult_acc_7: 0.1878  MAE: 1.6392  Corr: -0.0522 
2024-06-13 18:10:15:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-13 18:10:31:INFO:TRAIN-(cmcm) (1/2/5)>> loss: 0.9237
2024-06-13 18:10:33:INFO:VAL-(cmcm) >>
2024-06-13 18:10:33:INFO:M: >>  Has0_acc_2: 0.4236  Has0_F1_score: 0.3670  Non0_acc_2: 0.4537  Non0_F1_score: 0.3994  Mult_acc_5: 0.1310  Mult_acc_7: 0.1310  MAE: 1.8405  Corr: -0.0419 
2024-06-13 18:10:48:INFO:TRAIN-(cmcm) (2/3/5)>> loss: 0.8877
2024-06-13 18:10:51:INFO:VAL-(cmcm) >>
2024-06-13 18:10:51:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4723  Non0_acc_2: 0.5787  Non0_F1_score: 0.4445  Mult_acc_5: 0.1703  Mult_acc_7: 0.1703  MAE: 1.4973  Corr: 0.0055 
2024-06-13 18:10:51:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-mosi-regression.pth.
2024-06-13 18:11:07:INFO:TRAIN-(cmcm) (1/4/5)>> loss: 0.8836
2024-06-13 18:11:09:INFO:VAL-(cmcm) >>
2024-06-13 18:11:09:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5741  Non0_F1_score: 0.4187  Mult_acc_5: 0.2096  Mult_acc_7: 0.1703  MAE: 1.5778  Corr: 0.0446 
2024-06-13 18:11:24:INFO:TRAIN-(cmcm) (2/5/5)>> loss: 0.8874
2024-06-13 18:11:27:INFO:VAL-(cmcm) >>
2024-06-13 18:11:27:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5282  Non0_acc_2: 0.5648  Non0_F1_score: 0.5097  Mult_acc_5: 0.2052  Mult_acc_7: 0.1703  MAE: 1.6616  Corr: 0.0083 
2024-06-13 18:11:42:INFO:TRAIN-(cmcm) (3/6/5)>> loss: 0.8707
2024-06-13 18:11:44:INFO:VAL-(cmcm) >>
2024-06-13 18:11:44:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.5390  Non0_acc_2: 0.5602  Non0_F1_score: 0.5283  Mult_acc_5: 0.2489  Mult_acc_7: 0.1703  MAE: 1.8014  Corr: 0.0285 
2024-06-13 18:11:59:INFO:TRAIN-(cmcm) (4/7/5)>> loss: 0.8692
2024-06-13 18:12:02:INFO:VAL-(cmcm) >>
2024-06-13 18:12:02:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.5086  Non0_acc_2: 0.5185  Non0_F1_score: 0.5205  Mult_acc_5: 0.1747  Mult_acc_7: 0.1703  MAE: 1.4737  Corr: 0.0712 
2024-06-13 18:12:02:INFO:Saving checkpoint at epoch 7 to results/models/cmcm-mosi-regression.pth.
2024-06-13 18:12:17:INFO:TRAIN-(cmcm) (1/8/5)>> loss: 0.8616
2024-06-13 18:12:20:INFO:VAL-(cmcm) >>
2024-06-13 18:12:20:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.5349  Non0_acc_2: 0.5694  Non0_F1_score: 0.5167  Mult_acc_5: 0.2838  Mult_acc_7: 0.2009  MAE: 1.8084  Corr: 0.0304 
2024-06-13 18:12:35:INFO:TRAIN-(cmcm) (2/9/5)>> loss: 0.8689
2024-06-13 18:12:37:INFO:VAL-(cmcm) >>
2024-06-13 18:12:37:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.4897  Non0_acc_2: 0.5648  Non0_F1_score: 0.4627  Mult_acc_5: 0.2707  Mult_acc_7: 0.1965  MAE: 1.7656  Corr: -0.0558 
2024-06-13 18:12:52:INFO:TRAIN-(cmcm) (3/10/5)>> loss: 0.8589
2024-06-13 18:12:55:INFO:VAL-(cmcm) >>
2024-06-13 18:12:55:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4700  Non0_acc_2: 0.5972  Non0_F1_score: 0.5681  Mult_acc_5: 0.2751  Mult_acc_7: 0.2271  MAE: 1.4106  Corr: 0.1113 
2024-06-13 18:12:55:INFO:Saving checkpoint at epoch 10 to results/models/cmcm-mosi-regression.pth.
2024-06-13 18:13:10:INFO:TRAIN-(cmcm) (1/11/5)>> loss: 0.8513
2024-06-13 18:13:13:INFO:VAL-(cmcm) >>
2024-06-13 18:13:13:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.5775  Non0_acc_2: 0.5833  Non0_F1_score: 0.5735  Mult_acc_5: 0.2140  Mult_acc_7: 0.1965  MAE: 1.5082  Corr: 0.1154 
2024-06-13 18:13:28:INFO:TRAIN-(cmcm) (2/12/5)>> loss: 0.8542
2024-06-13 18:13:30:INFO:VAL-(cmcm) >>
2024-06-13 18:13:30:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5309  Non0_acc_2: 0.5648  Non0_F1_score: 0.5201  Mult_acc_5: 0.2926  Mult_acc_7: 0.2140  MAE: 1.6686  Corr: 0.0500 
2024-06-13 18:13:45:INFO:TRAIN-(cmcm) (3/13/5)>> loss: 0.8439
2024-06-13 18:13:48:INFO:VAL-(cmcm) >>
2024-06-13 18:13:48:INFO:M: >>  Has0_acc_2: 0.6245  Has0_F1_score: 0.5962  Non0_acc_2: 0.6111  Non0_F1_score: 0.5818  Mult_acc_5: 0.2969  Mult_acc_7: 0.2140  MAE: 1.5979  Corr: 0.1429 
2024-06-13 18:14:03:INFO:TRAIN-(cmcm) (4/14/5)>> loss: 0.8379
2024-06-13 18:14:05:INFO:VAL-(cmcm) >>
2024-06-13 18:14:05:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.5673  Non0_acc_2: 0.5972  Non0_F1_score: 0.5840  Mult_acc_5: 0.2707  Mult_acc_7: 0.2183  MAE: 1.4525  Corr: 0.1730 
2024-06-13 18:14:20:INFO:TRAIN-(cmcm) (5/15/5)>> loss: 0.8350
2024-06-13 18:14:23:INFO:VAL-(cmcm) >>
2024-06-13 18:14:23:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5741  Non0_F1_score: 0.4187  Mult_acc_5: 0.2358  Mult_acc_7: 0.1659  MAE: 1.6717  Corr: 0.1176 
2024-06-13 18:14:38:INFO:TRAIN-(cmcm) (6/16/5)>> loss: 0.8271
2024-06-13 18:14:40:INFO:VAL-(cmcm) >>
2024-06-13 18:14:40:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.5309  Non0_acc_2: 0.6019  Non0_F1_score: 0.5479  Mult_acc_5: 0.3100  Mult_acc_7: 0.2314  MAE: 1.5726  Corr: 0.2215 
2024-06-13 18:14:55:INFO:TRAIN-(cmcm) (7/17/5)>> loss: 0.8160
2024-06-13 18:14:57:INFO:VAL-(cmcm) >>
2024-06-13 18:14:58:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.6107  Non0_acc_2: 0.6204  Non0_F1_score: 0.6130  Mult_acc_5: 0.2751  Mult_acc_7: 0.2052  MAE: 1.4215  Corr: 0.3431 
2024-06-13 18:15:12:INFO:TRAIN-(cmcm) (8/18/5)>> loss: 0.8058
2024-06-13 18:15:15:INFO:VAL-(cmcm) >>
2024-06-13 18:15:15:INFO:M: >>  Has0_acc_2: 0.6550  Has0_F1_score: 0.6582  Non0_acc_2: 0.6759  Non0_F1_score: 0.6775  Mult_acc_5: 0.3275  Mult_acc_7: 0.2576  MAE: 1.4223  Corr: 0.3210 
2024-06-13 18:15:30:INFO:TRAIN-(cmcm) (9/19/5)>> loss: 0.7972
2024-06-13 18:15:33:INFO:VAL-(cmcm) >>
2024-06-13 18:15:33:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5863  Non0_acc_2: 0.6250  Non0_F1_score: 0.6160  Mult_acc_5: 0.2838  Mult_acc_7: 0.2271  MAE: 1.3646  Corr: 0.3510 
2024-06-13 18:15:33:INFO:Saving checkpoint at epoch 19 to results/models/cmcm-mosi-regression.pth.
2024-06-13 18:15:48:INFO:TRAIN-(cmcm) (1/20/5)>> loss: 0.7986
2024-06-13 18:15:51:INFO:VAL-(cmcm) >>
2024-06-13 18:15:51:INFO:M: >>  Has0_acc_2: 0.5284  Has0_F1_score: 0.4759  Non0_acc_2: 0.5093  Non0_F1_score: 0.4299  Mult_acc_5: 0.1659  Mult_acc_7: 0.1528  MAE: 1.6074  Corr: 0.2207 
2024-06-13 18:16:06:INFO:TRAIN-(cmcm) (2/21/5)>> loss: 0.7940
2024-06-13 18:16:08:INFO:VAL-(cmcm) >>
2024-06-13 18:16:08:INFO:M: >>  Has0_acc_2: 0.6201  Has0_F1_score: 0.6141  Non0_acc_2: 0.6296  Non0_F1_score: 0.6188  Mult_acc_5: 0.2445  Mult_acc_7: 0.1965  MAE: 1.4158  Corr: 0.4005 
2024-06-13 18:16:23:INFO:TRAIN-(cmcm) (3/22/5)>> loss: 0.7749
2024-06-13 18:16:25:INFO:VAL-(cmcm) >>
2024-06-13 18:16:25:INFO:M: >>  Has0_acc_2: 0.6681  Has0_F1_score: 0.6592  Non0_acc_2: 0.6065  Non0_F1_score: 0.5994  Mult_acc_5: 0.2533  Mult_acc_7: 0.1921  MAE: 1.3009  Corr: 0.3830 
2024-06-13 18:16:26:INFO:Saving checkpoint at epoch 22 to results/models/cmcm-mosi-regression.pth.
2024-06-13 18:16:41:INFO:TRAIN-(cmcm) (1/23/5)>> loss: 0.7692
2024-06-13 18:16:44:INFO:VAL-(cmcm) >>
2024-06-13 18:16:44:INFO:M: >>  Has0_acc_2: 0.6507  Has0_F1_score: 0.6527  Non0_acc_2: 0.6713  Non0_F1_score: 0.6730  Mult_acc_5: 0.2969  Mult_acc_7: 0.2271  MAE: 1.3555  Corr: 0.3591 
2024-06-13 18:16:58:INFO:TRAIN-(cmcm) (2/24/5)>> loss: 0.7659
2024-06-13 18:17:01:INFO:VAL-(cmcm) >>
2024-06-13 18:17:01:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5935  Non0_acc_2: 0.6065  Non0_F1_score: 0.6056  Mult_acc_5: 0.3231  Mult_acc_7: 0.2445  MAE: 1.5285  Corr: 0.2643 
2024-06-13 18:17:16:INFO:TRAIN-(cmcm) (3/25/5)>> loss: 0.7653
2024-06-13 18:17:18:INFO:VAL-(cmcm) >>
2024-06-13 18:17:18:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.4943  Non0_acc_2: 0.5972  Non0_F1_score: 0.5574  Mult_acc_5: 0.1834  Mult_acc_7: 0.1659  MAE: 1.4301  Corr: 0.2356 
2024-06-13 18:17:33:INFO:TRAIN-(cmcm) (4/26/5)>> loss: 0.7572
2024-06-13 18:17:36:INFO:VAL-(cmcm) >>
2024-06-13 18:17:36:INFO:M: >>  Has0_acc_2: 0.6245  Has0_F1_score: 0.6006  Non0_acc_2: 0.6065  Non0_F1_score: 0.6041  Mult_acc_5: 0.2489  Mult_acc_7: 0.1878  MAE: 1.4127  Corr: 0.2897 
2024-06-13 18:17:51:INFO:TRAIN-(cmcm) (5/27/5)>> loss: 0.7360
2024-06-13 18:17:53:INFO:VAL-(cmcm) >>
2024-06-13 18:17:53:INFO:M: >>  Has0_acc_2: 0.6245  Has0_F1_score: 0.6264  Non0_acc_2: 0.6250  Non0_F1_score: 0.6212  Mult_acc_5: 0.3057  Mult_acc_7: 0.2402  MAE: 1.3678  Corr: 0.3831 
2024-06-13 18:18:08:INFO:TRAIN-(cmcm) (6/28/5)>> loss: 0.7221
2024-06-13 18:18:11:INFO:VAL-(cmcm) >>
2024-06-13 18:18:11:INFO:M: >>  Has0_acc_2: 0.6288  Has0_F1_score: 0.5669  Non0_acc_2: 0.6528  Non0_F1_score: 0.6042  Mult_acc_5: 0.3275  Mult_acc_7: 0.2314  MAE: 1.4887  Corr: 0.3559 
2024-06-13 18:18:26:INFO:TRAIN-(cmcm) (7/29/5)>> loss: 0.7150
2024-06-13 18:18:28:INFO:VAL-(cmcm) >>
2024-06-13 18:18:28:INFO:M: >>  Has0_acc_2: 0.6288  Has0_F1_score: 0.6220  Non0_acc_2: 0.6481  Non0_F1_score: 0.6490  Mult_acc_5: 0.2751  Mult_acc_7: 0.2052  MAE: 1.3761  Corr: 0.3617 
2024-06-13 18:18:43:INFO:TRAIN-(cmcm) (8/30/5)>> loss: 0.7192
2024-06-13 18:18:46:INFO:VAL-(cmcm) >>
2024-06-13 18:18:46:INFO:M: >>  Has0_acc_2: 0.6419  Has0_F1_score: 0.6309  Non0_acc_2: 0.6481  Non0_F1_score: 0.6456  Mult_acc_5: 0.3057  Mult_acc_7: 0.2445  MAE: 1.3053  Corr: 0.3659 
2024-06-13 18:19:01:INFO:TRAIN-(cmcm) (9/31/5)>> loss: 0.6925
2024-06-13 18:19:03:INFO:VAL-(cmcm) >>
2024-06-13 18:19:03:INFO:M: >>  Has0_acc_2: 0.6594  Has0_F1_score: 0.6594  Non0_acc_2: 0.6435  Non0_F1_score: 0.6453  Mult_acc_5: 0.2664  Mult_acc_7: 0.2271  MAE: 1.3302  Corr: 0.3743 
2024-06-13 18:19:18:INFO:TRAIN-(cmcm) (10/32/5)>> loss: 0.6979
2024-06-13 18:19:21:INFO:VAL-(cmcm) >>
2024-06-13 18:19:21:INFO:M: >>  Has0_acc_2: 0.6681  Has0_F1_score: 0.6625  Non0_acc_2: 0.6528  Non0_F1_score: 0.6499  Mult_acc_5: 0.3188  Mult_acc_7: 0.2402  MAE: 1.3778  Corr: 0.3418 
2024-06-13 18:19:28:INFO:TEST-(cmcm) >>
2024-06-13 18:19:28:INFO:M: >>  Has0_acc_2: 0.6370  Has0_F1_score: 0.6337  Non0_acc_2: 0.6418  Non0_F1_score: 0.6252  Mult_acc_5: 0.2595  Mult_acc_7: 0.2347  MAE: 1.2967  Corr: 0.3119 
2024-06-13 18:19:28:INFO:Results are added to results/results/mosi-regression-50.csv...
2024-06-13 18:19:28:INFO:Start running cmcm...
2024-06-13 18:19:28:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 6, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 60, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-06-13 18:19:28:INFO:Let's use the GPU 1 !
2024-06-13 18:19:28:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 18:19:29:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718273969 HTTP/1.1" 200 235
2024-06-13 18:19:29:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 18:19:29:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 18:19:30:INFO:train samples: (1284,)
2024-06-13 18:19:30:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 18:19:31:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718273971 HTTP/1.1" 200 235
2024-06-13 18:19:31:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 18:19:31:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 18:19:32:INFO:valid samples: (229,)
2024-06-13 18:19:32:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 18:19:32:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718273972 HTTP/1.1" 200 235
2024-06-13 18:19:32:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 18:19:33:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 18:19:33:INFO:test samples: (686,)
2024-06-13 18:19:33:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 18:19:34:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718273974 HTTP/1.1" 200 235
2024-06-13 18:19:34:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 18:19:34:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 18:19:35:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 18:19:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718273975 HTTP/1.1" 200 235
2024-06-13 18:19:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 18:19:36:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 18:19:36:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-13 18:19:36:WARNING:Try importing flash-attention for faster inference...
2024-06-13 18:19:36:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-13 18:19:36:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-13 18:19:36:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-13 18:19:37:INFO:trainable params: 1310288 || all params: 1838138960 || trainable%: 0.07128340286090232
2024-06-13 18:19:37:INFO:Init labels...
2024-06-13 18:19:37:INFO:Start training...
2024-06-13 18:19:52:INFO:TRAIN-(cmcm) (1/1/1)>> loss: 2.0702
2024-06-13 18:19:54:INFO:VAL-(cmcm) >>
2024-06-13 18:19:54:INFO:M: >>  Has0_acc_2: 0.5590  Has0_F1_score: 0.5124  Non0_acc_2: 0.5417  Non0_F1_score: 0.4929  Mult_acc_5: 0.1659  Mult_acc_7: 0.1659  MAE: 1.5602  Corr: -0.0358 
2024-06-13 18:19:55:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-13 18:20:10:INFO:TRAIN-(cmcm) (1/2/1)>> loss: 0.8981
2024-06-13 18:20:12:INFO:VAL-(cmcm) >>
2024-06-13 18:20:12:INFO:M: >>  Has0_acc_2: 0.4017  Has0_F1_score: 0.2303  Non0_acc_2: 0.4259  Non0_F1_score: 0.2544  Mult_acc_5: 0.1397  Mult_acc_7: 0.1397  MAE: 1.6628  Corr: -0.0744 
2024-06-13 18:20:27:INFO:TRAIN-(cmcm) (2/3/1)>> loss: 0.8843
2024-06-13 18:20:30:INFO:VAL-(cmcm) >>
2024-06-13 18:20:30:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5741  Non0_F1_score: 0.4187  Mult_acc_5: 0.2533  Mult_acc_7: 0.1878  MAE: 1.7065  Corr: -0.0542 
2024-06-13 18:20:45:INFO:TRAIN-(cmcm) (3/4/1)>> loss: 0.8826
2024-06-13 18:20:48:INFO:VAL-(cmcm) >>
2024-06-13 18:20:48:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4577  Non0_acc_2: 0.5787  Non0_F1_score: 0.4291  Mult_acc_5: 0.1878  Mult_acc_7: 0.1790  MAE: 1.5340  Corr: 0.0701 
2024-06-13 18:20:48:INFO:Saving checkpoint at epoch 4 to results/models/cmcm-mosi-regression.pth.
2024-06-13 18:21:03:INFO:TRAIN-(cmcm) (1/5/1)>> loss: 0.8749
2024-06-13 18:21:06:INFO:VAL-(cmcm) >>
2024-06-13 18:21:06:INFO:M: >>  Has0_acc_2: 0.5197  Has0_F1_score: 0.5127  Non0_acc_2: 0.5370  Non0_F1_score: 0.5294  Mult_acc_5: 0.1878  Mult_acc_7: 0.1485  MAE: 1.8813  Corr: 0.0609 
2024-06-13 18:21:20:INFO:TRAIN-(cmcm) (2/6/1)>> loss: 0.8720
2024-06-13 18:21:23:INFO:VAL-(cmcm) >>
2024-06-13 18:21:23:INFO:M: >>  Has0_acc_2: 0.5502  Has0_F1_score: 0.5252  Non0_acc_2: 0.5370  Non0_F1_score: 0.5101  Mult_acc_5: 0.2140  Mult_acc_7: 0.1790  MAE: 1.6715  Corr: -0.0013 
2024-06-13 18:21:38:INFO:TRAIN-(cmcm) (3/7/1)>> loss: 0.8668
2024-06-13 18:21:40:INFO:VAL-(cmcm) >>
2024-06-13 18:21:40:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.4951  Non0_acc_2: 0.5648  Non0_F1_score: 0.4684  Mult_acc_5: 0.3057  Mult_acc_7: 0.2227  MAE: 1.7765  Corr: -0.0108 
2024-06-13 18:21:55:INFO:TRAIN-(cmcm) (4/8/1)>> loss: 0.8666
2024-06-13 18:21:58:INFO:VAL-(cmcm) >>
2024-06-13 18:21:58:INFO:M: >>  Has0_acc_2: 0.5590  Has0_F1_score: 0.5297  Non0_acc_2: 0.5463  Non0_F1_score: 0.5148  Mult_acc_5: 0.1703  Mult_acc_7: 0.1703  MAE: 1.5440  Corr: 0.0282 
2024-06-13 18:22:13:INFO:TRAIN-(cmcm) (5/9/1)>> loss: 0.8574
2024-06-13 18:22:15:INFO:VAL-(cmcm) >>
2024-06-13 18:22:15:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4577  Non0_acc_2: 0.5787  Non0_F1_score: 0.4291  Mult_acc_5: 0.2009  Mult_acc_7: 0.1790  MAE: 1.5983  Corr: -0.0382 
2024-06-13 18:22:30:INFO:TRAIN-(cmcm) (6/10/1)>> loss: 0.8561
2024-06-13 18:22:33:INFO:VAL-(cmcm) >>
2024-06-13 18:22:33:INFO:M: >>  Has0_acc_2: 0.6201  Has0_F1_score: 0.5771  Non0_acc_2: 0.6111  Non0_F1_score: 0.5651  Mult_acc_5: 0.2926  Mult_acc_7: 0.2227  MAE: 1.6280  Corr: 0.1283 
2024-06-13 18:22:48:INFO:TRAIN-(cmcm) (7/11/1)>> loss: 0.8548
2024-06-13 18:22:50:INFO:VAL-(cmcm) >>
2024-06-13 18:22:50:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5446  Non0_acc_2: 0.5787  Non0_F1_score: 0.5306  Mult_acc_5: 0.2838  Mult_acc_7: 0.2009  MAE: 1.7582  Corr: 0.0414 
2024-06-13 18:23:05:INFO:TRAIN-(cmcm) (8/12/1)>> loss: 0.8444
2024-06-13 18:23:08:INFO:VAL-(cmcm) >>
2024-06-13 18:23:08:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.4769  Non0_acc_2: 0.4861  Non0_F1_score: 0.4881  Mult_acc_5: 0.2227  Mult_acc_7: 0.2227  MAE: 1.4187  Corr: 0.0354 
2024-06-13 18:23:08:INFO:Saving checkpoint at epoch 12 to results/models/cmcm-mosi-regression.pth.
2024-06-13 18:23:24:INFO:TRAIN-(cmcm) (1/13/1)>> loss: 0.8437
2024-06-13 18:23:26:INFO:VAL-(cmcm) >>
2024-06-13 18:23:26:INFO:M: >>  Has0_acc_2: 0.5633  Has0_F1_score: 0.5668  Non0_acc_2: 0.5787  Non0_F1_score: 0.5806  Mult_acc_5: 0.2751  Mult_acc_7: 0.2009  MAE: 1.7577  Corr: 0.1792 
2024-06-13 18:23:41:INFO:TRAIN-(cmcm) (2/14/1)>> loss: 0.8385
2024-06-13 18:23:44:INFO:VAL-(cmcm) >>
2024-06-13 18:23:44:INFO:M: >>  Has0_acc_2: 0.6550  Has0_F1_score: 0.6582  Non0_acc_2: 0.6620  Non0_F1_score: 0.6637  Mult_acc_5: 0.2533  Mult_acc_7: 0.2402  MAE: 1.3379  Corr: 0.2990 
2024-06-13 18:23:44:INFO:Saving checkpoint at epoch 14 to results/models/cmcm-mosi-regression.pth.
2024-06-13 18:23:59:INFO:TRAIN-(cmcm) (1/15/1)>> loss: 0.8376
2024-06-13 18:24:02:INFO:VAL-(cmcm) >>
2024-06-13 18:24:02:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4556  Non0_acc_2: 0.5741  Non0_F1_score: 0.4269  Mult_acc_5: 0.3013  Mult_acc_7: 0.2183  MAE: 1.7538  Corr: 0.0287 
2024-06-13 18:24:17:INFO:TRAIN-(cmcm) (2/16/1)>> loss: 0.8337
2024-06-13 18:24:20:INFO:VAL-(cmcm) >>
2024-06-13 18:24:20:INFO:M: >>  Has0_acc_2: 0.6245  Has0_F1_score: 0.5774  Non0_acc_2: 0.5648  Non0_F1_score: 0.5585  Mult_acc_5: 0.3057  Mult_acc_7: 0.2271  MAE: 1.4472  Corr: 0.2271 
2024-06-13 18:24:35:INFO:TRAIN-(cmcm) (3/17/1)>> loss: 0.8195
2024-06-13 18:24:38:INFO:VAL-(cmcm) >>
2024-06-13 18:24:38:INFO:M: >>  Has0_acc_2: 0.7118  Has0_F1_score: 0.7100  Non0_acc_2: 0.6713  Non0_F1_score: 0.6731  Mult_acc_5: 0.3712  Mult_acc_7: 0.3100  MAE: 1.1956  Corr: 0.4271 
2024-06-13 18:24:38:INFO:Saving checkpoint at epoch 17 to results/models/cmcm-mosi-regression.pth.
2024-06-13 18:24:53:INFO:TRAIN-(cmcm) (1/18/1)>> loss: 0.8118
2024-06-13 18:24:56:INFO:VAL-(cmcm) >>
2024-06-13 18:24:56:INFO:M: >>  Has0_acc_2: 0.6769  Has0_F1_score: 0.6799  Non0_acc_2: 0.6713  Non0_F1_score: 0.6731  Mult_acc_5: 0.3144  Mult_acc_7: 0.2533  MAE: 1.3280  Corr: 0.3655 
2024-06-13 18:25:11:INFO:TRAIN-(cmcm) (2/19/1)>> loss: 0.7973
2024-06-13 18:25:13:INFO:VAL-(cmcm) >>
2024-06-13 18:25:13:INFO:M: >>  Has0_acc_2: 0.6376  Has0_F1_score: 0.5418  Non0_acc_2: 0.6204  Non0_F1_score: 0.5207  Mult_acc_5: 0.3493  Mult_acc_7: 0.2576  MAE: 1.4733  Corr: 0.3681 
2024-06-13 18:25:28:INFO:TRAIN-(cmcm) (3/20/1)>> loss: 0.7922
2024-06-13 18:25:31:INFO:VAL-(cmcm) >>
2024-06-13 18:25:31:INFO:M: >>  Has0_acc_2: 0.7162  Has0_F1_score: 0.6939  Non0_acc_2: 0.7037  Non0_F1_score: 0.6813  Mult_acc_5: 0.3406  Mult_acc_7: 0.2445  MAE: 1.2353  Corr: 0.5008 
2024-06-13 18:25:46:INFO:TRAIN-(cmcm) (4/21/1)>> loss: 0.7757
2024-06-13 18:25:48:INFO:VAL-(cmcm) >>
2024-06-13 18:25:48:INFO:M: >>  Has0_acc_2: 0.6900  Has0_F1_score: 0.6891  Non0_acc_2: 0.6991  Non0_F1_score: 0.6978  Mult_acc_5: 0.3362  Mult_acc_7: 0.2445  MAE: 1.3529  Corr: 0.3871 
2024-06-13 18:26:03:INFO:TRAIN-(cmcm) (5/22/1)>> loss: 0.7666
2024-06-13 18:26:06:INFO:VAL-(cmcm) >>
2024-06-13 18:26:06:INFO:M: >>  Has0_acc_2: 0.6943  Has0_F1_score: 0.6732  Non0_acc_2: 0.6898  Non0_F1_score: 0.6692  Mult_acc_5: 0.3712  Mult_acc_7: 0.2882  MAE: 1.2219  Corr: 0.4527 
2024-06-13 18:26:21:INFO:TRAIN-(cmcm) (6/23/1)>> loss: 0.7558
2024-06-13 18:26:23:INFO:VAL-(cmcm) >>
2024-06-13 18:26:23:INFO:M: >>  Has0_acc_2: 0.6856  Has0_F1_score: 0.6407  Non0_acc_2: 0.6852  Non0_F1_score: 0.6453  Mult_acc_5: 0.3537  Mult_acc_7: 0.2620  MAE: 1.2883  Corr: 0.4924 
2024-06-13 18:26:38:INFO:TRAIN-(cmcm) (7/24/1)>> loss: 0.7550
2024-06-13 18:26:41:INFO:VAL-(cmcm) >>
2024-06-13 18:26:41:INFO:M: >>  Has0_acc_2: 0.6900  Has0_F1_score: 0.6637  Non0_acc_2: 0.7083  Non0_F1_score: 0.7028  Mult_acc_5: 0.3712  Mult_acc_7: 0.3100  MAE: 1.1606  Corr: 0.5011 
2024-06-13 18:26:41:INFO:Saving checkpoint at epoch 24 to results/models/cmcm-mosi-regression.pth.
2024-06-13 18:26:57:INFO:TRAIN-(cmcm) (1/25/1)>> loss: 0.7414
2024-06-13 18:26:59:INFO:VAL-(cmcm) >>
2024-06-13 18:26:59:INFO:M: >>  Has0_acc_2: 0.7031  Has0_F1_score: 0.6749  Non0_acc_2: 0.7176  Non0_F1_score: 0.6971  Mult_acc_5: 0.3755  Mult_acc_7: 0.3144  MAE: 1.1608  Corr: 0.5300 
2024-06-13 18:27:14:INFO:TRAIN-(cmcm) (2/26/1)>> loss: 0.7301
2024-06-13 18:27:17:INFO:VAL-(cmcm) >>
2024-06-13 18:27:17:INFO:M: >>  Has0_acc_2: 0.7205  Has0_F1_score: 0.7043  Non0_acc_2: 0.7315  Non0_F1_score: 0.7172  Mult_acc_5: 0.3537  Mult_acc_7: 0.2620  MAE: 1.2848  Corr: 0.4761 
2024-06-13 18:27:32:INFO:TRAIN-(cmcm) (3/27/1)>> loss: 0.7174
2024-06-13 18:27:34:INFO:VAL-(cmcm) >>
2024-06-13 18:27:34:INFO:M: >>  Has0_acc_2: 0.6812  Has0_F1_score: 0.6563  Non0_acc_2: 0.7222  Non0_F1_score: 0.7156  Mult_acc_5: 0.3668  Mult_acc_7: 0.3057  MAE: 1.1774  Corr: 0.5220 
2024-06-13 18:27:49:INFO:TRAIN-(cmcm) (4/28/1)>> loss: 0.7183
2024-06-13 18:27:52:INFO:VAL-(cmcm) >>
2024-06-13 18:27:52:INFO:M: >>  Has0_acc_2: 0.6943  Has0_F1_score: 0.6964  Non0_acc_2: 0.7130  Non0_F1_score: 0.7143  Mult_acc_5: 0.3668  Mult_acc_7: 0.2882  MAE: 1.2245  Corr: 0.4518 
2024-06-13 18:28:07:INFO:TRAIN-(cmcm) (5/29/1)>> loss: 0.7028
2024-06-13 18:28:09:INFO:VAL-(cmcm) >>
2024-06-13 18:28:09:INFO:M: >>  Has0_acc_2: 0.6725  Has0_F1_score: 0.6753  Non0_acc_2: 0.6481  Non0_F1_score: 0.6496  Mult_acc_5: 0.3057  Mult_acc_7: 0.2576  MAE: 1.2191  Corr: 0.4442 
2024-06-13 18:28:24:INFO:TRAIN-(cmcm) (6/30/1)>> loss: 0.6997
2024-06-13 18:28:27:INFO:VAL-(cmcm) >>
2024-06-13 18:28:27:INFO:M: >>  Has0_acc_2: 0.7031  Has0_F1_score: 0.6915  Non0_acc_2: 0.7361  Non0_F1_score: 0.7373  Mult_acc_5: 0.3624  Mult_acc_7: 0.2882  MAE: 1.1485  Corr: 0.5205 
2024-06-13 18:28:27:INFO:Saving checkpoint at epoch 30 to results/models/cmcm-mosi-regression.pth.
2024-06-13 18:28:42:INFO:TRAIN-(cmcm) (1/31/1)>> loss: 0.6823
2024-06-13 18:28:45:INFO:VAL-(cmcm) >>
2024-06-13 18:28:45:INFO:M: >>  Has0_acc_2: 0.6943  Has0_F1_score: 0.6882  Non0_acc_2: 0.6991  Non0_F1_score: 0.6934  Mult_acc_5: 0.3624  Mult_acc_7: 0.2707  MAE: 1.2485  Corr: 0.4708 
2024-06-13 18:29:00:INFO:TRAIN-(cmcm) (2/32/1)>> loss: 0.6746
2024-06-13 18:29:02:INFO:VAL-(cmcm) >>
2024-06-13 18:29:02:INFO:M: >>  Has0_acc_2: 0.7031  Has0_F1_score: 0.6927  Non0_acc_2: 0.6204  Non0_F1_score: 0.6169  Mult_acc_5: 0.3231  Mult_acc_7: 0.2533  MAE: 1.2475  Corr: 0.4358 
2024-06-13 18:29:17:INFO:TRAIN-(cmcm) (3/33/1)>> loss: 0.6737
2024-06-13 18:29:20:INFO:VAL-(cmcm) >>
2024-06-13 18:29:20:INFO:M: >>  Has0_acc_2: 0.7293  Has0_F1_score: 0.7282  Non0_acc_2: 0.7269  Non0_F1_score: 0.7267  Mult_acc_5: 0.3755  Mult_acc_7: 0.2707  MAE: 1.3106  Corr: 0.4645 
2024-06-13 18:29:35:INFO:TRAIN-(cmcm) (4/34/1)>> loss: 0.6543
2024-06-13 18:29:37:INFO:VAL-(cmcm) >>
2024-06-13 18:29:37:INFO:M: >>  Has0_acc_2: 0.6812  Has0_F1_score: 0.6521  Non0_acc_2: 0.7037  Non0_F1_score: 0.6880  Mult_acc_5: 0.3668  Mult_acc_7: 0.2882  MAE: 1.2804  Corr: 0.4472 
2024-06-13 18:29:52:INFO:TRAIN-(cmcm) (5/35/1)>> loss: 0.6485
2024-06-13 18:29:55:INFO:VAL-(cmcm) >>
2024-06-13 18:29:55:INFO:M: >>  Has0_acc_2: 0.6987  Has0_F1_score: 0.6931  Non0_acc_2: 0.7037  Non0_F1_score: 0.7051  Mult_acc_5: 0.3406  Mult_acc_7: 0.2926  MAE: 1.2053  Corr: 0.4451 
2024-06-13 18:30:10:INFO:TRAIN-(cmcm) (6/36/1)>> loss: 0.6329
2024-06-13 18:30:13:INFO:VAL-(cmcm) >>
2024-06-13 18:30:13:INFO:M: >>  Has0_acc_2: 0.7074  Has0_F1_score: 0.7020  Non0_acc_2: 0.7176  Non0_F1_score: 0.7164  Mult_acc_5: 0.3930  Mult_acc_7: 0.3100  MAE: 1.1809  Corr: 0.4921 
2024-06-13 18:30:27:INFO:TRAIN-(cmcm) (7/37/1)>> loss: 0.6238
2024-06-13 18:30:30:INFO:VAL-(cmcm) >>
2024-06-13 18:30:30:INFO:M: >>  Has0_acc_2: 0.6900  Has0_F1_score: 0.6758  Non0_acc_2: 0.6852  Non0_F1_score: 0.6836  Mult_acc_5: 0.3406  Mult_acc_7: 0.2795  MAE: 1.2359  Corr: 0.4430 
2024-06-13 18:30:45:INFO:TRAIN-(cmcm) (8/38/1)>> loss: 0.6074
2024-06-13 18:30:48:INFO:VAL-(cmcm) >>
2024-06-13 18:30:48:INFO:M: >>  Has0_acc_2: 0.6987  Has0_F1_score: 0.6949  Non0_acc_2: 0.7037  Non0_F1_score: 0.7052  Mult_acc_5: 0.3537  Mult_acc_7: 0.2751  MAE: 1.2106  Corr: 0.4691 
2024-06-13 18:31:03:INFO:TRAIN-(cmcm) (9/39/1)>> loss: 0.5950
2024-06-13 18:31:05:INFO:VAL-(cmcm) >>
2024-06-13 18:31:05:INFO:M: >>  Has0_acc_2: 0.7118  Has0_F1_score: 0.7107  Non0_acc_2: 0.7176  Non0_F1_score: 0.7169  Mult_acc_5: 0.3537  Mult_acc_7: 0.2882  MAE: 1.2512  Corr: 0.4434 
2024-06-13 18:31:20:INFO:TRAIN-(cmcm) (10/40/1)>> loss: 0.5731
2024-06-13 18:31:23:INFO:VAL-(cmcm) >>
2024-06-13 18:31:23:INFO:M: >>  Has0_acc_2: 0.6900  Has0_F1_score: 0.6727  Non0_acc_2: 0.6944  Non0_F1_score: 0.6872  Mult_acc_5: 0.3450  Mult_acc_7: 0.2751  MAE: 1.2368  Corr: 0.4542 
2024-06-13 18:31:30:INFO:TEST-(cmcm) >>
2024-06-13 18:31:30:INFO:M: >>  Has0_acc_2: 0.6778  Has0_F1_score: 0.6768  Non0_acc_2: 0.7180  Non0_F1_score: 0.7175  Mult_acc_5: 0.3338  Mult_acc_7: 0.2857  MAE: 1.2048  Corr: 0.4649 
2024-06-13 18:31:30:INFO:Results are added to results/results/mosi-regression-60.csv...
2024-06-13 18:31:30:INFO:Start running cmcm...
2024-06-13 18:31:30:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 6, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 60, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 2222}>
2024-06-13 18:31:30:INFO:Let's use the GPU 1 !
2024-06-13 18:31:31:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 18:31:31:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718274691 HTTP/1.1" 200 235
2024-06-13 18:31:31:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 18:31:32:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 18:31:32:INFO:train samples: (1284,)
2024-06-13 18:31:33:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 18:31:33:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718274693 HTTP/1.1" 200 235
2024-06-13 18:31:33:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 18:31:34:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 18:31:34:INFO:valid samples: (229,)
2024-06-13 18:31:34:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 18:31:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718274695 HTTP/1.1" 200 235
2024-06-13 18:31:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 18:31:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 18:31:36:INFO:test samples: (686,)
2024-06-13 18:31:36:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 18:31:36:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718274696 HTTP/1.1" 200 235
2024-06-13 18:31:36:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 18:31:37:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 18:31:37:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 18:31:37:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718274697 HTTP/1.1" 200 235
2024-06-13 18:31:37:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 18:31:38:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 18:31:38:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-13 18:31:38:WARNING:Try importing flash-attention for faster inference...
2024-06-13 18:31:38:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-13 18:31:38:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-13 18:31:38:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-13 18:31:39:INFO:trainable params: 1310288 || all params: 1838138960 || trainable%: 0.07128340286090232
2024-06-13 18:31:39:INFO:Init labels...
2024-06-13 18:31:39:INFO:Start training...
2024-06-13 18:31:54:INFO:TRAIN-(cmcm) (1/1/2)>> loss: 2.2806
2024-06-13 18:31:57:INFO:VAL-(cmcm) >>
2024-06-13 18:31:57:INFO:M: >>  Has0_acc_2: 0.5371  Has0_F1_score: 0.5307  Non0_acc_2: 0.5324  Non0_F1_score: 0.5263  Mult_acc_5: 0.1528  Mult_acc_7: 0.1485  MAE: 1.6816  Corr: -0.0133 
2024-06-13 18:31:57:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-13 18:32:12:INFO:TRAIN-(cmcm) (1/2/2)>> loss: 0.9614
2024-06-13 18:32:15:INFO:VAL-(cmcm) >>
2024-06-13 18:32:15:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5741  Non0_F1_score: 0.4187  Mult_acc_5: 0.1965  Mult_acc_7: 0.1834  MAE: 1.6375  Corr: -0.0965 
2024-06-13 18:32:15:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-13 18:32:30:INFO:TRAIN-(cmcm) (1/3/2)>> loss: 0.9238
2024-06-13 18:32:33:INFO:VAL-(cmcm) >>
2024-06-13 18:32:33:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.5140  Non0_acc_2: 0.5648  Non0_F1_score: 0.4978  Mult_acc_5: 0.2882  Mult_acc_7: 0.2096  MAE: 1.6839  Corr: 0.0069 
2024-06-13 18:32:48:INFO:TRAIN-(cmcm) (2/4/2)>> loss: 0.8985
2024-06-13 18:32:50:INFO:VAL-(cmcm) >>
2024-06-13 18:32:50:INFO:M: >>  Has0_acc_2: 0.6157  Has0_F1_score: 0.5222  Non0_acc_2: 0.5972  Non0_F1_score: 0.5000  Mult_acc_5: 0.2140  Mult_acc_7: 0.1703  MAE: 1.5654  Corr: 0.1327 
2024-06-13 18:32:51:INFO:Saving checkpoint at epoch 4 to results/models/cmcm-mosi-regression.pth.
2024-06-13 18:33:06:INFO:TRAIN-(cmcm) (1/5/2)>> loss: 0.8880
2024-06-13 18:33:09:INFO:VAL-(cmcm) >>
2024-06-13 18:33:09:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.5382  Non0_acc_2: 0.5694  Non0_F1_score: 0.5203  Mult_acc_5: 0.2271  Mult_acc_7: 0.1790  MAE: 1.6551  Corr: 0.0451 
2024-06-13 18:33:24:INFO:TRAIN-(cmcm) (2/6/2)>> loss: 0.8784
2024-06-13 18:33:26:INFO:VAL-(cmcm) >>
2024-06-13 18:33:26:INFO:M: >>  Has0_acc_2: 0.5590  Has0_F1_score: 0.5156  Non0_acc_2: 0.5463  Non0_F1_score: 0.4997  Mult_acc_5: 0.2096  Mult_acc_7: 0.1703  MAE: 1.7292  Corr: -0.0293 
2024-06-13 18:33:41:INFO:TRAIN-(cmcm) (3/7/2)>> loss: 0.8765
2024-06-13 18:33:44:INFO:VAL-(cmcm) >>
2024-06-13 18:33:44:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.5141  Non0_acc_2: 0.5880  Non0_F1_score: 0.4885  Mult_acc_5: 0.2664  Mult_acc_7: 0.1965  MAE: 1.6673  Corr: 0.0826 
2024-06-13 18:33:59:INFO:TRAIN-(cmcm) (4/8/2)>> loss: 0.8648
2024-06-13 18:34:01:INFO:VAL-(cmcm) >>
2024-06-13 18:34:01:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.4996  Non0_acc_2: 0.5648  Non0_F1_score: 0.4791  Mult_acc_5: 0.2882  Mult_acc_7: 0.2096  MAE: 1.7512  Corr: -0.0055 
2024-06-13 18:34:16:INFO:TRAIN-(cmcm) (5/9/2)>> loss: 0.8644
2024-06-13 18:34:19:INFO:VAL-(cmcm) >>
2024-06-13 18:34:19:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4742  Non0_acc_2: 0.5694  Non0_F1_score: 0.4465  Mult_acc_5: 0.2926  Mult_acc_7: 0.2096  MAE: 1.7416  Corr: 0.0214 
2024-06-13 18:34:34:INFO:TRAIN-(cmcm) (6/10/2)>> loss: 0.8774
2024-06-13 18:34:37:INFO:VAL-(cmcm) >>
2024-06-13 18:34:37:INFO:M: >>  Has0_acc_2: 0.5153  Has0_F1_score: 0.5178  Non0_acc_2: 0.5231  Non0_F1_score: 0.5228  Mult_acc_5: 0.2358  Mult_acc_7: 0.1965  MAE: 1.8171  Corr: -0.0155 
2024-06-13 18:34:52:INFO:TRAIN-(cmcm) (7/11/2)>> loss: 0.8610
2024-06-13 18:34:54:INFO:VAL-(cmcm) >>
2024-06-13 18:34:54:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5070  Non0_acc_2: 0.5787  Non0_F1_score: 0.5632  Mult_acc_5: 0.2751  Mult_acc_7: 0.2052  MAE: 1.6791  Corr: 0.0445 
2024-06-13 18:35:09:INFO:TRAIN-(cmcm) (8/12/2)>> loss: 0.8548
2024-06-13 18:35:12:INFO:VAL-(cmcm) >>
2024-06-13 18:35:12:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5109  Non0_acc_2: 0.5556  Non0_F1_score: 0.4913  Mult_acc_5: 0.2533  Mult_acc_7: 0.2052  MAE: 1.6632  Corr: -0.0071 
2024-06-13 18:35:27:INFO:TRAIN-(cmcm) (9/13/2)>> loss: 0.8531
2024-06-13 18:35:29:INFO:VAL-(cmcm) >>
2024-06-13 18:35:29:INFO:M: >>  Has0_acc_2: 0.5284  Has0_F1_score: 0.5329  Non0_acc_2: 0.5231  Non0_F1_score: 0.5257  Mult_acc_5: 0.2402  Mult_acc_7: 0.1878  MAE: 1.7053  Corr: 0.0220 
2024-06-13 18:35:44:INFO:TRAIN-(cmcm) (10/14/2)>> loss: 0.8494
2024-06-13 18:35:47:INFO:VAL-(cmcm) >>
2024-06-13 18:35:47:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.5178  Non0_acc_2: 0.5694  Non0_F1_score: 0.5052  Mult_acc_5: 0.2882  Mult_acc_7: 0.2096  MAE: 1.7057  Corr: 0.0214 
2024-06-13 18:35:54:INFO:TEST-(cmcm) >>
2024-06-13 18:35:54:INFO:M: >>  Has0_acc_2: 0.4854  Has0_F1_score: 0.3945  Non0_acc_2: 0.4634  Non0_F1_score: 0.3740  Mult_acc_5: 0.1953  Mult_acc_7: 0.1808  MAE: 1.9040  Corr: 0.0542 
2024-06-13 18:35:55:INFO:Results are added to results/results/mosi-regression-60.csv...
2024-06-13 18:35:55:INFO:Start running cmcm...
2024-06-13 18:35:55:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 6, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 60, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 3333}>
2024-06-13 18:35:55:INFO:Let's use the GPU 1 !
2024-06-13 18:35:55:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 18:35:55:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718274955 HTTP/1.1" 200 235
2024-06-13 18:35:55:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 18:35:56:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 18:35:56:INFO:train samples: (1284,)
2024-06-13 18:35:56:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 18:35:57:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718274957 HTTP/1.1" 200 235
2024-06-13 18:35:57:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 18:35:57:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 18:35:58:INFO:valid samples: (229,)
2024-06-13 18:35:58:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 18:35:58:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718274958 HTTP/1.1" 200 235
2024-06-13 18:35:59:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 18:35:59:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 18:35:59:INFO:test samples: (686,)
2024-06-13 18:35:59:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 18:36:00:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718274960 HTTP/1.1" 200 235
2024-06-13 18:36:00:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 18:36:01:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 18:36:01:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 18:36:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718274962 HTTP/1.1" 200 235
2024-06-13 18:36:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 18:36:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 18:36:02:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-13 18:36:02:WARNING:Try importing flash-attention for faster inference...
2024-06-13 18:36:02:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-13 18:36:02:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-13 18:36:02:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-13 18:36:03:INFO:trainable params: 1310288 || all params: 1838138960 || trainable%: 0.07128340286090232
2024-06-13 18:36:03:INFO:Init labels...
2024-06-13 18:36:03:INFO:Start training...
2024-06-13 18:36:18:INFO:TRAIN-(cmcm) (1/1/3)>> loss: 2.3130
2024-06-13 18:36:21:INFO:VAL-(cmcm) >>
2024-06-13 18:36:21:INFO:M: >>  Has0_acc_2: 0.5459  Has0_F1_score: 0.5368  Non0_acc_2: 0.5417  Non0_F1_score: 0.5330  Mult_acc_5: 0.2576  Mult_acc_7: 0.1921  MAE: 1.6769  Corr: 0.0652 
2024-06-13 18:36:21:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-13 18:36:36:INFO:TRAIN-(cmcm) (1/2/3)>> loss: 0.9497
2024-06-13 18:36:39:INFO:VAL-(cmcm) >>
2024-06-13 18:36:39:INFO:M: >>  Has0_acc_2: 0.5153  Has0_F1_score: 0.5144  Non0_acc_2: 0.5139  Non0_F1_score: 0.5100  Mult_acc_5: 0.1790  Mult_acc_7: 0.1485  MAE: 1.7598  Corr: 0.0904 
2024-06-13 18:36:54:INFO:TRAIN-(cmcm) (2/3/3)>> loss: 0.8916
2024-06-13 18:36:56:INFO:VAL-(cmcm) >>
2024-06-13 18:36:56:INFO:M: >>  Has0_acc_2: 0.5546  Has0_F1_score: 0.5372  Non0_acc_2: 0.5509  Non0_F1_score: 0.5304  Mult_acc_5: 0.2402  Mult_acc_7: 0.1921  MAE: 1.7287  Corr: 0.0302 
2024-06-13 18:37:11:INFO:TRAIN-(cmcm) (3/4/3)>> loss: 0.8846
2024-06-13 18:37:14:INFO:VAL-(cmcm) >>
2024-06-13 18:37:14:INFO:M: >>  Has0_acc_2: 0.5633  Has0_F1_score: 0.5647  Non0_acc_2: 0.5602  Non0_F1_score: 0.5599  Mult_acc_5: 0.2489  Mult_acc_7: 0.1747  MAE: 1.7407  Corr: 0.0675 
2024-06-13 18:37:29:INFO:TRAIN-(cmcm) (4/5/3)>> loss: 0.8787
2024-06-13 18:37:32:INFO:VAL-(cmcm) >>
2024-06-13 18:37:32:INFO:M: >>  Has0_acc_2: 0.5371  Has0_F1_score: 0.5170  Non0_acc_2: 0.5278  Non0_F1_score: 0.5051  Mult_acc_5: 0.2314  Mult_acc_7: 0.1878  MAE: 1.7004  Corr: -0.0798 
2024-06-13 18:37:47:INFO:TRAIN-(cmcm) (5/6/3)>> loss: 0.8695
2024-06-13 18:37:49:INFO:VAL-(cmcm) >>
2024-06-13 18:37:49:INFO:M: >>  Has0_acc_2: 0.5415  Has0_F1_score: 0.5452  Non0_acc_2: 0.5509  Non0_F1_score: 0.5522  Mult_acc_5: 0.2489  Mult_acc_7: 0.1616  MAE: 1.8547  Corr: 0.0781 
2024-06-13 18:38:04:INFO:TRAIN-(cmcm) (6/7/3)>> loss: 0.8710
2024-06-13 18:38:07:INFO:VAL-(cmcm) >>
2024-06-13 18:38:07:INFO:M: >>  Has0_acc_2: 0.5590  Has0_F1_score: 0.5522  Non0_acc_2: 0.5556  Non0_F1_score: 0.5465  Mult_acc_5: 0.2795  Mult_acc_7: 0.2009  MAE: 1.7062  Corr: 0.0575 
2024-06-13 18:38:22:INFO:TRAIN-(cmcm) (7/8/3)>> loss: 1.4055
2024-06-13 18:38:24:INFO:VAL-(cmcm) >>
2024-06-13 18:38:24:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4676  Non0_acc_2: 0.5417  Non0_F1_score: 0.5112  Mult_acc_5: 0.1659  Mult_acc_7: 0.1659  MAE: 1.4663  Corr: -0.0318 
2024-06-13 18:38:25:INFO:Saving checkpoint at epoch 8 to results/models/cmcm-mosi-regression.pth.
2024-06-13 18:38:40:INFO:TRAIN-(cmcm) (1/9/3)>> loss: 0.8910
2024-06-13 18:38:43:INFO:VAL-(cmcm) >>
2024-06-13 18:38:43:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4830  Non0_acc_2: 0.5741  Non0_F1_score: 0.4558  Mult_acc_5: 0.2314  Mult_acc_7: 0.1659  MAE: 1.6280  Corr: -0.0084 
2024-06-13 18:38:58:INFO:TRAIN-(cmcm) (2/10/3)>> loss: 0.8809
2024-06-13 18:39:00:INFO:VAL-(cmcm) >>
2024-06-13 18:39:00:INFO:M: >>  Has0_acc_2: 0.5371  Has0_F1_score: 0.4964  Non0_acc_2: 0.5231  Non0_F1_score: 0.4826  Mult_acc_5: 0.1659  Mult_acc_7: 0.1659  MAE: 1.6034  Corr: -0.0405 
2024-06-13 18:39:15:INFO:TRAIN-(cmcm) (3/11/3)>> loss: 0.8723
2024-06-13 18:39:18:INFO:VAL-(cmcm) >>
2024-06-13 18:39:18:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5070  Non0_acc_2: 0.5602  Non0_F1_score: 0.4945  Mult_acc_5: 0.2795  Mult_acc_7: 0.1965  MAE: 1.6839  Corr: 0.0222 
2024-06-13 18:39:33:INFO:TRAIN-(cmcm) (4/12/3)>> loss: 0.8665
2024-06-13 18:39:35:INFO:VAL-(cmcm) >>
2024-06-13 18:39:35:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.4491  Non0_acc_2: 0.5556  Non0_F1_score: 0.4178  Mult_acc_5: 0.1659  Mult_acc_7: 0.1659  MAE: 1.5602  Corr: -0.0470 
2024-06-13 18:39:50:INFO:TRAIN-(cmcm) (5/13/3)>> loss: 0.8663
2024-06-13 18:39:53:INFO:VAL-(cmcm) >>
2024-06-13 18:39:53:INFO:M: >>  Has0_acc_2: 0.5590  Has0_F1_score: 0.5124  Non0_acc_2: 0.5509  Non0_F1_score: 0.5031  Mult_acc_5: 0.2358  Mult_acc_7: 0.1747  MAE: 1.7075  Corr: -0.0043 
2024-06-13 18:40:08:INFO:TRAIN-(cmcm) (6/14/3)>> loss: 0.8614
2024-06-13 18:40:10:INFO:VAL-(cmcm) >>
2024-06-13 18:40:10:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.5079  Non0_acc_2: 0.5509  Non0_F1_score: 0.4881  Mult_acc_5: 0.2795  Mult_acc_7: 0.2009  MAE: 1.7625  Corr: -0.0229 
2024-06-13 18:40:25:INFO:TRAIN-(cmcm) (7/15/3)>> loss: 0.8632
2024-06-13 18:40:28:INFO:VAL-(cmcm) >>
2024-06-13 18:40:28:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4978  Non0_acc_2: 0.5694  Non0_F1_score: 0.4713  Mult_acc_5: 0.3057  Mult_acc_7: 0.2227  MAE: 1.6830  Corr: -0.0005 
2024-06-13 18:40:43:INFO:TRAIN-(cmcm) (8/16/3)>> loss: 0.8592
2024-06-13 18:40:45:INFO:VAL-(cmcm) >>
2024-06-13 18:40:45:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.4653  Non0_acc_2: 0.5648  Non0_F1_score: 0.4371  Mult_acc_5: 0.2969  Mult_acc_7: 0.2140  MAE: 1.6752  Corr: 0.0041 
2024-06-13 18:41:01:INFO:TRAIN-(cmcm) (9/17/3)>> loss: 0.8552
2024-06-13 18:41:03:INFO:VAL-(cmcm) >>
2024-06-13 18:41:03:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.5032  Non0_acc_2: 0.5787  Non0_F1_score: 0.4827  Mult_acc_5: 0.2751  Mult_acc_7: 0.1965  MAE: 1.6368  Corr: 0.0006 
2024-06-13 18:41:18:INFO:TRAIN-(cmcm) (10/18/3)>> loss: 0.8565
2024-06-13 18:41:21:INFO:VAL-(cmcm) >>
2024-06-13 18:41:21:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5833  Non0_F1_score: 0.4469  Mult_acc_5: 0.2795  Mult_acc_7: 0.2009  MAE: 1.6271  Corr: 0.0262 
2024-06-13 18:41:28:INFO:TEST-(cmcm) >>
2024-06-13 18:41:28:INFO:M: >>  Has0_acc_2: 0.4738  Has0_F1_score: 0.3486  Non0_acc_2: 0.4756  Non0_F1_score: 0.4447  Mult_acc_5: 0.1720  Mult_acc_7: 0.1706  MAE: 1.5305  Corr: 0.0591 
2024-06-13 18:41:28:INFO:Results are added to results/results/mosi-regression-60.csv...
2024-06-13 18:41:28:INFO:Start running cmcm...
2024-06-13 18:41:28:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 6, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 60, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 4444}>
2024-06-13 18:41:28:INFO:Let's use the GPU 1 !
2024-06-13 18:41:29:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 18:41:29:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718275289 HTTP/1.1" 200 235
2024-06-13 18:41:29:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 18:41:29:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 18:41:30:INFO:train samples: (1284,)
2024-06-13 18:41:30:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 18:41:31:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718275291 HTTP/1.1" 200 235
2024-06-13 18:41:31:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 18:41:31:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 18:41:32:INFO:valid samples: (229,)
2024-06-13 18:41:32:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 18:41:32:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718275292 HTTP/1.1" 200 235
2024-06-13 18:41:33:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 18:41:33:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 18:41:33:INFO:test samples: (686,)
2024-06-13 18:41:33:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 18:41:34:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718275294 HTTP/1.1" 200 235
2024-06-13 18:41:34:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 18:41:34:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 18:41:35:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 18:41:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718275295 HTTP/1.1" 200 235
2024-06-13 18:41:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 18:41:36:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 18:41:36:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-13 18:41:36:WARNING:Try importing flash-attention for faster inference...
2024-06-13 18:41:36:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-13 18:41:36:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-13 18:41:36:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-13 18:41:37:INFO:trainable params: 1310288 || all params: 1838138960 || trainable%: 0.07128340286090232
2024-06-13 18:41:37:INFO:Init labels...
2024-06-13 18:41:37:INFO:Start training...
2024-06-13 18:41:52:INFO:TRAIN-(cmcm) (1/1/4)>> loss: 2.8281
2024-06-13 18:41:55:INFO:VAL-(cmcm) >>
2024-06-13 18:41:55:INFO:M: >>  Has0_acc_2: 0.5546  Has0_F1_score: 0.5092  Non0_acc_2: 0.5417  Non0_F1_score: 0.4929  Mult_acc_5: 0.1790  Mult_acc_7: 0.1790  MAE: 1.5694  Corr: -0.0148 
2024-06-13 18:41:55:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-13 18:42:10:INFO:TRAIN-(cmcm) (1/2/4)>> loss: 0.9577
2024-06-13 18:42:13:INFO:VAL-(cmcm) >>
2024-06-13 18:42:13:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4652  Non0_acc_2: 0.5787  Non0_F1_score: 0.4516  Mult_acc_5: 0.1659  Mult_acc_7: 0.1659  MAE: 1.4702  Corr: 0.0445 
2024-06-13 18:42:13:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-13 18:42:29:INFO:TRAIN-(cmcm) (1/3/4)>> loss: 0.9170
2024-06-13 18:42:31:INFO:VAL-(cmcm) >>
2024-06-13 18:42:31:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.5282  Non0_acc_2: 0.5556  Non0_F1_score: 0.5132  Mult_acc_5: 0.2183  Mult_acc_7: 0.1921  MAE: 1.6318  Corr: 0.0314 
2024-06-13 18:42:47:INFO:TRAIN-(cmcm) (2/4/4)>> loss: 0.8904
2024-06-13 18:42:49:INFO:VAL-(cmcm) >>
2024-06-13 18:42:49:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.5099  Non0_acc_2: 0.5602  Non0_F1_score: 0.4902  Mult_acc_5: 0.2489  Mult_acc_7: 0.2227  MAE: 1.6402  Corr: 0.0043 
2024-06-13 18:43:04:INFO:TRAIN-(cmcm) (3/5/4)>> loss: 0.8736
2024-06-13 18:43:07:INFO:VAL-(cmcm) >>
2024-06-13 18:43:07:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4917  Non0_acc_2: 0.5787  Non0_F1_score: 0.4649  Mult_acc_5: 0.2271  Mult_acc_7: 0.1965  MAE: 1.5576  Corr: 0.0489 
2024-06-13 18:43:22:INFO:TRAIN-(cmcm) (4/6/4)>> loss: 1.1068
2024-06-13 18:43:24:INFO:VAL-(cmcm) >>
2024-06-13 18:43:24:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.4606  Non0_acc_2: 0.5787  Non0_F1_score: 0.4711  Mult_acc_5: 0.1878  Mult_acc_7: 0.1834  MAE: 1.4838  Corr: 0.0426 
2024-06-13 18:43:39:INFO:TRAIN-(cmcm) (5/7/4)>> loss: 0.9052
2024-06-13 18:43:42:INFO:VAL-(cmcm) >>
2024-06-13 18:43:42:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5741  Non0_F1_score: 0.4187  Mult_acc_5: 0.1616  Mult_acc_7: 0.1616  MAE: 1.5244  Corr: 0.0369 
2024-06-13 18:43:57:INFO:TRAIN-(cmcm) (6/8/4)>> loss: 0.8754
2024-06-13 18:43:59:INFO:VAL-(cmcm) >>
2024-06-13 18:43:59:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5184  Non0_acc_2: 0.5556  Non0_F1_score: 0.4993  Mult_acc_5: 0.2358  Mult_acc_7: 0.1572  MAE: 1.7341  Corr: 0.0204 
2024-06-13 18:44:14:INFO:TRAIN-(cmcm) (7/9/4)>> loss: 0.8591
2024-06-13 18:44:17:INFO:VAL-(cmcm) >>
2024-06-13 18:44:17:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5876  Non0_acc_2: 0.6065  Non0_F1_score: 0.6025  Mult_acc_5: 0.2052  Mult_acc_7: 0.1703  MAE: 1.4883  Corr: 0.2714 
2024-06-13 18:44:32:INFO:TRAIN-(cmcm) (8/10/4)>> loss: 0.8551
2024-06-13 18:44:34:INFO:VAL-(cmcm) >>
2024-06-13 18:44:34:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.5472  Non0_acc_2: 0.5880  Non0_F1_score: 0.5265  Mult_acc_5: 0.2751  Mult_acc_7: 0.1965  MAE: 1.7123  Corr: 0.0638 
2024-06-13 18:44:49:INFO:TRAIN-(cmcm) (9/11/4)>> loss: 0.8455
2024-06-13 18:44:52:INFO:VAL-(cmcm) >>
2024-06-13 18:44:52:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4866  Non0_acc_2: 0.5694  Non0_F1_score: 0.4595  Mult_acc_5: 0.2838  Mult_acc_7: 0.2096  MAE: 1.6485  Corr: 0.0736 
2024-06-13 18:45:07:INFO:TRAIN-(cmcm) (10/12/4)>> loss: 0.8365
2024-06-13 18:45:10:INFO:VAL-(cmcm) >>
2024-06-13 18:45:10:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.5032  Non0_acc_2: 0.5787  Non0_F1_score: 0.4770  Mult_acc_5: 0.2620  Mult_acc_7: 0.1921  MAE: 1.7071  Corr: -0.0002 
2024-06-13 18:45:17:INFO:TEST-(cmcm) >>
2024-06-13 18:45:17:INFO:M: >>  Has0_acc_2: 0.4548  Has0_F1_score: 0.3090  Non0_acc_2: 0.4512  Non0_F1_score: 0.3304  Mult_acc_5: 0.1662  Mult_acc_7: 0.1662  MAE: 1.7052  Corr: 0.1019 
2024-06-13 18:45:17:INFO:Results are added to results/results/mosi-regression-60.csv...
2024-06-13 18:45:17:INFO:Start running cmcm...
2024-06-13 18:45:17:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 6, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 60, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 5555}>
2024-06-13 18:45:17:INFO:Let's use the GPU 1 !
2024-06-13 18:45:17:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 18:45:18:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718275518 HTTP/1.1" 200 235
2024-06-13 18:45:18:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 18:45:19:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 18:45:19:INFO:train samples: (1284,)
2024-06-13 18:45:19:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 18:45:20:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718275520 HTTP/1.1" 200 235
2024-06-13 18:45:20:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 18:45:20:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 18:45:21:INFO:valid samples: (229,)
2024-06-13 18:45:21:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 18:45:21:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718275522 HTTP/1.1" 200 235
2024-06-13 18:45:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 18:45:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 18:45:23:INFO:test samples: (686,)
2024-06-13 18:45:23:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 18:45:23:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718275523 HTTP/1.1" 200 235
2024-06-13 18:45:23:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 18:45:24:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 18:45:24:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 18:45:24:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718275525 HTTP/1.1" 200 235
2024-06-13 18:45:25:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 18:45:25:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 18:45:25:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-13 18:45:25:WARNING:Try importing flash-attention for faster inference...
2024-06-13 18:45:25:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-13 18:45:25:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-13 18:45:25:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-13 18:45:26:INFO:trainable params: 1310288 || all params: 1838138960 || trainable%: 0.07128340286090232
2024-06-13 18:45:26:INFO:Init labels...
2024-06-13 18:45:26:INFO:Start training...
2024-06-13 18:45:41:INFO:TRAIN-(cmcm) (1/1/5)>> loss: 2.5777
2024-06-13 18:45:44:INFO:VAL-(cmcm) >>
2024-06-13 18:45:44:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5646  Non0_acc_2: 0.5833  Non0_F1_score: 0.5568  Mult_acc_5: 0.2009  Mult_acc_7: 0.1790  MAE: 1.4816  Corr: 0.0435 
2024-06-13 18:45:44:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-13 18:45:59:INFO:TRAIN-(cmcm) (1/2/5)>> loss: 0.9552
2024-06-13 18:46:02:INFO:VAL-(cmcm) >>
2024-06-13 18:46:02:INFO:M: >>  Has0_acc_2: 0.5633  Has0_F1_score: 0.5010  Non0_acc_2: 0.5417  Non0_F1_score: 0.4775  Mult_acc_5: 0.1528  Mult_acc_7: 0.1485  MAE: 1.5916  Corr: -0.0769 
2024-06-13 18:46:17:INFO:TRAIN-(cmcm) (2/3/5)>> loss: 0.8917
2024-06-13 18:46:19:INFO:VAL-(cmcm) >>
2024-06-13 18:46:19:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5741  Non0_F1_score: 0.4187  Mult_acc_5: 0.3100  Mult_acc_7: 0.2271  MAE: 1.7084  Corr: 0.0308 
2024-06-13 18:46:34:INFO:TRAIN-(cmcm) (3/4/5)>> loss: 0.8814
2024-06-13 18:46:37:INFO:VAL-(cmcm) >>
2024-06-13 18:46:37:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.5352  Non0_acc_2: 0.5880  Non0_F1_score: 0.5138  Mult_acc_5: 0.2533  Mult_acc_7: 0.1878  MAE: 1.6424  Corr: 0.0850 
2024-06-13 18:46:52:INFO:TRAIN-(cmcm) (4/5/5)>> loss: 0.8755
2024-06-13 18:46:54:INFO:VAL-(cmcm) >>
2024-06-13 18:46:54:INFO:M: >>  Has0_acc_2: 0.5546  Has0_F1_score: 0.5588  Non0_acc_2: 0.5648  Non0_F1_score: 0.5669  Mult_acc_5: 0.1921  Mult_acc_7: 0.1921  MAE: 1.4357  Corr: 0.1448 
2024-06-13 18:46:55:INFO:Saving checkpoint at epoch 5 to results/models/cmcm-mosi-regression.pth.
2024-06-13 18:47:10:INFO:TRAIN-(cmcm) (1/6/5)>> loss: 0.8714
2024-06-13 18:47:12:INFO:VAL-(cmcm) >>
2024-06-13 18:47:12:INFO:M: >>  Has0_acc_2: 0.5590  Has0_F1_score: 0.5378  Non0_acc_2: 0.5833  Non0_F1_score: 0.5567  Mult_acc_5: 0.2533  Mult_acc_7: 0.1921  MAE: 1.6782  Corr: 0.2918 
2024-06-13 18:47:27:INFO:TRAIN-(cmcm) (2/7/5)>> loss: 0.8562
2024-06-13 18:47:30:INFO:VAL-(cmcm) >>
2024-06-13 18:47:30:INFO:M: >>  Has0_acc_2: 0.7031  Has0_F1_score: 0.7012  Non0_acc_2: 0.6111  Non0_F1_score: 0.5998  Mult_acc_5: 0.2140  Mult_acc_7: 0.2140  MAE: 1.3149  Corr: 0.3978 
2024-06-13 18:47:31:INFO:Saving checkpoint at epoch 7 to results/models/cmcm-mosi-regression.pth.
2024-06-13 18:47:46:INFO:TRAIN-(cmcm) (1/8/5)>> loss: 0.8483
2024-06-13 18:47:48:INFO:VAL-(cmcm) >>
2024-06-13 18:47:48:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.5032  Non0_acc_2: 0.5833  Non0_F1_score: 0.4799  Mult_acc_5: 0.3188  Mult_acc_7: 0.2314  MAE: 1.7302  Corr: 0.1188 
2024-06-13 18:48:03:INFO:TRAIN-(cmcm) (2/9/5)>> loss: 0.8363
2024-06-13 18:48:06:INFO:VAL-(cmcm) >>
2024-06-13 18:48:06:INFO:M: >>  Has0_acc_2: 0.6638  Has0_F1_score: 0.6670  Non0_acc_2: 0.6806  Non0_F1_score: 0.6823  Mult_acc_5: 0.3231  Mult_acc_7: 0.2533  MAE: 1.3293  Corr: 0.3994 
2024-06-13 18:48:21:INFO:TRAIN-(cmcm) (3/10/5)>> loss: 0.8115
2024-06-13 18:48:24:INFO:VAL-(cmcm) >>
2024-06-13 18:48:24:INFO:M: >>  Has0_acc_2: 0.6725  Has0_F1_score: 0.6560  Non0_acc_2: 0.6806  Non0_F1_score: 0.6674  Mult_acc_5: 0.3231  Mult_acc_7: 0.2707  MAE: 1.2589  Corr: 0.4121 
2024-06-13 18:48:24:INFO:Saving checkpoint at epoch 10 to results/models/cmcm-mosi-regression.pth.
2024-06-13 18:48:39:INFO:TRAIN-(cmcm) (1/11/5)>> loss: 0.8017
2024-06-13 18:48:42:INFO:VAL-(cmcm) >>
2024-06-13 18:48:42:INFO:M: >>  Has0_acc_2: 0.7162  Has0_F1_score: 0.7069  Non0_acc_2: 0.7222  Non0_F1_score: 0.7114  Mult_acc_5: 0.3362  Mult_acc_7: 0.2664  MAE: 1.1414  Corr: 0.5505 
2024-06-13 18:48:42:INFO:Saving checkpoint at epoch 11 to results/models/cmcm-mosi-regression.pth.
2024-06-13 18:48:58:INFO:TRAIN-(cmcm) (1/12/5)>> loss: 0.7862
2024-06-13 18:49:00:INFO:VAL-(cmcm) >>
2024-06-13 18:49:00:INFO:M: >>  Has0_acc_2: 0.7424  Has0_F1_score: 0.7447  Non0_acc_2: 0.7639  Non0_F1_score: 0.7649  Mult_acc_5: 0.3362  Mult_acc_7: 0.2576  MAE: 1.0189  Corr: 0.6273 
2024-06-13 18:49:00:INFO:Saving checkpoint at epoch 12 to results/models/cmcm-mosi-regression.pth.
2024-06-13 18:49:16:INFO:TRAIN-(cmcm) (1/13/5)>> loss: 0.7786
2024-06-13 18:49:18:INFO:VAL-(cmcm) >>
2024-06-13 18:49:18:INFO:M: >>  Has0_acc_2: 0.7162  Has0_F1_score: 0.7109  Non0_acc_2: 0.7222  Non0_F1_score: 0.7156  Mult_acc_5: 0.3755  Mult_acc_7: 0.3144  MAE: 1.1407  Corr: 0.5742 
2024-06-13 18:49:34:INFO:TRAIN-(cmcm) (2/14/5)>> loss: 0.7773
2024-06-13 18:49:36:INFO:VAL-(cmcm) >>
2024-06-13 18:49:36:INFO:M: >>  Has0_acc_2: 0.7118  Has0_F1_score: 0.7144  Non0_acc_2: 0.6759  Non0_F1_score: 0.6706  Mult_acc_5: 0.3319  Mult_acc_7: 0.2882  MAE: 1.1763  Corr: 0.5372 
2024-06-13 18:49:51:INFO:TRAIN-(cmcm) (3/15/5)>> loss: 0.7620
2024-06-13 18:49:54:INFO:VAL-(cmcm) >>
2024-06-13 18:49:54:INFO:M: >>  Has0_acc_2: 0.7336  Has0_F1_score: 0.7350  Non0_acc_2: 0.7407  Non0_F1_score: 0.7416  Mult_acc_5: 0.3362  Mult_acc_7: 0.2576  MAE: 1.1558  Corr: 0.5600 
2024-06-13 18:50:09:INFO:TRAIN-(cmcm) (4/16/5)>> loss: 0.7530
2024-06-13 18:50:11:INFO:VAL-(cmcm) >>
2024-06-13 18:50:11:INFO:M: >>  Has0_acc_2: 0.7118  Has0_F1_score: 0.7029  Non0_acc_2: 0.7176  Non0_F1_score: 0.7083  Mult_acc_5: 0.3712  Mult_acc_7: 0.3013  MAE: 1.1071  Corr: 0.5522 
2024-06-13 18:50:26:INFO:TRAIN-(cmcm) (5/17/5)>> loss: 0.7482
2024-06-13 18:50:29:INFO:VAL-(cmcm) >>
2024-06-13 18:50:29:INFO:M: >>  Has0_acc_2: 0.7205  Has0_F1_score: 0.7205  Non0_acc_2: 0.7269  Non0_F1_score: 0.7267  Mult_acc_5: 0.3493  Mult_acc_7: 0.2576  MAE: 1.1734  Corr: 0.5437 
2024-06-13 18:50:44:INFO:TRAIN-(cmcm) (6/18/5)>> loss: 0.7340
2024-06-13 18:50:47:INFO:VAL-(cmcm) >>
2024-06-13 18:50:47:INFO:M: >>  Has0_acc_2: 0.7205  Has0_F1_score: 0.7119  Non0_acc_2: 0.7315  Non0_F1_score: 0.7283  Mult_acc_5: 0.4105  Mult_acc_7: 0.3144  MAE: 1.1464  Corr: 0.5558 
2024-06-13 18:51:02:INFO:TRAIN-(cmcm) (7/19/5)>> loss: 0.7346
2024-06-13 18:51:04:INFO:VAL-(cmcm) >>
2024-06-13 18:51:04:INFO:M: >>  Has0_acc_2: 0.7293  Has0_F1_score: 0.7313  Non0_acc_2: 0.7500  Non0_F1_score: 0.7514  Mult_acc_5: 0.3799  Mult_acc_7: 0.2969  MAE: 1.1237  Corr: 0.5617 
2024-06-13 18:51:19:INFO:TRAIN-(cmcm) (8/20/5)>> loss: 0.7293
2024-06-13 18:51:22:INFO:VAL-(cmcm) >>
2024-06-13 18:51:22:INFO:M: >>  Has0_acc_2: 0.7118  Has0_F1_score: 0.7144  Non0_acc_2: 0.7361  Non0_F1_score: 0.7363  Mult_acc_5: 0.2969  Mult_acc_7: 0.2358  MAE: 1.1826  Corr: 0.5716 
2024-06-13 18:51:37:INFO:TRAIN-(cmcm) (9/21/5)>> loss: 0.7280
2024-06-13 18:51:39:INFO:VAL-(cmcm) >>
2024-06-13 18:51:39:INFO:M: >>  Has0_acc_2: 0.7249  Has0_F1_score: 0.7266  Non0_acc_2: 0.7315  Non0_F1_score: 0.7324  Mult_acc_5: 0.3231  Mult_acc_7: 0.2664  MAE: 1.0883  Corr: 0.6026 
2024-06-13 18:51:54:INFO:TRAIN-(cmcm) (10/22/5)>> loss: 0.7094
2024-06-13 18:51:57:INFO:VAL-(cmcm) >>
2024-06-13 18:51:57:INFO:M: >>  Has0_acc_2: 0.6943  Has0_F1_score: 0.6948  Non0_acc_2: 0.6806  Non0_F1_score: 0.6765  Mult_acc_5: 0.3362  Mult_acc_7: 0.2707  MAE: 1.1970  Corr: 0.5015 
2024-06-13 18:52:04:INFO:TEST-(cmcm) >>
2024-06-13 18:52:04:INFO:M: >>  Has0_acc_2: 0.7376  Has0_F1_score: 0.7360  Non0_acc_2: 0.7530  Non0_F1_score: 0.7524  Mult_acc_5: 0.3542  Mult_acc_7: 0.3134  MAE: 1.0765  Corr: 0.5570 
2024-06-13 18:52:05:INFO:Results are added to results/results/mosi-regression-60.csv...
2024-06-13 18:52:05:INFO:Start running cmcm...
2024-06-13 18:52:05:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 6, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 70, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-06-13 18:52:05:INFO:Let's use the GPU 1 !
2024-06-13 18:52:05:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 18:52:05:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718275925 HTTP/1.1" 200 235
2024-06-13 18:52:05:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 18:52:06:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 18:52:06:INFO:train samples: (1284,)
2024-06-13 18:52:06:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 18:52:07:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718275927 HTTP/1.1" 200 235
2024-06-13 18:52:07:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 18:52:07:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 18:52:08:INFO:valid samples: (229,)
2024-06-13 18:52:08:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 18:52:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718275929 HTTP/1.1" 200 235
2024-06-13 18:52:09:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 18:52:09:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 18:52:09:INFO:test samples: (686,)
2024-06-13 18:52:09:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 18:52:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718275930 HTTP/1.1" 200 235
2024-06-13 18:52:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 18:52:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 18:52:11:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 18:52:11:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718275931 HTTP/1.1" 200 235
2024-06-13 18:52:11:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 18:52:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 18:52:12:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-13 18:52:12:WARNING:Try importing flash-attention for faster inference...
2024-06-13 18:52:12:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-13 18:52:12:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-13 18:52:12:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-13 18:52:13:INFO:trainable params: 1310288 || all params: 1838138960 || trainable%: 0.07128340286090232
2024-06-13 18:52:13:INFO:Init labels...
2024-06-13 18:52:13:INFO:Start training...
2024-06-13 18:52:28:INFO:TRAIN-(cmcm) (1/1/1)>> loss: 2.1735
2024-06-13 18:52:30:INFO:VAL-(cmcm) >>
2024-06-13 18:52:30:INFO:M: >>  Has0_acc_2: 0.5459  Has0_F1_score: 0.5194  Non0_acc_2: 0.5370  Non0_F1_score: 0.5075  Mult_acc_5: 0.1572  Mult_acc_7: 0.1572  MAE: 1.5659  Corr: -0.0178 
2024-06-13 18:52:31:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-13 18:52:46:INFO:TRAIN-(cmcm) (1/2/1)>> loss: 0.9096
2024-06-13 18:52:48:INFO:VAL-(cmcm) >>
2024-06-13 18:52:48:INFO:M: >>  Has0_acc_2: 0.4367  Has0_F1_score: 0.3640  Non0_acc_2: 0.4259  Non0_F1_score: 0.2544  Mult_acc_5: 0.1747  Mult_acc_7: 0.1659  MAE: 1.8052  Corr: -0.0516 
2024-06-13 18:53:03:INFO:TRAIN-(cmcm) (2/3/1)>> loss: 0.9213
2024-06-13 18:53:06:INFO:VAL-(cmcm) >>
2024-06-13 18:53:06:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5741  Non0_F1_score: 0.4187  Mult_acc_5: 0.2707  Mult_acc_7: 0.1921  MAE: 1.7057  Corr: -0.0138 
2024-06-13 18:53:21:INFO:TRAIN-(cmcm) (3/4/1)>> loss: 0.8850
2024-06-13 18:53:24:INFO:VAL-(cmcm) >>
2024-06-13 18:53:24:INFO:M: >>  Has0_acc_2: 0.5633  Has0_F1_score: 0.5188  Non0_acc_2: 0.5139  Non0_F1_score: 0.4733  Mult_acc_5: 0.2227  Mult_acc_7: 0.2227  MAE: 1.4427  Corr: 0.0732 
2024-06-13 18:53:24:INFO:Saving checkpoint at epoch 4 to results/models/cmcm-mosi-regression.pth.
2024-06-13 18:53:39:INFO:TRAIN-(cmcm) (1/5/1)>> loss: 0.8748
2024-06-13 18:53:42:INFO:VAL-(cmcm) >>
2024-06-13 18:53:42:INFO:M: >>  Has0_acc_2: 0.4541  Has0_F1_score: 0.3988  Non0_acc_2: 0.4769  Non0_F1_score: 0.4231  Mult_acc_5: 0.1703  Mult_acc_7: 0.1441  MAE: 1.7746  Corr: 0.0489 
2024-06-13 18:53:57:INFO:TRAIN-(cmcm) (2/6/1)>> loss: 0.8682
2024-06-13 18:53:59:INFO:VAL-(cmcm) >>
2024-06-13 18:53:59:INFO:M: >>  Has0_acc_2: 0.5459  Has0_F1_score: 0.5319  Non0_acc_2: 0.5324  Non0_F1_score: 0.5171  Mult_acc_5: 0.2445  Mult_acc_7: 0.1659  MAE: 1.9346  Corr: -0.0293 
2024-06-13 18:54:14:INFO:TRAIN-(cmcm) (3/7/1)>> loss: 0.8642
2024-06-13 18:54:17:INFO:VAL-(cmcm) >>
2024-06-13 18:54:17:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5081  Non0_acc_2: 0.5694  Non0_F1_score: 0.4821  Mult_acc_5: 0.2096  Mult_acc_7: 0.1747  MAE: 1.6223  Corr: 0.0175 
2024-06-13 18:54:32:INFO:TRAIN-(cmcm) (4/8/1)>> loss: 0.8731
2024-06-13 18:54:35:INFO:VAL-(cmcm) >>
2024-06-13 18:54:35:INFO:M: >>  Has0_acc_2: 0.5153  Has0_F1_score: 0.5117  Non0_acc_2: 0.5093  Non0_F1_score: 0.5068  Mult_acc_5: 0.1965  Mult_acc_7: 0.1965  MAE: 1.5825  Corr: -0.0281 
2024-06-13 18:54:50:INFO:TRAIN-(cmcm) (5/9/1)>> loss: 0.8668
2024-06-13 18:54:52:INFO:VAL-(cmcm) >>
2024-06-13 18:54:52:INFO:M: >>  Has0_acc_2: 0.5590  Has0_F1_score: 0.5187  Non0_acc_2: 0.5370  Non0_F1_score: 0.4961  Mult_acc_5: 0.2751  Mult_acc_7: 0.1965  MAE: 1.7992  Corr: -0.0169 
2024-06-13 18:55:07:INFO:TRAIN-(cmcm) (6/10/1)>> loss: 0.8585
2024-06-13 18:55:10:INFO:VAL-(cmcm) >>
2024-06-13 18:55:10:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5129  Non0_acc_2: 0.5648  Non0_F1_score: 0.4934  Mult_acc_5: 0.2969  Mult_acc_7: 0.2183  MAE: 1.7302  Corr: 0.0175 
2024-06-13 18:55:25:INFO:TRAIN-(cmcm) (7/11/1)>> loss: 0.8580
2024-06-13 18:55:27:INFO:VAL-(cmcm) >>
2024-06-13 18:55:27:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.5311  Non0_acc_2: 0.5556  Non0_F1_score: 0.5163  Mult_acc_5: 0.2707  Mult_acc_7: 0.1878  MAE: 1.8210  Corr: 0.0087 
2024-06-13 18:55:42:INFO:TRAIN-(cmcm) (8/12/1)>> loss: 0.8503
2024-06-13 18:55:45:INFO:VAL-(cmcm) >>
2024-06-13 18:55:45:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5787  Non0_F1_score: 0.4445  Mult_acc_5: 0.1747  Mult_acc_7: 0.1747  MAE: 1.4130  Corr: 0.0624 
2024-06-13 18:55:45:INFO:Saving checkpoint at epoch 12 to results/models/cmcm-mosi-regression.pth.
2024-06-13 18:56:00:INFO:TRAIN-(cmcm) (1/13/1)>> loss: 0.8489
2024-06-13 18:56:03:INFO:VAL-(cmcm) >>
2024-06-13 18:56:03:INFO:M: >>  Has0_acc_2: 0.5590  Has0_F1_score: 0.5546  Non0_acc_2: 0.5602  Non0_F1_score: 0.5532  Mult_acc_5: 0.2576  Mult_acc_7: 0.1834  MAE: 1.7961  Corr: 0.0570 
2024-06-13 18:56:18:INFO:TRAIN-(cmcm) (2/14/1)>> loss: 0.8451
2024-06-13 18:56:21:INFO:VAL-(cmcm) >>
2024-06-13 18:56:21:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.6063  Non0_acc_2: 0.6111  Non0_F1_score: 0.6131  Mult_acc_5: 0.2009  Mult_acc_7: 0.2009  MAE: 1.4344  Corr: 0.1932 
2024-06-13 18:56:36:INFO:TRAIN-(cmcm) (3/15/1)>> loss: 0.8468
2024-06-13 18:56:38:INFO:VAL-(cmcm) >>
2024-06-13 18:56:38:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4700  Non0_acc_2: 0.5741  Non0_F1_score: 0.4420  Mult_acc_5: 0.2271  Mult_acc_7: 0.2009  MAE: 1.4619  Corr: 0.0821 
2024-06-13 18:56:53:INFO:TRAIN-(cmcm) (4/16/1)>> loss: 0.8438
2024-06-13 18:56:56:INFO:VAL-(cmcm) >>
2024-06-13 18:56:56:INFO:M: >>  Has0_acc_2: 0.6245  Has0_F1_score: 0.5889  Non0_acc_2: 0.5926  Non0_F1_score: 0.5830  Mult_acc_5: 0.2620  Mult_acc_7: 0.2533  MAE: 1.3844  Corr: 0.2066 
2024-06-13 18:56:56:INFO:Saving checkpoint at epoch 16 to results/models/cmcm-mosi-regression.pth.
2024-06-13 18:57:11:INFO:TRAIN-(cmcm) (1/17/1)>> loss: 0.8344
2024-06-13 18:57:14:INFO:VAL-(cmcm) >>
2024-06-13 18:57:14:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.4790  Non0_acc_2: 0.5648  Non0_F1_score: 0.5019  Mult_acc_5: 0.2838  Mult_acc_7: 0.2445  MAE: 1.4899  Corr: 0.0771 
2024-06-13 18:57:29:INFO:TRAIN-(cmcm) (2/18/1)>> loss: 0.8296
2024-06-13 18:57:31:INFO:VAL-(cmcm) >>
2024-06-13 18:57:31:INFO:M: >>  Has0_acc_2: 0.6812  Has0_F1_score: 0.6796  Non0_acc_2: 0.6528  Non0_F1_score: 0.6547  Mult_acc_5: 0.2620  Mult_acc_7: 0.2445  MAE: 1.2846  Corr: 0.3509 
2024-06-13 18:57:32:INFO:Saving checkpoint at epoch 18 to results/models/cmcm-mosi-regression.pth.
2024-06-13 18:57:47:INFO:TRAIN-(cmcm) (1/19/1)>> loss: 0.8268
2024-06-13 18:57:50:INFO:VAL-(cmcm) >>
2024-06-13 18:57:50:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5479  Non0_acc_2: 0.5833  Non0_F1_score: 0.5340  Mult_acc_5: 0.2445  Mult_acc_7: 0.1747  MAE: 1.5357  Corr: 0.1524 
2024-06-13 18:58:05:INFO:TRAIN-(cmcm) (2/20/1)>> loss: 0.8153
2024-06-13 18:58:07:INFO:VAL-(cmcm) >>
2024-06-13 18:58:07:INFO:M: >>  Has0_acc_2: 0.6900  Has0_F1_score: 0.6616  Non0_acc_2: 0.6806  Non0_F1_score: 0.6512  Mult_acc_5: 0.3450  Mult_acc_7: 0.2576  MAE: 1.3957  Corr: 0.3928 
2024-06-13 18:58:22:INFO:TRAIN-(cmcm) (3/21/1)>> loss: 0.8070
2024-06-13 18:58:25:INFO:VAL-(cmcm) >>
2024-06-13 18:58:25:INFO:M: >>  Has0_acc_2: 0.6157  Has0_F1_score: 0.6147  Non0_acc_2: 0.6528  Non0_F1_score: 0.6520  Mult_acc_5: 0.2969  Mult_acc_7: 0.2271  MAE: 1.3988  Corr: 0.3510 
2024-06-13 18:58:40:INFO:TRAIN-(cmcm) (4/22/1)>> loss: 0.7975
2024-06-13 18:58:42:INFO:VAL-(cmcm) >>
2024-06-13 18:58:42:INFO:M: >>  Has0_acc_2: 0.7074  Has0_F1_score: 0.6845  Non0_acc_2: 0.7176  Non0_F1_score: 0.7004  Mult_acc_5: 0.3188  Mult_acc_7: 0.2664  MAE: 1.2446  Corr: 0.4541 
2024-06-13 18:58:43:INFO:Saving checkpoint at epoch 22 to results/models/cmcm-mosi-regression.pth.
2024-06-13 18:58:58:INFO:TRAIN-(cmcm) (1/23/1)>> loss: 0.8016
2024-06-13 18:59:01:INFO:VAL-(cmcm) >>
2024-06-13 18:59:01:INFO:M: >>  Has0_acc_2: 0.6681  Has0_F1_score: 0.6318  Non0_acc_2: 0.6528  Non0_F1_score: 0.6158  Mult_acc_5: 0.3275  Mult_acc_7: 0.2489  MAE: 1.4289  Corr: 0.3302 
2024-06-13 18:59:16:INFO:TRAIN-(cmcm) (2/24/1)>> loss: 0.7812
2024-06-13 18:59:19:INFO:VAL-(cmcm) >>
2024-06-13 18:59:19:INFO:M: >>  Has0_acc_2: 0.6725  Has0_F1_score: 0.6426  Non0_acc_2: 0.6620  Non0_F1_score: 0.6576  Mult_acc_5: 0.2969  Mult_acc_7: 0.2795  MAE: 1.2589  Corr: 0.3692 
2024-06-13 18:59:33:INFO:TRAIN-(cmcm) (3/25/1)>> loss: 0.7817
2024-06-13 18:59:36:INFO:VAL-(cmcm) >>
2024-06-13 18:59:36:INFO:M: >>  Has0_acc_2: 0.6812  Has0_F1_score: 0.6426  Non0_acc_2: 0.6667  Non0_F1_score: 0.6272  Mult_acc_5: 0.3013  Mult_acc_7: 0.2620  MAE: 1.2857  Corr: 0.4408 
2024-06-13 18:59:51:INFO:TRAIN-(cmcm) (4/26/1)>> loss: 0.7734
2024-06-13 18:59:53:INFO:VAL-(cmcm) >>
2024-06-13 18:59:53:INFO:M: >>  Has0_acc_2: 0.6812  Has0_F1_score: 0.6563  Non0_acc_2: 0.6944  Non0_F1_score: 0.6766  Mult_acc_5: 0.3624  Mult_acc_7: 0.2926  MAE: 1.3069  Corr: 0.4165 
2024-06-13 19:00:08:INFO:TRAIN-(cmcm) (5/27/1)>> loss: 0.7643
2024-06-13 19:00:11:INFO:VAL-(cmcm) >>
2024-06-13 19:00:11:INFO:M: >>  Has0_acc_2: 0.7031  Has0_F1_score: 0.6971  Non0_acc_2: 0.6852  Non0_F1_score: 0.6868  Mult_acc_5: 0.3144  Mult_acc_7: 0.2795  MAE: 1.1567  Corr: 0.5085 
2024-06-13 19:00:11:INFO:Saving checkpoint at epoch 27 to results/models/cmcm-mosi-regression.pth.
2024-06-13 19:00:26:INFO:TRAIN-(cmcm) (1/28/1)>> loss: 0.7616
2024-06-13 19:00:29:INFO:VAL-(cmcm) >>
2024-06-13 19:00:29:INFO:M: >>  Has0_acc_2: 0.6769  Has0_F1_score: 0.6628  Non0_acc_2: 0.6898  Non0_F1_score: 0.6873  Mult_acc_5: 0.3755  Mult_acc_7: 0.2882  MAE: 1.2560  Corr: 0.4171 
2024-06-13 19:00:44:INFO:TRAIN-(cmcm) (2/29/1)>> loss: 0.7419
2024-06-13 19:00:46:INFO:VAL-(cmcm) >>
2024-06-13 19:00:46:INFO:M: >>  Has0_acc_2: 0.7205  Has0_F1_score: 0.7188  Non0_acc_2: 0.6574  Non0_F1_score: 0.6551  Mult_acc_5: 0.2882  Mult_acc_7: 0.2664  MAE: 1.1961  Corr: 0.4602 
2024-06-13 19:01:01:INFO:TRAIN-(cmcm) (3/30/1)>> loss: 0.7363
2024-06-13 19:01:04:INFO:VAL-(cmcm) >>
2024-06-13 19:01:04:INFO:M: >>  Has0_acc_2: 0.6812  Has0_F1_score: 0.6781  Non0_acc_2: 0.6759  Non0_F1_score: 0.6773  Mult_acc_5: 0.3100  Mult_acc_7: 0.2576  MAE: 1.2285  Corr: 0.4436 
2024-06-13 19:01:19:INFO:TRAIN-(cmcm) (4/31/1)>> loss: 0.7211
2024-06-13 19:01:21:INFO:VAL-(cmcm) >>
2024-06-13 19:01:21:INFO:M: >>  Has0_acc_2: 0.6812  Has0_F1_score: 0.6635  Non0_acc_2: 0.6852  Non0_F1_score: 0.6700  Mult_acc_5: 0.3406  Mult_acc_7: 0.2795  MAE: 1.2202  Corr: 0.4502 
2024-06-13 19:01:36:INFO:TRAIN-(cmcm) (5/32/1)>> loss: 0.7232
2024-06-13 19:01:39:INFO:VAL-(cmcm) >>
2024-06-13 19:01:39:INFO:M: >>  Has0_acc_2: 0.6900  Has0_F1_score: 0.6902  Non0_acc_2: 0.6065  Non0_F1_score: 0.5957  Mult_acc_5: 0.3057  Mult_acc_7: 0.2707  MAE: 1.2333  Corr: 0.4498 
2024-06-13 19:01:54:INFO:TRAIN-(cmcm) (6/33/1)>> loss: 0.7248
2024-06-13 19:01:56:INFO:VAL-(cmcm) >>
2024-06-13 19:01:56:INFO:M: >>  Has0_acc_2: 0.7380  Has0_F1_score: 0.7309  Non0_acc_2: 0.7500  Non0_F1_score: 0.7477  Mult_acc_5: 0.4061  Mult_acc_7: 0.3013  MAE: 1.1346  Corr: 0.5583 
2024-06-13 19:01:56:INFO:Saving checkpoint at epoch 33 to results/models/cmcm-mosi-regression.pth.
2024-06-13 19:02:12:INFO:TRAIN-(cmcm) (1/34/1)>> loss: 0.6974
2024-06-13 19:02:14:INFO:VAL-(cmcm) >>
2024-06-13 19:02:14:INFO:M: >>  Has0_acc_2: 0.6638  Has0_F1_score: 0.6257  Non0_acc_2: 0.6898  Non0_F1_score: 0.6796  Mult_acc_5: 0.3712  Mult_acc_7: 0.2838  MAE: 1.3311  Corr: 0.4107 
2024-06-13 19:02:29:INFO:TRAIN-(cmcm) (2/35/1)>> loss: 0.7023
2024-06-13 19:02:32:INFO:VAL-(cmcm) >>
2024-06-13 19:02:32:INFO:M: >>  Has0_acc_2: 0.7336  Has0_F1_score: 0.7269  Non0_acc_2: 0.7083  Non0_F1_score: 0.7089  Mult_acc_5: 0.3319  Mult_acc_7: 0.2707  MAE: 1.1734  Corr: 0.5004 
2024-06-13 19:02:47:INFO:TRAIN-(cmcm) (3/36/1)>> loss: 0.6883
2024-06-13 19:02:49:INFO:VAL-(cmcm) >>
2024-06-13 19:02:49:INFO:M: >>  Has0_acc_2: 0.7467  Has0_F1_score: 0.7475  Non0_acc_2: 0.7361  Non0_F1_score: 0.7371  Mult_acc_5: 0.3450  Mult_acc_7: 0.2882  MAE: 1.0774  Corr: 0.5695 
2024-06-13 19:02:49:INFO:Saving checkpoint at epoch 36 to results/models/cmcm-mosi-regression.pth.
2024-06-13 19:03:05:INFO:TRAIN-(cmcm) (1/37/1)>> loss: 0.6829
2024-06-13 19:03:07:INFO:VAL-(cmcm) >>
2024-06-13 19:03:07:INFO:M: >>  Has0_acc_2: 0.6638  Has0_F1_score: 0.6374  Non0_acc_2: 0.7130  Non0_F1_score: 0.7062  Mult_acc_5: 0.3843  Mult_acc_7: 0.2926  MAE: 1.2407  Corr: 0.4449 
2024-06-13 19:03:22:INFO:TRAIN-(cmcm) (2/38/1)>> loss: 0.6801
2024-06-13 19:03:25:INFO:VAL-(cmcm) >>
2024-06-13 19:03:25:INFO:M: >>  Has0_acc_2: 0.7118  Has0_F1_score: 0.7006  Non0_acc_2: 0.7407  Non0_F1_score: 0.7411  Mult_acc_5: 0.3974  Mult_acc_7: 0.3188  MAE: 1.1206  Corr: 0.5378 
2024-06-13 19:03:40:INFO:TRAIN-(cmcm) (3/39/1)>> loss: 0.6629
2024-06-13 19:03:42:INFO:VAL-(cmcm) >>
2024-06-13 19:03:42:INFO:M: >>  Has0_acc_2: 0.6681  Has0_F1_score: 0.6681  Non0_acc_2: 0.7083  Non0_F1_score: 0.7081  Mult_acc_5: 0.3712  Mult_acc_7: 0.2751  MAE: 1.2437  Corr: 0.4555 
2024-06-13 19:03:57:INFO:TRAIN-(cmcm) (4/40/1)>> loss: 0.6431
2024-06-13 19:04:00:INFO:VAL-(cmcm) >>
2024-06-13 19:04:00:INFO:M: >>  Has0_acc_2: 0.6900  Has0_F1_score: 0.6758  Non0_acc_2: 0.6852  Non0_F1_score: 0.6856  Mult_acc_5: 0.3406  Mult_acc_7: 0.2926  MAE: 1.1935  Corr: 0.4578 
2024-06-13 19:04:15:INFO:TRAIN-(cmcm) (5/41/1)>> loss: 0.6441
2024-06-13 19:04:17:INFO:VAL-(cmcm) >>
2024-06-13 19:04:17:INFO:M: >>  Has0_acc_2: 0.6900  Has0_F1_score: 0.6785  Non0_acc_2: 0.7130  Non0_F1_score: 0.7088  Mult_acc_5: 0.3581  Mult_acc_7: 0.2795  MAE: 1.2009  Corr: 0.4680 
2024-06-13 19:04:32:INFO:TRAIN-(cmcm) (6/42/1)>> loss: 0.6304
2024-06-13 19:04:34:INFO:VAL-(cmcm) >>
2024-06-13 19:04:34:INFO:M: >>  Has0_acc_2: 0.6987  Has0_F1_score: 0.6972  Non0_acc_2: 0.7361  Non0_F1_score: 0.7371  Mult_acc_5: 0.3537  Mult_acc_7: 0.2795  MAE: 1.1988  Corr: 0.4661 
2024-06-13 19:04:49:INFO:TRAIN-(cmcm) (7/43/1)>> loss: 0.6111
2024-06-13 19:04:52:INFO:VAL-(cmcm) >>
2024-06-13 19:04:52:INFO:M: >>  Has0_acc_2: 0.6812  Has0_F1_score: 0.6651  Non0_acc_2: 0.6806  Non0_F1_score: 0.6820  Mult_acc_5: 0.3450  Mult_acc_7: 0.2795  MAE: 1.1877  Corr: 0.4628 
2024-06-13 19:05:07:INFO:TRAIN-(cmcm) (8/44/1)>> loss: 0.6095
2024-06-13 19:05:09:INFO:VAL-(cmcm) >>
2024-06-13 19:05:09:INFO:M: >>  Has0_acc_2: 0.7380  Has0_F1_score: 0.7370  Non0_acc_2: 0.7778  Non0_F1_score: 0.7781  Mult_acc_5: 0.3712  Mult_acc_7: 0.2969  MAE: 1.1298  Corr: 0.5283 
2024-06-13 19:05:24:INFO:TRAIN-(cmcm) (9/45/1)>> loss: 0.5972
2024-06-13 19:05:27:INFO:VAL-(cmcm) >>
2024-06-13 19:05:27:INFO:M: >>  Has0_acc_2: 0.6856  Has0_F1_score: 0.6689  Non0_acc_2: 0.6944  Non0_F1_score: 0.6861  Mult_acc_5: 0.4061  Mult_acc_7: 0.3231  MAE: 1.1794  Corr: 0.4834 
2024-06-13 19:05:42:INFO:TRAIN-(cmcm) (10/46/1)>> loss: 0.5926
2024-06-13 19:05:44:INFO:VAL-(cmcm) >>
2024-06-13 19:05:44:INFO:M: >>  Has0_acc_2: 0.7074  Has0_F1_score: 0.6990  Non0_acc_2: 0.7315  Non0_F1_score: 0.7306  Mult_acc_5: 0.3755  Mult_acc_7: 0.3144  MAE: 1.1602  Corr: 0.5157 
2024-06-13 19:05:52:INFO:TEST-(cmcm) >>
2024-06-13 19:05:52:INFO:M: >>  Has0_acc_2: 0.7055  Has0_F1_score: 0.7063  Non0_acc_2: 0.7332  Non0_F1_score: 0.7284  Mult_acc_5: 0.3003  Mult_acc_7: 0.2668  MAE: 1.1212  Corr: 0.4958 
2024-06-13 19:05:52:INFO:Results are added to results/results/mosi-regression-70.csv...
2024-06-13 19:05:52:INFO:Start running cmcm...
2024-06-13 19:05:52:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 6, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 70, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 2222}>
2024-06-13 19:05:52:INFO:Let's use the GPU 1 !
2024-06-13 19:05:52:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 19:05:53:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718276753 HTTP/1.1" 200 235
2024-06-13 19:05:53:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 19:05:53:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 19:05:54:INFO:train samples: (1284,)
2024-06-13 19:05:54:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 19:05:55:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718276755 HTTP/1.1" 200 235
2024-06-13 19:05:55:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 19:05:55:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 19:05:56:INFO:valid samples: (229,)
2024-06-13 19:05:56:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 19:05:56:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718276756 HTTP/1.1" 200 235
2024-06-13 19:05:56:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 19:05:57:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 19:05:57:INFO:test samples: (686,)
2024-06-13 19:05:57:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 19:05:58:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718276758 HTTP/1.1" 200 235
2024-06-13 19:05:58:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 19:05:58:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 19:05:59:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 19:05:59:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718276759 HTTP/1.1" 200 235
2024-06-13 19:05:59:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 19:06:00:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 19:06:00:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-13 19:06:00:WARNING:Try importing flash-attention for faster inference...
2024-06-13 19:06:00:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-13 19:06:00:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-13 19:06:00:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-13 19:06:01:INFO:trainable params: 1310288 || all params: 1838138960 || trainable%: 0.07128340286090232
2024-06-13 19:06:01:INFO:Init labels...
2024-06-13 19:06:01:INFO:Start training...
2024-06-13 19:06:16:INFO:TRAIN-(cmcm) (1/1/2)>> loss: 2.1100
2024-06-13 19:06:19:INFO:VAL-(cmcm) >>
2024-06-13 19:06:19:INFO:M: >>  Has0_acc_2: 0.4148  Has0_F1_score: 0.3132  Non0_acc_2: 0.4259  Non0_F1_score: 0.2544  Mult_acc_5: 0.2183  Mult_acc_7: 0.2183  MAE: 1.5183  Corr: -0.1804 
2024-06-13 19:06:19:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-13 19:06:35:INFO:TRAIN-(cmcm) (1/2/2)>> loss: 0.9789
2024-06-13 19:06:37:INFO:VAL-(cmcm) >>
2024-06-13 19:06:37:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4791  Non0_acc_2: 0.5833  Non0_F1_score: 0.4610  Mult_acc_5: 0.2009  Mult_acc_7: 0.1965  MAE: 1.5711  Corr: -0.0034 
2024-06-13 19:06:52:INFO:TRAIN-(cmcm) (2/3/2)>> loss: 0.8943
2024-06-13 19:06:55:INFO:VAL-(cmcm) >>
2024-06-13 19:06:55:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5741  Non0_F1_score: 0.4187  Mult_acc_5: 0.2445  Mult_acc_7: 0.1747  MAE: 1.6992  Corr: -0.0101 
2024-06-13 19:07:10:INFO:TRAIN-(cmcm) (3/4/2)>> loss: 0.8806
2024-06-13 19:07:12:INFO:VAL-(cmcm) >>
2024-06-13 19:07:12:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5042  Non0_acc_2: 0.5602  Non0_F1_score: 0.4810  Mult_acc_5: 0.3013  Mult_acc_7: 0.2227  MAE: 1.7835  Corr: 0.0143 
2024-06-13 19:07:27:INFO:TRAIN-(cmcm) (4/5/2)>> loss: 0.8804
2024-06-13 19:07:30:INFO:VAL-(cmcm) >>
2024-06-13 19:07:30:INFO:M: >>  Has0_acc_2: 0.5633  Has0_F1_score: 0.5546  Non0_acc_2: 0.5556  Non0_F1_score: 0.5450  Mult_acc_5: 0.2489  Mult_acc_7: 0.1878  MAE: 1.6280  Corr: 0.0588 
2024-06-13 19:07:45:INFO:TRAIN-(cmcm) (5/6/2)>> loss: 0.8755
2024-06-13 19:07:48:INFO:VAL-(cmcm) >>
2024-06-13 19:07:48:INFO:M: >>  Has0_acc_2: 0.5633  Has0_F1_score: 0.5356  Non0_acc_2: 0.5556  Non0_F1_score: 0.5247  Mult_acc_5: 0.1747  Mult_acc_7: 0.1747  MAE: 1.5453  Corr: 0.0138 
2024-06-13 19:08:03:INFO:TRAIN-(cmcm) (6/7/2)>> loss: 0.8816
2024-06-13 19:08:05:INFO:VAL-(cmcm) >>
2024-06-13 19:08:05:INFO:M: >>  Has0_acc_2: 0.6332  Has0_F1_score: 0.5738  Non0_acc_2: 0.6204  Non0_F1_score: 0.5619  Mult_acc_5: 0.3144  Mult_acc_7: 0.2314  MAE: 1.6132  Corr: 0.1873 
2024-06-13 19:08:20:INFO:TRAIN-(cmcm) (7/8/2)>> loss: 0.8673
2024-06-13 19:08:23:INFO:VAL-(cmcm) >>
2024-06-13 19:08:23:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4577  Non0_acc_2: 0.5787  Non0_F1_score: 0.4291  Mult_acc_5: 0.3057  Mult_acc_7: 0.2227  MAE: 1.7302  Corr: 0.0830 
2024-06-13 19:08:38:INFO:TRAIN-(cmcm) (8/9/2)>> loss: 0.8588
2024-06-13 19:08:40:INFO:VAL-(cmcm) >>
2024-06-13 19:08:40:INFO:M: >>  Has0_acc_2: 0.6725  Has0_F1_score: 0.6178  Non0_acc_2: 0.6574  Non0_F1_score: 0.6012  Mult_acc_5: 0.3581  Mult_acc_7: 0.2576  MAE: 1.4953  Corr: 0.3584 
2024-06-13 19:08:41:INFO:Saving checkpoint at epoch 9 to results/models/cmcm-mosi-regression.pth.
2024-06-13 19:08:56:INFO:TRAIN-(cmcm) (1/10/2)>> loss: 0.8505
2024-06-13 19:08:59:INFO:VAL-(cmcm) >>
2024-06-13 19:08:59:INFO:M: >>  Has0_acc_2: 0.7118  Has0_F1_score: 0.7100  Non0_acc_2: 0.7222  Non0_F1_score: 0.7189  Mult_acc_5: 0.3755  Mult_acc_7: 0.2664  MAE: 1.3935  Corr: 0.4007 
2024-06-13 19:08:59:INFO:Saving checkpoint at epoch 10 to results/models/cmcm-mosi-regression.pth.
2024-06-13 19:09:15:INFO:TRAIN-(cmcm) (1/11/2)>> loss: 0.8275
2024-06-13 19:09:17:INFO:VAL-(cmcm) >>
2024-06-13 19:09:17:INFO:M: >>  Has0_acc_2: 0.6769  Has0_F1_score: 0.6545  Non0_acc_2: 0.7083  Non0_F1_score: 0.6936  Mult_acc_5: 0.3624  Mult_acc_7: 0.2751  MAE: 1.2817  Corr: 0.3766 
2024-06-13 19:09:18:INFO:Saving checkpoint at epoch 11 to results/models/cmcm-mosi-regression.pth.
2024-06-13 19:09:33:INFO:TRAIN-(cmcm) (1/12/2)>> loss: 0.8212
2024-06-13 19:09:35:INFO:VAL-(cmcm) >>
2024-06-13 19:09:35:INFO:M: >>  Has0_acc_2: 0.7031  Has0_F1_score: 0.7036  Non0_acc_2: 0.7083  Non0_F1_score: 0.7077  Mult_acc_5: 0.3668  Mult_acc_7: 0.2751  MAE: 1.2573  Corr: 0.4466 
2024-06-13 19:09:36:INFO:Saving checkpoint at epoch 12 to results/models/cmcm-mosi-regression.pth.
2024-06-13 19:09:51:INFO:TRAIN-(cmcm) (1/13/2)>> loss: 0.8055
2024-06-13 19:09:54:INFO:VAL-(cmcm) >>
2024-06-13 19:09:54:INFO:M: >>  Has0_acc_2: 0.5371  Has0_F1_score: 0.4916  Non0_acc_2: 0.5694  Non0_F1_score: 0.5252  Mult_acc_5: 0.2795  Mult_acc_7: 0.2314  MAE: 1.3664  Corr: 0.4249 
2024-06-13 19:10:09:INFO:TRAIN-(cmcm) (2/14/2)>> loss: 0.8059
2024-06-13 19:10:12:INFO:VAL-(cmcm) >>
2024-06-13 19:10:12:INFO:M: >>  Has0_acc_2: 0.7249  Has0_F1_score: 0.7276  Non0_acc_2: 0.7361  Non0_F1_score: 0.7375  Mult_acc_5: 0.3493  Mult_acc_7: 0.2707  MAE: 1.1202  Corr: 0.5665 
2024-06-13 19:10:12:INFO:Saving checkpoint at epoch 14 to results/models/cmcm-mosi-regression.pth.
2024-06-13 19:10:27:INFO:TRAIN-(cmcm) (1/15/2)>> loss: 0.7892
2024-06-13 19:10:30:INFO:VAL-(cmcm) >>
2024-06-13 19:10:30:INFO:M: >>  Has0_acc_2: 0.7336  Has0_F1_score: 0.7356  Non0_acc_2: 0.7593  Non0_F1_score: 0.7601  Mult_acc_5: 0.3581  Mult_acc_7: 0.2751  MAE: 1.1459  Corr: 0.5765 
2024-06-13 19:10:45:INFO:TRAIN-(cmcm) (2/16/2)>> loss: 0.7873
2024-06-13 19:10:47:INFO:VAL-(cmcm) >>
2024-06-13 19:10:47:INFO:M: >>  Has0_acc_2: 0.7380  Has0_F1_score: 0.7358  Non0_acc_2: 0.6389  Non0_F1_score: 0.6270  Mult_acc_5: 0.3624  Mult_acc_7: 0.3013  MAE: 1.1411  Corr: 0.5510 
2024-06-13 19:11:02:INFO:TRAIN-(cmcm) (3/17/2)>> loss: 0.7696
2024-06-13 19:11:05:INFO:VAL-(cmcm) >>
2024-06-13 19:11:05:INFO:M: >>  Has0_acc_2: 0.7293  Has0_F1_score: 0.7229  Non0_acc_2: 0.7639  Non0_F1_score: 0.7652  Mult_acc_5: 0.4017  Mult_acc_7: 0.3275  MAE: 1.0328  Corr: 0.6008 
2024-06-13 19:11:06:INFO:Saving checkpoint at epoch 17 to results/models/cmcm-mosi-regression.pth.
2024-06-13 19:11:21:INFO:TRAIN-(cmcm) (1/18/2)>> loss: 0.7550
2024-06-13 19:11:24:INFO:VAL-(cmcm) >>
2024-06-13 19:11:24:INFO:M: >>  Has0_acc_2: 0.7336  Has0_F1_score: 0.7360  Non0_acc_2: 0.7500  Non0_F1_score: 0.7512  Mult_acc_5: 0.4017  Mult_acc_7: 0.3013  MAE: 1.1499  Corr: 0.5753 
2024-06-13 19:11:39:INFO:TRAIN-(cmcm) (2/19/2)>> loss: 0.7701
2024-06-13 19:11:41:INFO:VAL-(cmcm) >>
2024-06-13 19:11:41:INFO:M: >>  Has0_acc_2: 0.7555  Has0_F1_score: 0.7562  Non0_acc_2: 0.7639  Non0_F1_score: 0.7637  Mult_acc_5: 0.4629  Mult_acc_7: 0.3537  MAE: 1.0490  Corr: 0.6153 
2024-06-13 19:11:56:INFO:TRAIN-(cmcm) (3/20/2)>> loss: 0.7507
2024-06-13 19:11:59:INFO:VAL-(cmcm) >>
2024-06-13 19:11:59:INFO:M: >>  Has0_acc_2: 0.7293  Has0_F1_score: 0.7317  Non0_acc_2: 0.7361  Non0_F1_score: 0.7374  Mult_acc_5: 0.4105  Mult_acc_7: 0.3275  MAE: 1.1193  Corr: 0.5493 
2024-06-13 19:12:14:INFO:TRAIN-(cmcm) (4/21/2)>> loss: 0.7425
2024-06-13 19:12:16:INFO:VAL-(cmcm) >>
2024-06-13 19:12:16:INFO:M: >>  Has0_acc_2: 0.7336  Has0_F1_score: 0.7278  Non0_acc_2: 0.7315  Non0_F1_score: 0.7318  Mult_acc_5: 0.4236  Mult_acc_7: 0.3493  MAE: 1.1149  Corr: 0.5567 
2024-06-13 19:12:31:INFO:TRAIN-(cmcm) (5/22/2)>> loss: 0.7280
2024-06-13 19:12:34:INFO:VAL-(cmcm) >>
2024-06-13 19:12:34:INFO:M: >>  Has0_acc_2: 0.7555  Has0_F1_score: 0.7576  Non0_acc_2: 0.7176  Non0_F1_score: 0.7159  Mult_acc_5: 0.4105  Mult_acc_7: 0.3275  MAE: 1.0892  Corr: 0.5803 
2024-06-13 19:12:49:INFO:TRAIN-(cmcm) (6/23/2)>> loss: 0.7357
2024-06-13 19:12:51:INFO:VAL-(cmcm) >>
2024-06-13 19:12:51:INFO:M: >>  Has0_acc_2: 0.7380  Has0_F1_score: 0.7402  Non0_acc_2: 0.7639  Non0_F1_score: 0.7649  Mult_acc_5: 0.3886  Mult_acc_7: 0.2969  MAE: 1.1302  Corr: 0.5886 
2024-06-13 19:13:06:INFO:TRAIN-(cmcm) (7/24/2)>> loss: 0.7245
2024-06-13 19:13:09:INFO:VAL-(cmcm) >>
2024-06-13 19:13:09:INFO:M: >>  Has0_acc_2: 0.7773  Has0_F1_score: 0.7778  Non0_acc_2: 0.7407  Non0_F1_score: 0.7418  Mult_acc_5: 0.3843  Mult_acc_7: 0.2969  MAE: 1.1215  Corr: 0.5589 
2024-06-13 19:13:24:INFO:TRAIN-(cmcm) (8/25/2)>> loss: 0.7100
2024-06-13 19:13:26:INFO:VAL-(cmcm) >>
2024-06-13 19:13:26:INFO:M: >>  Has0_acc_2: 0.7729  Has0_F1_score: 0.7747  Non0_acc_2: 0.7731  Non0_F1_score: 0.7744  Mult_acc_5: 0.4279  Mult_acc_7: 0.3450  MAE: 1.0494  Corr: 0.6017 
2024-06-13 19:13:41:INFO:TRAIN-(cmcm) (9/26/2)>> loss: 0.7162
2024-06-13 19:13:44:INFO:VAL-(cmcm) >>
2024-06-13 19:13:44:INFO:M: >>  Has0_acc_2: 0.7817  Has0_F1_score: 0.7838  Non0_acc_2: 0.7546  Non0_F1_score: 0.7545  Mult_acc_5: 0.3799  Mult_acc_7: 0.3188  MAE: 1.0516  Corr: 0.5822 
2024-06-13 19:13:59:INFO:TRAIN-(cmcm) (10/27/2)>> loss: 0.7089
2024-06-13 19:14:02:INFO:VAL-(cmcm) >>
2024-06-13 19:14:02:INFO:M: >>  Has0_acc_2: 0.7511  Has0_F1_score: 0.7532  Non0_acc_2: 0.7731  Non0_F1_score: 0.7742  Mult_acc_5: 0.3712  Mult_acc_7: 0.2882  MAE: 1.0975  Corr: 0.6039 
2024-06-13 19:14:09:INFO:TEST-(cmcm) >>
2024-06-13 19:14:09:INFO:M: >>  Has0_acc_2: 0.6691  Has0_F1_score: 0.6644  Non0_acc_2: 0.7104  Non0_F1_score: 0.7092  Mult_acc_5: 0.3280  Mult_acc_7: 0.2886  MAE: 1.1521  Corr: 0.5222 
2024-06-13 19:14:09:INFO:Results are added to results/results/mosi-regression-70.csv...
2024-06-13 19:14:09:INFO:Start running cmcm...
2024-06-13 19:14:09:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 6, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 70, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 3333}>
2024-06-13 19:14:09:INFO:Let's use the GPU 1 !
2024-06-13 19:14:09:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 19:14:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718277250 HTTP/1.1" 200 235
2024-06-13 19:14:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 19:14:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 19:14:11:INFO:train samples: (1284,)
2024-06-13 19:14:11:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 19:14:11:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718277252 HTTP/1.1" 200 235
2024-06-13 19:14:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 19:14:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 19:14:13:INFO:valid samples: (229,)
2024-06-13 19:14:13:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 19:14:13:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718277253 HTTP/1.1" 200 235
2024-06-13 19:14:13:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 19:14:14:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 19:14:14:INFO:test samples: (686,)
2024-06-13 19:14:14:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 19:14:14:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718277255 HTTP/1.1" 200 235
2024-06-13 19:14:15:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 19:14:15:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 19:14:16:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 19:14:16:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718277256 HTTP/1.1" 200 235
2024-06-13 19:14:16:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 19:14:16:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 19:14:17:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-13 19:14:17:WARNING:Try importing flash-attention for faster inference...
2024-06-13 19:14:17:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-13 19:14:17:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-13 19:14:17:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-13 19:14:18:INFO:trainable params: 1310288 || all params: 1838138960 || trainable%: 0.07128340286090232
2024-06-13 19:14:18:INFO:Init labels...
2024-06-13 19:14:18:INFO:Start training...
2024-06-13 19:14:33:INFO:TRAIN-(cmcm) (1/1/3)>> loss: 2.3895
2024-06-13 19:14:35:INFO:VAL-(cmcm) >>
2024-06-13 19:14:35:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.4788  Non0_acc_2: 0.5556  Non0_F1_score: 0.4680  Mult_acc_5: 0.2664  Mult_acc_7: 0.2009  MAE: 1.8200  Corr: -0.0122 
2024-06-13 19:14:35:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-13 19:14:51:INFO:TRAIN-(cmcm) (1/2/3)>> loss: 1.0024
2024-06-13 19:14:53:INFO:VAL-(cmcm) >>
2024-06-13 19:14:53:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4652  Non0_acc_2: 0.5833  Non0_F1_score: 0.4469  Mult_acc_5: 0.2052  Mult_acc_7: 0.1834  MAE: 1.5533  Corr: 0.0578 
2024-06-13 19:14:53:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-13 19:15:09:INFO:TRAIN-(cmcm) (1/3/3)>> loss: 0.9393
2024-06-13 19:15:11:INFO:VAL-(cmcm) >>
2024-06-13 19:15:11:INFO:M: >>  Has0_acc_2: 0.4760  Has0_F1_score: 0.4177  Non0_acc_2: 0.5046  Non0_F1_score: 0.4503  Mult_acc_5: 0.2052  Mult_acc_7: 0.1834  MAE: 1.9497  Corr: 0.0821 
2024-06-13 19:15:26:INFO:TRAIN-(cmcm) (2/4/3)>> loss: 0.8993
2024-06-13 19:15:28:INFO:VAL-(cmcm) >>
2024-06-13 19:15:28:INFO:M: >>  Has0_acc_2: 0.4017  Has0_F1_score: 0.2589  Non0_acc_2: 0.4213  Non0_F1_score: 0.2753  Mult_acc_5: 0.1310  Mult_acc_7: 0.1310  MAE: 1.8536  Corr: -0.0266 
2024-06-13 19:15:43:INFO:TRAIN-(cmcm) (3/5/3)>> loss: 0.8834
2024-06-13 19:15:46:INFO:VAL-(cmcm) >>
2024-06-13 19:15:46:INFO:M: >>  Has0_acc_2: 0.4367  Has0_F1_score: 0.3143  Non0_acc_2: 0.4630  Non0_F1_score: 0.3434  Mult_acc_5: 0.1397  Mult_acc_7: 0.1397  MAE: 1.8117  Corr: 0.1212 
2024-06-13 19:16:01:INFO:TRAIN-(cmcm) (4/6/3)>> loss: 0.8734
2024-06-13 19:16:03:INFO:VAL-(cmcm) >>
2024-06-13 19:16:03:INFO:M: >>  Has0_acc_2: 0.5590  Has0_F1_score: 0.5187  Non0_acc_2: 0.5463  Non0_F1_score: 0.5030  Mult_acc_5: 0.2489  Mult_acc_7: 0.1834  MAE: 1.7235  Corr: 0.0023 
2024-06-13 19:16:18:INFO:TRAIN-(cmcm) (5/7/3)>> loss: 0.8759
2024-06-13 19:16:20:INFO:VAL-(cmcm) >>
2024-06-13 19:16:20:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.5178  Non0_acc_2: 0.5648  Non0_F1_score: 0.5019  Mult_acc_5: 0.2052  Mult_acc_7: 0.1790  MAE: 1.5602  Corr: 0.0238 
2024-06-13 19:16:35:INFO:TRAIN-(cmcm) (6/8/3)>> loss: 0.8731
2024-06-13 19:16:38:INFO:VAL-(cmcm) >>
2024-06-13 19:16:38:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5028  Non0_acc_2: 0.4352  Non0_F1_score: 0.2819  Mult_acc_5: 0.2009  Mult_acc_7: 0.2009  MAE: 1.5025  Corr: -0.0307 
2024-06-13 19:16:38:INFO:Saving checkpoint at epoch 8 to results/models/cmcm-mosi-regression.pth.
2024-06-13 19:16:53:INFO:TRAIN-(cmcm) (1/9/3)>> loss: 0.8662
2024-06-13 19:16:56:INFO:VAL-(cmcm) >>
2024-06-13 19:16:56:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5247  Non0_acc_2: 0.5648  Non0_F1_score: 0.5059  Mult_acc_5: 0.2882  Mult_acc_7: 0.2096  MAE: 1.6612  Corr: 0.0234 
2024-06-13 19:17:10:INFO:TRAIN-(cmcm) (2/10/3)>> loss: 0.8627
2024-06-13 19:17:13:INFO:VAL-(cmcm) >>
2024-06-13 19:17:13:INFO:M: >>  Has0_acc_2: 0.5546  Has0_F1_score: 0.5426  Non0_acc_2: 0.5417  Non0_F1_score: 0.5284  Mult_acc_5: 0.2664  Mult_acc_7: 0.1921  MAE: 1.7381  Corr: 0.0079 
2024-06-13 19:17:28:INFO:TRAIN-(cmcm) (3/11/3)>> loss: 0.8652
2024-06-13 19:17:30:INFO:VAL-(cmcm) >>
2024-06-13 19:17:30:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.4645  Non0_acc_2: 0.5509  Non0_F1_score: 0.4362  Mult_acc_5: 0.2882  Mult_acc_7: 0.2096  MAE: 1.8018  Corr: -0.0623 
2024-06-13 19:17:45:INFO:TRAIN-(cmcm) (4/12/3)>> loss: 0.8655
2024-06-13 19:17:48:INFO:VAL-(cmcm) >>
2024-06-13 19:17:48:INFO:M: >>  Has0_acc_2: 0.5590  Has0_F1_score: 0.5297  Non0_acc_2: 0.5463  Non0_F1_score: 0.5266  Mult_acc_5: 0.1703  Mult_acc_7: 0.1703  MAE: 1.5646  Corr: -0.0118 
2024-06-13 19:18:02:INFO:TRAIN-(cmcm) (5/13/3)>> loss: 0.8601
2024-06-13 19:18:05:INFO:VAL-(cmcm) >>
2024-06-13 19:18:05:INFO:M: >>  Has0_acc_2: 0.5633  Has0_F1_score: 0.5086  Non0_acc_2: 0.5463  Non0_F1_score: 0.4888  Mult_acc_5: 0.2140  Mult_acc_7: 0.1834  MAE: 1.6835  Corr: -0.0169 
2024-06-13 19:18:20:INFO:TRAIN-(cmcm) (6/14/3)>> loss: 0.8526
2024-06-13 19:18:22:INFO:VAL-(cmcm) >>
2024-06-13 19:18:22:INFO:M: >>  Has0_acc_2: 0.5109  Has0_F1_score: 0.5100  Non0_acc_2: 0.5000  Non0_F1_score: 0.4984  Mult_acc_5: 0.2271  Mult_acc_7: 0.1703  MAE: 1.7117  Corr: -0.0270 
2024-06-13 19:18:37:INFO:TRAIN-(cmcm) (7/15/3)>> loss: 0.8511
2024-06-13 19:18:40:INFO:VAL-(cmcm) >>
2024-06-13 19:18:40:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4830  Non0_acc_2: 0.5741  Non0_F1_score: 0.4558  Mult_acc_5: 0.2707  Mult_acc_7: 0.1878  MAE: 1.6961  Corr: -0.0032 
2024-06-13 19:18:54:INFO:TRAIN-(cmcm) (8/16/3)>> loss: 0.8512
2024-06-13 19:18:57:INFO:VAL-(cmcm) >>
2024-06-13 19:18:57:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.4924  Non0_acc_2: 0.5602  Non0_F1_score: 0.4656  Mult_acc_5: 0.2358  Mult_acc_7: 0.2096  MAE: 1.6184  Corr: -0.0314 
2024-06-13 19:19:12:INFO:TRAIN-(cmcm) (9/17/3)>> loss: 0.8442
2024-06-13 19:19:14:INFO:VAL-(cmcm) >>
2024-06-13 19:19:14:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.5013  Non0_acc_2: 0.5602  Non0_F1_score: 0.4810  Mult_acc_5: 0.2882  Mult_acc_7: 0.2358  MAE: 1.6865  Corr: -0.0397 
2024-06-13 19:19:29:INFO:TRAIN-(cmcm) (10/18/3)>> loss: 0.8397
2024-06-13 19:19:32:INFO:VAL-(cmcm) >>
2024-06-13 19:19:32:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4742  Non0_acc_2: 0.5694  Non0_F1_score: 0.4768  Mult_acc_5: 0.2489  Mult_acc_7: 0.2009  MAE: 1.5957  Corr: 0.0130 
2024-06-13 19:19:39:INFO:TEST-(cmcm) >>
2024-06-13 19:19:39:INFO:M: >>  Has0_acc_2: 0.5117  Has0_F1_score: 0.4595  Non0_acc_2: 0.5747  Non0_F1_score: 0.4244  Mult_acc_5: 0.1735  Mult_acc_7: 0.1735  MAE: 1.3897  Corr: 0.0760 
2024-06-13 19:19:39:INFO:Results are added to results/results/mosi-regression-70.csv...
2024-06-13 19:19:39:INFO:Start running cmcm...
2024-06-13 19:19:39:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 6, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 70, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 4444}>
2024-06-13 19:19:39:INFO:Let's use the GPU 1 !
2024-06-13 19:19:39:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 19:19:40:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718277580 HTTP/1.1" 200 235
2024-06-13 19:19:40:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 19:19:40:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 19:19:41:INFO:train samples: (1284,)
2024-06-13 19:19:41:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 19:19:41:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718277582 HTTP/1.1" 200 235
2024-06-13 19:19:42:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 19:19:42:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 19:19:43:INFO:valid samples: (229,)
2024-06-13 19:19:43:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 19:19:43:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718277583 HTTP/1.1" 200 235
2024-06-13 19:19:43:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 19:19:44:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 19:19:44:INFO:test samples: (686,)
2024-06-13 19:19:44:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 19:19:45:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718277585 HTTP/1.1" 200 235
2024-06-13 19:19:45:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 19:19:45:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 19:19:46:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 19:19:46:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718277586 HTTP/1.1" 200 235
2024-06-13 19:19:46:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 19:19:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 19:19:47:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-13 19:19:47:WARNING:Try importing flash-attention for faster inference...
2024-06-13 19:19:47:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-13 19:19:47:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-13 19:19:47:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-13 19:19:48:INFO:trainable params: 1310288 || all params: 1838138960 || trainable%: 0.07128340286090232
2024-06-13 19:19:48:INFO:Init labels...
2024-06-13 19:19:48:INFO:Start training...
2024-06-13 19:20:03:INFO:TRAIN-(cmcm) (1/1/4)>> loss: 2.7703
2024-06-13 19:20:05:INFO:VAL-(cmcm) >>
2024-06-13 19:20:05:INFO:M: >>  Has0_acc_2: 0.5197  Has0_F1_score: 0.5243  Non0_acc_2: 0.5139  Non0_F1_score: 0.5165  Mult_acc_5: 0.2445  Mult_acc_7: 0.1921  MAE: 1.7868  Corr: 0.0251 
2024-06-13 19:20:05:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-13 19:20:20:INFO:TRAIN-(cmcm) (1/2/4)>> loss: 0.9799
2024-06-13 19:20:23:INFO:VAL-(cmcm) >>
2024-06-13 19:20:23:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5611  Non0_acc_2: 0.5694  Non0_F1_score: 0.5517  Mult_acc_5: 0.2314  Mult_acc_7: 0.2314  MAE: 1.4606  Corr: 0.1150 
2024-06-13 19:20:23:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-13 19:20:38:INFO:TRAIN-(cmcm) (1/3/4)>> loss: 0.9022
2024-06-13 19:20:41:INFO:VAL-(cmcm) >>
2024-06-13 19:20:41:INFO:M: >>  Has0_acc_2: 0.5546  Has0_F1_score: 0.5484  Non0_acc_2: 0.5509  Non0_F1_score: 0.5425  Mult_acc_5: 0.2402  Mult_acc_7: 0.1921  MAE: 1.7065  Corr: 0.0094 
2024-06-13 19:20:56:INFO:TRAIN-(cmcm) (2/4/4)>> loss: 0.8858
2024-06-13 19:20:58:INFO:VAL-(cmcm) >>
2024-06-13 19:20:58:INFO:M: >>  Has0_acc_2: 0.4760  Has0_F1_score: 0.4396  Non0_acc_2: 0.5000  Non0_F1_score: 0.4654  Mult_acc_5: 0.1790  Mult_acc_7: 0.1790  MAE: 1.6820  Corr: 0.1363 
2024-06-13 19:21:13:INFO:TRAIN-(cmcm) (3/5/4)>> loss: 0.8729
2024-06-13 19:21:15:INFO:VAL-(cmcm) >>
2024-06-13 19:21:15:INFO:M: >>  Has0_acc_2: 0.6376  Has0_F1_score: 0.5610  Non0_acc_2: 0.6250  Non0_F1_score: 0.5489  Mult_acc_5: 0.2183  Mult_acc_7: 0.2096  MAE: 1.3977  Corr: 0.2601 
2024-06-13 19:21:16:INFO:Saving checkpoint at epoch 5 to results/models/cmcm-mosi-regression.pth.
2024-06-13 19:21:31:INFO:TRAIN-(cmcm) (1/6/4)>> loss: 0.8669
2024-06-13 19:21:33:INFO:VAL-(cmcm) >>
2024-06-13 19:21:33:INFO:M: >>  Has0_acc_2: 0.6157  Has0_F1_score: 0.5675  Non0_acc_2: 0.6019  Non0_F1_score: 0.5514  Mult_acc_5: 0.3013  Mult_acc_7: 0.2402  MAE: 1.6274  Corr: 0.1530 
2024-06-13 19:21:48:INFO:TRAIN-(cmcm) (2/7/4)>> loss: 0.8553
2024-06-13 19:21:51:INFO:VAL-(cmcm) >>
2024-06-13 19:21:51:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.4839  Non0_acc_2: 0.5880  Non0_F1_score: 0.4567  Mult_acc_5: 0.1878  Mult_acc_7: 0.1790  MAE: 1.5257  Corr: 0.1220 
2024-06-13 19:22:05:INFO:TRAIN-(cmcm) (3/8/4)>> loss: 0.8363
2024-06-13 19:22:08:INFO:VAL-(cmcm) >>
2024-06-13 19:22:08:INFO:M: >>  Has0_acc_2: 0.6900  Has0_F1_score: 0.6919  Non0_acc_2: 0.6991  Non0_F1_score: 0.6996  Mult_acc_5: 0.3231  Mult_acc_7: 0.2314  MAE: 1.4075  Corr: 0.3919 
2024-06-13 19:22:23:INFO:TRAIN-(cmcm) (4/9/4)>> loss: 0.8221
2024-06-13 19:22:25:INFO:VAL-(cmcm) >>
2024-06-13 19:22:25:INFO:M: >>  Has0_acc_2: 0.7074  Has0_F1_score: 0.7083  Non0_acc_2: 0.6435  Non0_F1_score: 0.6251  Mult_acc_5: 0.2576  Mult_acc_7: 0.2314  MAE: 1.1816  Corr: 0.5559 
2024-06-13 19:22:25:INFO:Saving checkpoint at epoch 9 to results/models/cmcm-mosi-regression.pth.
2024-06-13 19:22:40:INFO:TRAIN-(cmcm) (1/10/4)>> loss: 0.8082
2024-06-13 19:22:43:INFO:VAL-(cmcm) >>
2024-06-13 19:22:43:INFO:M: >>  Has0_acc_2: 0.6812  Has0_F1_score: 0.6371  Non0_acc_2: 0.6944  Non0_F1_score: 0.6557  Mult_acc_5: 0.3231  Mult_acc_7: 0.2620  MAE: 1.3331  Corr: 0.3964 
2024-06-13 19:22:58:INFO:TRAIN-(cmcm) (2/11/4)>> loss: 0.7947
2024-06-13 19:23:00:INFO:VAL-(cmcm) >>
2024-06-13 19:23:00:INFO:M: >>  Has0_acc_2: 0.7162  Has0_F1_score: 0.7069  Non0_acc_2: 0.7315  Non0_F1_score: 0.7210  Mult_acc_5: 0.3406  Mult_acc_7: 0.2882  MAE: 1.1191  Corr: 0.5329 
2024-06-13 19:23:01:INFO:Saving checkpoint at epoch 11 to results/models/cmcm-mosi-regression.pth.
2024-06-13 19:23:16:INFO:TRAIN-(cmcm) (1/12/4)>> loss: 0.7887
2024-06-13 19:23:18:INFO:VAL-(cmcm) >>
2024-06-13 19:23:18:INFO:M: >>  Has0_acc_2: 0.7467  Has0_F1_score: 0.7357  Non0_acc_2: 0.7500  Non0_F1_score: 0.7380  Mult_acc_5: 0.3581  Mult_acc_7: 0.2795  MAE: 1.1603  Corr: 0.5443 
2024-06-13 19:23:33:INFO:TRAIN-(cmcm) (2/13/4)>> loss: 0.7733
2024-06-13 19:23:35:INFO:VAL-(cmcm) >>
2024-06-13 19:23:35:INFO:M: >>  Has0_acc_2: 0.7249  Has0_F1_score: 0.7256  Non0_acc_2: 0.7500  Non0_F1_score: 0.7496  Mult_acc_5: 0.3188  Mult_acc_7: 0.2707  MAE: 1.1039  Corr: 0.5531 
2024-06-13 19:23:36:INFO:Saving checkpoint at epoch 13 to results/models/cmcm-mosi-regression.pth.
2024-06-13 19:23:51:INFO:TRAIN-(cmcm) (1/14/4)>> loss: 0.7694
2024-06-13 19:23:53:INFO:VAL-(cmcm) >>
2024-06-13 19:23:53:INFO:M: >>  Has0_acc_2: 0.7293  Has0_F1_score: 0.7308  Non0_acc_2: 0.7546  Non0_F1_score: 0.7548  Mult_acc_5: 0.3406  Mult_acc_7: 0.2751  MAE: 1.1132  Corr: 0.5335 
2024-06-13 19:24:08:INFO:TRAIN-(cmcm) (2/15/4)>> loss: 0.7664
2024-06-13 19:24:11:INFO:VAL-(cmcm) >>
2024-06-13 19:24:11:INFO:M: >>  Has0_acc_2: 0.7380  Has0_F1_score: 0.7343  Non0_acc_2: 0.7361  Non0_F1_score: 0.7327  Mult_acc_5: 0.3712  Mult_acc_7: 0.2795  MAE: 1.1005  Corr: 0.5782 
2024-06-13 19:24:11:INFO:Saving checkpoint at epoch 15 to results/models/cmcm-mosi-regression.pth.
2024-06-13 19:24:26:INFO:TRAIN-(cmcm) (1/16/4)>> loss: 0.7528
2024-06-13 19:24:28:INFO:VAL-(cmcm) >>
2024-06-13 19:24:28:INFO:M: >>  Has0_acc_2: 0.7380  Has0_F1_score: 0.7400  Non0_acc_2: 0.7731  Non0_F1_score: 0.7736  Mult_acc_5: 0.3624  Mult_acc_7: 0.3013  MAE: 1.0599  Corr: 0.5785 
2024-06-13 19:24:29:INFO:Saving checkpoint at epoch 16 to results/models/cmcm-mosi-regression.pth.
2024-06-13 19:24:44:INFO:TRAIN-(cmcm) (1/17/4)>> loss: 0.7398
2024-06-13 19:24:46:INFO:VAL-(cmcm) >>
2024-06-13 19:24:46:INFO:M: >>  Has0_acc_2: 0.7336  Has0_F1_score: 0.7317  Non0_acc_2: 0.7454  Non0_F1_score: 0.7427  Mult_acc_5: 0.3886  Mult_acc_7: 0.3275  MAE: 1.0979  Corr: 0.5345 
2024-06-13 19:25:01:INFO:TRAIN-(cmcm) (2/18/4)>> loss: 0.7439
2024-06-13 19:25:04:INFO:VAL-(cmcm) >>
2024-06-13 19:25:04:INFO:M: >>  Has0_acc_2: 0.7336  Has0_F1_score: 0.7215  Non0_acc_2: 0.7083  Non0_F1_score: 0.7092  Mult_acc_5: 0.3930  Mult_acc_7: 0.3231  MAE: 1.1384  Corr: 0.4885 
2024-06-13 19:25:18:INFO:TRAIN-(cmcm) (3/19/4)>> loss: 0.7280
2024-06-13 19:25:21:INFO:VAL-(cmcm) >>
2024-06-13 19:25:21:INFO:M: >>  Has0_acc_2: 0.7162  Has0_F1_score: 0.7186  Non0_acc_2: 0.6620  Non0_F1_score: 0.6594  Mult_acc_5: 0.3275  Mult_acc_7: 0.2795  MAE: 1.1599  Corr: 0.5042 
2024-06-13 19:25:36:INFO:TRAIN-(cmcm) (4/20/4)>> loss: 0.7191
2024-06-13 19:25:38:INFO:VAL-(cmcm) >>
2024-06-13 19:25:38:INFO:M: >>  Has0_acc_2: 0.6812  Has0_F1_score: 0.6521  Non0_acc_2: 0.7269  Non0_F1_score: 0.7117  Mult_acc_5: 0.3930  Mult_acc_7: 0.3144  MAE: 1.2429  Corr: 0.4581 
2024-06-13 19:25:53:INFO:TRAIN-(cmcm) (5/21/4)>> loss: 0.7310
2024-06-13 19:25:55:INFO:VAL-(cmcm) >>
2024-06-13 19:25:55:INFO:M: >>  Has0_acc_2: 0.7424  Has0_F1_score: 0.7440  Non0_acc_2: 0.7639  Non0_F1_score: 0.7646  Mult_acc_5: 0.3843  Mult_acc_7: 0.3057  MAE: 1.1039  Corr: 0.5728 
2024-06-13 19:26:10:INFO:TRAIN-(cmcm) (6/22/4)>> loss: 0.7161
2024-06-13 19:26:13:INFO:VAL-(cmcm) >>
2024-06-13 19:26:13:INFO:M: >>  Has0_acc_2: 0.6594  Has0_F1_score: 0.6514  Non0_acc_2: 0.6667  Non0_F1_score: 0.6545  Mult_acc_5: 0.3450  Mult_acc_7: 0.2664  MAE: 1.2407  Corr: 0.5415 
2024-06-13 19:26:27:INFO:TRAIN-(cmcm) (7/23/4)>> loss: 0.7141
2024-06-13 19:26:30:INFO:VAL-(cmcm) >>
2024-06-13 19:26:30:INFO:M: >>  Has0_acc_2: 0.7555  Has0_F1_score: 0.7497  Non0_acc_2: 0.7593  Non0_F1_score: 0.7551  Mult_acc_5: 0.4061  Mult_acc_7: 0.3275  MAE: 1.0839  Corr: 0.5421 
2024-06-13 19:26:45:INFO:TRAIN-(cmcm) (8/24/4)>> loss: 0.6952
2024-06-13 19:26:47:INFO:VAL-(cmcm) >>
2024-06-13 19:26:47:INFO:M: >>  Has0_acc_2: 0.7729  Has0_F1_score: 0.7725  Non0_acc_2: 0.7778  Non0_F1_score: 0.7771  Mult_acc_5: 0.4192  Mult_acc_7: 0.3406  MAE: 1.0223  Corr: 0.6114 
2024-06-13 19:26:47:INFO:Saving checkpoint at epoch 24 to results/models/cmcm-mosi-regression.pth.
2024-06-13 19:27:02:INFO:TRAIN-(cmcm) (1/25/4)>> loss: 0.6777
2024-06-13 19:27:05:INFO:VAL-(cmcm) >>
2024-06-13 19:27:05:INFO:M: >>  Has0_acc_2: 0.7642  Has0_F1_score: 0.7633  Non0_acc_2: 0.7500  Non0_F1_score: 0.7492  Mult_acc_5: 0.4105  Mult_acc_7: 0.3450  MAE: 1.0822  Corr: 0.5556 
2024-06-13 19:27:20:INFO:TRAIN-(cmcm) (2/26/4)>> loss: 0.6744
2024-06-13 19:27:22:INFO:VAL-(cmcm) >>
2024-06-13 19:27:22:INFO:M: >>  Has0_acc_2: 0.7467  Has0_F1_score: 0.7452  Non0_acc_2: 0.7454  Non0_F1_score: 0.7455  Mult_acc_5: 0.3886  Mult_acc_7: 0.3319  MAE: 1.0934  Corr: 0.5449 
2024-06-13 19:27:37:INFO:TRAIN-(cmcm) (3/27/4)>> loss: 0.6787
2024-06-13 19:27:39:INFO:VAL-(cmcm) >>
2024-06-13 19:27:39:INFO:M: >>  Has0_acc_2: 0.7860  Has0_F1_score: 0.7814  Non0_acc_2: 0.7685  Non0_F1_score: 0.7658  Mult_acc_5: 0.4323  Mult_acc_7: 0.3493  MAE: 1.0695  Corr: 0.5774 
2024-06-13 19:27:54:INFO:TRAIN-(cmcm) (4/28/4)>> loss: 0.6748
2024-06-13 19:27:57:INFO:VAL-(cmcm) >>
2024-06-13 19:27:57:INFO:M: >>  Has0_acc_2: 0.7773  Has0_F1_score: 0.7709  Non0_acc_2: 0.7731  Non0_F1_score: 0.7682  Mult_acc_5: 0.4410  Mult_acc_7: 0.3581  MAE: 1.0228  Corr: 0.5984 
2024-06-13 19:28:11:INFO:TRAIN-(cmcm) (5/29/4)>> loss: 0.6467
2024-06-13 19:28:14:INFO:VAL-(cmcm) >>
2024-06-13 19:28:14:INFO:M: >>  Has0_acc_2: 0.7424  Has0_F1_score: 0.7391  Non0_acc_2: 0.7500  Non0_F1_score: 0.7506  Mult_acc_5: 0.3974  Mult_acc_7: 0.3362  MAE: 1.0809  Corr: 0.5425 
2024-06-13 19:28:29:INFO:TRAIN-(cmcm) (6/30/4)>> loss: 0.6491
2024-06-13 19:28:31:INFO:VAL-(cmcm) >>
2024-06-13 19:28:31:INFO:M: >>  Has0_acc_2: 0.7773  Has0_F1_score: 0.7732  Non0_acc_2: 0.7685  Non0_F1_score: 0.7658  Mult_acc_5: 0.4323  Mult_acc_7: 0.3362  MAE: 1.0686  Corr: 0.5859 
2024-06-13 19:28:46:INFO:TRAIN-(cmcm) (7/31/4)>> loss: 0.6389
2024-06-13 19:28:49:INFO:VAL-(cmcm) >>
2024-06-13 19:28:49:INFO:M: >>  Has0_acc_2: 0.7598  Has0_F1_score: 0.7568  Non0_acc_2: 0.7870  Non0_F1_score: 0.7827  Mult_acc_5: 0.3493  Mult_acc_7: 0.3057  MAE: 1.0337  Corr: 0.6090 
2024-06-13 19:29:03:INFO:TRAIN-(cmcm) (8/32/4)>> loss: 0.6336
2024-06-13 19:29:06:INFO:VAL-(cmcm) >>
2024-06-13 19:29:06:INFO:M: >>  Has0_acc_2: 0.7686  Has0_F1_score: 0.7627  Non0_acc_2: 0.7917  Non0_F1_score: 0.7884  Mult_acc_5: 0.4061  Mult_acc_7: 0.3275  MAE: 1.0734  Corr: 0.5711 
2024-06-13 19:29:20:INFO:TRAIN-(cmcm) (9/33/4)>> loss: 0.6138
2024-06-13 19:29:23:INFO:VAL-(cmcm) >>
2024-06-13 19:29:23:INFO:M: >>  Has0_acc_2: 0.7642  Has0_F1_score: 0.7550  Non0_acc_2: 0.7731  Non0_F1_score: 0.7666  Mult_acc_5: 0.4061  Mult_acc_7: 0.3406  MAE: 1.0643  Corr: 0.5589 
2024-06-13 19:29:38:INFO:TRAIN-(cmcm) (10/34/4)>> loss: 0.6169
2024-06-13 19:29:40:INFO:VAL-(cmcm) >>
2024-06-13 19:29:40:INFO:M: >>  Has0_acc_2: 0.7642  Has0_F1_score: 0.7633  Non0_acc_2: 0.7824  Non0_F1_score: 0.7815  Mult_acc_5: 0.4323  Mult_acc_7: 0.3537  MAE: 1.0389  Corr: 0.5860 
2024-06-13 19:29:48:INFO:TEST-(cmcm) >>
2024-06-13 19:29:48:INFO:M: >>  Has0_acc_2: 0.7318  Has0_F1_score: 0.7311  Non0_acc_2: 0.7470  Non0_F1_score: 0.7463  Mult_acc_5: 0.3615  Mult_acc_7: 0.3061  MAE: 1.0946  Corr: 0.5447 
2024-06-13 19:29:48:INFO:Results are added to results/results/mosi-regression-70.csv...
2024-06-13 19:29:48:INFO:Start running cmcm...
2024-06-13 19:29:48:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 6, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 70, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 5555}>
2024-06-13 19:29:48:INFO:Let's use the GPU 1 !
2024-06-13 19:29:48:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 19:29:49:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718278189 HTTP/1.1" 200 235
2024-06-13 19:29:49:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 19:29:49:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 19:29:50:INFO:train samples: (1284,)
2024-06-13 19:29:50:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 19:29:50:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718278190 HTTP/1.1" 200 235
2024-06-13 19:29:50:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 19:29:51:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 19:29:51:INFO:valid samples: (229,)
2024-06-13 19:29:52:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 19:29:52:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718278192 HTTP/1.1" 200 235
2024-06-13 19:29:52:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 19:29:52:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 19:29:53:INFO:test samples: (686,)
2024-06-13 19:29:53:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 19:29:53:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718278193 HTTP/1.1" 200 235
2024-06-13 19:29:54:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 19:29:54:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 19:29:54:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 19:29:55:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718278195 HTTP/1.1" 200 235
2024-06-13 19:29:55:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 19:29:55:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 19:29:55:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-13 19:29:55:WARNING:Try importing flash-attention for faster inference...
2024-06-13 19:29:55:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-13 19:29:55:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-13 19:29:55:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-13 19:29:56:INFO:trainable params: 1310288 || all params: 1838138960 || trainable%: 0.07128340286090232
2024-06-13 19:29:56:INFO:Init labels...
2024-06-13 19:29:56:INFO:Start training...
2024-06-13 19:30:11:INFO:TRAIN-(cmcm) (1/1/5)>> loss: 1.9238
2024-06-13 19:30:14:INFO:VAL-(cmcm) >>
2024-06-13 19:30:14:INFO:M: >>  Has0_acc_2: 0.4410  Has0_F1_score: 0.3669  Non0_acc_2: 0.4583  Non0_F1_score: 0.3824  Mult_acc_5: 0.1878  Mult_acc_7: 0.1572  MAE: 1.8912  Corr: -0.0142 
2024-06-13 19:30:14:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-13 19:30:29:INFO:TRAIN-(cmcm) (1/2/5)>> loss: 0.9418
2024-06-13 19:30:32:INFO:VAL-(cmcm) >>
2024-06-13 19:30:32:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5087  Non0_acc_2: 0.5556  Non0_F1_score: 0.4826  Mult_acc_5: 0.1616  Mult_acc_7: 0.1616  MAE: 1.5222  Corr: -0.0398 
2024-06-13 19:30:32:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-13 19:30:47:INFO:TRAIN-(cmcm) (1/3/5)>> loss: 0.8929
2024-06-13 19:30:50:INFO:VAL-(cmcm) >>
2024-06-13 19:30:50:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4652  Non0_acc_2: 0.5787  Non0_F1_score: 0.4370  Mult_acc_5: 0.1659  Mult_acc_7: 0.1659  MAE: 1.4554  Corr: 0.0788 
2024-06-13 19:30:50:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-mosi-regression.pth.
2024-06-13 19:31:05:INFO:TRAIN-(cmcm) (1/4/5)>> loss: 0.8885
2024-06-13 19:31:07:INFO:VAL-(cmcm) >>
2024-06-13 19:31:07:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.4951  Non0_acc_2: 0.5741  Non0_F1_score: 0.4742  Mult_acc_5: 0.1921  Mult_acc_7: 0.1878  MAE: 1.6001  Corr: 0.0102 
2024-06-13 19:31:22:INFO:TRAIN-(cmcm) (2/5/5)>> loss: 0.8879
2024-06-13 19:31:25:INFO:VAL-(cmcm) >>
2024-06-13 19:31:25:INFO:M: >>  Has0_acc_2: 0.5633  Has0_F1_score: 0.5402  Non0_acc_2: 0.5602  Non0_F1_score: 0.5334  Mult_acc_5: 0.2620  Mult_acc_7: 0.2009  MAE: 1.6935  Corr: 0.0324 
2024-06-13 19:31:39:INFO:TRAIN-(cmcm) (3/6/5)>> loss: 0.8716
2024-06-13 19:31:42:INFO:VAL-(cmcm) >>
2024-06-13 19:31:42:INFO:M: >>  Has0_acc_2: 0.4672  Has0_F1_score: 0.4245  Non0_acc_2: 0.4861  Non0_F1_score: 0.4432  Mult_acc_5: 0.1965  Mult_acc_7: 0.1616  MAE: 1.7095  Corr: 0.0819 
2024-06-13 19:31:57:INFO:TRAIN-(cmcm) (4/7/5)>> loss: 0.8687
2024-06-13 19:31:59:INFO:VAL-(cmcm) >>
2024-06-13 19:31:59:INFO:M: >>  Has0_acc_2: 0.5633  Has0_F1_score: 0.5546  Non0_acc_2: 0.4213  Non0_F1_score: 0.3303  Mult_acc_5: 0.1965  Mult_acc_7: 0.1965  MAE: 1.5820  Corr: 0.0529 
2024-06-13 19:32:14:INFO:TRAIN-(cmcm) (5/8/5)>> loss: 0.8860
2024-06-13 19:32:16:INFO:VAL-(cmcm) >>
2024-06-13 19:32:16:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4830  Non0_acc_2: 0.5741  Non0_F1_score: 0.4558  Mult_acc_5: 0.2838  Mult_acc_7: 0.2009  MAE: 1.7660  Corr: 0.0159 
2024-06-13 19:32:31:INFO:TRAIN-(cmcm) (6/9/5)>> loss: 0.8692
2024-06-13 19:32:34:INFO:VAL-(cmcm) >>
2024-06-13 19:32:34:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4830  Non0_acc_2: 0.5463  Non0_F1_score: 0.4926  Mult_acc_5: 0.2533  Mult_acc_7: 0.1834  MAE: 1.6354  Corr: -0.0227 
2024-06-13 19:32:48:INFO:TRAIN-(cmcm) (7/10/5)>> loss: 0.8620
2024-06-13 19:32:51:INFO:VAL-(cmcm) >>
2024-06-13 19:32:51:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4830  Non0_acc_2: 0.5324  Non0_F1_score: 0.5333  Mult_acc_5: 0.2183  Mult_acc_7: 0.2140  MAE: 1.4584  Corr: 0.0080 
2024-06-13 19:33:06:INFO:TRAIN-(cmcm) (8/11/5)>> loss: 0.8527
2024-06-13 19:33:08:INFO:VAL-(cmcm) >>
2024-06-13 19:33:08:INFO:M: >>  Has0_acc_2: 0.6332  Has0_F1_score: 0.6233  Non0_acc_2: 0.6157  Non0_F1_score: 0.6149  Mult_acc_5: 0.2183  Mult_acc_7: 0.2096  MAE: 1.4501  Corr: 0.1158 
2024-06-13 19:33:08:INFO:Saving checkpoint at epoch 11 to results/models/cmcm-mosi-regression.pth.
2024-06-13 19:33:24:INFO:TRAIN-(cmcm) (1/12/5)>> loss: 0.8502
2024-06-13 19:33:26:INFO:VAL-(cmcm) >>
2024-06-13 19:33:26:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.5704  Non0_acc_2: 0.5833  Non0_F1_score: 0.5544  Mult_acc_5: 0.2795  Mult_acc_7: 0.2052  MAE: 1.6512  Corr: 0.0601 
2024-06-13 19:33:41:INFO:TRAIN-(cmcm) (2/13/5)>> loss: 0.8447
2024-06-13 19:33:43:INFO:VAL-(cmcm) >>
2024-06-13 19:33:43:INFO:M: >>  Has0_acc_2: 0.6463  Has0_F1_score: 0.6228  Non0_acc_2: 0.6389  Non0_F1_score: 0.6138  Mult_acc_5: 0.3231  Mult_acc_7: 0.2402  MAE: 1.5595  Corr: 0.2026 
2024-06-13 19:33:58:INFO:TRAIN-(cmcm) (3/14/5)>> loss: 0.8393
2024-06-13 19:34:01:INFO:VAL-(cmcm) >>
2024-06-13 19:34:01:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.5032  Non0_acc_2: 0.5833  Non0_F1_score: 0.5735  Mult_acc_5: 0.3013  Mult_acc_7: 0.2489  MAE: 1.4667  Corr: 0.1118 
2024-06-13 19:34:15:INFO:TRAIN-(cmcm) (4/15/5)>> loss: 0.8332
2024-06-13 19:34:18:INFO:VAL-(cmcm) >>
2024-06-13 19:34:18:INFO:M: >>  Has0_acc_2: 0.6288  Has0_F1_score: 0.6167  Non0_acc_2: 0.6343  Non0_F1_score: 0.6192  Mult_acc_5: 0.3406  Mult_acc_7: 0.2664  MAE: 1.4624  Corr: 0.2378 
2024-06-13 19:34:33:INFO:TRAIN-(cmcm) (5/16/5)>> loss: 0.8220
2024-06-13 19:34:35:INFO:VAL-(cmcm) >>
2024-06-13 19:34:35:INFO:M: >>  Has0_acc_2: 0.6419  Has0_F1_score: 0.6128  Non0_acc_2: 0.6343  Non0_F1_score: 0.6031  Mult_acc_5: 0.3013  Mult_acc_7: 0.2314  MAE: 1.4381  Corr: 0.2516 
2024-06-13 19:34:35:INFO:Saving checkpoint at epoch 16 to results/models/cmcm-mosi-regression.pth.
2024-06-13 19:34:50:INFO:TRAIN-(cmcm) (1/17/5)>> loss: 0.8265
2024-06-13 19:34:53:INFO:VAL-(cmcm) >>
2024-06-13 19:34:53:INFO:M: >>  Has0_acc_2: 0.6550  Has0_F1_score: 0.6582  Non0_acc_2: 0.6481  Non0_F1_score: 0.6486  Mult_acc_5: 0.3188  Mult_acc_7: 0.2445  MAE: 1.4215  Corr: 0.3265 
2024-06-13 19:34:53:INFO:Saving checkpoint at epoch 17 to results/models/cmcm-mosi-regression.pth.
2024-06-13 19:35:08:INFO:TRAIN-(cmcm) (1/18/5)>> loss: 0.8187
2024-06-13 19:35:11:INFO:VAL-(cmcm) >>
2024-06-13 19:35:11:INFO:M: >>  Has0_acc_2: 0.6507  Has0_F1_score: 0.6303  Non0_acc_2: 0.6574  Non0_F1_score: 0.6557  Mult_acc_5: 0.3144  Mult_acc_7: 0.2533  MAE: 1.3726  Corr: 0.2691 
2024-06-13 19:35:11:INFO:Saving checkpoint at epoch 18 to results/models/cmcm-mosi-regression.pth.
2024-06-13 19:35:26:INFO:TRAIN-(cmcm) (1/19/5)>> loss: 0.8121
2024-06-13 19:35:29:INFO:VAL-(cmcm) >>
2024-06-13 19:35:29:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.5436  Non0_acc_2: 0.6065  Non0_F1_score: 0.5759  Mult_acc_5: 0.2358  Mult_acc_7: 0.2140  MAE: 1.4512  Corr: 0.3092 
2024-06-13 19:35:43:INFO:TRAIN-(cmcm) (2/20/5)>> loss: 0.8043
2024-06-13 19:35:46:INFO:VAL-(cmcm) >>
2024-06-13 19:35:46:INFO:M: >>  Has0_acc_2: 0.4760  Has0_F1_score: 0.3849  Non0_acc_2: 0.5046  Non0_F1_score: 0.4176  Mult_acc_5: 0.2489  Mult_acc_7: 0.2314  MAE: 1.7008  Corr: 0.2054 
2024-06-13 19:36:01:INFO:TRAIN-(cmcm) (3/21/5)>> loss: 0.8052
2024-06-13 19:36:03:INFO:VAL-(cmcm) >>
2024-06-13 19:36:03:INFO:M: >>  Has0_acc_2: 0.6376  Has0_F1_score: 0.6318  Non0_acc_2: 0.5324  Non0_F1_score: 0.4629  Mult_acc_5: 0.2576  Mult_acc_7: 0.2052  MAE: 1.4311  Corr: 0.3813 
2024-06-13 19:36:18:INFO:TRAIN-(cmcm) (4/22/5)>> loss: 0.7880
2024-06-13 19:36:20:INFO:VAL-(cmcm) >>
2024-06-13 19:36:20:INFO:M: >>  Has0_acc_2: 0.6376  Has0_F1_score: 0.5610  Non0_acc_2: 0.5833  Non0_F1_score: 0.5608  Mult_acc_5: 0.3100  Mult_acc_7: 0.2751  MAE: 1.2702  Corr: 0.3500 
2024-06-13 19:36:21:INFO:Saving checkpoint at epoch 22 to results/models/cmcm-mosi-regression.pth.
2024-06-13 19:36:36:INFO:TRAIN-(cmcm) (1/23/5)>> loss: 0.7744
2024-06-13 19:36:38:INFO:VAL-(cmcm) >>
2024-06-13 19:36:38:INFO:M: >>  Has0_acc_2: 0.6507  Has0_F1_score: 0.6465  Non0_acc_2: 0.6528  Non0_F1_score: 0.6444  Mult_acc_5: 0.3057  Mult_acc_7: 0.2445  MAE: 1.3279  Corr: 0.3865 
2024-06-13 19:36:53:INFO:TRAIN-(cmcm) (2/24/5)>> loss: 0.7751
2024-06-13 19:36:56:INFO:VAL-(cmcm) >>
2024-06-13 19:36:56:INFO:M: >>  Has0_acc_2: 0.6550  Has0_F1_score: 0.6301  Non0_acc_2: 0.6713  Non0_F1_score: 0.6578  Mult_acc_5: 0.3319  Mult_acc_7: 0.2445  MAE: 1.4079  Corr: 0.3282 
2024-06-13 19:37:10:INFO:TRAIN-(cmcm) (3/25/5)>> loss: 0.7621
2024-06-13 19:37:13:INFO:VAL-(cmcm) >>
2024-06-13 19:37:13:INFO:M: >>  Has0_acc_2: 0.6769  Has0_F1_score: 0.6439  Non0_acc_2: 0.6667  Non0_F1_score: 0.6643  Mult_acc_5: 0.3275  Mult_acc_7: 0.2620  MAE: 1.2632  Corr: 0.3874 
2024-06-13 19:37:13:INFO:Saving checkpoint at epoch 25 to results/models/cmcm-mosi-regression.pth.
2024-06-13 19:37:28:INFO:TRAIN-(cmcm) (1/26/5)>> loss: 0.7533
2024-06-13 19:37:31:INFO:VAL-(cmcm) >>
2024-06-13 19:37:31:INFO:M: >>  Has0_acc_2: 0.6987  Has0_F1_score: 0.6949  Non0_acc_2: 0.7037  Non0_F1_score: 0.7052  Mult_acc_5: 0.3450  Mult_acc_7: 0.2707  MAE: 1.2145  Corr: 0.4572 
2024-06-13 19:37:31:INFO:Saving checkpoint at epoch 26 to results/models/cmcm-mosi-regression.pth.
2024-06-13 19:37:46:INFO:TRAIN-(cmcm) (1/27/5)>> loss: 0.7475
2024-06-13 19:37:49:INFO:VAL-(cmcm) >>
2024-06-13 19:37:49:INFO:M: >>  Has0_acc_2: 0.6769  Has0_F1_score: 0.6704  Non0_acc_2: 0.6852  Non0_F1_score: 0.6822  Mult_acc_5: 0.3493  Mult_acc_7: 0.2838  MAE: 1.2870  Corr: 0.3697 
2024-06-13 19:38:03:INFO:TRAIN-(cmcm) (2/28/5)>> loss: 0.7436
2024-06-13 19:38:06:INFO:VAL-(cmcm) >>
2024-06-13 19:38:06:INFO:M: >>  Has0_acc_2: 0.6943  Has0_F1_score: 0.6796  Non0_acc_2: 0.7037  Non0_F1_score: 0.6921  Mult_acc_5: 0.3581  Mult_acc_7: 0.2664  MAE: 1.3381  Corr: 0.4015 
2024-06-13 19:38:21:INFO:TRAIN-(cmcm) (3/29/5)>> loss: 0.7324
2024-06-13 19:38:23:INFO:VAL-(cmcm) >>
2024-06-13 19:38:23:INFO:M: >>  Has0_acc_2: 0.7162  Has0_F1_score: 0.7189  Non0_acc_2: 0.7361  Non0_F1_score: 0.7375  Mult_acc_5: 0.3537  Mult_acc_7: 0.2707  MAE: 1.1846  Corr: 0.5030 
2024-06-13 19:38:23:INFO:Saving checkpoint at epoch 29 to results/models/cmcm-mosi-regression.pth.
2024-06-13 19:38:39:INFO:TRAIN-(cmcm) (1/30/5)>> loss: 0.7273
2024-06-13 19:38:41:INFO:VAL-(cmcm) >>
2024-06-13 19:38:41:INFO:M: >>  Has0_acc_2: 0.7336  Has0_F1_score: 0.7317  Non0_acc_2: 0.7083  Non0_F1_score: 0.7089  Mult_acc_5: 0.3493  Mult_acc_7: 0.2620  MAE: 1.1913  Corr: 0.4910 
2024-06-13 19:38:56:INFO:TRAIN-(cmcm) (2/31/5)>> loss: 0.7164
2024-06-13 19:38:58:INFO:VAL-(cmcm) >>
2024-06-13 19:38:58:INFO:M: >>  Has0_acc_2: 0.6856  Has0_F1_score: 0.6689  Non0_acc_2: 0.6435  Non0_F1_score: 0.6442  Mult_acc_5: 0.3406  Mult_acc_7: 0.2795  MAE: 1.2320  Corr: 0.4187 
2024-06-13 19:39:13:INFO:TRAIN-(cmcm) (3/32/5)>> loss: 0.7147
2024-06-13 19:39:16:INFO:VAL-(cmcm) >>
2024-06-13 19:39:16:INFO:M: >>  Has0_acc_2: 0.7424  Has0_F1_score: 0.7434  Non0_acc_2: 0.7639  Non0_F1_score: 0.7643  Mult_acc_5: 0.3624  Mult_acc_7: 0.2838  MAE: 1.1245  Corr: 0.5361 
2024-06-13 19:39:16:INFO:Saving checkpoint at epoch 32 to results/models/cmcm-mosi-regression.pth.
2024-06-13 19:39:31:INFO:TRAIN-(cmcm) (1/33/5)>> loss: 0.7189
2024-06-13 19:39:33:INFO:VAL-(cmcm) >>
2024-06-13 19:39:33:INFO:M: >>  Has0_acc_2: 0.7162  Has0_F1_score: 0.7189  Non0_acc_2: 0.7222  Non0_F1_score: 0.7237  Mult_acc_5: 0.3537  Mult_acc_7: 0.2838  MAE: 1.1991  Corr: 0.4909 
2024-06-13 19:39:48:INFO:TRAIN-(cmcm) (2/34/5)>> loss: 0.6983
2024-06-13 19:39:51:INFO:VAL-(cmcm) >>
2024-06-13 19:39:51:INFO:M: >>  Has0_acc_2: 0.6594  Has0_F1_score: 0.6615  Non0_acc_2: 0.6806  Non0_F1_score: 0.6793  Mult_acc_5: 0.3624  Mult_acc_7: 0.3057  MAE: 1.1947  Corr: 0.4505 
2024-06-13 19:40:05:INFO:TRAIN-(cmcm) (3/35/5)>> loss: 0.6900
2024-06-13 19:40:08:INFO:VAL-(cmcm) >>
2024-06-13 19:40:08:INFO:M: >>  Has0_acc_2: 0.7205  Has0_F1_score: 0.7205  Non0_acc_2: 0.7315  Non0_F1_score: 0.7321  Mult_acc_5: 0.3799  Mult_acc_7: 0.3057  MAE: 1.1354  Corr: 0.5299 
2024-06-13 19:40:23:INFO:TRAIN-(cmcm) (4/36/5)>> loss: 0.6871
2024-06-13 19:40:25:INFO:VAL-(cmcm) >>
2024-06-13 19:40:25:INFO:M: >>  Has0_acc_2: 0.7293  Has0_F1_score: 0.7175  Non0_acc_2: 0.7361  Non0_F1_score: 0.7274  Mult_acc_5: 0.3493  Mult_acc_7: 0.2533  MAE: 1.2576  Corr: 0.4879 
2024-06-13 19:40:40:INFO:TRAIN-(cmcm) (5/37/5)>> loss: 0.6800
2024-06-13 19:40:43:INFO:VAL-(cmcm) >>
2024-06-13 19:40:43:INFO:M: >>  Has0_acc_2: 0.6812  Has0_F1_score: 0.6796  Non0_acc_2: 0.7083  Non0_F1_score: 0.7094  Mult_acc_5: 0.3406  Mult_acc_7: 0.2664  MAE: 1.2200  Corr: 0.4774 
2024-06-13 19:40:57:INFO:TRAIN-(cmcm) (6/38/5)>> loss: 0.6696
2024-06-13 19:41:00:INFO:VAL-(cmcm) >>
2024-06-13 19:41:00:INFO:M: >>  Has0_acc_2: 0.6900  Has0_F1_score: 0.6758  Non0_acc_2: 0.6944  Non0_F1_score: 0.6908  Mult_acc_5: 0.3362  Mult_acc_7: 0.2751  MAE: 1.2790  Corr: 0.4058 
2024-06-13 19:41:15:INFO:TRAIN-(cmcm) (7/39/5)>> loss: 0.6671
2024-06-13 19:41:17:INFO:VAL-(cmcm) >>
2024-06-13 19:41:17:INFO:M: >>  Has0_acc_2: 0.6943  Has0_F1_score: 0.6781  Non0_acc_2: 0.7315  Non0_F1_score: 0.7290  Mult_acc_5: 0.3581  Mult_acc_7: 0.2838  MAE: 1.2385  Corr: 0.4436 
2024-06-13 19:41:32:INFO:TRAIN-(cmcm) (8/40/5)>> loss: 0.6533
2024-06-13 19:41:34:INFO:VAL-(cmcm) >>
2024-06-13 19:41:34:INFO:M: >>  Has0_acc_2: 0.7118  Has0_F1_score: 0.7135  Non0_acc_2: 0.7269  Non0_F1_score: 0.7279  Mult_acc_5: 0.3013  Mult_acc_7: 0.2402  MAE: 1.2385  Corr: 0.4828 
2024-06-13 19:41:49:INFO:TRAIN-(cmcm) (9/41/5)>> loss: 0.6403
2024-06-13 19:41:52:INFO:VAL-(cmcm) >>
2024-06-13 19:41:52:INFO:M: >>  Has0_acc_2: 0.7031  Has0_F1_score: 0.7031  Non0_acc_2: 0.7269  Non0_F1_score: 0.7277  Mult_acc_5: 0.3537  Mult_acc_7: 0.2926  MAE: 1.1624  Corr: 0.4855 
2024-06-13 19:42:06:INFO:TRAIN-(cmcm) (10/42/5)>> loss: 0.6217
2024-06-13 19:42:09:INFO:VAL-(cmcm) >>
2024-06-13 19:42:09:INFO:M: >>  Has0_acc_2: 0.7118  Has0_F1_score: 0.7086  Non0_acc_2: 0.7130  Non0_F1_score: 0.7142  Mult_acc_5: 0.3450  Mult_acc_7: 0.2707  MAE: 1.1822  Corr: 0.5015 
2024-06-13 19:42:16:INFO:TEST-(cmcm) >>
2024-06-13 19:42:16:INFO:M: >>  Has0_acc_2: 0.6837  Has0_F1_score: 0.6837  Non0_acc_2: 0.6936  Non0_F1_score: 0.6940  Mult_acc_5: 0.3324  Mult_acc_7: 0.2930  MAE: 1.2183  Corr: 0.4085 
2024-06-13 19:42:17:INFO:Results are added to results/results/mosi-regression-70.csv...
2024-06-13 19:42:17:INFO:Start running cmcm...
2024-06-13 19:42:17:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 6, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 80, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-06-13 19:42:17:INFO:Let's use the GPU 1 !
2024-06-13 19:42:17:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 19:42:17:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718278937 HTTP/1.1" 200 235
2024-06-13 19:42:17:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 19:42:18:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 19:42:18:INFO:train samples: (1284,)
2024-06-13 19:42:18:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 19:42:19:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718278939 HTTP/1.1" 200 235
2024-06-13 19:42:19:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 19:42:20:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 19:42:20:INFO:valid samples: (229,)
2024-06-13 19:42:20:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 19:42:21:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718278941 HTTP/1.1" 200 235
2024-06-13 19:42:21:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 19:42:21:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 19:42:22:INFO:test samples: (686,)
2024-06-13 19:42:22:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 19:42:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718278942 HTTP/1.1" 200 235
2024-06-13 19:42:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 19:42:23:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 19:42:23:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 19:42:24:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718278944 HTTP/1.1" 200 235
2024-06-13 19:42:24:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 19:42:24:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 19:42:24:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-13 19:42:24:WARNING:Try importing flash-attention for faster inference...
2024-06-13 19:42:24:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-13 19:42:24:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-13 19:42:24:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-13 19:42:25:INFO:trainable params: 1310288 || all params: 1838138960 || trainable%: 0.07128340286090232
2024-06-13 19:42:25:INFO:Init labels...
2024-06-13 19:42:25:INFO:Start training...
2024-06-13 19:42:40:INFO:TRAIN-(cmcm) (1/1/1)>> loss: 2.2246
2024-06-13 19:42:43:INFO:VAL-(cmcm) >>
2024-06-13 19:42:43:INFO:M: >>  Has0_acc_2: 0.3974  Has0_F1_score: 0.2432  Non0_acc_2: 0.4213  Non0_F1_score: 0.2680  Mult_acc_5: 0.1310  Mult_acc_7: 0.1310  MAE: 1.7794  Corr: 0.0277 
2024-06-13 19:42:43:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-13 19:42:58:INFO:TRAIN-(cmcm) (1/2/1)>> loss: 0.9154
2024-06-13 19:43:01:INFO:VAL-(cmcm) >>
2024-06-13 19:43:01:INFO:M: >>  Has0_acc_2: 0.4105  Has0_F1_score: 0.2561  Non0_acc_2: 0.4352  Non0_F1_score: 0.2819  Mult_acc_5: 0.1397  Mult_acc_7: 0.1397  MAE: 1.8956  Corr: -0.0264 
2024-06-13 19:43:16:INFO:TRAIN-(cmcm) (2/3/1)>> loss: 0.8842
2024-06-13 19:43:18:INFO:VAL-(cmcm) >>
2024-06-13 19:43:18:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5741  Non0_F1_score: 0.4187  Mult_acc_5: 0.1790  Mult_acc_7: 0.1790  MAE: 1.5545  Corr: -0.0603 
2024-06-13 19:43:19:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-mosi-regression.pth.
2024-06-13 19:43:34:INFO:TRAIN-(cmcm) (1/4/1)>> loss: 0.8839
2024-06-13 19:43:36:INFO:VAL-(cmcm) >>
2024-06-13 19:43:36:INFO:M: >>  Has0_acc_2: 0.4891  Has0_F1_score: 0.4941  Non0_acc_2: 0.4398  Non0_F1_score: 0.3244  Mult_acc_5: 0.1834  Mult_acc_7: 0.1747  MAE: 1.6384  Corr: -0.0295 
2024-06-13 19:43:51:INFO:TRAIN-(cmcm) (2/5/1)>> loss: 0.8765
2024-06-13 19:43:53:INFO:VAL-(cmcm) >>
2024-06-13 19:43:53:INFO:M: >>  Has0_acc_2: 0.5153  Has0_F1_score: 0.5076  Non0_acc_2: 0.5278  Non0_F1_score: 0.5186  Mult_acc_5: 0.2271  Mult_acc_7: 0.1878  MAE: 1.7097  Corr: 0.0778 
2024-06-13 19:44:08:INFO:TRAIN-(cmcm) (3/6/1)>> loss: 0.8776
2024-06-13 19:44:11:INFO:VAL-(cmcm) >>
2024-06-13 19:44:11:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.4975  Non0_acc_2: 0.5602  Non0_F1_score: 0.4710  Mult_acc_5: 0.2533  Mult_acc_7: 0.2314  MAE: 1.5392  Corr: 0.0122 
2024-06-13 19:44:11:INFO:Saving checkpoint at epoch 6 to results/models/cmcm-mosi-regression.pth.
2024-06-13 19:44:27:INFO:TRAIN-(cmcm) (1/7/1)>> loss: 0.8655
2024-06-13 19:44:29:INFO:VAL-(cmcm) >>
2024-06-13 19:44:29:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4917  Non0_acc_2: 0.5787  Non0_F1_score: 0.4649  Mult_acc_5: 0.2969  Mult_acc_7: 0.2140  MAE: 1.7704  Corr: 0.0065 
2024-06-13 19:44:44:INFO:TRAIN-(cmcm) (2/8/1)>> loss: 0.8659
2024-06-13 19:44:46:INFO:VAL-(cmcm) >>
2024-06-13 19:44:46:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.5284  Non0_acc_2: 0.5417  Non0_F1_score: 0.5027  Mult_acc_5: 0.2533  Mult_acc_7: 0.1834  MAE: 1.6664  Corr: 0.0058 
2024-06-13 19:45:01:INFO:TRAIN-(cmcm) (3/9/1)>> loss: 0.8625
2024-06-13 19:45:04:INFO:VAL-(cmcm) >>
2024-06-13 19:45:04:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.5058  Non0_acc_2: 0.5694  Non0_F1_score: 0.4821  Mult_acc_5: 0.3013  Mult_acc_7: 0.2183  MAE: 1.7459  Corr: -0.0111 
2024-06-13 19:45:18:INFO:TRAIN-(cmcm) (4/10/1)>> loss: 0.8588
2024-06-13 19:45:21:INFO:VAL-(cmcm) >>
2024-06-13 19:45:21:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5506  Non0_acc_2: 0.5741  Non0_F1_score: 0.5334  Mult_acc_5: 0.2838  Mult_acc_7: 0.2140  MAE: 1.7368  Corr: 0.0497 
2024-06-13 19:45:36:INFO:TRAIN-(cmcm) (5/11/1)>> loss: 0.8603
2024-06-13 19:45:38:INFO:VAL-(cmcm) >>
2024-06-13 19:45:38:INFO:M: >>  Has0_acc_2: 0.5546  Has0_F1_score: 0.5287  Non0_acc_2: 0.5417  Non0_F1_score: 0.5137  Mult_acc_5: 0.2620  Mult_acc_7: 0.1790  MAE: 1.8743  Corr: -0.0053 
2024-06-13 19:45:53:INFO:TRAIN-(cmcm) (6/12/1)>> loss: 0.8512
2024-06-13 19:45:55:INFO:VAL-(cmcm) >>
2024-06-13 19:45:55:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5741  Non0_F1_score: 0.4346  Mult_acc_5: 0.1965  Mult_acc_7: 0.1790  MAE: 1.4785  Corr: 0.0045 
2024-06-13 19:45:56:INFO:Saving checkpoint at epoch 12 to results/models/cmcm-mosi-regression.pth.
2024-06-13 19:46:11:INFO:TRAIN-(cmcm) (1/13/1)>> loss: 0.8503
2024-06-13 19:46:13:INFO:VAL-(cmcm) >>
2024-06-13 19:46:13:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.5949  Non0_acc_2: 0.6019  Non0_F1_score: 0.5880  Mult_acc_5: 0.2751  Mult_acc_7: 0.1921  MAE: 1.7180  Corr: 0.1069 
2024-06-13 19:46:28:INFO:TRAIN-(cmcm) (2/14/1)>> loss: 0.8437
2024-06-13 19:46:31:INFO:VAL-(cmcm) >>
2024-06-13 19:46:31:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.6002  Non0_acc_2: 0.6019  Non0_F1_score: 0.5910  Mult_acc_5: 0.2052  Mult_acc_7: 0.2052  MAE: 1.4253  Corr: 0.1531 
2024-06-13 19:46:31:INFO:Saving checkpoint at epoch 14 to results/models/cmcm-mosi-regression.pth.
2024-06-13 19:46:46:INFO:TRAIN-(cmcm) (1/15/1)>> loss: 0.8513
2024-06-13 19:46:49:INFO:VAL-(cmcm) >>
2024-06-13 19:46:49:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.4746  Non0_acc_2: 0.5833  Non0_F1_score: 0.4469  Mult_acc_5: 0.2969  Mult_acc_7: 0.2140  MAE: 1.7346  Corr: 0.0491 
2024-06-13 19:47:04:INFO:TRAIN-(cmcm) (2/16/1)>> loss: 0.8472
2024-06-13 19:47:06:INFO:VAL-(cmcm) >>
2024-06-13 19:47:06:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5170  Non0_acc_2: 0.4630  Non0_F1_score: 0.4096  Mult_acc_5: 0.2140  Mult_acc_7: 0.2096  MAE: 1.5060  Corr: 0.0235 
2024-06-13 19:47:21:INFO:TRAIN-(cmcm) (3/17/1)>> loss: 0.8336
2024-06-13 19:47:23:INFO:VAL-(cmcm) >>
2024-06-13 19:47:23:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.5263  Non0_acc_2: 0.5926  Non0_F1_score: 0.5124  Mult_acc_5: 0.2358  Mult_acc_7: 0.2140  MAE: 1.5328  Corr: 0.1211 
2024-06-13 19:47:38:INFO:TRAIN-(cmcm) (4/18/1)>> loss: 0.8242
2024-06-13 19:47:41:INFO:VAL-(cmcm) >>
2024-06-13 19:47:41:INFO:M: >>  Has0_acc_2: 0.7031  Has0_F1_score: 0.7051  Non0_acc_2: 0.7176  Non0_F1_score: 0.7189  Mult_acc_5: 0.3624  Mult_acc_7: 0.2620  MAE: 1.3188  Corr: 0.4334 
2024-06-13 19:47:41:INFO:Saving checkpoint at epoch 18 to results/models/cmcm-mosi-regression.pth.
2024-06-13 19:47:56:INFO:TRAIN-(cmcm) (1/19/1)>> loss: 0.8137
2024-06-13 19:47:59:INFO:VAL-(cmcm) >>
2024-06-13 19:47:59:INFO:M: >>  Has0_acc_2: 0.6201  Has0_F1_score: 0.5251  Non0_acc_2: 0.6019  Non0_F1_score: 0.5030  Mult_acc_5: 0.3319  Mult_acc_7: 0.2445  MAE: 1.6158  Corr: 0.1807 
2024-06-13 19:48:13:INFO:TRAIN-(cmcm) (2/20/1)>> loss: 0.8076
2024-06-13 19:48:16:INFO:VAL-(cmcm) >>
2024-06-13 19:48:16:INFO:M: >>  Has0_acc_2: 0.6638  Has0_F1_score: 0.5967  Non0_acc_2: 0.6528  Non0_F1_score: 0.5864  Mult_acc_5: 0.3188  Mult_acc_7: 0.2576  MAE: 1.4193  Corr: 0.3668 
2024-06-13 19:48:31:INFO:TRAIN-(cmcm) (3/21/1)>> loss: 0.7931
2024-06-13 19:48:33:INFO:VAL-(cmcm) >>
2024-06-13 19:48:33:INFO:M: >>  Has0_acc_2: 0.6900  Has0_F1_score: 0.6927  Non0_acc_2: 0.7222  Non0_F1_score: 0.7234  Mult_acc_5: 0.2969  Mult_acc_7: 0.2445  MAE: 1.2975  Corr: 0.4511 
2024-06-13 19:48:34:INFO:Saving checkpoint at epoch 21 to results/models/cmcm-mosi-regression.pth.
2024-06-13 19:48:49:INFO:TRAIN-(cmcm) (1/22/1)>> loss: 0.7910
2024-06-13 19:48:51:INFO:VAL-(cmcm) >>
2024-06-13 19:48:51:INFO:M: >>  Has0_acc_2: 0.6769  Has0_F1_score: 0.6246  Non0_acc_2: 0.6852  Non0_F1_score: 0.6397  Mult_acc_5: 0.3799  Mult_acc_7: 0.2838  MAE: 1.4062  Corr: 0.3991 
2024-06-13 19:49:06:INFO:TRAIN-(cmcm) (2/23/1)>> loss: 0.7877
2024-06-13 19:49:09:INFO:VAL-(cmcm) >>
2024-06-13 19:49:09:INFO:M: >>  Has0_acc_2: 0.6594  Has0_F1_score: 0.6271  Non0_acc_2: 0.6435  Non0_F1_score: 0.6198  Mult_acc_5: 0.3144  Mult_acc_7: 0.2402  MAE: 1.4066  Corr: 0.2904 
2024-06-13 19:49:23:INFO:TRAIN-(cmcm) (3/24/1)>> loss: 0.7697
2024-06-13 19:49:26:INFO:VAL-(cmcm) >>
2024-06-13 19:49:26:INFO:M: >>  Has0_acc_2: 0.6987  Has0_F1_score: 0.6646  Non0_acc_2: 0.7269  Non0_F1_score: 0.7179  Mult_acc_5: 0.4279  Mult_acc_7: 0.3624  MAE: 1.1573  Corr: 0.4741 
2024-06-13 19:49:27:INFO:Saving checkpoint at epoch 24 to results/models/cmcm-mosi-regression.pth.
2024-06-13 19:49:42:INFO:TRAIN-(cmcm) (1/25/1)>> loss: 0.7620
2024-06-13 19:49:44:INFO:VAL-(cmcm) >>
2024-06-13 19:49:44:INFO:M: >>  Has0_acc_2: 0.6856  Has0_F1_score: 0.6435  Non0_acc_2: 0.6806  Non0_F1_score: 0.6611  Mult_acc_5: 0.3581  Mult_acc_7: 0.3013  MAE: 1.2145  Corr: 0.4433 
2024-06-13 19:49:59:INFO:TRAIN-(cmcm) (2/26/1)>> loss: 0.7493
2024-06-13 19:50:02:INFO:VAL-(cmcm) >>
2024-06-13 19:50:02:INFO:M: >>  Has0_acc_2: 0.6856  Has0_F1_score: 0.6579  Non0_acc_2: 0.6806  Non0_F1_score: 0.6688  Mult_acc_5: 0.3362  Mult_acc_7: 0.2882  MAE: 1.2835  Corr: 0.3815 
2024-06-13 19:50:17:INFO:TRAIN-(cmcm) (3/27/1)>> loss: 0.7413
2024-06-13 19:50:19:INFO:VAL-(cmcm) >>
2024-06-13 19:50:19:INFO:M: >>  Has0_acc_2: 0.6900  Has0_F1_score: 0.6928  Non0_acc_2: 0.6296  Non0_F1_score: 0.6175  Mult_acc_5: 0.3319  Mult_acc_7: 0.2664  MAE: 1.2021  Corr: 0.4728 
2024-06-13 19:50:34:INFO:TRAIN-(cmcm) (4/28/1)>> loss: 0.7470
2024-06-13 19:50:37:INFO:VAL-(cmcm) >>
2024-06-13 19:50:37:INFO:M: >>  Has0_acc_2: 0.7031  Has0_F1_score: 0.6706  Non0_acc_2: 0.6944  Non0_F1_score: 0.6674  Mult_acc_5: 0.3799  Mult_acc_7: 0.2926  MAE: 1.1708  Corr: 0.4964 
2024-06-13 19:50:51:INFO:TRAIN-(cmcm) (5/29/1)>> loss: 0.7267
2024-06-13 19:50:54:INFO:VAL-(cmcm) >>
2024-06-13 19:50:54:INFO:M: >>  Has0_acc_2: 0.6987  Has0_F1_score: 0.6900  Non0_acc_2: 0.6898  Non0_F1_score: 0.6907  Mult_acc_5: 0.3537  Mult_acc_7: 0.3144  MAE: 1.1276  Corr: 0.4954 
2024-06-13 19:50:54:INFO:Saving checkpoint at epoch 29 to results/models/cmcm-mosi-regression.pth.
2024-06-13 19:51:09:INFO:TRAIN-(cmcm) (1/30/1)>> loss: 0.7213
2024-06-13 19:51:12:INFO:VAL-(cmcm) >>
2024-06-13 19:51:12:INFO:M: >>  Has0_acc_2: 0.6987  Has0_F1_score: 0.7016  Non0_acc_2: 0.7037  Non0_F1_score: 0.7037  Mult_acc_5: 0.3406  Mult_acc_7: 0.2664  MAE: 1.1922  Corr: 0.5031 
2024-06-13 19:51:27:INFO:TRAIN-(cmcm) (2/31/1)>> loss: 0.7109
2024-06-13 19:51:29:INFO:VAL-(cmcm) >>
2024-06-13 19:51:29:INFO:M: >>  Has0_acc_2: 0.6812  Has0_F1_score: 0.6563  Non0_acc_2: 0.7037  Non0_F1_score: 0.6967  Mult_acc_5: 0.3624  Mult_acc_7: 0.3013  MAE: 1.2271  Corr: 0.4474 
2024-06-13 19:51:44:INFO:TRAIN-(cmcm) (3/32/1)>> loss: 0.7034
2024-06-13 19:51:47:INFO:VAL-(cmcm) >>
2024-06-13 19:51:47:INFO:M: >>  Has0_acc_2: 0.7598  Has0_F1_score: 0.7596  Non0_acc_2: 0.6759  Non0_F1_score: 0.6722  Mult_acc_5: 0.3406  Mult_acc_7: 0.2969  MAE: 1.1154  Corr: 0.5343 
2024-06-13 19:51:47:INFO:Saving checkpoint at epoch 32 to results/models/cmcm-mosi-regression.pth.
2024-06-13 19:52:02:INFO:TRAIN-(cmcm) (1/33/1)>> loss: 0.7108
2024-06-13 19:52:05:INFO:VAL-(cmcm) >>
2024-06-13 19:52:05:INFO:M: >>  Has0_acc_2: 0.7729  Has0_F1_score: 0.7698  Non0_acc_2: 0.7685  Non0_F1_score: 0.7669  Mult_acc_5: 0.4192  Mult_acc_7: 0.3275  MAE: 1.1678  Corr: 0.5248 
2024-06-13 19:52:20:INFO:TRAIN-(cmcm) (2/34/1)>> loss: 0.6891
2024-06-13 19:52:22:INFO:VAL-(cmcm) >>
2024-06-13 19:52:22:INFO:M: >>  Has0_acc_2: 0.6419  Has0_F1_score: 0.5765  Non0_acc_2: 0.6852  Non0_F1_score: 0.6766  Mult_acc_5: 0.3668  Mult_acc_7: 0.2795  MAE: 1.2678  Corr: 0.4187 
2024-06-13 19:52:37:INFO:TRAIN-(cmcm) (3/35/1)>> loss: 0.6953
2024-06-13 19:52:40:INFO:VAL-(cmcm) >>
2024-06-13 19:52:40:INFO:M: >>  Has0_acc_2: 0.7380  Has0_F1_score: 0.7380  Non0_acc_2: 0.6944  Non0_F1_score: 0.6957  Mult_acc_5: 0.3668  Mult_acc_7: 0.3057  MAE: 1.1263  Corr: 0.5238 
2024-06-13 19:52:55:INFO:TRAIN-(cmcm) (4/36/1)>> loss: 0.6668
2024-06-13 19:52:57:INFO:VAL-(cmcm) >>
2024-06-13 19:52:57:INFO:M: >>  Has0_acc_2: 0.7380  Has0_F1_score: 0.7266  Non0_acc_2: 0.7222  Non0_F1_score: 0.7136  Mult_acc_5: 0.3581  Mult_acc_7: 0.3100  MAE: 1.1302  Corr: 0.5091 
2024-06-13 19:53:12:INFO:TRAIN-(cmcm) (5/37/1)>> loss: 0.6644
2024-06-13 19:53:15:INFO:VAL-(cmcm) >>
2024-06-13 19:53:15:INFO:M: >>  Has0_acc_2: 0.7467  Has0_F1_score: 0.7487  Non0_acc_2: 0.7130  Non0_F1_score: 0.7116  Mult_acc_5: 0.3974  Mult_acc_7: 0.3450  MAE: 1.1261  Corr: 0.5202 
2024-06-13 19:53:30:INFO:TRAIN-(cmcm) (6/38/1)>> loss: 0.6714
2024-06-13 19:53:32:INFO:VAL-(cmcm) >>
2024-06-13 19:53:32:INFO:M: >>  Has0_acc_2: 0.6987  Has0_F1_score: 0.6669  Non0_acc_2: 0.6806  Non0_F1_score: 0.6674  Mult_acc_5: 0.3581  Mult_acc_7: 0.2838  MAE: 1.2162  Corr: 0.4134 
2024-06-13 19:53:47:INFO:TRAIN-(cmcm) (7/39/1)>> loss: 0.6593
2024-06-13 19:53:50:INFO:VAL-(cmcm) >>
2024-06-13 19:53:50:INFO:M: >>  Has0_acc_2: 0.7249  Has0_F1_score: 0.7148  Non0_acc_2: 0.7222  Non0_F1_score: 0.7229  Mult_acc_5: 0.4236  Mult_acc_7: 0.3450  MAE: 1.1433  Corr: 0.4857 
2024-06-13 19:54:04:INFO:TRAIN-(cmcm) (8/40/1)>> loss: 0.6511
2024-06-13 19:54:07:INFO:VAL-(cmcm) >>
2024-06-13 19:54:07:INFO:M: >>  Has0_acc_2: 0.7424  Has0_F1_score: 0.7359  Non0_acc_2: 0.6713  Non0_F1_score: 0.6728  Mult_acc_5: 0.3188  Mult_acc_7: 0.2620  MAE: 1.1525  Corr: 0.4681 
2024-06-13 19:54:22:INFO:TRAIN-(cmcm) (9/41/1)>> loss: 0.6351
2024-06-13 19:54:24:INFO:VAL-(cmcm) >>
2024-06-13 19:54:24:INFO:M: >>  Has0_acc_2: 0.6681  Has0_F1_score: 0.6681  Non0_acc_2: 0.6991  Non0_F1_score: 0.7004  Mult_acc_5: 0.3799  Mult_acc_7: 0.3100  MAE: 1.2529  Corr: 0.4227 
2024-06-13 19:54:39:INFO:TRAIN-(cmcm) (10/42/1)>> loss: 0.6231
2024-06-13 19:54:42:INFO:VAL-(cmcm) >>
2024-06-13 19:54:42:INFO:M: >>  Has0_acc_2: 0.7031  Has0_F1_score: 0.7005  Non0_acc_2: 0.6250  Non0_F1_score: 0.6220  Mult_acc_5: 0.3362  Mult_acc_7: 0.2882  MAE: 1.2235  Corr: 0.4195 
2024-06-13 19:54:49:INFO:TEST-(cmcm) >>
2024-06-13 19:54:49:INFO:M: >>  Has0_acc_2: 0.7041  Has0_F1_score: 0.7049  Non0_acc_2: 0.7149  Non0_F1_score: 0.7073  Mult_acc_5: 0.3134  Mult_acc_7: 0.2828  MAE: 1.1399  Corr: 0.4748 
2024-06-13 19:54:50:INFO:Results are added to results/results/mosi-regression-80.csv...
2024-06-13 19:54:50:INFO:Start running cmcm...
2024-06-13 19:54:50:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 6, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 80, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 2222}>
2024-06-13 19:54:50:INFO:Let's use the GPU 1 !
2024-06-13 19:54:50:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 19:54:50:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718279690 HTTP/1.1" 200 235
2024-06-13 19:54:51:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 19:54:51:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 19:54:52:INFO:train samples: (1284,)
2024-06-13 19:54:52:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 19:54:52:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718279692 HTTP/1.1" 200 235
2024-06-13 19:54:52:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 19:54:53:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 19:54:53:INFO:valid samples: (229,)
2024-06-13 19:54:53:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 19:54:54:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718279694 HTTP/1.1" 200 235
2024-06-13 19:54:54:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 19:54:54:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 19:54:55:INFO:test samples: (686,)
2024-06-13 19:54:55:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 19:54:55:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718279695 HTTP/1.1" 200 235
2024-06-13 19:54:55:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 19:54:56:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 19:54:56:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 19:54:56:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718279697 HTTP/1.1" 200 235
2024-06-13 19:54:57:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 19:54:57:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 19:54:57:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-13 19:54:57:WARNING:Try importing flash-attention for faster inference...
2024-06-13 19:54:57:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-13 19:54:57:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-13 19:54:57:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-13 19:54:58:INFO:trainable params: 1310288 || all params: 1838138960 || trainable%: 0.07128340286090232
2024-06-13 19:54:58:INFO:Init labels...
2024-06-13 19:54:58:INFO:Start training...
2024-06-13 19:55:13:INFO:TRAIN-(cmcm) (1/1/2)>> loss: 2.1677
2024-06-13 19:55:16:INFO:VAL-(cmcm) >>
2024-06-13 19:55:16:INFO:M: >>  Has0_acc_2: 0.5546  Has0_F1_score: 0.5310  Non0_acc_2: 0.5324  Non0_F1_score: 0.5205  Mult_acc_5: 0.1878  Mult_acc_7: 0.1878  MAE: 1.5095  Corr: -0.0411 
2024-06-13 19:55:16:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-13 19:55:31:INFO:TRAIN-(cmcm) (1/2/2)>> loss: 0.9875
2024-06-13 19:55:34:INFO:VAL-(cmcm) >>
2024-06-13 19:55:34:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5053  Non0_acc_2: 0.5694  Non0_F1_score: 0.4821  Mult_acc_5: 0.2183  Mult_acc_7: 0.1878  MAE: 1.6861  Corr: -0.0555 
2024-06-13 19:55:49:INFO:TRAIN-(cmcm) (2/3/2)>> loss: 0.9854
2024-06-13 19:55:51:INFO:VAL-(cmcm) >>
2024-06-13 19:55:51:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4556  Non0_acc_2: 0.5741  Non0_F1_score: 0.4269  Mult_acc_5: 0.3057  Mult_acc_7: 0.2271  MAE: 1.7813  Corr: -0.0147 
2024-06-13 19:56:06:INFO:TRAIN-(cmcm) (3/4/2)>> loss: 1.0141
2024-06-13 19:56:09:INFO:VAL-(cmcm) >>
2024-06-13 19:56:09:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5540  Non0_acc_2: 0.5787  Non0_F1_score: 0.5370  Mult_acc_5: 0.1834  Mult_acc_7: 0.1834  MAE: 1.5844  Corr: 0.0515 
2024-06-13 19:56:23:INFO:TRAIN-(cmcm) (4/5/2)>> loss: 0.8917
2024-06-13 19:56:26:INFO:VAL-(cmcm) >>
2024-06-13 19:56:26:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.4839  Non0_acc_2: 0.5880  Non0_F1_score: 0.4567  Mult_acc_5: 0.2314  Mult_acc_7: 0.2009  MAE: 1.5769  Corr: 0.0726 
2024-06-13 19:56:41:INFO:TRAIN-(cmcm) (5/6/2)>> loss: 0.8770
2024-06-13 19:56:43:INFO:VAL-(cmcm) >>
2024-06-13 19:56:43:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.5511  Non0_acc_2: 0.5880  Non0_F1_score: 0.5340  Mult_acc_5: 0.2795  Mult_acc_7: 0.2009  MAE: 1.5970  Corr: 0.1443 
2024-06-13 19:56:58:INFO:TRAIN-(cmcm) (6/7/2)>> loss: 0.8587
2024-06-13 19:57:01:INFO:VAL-(cmcm) >>
2024-06-13 19:57:01:INFO:M: >>  Has0_acc_2: 0.6201  Has0_F1_score: 0.6091  Non0_acc_2: 0.6111  Non0_F1_score: 0.6124  Mult_acc_5: 0.2751  Mult_acc_7: 0.2271  MAE: 1.3774  Corr: 0.3215 
2024-06-13 19:57:01:INFO:Saving checkpoint at epoch 7 to results/models/cmcm-mosi-regression.pth.
2024-06-13 19:57:16:INFO:TRAIN-(cmcm) (1/8/2)>> loss: 0.8425
2024-06-13 19:57:19:INFO:VAL-(cmcm) >>
2024-06-13 19:57:19:INFO:M: >>  Has0_acc_2: 0.6594  Has0_F1_score: 0.6602  Non0_acc_2: 0.6806  Non0_F1_score: 0.6798  Mult_acc_5: 0.3624  Mult_acc_7: 0.2576  MAE: 1.3892  Corr: 0.4521 
2024-06-13 19:57:34:INFO:TRAIN-(cmcm) (2/9/2)>> loss: 0.8285
2024-06-13 19:57:36:INFO:VAL-(cmcm) >>
2024-06-13 19:57:36:INFO:M: >>  Has0_acc_2: 0.7074  Has0_F1_score: 0.6954  Non0_acc_2: 0.7130  Non0_F1_score: 0.6992  Mult_acc_5: 0.3843  Mult_acc_7: 0.2751  MAE: 1.3634  Corr: 0.4264 
2024-06-13 19:57:36:INFO:Saving checkpoint at epoch 9 to results/models/cmcm-mosi-regression.pth.
2024-06-13 19:57:52:INFO:TRAIN-(cmcm) (1/10/2)>> loss: 0.8136
2024-06-13 19:57:54:INFO:VAL-(cmcm) >>
2024-06-13 19:57:54:INFO:M: >>  Has0_acc_2: 0.6943  Has0_F1_score: 0.6967  Non0_acc_2: 0.7037  Non0_F1_score: 0.7047  Mult_acc_5: 0.3450  Mult_acc_7: 0.2489  MAE: 1.2616  Corr: 0.4820 
2024-06-13 19:57:54:INFO:Saving checkpoint at epoch 10 to results/models/cmcm-mosi-regression.pth.
2024-06-13 19:58:10:INFO:TRAIN-(cmcm) (1/11/2)>> loss: 0.7843
2024-06-13 19:58:12:INFO:VAL-(cmcm) >>
2024-06-13 19:58:12:INFO:M: >>  Has0_acc_2: 0.7162  Has0_F1_score: 0.7109  Non0_acc_2: 0.6991  Non0_F1_score: 0.6999  Mult_acc_5: 0.3362  Mult_acc_7: 0.2620  MAE: 1.1643  Corr: 0.5404 
2024-06-13 19:58:12:INFO:Saving checkpoint at epoch 11 to results/models/cmcm-mosi-regression.pth.
2024-06-13 19:58:28:INFO:TRAIN-(cmcm) (1/12/2)>> loss: 0.7791
2024-06-13 19:58:30:INFO:VAL-(cmcm) >>
2024-06-13 19:58:30:INFO:M: >>  Has0_acc_2: 0.6725  Has0_F1_score: 0.6643  Non0_acc_2: 0.6944  Non0_F1_score: 0.6861  Mult_acc_5: 0.3886  Mult_acc_7: 0.3144  MAE: 1.1870  Corr: 0.4962 
2024-06-13 19:58:45:INFO:TRAIN-(cmcm) (2/13/2)>> loss: 0.7667
2024-06-13 19:58:48:INFO:VAL-(cmcm) >>
2024-06-13 19:58:48:INFO:M: >>  Has0_acc_2: 0.6812  Has0_F1_score: 0.6807  Non0_acc_2: 0.6898  Non0_F1_score: 0.6874  Mult_acc_5: 0.3755  Mult_acc_7: 0.2969  MAE: 1.1346  Corr: 0.5409 
2024-06-13 19:58:48:INFO:Saving checkpoint at epoch 13 to results/models/cmcm-mosi-regression.pth.
2024-06-13 19:59:03:INFO:TRAIN-(cmcm) (1/14/2)>> loss: 0.7798
2024-06-13 19:59:06:INFO:VAL-(cmcm) >>
2024-06-13 19:59:06:INFO:M: >>  Has0_acc_2: 0.7729  Has0_F1_score: 0.7725  Non0_acc_2: 0.7870  Non0_F1_score: 0.7855  Mult_acc_5: 0.4192  Mult_acc_7: 0.3100  MAE: 1.0407  Corr: 0.6115 
2024-06-13 19:59:06:INFO:Saving checkpoint at epoch 14 to results/models/cmcm-mosi-regression.pth.
2024-06-13 19:59:21:INFO:TRAIN-(cmcm) (1/15/2)>> loss: 0.7569
2024-06-13 19:59:24:INFO:VAL-(cmcm) >>
2024-06-13 19:59:24:INFO:M: >>  Has0_acc_2: 0.7467  Has0_F1_score: 0.7408  Non0_acc_2: 0.7685  Non0_F1_score: 0.7658  Mult_acc_5: 0.4410  Mult_acc_7: 0.3537  MAE: 1.0370  Corr: 0.5978 
2024-06-13 19:59:24:INFO:Saving checkpoint at epoch 15 to results/models/cmcm-mosi-regression.pth.
2024-06-13 19:59:39:INFO:TRAIN-(cmcm) (1/16/2)>> loss: 0.7512
2024-06-13 19:59:42:INFO:VAL-(cmcm) >>
2024-06-13 19:59:42:INFO:M: >>  Has0_acc_2: 0.7686  Has0_F1_score: 0.7683  Non0_acc_2: 0.7037  Non0_F1_score: 0.7023  Mult_acc_5: 0.3581  Mult_acc_7: 0.2926  MAE: 1.1283  Corr: 0.5469 
2024-06-13 19:59:57:INFO:TRAIN-(cmcm) (2/17/2)>> loss: 0.7325
2024-06-13 19:59:59:INFO:VAL-(cmcm) >>
2024-06-13 19:59:59:INFO:M: >>  Has0_acc_2: 0.7817  Has0_F1_score: 0.7780  Non0_acc_2: 0.7870  Non0_F1_score: 0.7873  Mult_acc_5: 0.3886  Mult_acc_7: 0.3057  MAE: 1.0261  Corr: 0.6361 
2024-06-13 20:00:00:INFO:Saving checkpoint at epoch 17 to results/models/cmcm-mosi-regression.pth.
2024-06-13 20:00:15:INFO:TRAIN-(cmcm) (1/18/2)>> loss: 0.7313
2024-06-13 20:00:17:INFO:VAL-(cmcm) >>
2024-06-13 20:00:17:INFO:M: >>  Has0_acc_2: 0.7336  Has0_F1_score: 0.7360  Non0_acc_2: 0.7222  Non0_F1_score: 0.7218  Mult_acc_5: 0.4192  Mult_acc_7: 0.3362  MAE: 1.1140  Corr: 0.5851 
2024-06-13 20:00:32:INFO:TRAIN-(cmcm) (2/19/2)>> loss: 0.7272
2024-06-13 20:00:35:INFO:VAL-(cmcm) >>
2024-06-13 20:00:35:INFO:M: >>  Has0_acc_2: 0.7555  Has0_F1_score: 0.7575  Non0_acc_2: 0.7778  Non0_F1_score: 0.7785  Mult_acc_5: 0.4236  Mult_acc_7: 0.3275  MAE: 1.0868  Corr: 0.5925 
2024-06-13 20:00:49:INFO:TRAIN-(cmcm) (3/20/2)>> loss: 0.7133
2024-06-13 20:00:52:INFO:VAL-(cmcm) >>
2024-06-13 20:00:52:INFO:M: >>  Has0_acc_2: 0.7773  Has0_F1_score: 0.7739  Non0_acc_2: 0.7778  Non0_F1_score: 0.7739  Mult_acc_5: 0.4061  Mult_acc_7: 0.3319  MAE: 1.0285  Corr: 0.6310 
2024-06-13 20:01:07:INFO:TRAIN-(cmcm) (4/21/2)>> loss: 0.7135
2024-06-13 20:01:09:INFO:VAL-(cmcm) >>
2024-06-13 20:01:09:INFO:M: >>  Has0_acc_2: 0.7598  Has0_F1_score: 0.7575  Non0_acc_2: 0.7778  Non0_F1_score: 0.7774  Mult_acc_5: 0.4541  Mult_acc_7: 0.3450  MAE: 1.0337  Corr: 0.6393 
2024-06-13 20:01:24:INFO:TRAIN-(cmcm) (5/22/2)>> loss: 0.6996
2024-06-13 20:01:27:INFO:VAL-(cmcm) >>
2024-06-13 20:01:27:INFO:M: >>  Has0_acc_2: 0.7162  Has0_F1_score: 0.7189  Non0_acc_2: 0.6759  Non0_F1_score: 0.6755  Mult_acc_5: 0.4017  Mult_acc_7: 0.3406  MAE: 1.1235  Corr: 0.5431 
2024-06-13 20:01:42:INFO:TRAIN-(cmcm) (6/23/2)>> loss: 0.6968
2024-06-13 20:01:44:INFO:VAL-(cmcm) >>
2024-06-13 20:01:44:INFO:M: >>  Has0_acc_2: 0.7817  Has0_F1_score: 0.7808  Non0_acc_2: 0.7824  Non0_F1_score: 0.7830  Mult_acc_5: 0.4061  Mult_acc_7: 0.3231  MAE: 1.0787  Corr: 0.6243 
2024-06-13 20:01:59:INFO:TRAIN-(cmcm) (7/24/2)>> loss: 0.6876
2024-06-13 20:02:02:INFO:VAL-(cmcm) >>
2024-06-13 20:02:02:INFO:M: >>  Has0_acc_2: 0.7686  Has0_F1_score: 0.7688  Non0_acc_2: 0.6759  Non0_F1_score: 0.6676  Mult_acc_5: 0.3843  Mult_acc_7: 0.3231  MAE: 1.0375  Corr: 0.6211 
2024-06-13 20:02:16:INFO:TRAIN-(cmcm) (8/25/2)>> loss: 0.6947
2024-06-13 20:02:19:INFO:VAL-(cmcm) >>
2024-06-13 20:02:19:INFO:M: >>  Has0_acc_2: 0.7598  Has0_F1_score: 0.7568  Non0_acc_2: 0.7731  Non0_F1_score: 0.7695  Mult_acc_5: 0.4279  Mult_acc_7: 0.3275  MAE: 1.0830  Corr: 0.6079 
2024-06-13 20:02:34:INFO:TRAIN-(cmcm) (9/26/2)>> loss: 0.6874
2024-06-13 20:02:36:INFO:VAL-(cmcm) >>
2024-06-13 20:02:36:INFO:M: >>  Has0_acc_2: 0.7555  Has0_F1_score: 0.7569  Non0_acc_2: 0.7037  Non0_F1_score: 0.7044  Mult_acc_5: 0.3799  Mult_acc_7: 0.3057  MAE: 1.0442  Corr: 0.6144 
2024-06-13 20:02:51:INFO:TRAIN-(cmcm) (10/27/2)>> loss: 0.6686
2024-06-13 20:02:54:INFO:VAL-(cmcm) >>
2024-06-13 20:02:54:INFO:M: >>  Has0_acc_2: 0.7424  Has0_F1_score: 0.7448  Non0_acc_2: 0.7361  Non0_F1_score: 0.7363  Mult_acc_5: 0.3406  Mult_acc_7: 0.2751  MAE: 1.0905  Corr: 0.5704 
2024-06-13 20:03:01:INFO:TEST-(cmcm) >>
2024-06-13 20:03:01:INFO:M: >>  Has0_acc_2: 0.7128  Has0_F1_score: 0.7124  Non0_acc_2: 0.7363  Non0_F1_score: 0.7370  Mult_acc_5: 0.3659  Mult_acc_7: 0.3178  MAE: 1.1218  Corr: 0.5533 
2024-06-13 20:03:01:INFO:Results are added to results/results/mosi-regression-80.csv...
2024-06-13 20:03:01:INFO:Start running cmcm...
2024-06-13 20:03:01:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 6, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 80, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 3333}>
2024-06-13 20:03:01:INFO:Let's use the GPU 1 !
2024-06-13 20:03:02:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 20:03:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718280182 HTTP/1.1" 200 235
2024-06-13 20:03:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 20:03:03:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 20:03:03:INFO:train samples: (1284,)
2024-06-13 20:03:03:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 20:03:04:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718280184 HTTP/1.1" 200 235
2024-06-13 20:03:04:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 20:03:04:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 20:03:05:INFO:valid samples: (229,)
2024-06-13 20:03:05:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 20:03:05:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718280185 HTTP/1.1" 200 235
2024-06-13 20:03:05:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 20:03:06:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 20:03:07:INFO:test samples: (686,)
2024-06-13 20:03:07:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 20:03:07:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718280187 HTTP/1.1" 200 235
2024-06-13 20:03:07:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 20:03:07:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 20:03:08:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 20:03:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718280188 HTTP/1.1" 200 235
2024-06-13 20:03:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 20:03:09:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 20:03:09:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-13 20:03:09:WARNING:Try importing flash-attention for faster inference...
2024-06-13 20:03:09:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-13 20:03:09:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-13 20:03:09:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-13 20:03:10:INFO:trainable params: 1310288 || all params: 1838138960 || trainable%: 0.07128340286090232
2024-06-13 20:03:10:INFO:Init labels...
2024-06-13 20:03:10:INFO:Start training...
2024-06-13 20:03:25:INFO:TRAIN-(cmcm) (1/1/3)>> loss: 2.4218
2024-06-13 20:03:27:INFO:VAL-(cmcm) >>
2024-06-13 20:03:27:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4556  Non0_acc_2: 0.5741  Non0_F1_score: 0.4269  Mult_acc_5: 0.2664  Mult_acc_7: 0.2052  MAE: 1.7285  Corr: 0.0041 
2024-06-13 20:03:28:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-13 20:03:43:INFO:TRAIN-(cmcm) (1/2/3)>> loss: 0.9567
2024-06-13 20:03:45:INFO:VAL-(cmcm) >>
2024-06-13 20:03:45:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4630  Non0_acc_2: 0.5787  Non0_F1_score: 0.4445  Mult_acc_5: 0.3275  Mult_acc_7: 0.2489  MAE: 1.7023  Corr: 0.0558 
2024-06-13 20:03:46:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-13 20:04:01:INFO:TRAIN-(cmcm) (1/3/3)>> loss: 0.9107
2024-06-13 20:04:04:INFO:VAL-(cmcm) >>
2024-06-13 20:04:04:INFO:M: >>  Has0_acc_2: 0.5371  Has0_F1_score: 0.5398  Non0_acc_2: 0.5324  Non0_F1_score: 0.5338  Mult_acc_5: 0.2664  Mult_acc_7: 0.1921  MAE: 1.8040  Corr: 0.0117 
2024-06-13 20:04:18:INFO:TRAIN-(cmcm) (2/4/3)>> loss: 0.8874
2024-06-13 20:04:21:INFO:VAL-(cmcm) >>
2024-06-13 20:04:21:INFO:M: >>  Has0_acc_2: 0.4934  Has0_F1_score: 0.4404  Non0_acc_2: 0.5139  Non0_F1_score: 0.4606  Mult_acc_5: 0.1747  Mult_acc_7: 0.1747  MAE: 1.6833  Corr: 0.1685 
2024-06-13 20:04:22:INFO:Saving checkpoint at epoch 4 to results/models/cmcm-mosi-regression.pth.
2024-06-13 20:04:37:INFO:TRAIN-(cmcm) (1/5/3)>> loss: 0.8760
2024-06-13 20:04:39:INFO:VAL-(cmcm) >>
2024-06-13 20:04:39:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.5032  Non0_acc_2: 0.5833  Non0_F1_score: 0.4799  Mult_acc_5: 0.2969  Mult_acc_7: 0.2183  MAE: 1.6761  Corr: 0.0906 
2024-06-13 20:04:40:INFO:Saving checkpoint at epoch 5 to results/models/cmcm-mosi-regression.pth.
2024-06-13 20:04:55:INFO:TRAIN-(cmcm) (1/6/3)>> loss: 0.8665
2024-06-13 20:04:58:INFO:VAL-(cmcm) >>
2024-06-13 20:04:58:INFO:M: >>  Has0_acc_2: 0.5590  Has0_F1_score: 0.5462  Non0_acc_2: 0.5556  Non0_F1_score: 0.5401  Mult_acc_5: 0.2489  Mult_acc_7: 0.1616  MAE: 1.8241  Corr: 0.0378 
2024-06-13 20:05:12:INFO:TRAIN-(cmcm) (2/7/3)>> loss: 0.8816
2024-06-13 20:05:15:INFO:VAL-(cmcm) >>
2024-06-13 20:05:15:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.5071  Non0_acc_2: 0.5694  Non0_F1_score: 0.4920  Mult_acc_5: 0.1921  Mult_acc_7: 0.1878  MAE: 1.4969  Corr: 0.0633 
2024-06-13 20:05:15:INFO:Saving checkpoint at epoch 7 to results/models/cmcm-mosi-regression.pth.
2024-06-13 20:05:30:INFO:TRAIN-(cmcm) (1/8/3)>> loss: 0.8763
2024-06-13 20:05:33:INFO:VAL-(cmcm) >>
2024-06-13 20:05:33:INFO:M: >>  Has0_acc_2: 0.5633  Has0_F1_score: 0.4969  Non0_acc_2: 0.5046  Non0_F1_score: 0.5026  Mult_acc_5: 0.2533  Mult_acc_7: 0.1790  MAE: 1.6223  Corr: -0.0350 
2024-06-13 20:05:48:INFO:TRAIN-(cmcm) (2/9/3)>> loss: 0.8667
2024-06-13 20:05:50:INFO:VAL-(cmcm) >>
2024-06-13 20:05:50:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.4920  Non0_acc_2: 0.5509  Non0_F1_score: 0.4651  Mult_acc_5: 0.2882  Mult_acc_7: 0.2052  MAE: 1.7547  Corr: -0.0150 
2024-06-13 20:06:05:INFO:TRAIN-(cmcm) (3/10/3)>> loss: 0.8606
2024-06-13 20:06:08:INFO:VAL-(cmcm) >>
2024-06-13 20:06:08:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5349  Non0_acc_2: 0.5694  Non0_F1_score: 0.5203  Mult_acc_5: 0.2795  Mult_acc_7: 0.2009  MAE: 1.6848  Corr: 0.0377 
2024-06-13 20:06:23:INFO:TRAIN-(cmcm) (4/11/3)>> loss: 0.8569
2024-06-13 20:06:25:INFO:VAL-(cmcm) >>
2024-06-13 20:06:25:INFO:M: >>  Has0_acc_2: 0.5546  Has0_F1_score: 0.4336  Non0_acc_2: 0.5324  Non0_F1_score: 0.4061  Mult_acc_5: 0.2838  Mult_acc_7: 0.2009  MAE: 1.7739  Corr: -0.0976 
2024-06-13 20:06:40:INFO:TRAIN-(cmcm) (5/12/3)>> loss: 0.8540
2024-06-13 20:06:42:INFO:VAL-(cmcm) >>
2024-06-13 20:06:42:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.4843  Non0_acc_2: 0.5509  Non0_F1_score: 0.4996  Mult_acc_5: 0.1965  Mult_acc_7: 0.1659  MAE: 1.5350  Corr: 0.0726 
2024-06-13 20:06:57:INFO:TRAIN-(cmcm) (6/13/3)>> loss: 0.8504
2024-06-13 20:07:00:INFO:VAL-(cmcm) >>
2024-06-13 20:07:00:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.5749  Non0_acc_2: 0.6019  Non0_F1_score: 0.5765  Mult_acc_5: 0.2576  Mult_acc_7: 0.2271  MAE: 1.4624  Corr: 0.2009 
2024-06-13 20:07:00:INFO:Saving checkpoint at epoch 13 to results/models/cmcm-mosi-regression.pth.
2024-06-13 20:07:16:INFO:TRAIN-(cmcm) (1/14/3)>> loss: 0.8450
2024-06-13 20:07:18:INFO:VAL-(cmcm) >>
2024-06-13 20:07:18:INFO:M: >>  Has0_acc_2: 0.6245  Has0_F1_score: 0.6257  Non0_acc_2: 0.6435  Non0_F1_score: 0.6421  Mult_acc_5: 0.2838  Mult_acc_7: 0.2489  MAE: 1.3231  Corr: 0.3249 
2024-06-13 20:07:18:INFO:Saving checkpoint at epoch 14 to results/models/cmcm-mosi-regression.pth.
2024-06-13 20:07:34:INFO:TRAIN-(cmcm) (1/15/3)>> loss: 0.8401
2024-06-13 20:07:36:INFO:VAL-(cmcm) >>
2024-06-13 20:07:36:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5662  Non0_acc_2: 0.5741  Non0_F1_score: 0.5592  Mult_acc_5: 0.2795  Mult_acc_7: 0.2009  MAE: 1.7097  Corr: 0.1708 
2024-06-13 20:07:51:INFO:TRAIN-(cmcm) (2/16/3)>> loss: 0.8334
2024-06-13 20:07:53:INFO:VAL-(cmcm) >>
2024-06-13 20:07:53:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4700  Non0_acc_2: 0.5741  Non0_F1_score: 0.4420  Mult_acc_5: 0.3057  Mult_acc_7: 0.2140  MAE: 1.7197  Corr: 0.1982 
2024-06-13 20:08:08:INFO:TRAIN-(cmcm) (3/17/3)>> loss: 0.8327
2024-06-13 20:08:11:INFO:VAL-(cmcm) >>
2024-06-13 20:08:11:INFO:M: >>  Has0_acc_2: 0.6463  Has0_F1_score: 0.6034  Non0_acc_2: 0.6435  Non0_F1_score: 0.5968  Mult_acc_5: 0.3231  Mult_acc_7: 0.2314  MAE: 1.4940  Corr: 0.3507 
2024-06-13 20:08:26:INFO:TRAIN-(cmcm) (4/18/3)>> loss: 0.8170
2024-06-13 20:08:28:INFO:VAL-(cmcm) >>
2024-06-13 20:08:28:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.5339  Non0_acc_2: 0.5880  Non0_F1_score: 0.5092  Mult_acc_5: 0.3537  Mult_acc_7: 0.2838  MAE: 1.3420  Corr: 0.3682 
2024-06-13 20:08:43:INFO:TRAIN-(cmcm) (5/19/3)>> loss: 0.8161
2024-06-13 20:08:46:INFO:VAL-(cmcm) >>
2024-06-13 20:08:46:INFO:M: >>  Has0_acc_2: 0.6812  Has0_F1_score: 0.6371  Non0_acc_2: 0.6667  Non0_F1_score: 0.6215  Mult_acc_5: 0.3668  Mult_acc_7: 0.2926  MAE: 1.1538  Corr: 0.5251 
2024-06-13 20:08:46:INFO:Saving checkpoint at epoch 19 to results/models/cmcm-mosi-regression.pth.
2024-06-13 20:09:01:INFO:TRAIN-(cmcm) (1/20/3)>> loss: 0.8064
2024-06-13 20:09:04:INFO:VAL-(cmcm) >>
2024-06-13 20:09:04:INFO:M: >>  Has0_acc_2: 0.6419  Has0_F1_score: 0.5999  Non0_acc_2: 0.6435  Non0_F1_score: 0.5968  Mult_acc_5: 0.3886  Mult_acc_7: 0.2926  MAE: 1.3682  Corr: 0.3868 
2024-06-13 20:09:18:INFO:TRAIN-(cmcm) (2/21/3)>> loss: 0.7859
2024-06-13 20:09:21:INFO:VAL-(cmcm) >>
2024-06-13 20:09:21:INFO:M: >>  Has0_acc_2: 0.6638  Has0_F1_score: 0.6669  Non0_acc_2: 0.6528  Non0_F1_score: 0.6520  Mult_acc_5: 0.2882  Mult_acc_7: 0.2271  MAE: 1.3167  Corr: 0.4475 
2024-06-13 20:09:36:INFO:TRAIN-(cmcm) (3/22/3)>> loss: 0.7850
2024-06-13 20:09:38:INFO:VAL-(cmcm) >>
2024-06-13 20:09:38:INFO:M: >>  Has0_acc_2: 0.6550  Has0_F1_score: 0.6576  Non0_acc_2: 0.6806  Non0_F1_score: 0.6820  Mult_acc_5: 0.3406  Mult_acc_7: 0.2707  MAE: 1.2625  Corr: 0.4761 
2024-06-13 20:09:53:INFO:TRAIN-(cmcm) (4/23/3)>> loss: 0.7879
2024-06-13 20:09:56:INFO:VAL-(cmcm) >>
2024-06-13 20:09:56:INFO:M: >>  Has0_acc_2: 0.6681  Has0_F1_score: 0.6675  Non0_acc_2: 0.6343  Non0_F1_score: 0.6328  Mult_acc_5: 0.3581  Mult_acc_7: 0.2795  MAE: 1.1734  Corr: 0.4850 
2024-06-13 20:10:11:INFO:TRAIN-(cmcm) (5/24/3)>> loss: 0.7645
2024-06-13 20:10:13:INFO:VAL-(cmcm) >>
2024-06-13 20:10:13:INFO:M: >>  Has0_acc_2: 0.6987  Has0_F1_score: 0.6990  Non0_acc_2: 0.6620  Non0_F1_score: 0.6630  Mult_acc_5: 0.3712  Mult_acc_7: 0.2882  MAE: 1.1324  Corr: 0.5297 
2024-06-13 20:10:13:INFO:Saving checkpoint at epoch 24 to results/models/cmcm-mosi-regression.pth.
2024-06-13 20:10:29:INFO:TRAIN-(cmcm) (1/25/3)>> loss: 0.7567
2024-06-13 20:10:31:INFO:VAL-(cmcm) >>
2024-06-13 20:10:31:INFO:M: >>  Has0_acc_2: 0.6856  Has0_F1_score: 0.6877  Non0_acc_2: 0.7176  Non0_F1_score: 0.7189  Mult_acc_5: 0.4236  Mult_acc_7: 0.3231  MAE: 1.1053  Corr: 0.5590 
2024-06-13 20:10:31:INFO:Saving checkpoint at epoch 25 to results/models/cmcm-mosi-regression.pth.
2024-06-13 20:10:47:INFO:TRAIN-(cmcm) (1/26/3)>> loss: 0.7522
2024-06-13 20:10:49:INFO:VAL-(cmcm) >>
2024-06-13 20:10:49:INFO:M: >>  Has0_acc_2: 0.6856  Has0_F1_score: 0.6886  Non0_acc_2: 0.6667  Non0_F1_score: 0.6656  Mult_acc_5: 0.3319  Mult_acc_7: 0.2664  MAE: 1.1918  Corr: 0.5260 
2024-06-13 20:11:04:INFO:TRAIN-(cmcm) (2/27/3)>> loss: 0.7438
2024-06-13 20:11:07:INFO:VAL-(cmcm) >>
2024-06-13 20:11:07:INFO:M: >>  Has0_acc_2: 0.7249  Has0_F1_score: 0.7263  Non0_acc_2: 0.7546  Non0_F1_score: 0.7541  Mult_acc_5: 0.3537  Mult_acc_7: 0.2795  MAE: 1.1263  Corr: 0.5540 
2024-06-13 20:11:21:INFO:TRAIN-(cmcm) (3/28/3)>> loss: 0.7385
2024-06-13 20:11:24:INFO:VAL-(cmcm) >>
2024-06-13 20:11:24:INFO:M: >>  Has0_acc_2: 0.7205  Has0_F1_score: 0.7221  Non0_acc_2: 0.7083  Non0_F1_score: 0.7099  Mult_acc_5: 0.3624  Mult_acc_7: 0.2926  MAE: 1.0747  Corr: 0.5612 
2024-06-13 20:11:24:INFO:Saving checkpoint at epoch 28 to results/models/cmcm-mosi-regression.pth.
2024-06-13 20:11:40:INFO:TRAIN-(cmcm) (1/29/3)>> loss: 0.7234
2024-06-13 20:11:42:INFO:VAL-(cmcm) >>
2024-06-13 20:11:42:INFO:M: >>  Has0_acc_2: 0.6943  Has0_F1_score: 0.6972  Non0_acc_2: 0.7037  Non0_F1_score: 0.7017  Mult_acc_5: 0.3450  Mult_acc_7: 0.2795  MAE: 1.0999  Corr: 0.5581 
2024-06-13 20:11:57:INFO:TRAIN-(cmcm) (2/30/3)>> loss: 0.7173
2024-06-13 20:12:00:INFO:VAL-(cmcm) >>
2024-06-13 20:12:00:INFO:M: >>  Has0_acc_2: 0.6900  Has0_F1_score: 0.6832  Non0_acc_2: 0.7176  Non0_F1_score: 0.7189  Mult_acc_5: 0.4148  Mult_acc_7: 0.3275  MAE: 1.0975  Corr: 0.5428 
2024-06-13 20:12:14:INFO:TRAIN-(cmcm) (3/31/3)>> loss: 0.7250
2024-06-13 20:12:17:INFO:VAL-(cmcm) >>
2024-06-13 20:12:17:INFO:M: >>  Has0_acc_2: 0.6900  Has0_F1_score: 0.6928  Non0_acc_2: 0.7269  Non0_F1_score: 0.7279  Mult_acc_5: 0.3624  Mult_acc_7: 0.2838  MAE: 1.1839  Corr: 0.5324 
2024-06-13 20:12:32:INFO:TRAIN-(cmcm) (4/32/3)>> loss: 0.7049
2024-06-13 20:12:34:INFO:VAL-(cmcm) >>
2024-06-13 20:12:34:INFO:M: >>  Has0_acc_2: 0.6812  Has0_F1_score: 0.6695  Non0_acc_2: 0.6806  Non0_F1_score: 0.6821  Mult_acc_5: 0.3712  Mult_acc_7: 0.2882  MAE: 1.1599  Corr: 0.5062 
2024-06-13 20:12:49:INFO:TRAIN-(cmcm) (5/33/3)>> loss: 0.6977
2024-06-13 20:12:52:INFO:VAL-(cmcm) >>
2024-06-13 20:12:52:INFO:M: >>  Has0_acc_2: 0.7031  Has0_F1_score: 0.7053  Non0_acc_2: 0.7407  Non0_F1_score: 0.7420  Mult_acc_5: 0.3974  Mult_acc_7: 0.2969  MAE: 1.1197  Corr: 0.5624 
2024-06-13 20:13:06:INFO:TRAIN-(cmcm) (6/34/3)>> loss: 0.6924
2024-06-13 20:13:09:INFO:VAL-(cmcm) >>
2024-06-13 20:13:09:INFO:M: >>  Has0_acc_2: 0.6812  Has0_F1_score: 0.6681  Non0_acc_2: 0.6898  Non0_F1_score: 0.6784  Mult_acc_5: 0.3668  Mult_acc_7: 0.2969  MAE: 1.1271  Corr: 0.5200 
2024-06-13 20:13:24:INFO:TRAIN-(cmcm) (7/35/3)>> loss: 0.6842
2024-06-13 20:13:26:INFO:VAL-(cmcm) >>
2024-06-13 20:13:26:INFO:M: >>  Has0_acc_2: 0.6856  Has0_F1_score: 0.6850  Non0_acc_2: 0.6944  Non0_F1_score: 0.6960  Mult_acc_5: 0.3886  Mult_acc_7: 0.3188  MAE: 1.1320  Corr: 0.5340 
2024-06-13 20:13:41:INFO:TRAIN-(cmcm) (8/36/3)>> loss: 0.6717
2024-06-13 20:13:44:INFO:VAL-(cmcm) >>
2024-06-13 20:13:44:INFO:M: >>  Has0_acc_2: 0.6769  Has0_F1_score: 0.6787  Non0_acc_2: 0.7037  Non0_F1_score: 0.7053  Mult_acc_5: 0.3974  Mult_acc_7: 0.3100  MAE: 1.1267  Corr: 0.5475 
2024-06-13 20:13:59:INFO:TRAIN-(cmcm) (9/37/3)>> loss: 0.6911
2024-06-13 20:14:01:INFO:VAL-(cmcm) >>
2024-06-13 20:14:01:INFO:M: >>  Has0_acc_2: 0.6943  Has0_F1_score: 0.6766  Non0_acc_2: 0.7176  Non0_F1_score: 0.7114  Mult_acc_5: 0.4017  Mult_acc_7: 0.3100  MAE: 1.1180  Corr: 0.5539 
2024-06-13 20:14:16:INFO:TRAIN-(cmcm) (10/38/3)>> loss: 0.6587
2024-06-13 20:14:19:INFO:VAL-(cmcm) >>
2024-06-13 20:14:19:INFO:M: >>  Has0_acc_2: 0.6856  Has0_F1_score: 0.6759  Non0_acc_2: 0.6991  Non0_F1_score: 0.6903  Mult_acc_5: 0.3755  Mult_acc_7: 0.2795  MAE: 1.1774  Corr: 0.5129 
2024-06-13 20:14:26:INFO:TEST-(cmcm) >>
2024-06-13 20:14:26:INFO:M: >>  Has0_acc_2: 0.7070  Has0_F1_score: 0.7074  Non0_acc_2: 0.7454  Non0_F1_score: 0.7427  Mult_acc_5: 0.3499  Mult_acc_7: 0.3120  MAE: 1.1071  Corr: 0.5254 
2024-06-13 20:14:26:INFO:Results are added to results/results/mosi-regression-80.csv...
2024-06-13 20:14:26:INFO:Start running cmcm...
2024-06-13 20:14:26:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 6, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 80, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 4444}>
2024-06-13 20:14:26:INFO:Let's use the GPU 1 !
2024-06-13 20:14:26:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 20:14:27:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718280867 HTTP/1.1" 200 235
2024-06-13 20:14:27:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 20:14:27:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 20:14:28:INFO:train samples: (1284,)
2024-06-13 20:14:28:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 20:14:28:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718280869 HTTP/1.1" 200 235
2024-06-13 20:14:29:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 20:14:29:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 20:14:30:INFO:valid samples: (229,)
2024-06-13 20:14:30:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 20:14:30:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718280870 HTTP/1.1" 200 235
2024-06-13 20:14:30:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 20:14:31:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 20:14:31:INFO:test samples: (686,)
2024-06-13 20:14:31:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 20:14:32:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718280872 HTTP/1.1" 200 235
2024-06-13 20:14:32:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 20:14:32:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 20:14:33:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 20:14:33:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718280873 HTTP/1.1" 200 235
2024-06-13 20:14:33:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 20:14:34:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 20:14:34:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-13 20:14:34:WARNING:Try importing flash-attention for faster inference...
2024-06-13 20:14:34:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-13 20:14:34:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-13 20:14:34:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-13 20:14:35:INFO:trainable params: 1310288 || all params: 1838138960 || trainable%: 0.07128340286090232
2024-06-13 20:14:35:INFO:Init labels...
2024-06-13 20:14:35:INFO:Start training...
2024-06-13 20:14:50:INFO:TRAIN-(cmcm) (1/1/4)>> loss: 2.9211
2024-06-13 20:14:52:INFO:VAL-(cmcm) >>
2024-06-13 20:14:52:INFO:M: >>  Has0_acc_2: 0.4367  Has0_F1_score: 0.3796  Non0_acc_2: 0.4537  Non0_F1_score: 0.3957  Mult_acc_5: 0.1397  Mult_acc_7: 0.1266  MAE: 1.8266  Corr: 0.0058 
2024-06-13 20:14:53:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-13 20:15:08:INFO:TRAIN-(cmcm) (1/2/4)>> loss: 1.0375
2024-06-13 20:15:10:INFO:VAL-(cmcm) >>
2024-06-13 20:15:10:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.5352  Non0_acc_2: 0.5833  Non0_F1_score: 0.5106  Mult_acc_5: 0.2009  Mult_acc_7: 0.1921  MAE: 1.4667  Corr: 0.0448 
2024-06-13 20:15:11:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-13 20:15:26:INFO:TRAIN-(cmcm) (1/3/4)>> loss: 0.9134
2024-06-13 20:15:29:INFO:VAL-(cmcm) >>
2024-06-13 20:15:29:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.5187  Non0_acc_2: 0.5556  Non0_F1_score: 0.5030  Mult_acc_5: 0.2358  Mult_acc_7: 0.2140  MAE: 1.6385  Corr: 0.0022 
2024-06-13 20:15:43:INFO:TRAIN-(cmcm) (2/4/4)>> loss: 0.8909
2024-06-13 20:15:46:INFO:VAL-(cmcm) >>
2024-06-13 20:15:46:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5315  Non0_acc_2: 0.5648  Non0_F1_score: 0.5201  Mult_acc_5: 0.2314  Mult_acc_7: 0.1965  MAE: 1.6389  Corr: 0.0265 
2024-06-13 20:16:01:INFO:TRAIN-(cmcm) (3/5/4)>> loss: 1.5218
2024-06-13 20:16:03:INFO:VAL-(cmcm) >>
2024-06-13 20:16:03:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5741  Non0_F1_score: 0.4187  Mult_acc_5: 0.2227  Mult_acc_7: 0.1790  MAE: 1.5860  Corr: -0.0898 
2024-06-13 20:16:18:INFO:TRAIN-(cmcm) (4/6/4)>> loss: 0.9308
2024-06-13 20:16:21:INFO:VAL-(cmcm) >>
2024-06-13 20:16:21:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4723  Non0_acc_2: 0.4769  Non0_F1_score: 0.4607  Mult_acc_5: 0.1965  Mult_acc_7: 0.1965  MAE: 1.4501  Corr: 0.0437 
2024-06-13 20:16:21:INFO:Saving checkpoint at epoch 6 to results/models/cmcm-mosi-regression.pth.
2024-06-13 20:16:36:INFO:TRAIN-(cmcm) (1/7/4)>> loss: 0.8730
2024-06-13 20:16:39:INFO:VAL-(cmcm) >>
2024-06-13 20:16:39:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.4645  Non0_acc_2: 0.5509  Non0_F1_score: 0.4362  Mult_acc_5: 0.1790  Mult_acc_7: 0.1747  MAE: 1.5401  Corr: 0.0078 
2024-06-13 20:16:53:INFO:TRAIN-(cmcm) (2/8/4)>> loss: 0.8631
2024-06-13 20:16:56:INFO:VAL-(cmcm) >>
2024-06-13 20:16:56:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.4939  Non0_acc_2: 0.5509  Non0_F1_score: 0.4701  Mult_acc_5: 0.2795  Mult_acc_7: 0.2096  MAE: 1.6961  Corr: -0.0018 
2024-06-13 20:17:11:INFO:TRAIN-(cmcm) (3/9/4)>> loss: 0.8520
2024-06-13 20:17:13:INFO:VAL-(cmcm) >>
2024-06-13 20:17:13:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.5808  Non0_acc_2: 0.6065  Non0_F1_score: 0.6015  Mult_acc_5: 0.2751  Mult_acc_7: 0.2183  MAE: 1.5184  Corr: 0.2789 
2024-06-13 20:17:28:INFO:TRAIN-(cmcm) (4/10/4)>> loss: 0.8481
2024-06-13 20:17:31:INFO:VAL-(cmcm) >>
2024-06-13 20:17:31:INFO:M: >>  Has0_acc_2: 0.6507  Has0_F1_score: 0.6008  Non0_acc_2: 0.6435  Non0_F1_score: 0.5903  Mult_acc_5: 0.3275  Mult_acc_7: 0.2445  MAE: 1.5909  Corr: 0.1979 
2024-06-13 20:17:46:INFO:TRAIN-(cmcm) (5/11/4)>> loss: 0.8361
2024-06-13 20:17:48:INFO:VAL-(cmcm) >>
2024-06-13 20:17:48:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4950  Non0_acc_2: 0.5787  Non0_F1_score: 0.4711  Mult_acc_5: 0.3188  Mult_acc_7: 0.2358  MAE: 1.6481  Corr: 0.1296 
2024-06-13 20:18:03:INFO:TRAIN-(cmcm) (6/12/4)>> loss: 0.8309
2024-06-13 20:18:05:INFO:VAL-(cmcm) >>
2024-06-13 20:18:05:INFO:M: >>  Has0_acc_2: 0.6638  Has0_F1_score: 0.6282  Non0_acc_2: 0.6528  Non0_F1_score: 0.6158  Mult_acc_5: 0.3450  Mult_acc_7: 0.2620  MAE: 1.5320  Corr: 0.2351 
2024-06-13 20:18:20:INFO:TRAIN-(cmcm) (7/13/4)>> loss: 0.8165
2024-06-13 20:18:23:INFO:VAL-(cmcm) >>
2024-06-13 20:18:23:INFO:M: >>  Has0_acc_2: 0.6376  Has0_F1_score: 0.5874  Non0_acc_2: 0.6065  Non0_F1_score: 0.5646  Mult_acc_5: 0.2969  Mult_acc_7: 0.2314  MAE: 1.4097  Corr: 0.2809 
2024-06-13 20:18:23:INFO:Saving checkpoint at epoch 13 to results/models/cmcm-mosi-regression.pth.
2024-06-13 20:18:39:INFO:TRAIN-(cmcm) (1/14/4)>> loss: 0.8208
2024-06-13 20:18:41:INFO:VAL-(cmcm) >>
2024-06-13 20:18:41:INFO:M: >>  Has0_acc_2: 0.6550  Has0_F1_score: 0.6258  Non0_acc_2: 0.6667  Non0_F1_score: 0.6394  Mult_acc_5: 0.3275  Mult_acc_7: 0.2445  MAE: 1.5398  Corr: 0.2819 
2024-06-13 20:18:56:INFO:TRAIN-(cmcm) (2/15/4)>> loss: 0.8088
2024-06-13 20:18:58:INFO:VAL-(cmcm) >>
2024-06-13 20:18:58:INFO:M: >>  Has0_acc_2: 0.6507  Has0_F1_score: 0.5830  Non0_acc_2: 0.6528  Non0_F1_score: 0.5940  Mult_acc_5: 0.3057  Mult_acc_7: 0.2227  MAE: 1.5167  Corr: 0.3115 
2024-06-13 20:19:13:INFO:TRAIN-(cmcm) (3/16/4)>> loss: 0.7997
2024-06-13 20:19:16:INFO:VAL-(cmcm) >>
2024-06-13 20:19:16:INFO:M: >>  Has0_acc_2: 0.6943  Has0_F1_score: 0.6973  Non0_acc_2: 0.7130  Non0_F1_score: 0.7145  Mult_acc_5: 0.3231  Mult_acc_7: 0.2576  MAE: 1.2376  Corr: 0.4455 
2024-06-13 20:19:16:INFO:Saving checkpoint at epoch 16 to results/models/cmcm-mosi-regression.pth.
2024-06-13 20:19:31:INFO:TRAIN-(cmcm) (1/17/4)>> loss: 0.8018
2024-06-13 20:19:34:INFO:VAL-(cmcm) >>
2024-06-13 20:19:34:INFO:M: >>  Has0_acc_2: 0.6638  Has0_F1_score: 0.6541  Non0_acc_2: 0.6204  Non0_F1_score: 0.6168  Mult_acc_5: 0.3319  Mult_acc_7: 0.2664  MAE: 1.3149  Corr: 0.3413 
2024-06-13 20:19:49:INFO:TRAIN-(cmcm) (2/18/4)>> loss: 0.7852
2024-06-13 20:19:51:INFO:VAL-(cmcm) >>
2024-06-13 20:19:51:INFO:M: >>  Has0_acc_2: 0.6681  Has0_F1_score: 0.6207  Non0_acc_2: 0.7037  Non0_F1_score: 0.6848  Mult_acc_5: 0.3712  Mult_acc_7: 0.2838  MAE: 1.3883  Corr: 0.4107 
2024-06-13 20:20:06:INFO:TRAIN-(cmcm) (3/19/4)>> loss: 0.7656
2024-06-13 20:20:09:INFO:VAL-(cmcm) >>
2024-06-13 20:20:09:INFO:M: >>  Has0_acc_2: 0.6419  Has0_F1_score: 0.6409  Non0_acc_2: 0.5972  Non0_F1_score: 0.5783  Mult_acc_5: 0.2882  Mult_acc_7: 0.2576  MAE: 1.2708  Corr: 0.4124 
2024-06-13 20:20:23:INFO:TRAIN-(cmcm) (4/20/4)>> loss: 0.7793
2024-06-13 20:20:26:INFO:VAL-(cmcm) >>
2024-06-13 20:20:26:INFO:M: >>  Has0_acc_2: 0.6550  Has0_F1_score: 0.6042  Non0_acc_2: 0.6481  Non0_F1_score: 0.5973  Mult_acc_5: 0.3188  Mult_acc_7: 0.2445  MAE: 1.4228  Corr: 0.3692 
2024-06-13 20:20:41:INFO:TRAIN-(cmcm) (5/21/4)>> loss: 0.7656
2024-06-13 20:20:43:INFO:VAL-(cmcm) >>
2024-06-13 20:20:43:INFO:M: >>  Has0_acc_2: 0.7249  Has0_F1_score: 0.7180  Non0_acc_2: 0.7222  Non0_F1_score: 0.7174  Mult_acc_5: 0.3581  Mult_acc_7: 0.2620  MAE: 1.2800  Corr: 0.4562 
2024-06-13 20:20:58:INFO:TRAIN-(cmcm) (6/22/4)>> loss: 0.7540
2024-06-13 20:21:01:INFO:VAL-(cmcm) >>
2024-06-13 20:21:01:INFO:M: >>  Has0_acc_2: 0.7162  Has0_F1_score: 0.7141  Non0_acc_2: 0.7176  Non0_F1_score: 0.7153  Mult_acc_5: 0.3843  Mult_acc_7: 0.2926  MAE: 1.2154  Corr: 0.4717 
2024-06-13 20:21:01:INFO:Saving checkpoint at epoch 22 to results/models/cmcm-mosi-regression.pth.
2024-06-13 20:21:16:INFO:TRAIN-(cmcm) (1/23/4)>> loss: 0.7513
2024-06-13 20:21:19:INFO:VAL-(cmcm) >>
2024-06-13 20:21:19:INFO:M: >>  Has0_acc_2: 0.7162  Has0_F1_score: 0.7147  Non0_acc_2: 0.7130  Non0_F1_score: 0.7145  Mult_acc_5: 0.3624  Mult_acc_7: 0.2926  MAE: 1.1874  Corr: 0.4764 
2024-06-13 20:21:20:INFO:Saving checkpoint at epoch 23 to results/models/cmcm-mosi-regression.pth.
2024-06-13 20:21:35:INFO:TRAIN-(cmcm) (1/24/4)>> loss: 0.7346
2024-06-13 20:21:38:INFO:VAL-(cmcm) >>
2024-06-13 20:21:38:INFO:M: >>  Has0_acc_2: 0.6681  Has0_F1_score: 0.6207  Non0_acc_2: 0.6667  Non0_F1_score: 0.6215  Mult_acc_5: 0.3450  Mult_acc_7: 0.2576  MAE: 1.4446  Corr: 0.3725 
2024-06-13 20:21:52:INFO:TRAIN-(cmcm) (2/25/4)>> loss: 0.7366
2024-06-13 20:21:55:INFO:VAL-(cmcm) >>
2024-06-13 20:21:55:INFO:M: >>  Has0_acc_2: 0.7293  Has0_F1_score: 0.7297  Non0_acc_2: 0.7361  Non0_F1_score: 0.7355  Mult_acc_5: 0.3450  Mult_acc_7: 0.2707  MAE: 1.2686  Corr: 0.4556 
2024-06-13 20:22:10:INFO:TRAIN-(cmcm) (3/26/4)>> loss: 0.7063
2024-06-13 20:22:12:INFO:VAL-(cmcm) >>
2024-06-13 20:22:12:INFO:M: >>  Has0_acc_2: 0.6987  Has0_F1_score: 0.6984  Non0_acc_2: 0.7130  Non0_F1_score: 0.7137  Mult_acc_5: 0.3668  Mult_acc_7: 0.2882  MAE: 1.2442  Corr: 0.4188 
2024-06-13 20:22:27:INFO:TRAIN-(cmcm) (4/27/4)>> loss: 0.7122
2024-06-13 20:22:30:INFO:VAL-(cmcm) >>
2024-06-13 20:22:30:INFO:M: >>  Has0_acc_2: 0.7467  Has0_F1_score: 0.7399  Non0_acc_2: 0.7037  Non0_F1_score: 0.7002  Mult_acc_5: 0.3974  Mult_acc_7: 0.3231  MAE: 1.1630  Corr: 0.4670 
2024-06-13 20:22:30:INFO:Saving checkpoint at epoch 27 to results/models/cmcm-mosi-regression.pth.
2024-06-13 20:22:45:INFO:TRAIN-(cmcm) (1/28/4)>> loss: 0.6963
2024-06-13 20:22:48:INFO:VAL-(cmcm) >>
2024-06-13 20:22:48:INFO:M: >>  Has0_acc_2: 0.7293  Has0_F1_score: 0.7276  Non0_acc_2: 0.7361  Non0_F1_score: 0.7355  Mult_acc_5: 0.3581  Mult_acc_7: 0.2926  MAE: 1.1778  Corr: 0.4828 
2024-06-13 20:23:02:INFO:TRAIN-(cmcm) (2/29/4)>> loss: 0.7021
2024-06-13 20:23:05:INFO:VAL-(cmcm) >>
2024-06-13 20:23:05:INFO:M: >>  Has0_acc_2: 0.7380  Has0_F1_score: 0.7319  Non0_acc_2: 0.6898  Non0_F1_score: 0.6914  Mult_acc_5: 0.3886  Mult_acc_7: 0.3188  MAE: 1.1510  Corr: 0.4676 
2024-06-13 20:23:05:INFO:Saving checkpoint at epoch 29 to results/models/cmcm-mosi-regression.pth.
2024-06-13 20:23:20:INFO:TRAIN-(cmcm) (1/30/4)>> loss: 0.6893
2024-06-13 20:23:23:INFO:VAL-(cmcm) >>
2024-06-13 20:23:23:INFO:M: >>  Has0_acc_2: 0.7031  Has0_F1_score: 0.7040  Non0_acc_2: 0.7083  Non0_F1_score: 0.7085  Mult_acc_5: 0.3712  Mult_acc_7: 0.3144  MAE: 1.3009  Corr: 0.4242 
2024-06-13 20:23:38:INFO:TRAIN-(cmcm) (2/31/4)>> loss: 0.6841
2024-06-13 20:23:40:INFO:VAL-(cmcm) >>
2024-06-13 20:23:40:INFO:M: >>  Has0_acc_2: 0.7293  Has0_F1_score: 0.7305  Non0_acc_2: 0.6944  Non0_F1_score: 0.6955  Mult_acc_5: 0.3886  Mult_acc_7: 0.3231  MAE: 1.1584  Corr: 0.4897 
2024-06-13 20:23:55:INFO:TRAIN-(cmcm) (3/32/4)>> loss: 0.6700
2024-06-13 20:23:58:INFO:VAL-(cmcm) >>
2024-06-13 20:23:58:INFO:M: >>  Has0_acc_2: 0.7205  Has0_F1_score: 0.7232  Non0_acc_2: 0.7176  Non0_F1_score: 0.7191  Mult_acc_5: 0.3493  Mult_acc_7: 0.2707  MAE: 1.2293  Corr: 0.4885 
2024-06-13 20:24:13:INFO:TRAIN-(cmcm) (4/33/4)>> loss: 0.6578
2024-06-13 20:24:15:INFO:VAL-(cmcm) >>
2024-06-13 20:24:15:INFO:M: >>  Has0_acc_2: 0.7162  Has0_F1_score: 0.7153  Non0_acc_2: 0.7083  Non0_F1_score: 0.7085  Mult_acc_5: 0.3493  Mult_acc_7: 0.2838  MAE: 1.2385  Corr: 0.4709 
2024-06-13 20:24:30:INFO:TRAIN-(cmcm) (5/34/4)>> loss: 0.6561
2024-06-13 20:24:32:INFO:VAL-(cmcm) >>
2024-06-13 20:24:32:INFO:M: >>  Has0_acc_2: 0.7118  Has0_F1_score: 0.7107  Non0_acc_2: 0.6852  Non0_F1_score: 0.6867  Mult_acc_5: 0.3100  Mult_acc_7: 0.2533  MAE: 1.2140  Corr: 0.4681 
2024-06-13 20:24:47:INFO:TRAIN-(cmcm) (6/35/4)>> loss: 0.6348
2024-06-13 20:24:50:INFO:VAL-(cmcm) >>
2024-06-13 20:24:50:INFO:M: >>  Has0_acc_2: 0.7424  Has0_F1_score: 0.7398  Non0_acc_2: 0.7407  Non0_F1_score: 0.7404  Mult_acc_5: 0.3799  Mult_acc_7: 0.2926  MAE: 1.1520  Corr: 0.5204 
2024-06-13 20:25:05:INFO:TRAIN-(cmcm) (7/36/4)>> loss: 0.6361
2024-06-13 20:25:07:INFO:VAL-(cmcm) >>
2024-06-13 20:25:07:INFO:M: >>  Has0_acc_2: 0.7424  Has0_F1_score: 0.7405  Non0_acc_2: 0.7130  Non0_F1_score: 0.7125  Mult_acc_5: 0.3581  Mult_acc_7: 0.2882  MAE: 1.1791  Corr: 0.4930 
2024-06-13 20:25:22:INFO:TRAIN-(cmcm) (8/37/4)>> loss: 0.6298
2024-06-13 20:25:25:INFO:VAL-(cmcm) >>
2024-06-13 20:25:25:INFO:M: >>  Has0_acc_2: 0.7511  Has0_F1_score: 0.7486  Non0_acc_2: 0.7130  Non0_F1_score: 0.7145  Mult_acc_5: 0.3624  Mult_acc_7: 0.2795  MAE: 1.1913  Corr: 0.5026 
2024-06-13 20:25:39:INFO:TRAIN-(cmcm) (9/38/4)>> loss: 0.6067
2024-06-13 20:25:42:INFO:VAL-(cmcm) >>
2024-06-13 20:25:42:INFO:M: >>  Has0_acc_2: 0.7162  Has0_F1_score: 0.7032  Non0_acc_2: 0.6898  Non0_F1_score: 0.6873  Mult_acc_5: 0.3275  Mult_acc_7: 0.2664  MAE: 1.2442  Corr: 0.4291 
2024-06-13 20:25:57:INFO:TRAIN-(cmcm) (10/39/4)>> loss: 0.6021
2024-06-13 20:25:59:INFO:VAL-(cmcm) >>
2024-06-13 20:25:59:INFO:M: >>  Has0_acc_2: 0.7380  Has0_F1_score: 0.7370  Non0_acc_2: 0.7315  Non0_F1_score: 0.7311  Mult_acc_5: 0.3581  Mult_acc_7: 0.2838  MAE: 1.1970  Corr: 0.4988 
2024-06-13 20:26:07:INFO:TEST-(cmcm) >>
2024-06-13 20:26:07:INFO:M: >>  Has0_acc_2: 0.6880  Has0_F1_score: 0.6837  Non0_acc_2: 0.6997  Non0_F1_score: 0.7011  Mult_acc_5: 0.3324  Mult_acc_7: 0.2988  MAE: 1.1566  Corr: 0.4965 
2024-06-13 20:26:07:INFO:Results are added to results/results/mosi-regression-80.csv...
2024-06-13 20:26:07:INFO:Start running cmcm...
2024-06-13 20:26:07:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 6, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 80, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 5555}>
2024-06-13 20:26:07:INFO:Let's use the GPU 1 !
2024-06-13 20:26:07:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 20:26:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718281568 HTTP/1.1" 200 235
2024-06-13 20:26:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 20:26:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 20:26:09:INFO:train samples: (1284,)
2024-06-13 20:26:09:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 20:26:09:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718281570 HTTP/1.1" 200 235
2024-06-13 20:26:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 20:26:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 20:26:11:INFO:valid samples: (229,)
2024-06-13 20:26:11:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 20:26:11:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718281571 HTTP/1.1" 200 235
2024-06-13 20:26:11:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 20:26:11:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 20:26:12:INFO:test samples: (686,)
2024-06-13 20:26:12:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 20:26:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718281573 HTTP/1.1" 200 235
2024-06-13 20:26:13:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 20:26:13:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 20:26:13:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 20:26:14:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718281574 HTTP/1.1" 200 235
2024-06-13 20:26:14:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 20:26:14:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 20:26:14:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-13 20:26:14:WARNING:Try importing flash-attention for faster inference...
2024-06-13 20:26:14:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-13 20:26:14:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-13 20:26:14:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-13 20:26:15:INFO:trainable params: 1310288 || all params: 1838138960 || trainable%: 0.07128340286090232
2024-06-13 20:26:15:INFO:Init labels...
2024-06-13 20:26:15:INFO:Start training...
2024-06-13 20:26:30:INFO:TRAIN-(cmcm) (1/1/5)>> loss: 2.0274
2024-06-13 20:26:33:INFO:VAL-(cmcm) >>
2024-06-13 20:26:33:INFO:M: >>  Has0_acc_2: 0.5459  Has0_F1_score: 0.5503  Non0_acc_2: 0.5556  Non0_F1_score: 0.5580  Mult_acc_5: 0.1747  Mult_acc_7: 0.1703  MAE: 1.5768  Corr: 0.0797 
2024-06-13 20:26:33:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-13 20:26:48:INFO:TRAIN-(cmcm) (1/2/5)>> loss: 0.9662
2024-06-13 20:26:51:INFO:VAL-(cmcm) >>
2024-06-13 20:26:51:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4767  Non0_acc_2: 0.5741  Non0_F1_score: 0.4491  Mult_acc_5: 0.1572  Mult_acc_7: 0.1572  MAE: 1.5392  Corr: -0.0221 
2024-06-13 20:26:51:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-13 20:27:06:INFO:TRAIN-(cmcm) (1/3/5)>> loss: 0.8888
2024-06-13 20:27:09:INFO:VAL-(cmcm) >>
2024-06-13 20:27:09:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.4438  Non0_acc_2: 0.5694  Non0_F1_score: 0.4323  Mult_acc_5: 0.1747  Mult_acc_7: 0.1659  MAE: 1.5031  Corr: -0.0266 
2024-06-13 20:27:09:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-mosi-regression.pth.
2024-06-13 20:27:24:INFO:TRAIN-(cmcm) (1/4/5)>> loss: 0.8888
2024-06-13 20:27:27:INFO:VAL-(cmcm) >>
2024-06-13 20:27:27:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5175  Non0_acc_2: 0.5694  Non0_F1_score: 0.4920  Mult_acc_5: 0.2795  Mult_acc_7: 0.2096  MAE: 1.7040  Corr: 0.0048 
2024-06-13 20:27:42:INFO:TRAIN-(cmcm) (2/5/5)>> loss: 0.9022
2024-06-13 20:27:44:INFO:VAL-(cmcm) >>
2024-06-13 20:27:44:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.5109  Non0_acc_2: 0.5741  Non0_F1_score: 0.4851  Mult_acc_5: 0.2140  Mult_acc_7: 0.1965  MAE: 1.5838  Corr: 0.0551 
2024-06-13 20:27:59:INFO:TRAIN-(cmcm) (3/6/5)>> loss: 0.8733
2024-06-13 20:28:01:INFO:VAL-(cmcm) >>
2024-06-13 20:28:01:INFO:M: >>  Has0_acc_2: 0.5546  Has0_F1_score: 0.5332  Non0_acc_2: 0.5509  Non0_F1_score: 0.5304  Mult_acc_5: 0.2707  Mult_acc_7: 0.1965  MAE: 1.6782  Corr: 0.0399 
2024-06-13 20:28:16:INFO:TRAIN-(cmcm) (4/7/5)>> loss: 0.8693
2024-06-13 20:28:19:INFO:VAL-(cmcm) >>
2024-06-13 20:28:19:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5377  Non0_acc_2: 0.5833  Non0_F1_score: 0.5231  Mult_acc_5: 0.1834  Mult_acc_7: 0.1834  MAE: 1.4829  Corr: 0.0614 
2024-06-13 20:28:19:INFO:Saving checkpoint at epoch 7 to results/models/cmcm-mosi-regression.pth.
2024-06-13 20:28:34:INFO:TRAIN-(cmcm) (1/8/5)>> loss: 0.8669
2024-06-13 20:28:37:INFO:VAL-(cmcm) >>
2024-06-13 20:28:37:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.4584  Non0_acc_2: 0.5694  Non0_F1_score: 0.4465  Mult_acc_5: 0.2969  Mult_acc_7: 0.2140  MAE: 1.7660  Corr: -0.0146 
2024-06-13 20:28:51:INFO:TRAIN-(cmcm) (2/9/5)>> loss: 0.8676
2024-06-13 20:28:54:INFO:VAL-(cmcm) >>
2024-06-13 20:28:54:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.5032  Non0_acc_2: 0.5694  Non0_F1_score: 0.4768  Mult_acc_5: 0.2838  Mult_acc_7: 0.2052  MAE: 1.6568  Corr: 0.0426 
2024-06-13 20:29:09:INFO:TRAIN-(cmcm) (3/10/5)>> loss: 0.8615
2024-06-13 20:29:11:INFO:VAL-(cmcm) >>
2024-06-13 20:29:11:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4917  Non0_acc_2: 0.5741  Non0_F1_score: 0.4622  Mult_acc_5: 0.2882  Mult_acc_7: 0.2140  MAE: 1.6678  Corr: 0.0600 
2024-06-13 20:29:26:INFO:TRAIN-(cmcm) (4/11/5)>> loss: 0.8507
2024-06-13 20:29:29:INFO:VAL-(cmcm) >>
2024-06-13 20:29:29:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5252  Non0_acc_2: 0.5602  Non0_F1_score: 0.5099  Mult_acc_5: 0.2620  Mult_acc_7: 0.2227  MAE: 1.5060  Corr: 0.0714 
2024-06-13 20:29:43:INFO:TRAIN-(cmcm) (5/12/5)>> loss: 0.8469
2024-06-13 20:29:46:INFO:VAL-(cmcm) >>
2024-06-13 20:29:46:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.5573  Non0_acc_2: 0.5833  Non0_F1_score: 0.5406  Mult_acc_5: 0.3188  Mult_acc_7: 0.2358  MAE: 1.6245  Corr: 0.1111 
2024-06-13 20:30:01:INFO:TRAIN-(cmcm) (6/13/5)>> loss: 0.8516
2024-06-13 20:30:03:INFO:VAL-(cmcm) >>
2024-06-13 20:30:03:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.4843  Non0_acc_2: 0.5648  Non0_F1_score: 0.4627  Mult_acc_5: 0.3057  Mult_acc_7: 0.2402  MAE: 1.6210  Corr: 0.1054 
2024-06-13 20:30:18:INFO:TRAIN-(cmcm) (7/14/5)>> loss: 0.8415
2024-06-13 20:30:21:INFO:VAL-(cmcm) >>
2024-06-13 20:30:21:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.5799  Non0_acc_2: 0.6204  Non0_F1_score: 0.6209  Mult_acc_5: 0.3057  Mult_acc_7: 0.2489  MAE: 1.3711  Corr: 0.3286 
2024-06-13 20:30:21:INFO:Saving checkpoint at epoch 14 to results/models/cmcm-mosi-regression.pth.
2024-06-13 20:30:36:INFO:TRAIN-(cmcm) (1/15/5)>> loss: 0.8336
2024-06-13 20:30:39:INFO:VAL-(cmcm) >>
2024-06-13 20:30:39:INFO:M: >>  Has0_acc_2: 0.6157  Has0_F1_score: 0.5913  Non0_acc_2: 0.5509  Non0_F1_score: 0.5277  Mult_acc_5: 0.2926  Mult_acc_7: 0.2533  MAE: 1.3768  Corr: 0.3271 
2024-06-13 20:30:54:INFO:TRAIN-(cmcm) (2/16/5)>> loss: 0.8247
2024-06-13 20:30:56:INFO:VAL-(cmcm) >>
2024-06-13 20:30:56:INFO:M: >>  Has0_acc_2: 0.6507  Has0_F1_score: 0.6468  Non0_acc_2: 0.6759  Non0_F1_score: 0.6712  Mult_acc_5: 0.3275  Mult_acc_7: 0.2707  MAE: 1.2193  Corr: 0.4541 
2024-06-13 20:30:57:INFO:Saving checkpoint at epoch 16 to results/models/cmcm-mosi-regression.pth.
2024-06-13 20:31:12:INFO:TRAIN-(cmcm) (1/17/5)>> loss: 0.8205
2024-06-13 20:31:14:INFO:VAL-(cmcm) >>
2024-06-13 20:31:14:INFO:M: >>  Has0_acc_2: 0.6332  Has0_F1_score: 0.6361  Non0_acc_2: 0.6157  Non0_F1_score: 0.6155  Mult_acc_5: 0.3319  Mult_acc_7: 0.2664  MAE: 1.3790  Corr: 0.3164 
2024-06-13 20:31:29:INFO:TRAIN-(cmcm) (2/18/5)>> loss: 0.8116
2024-06-13 20:31:32:INFO:VAL-(cmcm) >>
2024-06-13 20:31:32:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.6063  Non0_acc_2: 0.6389  Non0_F1_score: 0.6329  Mult_acc_5: 0.2969  Mult_acc_7: 0.2183  MAE: 1.4586  Corr: 0.3787 
2024-06-13 20:31:46:INFO:TRAIN-(cmcm) (3/19/5)>> loss: 0.8011
2024-06-13 20:31:49:INFO:VAL-(cmcm) >>
2024-06-13 20:31:49:INFO:M: >>  Has0_acc_2: 0.6638  Has0_F1_score: 0.6653  Non0_acc_2: 0.6898  Non0_F1_score: 0.6904  Mult_acc_5: 0.3886  Mult_acc_7: 0.3188  MAE: 1.1800  Corr: 0.4694 
2024-06-13 20:31:49:INFO:Saving checkpoint at epoch 19 to results/models/cmcm-mosi-regression.pth.
2024-06-13 20:32:04:INFO:TRAIN-(cmcm) (1/20/5)>> loss: 0.7849
2024-06-13 20:32:07:INFO:VAL-(cmcm) >>
2024-06-13 20:32:07:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.5388  Non0_acc_2: 0.5833  Non0_F1_score: 0.5522  Mult_acc_5: 0.2926  Mult_acc_7: 0.2358  MAE: 1.4515  Corr: 0.3505 
2024-06-13 20:32:22:INFO:TRAIN-(cmcm) (2/21/5)>> loss: 0.7863
2024-06-13 20:32:24:INFO:VAL-(cmcm) >>
2024-06-13 20:32:24:INFO:M: >>  Has0_acc_2: 0.6201  Has0_F1_score: 0.6187  Non0_acc_2: 0.6435  Non0_F1_score: 0.6407  Mult_acc_5: 0.2969  Mult_acc_7: 0.2314  MAE: 1.3809  Corr: 0.4434 
2024-06-13 20:32:39:INFO:TRAIN-(cmcm) (3/22/5)>> loss: 0.7635
2024-06-13 20:32:42:INFO:VAL-(cmcm) >>
2024-06-13 20:32:42:INFO:M: >>  Has0_acc_2: 0.6856  Has0_F1_score: 0.6837  Non0_acc_2: 0.6667  Non0_F1_score: 0.6656  Mult_acc_5: 0.3493  Mult_acc_7: 0.2707  MAE: 1.1787  Corr: 0.4746 
2024-06-13 20:32:42:INFO:Saving checkpoint at epoch 22 to results/models/cmcm-mosi-regression.pth.
2024-06-13 20:32:57:INFO:TRAIN-(cmcm) (1/23/5)>> loss: 0.7619
2024-06-13 20:32:59:INFO:VAL-(cmcm) >>
2024-06-13 20:32:59:INFO:M: >>  Has0_acc_2: 0.6638  Has0_F1_score: 0.6638  Non0_acc_2: 0.6898  Non0_F1_score: 0.6891  Mult_acc_5: 0.3624  Mult_acc_7: 0.2707  MAE: 1.3359  Corr: 0.4789 
2024-06-13 20:33:14:INFO:TRAIN-(cmcm) (2/24/5)>> loss: 0.7518
2024-06-13 20:33:17:INFO:VAL-(cmcm) >>
2024-06-13 20:33:17:INFO:M: >>  Has0_acc_2: 0.6681  Has0_F1_score: 0.6702  Non0_acc_2: 0.6852  Non0_F1_score: 0.6859  Mult_acc_5: 0.3843  Mult_acc_7: 0.3013  MAE: 1.2315  Corr: 0.4734 
2024-06-13 20:33:32:INFO:TRAIN-(cmcm) (3/25/5)>> loss: 0.7395
2024-06-13 20:33:34:INFO:VAL-(cmcm) >>
2024-06-13 20:33:34:INFO:M: >>  Has0_acc_2: 0.6725  Has0_F1_score: 0.6109  Non0_acc_2: 0.6944  Non0_F1_score: 0.6850  Mult_acc_5: 0.3755  Mult_acc_7: 0.2838  MAE: 1.2625  Corr: 0.4590 
2024-06-13 20:33:49:INFO:TRAIN-(cmcm) (4/26/5)>> loss: 0.7444
2024-06-13 20:33:51:INFO:VAL-(cmcm) >>
2024-06-13 20:33:51:INFO:M: >>  Has0_acc_2: 0.6987  Has0_F1_score: 0.6820  Non0_acc_2: 0.7130  Non0_F1_score: 0.7018  Mult_acc_5: 0.3450  Mult_acc_7: 0.2664  MAE: 1.1944  Corr: 0.4809 
2024-06-13 20:34:06:INFO:TRAIN-(cmcm) (5/27/5)>> loss: 0.7281
2024-06-13 20:34:09:INFO:VAL-(cmcm) >>
2024-06-13 20:34:09:INFO:M: >>  Has0_acc_2: 0.7249  Has0_F1_score: 0.7271  Non0_acc_2: 0.7454  Non0_F1_score: 0.7465  Mult_acc_5: 0.3319  Mult_acc_7: 0.2576  MAE: 1.1800  Corr: 0.5174 
2024-06-13 20:34:23:INFO:TRAIN-(cmcm) (6/28/5)>> loss: 0.7164
2024-06-13 20:34:26:INFO:VAL-(cmcm) >>
2024-06-13 20:34:26:INFO:M: >>  Has0_acc_2: 0.7031  Has0_F1_score: 0.6858  Non0_acc_2: 0.7222  Non0_F1_score: 0.7189  Mult_acc_5: 0.3886  Mult_acc_7: 0.3144  MAE: 1.1573  Corr: 0.5097 
2024-06-13 20:34:26:INFO:Saving checkpoint at epoch 28 to results/models/cmcm-mosi-regression.pth.
2024-06-13 20:34:41:INFO:TRAIN-(cmcm) (1/29/5)>> loss: 0.7079
2024-06-13 20:34:44:INFO:VAL-(cmcm) >>
2024-06-13 20:34:44:INFO:M: >>  Has0_acc_2: 0.7380  Has0_F1_score: 0.7375  Non0_acc_2: 0.6806  Non0_F1_score: 0.6820  Mult_acc_5: 0.3319  Mult_acc_7: 0.2707  MAE: 1.1868  Corr: 0.4622 
2024-06-13 20:34:59:INFO:TRAIN-(cmcm) (2/30/5)>> loss: 0.7008
2024-06-13 20:35:01:INFO:VAL-(cmcm) >>
2024-06-13 20:35:01:INFO:M: >>  Has0_acc_2: 0.6987  Has0_F1_score: 0.7009  Non0_acc_2: 0.6991  Non0_F1_score: 0.7004  Mult_acc_5: 0.3057  Mult_acc_7: 0.2358  MAE: 1.2481  Corr: 0.4615 
2024-06-13 20:35:16:INFO:TRAIN-(cmcm) (3/31/5)>> loss: 0.6926
2024-06-13 20:35:19:INFO:VAL-(cmcm) >>
2024-06-13 20:35:19:INFO:M: >>  Has0_acc_2: 0.7074  Has0_F1_score: 0.6979  Non0_acc_2: 0.7269  Non0_F1_score: 0.7257  Mult_acc_5: 0.3450  Mult_acc_7: 0.2838  MAE: 1.1285  Corr: 0.5181 
2024-06-13 20:35:19:INFO:Saving checkpoint at epoch 31 to results/models/cmcm-mosi-regression.pth.
2024-06-13 20:35:34:INFO:TRAIN-(cmcm) (1/32/5)>> loss: 0.6883
2024-06-13 20:35:37:INFO:VAL-(cmcm) >>
2024-06-13 20:35:37:INFO:M: >>  Has0_acc_2: 0.7205  Has0_F1_score: 0.7028  Non0_acc_2: 0.7454  Non0_F1_score: 0.7413  Mult_acc_5: 0.3712  Mult_acc_7: 0.2926  MAE: 1.1381  Corr: 0.5237 
2024-06-13 20:35:52:INFO:TRAIN-(cmcm) (2/33/5)>> loss: 0.6800
2024-06-13 20:35:54:INFO:VAL-(cmcm) >>
2024-06-13 20:35:54:INFO:M: >>  Has0_acc_2: 0.7336  Has0_F1_score: 0.7356  Non0_acc_2: 0.7593  Non0_F1_score: 0.7596  Mult_acc_5: 0.3712  Mult_acc_7: 0.3144  MAE: 1.1127  Corr: 0.5299 
2024-06-13 20:35:54:INFO:Saving checkpoint at epoch 33 to results/models/cmcm-mosi-regression.pth.
2024-06-13 20:36:09:INFO:TRAIN-(cmcm) (1/34/5)>> loss: 0.6628
2024-06-13 20:36:12:INFO:VAL-(cmcm) >>
2024-06-13 20:36:12:INFO:M: >>  Has0_acc_2: 0.6812  Has0_F1_score: 0.6838  Non0_acc_2: 0.6898  Non0_F1_score: 0.6912  Mult_acc_5: 0.3450  Mult_acc_7: 0.2795  MAE: 1.1844  Corr: 0.4604 
2024-06-13 20:36:27:INFO:TRAIN-(cmcm) (2/35/5)>> loss: 0.6711
2024-06-13 20:36:29:INFO:VAL-(cmcm) >>
2024-06-13 20:36:29:INFO:M: >>  Has0_acc_2: 0.6638  Has0_F1_score: 0.6662  Non0_acc_2: 0.6713  Non0_F1_score: 0.6731  Mult_acc_5: 0.3100  Mult_acc_7: 0.2576  MAE: 1.3001  Corr: 0.3776 
2024-06-13 20:36:44:INFO:TRAIN-(cmcm) (3/36/5)>> loss: 0.6656
2024-06-13 20:36:47:INFO:VAL-(cmcm) >>
2024-06-13 20:36:47:INFO:M: >>  Has0_acc_2: 0.6638  Has0_F1_score: 0.6596  Non0_acc_2: 0.6852  Non0_F1_score: 0.6842  Mult_acc_5: 0.3493  Mult_acc_7: 0.2795  MAE: 1.2258  Corr: 0.4718 
2024-06-13 20:37:01:INFO:TRAIN-(cmcm) (4/37/5)>> loss: 0.6458
2024-06-13 20:37:04:INFO:VAL-(cmcm) >>
2024-06-13 20:37:04:INFO:M: >>  Has0_acc_2: 0.6812  Has0_F1_score: 0.6842  Non0_acc_2: 0.7083  Non0_F1_score: 0.7099  Mult_acc_5: 0.3493  Mult_acc_7: 0.2969  MAE: 1.2813  Corr: 0.4210 
2024-06-13 20:37:19:INFO:TRAIN-(cmcm) (5/38/5)>> loss: 0.6579
2024-06-13 20:37:21:INFO:VAL-(cmcm) >>
2024-06-13 20:37:21:INFO:M: >>  Has0_acc_2: 0.6856  Has0_F1_score: 0.6812  Non0_acc_2: 0.7037  Non0_F1_score: 0.7022  Mult_acc_5: 0.3624  Mult_acc_7: 0.3013  MAE: 1.1726  Corr: 0.4849 
2024-06-13 20:37:36:INFO:TRAIN-(cmcm) (6/39/5)>> loss: 0.6429
2024-06-13 20:37:39:INFO:VAL-(cmcm) >>
2024-06-13 20:37:39:INFO:M: >>  Has0_acc_2: 0.6987  Has0_F1_score: 0.6876  Non0_acc_2: 0.7269  Non0_F1_score: 0.7217  Mult_acc_5: 0.3493  Mult_acc_7: 0.2926  MAE: 1.2411  Corr: 0.4522 
2024-06-13 20:37:53:INFO:TRAIN-(cmcm) (7/40/5)>> loss: 0.6254
2024-06-13 20:37:56:INFO:VAL-(cmcm) >>
2024-06-13 20:37:56:INFO:M: >>  Has0_acc_2: 0.6900  Has0_F1_score: 0.6928  Non0_acc_2: 0.7130  Non0_F1_score: 0.7145  Mult_acc_5: 0.2969  Mult_acc_7: 0.2664  MAE: 1.2472  Corr: 0.4206 
2024-06-13 20:38:11:INFO:TRAIN-(cmcm) (8/41/5)>> loss: 0.6253
2024-06-13 20:38:13:INFO:VAL-(cmcm) >>
2024-06-13 20:38:13:INFO:M: >>  Has0_acc_2: 0.6507  Has0_F1_score: 0.6512  Non0_acc_2: 0.6713  Non0_F1_score: 0.6705  Mult_acc_5: 0.3231  Mult_acc_7: 0.2664  MAE: 1.3446  Corr: 0.3827 
2024-06-13 20:38:28:INFO:TRAIN-(cmcm) (9/42/5)>> loss: 0.6007
2024-06-13 20:38:31:INFO:VAL-(cmcm) >>
2024-06-13 20:38:31:INFO:M: >>  Has0_acc_2: 0.6638  Has0_F1_score: 0.6576  Non0_acc_2: 0.6713  Non0_F1_score: 0.6693  Mult_acc_5: 0.3581  Mult_acc_7: 0.3100  MAE: 1.2516  Corr: 0.4108 
2024-06-13 20:38:45:INFO:TRAIN-(cmcm) (10/43/5)>> loss: 0.6071
2024-06-13 20:38:48:INFO:VAL-(cmcm) >>
2024-06-13 20:38:48:INFO:M: >>  Has0_acc_2: 0.6245  Has0_F1_score: 0.6274  Non0_acc_2: 0.6389  Non0_F1_score: 0.6394  Mult_acc_5: 0.3319  Mult_acc_7: 0.2751  MAE: 1.3280  Corr: 0.3717 
2024-06-13 20:38:55:INFO:TEST-(cmcm) >>
2024-06-13 20:38:55:INFO:M: >>  Has0_acc_2: 0.7259  Has0_F1_score: 0.7251  Non0_acc_2: 0.7424  Non0_F1_score: 0.7424  Mult_acc_5: 0.3688  Mult_acc_7: 0.3280  MAE: 1.1567  Corr: 0.4753 
2024-06-13 20:38:56:INFO:Results are added to results/results/mosi-regression-80.csv...
2024-06-13 20:38:56:INFO:Start running cmcm...
2024-06-13 20:38:56:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 6, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 90, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-06-13 20:38:56:INFO:Let's use the GPU 1 !
2024-06-13 20:38:56:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 20:38:56:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718282336 HTTP/1.1" 200 235
2024-06-13 20:38:56:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 20:38:57:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 20:38:57:INFO:train samples: (1284,)
2024-06-13 20:38:58:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 20:38:58:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718282338 HTTP/1.1" 200 235
2024-06-13 20:38:58:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 20:38:58:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 20:38:59:INFO:valid samples: (229,)
2024-06-13 20:38:59:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 20:38:59:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718282340 HTTP/1.1" 200 235
2024-06-13 20:39:00:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 20:39:00:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 20:39:01:INFO:test samples: (686,)
2024-06-13 20:39:01:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 20:39:01:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718282341 HTTP/1.1" 200 235
2024-06-13 20:39:01:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 20:39:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 20:39:02:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 20:39:03:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718282343 HTTP/1.1" 200 235
2024-06-13 20:39:03:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 20:39:03:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 20:39:03:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-13 20:39:03:WARNING:Try importing flash-attention for faster inference...
2024-06-13 20:39:03:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-13 20:39:03:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-13 20:39:03:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-13 20:39:04:INFO:trainable params: 1310288 || all params: 1838138960 || trainable%: 0.07128340286090232
2024-06-13 20:39:04:INFO:Init labels...
2024-06-13 20:39:04:INFO:Start training...
2024-06-13 20:39:19:INFO:TRAIN-(cmcm) (1/1/1)>> loss: 2.3096
2024-06-13 20:39:22:INFO:VAL-(cmcm) >>
2024-06-13 20:39:22:INFO:M: >>  Has0_acc_2: 0.4148  Has0_F1_score: 0.3132  Non0_acc_2: 0.4352  Non0_F1_score: 0.3332  Mult_acc_5: 0.1921  Mult_acc_7: 0.1485  MAE: 2.1641  Corr: 0.0222 
2024-06-13 20:39:22:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-13 20:39:37:INFO:TRAIN-(cmcm) (1/2/1)>> loss: 0.9101
2024-06-13 20:39:40:INFO:VAL-(cmcm) >>
2024-06-13 20:39:40:INFO:M: >>  Has0_acc_2: 0.4017  Has0_F1_score: 0.2303  Non0_acc_2: 0.4259  Non0_F1_score: 0.2544  Mult_acc_5: 0.1310  Mult_acc_7: 0.1310  MAE: 1.8702  Corr: 0.0342 
2024-06-13 20:39:40:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-13 20:39:55:INFO:TRAIN-(cmcm) (1/3/1)>> loss: 0.8891
2024-06-13 20:39:58:INFO:VAL-(cmcm) >>
2024-06-13 20:39:58:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4830  Non0_acc_2: 0.5741  Non0_F1_score: 0.4558  Mult_acc_5: 0.1659  Mult_acc_7: 0.1659  MAE: 1.4663  Corr: -0.0500 
2024-06-13 20:39:58:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-mosi-regression.pth.
2024-06-13 20:40:13:INFO:TRAIN-(cmcm) (1/4/1)>> loss: 0.8838
2024-06-13 20:40:16:INFO:VAL-(cmcm) >>
2024-06-13 20:40:16:INFO:M: >>  Has0_acc_2: 0.4061  Has0_F1_score: 0.2470  Non0_acc_2: 0.4306  Non0_F1_score: 0.2722  Mult_acc_5: 0.1441  Mult_acc_7: 0.1310  MAE: 1.8519  Corr: -0.0731 
2024-06-13 20:40:30:INFO:TRAIN-(cmcm) (2/5/1)>> loss: 0.8881
2024-06-13 20:40:33:INFO:VAL-(cmcm) >>
2024-06-13 20:40:33:INFO:M: >>  Has0_acc_2: 0.4541  Has0_F1_score: 0.4087  Non0_acc_2: 0.4722  Non0_F1_score: 0.4265  Mult_acc_5: 0.1572  Mult_acc_7: 0.1572  MAE: 1.7615  Corr: 0.0517 
2024-06-13 20:40:48:INFO:TRAIN-(cmcm) (3/6/1)>> loss: 0.8780
2024-06-13 20:40:50:INFO:VAL-(cmcm) >>
2024-06-13 20:40:50:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5219  Non0_acc_2: 0.5602  Non0_F1_score: 0.5063  Mult_acc_5: 0.2751  Mult_acc_7: 0.1921  MAE: 1.8162  Corr: 0.0048 
2024-06-13 20:41:05:INFO:TRAIN-(cmcm) (4/7/1)>> loss: 0.8664
2024-06-13 20:41:08:INFO:VAL-(cmcm) >>
2024-06-13 20:41:08:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4923  Non0_acc_2: 0.5694  Non0_F1_score: 0.4655  Mult_acc_5: 0.2183  Mult_acc_7: 0.2052  MAE: 1.6091  Corr: -0.0050 
2024-06-13 20:41:23:INFO:TRAIN-(cmcm) (5/8/1)>> loss: 0.8675
2024-06-13 20:41:25:INFO:VAL-(cmcm) >>
2024-06-13 20:41:25:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5284  Non0_acc_2: 0.5556  Non0_F1_score: 0.5099  Mult_acc_5: 0.1659  Mult_acc_7: 0.1659  MAE: 1.5440  Corr: 0.0168 
2024-06-13 20:41:40:INFO:TRAIN-(cmcm) (6/9/1)>> loss: 0.8666
2024-06-13 20:41:43:INFO:VAL-(cmcm) >>
2024-06-13 20:41:43:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4556  Non0_acc_2: 0.5000  Non0_F1_score: 0.4783  Mult_acc_5: 0.1878  Mult_acc_7: 0.1878  MAE: 1.5235  Corr: -0.0693 
2024-06-13 20:41:57:INFO:TRAIN-(cmcm) (7/10/1)>> loss: 0.8646
2024-06-13 20:42:00:INFO:VAL-(cmcm) >>
2024-06-13 20:42:00:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.4984  Non0_acc_2: 0.5509  Non0_F1_score: 0.4749  Mult_acc_5: 0.2926  Mult_acc_7: 0.2140  MAE: 1.8018  Corr: -0.0213 
2024-06-13 20:42:15:INFO:TRAIN-(cmcm) (8/11/1)>> loss: 0.8638
2024-06-13 20:42:17:INFO:VAL-(cmcm) >>
2024-06-13 20:42:17:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5170  Non0_acc_2: 0.5648  Non0_F1_score: 0.4978  Mult_acc_5: 0.2533  Mult_acc_7: 0.1834  MAE: 1.7940  Corr: 0.0151 
2024-06-13 20:42:32:INFO:TRAIN-(cmcm) (9/12/1)>> loss: 0.8530
2024-06-13 20:42:35:INFO:VAL-(cmcm) >>
2024-06-13 20:42:35:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.4897  Non0_acc_2: 0.5278  Non0_F1_score: 0.4595  Mult_acc_5: 0.1834  Mult_acc_7: 0.1834  MAE: 1.4685  Corr: -0.0304 
2024-06-13 20:42:50:INFO:TRAIN-(cmcm) (10/13/1)>> loss: 0.8489
2024-06-13 20:42:52:INFO:VAL-(cmcm) >>
2024-06-13 20:42:52:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.5479  Non0_acc_2: 0.5880  Non0_F1_score: 0.5340  Mult_acc_5: 0.2926  Mult_acc_7: 0.2096  MAE: 1.7223  Corr: 0.0769 
2024-06-13 20:43:00:INFO:TEST-(cmcm) >>
2024-06-13 20:43:00:INFO:M: >>  Has0_acc_2: 0.4883  Has0_F1_score: 0.3916  Non0_acc_2: 0.4649  Non0_F1_score: 0.3700  Mult_acc_5: 0.1866  Mult_acc_7: 0.1851  MAE: 1.5137  Corr: 0.1018 
2024-06-13 20:43:00:INFO:Results are added to results/results/mosi-regression-90.csv...
2024-06-13 20:43:00:INFO:Start running cmcm...
2024-06-13 20:43:00:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 6, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 90, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 2222}>
2024-06-13 20:43:00:INFO:Let's use the GPU 1 !
2024-06-13 20:43:00:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 20:43:00:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718282581 HTTP/1.1" 200 235
2024-06-13 20:43:01:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 20:43:01:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 20:43:02:INFO:train samples: (1284,)
2024-06-13 20:43:02:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 20:43:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718282582 HTTP/1.1" 200 235
2024-06-13 20:43:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 20:43:03:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 20:43:03:INFO:valid samples: (229,)
2024-06-13 20:43:03:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 20:43:04:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718282584 HTTP/1.1" 200 235
2024-06-13 20:43:04:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 20:43:04:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 20:43:05:INFO:test samples: (686,)
2024-06-13 20:43:05:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 20:43:05:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718282585 HTTP/1.1" 200 235
2024-06-13 20:43:05:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 20:43:06:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 20:43:06:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 20:43:07:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718282587 HTTP/1.1" 200 235
2024-06-13 20:43:07:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 20:43:07:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 20:43:08:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-13 20:43:08:WARNING:Try importing flash-attention for faster inference...
2024-06-13 20:43:08:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-13 20:43:08:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-13 20:43:08:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-13 20:43:09:INFO:trainable params: 1310288 || all params: 1838138960 || trainable%: 0.07128340286090232
2024-06-13 20:43:09:INFO:Init labels...
2024-06-13 20:43:09:INFO:Start training...
2024-06-13 20:43:24:INFO:TRAIN-(cmcm) (1/1/2)>> loss: 2.3063
2024-06-13 20:43:26:INFO:VAL-(cmcm) >>
2024-06-13 20:43:26:INFO:M: >>  Has0_acc_2: 0.5197  Has0_F1_score: 0.5243  Non0_acc_2: 0.5278  Non0_F1_score: 0.5304  Mult_acc_5: 0.1965  Mult_acc_7: 0.1878  MAE: 1.6366  Corr: 0.0579 
2024-06-13 20:43:27:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-13 20:43:42:INFO:TRAIN-(cmcm) (1/2/2)>> loss: 0.9628
2024-06-13 20:43:44:INFO:VAL-(cmcm) >>
2024-06-13 20:43:44:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5741  Non0_F1_score: 0.4187  Mult_acc_5: 0.2969  Mult_acc_7: 0.2140  MAE: 1.6167  Corr: 0.0169 
2024-06-13 20:43:45:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-13 20:44:00:INFO:TRAIN-(cmcm) (1/3/2)>> loss: 0.9553
2024-06-13 20:44:02:INFO:VAL-(cmcm) >>
2024-06-13 20:44:02:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5070  Non0_acc_2: 0.5556  Non0_F1_score: 0.4871  Mult_acc_5: 0.1747  Mult_acc_7: 0.1747  MAE: 1.5991  Corr: -0.0246 
2024-06-13 20:44:02:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-mosi-regression.pth.
2024-06-13 20:44:18:INFO:TRAIN-(cmcm) (1/4/2)>> loss: 0.8812
2024-06-13 20:44:20:INFO:VAL-(cmcm) >>
2024-06-13 20:44:20:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.4736  Non0_acc_2: 0.5463  Non0_F1_score: 0.4458  Mult_acc_5: 0.2489  Mult_acc_7: 0.2052  MAE: 1.6934  Corr: -0.0546 
2024-06-13 20:44:35:INFO:TRAIN-(cmcm) (2/5/2)>> loss: 0.8769
2024-06-13 20:44:37:INFO:VAL-(cmcm) >>
2024-06-13 20:44:37:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.4947  Non0_acc_2: 0.5556  Non0_F1_score: 0.4680  Mult_acc_5: 0.2751  Mult_acc_7: 0.1965  MAE: 1.7494  Corr: -0.0297 
2024-06-13 20:44:52:INFO:TRAIN-(cmcm) (3/6/2)>> loss: 0.8712
2024-06-13 20:44:55:INFO:VAL-(cmcm) >>
2024-06-13 20:44:55:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.5529  Non0_acc_2: 0.5648  Non0_F1_score: 0.5395  Mult_acc_5: 0.2838  Mult_acc_7: 0.2009  MAE: 1.7306  Corr: 0.0378 
2024-06-13 20:45:10:INFO:TRAIN-(cmcm) (4/7/2)>> loss: 0.9166
2024-06-13 20:45:12:INFO:VAL-(cmcm) >>
2024-06-13 20:45:12:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.4769  Non0_acc_2: 0.5880  Non0_F1_score: 0.4494  Mult_acc_5: 0.1659  Mult_acc_7: 0.1659  MAE: 1.4615  Corr: 0.0634 
2024-06-13 20:45:12:INFO:Saving checkpoint at epoch 7 to results/models/cmcm-mosi-regression.pth.
2024-06-13 20:45:27:INFO:TRAIN-(cmcm) (1/8/2)>> loss: 0.8776
2024-06-13 20:45:30:INFO:VAL-(cmcm) >>
2024-06-13 20:45:30:INFO:M: >>  Has0_acc_2: 0.5371  Has0_F1_score: 0.5263  Non0_acc_2: 0.5602  Non0_F1_score: 0.5496  Mult_acc_5: 0.1965  Mult_acc_7: 0.1703  MAE: 1.7158  Corr: 0.1798 
2024-06-13 20:45:45:INFO:TRAIN-(cmcm) (2/9/2)>> loss: 0.8755
2024-06-13 20:45:47:INFO:VAL-(cmcm) >>
2024-06-13 20:45:47:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.5201  Non0_acc_2: 0.5694  Non0_F1_score: 0.5010  Mult_acc_5: 0.2707  Mult_acc_7: 0.1921  MAE: 1.7302  Corr: 0.0155 
2024-06-13 20:46:02:INFO:TRAIN-(cmcm) (3/10/2)>> loss: 0.8679
2024-06-13 20:46:05:INFO:VAL-(cmcm) >>
2024-06-13 20:46:05:INFO:M: >>  Has0_acc_2: 0.6419  Has0_F1_score: 0.6448  Non0_acc_2: 0.6574  Non0_F1_score: 0.6586  Mult_acc_5: 0.2664  Mult_acc_7: 0.2183  MAE: 1.4589  Corr: 0.3300 
2024-06-13 20:46:05:INFO:Saving checkpoint at epoch 10 to results/models/cmcm-mosi-regression.pth.
2024-06-13 20:46:20:INFO:TRAIN-(cmcm) (1/11/2)>> loss: 0.8562
2024-06-13 20:46:23:INFO:VAL-(cmcm) >>
2024-06-13 20:46:23:INFO:M: >>  Has0_acc_2: 0.6288  Has0_F1_score: 0.5998  Non0_acc_2: 0.6296  Non0_F1_score: 0.5993  Mult_acc_5: 0.2183  Mult_acc_7: 0.2009  MAE: 1.3934  Corr: 0.2613 
2024-06-13 20:46:23:INFO:Saving checkpoint at epoch 11 to results/models/cmcm-mosi-regression.pth.
2024-06-13 20:46:38:INFO:TRAIN-(cmcm) (1/12/2)>> loss: 0.8325
2024-06-13 20:46:40:INFO:VAL-(cmcm) >>
2024-06-13 20:46:40:INFO:M: >>  Has0_acc_2: 0.6550  Has0_F1_score: 0.6009  Non0_acc_2: 0.6481  Non0_F1_score: 0.5904  Mult_acc_5: 0.2052  Mult_acc_7: 0.1921  MAE: 1.3926  Corr: 0.2853 
2024-06-13 20:46:41:INFO:Saving checkpoint at epoch 12 to results/models/cmcm-mosi-regression.pth.
2024-06-13 20:46:56:INFO:TRAIN-(cmcm) (1/13/2)>> loss: 0.8161
2024-06-13 20:46:58:INFO:VAL-(cmcm) >>
2024-06-13 20:46:58:INFO:M: >>  Has0_acc_2: 0.6288  Has0_F1_score: 0.6195  Non0_acc_2: 0.6574  Non0_F1_score: 0.6486  Mult_acc_5: 0.2707  Mult_acc_7: 0.1965  MAE: 1.3327  Corr: 0.4542 
2024-06-13 20:46:59:INFO:Saving checkpoint at epoch 13 to results/models/cmcm-mosi-regression.pth.
2024-06-13 20:47:14:INFO:TRAIN-(cmcm) (1/14/2)>> loss: 0.8104
2024-06-13 20:47:16:INFO:VAL-(cmcm) >>
2024-06-13 20:47:16:INFO:M: >>  Has0_acc_2: 0.6856  Has0_F1_score: 0.6705  Non0_acc_2: 0.6944  Non0_F1_score: 0.6766  Mult_acc_5: 0.3100  Mult_acc_7: 0.2576  MAE: 1.2407  Corr: 0.4450 
2024-06-13 20:47:17:INFO:Saving checkpoint at epoch 14 to results/models/cmcm-mosi-regression.pth.
2024-06-13 20:47:32:INFO:TRAIN-(cmcm) (1/15/2)>> loss: 0.7930
2024-06-13 20:47:34:INFO:VAL-(cmcm) >>
2024-06-13 20:47:34:INFO:M: >>  Has0_acc_2: 0.6812  Has0_F1_score: 0.6840  Non0_acc_2: 0.7037  Non0_F1_score: 0.7047  Mult_acc_5: 0.3624  Mult_acc_7: 0.2445  MAE: 1.2761  Corr: 0.4789 
2024-06-13 20:47:49:INFO:TRAIN-(cmcm) (2/16/2)>> loss: 0.7929
2024-06-13 20:47:52:INFO:VAL-(cmcm) >>
2024-06-13 20:47:52:INFO:M: >>  Has0_acc_2: 0.6943  Has0_F1_score: 0.6968  Non0_acc_2: 0.7130  Non0_F1_score: 0.7141  Mult_acc_5: 0.3013  Mult_acc_7: 0.2489  MAE: 1.2353  Corr: 0.4868 
2024-06-13 20:47:52:INFO:Saving checkpoint at epoch 16 to results/models/cmcm-mosi-regression.pth.
2024-06-13 20:48:07:INFO:TRAIN-(cmcm) (1/17/2)>> loss: 0.7817
2024-06-13 20:48:09:INFO:VAL-(cmcm) >>
2024-06-13 20:48:09:INFO:M: >>  Has0_acc_2: 0.6507  Has0_F1_score: 0.6503  Non0_acc_2: 0.6713  Non0_F1_score: 0.6694  Mult_acc_5: 0.2838  Mult_acc_7: 0.2227  MAE: 1.3905  Corr: 0.4072 
2024-06-13 20:48:24:INFO:TRAIN-(cmcm) (2/18/2)>> loss: 0.7669
2024-06-13 20:48:27:INFO:VAL-(cmcm) >>
2024-06-13 20:48:27:INFO:M: >>  Has0_acc_2: 0.6856  Has0_F1_score: 0.6872  Non0_acc_2: 0.7083  Non0_F1_score: 0.7089  Mult_acc_5: 0.3624  Mult_acc_7: 0.2576  MAE: 1.3053  Corr: 0.5069 
2024-06-13 20:48:42:INFO:TRAIN-(cmcm) (3/19/2)>> loss: 0.7573
2024-06-13 20:48:44:INFO:VAL-(cmcm) >>
2024-06-13 20:48:44:INFO:M: >>  Has0_acc_2: 0.6943  Has0_F1_score: 0.6948  Non0_acc_2: 0.7176  Non0_F1_score: 0.7159  Mult_acc_5: 0.3799  Mult_acc_7: 0.2838  MAE: 1.2114  Corr: 0.5137 
2024-06-13 20:48:44:INFO:Saving checkpoint at epoch 19 to results/models/cmcm-mosi-regression.pth.
2024-06-13 20:48:59:INFO:TRAIN-(cmcm) (1/20/2)>> loss: 0.7480
2024-06-13 20:49:02:INFO:VAL-(cmcm) >>
2024-06-13 20:49:02:INFO:M: >>  Has0_acc_2: 0.6725  Has0_F1_score: 0.6753  Non0_acc_2: 0.6991  Non0_F1_score: 0.7000  Mult_acc_5: 0.3755  Mult_acc_7: 0.2576  MAE: 1.3381  Corr: 0.4851 
2024-06-13 20:49:17:INFO:TRAIN-(cmcm) (2/21/2)>> loss: 0.7443
2024-06-13 20:49:19:INFO:VAL-(cmcm) >>
2024-06-13 20:49:19:INFO:M: >>  Has0_acc_2: 0.6681  Has0_F1_score: 0.6708  Non0_acc_2: 0.7083  Non0_F1_score: 0.7094  Mult_acc_5: 0.3799  Mult_acc_7: 0.2707  MAE: 1.2992  Corr: 0.5043 
2024-06-13 20:49:34:INFO:TRAIN-(cmcm) (3/22/2)>> loss: 0.7300
2024-06-13 20:49:37:INFO:VAL-(cmcm) >>
2024-06-13 20:49:37:INFO:M: >>  Has0_acc_2: 0.6725  Has0_F1_score: 0.6746  Non0_acc_2: 0.6759  Non0_F1_score: 0.6777  Mult_acc_5: 0.3755  Mult_acc_7: 0.2795  MAE: 1.2468  Corr: 0.4753 
2024-06-13 20:49:51:INFO:TRAIN-(cmcm) (4/23/2)>> loss: 0.7382
2024-06-13 20:49:54:INFO:VAL-(cmcm) >>
2024-06-13 20:49:54:INFO:M: >>  Has0_acc_2: 0.6812  Has0_F1_score: 0.6809  Non0_acc_2: 0.7083  Non0_F1_score: 0.7066  Mult_acc_5: 0.3712  Mult_acc_7: 0.2795  MAE: 1.1586  Corr: 0.5253 
2024-06-13 20:49:54:INFO:Saving checkpoint at epoch 23 to results/models/cmcm-mosi-regression.pth.
2024-06-13 20:50:09:INFO:TRAIN-(cmcm) (1/24/2)>> loss: 0.7261
2024-06-13 20:50:12:INFO:VAL-(cmcm) >>
2024-06-13 20:50:12:INFO:M: >>  Has0_acc_2: 0.6900  Has0_F1_score: 0.6925  Non0_acc_2: 0.6481  Non0_F1_score: 0.6464  Mult_acc_5: 0.3362  Mult_acc_7: 0.2620  MAE: 1.2752  Corr: 0.4866 
2024-06-13 20:50:26:INFO:TRAIN-(cmcm) (2/25/2)>> loss: 0.7185
2024-06-13 20:50:29:INFO:VAL-(cmcm) >>
2024-06-13 20:50:29:INFO:M: >>  Has0_acc_2: 0.6856  Has0_F1_score: 0.6882  Non0_acc_2: 0.7130  Non0_F1_score: 0.7137  Mult_acc_5: 0.3755  Mult_acc_7: 0.2576  MAE: 1.2835  Corr: 0.4998 
2024-06-13 20:50:44:INFO:TRAIN-(cmcm) (3/26/2)>> loss: 0.7092
2024-06-13 20:50:46:INFO:VAL-(cmcm) >>
2024-06-13 20:50:46:INFO:M: >>  Has0_acc_2: 0.7293  Has0_F1_score: 0.7269  Non0_acc_2: 0.6898  Non0_F1_score: 0.6914  Mult_acc_5: 0.3581  Mult_acc_7: 0.2707  MAE: 1.1311  Corr: 0.5640 
2024-06-13 20:50:47:INFO:Saving checkpoint at epoch 26 to results/models/cmcm-mosi-regression.pth.
2024-06-13 20:51:02:INFO:TRAIN-(cmcm) (1/27/2)>> loss: 0.7054
2024-06-13 20:51:04:INFO:VAL-(cmcm) >>
2024-06-13 20:51:04:INFO:M: >>  Has0_acc_2: 0.6943  Has0_F1_score: 0.6948  Non0_acc_2: 0.7130  Non0_F1_score: 0.7115  Mult_acc_5: 0.3799  Mult_acc_7: 0.2795  MAE: 1.1861  Corr: 0.5309 
2024-06-13 20:51:19:INFO:TRAIN-(cmcm) (2/28/2)>> loss: 0.6969
2024-06-13 20:51:22:INFO:VAL-(cmcm) >>
2024-06-13 20:51:22:INFO:M: >>  Has0_acc_2: 0.7031  Has0_F1_score: 0.6971  Non0_acc_2: 0.7269  Non0_F1_score: 0.7189  Mult_acc_5: 0.3406  Mult_acc_7: 0.2533  MAE: 1.1870  Corr: 0.5251 
2024-06-13 20:51:36:INFO:TRAIN-(cmcm) (3/29/2)>> loss: 0.6892
2024-06-13 20:51:39:INFO:VAL-(cmcm) >>
2024-06-13 20:51:39:INFO:M: >>  Has0_acc_2: 0.6943  Has0_F1_score: 0.6969  Non0_acc_2: 0.6898  Non0_F1_score: 0.6915  Mult_acc_5: 0.3624  Mult_acc_7: 0.2707  MAE: 1.2049  Corr: 0.5331 
2024-06-13 20:51:54:INFO:TRAIN-(cmcm) (4/30/2)>> loss: 0.6925
2024-06-13 20:51:56:INFO:VAL-(cmcm) >>
2024-06-13 20:51:56:INFO:M: >>  Has0_acc_2: 0.7074  Has0_F1_score: 0.6954  Non0_acc_2: 0.7361  Non0_F1_score: 0.7327  Mult_acc_5: 0.3974  Mult_acc_7: 0.2882  MAE: 1.1398  Corr: 0.5418 
2024-06-13 20:52:11:INFO:TRAIN-(cmcm) (5/31/2)>> loss: 0.6957
2024-06-13 20:52:13:INFO:VAL-(cmcm) >>
2024-06-13 20:52:13:INFO:M: >>  Has0_acc_2: 0.7074  Has0_F1_score: 0.7038  Non0_acc_2: 0.7269  Non0_F1_score: 0.7208  Mult_acc_5: 0.3755  Mult_acc_7: 0.2882  MAE: 1.1193  Corr: 0.5520 
2024-06-13 20:52:14:INFO:Saving checkpoint at epoch 31 to results/models/cmcm-mosi-regression.pth.
2024-06-13 20:52:29:INFO:TRAIN-(cmcm) (1/32/2)>> loss: 0.6963
2024-06-13 20:52:31:INFO:VAL-(cmcm) >>
2024-06-13 20:52:31:INFO:M: >>  Has0_acc_2: 0.6943  Has0_F1_score: 0.6957  Non0_acc_2: 0.6759  Non0_F1_score: 0.6777  Mult_acc_5: 0.3581  Mult_acc_7: 0.2838  MAE: 1.1485  Corr: 0.5399 
2024-06-13 20:52:46:INFO:TRAIN-(cmcm) (2/33/2)>> loss: 0.6743
2024-06-13 20:52:49:INFO:VAL-(cmcm) >>
2024-06-13 20:52:49:INFO:M: >>  Has0_acc_2: 0.7074  Has0_F1_score: 0.7060  Non0_acc_2: 0.7269  Non0_F1_score: 0.7252  Mult_acc_5: 0.4148  Mult_acc_7: 0.3100  MAE: 1.1280  Corr: 0.5519 
2024-06-13 20:53:03:INFO:TRAIN-(cmcm) (3/34/2)>> loss: 0.6621
2024-06-13 20:53:06:INFO:VAL-(cmcm) >>
2024-06-13 20:53:06:INFO:M: >>  Has0_acc_2: 0.6638  Has0_F1_score: 0.6514  Non0_acc_2: 0.7176  Non0_F1_score: 0.7146  Mult_acc_5: 0.3799  Mult_acc_7: 0.2795  MAE: 1.1691  Corr: 0.5085 
2024-06-13 20:53:21:INFO:TRAIN-(cmcm) (4/35/2)>> loss: 0.6639
2024-06-13 20:53:23:INFO:VAL-(cmcm) >>
2024-06-13 20:53:23:INFO:M: >>  Has0_acc_2: 0.6725  Has0_F1_score: 0.6738  Non0_acc_2: 0.7130  Non0_F1_score: 0.7143  Mult_acc_5: 0.3843  Mult_acc_7: 0.2795  MAE: 1.1503  Corr: 0.5594 
2024-06-13 20:53:38:INFO:TRAIN-(cmcm) (5/36/2)>> loss: 0.6551
2024-06-13 20:53:40:INFO:VAL-(cmcm) >>
2024-06-13 20:53:40:INFO:M: >>  Has0_acc_2: 0.6594  Has0_F1_score: 0.6623  Non0_acc_2: 0.7037  Non0_F1_score: 0.7037  Mult_acc_5: 0.3450  Mult_acc_7: 0.2620  MAE: 1.2468  Corr: 0.4873 
2024-06-13 20:53:55:INFO:TRAIN-(cmcm) (6/37/2)>> loss: 0.6486
2024-06-13 20:53:58:INFO:VAL-(cmcm) >>
2024-06-13 20:53:58:INFO:M: >>  Has0_acc_2: 0.6769  Has0_F1_score: 0.6756  Non0_acc_2: 0.6759  Non0_F1_score: 0.6777  Mult_acc_5: 0.3712  Mult_acc_7: 0.2751  MAE: 1.1887  Corr: 0.5146 
2024-06-13 20:54:12:INFO:TRAIN-(cmcm) (7/38/2)>> loss: 0.6505
2024-06-13 20:54:15:INFO:VAL-(cmcm) >>
2024-06-13 20:54:15:INFO:M: >>  Has0_acc_2: 0.6594  Has0_F1_score: 0.6221  Non0_acc_2: 0.6481  Non0_F1_score: 0.6093  Mult_acc_5: 0.3886  Mult_acc_7: 0.3057  MAE: 1.2468  Corr: 0.4857 
2024-06-13 20:54:30:INFO:TRAIN-(cmcm) (8/39/2)>> loss: 0.6507
2024-06-13 20:54:32:INFO:VAL-(cmcm) >>
2024-06-13 20:54:32:INFO:M: >>  Has0_acc_2: 0.6725  Has0_F1_score: 0.6543  Non0_acc_2: 0.7037  Non0_F1_score: 0.6894  Mult_acc_5: 0.3974  Mult_acc_7: 0.2882  MAE: 1.2110  Corr: 0.5046 
2024-06-13 20:54:47:INFO:TRAIN-(cmcm) (9/40/2)>> loss: 0.6269
2024-06-13 20:54:49:INFO:VAL-(cmcm) >>
2024-06-13 20:54:49:INFO:M: >>  Has0_acc_2: 0.6507  Has0_F1_score: 0.6370  Non0_acc_2: 0.6898  Non0_F1_score: 0.6904  Mult_acc_5: 0.3712  Mult_acc_7: 0.2882  MAE: 1.1769  Corr: 0.5245 
2024-06-13 20:55:04:INFO:TRAIN-(cmcm) (10/41/2)>> loss: 0.6181
2024-06-13 20:55:07:INFO:VAL-(cmcm) >>
2024-06-13 20:55:07:INFO:M: >>  Has0_acc_2: 0.6987  Has0_F1_score: 0.6949  Non0_acc_2: 0.7361  Non0_F1_score: 0.7327  Mult_acc_5: 0.4017  Mult_acc_7: 0.2969  MAE: 1.1739  Corr: 0.5480 
2024-06-13 20:55:14:INFO:TEST-(cmcm) >>
2024-06-13 20:55:14:INFO:M: >>  Has0_acc_2: 0.7318  Has0_F1_score: 0.7325  Non0_acc_2: 0.7348  Non0_F1_score: 0.7363  Mult_acc_5: 0.3499  Mult_acc_7: 0.3076  MAE: 1.0637  Corr: 0.5728 
2024-06-13 20:55:15:INFO:Results are added to results/results/mosi-regression-90.csv...
2024-06-13 20:55:15:INFO:Start running cmcm...
2024-06-13 20:55:15:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 6, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 90, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 3333}>
2024-06-13 20:55:15:INFO:Let's use the GPU 1 !
2024-06-13 20:55:15:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 20:55:15:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718283315 HTTP/1.1" 200 235
2024-06-13 20:55:15:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 20:55:16:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 20:55:16:INFO:train samples: (1284,)
2024-06-13 20:55:16:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 20:55:17:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718283317 HTTP/1.1" 200 235
2024-06-13 20:55:17:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 20:55:17:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 20:55:18:INFO:valid samples: (229,)
2024-06-13 20:55:18:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 20:55:18:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718283319 HTTP/1.1" 200 235
2024-06-13 20:55:19:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 20:55:19:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 20:55:20:INFO:test samples: (686,)
2024-06-13 20:55:20:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 20:55:20:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718283320 HTTP/1.1" 200 235
2024-06-13 20:55:20:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 20:55:21:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 20:55:21:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 20:55:21:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718283322 HTTP/1.1" 200 235
2024-06-13 20:55:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 20:55:22:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 20:55:22:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-13 20:55:22:WARNING:Try importing flash-attention for faster inference...
2024-06-13 20:55:22:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-13 20:55:22:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-13 20:55:22:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-13 20:55:23:INFO:trainable params: 1310288 || all params: 1838138960 || trainable%: 0.07128340286090232
2024-06-13 20:55:23:INFO:Init labels...
2024-06-13 20:55:23:INFO:Start training...
2024-06-13 20:55:38:INFO:TRAIN-(cmcm) (1/1/3)>> loss: 2.4930
2024-06-13 20:55:41:INFO:VAL-(cmcm) >>
2024-06-13 20:55:41:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4652  Non0_acc_2: 0.5787  Non0_F1_score: 0.4370  Mult_acc_5: 0.2096  Mult_acc_7: 0.1834  MAE: 1.5680  Corr: -0.0328 
2024-06-13 20:55:41:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-13 20:55:56:INFO:TRAIN-(cmcm) (1/2/3)>> loss: 0.9303
2024-06-13 20:55:59:INFO:VAL-(cmcm) >>
2024-06-13 20:55:59:INFO:M: >>  Has0_acc_2: 0.5633  Has0_F1_score: 0.5010  Non0_acc_2: 0.5463  Non0_F1_score: 0.4807  Mult_acc_5: 0.2620  Mult_acc_7: 0.2009  MAE: 1.6813  Corr: -0.0202 
2024-06-13 20:56:14:INFO:TRAIN-(cmcm) (2/3/3)>> loss: 0.9009
2024-06-13 20:56:16:INFO:VAL-(cmcm) >>
2024-06-13 20:56:16:INFO:M: >>  Has0_acc_2: 0.5197  Has0_F1_score: 0.5115  Non0_acc_2: 0.5046  Non0_F1_score: 0.4953  Mult_acc_5: 0.2140  Mult_acc_7: 0.1834  MAE: 1.7647  Corr: -0.0523 
2024-06-13 20:56:31:INFO:TRAIN-(cmcm) (3/4/3)>> loss: 0.8887
2024-06-13 20:56:34:INFO:VAL-(cmcm) >>
2024-06-13 20:56:34:INFO:M: >>  Has0_acc_2: 0.4017  Has0_F1_score: 0.2451  Non0_acc_2: 0.4259  Non0_F1_score: 0.2544  Mult_acc_5: 0.1485  Mult_acc_7: 0.1485  MAE: 1.6497  Corr: 0.0283 
2024-06-13 20:56:49:INFO:TRAIN-(cmcm) (4/5/3)>> loss: 0.9291
2024-06-13 20:56:51:INFO:VAL-(cmcm) >>
2024-06-13 20:56:51:INFO:M: >>  Has0_acc_2: 0.5546  Has0_F1_score: 0.5471  Non0_acc_2: 0.5556  Non0_F1_score: 0.5450  Mult_acc_5: 0.2533  Mult_acc_7: 0.2096  MAE: 1.6651  Corr: 0.0753 
2024-06-13 20:57:06:INFO:TRAIN-(cmcm) (5/6/3)>> loss: 0.8753
2024-06-13 20:57:09:INFO:VAL-(cmcm) >>
2024-06-13 20:57:09:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.5040  Non0_acc_2: 0.5463  Non0_F1_score: 0.4807  Mult_acc_5: 0.2620  Mult_acc_7: 0.1921  MAE: 1.8114  Corr: -0.0082 
2024-06-13 20:57:23:INFO:TRAIN-(cmcm) (6/7/3)>> loss: 0.8645
2024-06-13 20:57:26:INFO:VAL-(cmcm) >>
2024-06-13 20:57:26:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5534  Non0_acc_2: 0.5880  Non0_F1_score: 0.5556  Mult_acc_5: 0.2795  Mult_acc_7: 0.2052  MAE: 1.5809  Corr: 0.0996 
2024-06-13 20:57:41:INFO:TRAIN-(cmcm) (7/8/3)>> loss: 0.8623
2024-06-13 20:57:43:INFO:VAL-(cmcm) >>
2024-06-13 20:57:43:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4830  Non0_acc_2: 0.5046  Non0_F1_score: 0.4742  Mult_acc_5: 0.2009  Mult_acc_7: 0.1965  MAE: 1.4999  Corr: 0.0697 
2024-06-13 20:57:44:INFO:Saving checkpoint at epoch 8 to results/models/cmcm-mosi-regression.pth.
2024-06-13 20:57:59:INFO:TRAIN-(cmcm) (1/9/3)>> loss: 0.8605
2024-06-13 20:58:01:INFO:VAL-(cmcm) >>
2024-06-13 20:58:01:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.5137  Non0_acc_2: 0.5787  Non0_F1_score: 0.4881  Mult_acc_5: 0.3057  Mult_acc_7: 0.2183  MAE: 1.6542  Corr: 0.1119 
2024-06-13 20:58:16:INFO:TRAIN-(cmcm) (2/10/3)>> loss: 0.8494
2024-06-13 20:58:19:INFO:VAL-(cmcm) >>
2024-06-13 20:58:19:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.5724  Non0_acc_2: 0.6019  Non0_F1_score: 0.5639  Mult_acc_5: 0.3275  Mult_acc_7: 0.2533  MAE: 1.5031  Corr: 0.1890 
2024-06-13 20:58:34:INFO:TRAIN-(cmcm) (3/11/3)>> loss: 0.8362
2024-06-13 20:58:36:INFO:VAL-(cmcm) >>
2024-06-13 20:58:36:INFO:M: >>  Has0_acc_2: 0.6594  Has0_F1_score: 0.6317  Non0_acc_2: 0.6620  Non0_F1_score: 0.6310  Mult_acc_5: 0.3406  Mult_acc_7: 0.2445  MAE: 1.3769  Corr: 0.3659 
2024-06-13 20:58:37:INFO:Saving checkpoint at epoch 11 to results/models/cmcm-mosi-regression.pth.
2024-06-13 20:58:52:INFO:TRAIN-(cmcm) (1/12/3)>> loss: 0.8300
2024-06-13 20:58:54:INFO:VAL-(cmcm) >>
2024-06-13 20:58:54:INFO:M: >>  Has0_acc_2: 0.6288  Has0_F1_score: 0.5706  Non0_acc_2: 0.6343  Non0_F1_score: 0.5797  Mult_acc_5: 0.3013  Mult_acc_7: 0.2402  MAE: 1.4276  Corr: 0.2984 
2024-06-13 20:59:09:INFO:TRAIN-(cmcm) (2/13/3)>> loss: 0.8153
2024-06-13 20:59:12:INFO:VAL-(cmcm) >>
2024-06-13 20:59:12:INFO:M: >>  Has0_acc_2: 0.7074  Has0_F1_score: 0.7053  Non0_acc_2: 0.7176  Non0_F1_score: 0.7139  Mult_acc_5: 0.3624  Mult_acc_7: 0.3188  MAE: 1.1346  Corr: 0.5060 
2024-06-13 20:59:12:INFO:Saving checkpoint at epoch 13 to results/models/cmcm-mosi-regression.pth.
2024-06-13 20:59:27:INFO:TRAIN-(cmcm) (1/14/3)>> loss: 0.8094
2024-06-13 20:59:30:INFO:VAL-(cmcm) >>
2024-06-13 20:59:30:INFO:M: >>  Has0_acc_2: 0.6201  Has0_F1_score: 0.6093  Non0_acc_2: 0.6528  Non0_F1_score: 0.6433  Mult_acc_5: 0.3188  Mult_acc_7: 0.2489  MAE: 1.3634  Corr: 0.4411 
2024-06-13 20:59:45:INFO:TRAIN-(cmcm) (2/15/3)>> loss: 0.7919
2024-06-13 20:59:47:INFO:VAL-(cmcm) >>
2024-06-13 20:59:47:INFO:M: >>  Has0_acc_2: 0.7074  Has0_F1_score: 0.7102  Non0_acc_2: 0.7315  Non0_F1_score: 0.7329  Mult_acc_5: 0.3057  Mult_acc_7: 0.2533  MAE: 1.1916  Corr: 0.4904 
2024-06-13 21:00:02:INFO:TRAIN-(cmcm) (3/16/3)>> loss: 0.7850
2024-06-13 21:00:05:INFO:VAL-(cmcm) >>
2024-06-13 21:00:05:INFO:M: >>  Has0_acc_2: 0.7162  Has0_F1_score: 0.7109  Non0_acc_2: 0.7269  Non0_F1_score: 0.7208  Mult_acc_5: 0.4279  Mult_acc_7: 0.3144  MAE: 1.1271  Corr: 0.5423 
2024-06-13 21:00:05:INFO:Saving checkpoint at epoch 16 to results/models/cmcm-mosi-regression.pth.
2024-06-13 21:00:20:INFO:TRAIN-(cmcm) (1/17/3)>> loss: 0.7745
2024-06-13 21:00:23:INFO:VAL-(cmcm) >>
2024-06-13 21:00:23:INFO:M: >>  Has0_acc_2: 0.7074  Has0_F1_score: 0.7096  Non0_acc_2: 0.7361  Non0_F1_score: 0.7373  Mult_acc_5: 0.3930  Mult_acc_7: 0.3100  MAE: 1.1215  Corr: 0.5373 
2024-06-13 21:00:23:INFO:Saving checkpoint at epoch 17 to results/models/cmcm-mosi-regression.pth.
2024-06-13 21:00:39:INFO:TRAIN-(cmcm) (1/18/3)>> loss: 0.7687
2024-06-13 21:00:41:INFO:VAL-(cmcm) >>
2024-06-13 21:00:41:INFO:M: >>  Has0_acc_2: 0.7031  Has0_F1_score: 0.6989  Non0_acc_2: 0.7083  Non0_F1_score: 0.7099  Mult_acc_5: 0.4192  Mult_acc_7: 0.3231  MAE: 1.1053  Corr: 0.5398 
2024-06-13 21:00:42:INFO:Saving checkpoint at epoch 18 to results/models/cmcm-mosi-regression.pth.
2024-06-13 21:00:57:INFO:TRAIN-(cmcm) (1/19/3)>> loss: 0.7654
2024-06-13 21:00:59:INFO:VAL-(cmcm) >>
2024-06-13 21:00:59:INFO:M: >>  Has0_acc_2: 0.6987  Has0_F1_score: 0.7012  Non0_acc_2: 0.6574  Non0_F1_score: 0.6449  Mult_acc_5: 0.3581  Mult_acc_7: 0.2707  MAE: 1.2755  Corr: 0.5303 
2024-06-13 21:01:14:INFO:TRAIN-(cmcm) (2/20/3)>> loss: 0.7547
2024-06-13 21:01:17:INFO:VAL-(cmcm) >>
2024-06-13 21:01:17:INFO:M: >>  Has0_acc_2: 0.7642  Has0_F1_score: 0.7587  Non0_acc_2: 0.7685  Non0_F1_score: 0.7622  Mult_acc_5: 0.4105  Mult_acc_7: 0.3100  MAE: 1.1030  Corr: 0.5394 
2024-06-13 21:01:17:INFO:Saving checkpoint at epoch 20 to results/models/cmcm-mosi-regression.pth.
2024-06-13 21:01:32:INFO:TRAIN-(cmcm) (1/21/3)>> loss: 0.7580
2024-06-13 21:01:35:INFO:VAL-(cmcm) >>
2024-06-13 21:01:35:INFO:M: >>  Has0_acc_2: 0.7686  Has0_F1_score: 0.7674  Non0_acc_2: 0.7361  Non0_F1_score: 0.7374  Mult_acc_5: 0.3843  Mult_acc_7: 0.3231  MAE: 1.0995  Corr: 0.5547 
2024-06-13 21:01:35:INFO:Saving checkpoint at epoch 21 to results/models/cmcm-mosi-regression.pth.
2024-06-13 21:01:51:INFO:TRAIN-(cmcm) (1/22/3)>> loss: 0.7512
2024-06-13 21:01:53:INFO:VAL-(cmcm) >>
2024-06-13 21:01:53:INFO:M: >>  Has0_acc_2: 0.6812  Has0_F1_score: 0.6794  Non0_acc_2: 0.7037  Non0_F1_score: 0.7003  Mult_acc_5: 0.3275  Mult_acc_7: 0.2533  MAE: 1.2196  Corr: 0.5246 
2024-06-13 21:02:08:INFO:TRAIN-(cmcm) (2/23/3)>> loss: 0.7389
2024-06-13 21:02:11:INFO:VAL-(cmcm) >>
2024-06-13 21:02:11:INFO:M: >>  Has0_acc_2: 0.7424  Has0_F1_score: 0.7448  Non0_acc_2: 0.7315  Non0_F1_score: 0.7315  Mult_acc_5: 0.3799  Mult_acc_7: 0.3013  MAE: 1.0988  Corr: 0.5714 
2024-06-13 21:02:11:INFO:Saving checkpoint at epoch 23 to results/models/cmcm-mosi-regression.pth.
2024-06-13 21:02:26:INFO:TRAIN-(cmcm) (1/24/3)>> loss: 0.7237
2024-06-13 21:02:29:INFO:VAL-(cmcm) >>
2024-06-13 21:02:29:INFO:M: >>  Has0_acc_2: 0.6943  Has0_F1_score: 0.6970  Non0_acc_2: 0.6898  Non0_F1_score: 0.6874  Mult_acc_5: 0.3712  Mult_acc_7: 0.2969  MAE: 1.1769  Corr: 0.5314 
2024-06-13 21:02:44:INFO:TRAIN-(cmcm) (2/25/3)>> loss: 0.7173
2024-06-13 21:02:46:INFO:VAL-(cmcm) >>
2024-06-13 21:02:46:INFO:M: >>  Has0_acc_2: 0.6987  Has0_F1_score: 0.7011  Non0_acc_2: 0.7130  Non0_F1_score: 0.7139  Mult_acc_5: 0.4279  Mult_acc_7: 0.3537  MAE: 1.0835  Corr: 0.5617 
2024-06-13 21:02:47:INFO:Saving checkpoint at epoch 25 to results/models/cmcm-mosi-regression.pth.
2024-06-13 21:03:02:INFO:TRAIN-(cmcm) (1/26/3)>> loss: 0.7236
2024-06-13 21:03:04:INFO:VAL-(cmcm) >>
2024-06-13 21:03:04:INFO:M: >>  Has0_acc_2: 0.7205  Has0_F1_score: 0.7227  Non0_acc_2: 0.6898  Non0_F1_score: 0.6896  Mult_acc_5: 0.3712  Mult_acc_7: 0.2969  MAE: 1.1309  Corr: 0.5614 
2024-06-13 21:03:19:INFO:TRAIN-(cmcm) (2/27/3)>> loss: 0.7198
2024-06-13 21:03:22:INFO:VAL-(cmcm) >>
2024-06-13 21:03:22:INFO:M: >>  Has0_acc_2: 0.7118  Has0_F1_score: 0.7145  Non0_acc_2: 0.6991  Non0_F1_score: 0.6996  Mult_acc_5: 0.3886  Mult_acc_7: 0.3013  MAE: 1.1826  Corr: 0.5176 
2024-06-13 21:03:37:INFO:TRAIN-(cmcm) (3/28/3)>> loss: 0.6918
2024-06-13 21:03:39:INFO:VAL-(cmcm) >>
2024-06-13 21:03:39:INFO:M: >>  Has0_acc_2: 0.7031  Has0_F1_score: 0.6998  Non0_acc_2: 0.7083  Non0_F1_score: 0.7099  Mult_acc_5: 0.3974  Mult_acc_7: 0.3100  MAE: 1.1280  Corr: 0.5348 
2024-06-13 21:03:54:INFO:TRAIN-(cmcm) (4/29/3)>> loss: 0.6855
2024-06-13 21:03:57:INFO:VAL-(cmcm) >>
2024-06-13 21:03:57:INFO:M: >>  Has0_acc_2: 0.7031  Has0_F1_score: 0.6888  Non0_acc_2: 0.7454  Non0_F1_score: 0.7433  Mult_acc_5: 0.4236  Mult_acc_7: 0.3188  MAE: 1.1643  Corr: 0.5146 
2024-06-13 21:04:12:INFO:TRAIN-(cmcm) (5/30/3)>> loss: 0.6954
2024-06-13 21:04:14:INFO:VAL-(cmcm) >>
2024-06-13 21:04:14:INFO:M: >>  Has0_acc_2: 0.7118  Has0_F1_score: 0.7131  Non0_acc_2: 0.6806  Non0_F1_score: 0.6808  Mult_acc_5: 0.3493  Mult_acc_7: 0.2926  MAE: 1.1630  Corr: 0.5234 
2024-06-13 21:04:29:INFO:TRAIN-(cmcm) (6/31/3)>> loss: 0.6765
2024-06-13 21:04:32:INFO:VAL-(cmcm) >>
2024-06-13 21:04:32:INFO:M: >>  Has0_acc_2: 0.6900  Has0_F1_score: 0.6920  Non0_acc_2: 0.7130  Non0_F1_score: 0.7139  Mult_acc_5: 0.3537  Mult_acc_7: 0.2664  MAE: 1.2296  Corr: 0.4827 
2024-06-13 21:04:47:INFO:TRAIN-(cmcm) (7/32/3)>> loss: 0.6815
2024-06-13 21:04:49:INFO:VAL-(cmcm) >>
2024-06-13 21:04:49:INFO:M: >>  Has0_acc_2: 0.7074  Has0_F1_score: 0.7029  Non0_acc_2: 0.6852  Non0_F1_score: 0.6852  Mult_acc_5: 0.3799  Mult_acc_7: 0.3231  MAE: 1.1555  Corr: 0.4798 
2024-06-13 21:05:04:INFO:TRAIN-(cmcm) (8/33/3)>> loss: 0.6861
2024-06-13 21:05:07:INFO:VAL-(cmcm) >>
2024-06-13 21:05:07:INFO:M: >>  Has0_acc_2: 0.7555  Has0_F1_score: 0.7448  Non0_acc_2: 0.7639  Non0_F1_score: 0.7542  Mult_acc_5: 0.4017  Mult_acc_7: 0.3057  MAE: 1.1171  Corr: 0.5781 
2024-06-13 21:05:21:INFO:TRAIN-(cmcm) (9/34/3)>> loss: 0.6557
2024-06-13 21:05:24:INFO:VAL-(cmcm) >>
2024-06-13 21:05:24:INFO:M: >>  Has0_acc_2: 0.7336  Has0_F1_score: 0.7278  Non0_acc_2: 0.7454  Non0_F1_score: 0.7380  Mult_acc_5: 0.3843  Mult_acc_7: 0.3057  MAE: 1.0769  Corr: 0.5722 
2024-06-13 21:05:24:INFO:Saving checkpoint at epoch 34 to results/models/cmcm-mosi-regression.pth.
2024-06-13 21:05:40:INFO:TRAIN-(cmcm) (1/35/3)>> loss: 0.6597
2024-06-13 21:05:42:INFO:VAL-(cmcm) >>
2024-06-13 21:05:42:INFO:M: >>  Has0_acc_2: 0.7336  Has0_F1_score: 0.7339  Non0_acc_2: 0.7037  Non0_F1_score: 0.7051  Mult_acc_5: 0.3930  Mult_acc_7: 0.3013  MAE: 1.1145  Corr: 0.5651 
2024-06-13 21:05:57:INFO:TRAIN-(cmcm) (2/36/3)>> loss: 0.6593
2024-06-13 21:06:00:INFO:VAL-(cmcm) >>
2024-06-13 21:06:00:INFO:M: >>  Has0_acc_2: 0.7249  Has0_F1_score: 0.7256  Non0_acc_2: 0.6898  Non0_F1_score: 0.6914  Mult_acc_5: 0.3799  Mult_acc_7: 0.2926  MAE: 1.1577  Corr: 0.5294 
2024-06-13 21:06:14:INFO:TRAIN-(cmcm) (3/37/3)>> loss: 0.6387
2024-06-13 21:06:17:INFO:VAL-(cmcm) >>
2024-06-13 21:06:17:INFO:M: >>  Has0_acc_2: 0.7555  Has0_F1_score: 0.7459  Non0_acc_2: 0.7454  Non0_F1_score: 0.7420  Mult_acc_5: 0.4148  Mult_acc_7: 0.3231  MAE: 1.0979  Corr: 0.5739 
2024-06-13 21:06:32:INFO:TRAIN-(cmcm) (4/38/3)>> loss: 0.6136
2024-06-13 21:06:34:INFO:VAL-(cmcm) >>
2024-06-13 21:06:34:INFO:M: >>  Has0_acc_2: 0.7162  Has0_F1_score: 0.7188  Non0_acc_2: 0.7315  Non0_F1_score: 0.7329  Mult_acc_5: 0.3799  Mult_acc_7: 0.2838  MAE: 1.1507  Corr: 0.5405 
2024-06-13 21:06:49:INFO:TRAIN-(cmcm) (5/39/3)>> loss: 0.6154
2024-06-13 21:06:52:INFO:VAL-(cmcm) >>
2024-06-13 21:06:52:INFO:M: >>  Has0_acc_2: 0.7031  Has0_F1_score: 0.6980  Non0_acc_2: 0.7361  Non0_F1_score: 0.7369  Mult_acc_5: 0.3974  Mult_acc_7: 0.3188  MAE: 1.1206  Corr: 0.5501 
2024-06-13 21:07:07:INFO:TRAIN-(cmcm) (6/40/3)>> loss: 0.6092
2024-06-13 21:07:09:INFO:VAL-(cmcm) >>
2024-06-13 21:07:09:INFO:M: >>  Has0_acc_2: 0.7162  Has0_F1_score: 0.7100  Non0_acc_2: 0.7407  Non0_F1_score: 0.7355  Mult_acc_5: 0.4017  Mult_acc_7: 0.3319  MAE: 1.1049  Corr: 0.5465 
2024-06-13 21:07:24:INFO:TRAIN-(cmcm) (7/41/3)>> loss: 0.6105
2024-06-13 21:07:27:INFO:VAL-(cmcm) >>
2024-06-13 21:07:27:INFO:M: >>  Has0_acc_2: 0.7031  Has0_F1_score: 0.7051  Non0_acc_2: 0.7176  Non0_F1_score: 0.7187  Mult_acc_5: 0.3581  Mult_acc_7: 0.2969  MAE: 1.1494  Corr: 0.5248 
2024-06-13 21:07:42:INFO:TRAIN-(cmcm) (8/42/3)>> loss: 0.5918
2024-06-13 21:07:44:INFO:VAL-(cmcm) >>
2024-06-13 21:07:44:INFO:M: >>  Has0_acc_2: 0.7467  Has0_F1_score: 0.7399  Non0_acc_2: 0.7639  Non0_F1_score: 0.7587  Mult_acc_5: 0.4017  Mult_acc_7: 0.3100  MAE: 1.1057  Corr: 0.5344 
2024-06-13 21:07:59:INFO:TRAIN-(cmcm) (9/43/3)>> loss: 0.5810
2024-06-13 21:08:02:INFO:VAL-(cmcm) >>
2024-06-13 21:08:02:INFO:M: >>  Has0_acc_2: 0.7293  Has0_F1_score: 0.7262  Non0_acc_2: 0.7269  Non0_F1_score: 0.7252  Mult_acc_5: 0.4148  Mult_acc_7: 0.3275  MAE: 1.1525  Corr: 0.5119 
2024-06-13 21:08:16:INFO:TRAIN-(cmcm) (10/44/3)>> loss: 0.5945
2024-06-13 21:08:19:INFO:VAL-(cmcm) >>
2024-06-13 21:08:19:INFO:M: >>  Has0_acc_2: 0.7205  Has0_F1_score: 0.7205  Non0_acc_2: 0.7130  Non0_F1_score: 0.7130  Mult_acc_5: 0.3843  Mult_acc_7: 0.2926  MAE: 1.1577  Corr: 0.5140 
2024-06-13 21:08:27:INFO:TEST-(cmcm) >>
2024-06-13 21:08:27:INFO:M: >>  Has0_acc_2: 0.7026  Has0_F1_score: 0.7027  Non0_acc_2: 0.7119  Non0_F1_score: 0.7131  Mult_acc_5: 0.3280  Mult_acc_7: 0.2945  MAE: 1.1472  Corr: 0.5435 
2024-06-13 21:08:27:INFO:Results are added to results/results/mosi-regression-90.csv...
2024-06-13 21:08:27:INFO:Start running cmcm...
2024-06-13 21:08:27:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 6, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 90, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 4444}>
2024-06-13 21:08:27:INFO:Let's use the GPU 1 !
2024-06-13 21:08:27:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 21:08:27:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718284108 HTTP/1.1" 200 235
2024-06-13 21:08:28:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 21:08:28:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 21:08:29:INFO:train samples: (1284,)
2024-06-13 21:08:29:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 21:08:29:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718284109 HTTP/1.1" 200 235
2024-06-13 21:08:29:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 21:08:30:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 21:08:30:INFO:valid samples: (229,)
2024-06-13 21:08:31:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 21:08:31:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718284111 HTTP/1.1" 200 235
2024-06-13 21:08:31:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 21:08:31:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 21:08:32:INFO:test samples: (686,)
2024-06-13 21:08:32:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 21:08:32:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718284112 HTTP/1.1" 200 235
2024-06-13 21:08:32:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 21:08:33:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 21:08:33:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 21:08:34:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718284114 HTTP/1.1" 200 235
2024-06-13 21:08:34:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 21:08:34:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 21:08:34:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-13 21:08:34:WARNING:Try importing flash-attention for faster inference...
2024-06-13 21:08:34:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-13 21:08:34:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-13 21:08:34:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-13 21:08:35:INFO:trainable params: 1310288 || all params: 1838138960 || trainable%: 0.07128340286090232
2024-06-13 21:08:35:INFO:Init labels...
2024-06-13 21:08:35:INFO:Start training...
2024-06-13 21:08:50:INFO:TRAIN-(cmcm) (1/1/4)>> loss: 3.0768
2024-06-13 21:08:53:INFO:VAL-(cmcm) >>
2024-06-13 21:08:53:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5070  Non0_acc_2: 0.4769  Non0_F1_score: 0.4713  Mult_acc_5: 0.1659  Mult_acc_7: 0.1659  MAE: 1.5707  Corr: -0.0658 
2024-06-13 21:08:53:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-13 21:09:08:INFO:TRAIN-(cmcm) (1/2/4)>> loss: 0.9603
2024-06-13 21:09:11:INFO:VAL-(cmcm) >>
2024-06-13 21:09:11:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4891  Non0_acc_2: 0.5509  Non0_F1_score: 0.4543  Mult_acc_5: 0.1834  Mult_acc_7: 0.1703  MAE: 1.4934  Corr: 0.0229 
2024-06-13 21:09:11:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-13 21:09:26:INFO:TRAIN-(cmcm) (1/3/4)>> loss: 0.9308
2024-06-13 21:09:29:INFO:VAL-(cmcm) >>
2024-06-13 21:09:29:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.4984  Non0_acc_2: 0.5556  Non0_F1_score: 0.4993  Mult_acc_5: 0.2969  Mult_acc_7: 0.2227  MAE: 1.7315  Corr: -0.0347 
2024-06-13 21:09:44:INFO:TRAIN-(cmcm) (2/4/4)>> loss: 0.8912
2024-06-13 21:09:46:INFO:VAL-(cmcm) >>
2024-06-13 21:09:46:INFO:M: >>  Has0_acc_2: 0.5109  Has0_F1_score: 0.4959  Non0_acc_2: 0.4907  Non0_F1_score: 0.4750  Mult_acc_5: 0.1747  Mult_acc_7: 0.1703  MAE: 1.6340  Corr: -0.0633 
2024-06-13 21:10:01:INFO:TRAIN-(cmcm) (3/5/4)>> loss: 0.8839
2024-06-13 21:10:04:INFO:VAL-(cmcm) >>
2024-06-13 21:10:04:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4630  Non0_acc_2: 0.5741  Non0_F1_score: 0.4346  Mult_acc_5: 0.2052  Mult_acc_7: 0.1965  MAE: 1.5305  Corr: 0.0513 
2024-06-13 21:10:19:INFO:TRAIN-(cmcm) (4/6/4)>> loss: 0.8812
2024-06-13 21:10:21:INFO:VAL-(cmcm) >>
2024-06-13 21:10:21:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5741  Non0_F1_score: 0.4187  Mult_acc_5: 0.1921  Mult_acc_7: 0.1921  MAE: 1.5174  Corr: -0.0112 
2024-06-13 21:10:36:INFO:TRAIN-(cmcm) (5/7/4)>> loss: 0.8743
2024-06-13 21:10:39:INFO:VAL-(cmcm) >>
2024-06-13 21:10:39:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4652  Non0_acc_2: 0.5787  Non0_F1_score: 0.4370  Mult_acc_5: 0.1790  Mult_acc_7: 0.1747  MAE: 1.5191  Corr: 0.0317 
2024-06-13 21:10:54:INFO:TRAIN-(cmcm) (6/8/4)>> loss: 0.8636
2024-06-13 21:10:56:INFO:VAL-(cmcm) >>
2024-06-13 21:10:56:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5070  Non0_acc_2: 0.5509  Non0_F1_score: 0.4839  Mult_acc_5: 0.2576  Mult_acc_7: 0.2009  MAE: 1.6699  Corr: -0.0289 
2024-06-13 21:11:11:INFO:TRAIN-(cmcm) (7/9/4)>> loss: 0.8619
2024-06-13 21:11:13:INFO:VAL-(cmcm) >>
2024-06-13 21:11:13:INFO:M: >>  Has0_acc_2: 0.5371  Has0_F1_score: 0.5263  Non0_acc_2: 0.5185  Non0_F1_score: 0.4768  Mult_acc_5: 0.2052  Mult_acc_7: 0.2009  MAE: 1.5523  Corr: 0.1868 
2024-06-13 21:11:28:INFO:TRAIN-(cmcm) (8/10/4)>> loss: 0.8600
2024-06-13 21:11:31:INFO:VAL-(cmcm) >>
2024-06-13 21:11:31:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.5739  Non0_acc_2: 0.5972  Non0_F1_score: 0.5656  Mult_acc_5: 0.2969  Mult_acc_7: 0.2271  MAE: 1.5848  Corr: 0.1275 
2024-06-13 21:11:46:INFO:TRAIN-(cmcm) (9/11/4)>> loss: 0.8634
2024-06-13 21:11:48:INFO:VAL-(cmcm) >>
2024-06-13 21:11:48:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.4947  Non0_acc_2: 0.5556  Non0_F1_score: 0.4680  Mult_acc_5: 0.2751  Mult_acc_7: 0.1965  MAE: 1.7263  Corr: -0.0199 
2024-06-13 21:12:03:INFO:TRAIN-(cmcm) (10/12/4)>> loss: 0.8464
2024-06-13 21:12:06:INFO:VAL-(cmcm) >>
2024-06-13 21:12:06:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.4897  Non0_acc_2: 0.5648  Non0_F1_score: 0.4627  Mult_acc_5: 0.2402  Mult_acc_7: 0.2009  MAE: 1.6759  Corr: -0.0319 
2024-06-13 21:12:13:INFO:TEST-(cmcm) >>
2024-06-13 21:12:13:INFO:M: >>  Has0_acc_2: 0.4810  Has0_F1_score: 0.3681  Non0_acc_2: 0.4680  Non0_F1_score: 0.3753  Mult_acc_5: 0.1720  Mult_acc_7: 0.1720  MAE: 1.6946  Corr: 0.1177 
2024-06-13 21:12:14:INFO:Results are added to results/results/mosi-regression-90.csv...
2024-06-13 21:12:14:INFO:Start running cmcm...
2024-06-13 21:12:14:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 6, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 90, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 5555}>
2024-06-13 21:12:14:INFO:Let's use the GPU 1 !
2024-06-13 21:12:14:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 21:12:14:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718284334 HTTP/1.1" 200 235
2024-06-13 21:12:14:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 21:12:15:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 21:12:15:INFO:train samples: (1284,)
2024-06-13 21:12:16:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 21:12:16:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718284336 HTTP/1.1" 200 235
2024-06-13 21:12:16:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 21:12:17:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 21:12:17:INFO:valid samples: (229,)
2024-06-13 21:12:17:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 21:12:18:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718284338 HTTP/1.1" 200 235
2024-06-13 21:12:18:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 21:12:18:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 21:12:19:INFO:test samples: (686,)
2024-06-13 21:12:19:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 21:12:19:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718284339 HTTP/1.1" 200 235
2024-06-13 21:12:19:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 21:12:20:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 21:12:20:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 21:12:20:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718284341 HTTP/1.1" 200 235
2024-06-13 21:12:21:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 21:12:21:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 21:12:21:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-13 21:12:21:WARNING:Try importing flash-attention for faster inference...
2024-06-13 21:12:21:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-13 21:12:21:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-13 21:12:21:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-13 21:12:22:INFO:trainable params: 1310288 || all params: 1838138960 || trainable%: 0.07128340286090232
2024-06-13 21:12:22:INFO:Init labels...
2024-06-13 21:12:22:INFO:Start training...
2024-06-13 21:12:37:INFO:TRAIN-(cmcm) (1/1/5)>> loss: 2.4671
2024-06-13 21:12:40:INFO:VAL-(cmcm) >>
2024-06-13 21:12:40:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5833  Non0_F1_score: 0.4393  Mult_acc_5: 0.2882  Mult_acc_7: 0.2140  MAE: 1.7730  Corr: 0.0266 
2024-06-13 21:12:40:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-13 21:12:55:INFO:TRAIN-(cmcm) (1/2/5)>> loss: 0.9811
2024-06-13 21:12:58:INFO:VAL-(cmcm) >>
2024-06-13 21:12:58:INFO:M: >>  Has0_acc_2: 0.5153  Has0_F1_score: 0.4961  Non0_acc_2: 0.5417  Non0_F1_score: 0.5240  Mult_acc_5: 0.2183  Mult_acc_7: 0.1790  MAE: 1.8414  Corr: 0.1628 
2024-06-13 21:13:13:INFO:TRAIN-(cmcm) (2/3/5)>> loss: 0.8961
2024-06-13 21:13:15:INFO:VAL-(cmcm) >>
2024-06-13 21:13:15:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4458  Non0_acc_2: 0.5694  Non0_F1_score: 0.4323  Mult_acc_5: 0.2707  Mult_acc_7: 0.2009  MAE: 1.6049  Corr: 0.0188 
2024-06-13 21:13:16:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-mosi-regression.pth.
2024-06-13 21:13:31:INFO:TRAIN-(cmcm) (1/4/5)>> loss: 0.8917
2024-06-13 21:13:34:INFO:VAL-(cmcm) >>
2024-06-13 21:13:34:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5146  Non0_acc_2: 0.5787  Non0_F1_score: 0.5117  Mult_acc_5: 0.1965  Mult_acc_7: 0.1965  MAE: 1.5362  Corr: 0.0025 
2024-06-13 21:13:34:INFO:Saving checkpoint at epoch 4 to results/models/cmcm-mosi-regression.pth.
2024-06-13 21:13:49:INFO:TRAIN-(cmcm) (1/5/5)>> loss: 0.8855
2024-06-13 21:13:52:INFO:VAL-(cmcm) >>
2024-06-13 21:13:52:INFO:M: >>  Has0_acc_2: 0.5502  Has0_F1_score: 0.5121  Non0_acc_2: 0.5370  Non0_F1_score: 0.4961  Mult_acc_5: 0.2707  Mult_acc_7: 0.1921  MAE: 1.8315  Corr: -0.0211 
2024-06-13 21:14:07:INFO:TRAIN-(cmcm) (2/6/5)>> loss: 0.8660
2024-06-13 21:14:09:INFO:VAL-(cmcm) >>
2024-06-13 21:14:09:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5726  Non0_acc_2: 0.6111  Non0_F1_score: 0.5882  Mult_acc_5: 0.2445  Mult_acc_7: 0.1834  MAE: 1.4638  Corr: 0.3458 
2024-06-13 21:14:10:INFO:Saving checkpoint at epoch 6 to results/models/cmcm-mosi-regression.pth.
2024-06-13 21:14:25:INFO:TRAIN-(cmcm) (1/7/5)>> loss: 0.8480
2024-06-13 21:14:27:INFO:VAL-(cmcm) >>
2024-06-13 21:14:27:INFO:M: >>  Has0_acc_2: 0.6463  Has0_F1_score: 0.6483  Non0_acc_2: 0.6667  Non0_F1_score: 0.6675  Mult_acc_5: 0.2052  Mult_acc_7: 0.2009  MAE: 1.3453  Corr: 0.3773 
2024-06-13 21:14:28:INFO:Saving checkpoint at epoch 7 to results/models/cmcm-mosi-regression.pth.
2024-06-13 21:14:43:INFO:TRAIN-(cmcm) (1/8/5)>> loss: 0.8429
2024-06-13 21:14:46:INFO:VAL-(cmcm) >>
2024-06-13 21:14:46:INFO:M: >>  Has0_acc_2: 0.6376  Has0_F1_score: 0.6297  Non0_acc_2: 0.6389  Non0_F1_score: 0.6291  Mult_acc_5: 0.3100  Mult_acc_7: 0.2096  MAE: 1.6162  Corr: 0.2387 
2024-06-13 21:15:00:INFO:TRAIN-(cmcm) (2/9/5)>> loss: 0.8382
2024-06-13 21:15:03:INFO:VAL-(cmcm) >>
2024-06-13 21:15:03:INFO:M: >>  Has0_acc_2: 0.7205  Has0_F1_score: 0.7174  Non0_acc_2: 0.7361  Non0_F1_score: 0.7311  Mult_acc_5: 0.3013  Mult_acc_7: 0.2707  MAE: 1.1761  Corr: 0.4679 
2024-06-13 21:15:03:INFO:Saving checkpoint at epoch 9 to results/models/cmcm-mosi-regression.pth.
2024-06-13 21:15:18:INFO:TRAIN-(cmcm) (1/10/5)>> loss: 0.8239
2024-06-13 21:15:21:INFO:VAL-(cmcm) >>
2024-06-13 21:15:21:INFO:M: >>  Has0_acc_2: 0.7118  Has0_F1_score: 0.6935  Non0_acc_2: 0.7176  Non0_F1_score: 0.7153  Mult_acc_5: 0.3231  Mult_acc_7: 0.2838  MAE: 1.1761  Corr: 0.4731 
2024-06-13 21:15:36:INFO:TRAIN-(cmcm) (2/11/5)>> loss: 0.8051
2024-06-13 21:15:38:INFO:VAL-(cmcm) >>
2024-06-13 21:15:38:INFO:M: >>  Has0_acc_2: 0.7205  Has0_F1_score: 0.7043  Non0_acc_2: 0.6620  Non0_F1_score: 0.6633  Mult_acc_5: 0.3144  Mult_acc_7: 0.2795  MAE: 1.1440  Corr: 0.5330 
2024-06-13 21:15:39:INFO:Saving checkpoint at epoch 11 to results/models/cmcm-mosi-regression.pth.
2024-06-13 21:15:54:INFO:TRAIN-(cmcm) (1/12/5)>> loss: 0.7883
2024-06-13 21:15:56:INFO:VAL-(cmcm) >>
2024-06-13 21:15:56:INFO:M: >>  Has0_acc_2: 0.7031  Has0_F1_score: 0.6951  Non0_acc_2: 0.7130  Non0_F1_score: 0.7041  Mult_acc_5: 0.2795  Mult_acc_7: 0.2489  MAE: 1.1440  Corr: 0.5071 
2024-06-13 21:16:11:INFO:TRAIN-(cmcm) (2/13/5)>> loss: 0.7895
2024-06-13 21:16:14:INFO:VAL-(cmcm) >>
2024-06-13 21:16:14:INFO:M: >>  Has0_acc_2: 0.7249  Has0_F1_score: 0.7170  Non0_acc_2: 0.7361  Non0_F1_score: 0.7285  Mult_acc_5: 0.4192  Mult_acc_7: 0.3057  MAE: 1.1551  Corr: 0.5320 
2024-06-13 21:16:28:INFO:TRAIN-(cmcm) (3/14/5)>> loss: 0.7693
2024-06-13 21:16:31:INFO:VAL-(cmcm) >>
2024-06-13 21:16:31:INFO:M: >>  Has0_acc_2: 0.6463  Has0_F1_score: 0.6469  Non0_acc_2: 0.6343  Non0_F1_score: 0.6242  Mult_acc_5: 0.3013  Mult_acc_7: 0.2533  MAE: 1.2337  Corr: 0.4650 
2024-06-13 21:16:46:INFO:TRAIN-(cmcm) (4/15/5)>> loss: 0.7696
2024-06-13 21:16:48:INFO:VAL-(cmcm) >>
2024-06-13 21:16:48:INFO:M: >>  Has0_acc_2: 0.6812  Has0_F1_score: 0.6834  Non0_acc_2: 0.6435  Non0_F1_score: 0.6267  Mult_acc_5: 0.3144  Mult_acc_7: 0.2489  MAE: 1.3008  Corr: 0.5064 
2024-06-13 21:17:03:INFO:TRAIN-(cmcm) (5/16/5)>> loss: 0.7605
2024-06-13 21:17:06:INFO:VAL-(cmcm) >>
2024-06-13 21:17:06:INFO:M: >>  Has0_acc_2: 0.6856  Has0_F1_score: 0.6886  Non0_acc_2: 0.6852  Non0_F1_score: 0.6869  Mult_acc_5: 0.3581  Mult_acc_7: 0.2926  MAE: 1.2001  Corr: 0.4899 
2024-06-13 21:17:20:INFO:TRAIN-(cmcm) (6/17/5)>> loss: 0.7442
2024-06-13 21:17:23:INFO:VAL-(cmcm) >>
2024-06-13 21:17:23:INFO:M: >>  Has0_acc_2: 0.7118  Has0_F1_score: 0.7146  Non0_acc_2: 0.6759  Non0_F1_score: 0.6737  Mult_acc_5: 0.3275  Mult_acc_7: 0.2402  MAE: 1.2056  Corr: 0.5324 
2024-06-13 21:17:38:INFO:TRAIN-(cmcm) (7/18/5)>> loss: 0.7378
2024-06-13 21:17:40:INFO:VAL-(cmcm) >>
2024-06-13 21:17:40:INFO:M: >>  Has0_acc_2: 0.6943  Has0_F1_score: 0.6872  Non0_acc_2: 0.7222  Non0_F1_score: 0.7226  Mult_acc_5: 0.3886  Mult_acc_7: 0.2969  MAE: 1.1542  Corr: 0.5308 
2024-06-13 21:17:55:INFO:TRAIN-(cmcm) (8/19/5)>> loss: 0.7360
2024-06-13 21:17:58:INFO:VAL-(cmcm) >>
2024-06-13 21:17:58:INFO:M: >>  Has0_acc_2: 0.6594  Has0_F1_score: 0.6597  Non0_acc_2: 0.6898  Non0_F1_score: 0.6891  Mult_acc_5: 0.3624  Mult_acc_7: 0.2969  MAE: 1.1957  Corr: 0.4999 
2024-06-13 21:18:12:INFO:TRAIN-(cmcm) (9/20/5)>> loss: 0.7303
2024-06-13 21:18:15:INFO:VAL-(cmcm) >>
2024-06-13 21:18:15:INFO:M: >>  Has0_acc_2: 0.6550  Has0_F1_score: 0.6514  Non0_acc_2: 0.6944  Non0_F1_score: 0.6910  Mult_acc_5: 0.3013  Mult_acc_7: 0.2314  MAE: 1.2860  Corr: 0.5496 
2024-06-13 21:18:30:INFO:TRAIN-(cmcm) (10/21/5)>> loss: 0.7363
2024-06-13 21:18:32:INFO:VAL-(cmcm) >>
2024-06-13 21:18:32:INFO:M: >>  Has0_acc_2: 0.6812  Has0_F1_score: 0.6826  Non0_acc_2: 0.6944  Non0_F1_score: 0.6944  Mult_acc_5: 0.3231  Mult_acc_7: 0.2402  MAE: 1.1791  Corr: 0.5642 
2024-06-13 21:18:40:INFO:TEST-(cmcm) >>
2024-06-13 21:18:40:INFO:M: >>  Has0_acc_2: 0.6851  Has0_F1_score: 0.6762  Non0_acc_2: 0.7073  Non0_F1_score: 0.7088  Mult_acc_5: 0.2886  Mult_acc_7: 0.2668  MAE: 1.1045  Corr: 0.5384 
2024-06-13 21:18:40:INFO:Results are added to results/results/mosi-regression-90.csv...
2024-06-13 21:18:40:INFO:Start running cmcm...
2024-06-13 21:18:40:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 6, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 100, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-06-13 21:18:40:INFO:Let's use the GPU 1 !
2024-06-13 21:18:40:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 21:18:41:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718284721 HTTP/1.1" 200 235
2024-06-13 21:18:41:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 21:18:41:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 21:18:42:INFO:train samples: (1284,)
2024-06-13 21:18:42:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 21:18:42:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718284723 HTTP/1.1" 200 235
2024-06-13 21:18:43:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 21:18:43:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 21:18:44:INFO:valid samples: (229,)
2024-06-13 21:18:44:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 21:18:44:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718284724 HTTP/1.1" 200 235
2024-06-13 21:18:44:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 21:18:45:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 21:18:45:INFO:test samples: (686,)
2024-06-13 21:18:45:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 21:18:45:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718284726 HTTP/1.1" 200 235
2024-06-13 21:18:46:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 21:18:46:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 21:18:46:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 21:18:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718284727 HTTP/1.1" 200 235
2024-06-13 21:18:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 21:18:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 21:18:47:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-13 21:18:47:WARNING:Try importing flash-attention for faster inference...
2024-06-13 21:18:47:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-13 21:18:47:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-13 21:18:47:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-13 21:18:49:INFO:trainable params: 1310288 || all params: 1838138960 || trainable%: 0.07128340286090232
2024-06-13 21:18:49:INFO:Init labels...
2024-06-13 21:18:49:INFO:Start training...
2024-06-13 21:19:03:INFO:TRAIN-(cmcm) (1/1/1)>> loss: 2.3262
2024-06-13 21:19:06:INFO:VAL-(cmcm) >>
2024-06-13 21:19:06:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.5317  Non0_acc_2: 0.5648  Non0_F1_score: 0.5168  Mult_acc_5: 0.1616  Mult_acc_7: 0.1616  MAE: 1.5842  Corr: 0.0373 
2024-06-13 21:19:06:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-13 21:19:21:INFO:TRAIN-(cmcm) (1/2/1)>> loss: 0.9069
2024-06-13 21:19:24:INFO:VAL-(cmcm) >>
2024-06-13 21:19:24:INFO:M: >>  Has0_acc_2: 0.4017  Has0_F1_score: 0.2303  Non0_acc_2: 0.4259  Non0_F1_score: 0.2544  Mult_acc_5: 0.1310  Mult_acc_7: 0.1310  MAE: 1.7960  Corr: -0.0176 
2024-06-13 21:19:39:INFO:TRAIN-(cmcm) (2/3/1)>> loss: 0.8962
2024-06-13 21:19:41:INFO:VAL-(cmcm) >>
2024-06-13 21:19:41:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4556  Non0_acc_2: 0.5741  Non0_F1_score: 0.4269  Mult_acc_5: 0.1659  Mult_acc_7: 0.1659  MAE: 1.5765  Corr: -0.0137 
2024-06-13 21:19:42:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-mosi-regression.pth.
2024-06-13 21:19:57:INFO:TRAIN-(cmcm) (1/4/1)>> loss: 0.8851
2024-06-13 21:19:59:INFO:VAL-(cmcm) >>
2024-06-13 21:19:59:INFO:M: >>  Has0_acc_2: 0.5415  Has0_F1_score: 0.5392  Non0_acc_2: 0.5185  Non0_F1_score: 0.5161  Mult_acc_5: 0.1790  Mult_acc_7: 0.1790  MAE: 1.5864  Corr: -0.0159 
2024-06-13 21:20:14:INFO:TRAIN-(cmcm) (2/5/1)>> loss: 0.8754
2024-06-13 21:20:17:INFO:VAL-(cmcm) >>
2024-06-13 21:20:17:INFO:M: >>  Has0_acc_2: 0.5502  Has0_F1_score: 0.5540  Non0_acc_2: 0.5556  Non0_F1_score: 0.5574  Mult_acc_5: 0.2227  Mult_acc_7: 0.2009  MAE: 1.6420  Corr: 0.0700 
2024-06-13 21:20:31:INFO:TRAIN-(cmcm) (3/6/1)>> loss: 0.8774
2024-06-13 21:20:34:INFO:VAL-(cmcm) >>
2024-06-13 21:20:34:INFO:M: >>  Has0_acc_2: 0.6245  Has0_F1_score: 0.5599  Non0_acc_2: 0.6111  Non0_F1_score: 0.5432  Mult_acc_5: 0.2664  Mult_acc_7: 0.2140  MAE: 1.5324  Corr: 0.0946 
2024-06-13 21:20:34:INFO:Saving checkpoint at epoch 6 to results/models/cmcm-mosi-regression.pth.
2024-06-13 21:20:49:INFO:TRAIN-(cmcm) (1/7/1)>> loss: 0.8748
2024-06-13 21:20:52:INFO:VAL-(cmcm) >>
2024-06-13 21:20:52:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.5002  Non0_acc_2: 0.5833  Non0_F1_score: 0.4739  Mult_acc_5: 0.2926  Mult_acc_7: 0.2140  MAE: 1.6595  Corr: 0.0269 
2024-06-13 21:21:06:INFO:TRAIN-(cmcm) (2/8/1)>> loss: 0.8724
2024-06-13 21:21:09:INFO:VAL-(cmcm) >>
2024-06-13 21:21:09:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5282  Non0_acc_2: 0.5509  Non0_F1_score: 0.5282  Mult_acc_5: 0.1616  Mult_acc_7: 0.1616  MAE: 1.5043  Corr: 0.0213 
2024-06-13 21:21:09:INFO:Saving checkpoint at epoch 8 to results/models/cmcm-mosi-regression.pth.
2024-06-13 21:21:24:INFO:TRAIN-(cmcm) (1/9/1)>> loss: 0.8671
2024-06-13 21:21:27:INFO:VAL-(cmcm) >>
2024-06-13 21:21:27:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5741  Non0_F1_score: 0.4187  Mult_acc_5: 0.2533  Mult_acc_7: 0.1790  MAE: 1.6861  Corr: -0.0040 
2024-06-13 21:21:42:INFO:TRAIN-(cmcm) (2/10/1)>> loss: 0.8623
2024-06-13 21:21:44:INFO:VAL-(cmcm) >>
2024-06-13 21:21:44:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4767  Non0_acc_2: 0.5741  Non0_F1_score: 0.4491  Mult_acc_5: 0.2926  Mult_acc_7: 0.2096  MAE: 1.7826  Corr: -0.0040 
2024-06-13 21:21:59:INFO:TRAIN-(cmcm) (3/11/1)>> loss: 0.8676
2024-06-13 21:22:02:INFO:VAL-(cmcm) >>
2024-06-13 21:22:02:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5449  Non0_acc_2: 0.5602  Non0_F1_score: 0.5309  Mult_acc_5: 0.2445  Mult_acc_7: 0.1659  MAE: 1.7590  Corr: 0.0335 
2024-06-13 21:22:16:INFO:TRAIN-(cmcm) (4/12/1)>> loss: 0.8586
2024-06-13 21:22:19:INFO:VAL-(cmcm) >>
2024-06-13 21:22:19:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5741  Non0_F1_score: 0.4187  Mult_acc_5: 0.2707  Mult_acc_7: 0.2314  MAE: 1.4322  Corr: 0.1382 
2024-06-13 21:22:19:INFO:Saving checkpoint at epoch 12 to results/models/cmcm-mosi-regression.pth.
2024-06-13 21:22:34:INFO:TRAIN-(cmcm) (1/13/1)>> loss: 0.8552
2024-06-13 21:22:37:INFO:VAL-(cmcm) >>
2024-06-13 21:22:37:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5381  Non0_acc_2: 0.5648  Non0_F1_score: 0.5201  Mult_acc_5: 0.2795  Mult_acc_7: 0.2009  MAE: 1.7446  Corr: 0.0122 
2024-06-13 21:22:51:INFO:TRAIN-(cmcm) (2/14/1)>> loss: 0.8547
2024-06-13 21:22:54:INFO:VAL-(cmcm) >>
2024-06-13 21:22:54:INFO:M: >>  Has0_acc_2: 0.5371  Has0_F1_score: 0.5229  Non0_acc_2: 0.5324  Non0_F1_score: 0.5171  Mult_acc_5: 0.1878  Mult_acc_7: 0.1878  MAE: 1.5549  Corr: -0.0180 
2024-06-13 21:23:09:INFO:TRAIN-(cmcm) (3/15/1)>> loss: 0.8587
2024-06-13 21:23:11:INFO:VAL-(cmcm) >>
2024-06-13 21:23:11:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.5059  Non0_acc_2: 0.5833  Non0_F1_score: 0.4799  Mult_acc_5: 0.3013  Mult_acc_7: 0.2183  MAE: 1.7468  Corr: 0.0510 
2024-06-13 21:23:26:INFO:TRAIN-(cmcm) (4/16/1)>> loss: 0.8509
2024-06-13 21:23:29:INFO:VAL-(cmcm) >>
2024-06-13 21:23:29:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.5278  Non0_acc_2: 0.5370  Non0_F1_score: 0.5209  Mult_acc_5: 0.1921  Mult_acc_7: 0.1921  MAE: 1.4715  Corr: 0.0969 
2024-06-13 21:23:43:INFO:TRAIN-(cmcm) (5/17/1)>> loss: 0.8483
2024-06-13 21:23:46:INFO:VAL-(cmcm) >>
2024-06-13 21:23:46:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.4943  Non0_acc_2: 0.5093  Non0_F1_score: 0.5118  Mult_acc_5: 0.2052  Mult_acc_7: 0.2052  MAE: 1.4883  Corr: 0.0202 
2024-06-13 21:24:01:INFO:TRAIN-(cmcm) (6/18/1)>> loss: 0.8468
2024-06-13 21:24:03:INFO:VAL-(cmcm) >>
2024-06-13 21:24:03:INFO:M: >>  Has0_acc_2: 0.5415  Has0_F1_score: 0.5084  Non0_acc_2: 0.5694  Non0_F1_score: 0.5385  Mult_acc_5: 0.2489  Mult_acc_7: 0.1965  MAE: 1.4913  Corr: 0.2906 
2024-06-13 21:24:18:INFO:TRAIN-(cmcm) (7/19/1)>> loss: 0.8391
2024-06-13 21:24:20:INFO:VAL-(cmcm) >>
2024-06-13 21:24:20:INFO:M: >>  Has0_acc_2: 0.6419  Has0_F1_score: 0.5684  Non0_acc_2: 0.6343  Non0_F1_score: 0.5556  Mult_acc_5: 0.3188  Mult_acc_7: 0.2358  MAE: 1.5459  Corr: 0.2333 
2024-06-13 21:24:35:INFO:TRAIN-(cmcm) (8/20/1)>> loss: 0.8272
2024-06-13 21:24:38:INFO:VAL-(cmcm) >>
2024-06-13 21:24:38:INFO:M: >>  Has0_acc_2: 0.6332  Has0_F1_score: 0.5534  Non0_acc_2: 0.6157  Non0_F1_score: 0.5331  Mult_acc_5: 0.2620  Mult_acc_7: 0.2140  MAE: 1.4926  Corr: 0.2827 
2024-06-13 21:24:52:INFO:TRAIN-(cmcm) (9/21/1)>> loss: 0.8126
2024-06-13 21:24:55:INFO:VAL-(cmcm) >>
2024-06-13 21:24:55:INFO:M: >>  Has0_acc_2: 0.6681  Has0_F1_score: 0.6411  Non0_acc_2: 0.6574  Non0_F1_score: 0.6294  Mult_acc_5: 0.3188  Mult_acc_7: 0.2358  MAE: 1.5023  Corr: 0.2648 
2024-06-13 21:25:10:INFO:TRAIN-(cmcm) (10/22/1)>> loss: 0.8054
2024-06-13 21:25:12:INFO:VAL-(cmcm) >>
2024-06-13 21:25:12:INFO:M: >>  Has0_acc_2: 0.6943  Has0_F1_score: 0.6560  Non0_acc_2: 0.6944  Non0_F1_score: 0.6583  Mult_acc_5: 0.3362  Mult_acc_7: 0.2795  MAE: 1.2560  Corr: 0.4591 
2024-06-13 21:25:13:INFO:Saving checkpoint at epoch 22 to results/models/cmcm-mosi-regression.pth.
2024-06-13 21:25:28:INFO:TRAIN-(cmcm) (1/23/1)>> loss: 0.7966
2024-06-13 21:25:30:INFO:VAL-(cmcm) >>
2024-06-13 21:25:30:INFO:M: >>  Has0_acc_2: 0.6507  Has0_F1_score: 0.5975  Non0_acc_2: 0.6481  Non0_F1_score: 0.5939  Mult_acc_5: 0.3450  Mult_acc_7: 0.2576  MAE: 1.5101  Corr: 0.3273 
2024-06-13 21:25:45:INFO:TRAIN-(cmcm) (2/24/1)>> loss: 0.7816
2024-06-13 21:25:47:INFO:VAL-(cmcm) >>
2024-06-13 21:25:47:INFO:M: >>  Has0_acc_2: 0.6943  Has0_F1_score: 0.6417  Non0_acc_2: 0.6806  Non0_F1_score: 0.6359  Mult_acc_5: 0.3668  Mult_acc_7: 0.3057  MAE: 1.2582  Corr: 0.4544 
2024-06-13 21:26:02:INFO:TRAIN-(cmcm) (3/25/1)>> loss: 0.7753
2024-06-13 21:26:05:INFO:VAL-(cmcm) >>
2024-06-13 21:26:05:INFO:M: >>  Has0_acc_2: 0.6725  Has0_F1_score: 0.6211  Non0_acc_2: 0.6759  Non0_F1_score: 0.6291  Mult_acc_5: 0.3755  Mult_acc_7: 0.3188  MAE: 1.1795  Corr: 0.4921 
2024-06-13 21:26:05:INFO:Saving checkpoint at epoch 25 to results/models/cmcm-mosi-regression.pth.
2024-06-13 21:26:20:INFO:TRAIN-(cmcm) (1/26/1)>> loss: 0.7607
2024-06-13 21:26:23:INFO:VAL-(cmcm) >>
2024-06-13 21:26:23:INFO:M: >>  Has0_acc_2: 0.7031  Has0_F1_score: 0.6658  Non0_acc_2: 0.7546  Non0_F1_score: 0.7554  Mult_acc_5: 0.3668  Mult_acc_7: 0.3013  MAE: 1.1337  Corr: 0.5197 
2024-06-13 21:26:24:INFO:Saving checkpoint at epoch 26 to results/models/cmcm-mosi-regression.pth.
2024-06-13 21:26:39:INFO:TRAIN-(cmcm) (1/27/1)>> loss: 0.7554
2024-06-13 21:26:41:INFO:VAL-(cmcm) >>
2024-06-13 21:26:41:INFO:M: >>  Has0_acc_2: 0.7205  Has0_F1_score: 0.7232  Non0_acc_2: 0.6296  Non0_F1_score: 0.6213  Mult_acc_5: 0.3406  Mult_acc_7: 0.2707  MAE: 1.1691  Corr: 0.4999 
2024-06-13 21:26:56:INFO:TRAIN-(cmcm) (2/28/1)>> loss: 0.7556
2024-06-13 21:26:59:INFO:VAL-(cmcm) >>
2024-06-13 21:26:59:INFO:M: >>  Has0_acc_2: 0.7467  Has0_F1_score: 0.7487  Non0_acc_2: 0.7130  Non0_F1_score: 0.7137  Mult_acc_5: 0.3712  Mult_acc_7: 0.3144  MAE: 1.1595  Corr: 0.4874 
2024-06-13 21:27:13:INFO:TRAIN-(cmcm) (3/29/1)>> loss: 0.7317
2024-06-13 21:27:16:INFO:VAL-(cmcm) >>
2024-06-13 21:27:16:INFO:M: >>  Has0_acc_2: 0.7642  Has0_F1_score: 0.7646  Non0_acc_2: 0.6389  Non0_F1_score: 0.6257  Mult_acc_5: 0.3668  Mult_acc_7: 0.3100  MAE: 1.1276  Corr: 0.5672 
2024-06-13 21:27:16:INFO:Saving checkpoint at epoch 29 to results/models/cmcm-mosi-regression.pth.
2024-06-13 21:27:31:INFO:TRAIN-(cmcm) (1/30/1)>> loss: 0.7360
2024-06-13 21:27:34:INFO:VAL-(cmcm) >>
2024-06-13 21:27:34:INFO:M: >>  Has0_acc_2: 0.7162  Has0_F1_score: 0.6989  Non0_acc_2: 0.6667  Non0_F1_score: 0.6667  Mult_acc_5: 0.3886  Mult_acc_7: 0.3231  MAE: 1.1416  Corr: 0.5136 
2024-06-13 21:27:49:INFO:TRAIN-(cmcm) (2/31/1)>> loss: 0.7190
2024-06-13 21:27:51:INFO:VAL-(cmcm) >>
2024-06-13 21:27:51:INFO:M: >>  Has0_acc_2: 0.7642  Has0_F1_score: 0.7587  Non0_acc_2: 0.7546  Non0_F1_score: 0.7514  Mult_acc_5: 0.4061  Mult_acc_7: 0.3275  MAE: 1.0970  Corr: 0.5485 
2024-06-13 21:27:52:INFO:Saving checkpoint at epoch 31 to results/models/cmcm-mosi-regression.pth.
2024-06-13 21:28:07:INFO:TRAIN-(cmcm) (1/32/1)>> loss: 0.7195
2024-06-13 21:28:09:INFO:VAL-(cmcm) >>
2024-06-13 21:28:09:INFO:M: >>  Has0_acc_2: 0.7555  Has0_F1_score: 0.7527  Non0_acc_2: 0.6296  Non0_F1_score: 0.6263  Mult_acc_5: 0.3231  Mult_acc_7: 0.2882  MAE: 1.1860  Corr: 0.4787 
2024-06-13 21:28:24:INFO:TRAIN-(cmcm) (2/33/1)>> loss: 0.7250
2024-06-13 21:28:27:INFO:VAL-(cmcm) >>
2024-06-13 21:28:27:INFO:M: >>  Has0_acc_2: 0.7511  Has0_F1_score: 0.7439  Non0_acc_2: 0.7222  Non0_F1_score: 0.7222  Mult_acc_5: 0.3974  Mult_acc_7: 0.3188  MAE: 1.1451  Corr: 0.5241 
2024-06-13 21:28:41:INFO:TRAIN-(cmcm) (3/34/1)>> loss: 0.7124
2024-06-13 21:28:44:INFO:VAL-(cmcm) >>
2024-06-13 21:28:44:INFO:M: >>  Has0_acc_2: 0.7031  Has0_F1_score: 0.6769  Non0_acc_2: 0.7176  Non0_F1_score: 0.7019  Mult_acc_5: 0.3930  Mult_acc_7: 0.3275  MAE: 1.1621  Corr: 0.5010 
2024-06-13 21:28:59:INFO:TRAIN-(cmcm) (4/35/1)>> loss: 0.6933
2024-06-13 21:29:01:INFO:VAL-(cmcm) >>
2024-06-13 21:29:01:INFO:M: >>  Has0_acc_2: 0.7467  Has0_F1_score: 0.7369  Non0_acc_2: 0.6713  Non0_F1_score: 0.6719  Mult_acc_5: 0.4017  Mult_acc_7: 0.3406  MAE: 1.1555  Corr: 0.4818 
2024-06-13 21:29:16:INFO:TRAIN-(cmcm) (5/36/1)>> loss: 0.6967
2024-06-13 21:29:19:INFO:VAL-(cmcm) >>
2024-06-13 21:29:19:INFO:M: >>  Has0_acc_2: 0.7555  Has0_F1_score: 0.7550  Non0_acc_2: 0.7315  Non0_F1_score: 0.7326  Mult_acc_5: 0.3493  Mult_acc_7: 0.3100  MAE: 1.1392  Corr: 0.5064 
2024-06-13 21:29:33:INFO:TRAIN-(cmcm) (6/37/1)>> loss: 0.6970
2024-06-13 21:29:36:INFO:VAL-(cmcm) >>
2024-06-13 21:29:36:INFO:M: >>  Has0_acc_2: 0.7467  Has0_F1_score: 0.7452  Non0_acc_2: 0.6667  Non0_F1_score: 0.6650  Mult_acc_5: 0.3886  Mult_acc_7: 0.3319  MAE: 1.1132  Corr: 0.5272 
2024-06-13 21:29:51:INFO:TRAIN-(cmcm) (7/38/1)>> loss: 0.6886
2024-06-13 21:29:53:INFO:VAL-(cmcm) >>
2024-06-13 21:29:53:INFO:M: >>  Has0_acc_2: 0.7205  Has0_F1_score: 0.6940  Non0_acc_2: 0.6759  Non0_F1_score: 0.6773  Mult_acc_5: 0.3930  Mult_acc_7: 0.3144  MAE: 1.1512  Corr: 0.5063 
2024-06-13 21:30:08:INFO:TRAIN-(cmcm) (8/39/1)>> loss: 0.6802
2024-06-13 21:30:10:INFO:VAL-(cmcm) >>
2024-06-13 21:30:10:INFO:M: >>  Has0_acc_2: 0.7205  Has0_F1_score: 0.7194  Non0_acc_2: 0.7083  Non0_F1_score: 0.7094  Mult_acc_5: 0.3624  Mult_acc_7: 0.2969  MAE: 1.1542  Corr: 0.5172 
2024-06-13 21:30:25:INFO:TRAIN-(cmcm) (9/40/1)>> loss: 0.6677
2024-06-13 21:30:28:INFO:VAL-(cmcm) >>
2024-06-13 21:30:28:INFO:M: >>  Has0_acc_2: 0.7686  Has0_F1_score: 0.7643  Non0_acc_2: 0.6944  Non0_F1_score: 0.6944  Mult_acc_5: 0.3668  Mult_acc_7: 0.3013  MAE: 1.1397  Corr: 0.5084 
2024-06-13 21:30:43:INFO:TRAIN-(cmcm) (10/41/1)>> loss: 0.6656
2024-06-13 21:30:45:INFO:VAL-(cmcm) >>
2024-06-13 21:30:45:INFO:M: >>  Has0_acc_2: 0.7467  Has0_F1_score: 0.7446  Non0_acc_2: 0.7222  Non0_F1_score: 0.7229  Mult_acc_5: 0.3581  Mult_acc_7: 0.3057  MAE: 1.1643  Corr: 0.4886 
2024-06-13 21:30:53:INFO:TEST-(cmcm) >>
2024-06-13 21:30:53:INFO:M: >>  Has0_acc_2: 0.6880  Has0_F1_score: 0.6870  Non0_acc_2: 0.6875  Non0_F1_score: 0.6890  Mult_acc_5: 0.3324  Mult_acc_7: 0.2988  MAE: 1.2405  Corr: 0.4616 
2024-06-13 21:30:53:INFO:Results are added to results/results/mosi-regression-100.csv...
2024-06-13 21:30:53:INFO:Start running cmcm...
2024-06-13 21:30:53:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 6, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 100, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 2222}>
2024-06-13 21:30:53:INFO:Let's use the GPU 1 !
2024-06-13 21:30:53:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 21:30:54:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718285454 HTTP/1.1" 200 235
2024-06-13 21:30:54:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 21:30:54:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 21:30:55:INFO:train samples: (1284,)
2024-06-13 21:30:55:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 21:30:55:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718285455 HTTP/1.1" 200 235
2024-06-13 21:30:55:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 21:30:56:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 21:30:56:INFO:valid samples: (229,)
2024-06-13 21:30:56:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 21:30:57:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718285457 HTTP/1.1" 200 235
2024-06-13 21:30:57:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 21:30:57:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 21:30:58:INFO:test samples: (686,)
2024-06-13 21:30:58:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 21:30:58:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718285458 HTTP/1.1" 200 235
2024-06-13 21:30:58:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 21:30:59:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 21:30:59:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 21:30:59:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718285460 HTTP/1.1" 200 235
2024-06-13 21:31:00:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 21:31:01:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 21:31:01:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-13 21:31:01:WARNING:Try importing flash-attention for faster inference...
2024-06-13 21:31:01:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-13 21:31:01:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-13 21:31:01:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-13 21:31:02:INFO:trainable params: 1310288 || all params: 1838138960 || trainable%: 0.07128340286090232
2024-06-13 21:31:02:INFO:Init labels...
2024-06-13 21:31:02:INFO:Start training...
2024-06-13 21:31:17:INFO:TRAIN-(cmcm) (1/1/2)>> loss: 2.2972
2024-06-13 21:31:20:INFO:VAL-(cmcm) >>
2024-06-13 21:31:20:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5449  Non0_acc_2: 0.5602  Non0_F1_score: 0.5334  Mult_acc_5: 0.1878  Mult_acc_7: 0.1747  MAE: 1.5480  Corr: 0.0596 
2024-06-13 21:31:20:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-13 21:31:35:INFO:TRAIN-(cmcm) (1/2/2)>> loss: 0.9809
2024-06-13 21:31:38:INFO:VAL-(cmcm) >>
2024-06-13 21:31:38:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.5292  Non0_acc_2: 0.5926  Non0_F1_score: 0.5215  Mult_acc_5: 0.1965  Mult_acc_7: 0.1965  MAE: 1.4506  Corr: 0.0562 
2024-06-13 21:31:38:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-13 21:31:53:INFO:TRAIN-(cmcm) (1/3/2)>> loss: 1.0085
2024-06-13 21:31:56:INFO:VAL-(cmcm) >>
2024-06-13 21:31:56:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.4396  Non0_acc_2: 0.5556  Non0_F1_score: 0.4101  Mult_acc_5: 0.2140  Mult_acc_7: 0.1834  MAE: 1.6615  Corr: -0.1020 
2024-06-13 21:32:10:INFO:TRAIN-(cmcm) (2/4/2)>> loss: 0.9506
2024-06-13 21:32:13:INFO:VAL-(cmcm) >>
2024-06-13 21:32:13:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5349  Non0_acc_2: 0.5648  Non0_F1_score: 0.5168  Mult_acc_5: 0.2882  Mult_acc_7: 0.2052  MAE: 1.7817  Corr: 0.0239 
2024-06-13 21:32:28:INFO:TRAIN-(cmcm) (3/5/2)>> loss: 0.9120
2024-06-13 21:32:30:INFO:VAL-(cmcm) >>
2024-06-13 21:32:30:INFO:M: >>  Has0_acc_2: 0.5197  Has0_F1_score: 0.5127  Non0_acc_2: 0.5231  Non0_F1_score: 0.5117  Mult_acc_5: 0.1834  Mult_acc_7: 0.1834  MAE: 1.5724  Corr: 0.0323 
2024-06-13 21:32:45:INFO:TRAIN-(cmcm) (4/6/2)>> loss: 0.9022
2024-06-13 21:32:48:INFO:VAL-(cmcm) >>
2024-06-13 21:32:48:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.5806  Non0_acc_2: 0.5093  Non0_F1_score: 0.5085  Mult_acc_5: 0.1747  Mult_acc_7: 0.1703  MAE: 1.5554  Corr: 0.0795 
2024-06-13 21:33:03:INFO:TRAIN-(cmcm) (5/7/2)>> loss: 0.8915
2024-06-13 21:33:05:INFO:VAL-(cmcm) >>
2024-06-13 21:33:05:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5741  Non0_F1_score: 0.4187  Mult_acc_5: 0.2576  Mult_acc_7: 0.1834  MAE: 1.7520  Corr: -0.0290 
2024-06-13 21:33:20:INFO:TRAIN-(cmcm) (6/8/2)>> loss: 0.8860
2024-06-13 21:33:22:INFO:VAL-(cmcm) >>
2024-06-13 21:33:22:INFO:M: >>  Has0_acc_2: 0.4891  Has0_F1_score: 0.4709  Non0_acc_2: 0.5000  Non0_F1_score: 0.4776  Mult_acc_5: 0.1878  Mult_acc_7: 0.1703  MAE: 1.7619  Corr: 0.0872 
2024-06-13 21:33:37:INFO:TRAIN-(cmcm) (7/9/2)>> loss: 0.8912
2024-06-13 21:33:40:INFO:VAL-(cmcm) >>
2024-06-13 21:33:40:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.5413  Non0_acc_2: 0.5694  Non0_F1_score: 0.5236  Mult_acc_5: 0.2751  Mult_acc_7: 0.1921  MAE: 1.7765  Corr: 0.0299 
2024-06-13 21:33:55:INFO:TRAIN-(cmcm) (8/10/2)>> loss: 0.8848
2024-06-13 21:33:58:INFO:VAL-(cmcm) >>
2024-06-13 21:33:58:INFO:M: >>  Has0_acc_2: 0.5459  Has0_F1_score: 0.5497  Non0_acc_2: 0.5509  Non0_F1_score: 0.5526  Mult_acc_5: 0.2533  Mult_acc_7: 0.1659  MAE: 1.7988  Corr: 0.0892 
2024-06-13 21:34:13:INFO:TRAIN-(cmcm) (9/11/2)>> loss: 0.8744
2024-06-13 21:34:16:INFO:VAL-(cmcm) >>
2024-06-13 21:34:16:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5209  Non0_acc_2: 0.5648  Non0_F1_score: 0.5597  Mult_acc_5: 0.2664  Mult_acc_7: 0.2140  MAE: 1.5171  Corr: 0.1022 
2024-06-13 21:34:31:INFO:TRAIN-(cmcm) (10/12/2)>> loss: 0.8602
2024-06-13 21:34:33:INFO:VAL-(cmcm) >>
2024-06-13 21:34:33:INFO:M: >>  Has0_acc_2: 0.6245  Has0_F1_score: 0.5279  Non0_acc_2: 0.6065  Non0_F1_score: 0.5115  Mult_acc_5: 0.2271  Mult_acc_7: 0.2096  MAE: 1.4768  Corr: 0.2058 
2024-06-13 21:34:41:INFO:TEST-(cmcm) >>
2024-06-13 21:34:41:INFO:M: >>  Has0_acc_2: 0.4694  Has0_F1_score: 0.3612  Non0_acc_2: 0.4543  Non0_F1_score: 0.3600  Mult_acc_5: 0.1720  Mult_acc_7: 0.1720  MAE: 1.7148  Corr: 0.0121 
2024-06-13 21:34:42:INFO:Results are added to results/results/mosi-regression-100.csv...
2024-06-13 21:34:42:INFO:Start running cmcm...
2024-06-13 21:34:42:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 6, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 100, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 3333}>
2024-06-13 21:34:42:INFO:Let's use the GPU 1 !
2024-06-13 21:34:42:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 21:34:42:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718285682 HTTP/1.1" 200 235
2024-06-13 21:34:42:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 21:34:43:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 21:34:44:INFO:train samples: (1284,)
2024-06-13 21:34:44:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 21:34:44:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718285684 HTTP/1.1" 200 235
2024-06-13 21:34:44:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 21:34:45:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 21:34:45:INFO:valid samples: (229,)
2024-06-13 21:34:45:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 21:34:46:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718285686 HTTP/1.1" 200 235
2024-06-13 21:34:46:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 21:34:46:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 21:34:47:INFO:test samples: (686,)
2024-06-13 21:34:47:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 21:34:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718285687 HTTP/1.1" 200 235
2024-06-13 21:34:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 21:34:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 21:34:48:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 21:34:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718285689 HTTP/1.1" 200 235
2024-06-13 21:34:49:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 21:34:49:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 21:34:49:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-13 21:34:49:WARNING:Try importing flash-attention for faster inference...
2024-06-13 21:34:49:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-13 21:34:49:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-13 21:34:49:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-13 21:34:51:INFO:trainable params: 1310288 || all params: 1838138960 || trainable%: 0.07128340286090232
2024-06-13 21:34:51:INFO:Init labels...
2024-06-13 21:34:51:INFO:Start training...
2024-06-13 21:35:08:INFO:TRAIN-(cmcm) (1/1/3)>> loss: 2.6611
2024-06-13 21:35:11:INFO:VAL-(cmcm) >>
2024-06-13 21:35:11:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.4870  Non0_acc_2: 0.5648  Non0_F1_score: 0.4739  Mult_acc_5: 0.2402  Mult_acc_7: 0.2052  MAE: 1.7922  Corr: -0.0030 
2024-06-13 21:35:12:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-13 21:35:28:INFO:TRAIN-(cmcm) (1/2/3)>> loss: 0.9816
2024-06-13 21:35:31:INFO:VAL-(cmcm) >>
2024-06-13 21:35:31:INFO:M: >>  Has0_acc_2: 0.6070  Has0_F1_score: 0.4746  Non0_acc_2: 0.5833  Non0_F1_score: 0.4469  Mult_acc_5: 0.2795  Mult_acc_7: 0.2052  MAE: 1.7189  Corr: 0.0687 
2024-06-13 21:35:31:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-13 21:35:47:INFO:TRAIN-(cmcm) (1/3/3)>> loss: 0.9199
2024-06-13 21:35:49:INFO:VAL-(cmcm) >>
2024-06-13 21:35:49:INFO:M: >>  Has0_acc_2: 0.5590  Has0_F1_score: 0.5321  Non0_acc_2: 0.5417  Non0_F1_score: 0.5185  Mult_acc_5: 0.2358  Mult_acc_7: 0.1747  MAE: 1.7464  Corr: -0.0230 
2024-06-13 21:36:05:INFO:TRAIN-(cmcm) (2/4/3)>> loss: 0.8979
2024-06-13 21:36:07:INFO:VAL-(cmcm) >>
2024-06-13 21:36:07:INFO:M: >>  Has0_acc_2: 0.4891  Has0_F1_score: 0.4339  Non0_acc_2: 0.4583  Non0_F1_score: 0.3217  Mult_acc_5: 0.1528  Mult_acc_7: 0.1528  MAE: 1.7174  Corr: 0.1246 
2024-06-13 21:36:07:INFO:Saving checkpoint at epoch 4 to results/models/cmcm-mosi-regression.pth.
2024-06-13 21:36:23:INFO:TRAIN-(cmcm) (1/5/3)>> loss: 0.8873
2024-06-13 21:36:26:INFO:VAL-(cmcm) >>
2024-06-13 21:36:26:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4458  Non0_acc_2: 0.5694  Non0_F1_score: 0.4166  Mult_acc_5: 0.1747  Mult_acc_7: 0.1616  MAE: 1.5436  Corr: -0.0675 
2024-06-13 21:36:26:INFO:Saving checkpoint at epoch 5 to results/models/cmcm-mosi-regression.pth.
2024-06-13 21:36:42:INFO:TRAIN-(cmcm) (1/6/3)>> loss: 0.8750
2024-06-13 21:36:45:INFO:VAL-(cmcm) >>
2024-06-13 21:36:45:INFO:M: >>  Has0_acc_2: 0.5459  Has0_F1_score: 0.5395  Non0_acc_2: 0.5417  Non0_F1_score: 0.5330  Mult_acc_5: 0.2358  Mult_acc_7: 0.2052  MAE: 1.6449  Corr: 0.0143 
2024-06-13 21:37:00:INFO:TRAIN-(cmcm) (2/7/3)>> loss: 0.8774
2024-06-13 21:37:02:INFO:VAL-(cmcm) >>
2024-06-13 21:37:02:INFO:M: >>  Has0_acc_2: 0.5502  Has0_F1_score: 0.5469  Non0_acc_2: 0.5463  Non0_F1_score: 0.5409  Mult_acc_5: 0.2358  Mult_acc_7: 0.2096  MAE: 1.6149  Corr: 0.0172 
2024-06-13 21:37:17:INFO:TRAIN-(cmcm) (3/8/3)>> loss: 0.8763
2024-06-13 21:37:20:INFO:VAL-(cmcm) >>
2024-06-13 21:37:20:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.4817  Non0_acc_2: 0.5370  Non0_F1_score: 0.4562  Mult_acc_5: 0.2227  Mult_acc_7: 0.2052  MAE: 1.6091  Corr: -0.0958 
2024-06-13 21:37:35:INFO:TRAIN-(cmcm) (4/9/3)>> loss: 0.8698
2024-06-13 21:37:38:INFO:VAL-(cmcm) >>
2024-06-13 21:37:38:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4917  Non0_acc_2: 0.5787  Non0_F1_score: 0.4649  Mult_acc_5: 0.2358  Mult_acc_7: 0.1703  MAE: 1.6079  Corr: 0.0454 
2024-06-13 21:37:53:INFO:TRAIN-(cmcm) (5/10/3)>> loss: 0.8756
2024-06-13 21:37:55:INFO:VAL-(cmcm) >>
2024-06-13 21:37:55:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.4694  Non0_acc_2: 0.5602  Non0_F1_score: 0.4710  Mult_acc_5: 0.1965  Mult_acc_7: 0.1965  MAE: 1.4929  Corr: -0.0456 
2024-06-13 21:37:55:INFO:Saving checkpoint at epoch 10 to results/models/cmcm-mosi-regression.pth.
2024-06-13 21:38:11:INFO:TRAIN-(cmcm) (1/11/3)>> loss: 0.8664
2024-06-13 21:38:14:INFO:VAL-(cmcm) >>
2024-06-13 21:38:14:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5139  Non0_F1_score: 0.5135  Mult_acc_5: 0.2620  Mult_acc_7: 0.2140  MAE: 1.5014  Corr: 0.0210 
2024-06-13 21:38:29:INFO:TRAIN-(cmcm) (2/12/3)>> loss: 0.8619
2024-06-13 21:38:31:INFO:VAL-(cmcm) >>
2024-06-13 21:38:31:INFO:M: >>  Has0_acc_2: 0.5633  Has0_F1_score: 0.5249  Non0_acc_2: 0.5231  Non0_F1_score: 0.5183  Mult_acc_5: 0.2183  Mult_acc_7: 0.2140  MAE: 1.4916  Corr: 0.0440 
2024-06-13 21:38:32:INFO:Saving checkpoint at epoch 12 to results/models/cmcm-mosi-regression.pth.
2024-06-13 21:38:47:INFO:TRAIN-(cmcm) (1/13/3)>> loss: 0.8594
2024-06-13 21:38:50:INFO:VAL-(cmcm) >>
2024-06-13 21:38:50:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4978  Non0_acc_2: 0.5694  Non0_F1_score: 0.4713  Mult_acc_5: 0.2227  Mult_acc_7: 0.1965  MAE: 1.6206  Corr: -0.0119 
2024-06-13 21:39:05:INFO:TRAIN-(cmcm) (2/14/3)>> loss: 0.8525
2024-06-13 21:39:07:INFO:VAL-(cmcm) >>
2024-06-13 21:39:07:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5219  Non0_acc_2: 0.5602  Non0_F1_score: 0.5256  Mult_acc_5: 0.2227  Mult_acc_7: 0.2140  MAE: 1.5314  Corr: -0.0043 
2024-06-13 21:39:22:INFO:TRAIN-(cmcm) (3/15/3)>> loss: 0.8629
2024-06-13 21:39:25:INFO:VAL-(cmcm) >>
2024-06-13 21:39:25:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.4669  Non0_acc_2: 0.5602  Non0_F1_score: 0.4479  Mult_acc_5: 0.2707  Mult_acc_7: 0.2402  MAE: 1.6287  Corr: -0.0047 
2024-06-13 21:39:40:INFO:TRAIN-(cmcm) (4/16/3)>> loss: 0.8594
2024-06-13 21:39:43:INFO:VAL-(cmcm) >>
2024-06-13 21:39:43:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.4493  Non0_acc_2: 0.5602  Non0_F1_score: 0.4414  Mult_acc_5: 0.2707  Mult_acc_7: 0.2140  MAE: 1.7175  Corr: -0.1038 
2024-06-13 21:39:58:INFO:TRAIN-(cmcm) (5/17/3)>> loss: 0.8485
2024-06-13 21:40:00:INFO:VAL-(cmcm) >>
2024-06-13 21:40:00:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.4920  Non0_acc_2: 0.5556  Non0_F1_score: 0.4680  Mult_acc_5: 0.2969  Mult_acc_7: 0.2140  MAE: 1.7416  Corr: -0.0185 
2024-06-13 21:40:15:INFO:TRAIN-(cmcm) (6/18/3)>> loss: 0.8436
2024-06-13 21:40:18:INFO:VAL-(cmcm) >>
2024-06-13 21:40:18:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4950  Non0_acc_2: 0.5880  Non0_F1_score: 0.5224  Mult_acc_5: 0.3013  Mult_acc_7: 0.2227  MAE: 1.6787  Corr: 0.0250 
2024-06-13 21:40:33:INFO:TRAIN-(cmcm) (7/19/3)>> loss: 0.8352
2024-06-13 21:40:36:INFO:VAL-(cmcm) >>
2024-06-13 21:40:36:INFO:M: >>  Has0_acc_2: 0.6245  Has0_F1_score: 0.5862  Non0_acc_2: 0.6065  Non0_F1_score: 0.5780  Mult_acc_5: 0.2838  Mult_acc_7: 0.2314  MAE: 1.4935  Corr: 0.1178 
2024-06-13 21:40:51:INFO:TRAIN-(cmcm) (8/20/3)>> loss: 0.8324
2024-06-13 21:40:53:INFO:VAL-(cmcm) >>
2024-06-13 21:40:53:INFO:M: >>  Has0_acc_2: 0.5852  Has0_F1_score: 0.4694  Non0_acc_2: 0.5694  Non0_F1_score: 0.4465  Mult_acc_5: 0.2795  Mult_acc_7: 0.2009  MAE: 1.7328  Corr: 0.0033 
2024-06-13 21:41:09:INFO:TRAIN-(cmcm) (9/21/3)>> loss: 0.8322
2024-06-13 21:41:11:INFO:VAL-(cmcm) >>
2024-06-13 21:41:11:INFO:M: >>  Has0_acc_2: 0.6332  Has0_F1_score: 0.6233  Non0_acc_2: 0.6296  Non0_F1_score: 0.6182  Mult_acc_5: 0.2314  Mult_acc_7: 0.2314  MAE: 1.5490  Corr: 0.1565 
2024-06-13 21:41:26:INFO:TRAIN-(cmcm) (10/22/3)>> loss: 0.8311
2024-06-13 21:41:29:INFO:VAL-(cmcm) >>
2024-06-13 21:41:29:INFO:M: >>  Has0_acc_2: 0.6507  Has0_F1_score: 0.6069  Non0_acc_2: 0.6389  Non0_F1_score: 0.5962  Mult_acc_5: 0.2576  Mult_acc_7: 0.2314  MAE: 1.3926  Corr: 0.1772 
2024-06-13 21:41:29:INFO:Saving checkpoint at epoch 22 to results/models/cmcm-mosi-regression.pth.
2024-06-13 21:41:45:INFO:TRAIN-(cmcm) (1/23/3)>> loss: 0.8247
2024-06-13 21:41:47:INFO:VAL-(cmcm) >>
2024-06-13 21:41:47:INFO:M: >>  Has0_acc_2: 0.6419  Has0_F1_score: 0.6280  Non0_acc_2: 0.6481  Non0_F1_score: 0.6373  Mult_acc_5: 0.3057  Mult_acc_7: 0.2533  MAE: 1.4795  Corr: 0.1834 
2024-06-13 21:42:03:INFO:TRAIN-(cmcm) (2/24/3)>> loss: 0.8227
2024-06-13 21:42:05:INFO:VAL-(cmcm) >>
2024-06-13 21:42:05:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.5032  Non0_acc_2: 0.5972  Non0_F1_score: 0.5247  Mult_acc_5: 0.3275  Mult_acc_7: 0.2707  MAE: 1.4346  Corr: 0.1832 
2024-06-13 21:42:20:INFO:TRAIN-(cmcm) (3/25/3)>> loss: 0.8164
2024-06-13 21:42:23:INFO:VAL-(cmcm) >>
2024-06-13 21:42:23:INFO:M: >>  Has0_acc_2: 0.6419  Has0_F1_score: 0.6379  Non0_acc_2: 0.6065  Non0_F1_score: 0.6049  Mult_acc_5: 0.2664  Mult_acc_7: 0.2183  MAE: 1.5564  Corr: 0.1751 
2024-06-13 21:42:38:INFO:TRAIN-(cmcm) (4/26/3)>> loss: 0.8150
2024-06-13 21:42:41:INFO:VAL-(cmcm) >>
2024-06-13 21:42:41:INFO:M: >>  Has0_acc_2: 0.6507  Has0_F1_score: 0.6412  Non0_acc_2: 0.6481  Non0_F1_score: 0.6398  Mult_acc_5: 0.2969  Mult_acc_7: 0.2402  MAE: 1.4630  Corr: 0.2330 
2024-06-13 21:42:56:INFO:TRAIN-(cmcm) (5/27/3)>> loss: 0.8139
2024-06-13 21:42:58:INFO:VAL-(cmcm) >>
2024-06-13 21:42:58:INFO:M: >>  Has0_acc_2: 0.6245  Has0_F1_score: 0.5889  Non0_acc_2: 0.6111  Non0_F1_score: 0.5793  Mult_acc_5: 0.2926  Mult_acc_7: 0.2227  MAE: 1.6149  Corr: 0.1115 
2024-06-13 21:43:13:INFO:TRAIN-(cmcm) (6/28/3)>> loss: 0.8130
2024-06-13 21:43:16:INFO:VAL-(cmcm) >>
2024-06-13 21:43:16:INFO:M: >>  Has0_acc_2: 0.6157  Has0_F1_score: 0.4930  Non0_acc_2: 0.6111  Non0_F1_score: 0.5682  Mult_acc_5: 0.2795  Mult_acc_7: 0.2358  MAE: 1.5197  Corr: 0.0980 
2024-06-13 21:43:31:INFO:TRAIN-(cmcm) (7/29/3)>> loss: 0.8017
2024-06-13 21:43:34:INFO:VAL-(cmcm) >>
2024-06-13 21:43:34:INFO:M: >>  Has0_acc_2: 0.6114  Has0_F1_score: 0.5731  Non0_acc_2: 0.6111  Non0_F1_score: 0.5740  Mult_acc_5: 0.3013  Mult_acc_7: 0.2183  MAE: 1.7324  Corr: 0.0785 
2024-06-13 21:43:49:INFO:TRAIN-(cmcm) (8/30/3)>> loss: 0.8036
2024-06-13 21:43:51:INFO:VAL-(cmcm) >>
2024-06-13 21:43:51:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4742  Non0_acc_2: 0.6296  Non0_F1_score: 0.6081  Mult_acc_5: 0.3057  Mult_acc_7: 0.2533  MAE: 1.4830  Corr: 0.1435 
2024-06-13 21:44:06:INFO:TRAIN-(cmcm) (9/31/3)>> loss: 0.7955
2024-06-13 21:44:09:INFO:VAL-(cmcm) >>
2024-06-13 21:44:09:INFO:M: >>  Has0_acc_2: 0.5546  Has0_F1_score: 0.5573  Non0_acc_2: 0.5741  Non0_F1_score: 0.5751  Mult_acc_5: 0.2576  Mult_acc_7: 0.2183  MAE: 1.5368  Corr: 0.1582 
2024-06-13 21:44:24:INFO:TRAIN-(cmcm) (10/32/3)>> loss: 0.7904
2024-06-13 21:44:27:INFO:VAL-(cmcm) >>
2024-06-13 21:44:27:INFO:M: >>  Has0_acc_2: 0.6245  Has0_F1_score: 0.6098  Non0_acc_2: 0.6065  Non0_F1_score: 0.6056  Mult_acc_5: 0.2882  Mult_acc_7: 0.2751  MAE: 1.3349  Corr: 0.2507 
2024-06-13 21:44:27:INFO:Saving checkpoint at epoch 32 to results/models/cmcm-mosi-regression.pth.
2024-06-13 21:44:42:INFO:TRAIN-(cmcm) (1/33/3)>> loss: 0.7859
2024-06-13 21:44:45:INFO:VAL-(cmcm) >>
2024-06-13 21:44:45:INFO:M: >>  Has0_acc_2: 0.6812  Has0_F1_score: 0.6772  Non0_acc_2: 0.6898  Non0_F1_score: 0.6849  Mult_acc_5: 0.3144  Mult_acc_7: 0.2576  MAE: 1.4071  Corr: 0.3000 
2024-06-13 21:45:00:INFO:TRAIN-(cmcm) (2/34/3)>> loss: 0.7864
2024-06-13 21:45:03:INFO:VAL-(cmcm) >>
2024-06-13 21:45:03:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4652  Non0_acc_2: 0.5926  Non0_F1_score: 0.4663  Mult_acc_5: 0.2795  Mult_acc_7: 0.2227  MAE: 1.5761  Corr: 0.2002 
2024-06-13 21:45:18:INFO:TRAIN-(cmcm) (3/35/3)>> loss: 0.7748
2024-06-13 21:45:20:INFO:VAL-(cmcm) >>
2024-06-13 21:45:20:INFO:M: >>  Has0_acc_2: 0.6332  Has0_F1_score: 0.5931  Non0_acc_2: 0.5417  Non0_F1_score: 0.5306  Mult_acc_5: 0.2576  Mult_acc_7: 0.2445  MAE: 1.3634  Corr: 0.2243 
2024-06-13 21:45:35:INFO:TRAIN-(cmcm) (4/36/3)>> loss: 0.7736
2024-06-13 21:45:38:INFO:VAL-(cmcm) >>
2024-06-13 21:45:38:INFO:M: >>  Has0_acc_2: 0.6376  Has0_F1_score: 0.6390  Non0_acc_2: 0.6574  Non0_F1_score: 0.6563  Mult_acc_5: 0.3100  Mult_acc_7: 0.2620  MAE: 1.3647  Corr: 0.2724 
2024-06-13 21:45:53:INFO:TRAIN-(cmcm) (5/37/3)>> loss: 0.7613
2024-06-13 21:45:56:INFO:VAL-(cmcm) >>
2024-06-13 21:45:56:INFO:M: >>  Has0_acc_2: 0.6507  Has0_F1_score: 0.6008  Non0_acc_2: 0.6296  Non0_F1_score: 0.5827  Mult_acc_5: 0.3057  Mult_acc_7: 0.2314  MAE: 1.5084  Corr: 0.2045 
2024-06-13 21:46:11:INFO:TRAIN-(cmcm) (6/38/3)>> loss: 0.7735
2024-06-13 21:46:13:INFO:VAL-(cmcm) >>
2024-06-13 21:46:13:INFO:M: >>  Has0_acc_2: 0.6594  Has0_F1_score: 0.6294  Non0_acc_2: 0.6435  Non0_F1_score: 0.6155  Mult_acc_5: 0.3188  Mult_acc_7: 0.2489  MAE: 1.5267  Corr: 0.2184 
2024-06-13 21:46:28:INFO:TRAIN-(cmcm) (7/39/3)>> loss: 0.7501
2024-06-13 21:46:31:INFO:VAL-(cmcm) >>
2024-06-13 21:46:31:INFO:M: >>  Has0_acc_2: 0.6419  Has0_F1_score: 0.6416  Non0_acc_2: 0.5972  Non0_F1_score: 0.5800  Mult_acc_5: 0.2402  Mult_acc_7: 0.2183  MAE: 1.4777  Corr: 0.2942 
2024-06-13 21:46:46:INFO:TRAIN-(cmcm) (8/40/3)>> loss: 0.7385
2024-06-13 21:46:49:INFO:VAL-(cmcm) >>
2024-06-13 21:46:49:INFO:M: >>  Has0_acc_2: 0.6157  Has0_F1_score: 0.5456  Non0_acc_2: 0.6343  Non0_F1_score: 0.6139  Mult_acc_5: 0.3100  Mult_acc_7: 0.2620  MAE: 1.3957  Corr: 0.2364 
2024-06-13 21:47:04:INFO:TRAIN-(cmcm) (9/41/3)>> loss: 0.7293
2024-06-13 21:47:06:INFO:VAL-(cmcm) >>
2024-06-13 21:47:06:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.6020  Non0_acc_2: 0.6296  Non0_F1_score: 0.6317  Mult_acc_5: 0.3319  Mult_acc_7: 0.2926  MAE: 1.3717  Corr: 0.2540 
2024-06-13 21:47:22:INFO:TRAIN-(cmcm) (10/42/3)>> loss: 0.7377
2024-06-13 21:47:24:INFO:VAL-(cmcm) >>
2024-06-13 21:47:24:INFO:M: >>  Has0_acc_2: 0.6157  Has0_F1_score: 0.5973  Non0_acc_2: 0.6157  Non0_F1_score: 0.6031  Mult_acc_5: 0.2926  Mult_acc_7: 0.2620  MAE: 1.3223  Corr: 0.2855 
2024-06-13 21:47:24:INFO:Saving checkpoint at epoch 42 to results/models/cmcm-mosi-regression.pth.
2024-06-13 21:47:40:INFO:TRAIN-(cmcm) (1/43/3)>> loss: 0.7108
2024-06-13 21:47:42:INFO:VAL-(cmcm) >>
2024-06-13 21:47:42:INFO:M: >>  Has0_acc_2: 0.6332  Has0_F1_score: 0.6353  Non0_acc_2: 0.6574  Non0_F1_score: 0.6582  Mult_acc_5: 0.2707  Mult_acc_7: 0.2533  MAE: 1.3777  Corr: 0.2466 
2024-06-13 21:47:58:INFO:TRAIN-(cmcm) (2/44/3)>> loss: 0.7147
2024-06-13 21:48:00:INFO:VAL-(cmcm) >>
2024-06-13 21:48:00:INFO:M: >>  Has0_acc_2: 0.6288  Has0_F1_score: 0.5868  Non0_acc_2: 0.6250  Non0_F1_score: 0.6095  Mult_acc_5: 0.2838  Mult_acc_7: 0.2445  MAE: 1.4149  Corr: 0.2150 
2024-06-13 21:48:15:INFO:TRAIN-(cmcm) (3/45/3)>> loss: 0.6886
2024-06-13 21:48:18:INFO:VAL-(cmcm) >>
2024-06-13 21:48:18:INFO:M: >>  Has0_acc_2: 0.6288  Has0_F1_score: 0.6313  Non0_acc_2: 0.6528  Non0_F1_score: 0.6530  Mult_acc_5: 0.3013  Mult_acc_7: 0.2664  MAE: 1.4287  Corr: 0.3070 
2024-06-13 21:48:33:INFO:TRAIN-(cmcm) (4/46/3)>> loss: 0.6867
2024-06-13 21:48:36:INFO:VAL-(cmcm) >>
2024-06-13 21:48:36:INFO:M: >>  Has0_acc_2: 0.6376  Has0_F1_score: 0.6402  Non0_acc_2: 0.6806  Non0_F1_score: 0.6823  Mult_acc_5: 0.3188  Mult_acc_7: 0.2620  MAE: 1.3414  Corr: 0.3252 
2024-06-13 21:48:51:INFO:TRAIN-(cmcm) (5/47/3)>> loss: 0.6824
2024-06-13 21:48:53:INFO:VAL-(cmcm) >>
2024-06-13 21:48:53:INFO:M: >>  Has0_acc_2: 0.6550  Has0_F1_score: 0.6575  Non0_acc_2: 0.6713  Non0_F1_score: 0.6728  Mult_acc_5: 0.3144  Mult_acc_7: 0.2620  MAE: 1.3948  Corr: 0.2904 
2024-06-13 21:49:08:INFO:TRAIN-(cmcm) (6/48/3)>> loss: 0.6606
2024-06-13 21:49:11:INFO:VAL-(cmcm) >>
2024-06-13 21:49:11:INFO:M: >>  Has0_acc_2: 0.6419  Has0_F1_score: 0.6389  Non0_acc_2: 0.6343  Non0_F1_score: 0.6362  Mult_acc_5: 0.3100  Mult_acc_7: 0.2664  MAE: 1.3315  Corr: 0.3100 
2024-06-13 21:49:26:INFO:TRAIN-(cmcm) (7/49/3)>> loss: 0.6418
2024-06-13 21:49:28:INFO:VAL-(cmcm) >>
2024-06-13 21:49:28:INFO:M: >>  Has0_acc_2: 0.6245  Has0_F1_score: 0.6277  Non0_acc_2: 0.6528  Non0_F1_score: 0.6530  Mult_acc_5: 0.2795  Mult_acc_7: 0.2358  MAE: 1.4516  Corr: 0.2785 
2024-06-13 21:49:44:INFO:TRAIN-(cmcm) (8/50/3)>> loss: 0.6444
2024-06-13 21:49:46:INFO:VAL-(cmcm) >>
2024-06-13 21:49:46:INFO:M: >>  Has0_acc_2: 0.6288  Has0_F1_score: 0.6309  Non0_acc_2: 0.6528  Non0_F1_score: 0.6525  Mult_acc_5: 0.2838  Mult_acc_7: 0.2576  MAE: 1.4680  Corr: 0.2284 
2024-06-13 21:50:01:INFO:TRAIN-(cmcm) (9/51/3)>> loss: 0.6269
2024-06-13 21:50:04:INFO:VAL-(cmcm) >>
2024-06-13 21:50:04:INFO:M: >>  Has0_acc_2: 0.6201  Has0_F1_score: 0.6045  Non0_acc_2: 0.6157  Non0_F1_score: 0.6096  Mult_acc_5: 0.3057  Mult_acc_7: 0.2664  MAE: 1.4071  Corr: 0.2076 
2024-06-13 21:50:19:INFO:TRAIN-(cmcm) (10/52/3)>> loss: 0.6165
2024-06-13 21:50:21:INFO:VAL-(cmcm) >>
2024-06-13 21:50:21:INFO:M: >>  Has0_acc_2: 0.6288  Has0_F1_score: 0.6303  Non0_acc_2: 0.6343  Non0_F1_score: 0.6353  Mult_acc_5: 0.2882  Mult_acc_7: 0.2445  MAE: 1.5320  Corr: 0.1712 
2024-06-13 21:50:29:INFO:TEST-(cmcm) >>
2024-06-13 21:50:29:INFO:M: >>  Has0_acc_2: 0.6283  Has0_F1_score: 0.6262  Non0_acc_2: 0.6387  Non0_F1_score: 0.6399  Mult_acc_5: 0.2901  Mult_acc_7: 0.2653  MAE: 1.2930  Corr: 0.3768 
2024-06-13 21:50:29:INFO:Results are added to results/results/mosi-regression-100.csv...
2024-06-13 21:50:29:INFO:Start running cmcm...
2024-06-13 21:50:29:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 6, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 100, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 4444}>
2024-06-13 21:50:29:INFO:Let's use the GPU 1 !
2024-06-13 21:50:30:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 21:50:30:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718286630 HTTP/1.1" 200 235
2024-06-13 21:50:30:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 21:50:30:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 21:50:31:INFO:train samples: (1284,)
2024-06-13 21:50:31:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 21:50:32:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718286632 HTTP/1.1" 200 235
2024-06-13 21:50:32:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 21:50:32:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 21:50:33:INFO:valid samples: (229,)
2024-06-13 21:50:33:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 21:50:34:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718286634 HTTP/1.1" 200 235
2024-06-13 21:50:34:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 21:50:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 21:50:35:INFO:test samples: (686,)
2024-06-13 21:50:35:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 21:50:36:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718286636 HTTP/1.1" 200 235
2024-06-13 21:50:36:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 21:50:36:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 21:50:37:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 21:50:37:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718286638 HTTP/1.1" 200 235
2024-06-13 21:50:38:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 21:50:38:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 21:50:38:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-13 21:50:38:WARNING:Try importing flash-attention for faster inference...
2024-06-13 21:50:38:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-13 21:50:38:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-13 21:50:38:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-13 21:50:40:INFO:trainable params: 1310288 || all params: 1838138960 || trainable%: 0.07128340286090232
2024-06-13 21:50:40:INFO:Init labels...
2024-06-13 21:50:40:INFO:Start training...
2024-06-13 21:50:55:INFO:TRAIN-(cmcm) (1/1/4)>> loss: 3.0786
2024-06-13 21:50:58:INFO:VAL-(cmcm) >>
2024-06-13 21:50:58:INFO:M: >>  Has0_acc_2: 0.6288  Has0_F1_score: 0.6020  Non0_acc_2: 0.6157  Non0_F1_score: 0.5879  Mult_acc_5: 0.1834  Mult_acc_7: 0.1790  MAE: 1.5178  Corr: 0.1127 
2024-06-13 21:50:58:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-13 21:51:13:INFO:TRAIN-(cmcm) (1/2/4)>> loss: 1.0004
2024-06-13 21:51:16:INFO:VAL-(cmcm) >>
2024-06-13 21:51:16:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4556  Non0_acc_2: 0.5694  Non0_F1_score: 0.4246  Mult_acc_5: 0.2882  Mult_acc_7: 0.2358  MAE: 1.6228  Corr: 0.0806 
2024-06-13 21:51:31:INFO:TRAIN-(cmcm) (2/3/4)>> loss: 0.9194
2024-06-13 21:51:34:INFO:VAL-(cmcm) >>
2024-06-13 21:51:34:INFO:M: >>  Has0_acc_2: 0.4978  Has0_F1_score: 0.4759  Non0_acc_2: 0.5093  Non0_F1_score: 0.4851  Mult_acc_5: 0.2227  Mult_acc_7: 0.2009  MAE: 1.7001  Corr: 0.0773 
2024-06-13 21:51:49:INFO:TRAIN-(cmcm) (3/4/4)>> loss: 0.9104
2024-06-13 21:51:51:INFO:VAL-(cmcm) >>
2024-06-13 21:51:51:INFO:M: >>  Has0_acc_2: 0.4323  Has0_F1_score: 0.3119  Non0_acc_2: 0.4583  Non0_F1_score: 0.3408  Mult_acc_5: 0.1397  Mult_acc_7: 0.1310  MAE: 1.8379  Corr: 0.0284 
2024-06-13 21:52:06:INFO:TRAIN-(cmcm) (4/5/4)>> loss: 0.8823
2024-06-13 21:52:09:INFO:VAL-(cmcm) >>
2024-06-13 21:52:09:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4767  Non0_acc_2: 0.5741  Non0_F1_score: 0.4491  Mult_acc_5: 0.1790  Mult_acc_7: 0.1747  MAE: 1.5558  Corr: 0.0221 
2024-06-13 21:52:24:INFO:TRAIN-(cmcm) (5/6/4)>> loss: 0.8833
2024-06-13 21:52:26:INFO:VAL-(cmcm) >>
2024-06-13 21:52:27:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5509  Non0_F1_score: 0.4651  Mult_acc_5: 0.2882  Mult_acc_7: 0.2096  MAE: 1.7398  Corr: -0.0645 
2024-06-13 21:52:42:INFO:TRAIN-(cmcm) (6/7/4)>> loss: 0.8719
2024-06-13 21:52:44:INFO:VAL-(cmcm) >>
2024-06-13 21:52:44:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5787  Non0_F1_score: 0.4291  Mult_acc_5: 0.3013  Mult_acc_7: 0.2227  MAE: 1.7302  Corr: 0.0440 
2024-06-13 21:52:59:INFO:TRAIN-(cmcm) (7/8/4)>> loss: 0.8665
2024-06-13 21:53:02:INFO:VAL-(cmcm) >>
2024-06-13 21:53:02:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.5282  Non0_acc_2: 0.5648  Non0_F1_score: 0.5097  Mult_acc_5: 0.2140  Mult_acc_7: 0.1747  MAE: 1.7206  Corr: 0.0197 
2024-06-13 21:53:17:INFO:TRAIN-(cmcm) (8/9/4)>> loss: 0.8618
2024-06-13 21:53:19:INFO:VAL-(cmcm) >>
2024-06-13 21:53:19:INFO:M: >>  Has0_acc_2: 0.5197  Has0_F1_score: 0.4837  Non0_acc_2: 0.5417  Non0_F1_score: 0.5061  Mult_acc_5: 0.1616  Mult_acc_7: 0.1616  MAE: 1.6305  Corr: 0.2402 
2024-06-13 21:53:34:INFO:TRAIN-(cmcm) (9/10/4)>> loss: 0.8544
2024-06-13 21:53:37:INFO:VAL-(cmcm) >>
2024-06-13 21:53:37:INFO:M: >>  Has0_acc_2: 0.6288  Has0_F1_score: 0.5410  Non0_acc_2: 0.5972  Non0_F1_score: 0.5332  Mult_acc_5: 0.2969  Mult_acc_7: 0.2183  MAE: 1.6446  Corr: 0.0799 
2024-06-13 21:53:52:INFO:TRAIN-(cmcm) (10/11/4)>> loss: 0.8571
2024-06-13 21:53:55:INFO:VAL-(cmcm) >>
2024-06-13 21:53:55:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.4842  Non0_acc_2: 0.5509  Non0_F1_score: 0.4598  Mult_acc_5: 0.2576  Mult_acc_7: 0.2183  MAE: 1.7113  Corr: -0.0623 
2024-06-13 21:54:02:INFO:TEST-(cmcm) >>
2024-06-13 21:54:02:INFO:M: >>  Has0_acc_2: 0.5292  Has0_F1_score: 0.5015  Non0_acc_2: 0.5213  Non0_F1_score: 0.4983  Mult_acc_5: 0.2245  Mult_acc_7: 0.2070  MAE: 1.5974  Corr: 0.1500 
2024-06-13 21:54:03:INFO:Results are added to results/results/mosi-regression-100.csv...
2024-06-13 21:54:03:INFO:Start running cmcm...
2024-06-13 21:54:03:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosi', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [1], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSI/Processed/unaligned_50.pkl', 'seq_lens': (50, 50, 50), 'feature_dims': (2048, 5, 20), 'train_samples': 1284, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 6, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 100, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 5555}>
2024-06-13 21:54:03:INFO:Let's use the GPU 1 !
2024-06-13 21:54:03:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 21:54:03:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718286843 HTTP/1.1" 200 235
2024-06-13 21:54:03:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 21:54:04:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 21:54:05:INFO:train samples: (1284,)
2024-06-13 21:54:05:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 21:54:05:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718286845 HTTP/1.1" 200 235
2024-06-13 21:54:05:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 21:54:06:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 21:54:07:INFO:valid samples: (229,)
2024-06-13 21:54:07:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 21:54:07:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718286847 HTTP/1.1" 200 235
2024-06-13 21:54:07:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 21:54:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 21:54:09:INFO:test samples: (686,)
2024-06-13 21:54:09:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 21:54:09:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718286849 HTTP/1.1" 200 235
2024-06-13 21:54:09:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 21:54:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 21:54:10:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-06-13 21:54:11:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1718286851 HTTP/1.1" 200 235
2024-06-13 21:54:11:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-06-13 21:54:11:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-06-13 21:54:11:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-06-13 21:54:11:WARNING:Try importing flash-attention for faster inference...
2024-06-13 21:54:11:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-06-13 21:54:11:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-06-13 21:54:11:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-06-13 21:54:13:INFO:trainable params: 1310288 || all params: 1838138960 || trainable%: 0.07128340286090232
2024-06-13 21:54:13:INFO:Init labels...
2024-06-13 21:54:13:INFO:Start training...
2024-06-13 21:54:28:INFO:TRAIN-(cmcm) (1/1/5)>> loss: 2.1826
2024-06-13 21:54:31:INFO:VAL-(cmcm) >>
2024-06-13 21:54:31:INFO:M: >>  Has0_acc_2: 0.5633  Has0_F1_score: 0.5048  Non0_acc_2: 0.5463  Non0_F1_score: 0.4849  Mult_acc_5: 0.1790  Mult_acc_7: 0.1790  MAE: 1.5279  Corr: 0.0078 
2024-06-13 21:54:31:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosi-regression.pth.
2024-06-13 21:54:47:INFO:TRAIN-(cmcm) (1/2/5)>> loss: 0.9863
2024-06-13 21:54:49:INFO:VAL-(cmcm) >>
2024-06-13 21:54:49:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4855  Non0_acc_2: 0.5787  Non0_F1_score: 0.4584  Mult_acc_5: 0.1878  Mult_acc_7: 0.1790  MAE: 1.5043  Corr: -0.0416 
2024-06-13 21:54:50:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosi-regression.pth.
2024-06-13 21:55:05:INFO:TRAIN-(cmcm) (1/3/5)>> loss: 0.9082
2024-06-13 21:55:08:INFO:VAL-(cmcm) >>
2024-06-13 21:55:08:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.4584  Non0_acc_2: 0.5694  Non0_F1_score: 0.4396  Mult_acc_5: 0.1659  Mult_acc_7: 0.1616  MAE: 1.5069  Corr: -0.0407 
2024-06-13 21:55:23:INFO:TRAIN-(cmcm) (2/4/5)>> loss: 0.8810
2024-06-13 21:55:25:INFO:VAL-(cmcm) >>
2024-06-13 21:55:25:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4676  Non0_acc_2: 0.5694  Non0_F1_score: 0.4396  Mult_acc_5: 0.3057  Mult_acc_7: 0.2227  MAE: 1.6865  Corr: -0.0045 
2024-06-13 21:55:40:INFO:TRAIN-(cmcm) (3/5/5)>> loss: 0.8890
2024-06-13 21:55:43:INFO:VAL-(cmcm) >>
2024-06-13 21:55:43:INFO:M: >>  Has0_acc_2: 0.5590  Has0_F1_score: 0.5156  Non0_acc_2: 0.5509  Non0_F1_score: 0.5031  Mult_acc_5: 0.2140  Mult_acc_7: 0.1921  MAE: 1.5966  Corr: 0.0011 
2024-06-13 21:55:58:INFO:TRAIN-(cmcm) (4/6/5)>> loss: 0.8683
2024-06-13 21:56:01:INFO:VAL-(cmcm) >>
2024-06-13 21:56:01:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5745  Non0_acc_2: 0.5741  Non0_F1_score: 0.5746  Mult_acc_5: 0.2271  Mult_acc_7: 0.1747  MAE: 1.5673  Corr: 0.1281 
2024-06-13 21:56:16:INFO:TRAIN-(cmcm) (5/7/5)>> loss: 0.8658
2024-06-13 21:56:18:INFO:VAL-(cmcm) >>
2024-06-13 21:56:18:INFO:M: >>  Has0_acc_2: 0.6026  Has0_F1_score: 0.4577  Non0_acc_2: 0.5741  Non0_F1_score: 0.4269  Mult_acc_5: 0.1747  Mult_acc_7: 0.1747  MAE: 1.4746  Corr: -0.0141 
2024-06-13 21:56:19:INFO:Saving checkpoint at epoch 7 to results/models/cmcm-mosi-regression.pth.
2024-06-13 21:56:34:INFO:TRAIN-(cmcm) (1/8/5)>> loss: 0.8677
2024-06-13 21:56:37:INFO:VAL-(cmcm) >>
2024-06-13 21:56:37:INFO:M: >>  Has0_acc_2: 0.5808  Has0_F1_score: 0.4539  Non0_acc_2: 0.5556  Non0_F1_score: 0.4251  Mult_acc_5: 0.2882  Mult_acc_7: 0.2052  MAE: 1.8071  Corr: -0.0595 
2024-06-13 21:56:52:INFO:TRAIN-(cmcm) (2/9/5)>> loss: 0.8684
2024-06-13 21:56:55:INFO:VAL-(cmcm) >>
2024-06-13 21:56:55:INFO:M: >>  Has0_acc_2: 0.5764  Has0_F1_score: 0.4582  Non0_acc_2: 0.5463  Non0_F1_score: 0.4271  Mult_acc_5: 0.2838  Mult_acc_7: 0.2052  MAE: 1.8918  Corr: -0.0817 
2024-06-13 21:57:10:INFO:TRAIN-(cmcm) (3/10/5)>> loss: 0.8710
2024-06-13 21:57:12:INFO:VAL-(cmcm) >>
2024-06-13 21:57:12:INFO:M: >>  Has0_acc_2: 0.5939  Has0_F1_score: 0.4534  Non0_acc_2: 0.5648  Non0_F1_score: 0.4684  Mult_acc_5: 0.2751  Mult_acc_7: 0.2052  MAE: 1.6414  Corr: -0.0026 
2024-06-13 21:57:27:INFO:TRAIN-(cmcm) (4/11/5)>> loss: 0.8637
2024-06-13 21:57:30:INFO:VAL-(cmcm) >>
2024-06-13 21:57:30:INFO:M: >>  Has0_acc_2: 0.5721  Has0_F1_score: 0.5109  Non0_acc_2: 0.4954  Non0_F1_score: 0.4859  Mult_acc_5: 0.2271  Mult_acc_7: 0.2271  MAE: 1.4370  Corr: 0.0018 
2024-06-13 21:57:30:INFO:Saving checkpoint at epoch 11 to results/models/cmcm-mosi-regression.pth.
2024-06-13 21:57:46:INFO:TRAIN-(cmcm) (1/12/5)>> loss: 0.8578
2024-06-13 21:57:48:INFO:VAL-(cmcm) >>
2024-06-13 21:57:48:INFO:M: >>  Has0_acc_2: 0.5677  Has0_F1_score: 0.5311  Non0_acc_2: 0.5556  Non0_F1_score: 0.5163  Mult_acc_5: 0.2795  Mult_acc_7: 0.2009  MAE: 1.7215  Corr: 0.0127 
2024-06-13 21:58:04:INFO:TRAIN-(cmcm) (2/13/5)>> loss: 0.8552
2024-06-13 21:58:06:INFO:VAL-(cmcm) >>
2024-06-13 21:58:06:INFO:M: >>  Has0_acc_2: 0.5895  Has0_F1_score: 0.5189  Non0_acc_2: 0.5694  Non0_F1_score: 0.4966  Mult_acc_5: 0.2838  Mult_acc_7: 0.2052  MAE: 1.8036  Corr: 0.0083 
2024-06-13 21:58:21:INFO:TRAIN-(cmcm) (3/14/5)>> loss: 0.8518
2024-06-13 21:58:24:INFO:VAL-(cmcm) >>
2024-06-13 21:58:24:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.4479  Non0_acc_2: 0.5741  Non0_F1_score: 0.4346  Mult_acc_5: 0.2795  Mult_acc_7: 0.2183  MAE: 1.5589  Corr: 0.0443 
2024-06-13 21:58:39:INFO:TRAIN-(cmcm) (4/15/5)>> loss: 0.8521
2024-06-13 21:58:42:INFO:VAL-(cmcm) >>
2024-06-13 21:58:42:INFO:M: >>  Has0_acc_2: 0.6201  Has0_F1_score: 0.5302  Non0_acc_2: 0.6065  Non0_F1_score: 0.5266  Mult_acc_5: 0.3144  Mult_acc_7: 0.2271  MAE: 1.6774  Corr: 0.1276 
2024-06-13 21:58:57:INFO:TRAIN-(cmcm) (5/16/5)>> loss: 0.8430
2024-06-13 21:58:59:INFO:VAL-(cmcm) >>
2024-06-13 21:58:59:INFO:M: >>  Has0_acc_2: 0.5983  Has0_F1_score: 0.5409  Non0_acc_2: 0.5880  Non0_F1_score: 0.5265  Mult_acc_5: 0.3144  Mult_acc_7: 0.2314  MAE: 1.6726  Corr: 0.0761 
2024-06-13 21:59:14:INFO:TRAIN-(cmcm) (6/17/5)>> loss: 0.8411
2024-06-13 21:59:17:INFO:VAL-(cmcm) >>
2024-06-13 21:59:17:INFO:M: >>  Has0_acc_2: 0.6507  Has0_F1_score: 0.6540  Non0_acc_2: 0.6481  Non0_F1_score: 0.6490  Mult_acc_5: 0.2838  Mult_acc_7: 0.2096  MAE: 1.3756  Corr: 0.3144 
2024-06-13 21:59:17:INFO:Saving checkpoint at epoch 17 to results/models/cmcm-mosi-regression.pth.
2024-06-13 21:59:33:INFO:TRAIN-(cmcm) (1/18/5)>> loss: 0.8335
2024-06-13 21:59:36:INFO:VAL-(cmcm) >>
2024-06-13 21:59:36:INFO:M: >>  Has0_acc_2: 0.6681  Has0_F1_score: 0.6707  Non0_acc_2: 0.6713  Non0_F1_score: 0.6725  Mult_acc_5: 0.3188  Mult_acc_7: 0.2533  MAE: 1.3154  Corr: 0.3904 
2024-06-13 21:59:36:INFO:Saving checkpoint at epoch 18 to results/models/cmcm-mosi-regression.pth.
2024-06-13 21:59:52:INFO:TRAIN-(cmcm) (1/19/5)>> loss: 0.8359
2024-06-13 21:59:54:INFO:VAL-(cmcm) >>
2024-06-13 21:59:54:INFO:M: >>  Has0_acc_2: 0.5633  Has0_F1_score: 0.5257  Non0_acc_2: 0.5880  Non0_F1_score: 0.5510  Mult_acc_5: 0.2533  Mult_acc_7: 0.2096  MAE: 1.4664  Corr: 0.3478 
2024-06-13 22:00:09:INFO:TRAIN-(cmcm) (2/20/5)>> loss: 0.8285
2024-06-13 22:00:12:INFO:VAL-(cmcm) >>
2024-06-13 22:00:12:INFO:M: >>  Has0_acc_2: 0.5284  Has0_F1_score: 0.4759  Non0_acc_2: 0.4954  Non0_F1_score: 0.3967  Mult_acc_5: 0.1921  Mult_acc_7: 0.1747  MAE: 1.5287  Corr: 0.3163 
2024-06-13 22:00:27:INFO:TRAIN-(cmcm) (3/21/5)>> loss: 0.8253
2024-06-13 22:00:30:INFO:VAL-(cmcm) >>
2024-06-13 22:00:30:INFO:M: >>  Has0_acc_2: 0.6507  Has0_F1_score: 0.6465  Non0_acc_2: 0.6667  Non0_F1_score: 0.6602  Mult_acc_5: 0.3188  Mult_acc_7: 0.2445  MAE: 1.3839  Corr: 0.4243 
2024-06-13 22:00:45:INFO:TRAIN-(cmcm) (4/22/5)>> loss: 0.8118
2024-06-13 22:00:47:INFO:VAL-(cmcm) >>
2024-06-13 22:00:47:INFO:M: >>  Has0_acc_2: 0.7031  Has0_F1_score: 0.6789  Non0_acc_2: 0.7037  Non0_F1_score: 0.7010  Mult_acc_5: 0.3231  Mult_acc_7: 0.2882  MAE: 1.1047  Corr: 0.5502 
2024-06-13 22:00:47:INFO:Saving checkpoint at epoch 22 to results/models/cmcm-mosi-regression.pth.
2024-06-13 22:01:03:INFO:TRAIN-(cmcm) (1/23/5)>> loss: 0.7936
2024-06-13 22:01:06:INFO:VAL-(cmcm) >>
2024-06-13 22:01:06:INFO:M: >>  Has0_acc_2: 0.7249  Has0_F1_score: 0.7251  Non0_acc_2: 0.7454  Non0_F1_score: 0.7443  Mult_acc_5: 0.3799  Mult_acc_7: 0.2795  MAE: 1.2053  Corr: 0.5027 
2024-06-13 22:01:21:INFO:TRAIN-(cmcm) (2/24/5)>> loss: 0.7821
2024-06-13 22:01:23:INFO:VAL-(cmcm) >>
2024-06-13 22:01:23:INFO:M: >>  Has0_acc_2: 0.7162  Has0_F1_score: 0.7185  Non0_acc_2: 0.6991  Non0_F1_score: 0.6967  Mult_acc_5: 0.3493  Mult_acc_7: 0.2576  MAE: 1.2119  Corr: 0.5251 
2024-06-13 22:01:38:INFO:TRAIN-(cmcm) (3/25/5)>> loss: 0.7797
2024-06-13 22:01:41:INFO:VAL-(cmcm) >>
2024-06-13 22:01:41:INFO:M: >>  Has0_acc_2: 0.6769  Has0_F1_score: 0.6277  Non0_acc_2: 0.7454  Non0_F1_score: 0.7337  Mult_acc_5: 0.4061  Mult_acc_7: 0.3406  MAE: 1.0790  Corr: 0.5735 
2024-06-13 22:01:41:INFO:Saving checkpoint at epoch 25 to results/models/cmcm-mosi-regression.pth.
2024-06-13 22:01:57:INFO:TRAIN-(cmcm) (1/26/5)>> loss: 0.7689
2024-06-13 22:01:59:INFO:VAL-(cmcm) >>
2024-06-13 22:01:59:INFO:M: >>  Has0_acc_2: 0.6987  Has0_F1_score: 0.7016  Non0_acc_2: 0.6806  Non0_F1_score: 0.6812  Mult_acc_5: 0.3537  Mult_acc_7: 0.3057  MAE: 1.2322  Corr: 0.4740 
2024-06-13 22:02:14:INFO:TRAIN-(cmcm) (2/27/5)>> loss: 0.7610
2024-06-13 22:02:17:INFO:VAL-(cmcm) >>
2024-06-13 22:02:17:INFO:M: >>  Has0_acc_2: 0.7424  Has0_F1_score: 0.7405  Non0_acc_2: 0.7500  Non0_F1_score: 0.7482  Mult_acc_5: 0.4367  Mult_acc_7: 0.3581  MAE: 1.0695  Corr: 0.5380 
2024-06-13 22:02:18:INFO:Saving checkpoint at epoch 27 to results/models/cmcm-mosi-regression.pth.
2024-06-13 22:02:33:INFO:TRAIN-(cmcm) (1/28/5)>> loss: 0.7533
2024-06-13 22:02:36:INFO:VAL-(cmcm) >>
2024-06-13 22:02:36:INFO:M: >>  Has0_acc_2: 0.7162  Has0_F1_score: 0.7057  Non0_acc_2: 0.7130  Non0_F1_score: 0.7030  Mult_acc_5: 0.4410  Mult_acc_7: 0.3537  MAE: 1.1232  Corr: 0.5083 
2024-06-13 22:02:51:INFO:TRAIN-(cmcm) (2/29/5)>> loss: 0.7394
2024-06-13 22:02:53:INFO:VAL-(cmcm) >>
2024-06-13 22:02:53:INFO:M: >>  Has0_acc_2: 0.7293  Has0_F1_score: 0.7238  Non0_acc_2: 0.7176  Non0_F1_score: 0.7187  Mult_acc_5: 0.3886  Mult_acc_7: 0.3319  MAE: 1.0528  Corr: 0.5838 
2024-06-13 22:02:54:INFO:Saving checkpoint at epoch 29 to results/models/cmcm-mosi-regression.pth.
2024-06-13 22:03:09:INFO:TRAIN-(cmcm) (1/30/5)>> loss: 0.7294
2024-06-13 22:03:12:INFO:VAL-(cmcm) >>
2024-06-13 22:03:12:INFO:M: >>  Has0_acc_2: 0.7380  Has0_F1_score: 0.7351  Non0_acc_2: 0.7778  Non0_F1_score: 0.7771  Mult_acc_5: 0.4148  Mult_acc_7: 0.3450  MAE: 1.0320  Corr: 0.5809 
2024-06-13 22:03:12:INFO:Saving checkpoint at epoch 30 to results/models/cmcm-mosi-regression.pth.
2024-06-13 22:03:28:INFO:TRAIN-(cmcm) (1/31/5)>> loss: 0.7273
2024-06-13 22:03:30:INFO:VAL-(cmcm) >>
2024-06-13 22:03:30:INFO:M: >>  Has0_acc_2: 0.7467  Has0_F1_score: 0.7432  Non0_acc_2: 0.7500  Non0_F1_score: 0.7500  Mult_acc_5: 0.4498  Mult_acc_7: 0.3624  MAE: 1.0119  Corr: 0.6081 
2024-06-13 22:03:31:INFO:Saving checkpoint at epoch 31 to results/models/cmcm-mosi-regression.pth.
2024-06-13 22:03:46:INFO:TRAIN-(cmcm) (1/32/5)>> loss: 0.7204
2024-06-13 22:03:49:INFO:VAL-(cmcm) >>
2024-06-13 22:03:49:INFO:M: >>  Has0_acc_2: 0.7205  Has0_F1_score: 0.7221  Non0_acc_2: 0.7315  Non0_F1_score: 0.7321  Mult_acc_5: 0.3886  Mult_acc_7: 0.3100  MAE: 1.1053  Corr: 0.5626 
2024-06-13 22:04:04:INFO:TRAIN-(cmcm) (2/33/5)>> loss: 0.7270
2024-06-13 22:04:07:INFO:VAL-(cmcm) >>
2024-06-13 22:04:07:INFO:M: >>  Has0_acc_2: 0.6987  Has0_F1_score: 0.7015  Non0_acc_2: 0.6944  Non0_F1_score: 0.6940  Mult_acc_5: 0.3319  Mult_acc_7: 0.2620  MAE: 1.1477  Corr: 0.5472 
2024-06-13 22:04:22:INFO:TRAIN-(cmcm) (3/34/5)>> loss: 0.7138
2024-06-13 22:04:24:INFO:VAL-(cmcm) >>
2024-06-13 22:04:24:INFO:M: >>  Has0_acc_2: 0.7642  Has0_F1_score: 0.7638  Non0_acc_2: 0.7778  Non0_F1_score: 0.7762  Mult_acc_5: 0.4061  Mult_acc_7: 0.3406  MAE: 1.0669  Corr: 0.5728 
2024-06-13 22:04:39:INFO:TRAIN-(cmcm) (4/35/5)>> loss: 0.6997
2024-06-13 22:04:42:INFO:VAL-(cmcm) >>
2024-06-13 22:04:42:INFO:M: >>  Has0_acc_2: 0.7031  Has0_F1_score: 0.7060  Non0_acc_2: 0.6713  Non0_F1_score: 0.6611  Mult_acc_5: 0.3755  Mult_acc_7: 0.2838  MAE: 1.1315  Corr: 0.5887 
2024-06-13 22:04:57:INFO:TRAIN-(cmcm) (5/36/5)>> loss: 0.6933
2024-06-13 22:04:59:INFO:VAL-(cmcm) >>
2024-06-13 22:04:59:INFO:M: >>  Has0_acc_2: 0.7686  Has0_F1_score: 0.7643  Non0_acc_2: 0.7731  Non0_F1_score: 0.7695  Mult_acc_5: 0.4323  Mult_acc_7: 0.3319  MAE: 1.0590  Corr: 0.5830 
2024-06-13 22:05:14:INFO:TRAIN-(cmcm) (6/37/5)>> loss: 0.6867
2024-06-13 22:05:17:INFO:VAL-(cmcm) >>
2024-06-13 22:05:17:INFO:M: >>  Has0_acc_2: 0.7642  Has0_F1_score: 0.7622  Non0_acc_2: 0.7685  Non0_F1_score: 0.7658  Mult_acc_5: 0.3843  Mult_acc_7: 0.2969  MAE: 1.1049  Corr: 0.5811 
2024-06-13 22:05:32:INFO:TRAIN-(cmcm) (7/38/5)>> loss: 0.6800
2024-06-13 22:05:35:INFO:VAL-(cmcm) >>
2024-06-13 22:05:35:INFO:M: >>  Has0_acc_2: 0.7511  Has0_F1_score: 0.7498  Non0_acc_2: 0.7407  Non0_F1_score: 0.7416  Mult_acc_5: 0.4105  Mult_acc_7: 0.3406  MAE: 0.9940  Corr: 0.6278 
2024-06-13 22:05:35:INFO:Saving checkpoint at epoch 38 to results/models/cmcm-mosi-regression.pth.
2024-06-13 22:05:51:INFO:TRAIN-(cmcm) (1/39/5)>> loss: 0.7042
2024-06-13 22:05:53:INFO:VAL-(cmcm) >>
2024-06-13 22:05:53:INFO:M: >>  Has0_acc_2: 0.7817  Has0_F1_score: 0.7766  Non0_acc_2: 0.7685  Non0_F1_score: 0.7678  Mult_acc_5: 0.4148  Mult_acc_7: 0.3450  MAE: 1.0563  Corr: 0.5695 
2024-06-13 22:06:08:INFO:TRAIN-(cmcm) (2/40/5)>> loss: 0.6767
2024-06-13 22:06:11:INFO:VAL-(cmcm) >>
2024-06-13 22:06:11:INFO:M: >>  Has0_acc_2: 0.7336  Has0_F1_score: 0.7343  Non0_acc_2: 0.7454  Non0_F1_score: 0.7463  Mult_acc_5: 0.3799  Mult_acc_7: 0.3057  MAE: 1.0599  Corr: 0.5794 
2024-06-13 22:06:26:INFO:TRAIN-(cmcm) (3/41/5)>> loss: 0.6742
2024-06-13 22:06:29:INFO:VAL-(cmcm) >>
2024-06-13 22:06:29:INFO:M: >>  Has0_acc_2: 0.7555  Has0_F1_score: 0.7540  Non0_acc_2: 0.7546  Non0_F1_score: 0.7545  Mult_acc_5: 0.4148  Mult_acc_7: 0.3406  MAE: 1.0682  Corr: 0.5464 
2024-06-13 22:06:44:INFO:TRAIN-(cmcm) (4/42/5)>> loss: 0.6698
2024-06-13 22:06:46:INFO:VAL-(cmcm) >>
2024-06-13 22:06:46:INFO:M: >>  Has0_acc_2: 0.7729  Has0_F1_score: 0.7668  Non0_acc_2: 0.7870  Non0_F1_score: 0.7840  Mult_acc_5: 0.3930  Mult_acc_7: 0.3231  MAE: 1.0368  Corr: 0.6012 
2024-06-13 22:07:01:INFO:TRAIN-(cmcm) (5/43/5)>> loss: 0.6667
2024-06-13 22:07:04:INFO:VAL-(cmcm) >>
2024-06-13 22:07:04:INFO:M: >>  Has0_acc_2: 0.7205  Has0_F1_score: 0.7218  Non0_acc_2: 0.7361  Non0_F1_score: 0.7376  Mult_acc_5: 0.4192  Mult_acc_7: 0.3493  MAE: 1.0809  Corr: 0.5661 
2024-06-13 22:07:19:INFO:TRAIN-(cmcm) (6/44/5)>> loss: 0.6602
2024-06-13 22:07:21:INFO:VAL-(cmcm) >>
2024-06-13 22:07:21:INFO:M: >>  Has0_acc_2: 0.7293  Has0_F1_score: 0.7276  Non0_acc_2: 0.7454  Non0_F1_score: 0.7466  Mult_acc_5: 0.4061  Mult_acc_7: 0.3362  MAE: 1.0333  Corr: 0.6011 
2024-06-13 22:07:36:INFO:TRAIN-(cmcm) (7/45/5)>> loss: 0.6448
2024-06-13 22:07:39:INFO:VAL-(cmcm) >>
2024-06-13 22:07:39:INFO:M: >>  Has0_acc_2: 0.7598  Has0_F1_score: 0.7510  Non0_acc_2: 0.7546  Non0_F1_score: 0.7557  Mult_acc_5: 0.4541  Mult_acc_7: 0.3799  MAE: 0.9813  Corr: 0.6347 
2024-06-13 22:07:40:INFO:Saving checkpoint at epoch 45 to results/models/cmcm-mosi-regression.pth.
2024-06-13 22:07:55:INFO:TRAIN-(cmcm) (1/46/5)>> loss: 0.6440
2024-06-13 22:07:58:INFO:VAL-(cmcm) >>
2024-06-13 22:07:58:INFO:M: >>  Has0_acc_2: 0.7555  Has0_F1_score: 0.7527  Non0_acc_2: 0.7778  Non0_F1_score: 0.7767  Mult_acc_5: 0.4148  Mult_acc_7: 0.3581  MAE: 1.0030  Corr: 0.6338 
2024-06-13 22:08:13:INFO:TRAIN-(cmcm) (2/47/5)>> loss: 0.6298
2024-06-13 22:08:15:INFO:VAL-(cmcm) >>
2024-06-13 22:08:15:INFO:M: >>  Has0_acc_2: 0.7380  Has0_F1_score: 0.7370  Non0_acc_2: 0.7176  Non0_F1_score: 0.7190  Mult_acc_5: 0.4105  Mult_acc_7: 0.3406  MAE: 1.0263  Corr: 0.6092 
2024-06-13 22:08:30:INFO:TRAIN-(cmcm) (3/48/5)>> loss: 0.6201
2024-06-13 22:08:33:INFO:VAL-(cmcm) >>
2024-06-13 22:08:33:INFO:M: >>  Has0_acc_2: 0.7031  Has0_F1_score: 0.7056  Non0_acc_2: 0.6713  Non0_F1_score: 0.6706  Mult_acc_5: 0.3188  Mult_acc_7: 0.2751  MAE: 1.2036  Corr: 0.5167 
2024-06-13 22:08:48:INFO:TRAIN-(cmcm) (4/49/5)>> loss: 0.6119
2024-06-13 22:08:50:INFO:VAL-(cmcm) >>
2024-06-13 22:08:50:INFO:M: >>  Has0_acc_2: 0.7380  Has0_F1_score: 0.7309  Non0_acc_2: 0.7639  Non0_F1_score: 0.7614  Mult_acc_5: 0.3930  Mult_acc_7: 0.3362  MAE: 1.0612  Corr: 0.5771 
2024-06-13 22:09:05:INFO:TRAIN-(cmcm) (5/50/5)>> loss: 0.6190
2024-06-13 22:09:08:INFO:VAL-(cmcm) >>
2024-06-13 22:09:08:INFO:M: >>  Has0_acc_2: 0.7293  Has0_F1_score: 0.7313  Non0_acc_2: 0.7546  Non0_F1_score: 0.7560  Mult_acc_5: 0.4454  Mult_acc_7: 0.3668  MAE: 1.0394  Corr: 0.6037 
2024-06-13 22:09:23:INFO:TRAIN-(cmcm) (6/51/5)>> loss: 0.6046
2024-06-13 22:09:26:INFO:VAL-(cmcm) >>
2024-06-13 22:09:26:INFO:M: >>  Has0_acc_2: 0.7467  Has0_F1_score: 0.7432  Non0_acc_2: 0.7361  Non0_F1_score: 0.7371  Mult_acc_5: 0.3886  Mult_acc_7: 0.3231  MAE: 1.0660  Corr: 0.5636 
2024-06-13 22:09:41:INFO:TRAIN-(cmcm) (7/52/5)>> loss: 0.6096
2024-06-13 22:09:43:INFO:VAL-(cmcm) >>
2024-06-13 22:09:43:INFO:M: >>  Has0_acc_2: 0.6376  Has0_F1_score: 0.6354  Non0_acc_2: 0.6759  Non0_F1_score: 0.6722  Mult_acc_5: 0.3537  Mult_acc_7: 0.2882  MAE: 1.2464  Corr: 0.4844 
2024-06-13 22:09:58:INFO:TRAIN-(cmcm) (8/53/5)>> loss: 0.6026
2024-06-13 22:10:01:INFO:VAL-(cmcm) >>
2024-06-13 22:10:01:INFO:M: >>  Has0_acc_2: 0.7249  Has0_F1_score: 0.7256  Non0_acc_2: 0.7546  Non0_F1_score: 0.7559  Mult_acc_5: 0.4367  Mult_acc_7: 0.3406  MAE: 1.0673  Corr: 0.5647 
2024-06-13 22:10:16:INFO:TRAIN-(cmcm) (9/54/5)>> loss: 0.5796
2024-06-13 22:10:19:INFO:VAL-(cmcm) >>
2024-06-13 22:10:19:INFO:M: >>  Has0_acc_2: 0.7424  Has0_F1_score: 0.7329  Non0_acc_2: 0.7731  Non0_F1_score: 0.7695  Mult_acc_5: 0.4323  Mult_acc_7: 0.3668  MAE: 1.0136  Corr: 0.6089 
2024-06-13 22:10:34:INFO:TRAIN-(cmcm) (10/55/5)>> loss: 0.5726
2024-06-13 22:10:36:INFO:VAL-(cmcm) >>
2024-06-13 22:10:36:INFO:M: >>  Has0_acc_2: 0.7380  Has0_F1_score: 0.7289  Non0_acc_2: 0.7870  Non0_F1_score: 0.7860  Mult_acc_5: 0.4367  Mult_acc_7: 0.3624  MAE: 1.0407  Corr: 0.6055 
2024-06-13 22:10:44:INFO:TEST-(cmcm) >>
2024-06-13 22:10:44:INFO:M: >>  Has0_acc_2: 0.6939  Has0_F1_score: 0.6908  Non0_acc_2: 0.7515  Non0_F1_score: 0.7512  Mult_acc_5: 0.3324  Mult_acc_7: 0.2915  MAE: 1.1250  Corr: 0.5196 
2024-06-13 22:10:44:INFO:Results are added to results/results/mosi-regression-100.csv...
2024-07-02 17:00:35:INFO:Start running cmcm...
2024-07-02 17:00:35:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosei', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111], 'dataPath': '/home/young/DL/multimodal_dataset/MOSEI/Processed/unaligned_50.pkl', 'seq_lens': (50, 500, 375), 'feature_dims': (2048, 74, 35), 'train_samples': 16326, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 64, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2024-07-02 17:00:35:INFO:Find gpu: 0, with memory: 1981218816 left!
2024-07-02 17:00:35:INFO:Let's use the GPU 0 !
2024-07-02 17:00:42:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-02 17:00:43:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1719910843 HTTP/1.1" 200 235
2024-07-02 17:00:43:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-07-02 17:00:43:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-07-02 17:00:47:INFO:train samples: (16326,)
2024-07-02 17:00:54:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-02 17:00:55:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1719910855 HTTP/1.1" 200 235
2024-07-02 17:00:55:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-07-02 17:00:55:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-07-02 17:00:56:INFO:valid samples: (1871,)
2024-07-02 17:01:03:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-02 17:01:03:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1719910863 HTTP/1.1" 200 235
2024-07-02 17:01:04:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-07-02 17:01:04:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-07-02 17:01:06:INFO:test samples: (4659,)
2024-07-02 17:01:06:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-02 17:01:06:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1719910867 HTTP/1.1" 200 235
2024-07-02 17:01:07:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-07-02 17:01:07:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-07-02 17:01:08:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2024-07-02 17:01:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1719910868 HTTP/1.1" 200 235
2024-07-02 17:01:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 235
2024-07-02 17:01:09:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2024-07-02 17:01:09:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2024-07-02 17:01:09:WARNING:Try importing flash-attention for faster inference...
2024-07-02 17:01:09:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2024-07-02 17:01:09:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2024-07-02 17:01:09:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2024-07-02 17:01:12:INFO:trainable params: 1351244 || all params: 1838179916 || trainable%: 0.073509888136543
2024-07-02 17:01:12:INFO:Init labels...
2024-07-02 17:01:12:INFO:Start training...
2024-07-02 17:05:20:INFO:TRAIN-(cmcm) (1/1/1)>> loss: 1.0262
2024-07-02 17:05:46:INFO:VAL-(cmcm) >>
2024-07-02 17:05:46:INFO:M: >>  Has0_acc_2: 0.7402  Has0_F1_score: 0.6416  Non0_acc_2: 0.6328  Non0_F1_score: 0.5773  Mult_acc_5: 0.4409  Mult_acc_7: 0.4399  MAE: 0.7691  Corr: 0.1657 
2024-07-02 17:05:48:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosei-regression.pth.
2024-07-02 17:09:47:INFO:TRAIN-(cmcm) (1/2/1)>> loss: 0.6101
2024-07-02 17:10:14:INFO:VAL-(cmcm) >>
2024-07-02 17:10:14:INFO:M: >>  Has0_acc_2: 0.7974  Has0_F1_score: 0.7961  Non0_acc_2: 0.4506  Non0_F1_score: 0.3773  Mult_acc_5: 0.4666  Mult_acc_7: 0.4570  MAE: 0.7275  Corr: 0.5406 
2024-07-02 17:10:15:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosei-regression.pth.
2024-07-02 17:14:16:INFO:TRAIN-(cmcm) (1/3/1)>> loss: 0.5884
2024-07-02 17:14:40:INFO:VAL-(cmcm) >>
2024-07-02 17:14:40:INFO:M: >>  Has0_acc_2: 0.8065  Has0_F1_score: 0.7898  Non0_acc_2: 0.7003  Non0_F1_score: 0.7070  Mult_acc_5: 0.4714  Mult_acc_7: 0.4596  MAE: 0.6414  Corr: 0.5713 
2024-07-02 17:14:41:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-mosei-regression.pth.
2024-07-02 17:18:44:INFO:TRAIN-(cmcm) (1/4/1)>> loss: 0.5757
2024-07-02 17:19:10:INFO:VAL-(cmcm) >>
2024-07-02 17:19:10:INFO:M: >>  Has0_acc_2: 0.8161  Has0_F1_score: 0.7989  Non0_acc_2: 0.6606  Non0_F1_score: 0.6623  Mult_acc_5: 0.5056  Mult_acc_7: 0.4933  MAE: 0.6182  Corr: 0.5920 
2024-07-02 17:19:11:INFO:Saving checkpoint at epoch 4 to results/models/cmcm-mosei-regression.pth.
2024-07-02 17:23:14:INFO:TRAIN-(cmcm) (1/5/1)>> loss: 0.5598
2024-07-02 17:23:40:INFO:VAL-(cmcm) >>
2024-07-02 17:23:40:INFO:M: >>  Has0_acc_2: 0.8311  Has0_F1_score: 0.8269  Non0_acc_2: 0.5445  Non0_F1_score: 0.5154  Mult_acc_5: 0.4949  Mult_acc_7: 0.4864  MAE: 0.6211  Corr: 0.6327 
2024-07-02 17:27:42:INFO:TRAIN-(cmcm) (2/6/1)>> loss: 0.5471
2024-07-02 17:28:09:INFO:VAL-(cmcm) >>
2024-07-02 17:28:09:INFO:M: >>  Has0_acc_2: 0.8231  Has0_F1_score: 0.8050  Non0_acc_2: 0.6252  Non0_F1_score: 0.6186  Mult_acc_5: 0.5398  Mult_acc_7: 0.5286  MAE: 0.5744  Corr: 0.6486 
2024-07-02 17:28:10:INFO:Saving checkpoint at epoch 6 to results/models/cmcm-mosei-regression.pth.
2024-07-02 17:32:15:INFO:TRAIN-(cmcm) (1/7/1)>> loss: 0.5378
2024-07-02 17:32:40:INFO:VAL-(cmcm) >>
2024-07-02 17:32:40:INFO:M: >>  Has0_acc_2: 0.8429  Has0_F1_score: 0.8342  Non0_acc_2: 0.6530  Non0_F1_score: 0.6535  Mult_acc_5: 0.5409  Mult_acc_7: 0.5259  MAE: 0.5617  Corr: 0.6764 
2024-07-02 17:32:41:INFO:Saving checkpoint at epoch 7 to results/models/cmcm-mosei-regression.pth.
2024-07-02 17:36:46:INFO:TRAIN-(cmcm) (1/8/1)>> loss: 0.5301
2024-07-02 17:37:12:INFO:VAL-(cmcm) >>
2024-07-02 17:37:12:INFO:M: >>  Has0_acc_2: 0.8434  Has0_F1_score: 0.8321  Non0_acc_2: 0.6300  Non0_F1_score: 0.6236  Mult_acc_5: 0.5371  Mult_acc_7: 0.5227  MAE: 0.5692  Corr: 0.6571 
2024-07-02 17:41:17:INFO:TRAIN-(cmcm) (2/9/1)>> loss: 0.5246
2024-07-02 17:41:43:INFO:VAL-(cmcm) >>
2024-07-02 17:41:43:INFO:M: >>  Has0_acc_2: 0.8589  Has0_F1_score: 0.8574  Non0_acc_2: 0.5869  Non0_F1_score: 0.5701  Mult_acc_5: 0.5334  Mult_acc_7: 0.5206  MAE: 0.5686  Corr: 0.7054 
2024-07-02 17:45:46:INFO:TRAIN-(cmcm) (3/10/1)>> loss: 0.5195
2024-07-02 17:46:13:INFO:VAL-(cmcm) >>
2024-07-02 17:46:13:INFO:M: >>  Has0_acc_2: 0.8589  Has0_F1_score: 0.8592  Non0_acc_2: 0.7392  Non0_F1_score: 0.7444  Mult_acc_5: 0.5601  Mult_acc_7: 0.5404  MAE: 0.5500  Corr: 0.7286 
2024-07-02 17:46:14:INFO:Saving checkpoint at epoch 10 to results/models/cmcm-mosei-regression.pth.
2024-07-02 17:50:15:INFO:TRAIN-(cmcm) (1/11/1)>> loss: 0.5145
2024-07-02 17:50:41:INFO:VAL-(cmcm) >>
2024-07-02 17:50:41:INFO:M: >>  Has0_acc_2: 0.8509  Has0_F1_score: 0.8436  Non0_acc_2: 0.6613  Non0_F1_score: 0.6608  Mult_acc_5: 0.5719  Mult_acc_7: 0.5537  MAE: 0.5422  Corr: 0.7146 
2024-07-02 17:50:42:INFO:Saving checkpoint at epoch 11 to results/models/cmcm-mosei-regression.pth.
2024-07-02 17:54:56:INFO:TRAIN-(cmcm) (1/12/1)>> loss: 0.5107
2024-07-02 17:55:18:INFO:VAL-(cmcm) >>
2024-07-02 17:55:18:INFO:M: >>  Has0_acc_2: 0.8546  Has0_F1_score: 0.8468  Non0_acc_2: 0.7886  Non0_F1_score: 0.7932  Mult_acc_5: 0.5639  Mult_acc_7: 0.5484  MAE: 0.5193  Corr: 0.7301 
2024-07-02 17:55:19:INFO:Saving checkpoint at epoch 12 to results/models/cmcm-mosei-regression.pth.
2024-07-02 17:59:32:INFO:TRAIN-(cmcm) (1/13/1)>> loss: 0.5083
2024-07-02 17:59:58:INFO:VAL-(cmcm) >>
2024-07-02 17:59:58:INFO:M: >>  Has0_acc_2: 0.8546  Has0_F1_score: 0.8462  Non0_acc_2: 0.6613  Non0_F1_score: 0.6600  Mult_acc_5: 0.5623  Mult_acc_7: 0.5500  MAE: 0.5356  Corr: 0.7069 
2024-07-02 18:04:10:INFO:TRAIN-(cmcm) (2/14/1)>> loss: 0.5036
2024-07-02 18:04:36:INFO:VAL-(cmcm) >>
2024-07-02 18:04:36:INFO:M: >>  Has0_acc_2: 0.8552  Has0_F1_score: 0.8473  Non0_acc_2: 0.7079  Non0_F1_score: 0.7115  Mult_acc_5: 0.5596  Mult_acc_7: 0.5436  MAE: 0.5295  Corr: 0.7177 
2024-07-02 18:08:47:INFO:TRAIN-(cmcm) (3/15/1)>> loss: 0.5006
2024-07-02 18:09:11:INFO:VAL-(cmcm) >>
2024-07-02 18:09:11:INFO:M: >>  Has0_acc_2: 0.8316  Has0_F1_score: 0.8107  Non0_acc_2: 0.7211  Non0_F1_score: 0.7262  Mult_acc_5: 0.5617  Mult_acc_7: 0.5473  MAE: 0.5350  Corr: 0.7037 
2024-07-02 18:13:22:INFO:TRAIN-(cmcm) (4/16/1)>> loss: 0.4977
2024-07-02 18:13:49:INFO:VAL-(cmcm) >>
2024-07-02 18:13:49:INFO:M: >>  Has0_acc_2: 0.8584  Has0_F1_score: 0.8559  Non0_acc_2: 0.6453  Non0_F1_score: 0.6423  Mult_acc_5: 0.5601  Mult_acc_7: 0.5420  MAE: 0.5456  Corr: 0.7074 
2024-07-02 18:18:00:INFO:TRAIN-(cmcm) (5/17/1)>> loss: 0.4936
2024-07-02 18:18:27:INFO:VAL-(cmcm) >>
2024-07-02 18:18:27:INFO:M: >>  Has0_acc_2: 0.8616  Has0_F1_score: 0.8585  Non0_acc_2: 0.7184  Non0_F1_score: 0.7230  Mult_acc_5: 0.5601  Mult_acc_7: 0.5457  MAE: 0.5215  Corr: 0.7304 
2024-07-02 18:22:43:INFO:TRAIN-(cmcm) (6/18/1)>> loss: 0.4899
2024-07-02 18:23:09:INFO:VAL-(cmcm) >>
2024-07-02 18:23:09:INFO:M: >>  Has0_acc_2: 0.8530  Has0_F1_score: 0.8489  Non0_acc_2: 0.6947  Non0_F1_score: 0.6980  Mult_acc_5: 0.5591  Mult_acc_7: 0.5420  MAE: 0.5415  Corr: 0.7114 
2024-07-02 18:27:23:INFO:TRAIN-(cmcm) (7/19/1)>> loss: 0.4857
2024-07-02 18:27:50:INFO:VAL-(cmcm) >>
2024-07-02 18:27:50:INFO:M: >>  Has0_acc_2: 0.8642  Has0_F1_score: 0.8612  Non0_acc_2: 0.6829  Non0_F1_score: 0.6849  Mult_acc_5: 0.5676  Mult_acc_7: 0.5532  MAE: 0.5279  Corr: 0.7182 
2024-07-02 18:32:02:INFO:TRAIN-(cmcm) (8/20/1)>> loss: 0.4818
2024-07-02 18:32:28:INFO:VAL-(cmcm) >>
2024-07-02 18:32:28:INFO:M: >>  Has0_acc_2: 0.8530  Has0_F1_score: 0.8470  Non0_acc_2: 0.7079  Non0_F1_score: 0.7121  Mult_acc_5: 0.5548  Mult_acc_7: 0.5409  MAE: 0.5328  Corr: 0.7134 
2024-07-02 18:36:43:INFO:TRAIN-(cmcm) (9/21/1)>> loss: 0.4774
2024-07-02 18:37:08:INFO:VAL-(cmcm) >>
2024-07-02 18:37:08:INFO:M: >>  Has0_acc_2: 0.8487  Has0_F1_score: 0.8413  Non0_acc_2: 0.7267  Non0_F1_score: 0.7320  Mult_acc_5: 0.5494  Mult_acc_7: 0.5329  MAE: 0.5388  Corr: 0.7128 
2024-07-02 18:41:20:INFO:TRAIN-(cmcm) (10/22/1)>> loss: 0.4721
2024-07-02 18:41:47:INFO:VAL-(cmcm) >>
2024-07-02 18:41:47:INFO:M: >>  Has0_acc_2: 0.8562  Has0_F1_score: 0.8496  Non0_acc_2: 0.6996  Non0_F1_score: 0.7036  Mult_acc_5: 0.5468  Mult_acc_7: 0.5329  MAE: 0.5495  Corr: 0.6999 
2024-07-02 18:42:52:INFO:TEST-(cmcm) >>
2024-07-02 18:42:52:INFO:M: >>  Has0_acc_2: 0.8478  Has0_F1_score: 0.8411  Non0_acc_2: 0.8010  Non0_F1_score: 0.8043  Mult_acc_5: 0.5484  Mult_acc_7: 0.5329  MAE: 0.5383  Corr: 0.7479 
2024-07-02 18:42:52:INFO:Results are added to results/results/mosei-regression-30.csv...
2025-02-18 12:19:29:INFO:Start running cmcm...
2025-02-18 12:19:29:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosei', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'gpu_ids': [], 'seeds': [1111], 'dataPath': '/home/young/DL/multimodal_dataset/MOSEI/Processed/unaligned_50.pkl', 'seq_lens': (50, 500, 375), 'feature_dims': (2048, 74, 35), 'train_samples': 16326, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'pretrain_LM': 'qwen/Qwen-1_8B', 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 64, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2025-02-18 12:19:29:INFO:Find gpu: 1, with memory: 385613824 left!
2025-02-18 12:19:29:INFO:Let's use the GPU 1 !
2025-02-18 12:19:41:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2025-02-18 12:19:41:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1739852381 HTTP/1.1" 200 263
2025-02-18 12:19:41:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 263
2025-02-18 12:19:42:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2025-02-18 12:19:42:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2025-02-18 12:19:42:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=cache_autogptq_cuda_256.cpp HTTP/1.1" 200 8404
2025-02-18 12:19:42:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2025-02-18 12:19:43:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=cache_autogptq_cuda_kernel_256.cu HTTP/1.1" 200 51991
2025-02-18 12:19:43:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2025-02-18 12:19:43:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=assets/cli_demo.gif HTTP/1.1" 200 249464
2025-02-18 12:19:43:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2025-02-18 12:19:44:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=assets/code_interpreter_showcase_001.jpg HTTP/1.1" 200 138442
2025-02-18 12:19:44:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2025-02-18 12:19:44:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=config.json HTTP/1.1" 200 910
2025-02-18 12:19:44:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2025-02-18 12:19:45:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=configuration.json HTTP/1.1" 200 88
2025-02-18 12:19:45:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2025-02-18 12:19:45:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=configuration_qwen.py HTTP/1.1" 200 2345
2025-02-18 12:19:45:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2025-02-18 12:19:46:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=cpp_kernels.py HTTP/1.1" 200 1924
2025-02-18 12:19:46:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2025-02-18 12:19:46:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=generation_config.json HTTP/1.1" 200 222
2025-02-18 12:19:46:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2025-02-18 12:19:47:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=assets/hfagent_chat_1.png HTTP/1.1" 200 1708738
2025-02-18 12:19:47:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2025-02-18 12:19:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=assets/hfagent_chat_2.png HTTP/1.1" 200 1927640
2025-02-18 12:19:48:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2025-02-18 12:19:48:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=assets/hfagent_run.png HTTP/1.1" 200 2770957
2025-02-18 12:19:49:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2025-02-18 12:19:50:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=LICENSE.md HTTP/1.1" 200 7282
2025-02-18 12:19:50:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2025-02-18 12:19:50:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=assets/logo.jpg HTTP/1.1" 200 82693
2025-02-18 12:19:50:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2025-02-18 12:19:51:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=assets/logoqwen.jpg HTTP/1.1" 200 82693
2025-02-18 12:19:51:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2025-02-18 12:19:51:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=modeling_qwen.py HTTP/1.1" 200 55618
2025-02-18 12:19:51:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2025-02-18 12:19:52:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=NOTICE.md HTTP/1.1" 200 15311
2025-02-18 12:19:52:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2025-02-18 12:19:52:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=assets/openai_api.gif HTTP/1.1" 200 242414
2025-02-18 12:19:53:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2025-02-18 12:19:53:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=assets/performance.png HTTP/1.1" 200 118491
2025-02-18 12:19:53:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2025-02-18 12:19:54:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=qwen.tiktoken HTTP/1.1" 200 2561218
2025-02-18 12:19:55:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2025-02-18 12:19:56:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=assets/qwen_72b_needle_in_a_haystack.png HTTP/1.1" 200 484091
2025-02-18 12:19:56:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2025-02-18 12:19:57:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=qwen_generation_utils.py HTTP/1.1" 200 14604
2025-02-18 12:19:57:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2025-02-18 12:19:57:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=assets/qwen_tokenizer.png HTTP/1.1" 200 80947
2025-02-18 12:19:57:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2025-02-18 12:19:58:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=assets/qwen_tokenizer_old.png HTTP/1.1" 200 47558
2025-02-18 12:19:58:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2025-02-18 12:19:58:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=assets/radar_14b.jpg HTTP/1.1" 200 1032407
2025-02-18 12:19:58:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2025-02-18 12:19:59:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=assets/radar_72b.jpg HTTP/1.1" 200 209533
2025-02-18 12:19:59:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2025-02-18 12:19:59:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=assets/radar_72b.pdf HTTP/1.1" 200 19908
2025-02-18 12:20:00:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2025-02-18 12:20:01:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=assets/react_showcase_001.png HTTP/1.1" 200 309444
2025-02-18 12:20:01:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2025-02-18 12:20:01:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=assets/react_showcase_002.png HTTP/1.1" 200 629511
2025-02-18 12:20:02:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2025-02-18 12:20:02:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=assets/react_tutorial_001.png HTTP/1.1" 200 384709
2025-02-18 12:20:03:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2025-02-18 12:20:03:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=assets/react_tutorial_002.png HTTP/1.1" 200 455206
2025-02-18 12:20:04:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2025-02-18 12:20:05:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=README.md HTTP/1.1" 200 18594
2025-02-18 12:20:05:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2025-02-18 12:20:05:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=assets/system_prompt_behavior_setting.png HTTP/1.1" 200 404974
2025-02-18 12:20:05:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2025-02-18 12:20:06:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=assets/system_prompt_behavior_setting_en.png HTTP/1.1" 200 179839
2025-02-18 12:20:06:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2025-02-18 12:20:06:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=assets/system_prompt_language_style.png HTTP/1.1" 200 186122
2025-02-18 12:20:07:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2025-02-18 12:20:07:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=assets/system_prompt_language_style_en.png HTTP/1.1" 200 843517
2025-02-18 12:20:07:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2025-02-18 12:20:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=assets/system_prompt_role_play.png HTTP/1.1" 200 436597
2025-02-18 12:20:08:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2025-02-18 12:20:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=assets/system_prompt_role_play_en.png HTTP/1.1" 200 443108
2025-02-18 12:20:09:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2025-02-18 12:20:09:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=assets/system_prompt_task_setting.png HTTP/1.1" 200 476693
2025-02-18 12:20:09:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2025-02-18 12:20:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=assets/system_prompt_task_setting_en.png HTTP/1.1" 200 413015
2025-02-18 12:20:10:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2025-02-18 12:20:11:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=tokenization_qwen.py HTTP/1.1" 200 9618
2025-02-18 12:20:11:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2025-02-18 12:20:11:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=assets/tokenizer.pdf HTTP/1.1" 200 412800
2025-02-18 12:20:11:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2025-02-18 12:20:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=assets/tokenizer.png HTTP/1.1" 200 80947
2025-02-18 12:20:12:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2025-02-18 12:20:12:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=tokenizer_config.json HTTP/1.1" 200 173
2025-02-18 12:20:12:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2025-02-18 12:20:13:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=assets/tokenizer_old.pdf HTTP/1.1" 200 42912
2025-02-18 12:20:13:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2025-02-18 12:20:13:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=assets/tokenizer_old.png HTTP/1.1" 200 236005
2025-02-18 12:20:13:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2025-02-18 12:20:14:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=assets/wanx_colorful_black.png HTTP/1.1" 200 1326970
2025-02-18 12:20:14:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2025-02-18 12:20:15:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=assets/web_demo.gif HTTP/1.1" 200 680110
2025-02-18 12:20:15:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2025-02-18 12:20:16:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=assets/wechat.png HTTP/1.1" 200 413332
2025-02-18 12:21:03:INFO:train samples: (16326,)
2025-02-18 12:21:25:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2025-02-18 12:21:25:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1739852485 HTTP/1.1" 200 263
2025-02-18 12:21:26:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 263
2025-02-18 12:21:26:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2025-02-18 12:21:27:INFO:valid samples: (1871,)
2025-02-18 12:21:35:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2025-02-18 12:21:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1739852495 HTTP/1.1" 200 263
2025-02-18 12:21:35:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 263
2025-02-18 12:21:36:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2025-02-18 12:21:38:INFO:test samples: (4659,)
2025-02-18 12:21:39:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2025-02-18 12:21:39:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1739852500 HTTP/1.1" 200 263
2025-02-18 12:21:40:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 263
2025-02-18 12:21:40:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2025-02-18 12:21:41:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2025-02-18 12:21:41:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1739852501 HTTP/1.1" 200 263
2025-02-18 12:21:41:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/revisions?EndTime=1701705600 HTTP/1.1" 200 263
2025-02-18 12:21:42:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo/files?Revision=v1.0.0&Recursive=True HTTP/1.1" 200 None
2025-02-18 12:21:42:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2025-02-18 12:21:42:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2025-02-18 12:21:42:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2025-02-18 12:21:42:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2025-02-18 12:21:43:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=model-00001-of-00002.safetensors HTTP/1.1" 200 167772160
2025-02-18 12:21:43:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=model-00001-of-00002.safetensors HTTP/1.1" 200 167772160
2025-02-18 12:21:43:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=model-00001-of-00002.safetensors HTTP/1.1" 200 167772160
2025-02-18 12:21:43:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=model-00001-of-00002.safetensors HTTP/1.1" 200 167772160
2025-02-18 12:22:07:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2025-02-18 12:22:08:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=model-00001-of-00002.safetensors HTTP/1.1" 200 167772160
2025-02-18 12:22:09:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2025-02-18 12:22:10:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=model-00001-of-00002.safetensors HTTP/1.1" 200 167772160
2025-02-18 12:22:29:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2025-02-18 12:22:29:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=model-00001-of-00002.safetensors HTTP/1.1" 200 167772160
2025-02-18 12:22:40:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2025-02-18 12:22:40:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=model-00001-of-00002.safetensors HTTP/1.1" 200 167772160
2025-02-18 12:22:44:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2025-02-18 12:22:45:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=model-00001-of-00002.safetensors HTTP/1.1" 200 167772160
2025-02-18 12:22:58:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2025-02-18 12:22:59:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=model-00001-of-00002.safetensors HTTP/1.1" 200 167772160
2025-02-18 12:23:16:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2025-02-18 12:23:17:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=model-00001-of-00002.safetensors HTTP/1.1" 200 167772160
2025-02-18 12:23:48:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2025-02-18 12:23:49:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=model-00001-of-00002.safetensors HTTP/1.1" 200 167772160
2025-02-18 12:23:53:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2025-02-18 12:23:53:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=model-00001-of-00002.safetensors HTTP/1.1" 200 25993088
2025-02-18 12:27:23:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2025-02-18 12:27:23:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2025-02-18 12:27:23:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2025-02-18 12:27:23:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2025-02-18 12:27:23:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=model-00002-of-00002.safetensors HTTP/1.1" 200 167772160
2025-02-18 12:27:23:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=model-00002-of-00002.safetensors HTTP/1.1" 200 167772160
2025-02-18 12:27:24:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=model-00002-of-00002.safetensors HTTP/1.1" 200 167772160
2025-02-18 12:27:24:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=model-00002-of-00002.safetensors HTTP/1.1" 200 167772160
2025-02-18 12:27:56:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2025-02-18 12:27:57:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=model-00002-of-00002.safetensors HTTP/1.1" 200 167772160
2025-02-18 12:28:00:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2025-02-18 12:28:01:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=model-00002-of-00002.safetensors HTTP/1.1" 200 167772160
2025-02-18 12:28:05:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2025-02-18 12:28:05:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=model-00002-of-00002.safetensors HTTP/1.1" 200 167772160
2025-02-18 12:28:19:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2025-02-18 12:28:20:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=model-00002-of-00002.safetensors HTTP/1.1" 200 167772160
2025-02-18 12:28:23:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2025-02-18 12:28:24:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=model-00002-of-00002.safetensors HTTP/1.1" 200 167772160
2025-02-18 12:28:32:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2025-02-18 12:28:33:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=model-00002-of-00002.safetensors HTTP/1.1" 200 124469824
2025-02-18 12:29:42:DEBUG:Starting new HTTPS connection (1): www.modelscope.cn:443
2025-02-18 12:29:42:DEBUG:https://www.modelscope.cn:443 "GET /api/v1/models/qwen/Qwen-1_8B/repo?Revision=v1.0.0&FilePath=model.safetensors.index.json HTTP/1.1" 200 14706
2025-02-18 12:29:43:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2025-02-18 12:29:43:WARNING:Try importing flash-attention for faster inference...
2025-02-18 12:29:43:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2025-02-18 12:29:43:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2025-02-18 12:29:43:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2025-02-18 12:29:51:INFO:trainable params: 1351244 || all params: 1838179916 || trainable%: 0.073509888136543
2025-02-18 12:29:51:INFO:Init labels...
2025-02-18 12:29:51:INFO:Start training...
2025-02-18 12:33:25:INFO:TRAIN-(cmcm) (1/1/1)>> loss: 1.0262
2025-02-18 16:41:27:INFO:Start running cmcm...
2025-02-18 16:41:27:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'simsv2', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'pretrain_LM': '/data/huggingface_model/Qwen/Qwen-1_8B/', 'gpu_ids': [], 'seeds': [1111], 'dataPath': '/home/young/DL/multimodal_dataset/SIMS_V2/ch-simsv2s.pkl', 'seq_lens': (50, 925, 232), 'feature_dims': (2048, 25, 177), 'train_samples': 2722, 'num_classes': 3, 'language': 'cn', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'max_new_tokens': 4, 'pseudo_tokens': 4, 'task_specific_prompt': '[-1.0, +1.0]: ', 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 64, 'v_lstm_hidden_size': 64, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'update_epochs': 1, 'early_stop': 10, 'gamma': 1, 'H': 1.0, 'seed': 1111}>
2025-02-18 16:41:27:INFO:Find gpu: 2, with memory: 385613824 left!
2025-02-18 16:41:27:INFO:Let's use the GPU 2 !
2025-02-18 16:41:30:INFO:train samples: (2722,)
2025-02-18 16:41:32:INFO:valid samples: (647,)
2025-02-18 16:41:34:INFO:test samples: (1034,)
2025-02-18 16:41:35:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2025-02-18 16:41:35:WARNING:Try importing flash-attention for faster inference...
2025-02-18 16:41:35:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2025-02-18 16:41:35:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2025-02-18 16:41:35:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2025-02-18 16:41:36:INFO:trainable params: 1400268 || all params: 1838228940 || trainable%: 0.0761748425090076
2025-02-18 16:41:36:INFO:Init labels...
2025-02-18 16:41:36:INFO:Start training...
2025-02-18 16:42:13:INFO:TRAIN-(cmcm) (1/1/1)>> loss: 1.1167
2025-02-18 16:42:20:INFO:VAL-(cmcm) >>
2025-02-18 16:42:20:INFO:M: >>  Mult_acc_2: 0.6151  F1_score: 0.4718  Mult_acc_2_weak: 0.6745  MAE: 0.6575  Corr: 0.0645  Mult_acc_3: 0.5193  Mult_acc_5: 0.2473  R_squre: -0.8992 
2025-02-18 16:42:22:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-simsv2-regression.pth.
2025-02-18 16:43:01:INFO:TRAIN-(cmcm) (1/2/1)>> loss: 0.6062
2025-02-18 16:43:09:INFO:VAL-(cmcm) >>
2025-02-18 16:43:09:INFO:M: >>  Mult_acc_2: 0.5270  F1_score: 0.5007  Mult_acc_2_weak: 0.4549  MAE: 0.6155  Corr: 0.2313  Mult_acc_3: 0.5039  Mult_acc_5: 0.3308  R_squre: -0.7657 
2025-02-18 16:43:10:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-simsv2-regression.pth.
2025-02-18 16:43:49:INFO:TRAIN-(cmcm) (1/3/1)>> loss: 0.5782
2025-02-18 16:43:56:INFO:VAL-(cmcm) >>
2025-02-18 16:43:56:INFO:M: >>  Mult_acc_2: 0.6291  F1_score: 0.5023  Mult_acc_2_weak: 0.6824  MAE: 0.5947  Corr: 0.1660  Mult_acc_3: 0.5332  Mult_acc_5: 0.3431  R_squre: -0.6402 
2025-02-18 16:43:57:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-simsv2-regression.pth.
2025-02-18 16:44:36:INFO:TRAIN-(cmcm) (1/4/1)>> loss: 0.5517
2025-02-18 16:44:43:INFO:VAL-(cmcm) >>
2025-02-18 16:44:43:INFO:M: >>  Mult_acc_2: 0.5796  F1_score: 0.5596  Mult_acc_2_weak: 0.4745  MAE: 0.6334  Corr: 0.3460  Mult_acc_3: 0.5564  Mult_acc_5: 0.2488  R_squre: -0.9015 
2025-02-18 16:45:22:INFO:TRAIN-(cmcm) (2/5/1)>> loss: 0.5136
2025-02-18 16:45:29:INFO:VAL-(cmcm) >>
2025-02-18 16:45:29:INFO:M: >>  Mult_acc_2: 0.7651  F1_score: 0.7560  Mult_acc_2_weak: 0.7216  MAE: 0.3842  Corr: 0.5617  Mult_acc_3: 0.6677  Mult_acc_5: 0.4328  R_squre: 0.1930 
2025-02-18 16:45:30:INFO:Saving checkpoint at epoch 5 to results/models/cmcm-simsv2-regression.pth.
2025-02-18 16:46:09:INFO:TRAIN-(cmcm) (1/6/1)>> loss: 0.4882
2025-02-18 16:46:16:INFO:VAL-(cmcm) >>
2025-02-18 16:46:16:INFO:M: >>  Mult_acc_2: 0.7728  F1_score: 0.7584  Mult_acc_2_weak: 0.7294  MAE: 0.3941  Corr: 0.5487  Mult_acc_3: 0.6847  Mult_acc_5: 0.4374  R_squre: 0.1437 
2025-02-18 16:46:54:INFO:TRAIN-(cmcm) (2/7/1)>> loss: 0.4742
2025-02-18 16:47:02:INFO:VAL-(cmcm) >>
2025-02-18 16:47:02:INFO:M: >>  Mult_acc_2: 0.7759  F1_score: 0.7666  Mult_acc_2_weak: 0.7373  MAE: 0.3867  Corr: 0.5488  Mult_acc_3: 0.6893  Mult_acc_5: 0.4498  R_squre: 0.1532 
2025-02-18 16:47:40:INFO:TRAIN-(cmcm) (3/8/1)>> loss: 0.4578
2025-02-18 16:47:48:INFO:VAL-(cmcm) >>
2025-02-18 16:47:48:INFO:M: >>  Mult_acc_2: 0.7821  F1_score: 0.7745  Mult_acc_2_weak: 0.7490  MAE: 0.3805  Corr: 0.5563  Mult_acc_3: 0.7002  Mult_acc_5: 0.4699  R_squre: 0.1678 
2025-02-18 16:47:49:INFO:Saving checkpoint at epoch 8 to results/models/cmcm-simsv2-regression.pth.
2025-02-18 16:48:27:INFO:TRAIN-(cmcm) (1/9/1)>> loss: 0.4437
2025-02-18 16:48:35:INFO:VAL-(cmcm) >>
2025-02-18 16:48:35:INFO:M: >>  Mult_acc_2: 0.7573  F1_score: 0.7600  Mult_acc_2_weak: 0.6745  MAE: 0.3805  Corr: 0.5544  Mult_acc_3: 0.7079  Mult_acc_5: 0.4838  R_squre: 0.1373 
2025-02-18 16:49:13:INFO:TRAIN-(cmcm) (2/10/1)>> loss: 0.4305
2025-02-18 16:49:20:INFO:VAL-(cmcm) >>
2025-02-18 16:49:20:INFO:M: >>  Mult_acc_2: 0.7960  F1_score: 0.7946  Mult_acc_2_weak: 0.7608  MAE: 0.3549  Corr: 0.5970  Mult_acc_3: 0.7187  Mult_acc_5: 0.5131  R_squre: 0.2281 
2025-02-18 16:49:21:INFO:Saving checkpoint at epoch 10 to results/models/cmcm-simsv2-regression.pth.
2025-02-18 16:50:00:INFO:TRAIN-(cmcm) (1/11/1)>> loss: 0.4173
2025-02-18 16:50:07:INFO:VAL-(cmcm) >>
2025-02-18 16:50:07:INFO:M: >>  Mult_acc_2: 0.7682  F1_score: 0.7609  Mult_acc_2_weak: 0.7176  MAE: 0.3648  Corr: 0.5600  Mult_acc_3: 0.6584  Mult_acc_5: 0.4389  R_squre: 0.2376 
2025-02-18 16:50:46:INFO:TRAIN-(cmcm) (2/12/1)>> loss: 0.4073
2025-02-18 16:50:53:INFO:VAL-(cmcm) >>
2025-02-18 16:50:53:INFO:M: >>  Mult_acc_2: 0.7697  F1_score: 0.7662  Mult_acc_2_weak: 0.7333  MAE: 0.3645  Corr: 0.5694  Mult_acc_3: 0.6847  Mult_acc_5: 0.4822  R_squre: 0.2072 
2025-02-18 16:51:31:INFO:TRAIN-(cmcm) (3/13/1)>> loss: 0.3926
2025-02-18 16:51:39:INFO:VAL-(cmcm) >>
2025-02-18 16:51:39:INFO:M: >>  Mult_acc_2: 0.7434  F1_score: 0.7465  Mult_acc_2_weak: 0.6588  MAE: 0.3864  Corr: 0.5596  Mult_acc_3: 0.6368  Mult_acc_5: 0.4482  R_squre: 0.1561 
2025-02-18 16:52:17:INFO:TRAIN-(cmcm) (4/14/1)>> loss: 0.3829
2025-02-18 16:52:24:INFO:VAL-(cmcm) >>
2025-02-18 16:52:24:INFO:M: >>  Mult_acc_2: 0.7743  F1_score: 0.7757  Mult_acc_2_weak: 0.7176  MAE: 0.3731  Corr: 0.5782  Mult_acc_3: 0.6940  Mult_acc_5: 0.4822  R_squre: 0.1998 
2025-02-18 16:53:02:INFO:TRAIN-(cmcm) (5/15/1)>> loss: 0.3734
2025-02-18 16:53:10:INFO:VAL-(cmcm) >>
2025-02-18 16:53:10:INFO:M: >>  Mult_acc_2: 0.7666  F1_score: 0.7679  Mult_acc_2_weak: 0.7137  MAE: 0.3765  Corr: 0.5617  Mult_acc_3: 0.6662  Mult_acc_5: 0.4760  R_squre: 0.1507 
2025-02-18 16:53:48:INFO:TRAIN-(cmcm) (6/16/1)>> loss: 0.3625
2025-02-18 16:53:55:INFO:VAL-(cmcm) >>
2025-02-18 16:53:55:INFO:M: >>  Mult_acc_2: 0.7604  F1_score: 0.7610  Mult_acc_2_weak: 0.6941  MAE: 0.3802  Corr: 0.5516  Mult_acc_3: 0.6801  Mult_acc_5: 0.4869  R_squre: 0.1405 
2025-02-18 16:54:32:INFO:TRAIN-(cmcm) (7/17/1)>> loss: 0.3508
2025-02-18 16:54:40:INFO:VAL-(cmcm) >>
2025-02-18 16:54:40:INFO:M: >>  Mult_acc_2: 0.7821  F1_score: 0.7788  Mult_acc_2_weak: 0.7373  MAE: 0.3632  Corr: 0.5757  Mult_acc_3: 0.7002  Mult_acc_5: 0.5008  R_squre: 0.1699 
2025-02-18 16:55:16:INFO:TRAIN-(cmcm) (8/18/1)>> loss: 0.3310
2025-02-18 16:55:24:INFO:VAL-(cmcm) >>
2025-02-18 16:55:24:INFO:M: >>  Mult_acc_2: 0.7836  F1_score: 0.7800  Mult_acc_2_weak: 0.7451  MAE: 0.3583  Corr: 0.5661  Mult_acc_3: 0.6955  Mult_acc_5: 0.4977  R_squre: 0.2616 
2025-02-18 16:55:59:INFO:TRAIN-(cmcm) (9/19/1)>> loss: 0.3190
2025-02-18 16:56:07:INFO:VAL-(cmcm) >>
2025-02-18 16:56:07:INFO:M: >>  Mult_acc_2: 0.7759  F1_score: 0.7768  Mult_acc_2_weak: 0.7137  MAE: 0.3598  Corr: 0.5923  Mult_acc_3: 0.7017  Mult_acc_5: 0.5162  R_squre: 0.2138 
2025-02-18 16:56:45:INFO:TRAIN-(cmcm) (10/20/1)>> loss: 0.2981
2025-02-18 16:56:53:INFO:VAL-(cmcm) >>
2025-02-18 16:56:53:INFO:M: >>  Mult_acc_2: 0.7743  F1_score: 0.7754  Mult_acc_2_weak: 0.7020  MAE: 0.3549  Corr: 0.6057  Mult_acc_3: 0.7017  Mult_acc_5: 0.5070  R_squre: 0.2431 
2025-02-18 16:57:05:INFO:TEST-(cmcm) >>
2025-02-18 16:57:05:INFO:M: >>  Mult_acc_2: 0.7940  F1_score: 0.7931  Mult_acc_2_weak: 0.7205  MAE: 0.3449  Corr: 0.6378  Mult_acc_3: 0.7244  Mult_acc_5: 0.5348  R_squre: 0.2305 
2025-02-18 16:57:06:INFO:Results are added to results/results/simsv2-regression-30.csv...
2025-02-18 16:57:06:INFO:Start running cmcm...
2025-02-18 16:57:06:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosei', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'pretrain_LM': '/data/huggingface_model/Qwen/Qwen-1_8B/', 'gpu_ids': [2], 'seeds': [1111], 'dataPath': '/home/young/DL/multimodal_dataset/MOSEI/Processed/unaligned_50.pkl', 'seq_lens': (50, 500, 375), 'feature_dims': (2048, 74, 35), 'train_samples': 16326, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 64, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2025-02-18 16:57:06:INFO:Let's use the GPU 2 !
2025-02-18 16:57:17:INFO:train samples: (16326,)
2025-02-18 16:57:25:INFO:valid samples: (1871,)
2025-02-18 16:57:34:INFO:test samples: (4659,)
2025-02-18 16:57:35:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2025-02-18 16:57:35:WARNING:Try importing flash-attention for faster inference...
2025-02-18 16:57:35:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2025-02-18 16:57:35:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2025-02-18 16:57:35:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2025-02-18 16:57:36:INFO:trainable params: 1351244 || all params: 1838179916 || trainable%: 0.073509888136543
2025-02-18 16:57:36:INFO:Init labels...
2025-02-18 16:57:36:INFO:Start training...
2025-02-18 17:01:16:INFO:TRAIN-(cmcm) (1/1/1)>> loss: 1.0262
2025-02-18 17:01:38:INFO:VAL-(cmcm) >>
2025-02-18 17:01:38:INFO:M: >>  Has0_acc_2: 0.7402  Has0_F1_score: 0.6416  Non0_acc_2: 0.6328  Non0_F1_score: 0.5773  Mult_acc_5: 0.4409  Mult_acc_7: 0.4399  MAE: 0.7691  Corr: 0.1657 
2025-02-18 17:01:39:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosei-regression.pth.
2025-02-18 17:05:17:INFO:TRAIN-(cmcm) (1/2/1)>> loss: 0.6101
2025-02-18 17:05:39:INFO:VAL-(cmcm) >>
2025-02-18 17:05:39:INFO:M: >>  Has0_acc_2: 0.7974  Has0_F1_score: 0.7961  Non0_acc_2: 0.4506  Non0_F1_score: 0.3773  Mult_acc_5: 0.4666  Mult_acc_7: 0.4570  MAE: 0.7275  Corr: 0.5406 
2025-02-18 17:05:41:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosei-regression.pth.
2025-02-18 17:09:11:INFO:TRAIN-(cmcm) (1/3/1)>> loss: 0.5884
2025-02-18 17:09:33:INFO:VAL-(cmcm) >>
2025-02-18 17:09:33:INFO:M: >>  Has0_acc_2: 0.8065  Has0_F1_score: 0.7898  Non0_acc_2: 0.7003  Non0_F1_score: 0.7070  Mult_acc_5: 0.4714  Mult_acc_7: 0.4596  MAE: 0.6414  Corr: 0.5713 
2025-02-18 17:09:34:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-mosei-regression.pth.
2025-02-18 17:13:02:INFO:TRAIN-(cmcm) (1/4/1)>> loss: 0.5757
2025-02-18 17:13:23:INFO:VAL-(cmcm) >>
2025-02-18 17:13:23:INFO:M: >>  Has0_acc_2: 0.8161  Has0_F1_score: 0.7989  Non0_acc_2: 0.6606  Non0_F1_score: 0.6623  Mult_acc_5: 0.5056  Mult_acc_7: 0.4933  MAE: 0.6182  Corr: 0.5920 
2025-02-18 17:13:25:INFO:Saving checkpoint at epoch 4 to results/models/cmcm-mosei-regression.pth.
2025-02-18 17:17:02:INFO:TRAIN-(cmcm) (1/5/1)>> loss: 0.5598
2025-02-18 17:17:24:INFO:VAL-(cmcm) >>
2025-02-18 17:17:24:INFO:M: >>  Has0_acc_2: 0.8311  Has0_F1_score: 0.8269  Non0_acc_2: 0.5445  Non0_F1_score: 0.5154  Mult_acc_5: 0.4949  Mult_acc_7: 0.4864  MAE: 0.6211  Corr: 0.6327 
2025-02-18 17:20:51:INFO:TRAIN-(cmcm) (2/6/1)>> loss: 0.5471
2025-02-18 17:21:13:INFO:VAL-(cmcm) >>
2025-02-18 17:21:13:INFO:M: >>  Has0_acc_2: 0.8231  Has0_F1_score: 0.8050  Non0_acc_2: 0.6252  Non0_F1_score: 0.6186  Mult_acc_5: 0.5398  Mult_acc_7: 0.5286  MAE: 0.5744  Corr: 0.6486 
2025-02-18 17:21:14:INFO:Saving checkpoint at epoch 6 to results/models/cmcm-mosei-regression.pth.
2025-02-18 17:24:49:INFO:TRAIN-(cmcm) (1/7/1)>> loss: 0.5378
2025-02-18 17:25:10:INFO:VAL-(cmcm) >>
2025-02-18 17:25:10:INFO:M: >>  Has0_acc_2: 0.8429  Has0_F1_score: 0.8342  Non0_acc_2: 0.6530  Non0_F1_score: 0.6535  Mult_acc_5: 0.5409  Mult_acc_7: 0.5259  MAE: 0.5617  Corr: 0.6764 
2025-02-18 17:25:12:INFO:Saving checkpoint at epoch 7 to results/models/cmcm-mosei-regression.pth.
2025-02-18 17:28:41:INFO:TRAIN-(cmcm) (1/8/1)>> loss: 0.5301
2025-02-18 17:29:04:INFO:VAL-(cmcm) >>
2025-02-18 17:29:04:INFO:M: >>  Has0_acc_2: 0.8434  Has0_F1_score: 0.8321  Non0_acc_2: 0.6300  Non0_F1_score: 0.6236  Mult_acc_5: 0.5371  Mult_acc_7: 0.5227  MAE: 0.5692  Corr: 0.6571 
2025-02-18 17:32:31:INFO:TRAIN-(cmcm) (2/9/1)>> loss: 0.5246
2025-02-18 17:32:53:INFO:VAL-(cmcm) >>
2025-02-18 17:32:53:INFO:M: >>  Has0_acc_2: 0.8589  Has0_F1_score: 0.8574  Non0_acc_2: 0.5869  Non0_F1_score: 0.5701  Mult_acc_5: 0.5334  Mult_acc_7: 0.5206  MAE: 0.5686  Corr: 0.7054 
2025-02-18 17:36:33:INFO:TRAIN-(cmcm) (3/10/1)>> loss: 0.5195
2025-02-18 17:36:54:INFO:VAL-(cmcm) >>
2025-02-18 17:36:54:INFO:M: >>  Has0_acc_2: 0.8589  Has0_F1_score: 0.8592  Non0_acc_2: 0.7392  Non0_F1_score: 0.7444  Mult_acc_5: 0.5601  Mult_acc_7: 0.5404  MAE: 0.5500  Corr: 0.7286 
2025-02-18 17:36:56:INFO:Saving checkpoint at epoch 10 to results/models/cmcm-mosei-regression.pth.
2025-02-18 17:40:32:INFO:TRAIN-(cmcm) (1/11/1)>> loss: 0.5145
2025-02-18 17:40:54:INFO:VAL-(cmcm) >>
2025-02-18 17:40:54:INFO:M: >>  Has0_acc_2: 0.8509  Has0_F1_score: 0.8436  Non0_acc_2: 0.6613  Non0_F1_score: 0.6608  Mult_acc_5: 0.5719  Mult_acc_7: 0.5537  MAE: 0.5422  Corr: 0.7146 
2025-02-18 17:40:55:INFO:Saving checkpoint at epoch 11 to results/models/cmcm-mosei-regression.pth.
2025-02-18 17:44:31:INFO:TRAIN-(cmcm) (1/12/1)>> loss: 0.5107
2025-02-18 17:44:53:INFO:VAL-(cmcm) >>
2025-02-18 17:44:53:INFO:M: >>  Has0_acc_2: 0.8546  Has0_F1_score: 0.8468  Non0_acc_2: 0.7886  Non0_F1_score: 0.7932  Mult_acc_5: 0.5639  Mult_acc_7: 0.5484  MAE: 0.5193  Corr: 0.7301 
2025-02-18 17:44:55:INFO:Saving checkpoint at epoch 12 to results/models/cmcm-mosei-regression.pth.
2025-02-18 17:45:57:INFO:Start running cmcm...
2025-02-18 17:45:57:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'simsv2', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'pretrain_LM': '/data/huggingface_model/Qwen/Qwen-1_8B/', 'gpu_ids': [], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/SIMS_V2/ch-simsv2s.pkl', 'seq_lens': (50, 925, 232), 'feature_dims': (2048, 25, 177), 'train_samples': 2722, 'num_classes': 3, 'language': 'cn', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'max_new_tokens': 4, 'pseudo_tokens': 4, 'task_specific_prompt': '[-1.0, +1.0]: ', 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 64, 'v_lstm_hidden_size': 64, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'update_epochs': 1, 'early_stop': 10, 'gamma': 1, 'H': 1.0, 'seed': 1111}>
2025-02-18 17:45:57:INFO:Find gpu: 2, with memory: 385613824 left!
2025-02-18 17:45:57:INFO:Let's use the GPU 2 !
2025-02-18 17:46:00:INFO:train samples: (2722,)
2025-02-18 17:46:02:INFO:valid samples: (647,)
2025-02-18 17:46:04:INFO:test samples: (1034,)
2025-02-18 17:46:05:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2025-02-18 17:46:05:WARNING:Try importing flash-attention for faster inference...
2025-02-18 17:46:05:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2025-02-18 17:46:05:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2025-02-18 17:46:05:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2025-02-18 17:46:08:INFO:trainable params: 1400268 || all params: 1838228940 || trainable%: 0.0761748425090076
2025-02-18 17:46:08:INFO:Init labels...
2025-02-18 17:46:08:INFO:Start training...
2025-02-18 17:46:44:INFO:TRAIN-(cmcm) (1/1/1)>> loss: 1.1167
2025-02-18 17:46:51:INFO:VAL-(cmcm) >>
2025-02-18 17:46:52:INFO:M: >>  Mult_acc_2: 0.6151  F1_score: 0.4718  Mult_acc_2_weak: 0.6745  MAE: 0.6575  Corr: 0.0645  Mult_acc_3: 0.5193  Mult_acc_5: 0.2473  R_squre: -0.8992 
2025-02-18 17:46:54:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-simsv2-regression.pth.
2025-02-18 17:47:33:INFO:TRAIN-(cmcm) (1/2/1)>> loss: 0.6062
2025-02-18 17:47:41:INFO:VAL-(cmcm) >>
2025-02-18 17:47:41:INFO:M: >>  Mult_acc_2: 0.5270  F1_score: 0.5007  Mult_acc_2_weak: 0.4549  MAE: 0.6155  Corr: 0.2313  Mult_acc_3: 0.5039  Mult_acc_5: 0.3308  R_squre: -0.7657 
2025-02-18 17:47:42:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-simsv2-regression.pth.
2025-02-18 17:48:21:INFO:TRAIN-(cmcm) (1/3/1)>> loss: 0.5782
2025-02-18 17:48:29:INFO:VAL-(cmcm) >>
2025-02-18 17:48:29:INFO:M: >>  Mult_acc_2: 0.6291  F1_score: 0.5023  Mult_acc_2_weak: 0.6824  MAE: 0.5947  Corr: 0.1660  Mult_acc_3: 0.5332  Mult_acc_5: 0.3431  R_squre: -0.6402 
2025-02-18 17:48:30:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-simsv2-regression.pth.
2025-02-18 17:49:09:INFO:TRAIN-(cmcm) (1/4/1)>> loss: 0.5517
2025-02-18 17:49:16:INFO:VAL-(cmcm) >>
2025-02-18 17:49:16:INFO:M: >>  Mult_acc_2: 0.5796  F1_score: 0.5596  Mult_acc_2_weak: 0.4745  MAE: 0.6334  Corr: 0.3460  Mult_acc_3: 0.5564  Mult_acc_5: 0.2488  R_squre: -0.9015 
2025-02-18 17:49:54:INFO:TRAIN-(cmcm) (2/5/1)>> loss: 0.5136
2025-02-18 17:50:02:INFO:VAL-(cmcm) >>
2025-02-18 17:50:02:INFO:M: >>  Mult_acc_2: 0.7651  F1_score: 0.7560  Mult_acc_2_weak: 0.7216  MAE: 0.3842  Corr: 0.5617  Mult_acc_3: 0.6677  Mult_acc_5: 0.4328  R_squre: 0.1930 
2025-02-18 17:50:03:INFO:Saving checkpoint at epoch 5 to results/models/cmcm-simsv2-regression.pth.
2025-02-18 17:50:42:INFO:TRAIN-(cmcm) (1/6/1)>> loss: 0.4882
2025-02-18 17:50:50:INFO:VAL-(cmcm) >>
2025-02-18 17:50:50:INFO:M: >>  Mult_acc_2: 0.7728  F1_score: 0.7584  Mult_acc_2_weak: 0.7294  MAE: 0.3941  Corr: 0.5487  Mult_acc_3: 0.6847  Mult_acc_5: 0.4374  R_squre: 0.1437 
2025-02-18 17:51:28:INFO:TRAIN-(cmcm) (2/7/1)>> loss: 0.4742
2025-02-18 17:51:35:INFO:VAL-(cmcm) >>
2025-02-18 17:51:35:INFO:M: >>  Mult_acc_2: 0.7759  F1_score: 0.7666  Mult_acc_2_weak: 0.7373  MAE: 0.3867  Corr: 0.5488  Mult_acc_3: 0.6893  Mult_acc_5: 0.4498  R_squre: 0.1532 
2025-02-18 17:52:14:INFO:TRAIN-(cmcm) (3/8/1)>> loss: 0.4578
2025-02-18 17:52:21:INFO:VAL-(cmcm) >>
2025-02-18 17:52:21:INFO:M: >>  Mult_acc_2: 0.7821  F1_score: 0.7745  Mult_acc_2_weak: 0.7490  MAE: 0.3805  Corr: 0.5563  Mult_acc_3: 0.7002  Mult_acc_5: 0.4699  R_squre: 0.1678 
2025-02-18 17:52:22:INFO:Saving checkpoint at epoch 8 to results/models/cmcm-simsv2-regression.pth.
2025-02-18 17:53:01:INFO:TRAIN-(cmcm) (1/9/1)>> loss: 0.4437
2025-02-18 17:53:09:INFO:VAL-(cmcm) >>
2025-02-18 17:53:09:INFO:M: >>  Mult_acc_2: 0.7573  F1_score: 0.7600  Mult_acc_2_weak: 0.6745  MAE: 0.3805  Corr: 0.5544  Mult_acc_3: 0.7079  Mult_acc_5: 0.4838  R_squre: 0.1373 
2025-02-18 17:53:47:INFO:TRAIN-(cmcm) (2/10/1)>> loss: 0.4305
2025-02-18 17:53:54:INFO:VAL-(cmcm) >>
2025-02-18 17:53:54:INFO:M: >>  Mult_acc_2: 0.7960  F1_score: 0.7946  Mult_acc_2_weak: 0.7608  MAE: 0.3549  Corr: 0.5970  Mult_acc_3: 0.7187  Mult_acc_5: 0.5131  R_squre: 0.2281 
2025-02-18 17:53:55:INFO:Saving checkpoint at epoch 10 to results/models/cmcm-simsv2-regression.pth.
2025-02-18 17:54:33:INFO:TRAIN-(cmcm) (1/11/1)>> loss: 0.4173
2025-02-18 17:54:40:INFO:VAL-(cmcm) >>
2025-02-18 17:54:40:INFO:M: >>  Mult_acc_2: 0.7682  F1_score: 0.7609  Mult_acc_2_weak: 0.7176  MAE: 0.3648  Corr: 0.5600  Mult_acc_3: 0.6584  Mult_acc_5: 0.4389  R_squre: 0.2376 
2025-02-18 17:55:19:INFO:TRAIN-(cmcm) (2/12/1)>> loss: 0.4073
2025-02-18 17:55:26:INFO:VAL-(cmcm) >>
2025-02-18 17:55:26:INFO:M: >>  Mult_acc_2: 0.7697  F1_score: 0.7662  Mult_acc_2_weak: 0.7333  MAE: 0.3645  Corr: 0.5694  Mult_acc_3: 0.6847  Mult_acc_5: 0.4822  R_squre: 0.2072 
2025-02-18 17:56:04:INFO:TRAIN-(cmcm) (3/13/1)>> loss: 0.3926
2025-02-18 17:56:12:INFO:VAL-(cmcm) >>
2025-02-18 17:56:12:INFO:M: >>  Mult_acc_2: 0.7434  F1_score: 0.7465  Mult_acc_2_weak: 0.6588  MAE: 0.3864  Corr: 0.5596  Mult_acc_3: 0.6368  Mult_acc_5: 0.4482  R_squre: 0.1561 
2025-02-18 17:56:50:INFO:TRAIN-(cmcm) (4/14/1)>> loss: 0.3829
2025-02-18 17:56:58:INFO:VAL-(cmcm) >>
2025-02-18 17:56:58:INFO:M: >>  Mult_acc_2: 0.7743  F1_score: 0.7757  Mult_acc_2_weak: 0.7176  MAE: 0.3731  Corr: 0.5782  Mult_acc_3: 0.6940  Mult_acc_5: 0.4822  R_squre: 0.1998 
2025-02-18 17:57:36:INFO:TRAIN-(cmcm) (5/15/1)>> loss: 0.3734
2025-02-18 17:57:44:INFO:VAL-(cmcm) >>
2025-02-18 17:57:44:INFO:M: >>  Mult_acc_2: 0.7666  F1_score: 0.7679  Mult_acc_2_weak: 0.7137  MAE: 0.3765  Corr: 0.5617  Mult_acc_3: 0.6662  Mult_acc_5: 0.4760  R_squre: 0.1507 
2025-02-18 17:58:22:INFO:TRAIN-(cmcm) (6/16/1)>> loss: 0.3625
2025-02-18 17:58:30:INFO:VAL-(cmcm) >>
2025-02-18 17:58:30:INFO:M: >>  Mult_acc_2: 0.7604  F1_score: 0.7610  Mult_acc_2_weak: 0.6941  MAE: 0.3802  Corr: 0.5516  Mult_acc_3: 0.6801  Mult_acc_5: 0.4869  R_squre: 0.1405 
2025-02-18 17:59:08:INFO:TRAIN-(cmcm) (7/17/1)>> loss: 0.3508
2025-02-18 17:59:15:INFO:VAL-(cmcm) >>
2025-02-18 17:59:16:INFO:M: >>  Mult_acc_2: 0.7821  F1_score: 0.7788  Mult_acc_2_weak: 0.7373  MAE: 0.3632  Corr: 0.5757  Mult_acc_3: 0.7002  Mult_acc_5: 0.5008  R_squre: 0.1699 
2025-02-18 17:59:54:INFO:TRAIN-(cmcm) (8/18/1)>> loss: 0.3310
2025-02-18 18:00:02:INFO:VAL-(cmcm) >>
2025-02-18 18:00:02:INFO:M: >>  Mult_acc_2: 0.7836  F1_score: 0.7800  Mult_acc_2_weak: 0.7451  MAE: 0.3583  Corr: 0.5661  Mult_acc_3: 0.6955  Mult_acc_5: 0.4977  R_squre: 0.2616 
2025-02-18 18:00:40:INFO:TRAIN-(cmcm) (9/19/1)>> loss: 0.3190
2025-02-18 18:00:47:INFO:VAL-(cmcm) >>
2025-02-18 18:00:47:INFO:M: >>  Mult_acc_2: 0.7759  F1_score: 0.7768  Mult_acc_2_weak: 0.7137  MAE: 0.3598  Corr: 0.5923  Mult_acc_3: 0.7017  Mult_acc_5: 0.5162  R_squre: 0.2138 
2025-02-18 18:01:25:INFO:TRAIN-(cmcm) (10/20/1)>> loss: 0.2981
2025-02-18 18:01:33:INFO:VAL-(cmcm) >>
2025-02-18 18:01:33:INFO:M: >>  Mult_acc_2: 0.7743  F1_score: 0.7754  Mult_acc_2_weak: 0.7020  MAE: 0.3549  Corr: 0.6057  Mult_acc_3: 0.7017  Mult_acc_5: 0.5070  R_squre: 0.2431 
2025-02-18 18:01:45:INFO:TEST-(cmcm) >>
2025-02-18 18:01:45:INFO:M: >>  Mult_acc_2: 0.7940  F1_score: 0.7931  Mult_acc_2_weak: 0.7205  MAE: 0.3449  Corr: 0.6378  Mult_acc_3: 0.7244  Mult_acc_5: 0.5348  R_squre: 0.2305 
2025-02-18 18:01:46:INFO:Results are added to results/results/simsv2-regression-30.csv...
2025-02-18 18:01:46:INFO:Start running cmcm...
2025-02-18 18:01:46:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'simsv2', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'pretrain_LM': '/data/huggingface_model/Qwen/Qwen-1_8B/', 'gpu_ids': [2], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/SIMS_V2/ch-simsv2s.pkl', 'seq_lens': (50, 925, 232), 'feature_dims': (2048, 25, 177), 'train_samples': 2722, 'num_classes': 3, 'language': 'cn', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'max_new_tokens': 4, 'pseudo_tokens': 4, 'task_specific_prompt': '[-1.0, +1.0]: ', 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 64, 'v_lstm_hidden_size': 64, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'update_epochs': 1, 'early_stop': 10, 'gamma': 1, 'H': 1.0, 'seed': 2222}>
2025-02-18 18:01:46:INFO:Let's use the GPU 2 !
2025-02-18 18:01:48:INFO:train samples: (2722,)
2025-02-18 18:01:50:INFO:valid samples: (647,)
2025-02-18 18:01:52:INFO:test samples: (1034,)
2025-02-18 18:01:52:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2025-02-18 18:01:52:WARNING:Try importing flash-attention for faster inference...
2025-02-18 18:01:52:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2025-02-18 18:01:52:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2025-02-18 18:01:52:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2025-02-18 18:01:54:INFO:trainable params: 1400268 || all params: 1838228940 || trainable%: 0.0761748425090076
2025-02-18 18:01:54:INFO:Init labels...
2025-02-18 18:01:54:INFO:Start training...
2025-02-18 18:02:32:INFO:TRAIN-(cmcm) (1/1/2)>> loss: 2.0993
2025-02-18 18:02:40:INFO:VAL-(cmcm) >>
2025-02-18 18:02:40:INFO:M: >>  Mult_acc_2: 0.3879  F1_score: 0.2196  Mult_acc_2_weak: 0.3255  MAE: 0.8961  Corr: -0.0081  Mult_acc_3: 0.3864  Mult_acc_5: 0.1190  R_squre: -2.1607 
2025-02-18 18:02:41:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-simsv2-regression.pth.
2025-02-18 18:03:19:INFO:TRAIN-(cmcm) (1/2/2)>> loss: 0.6650
2025-02-18 18:03:27:INFO:VAL-(cmcm) >>
2025-02-18 18:03:27:INFO:M: >>  Mult_acc_2: 0.6399  F1_score: 0.5314  Mult_acc_2_weak: 0.6941  MAE: 0.5750  Corr: 0.2242  Mult_acc_3: 0.5471  Mult_acc_5: 0.3524  R_squre: -0.5519 
2025-02-18 18:03:28:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-simsv2-regression.pth.
2025-02-18 18:04:06:INFO:TRAIN-(cmcm) (1/3/2)>> loss: 0.5830
2025-02-18 18:04:14:INFO:VAL-(cmcm) >>
2025-02-18 18:04:14:INFO:M: >>  Mult_acc_2: 0.6043  F1_score: 0.6014  Mult_acc_2_weak: 0.5333  MAE: 0.5391  Corr: 0.3286  Mult_acc_3: 0.5811  Mult_acc_5: 0.3833  R_squre: -0.4640 
2025-02-18 18:04:15:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-simsv2-regression.pth.
2025-02-18 18:04:53:INFO:TRAIN-(cmcm) (1/4/2)>> loss: 0.5282
2025-02-18 18:05:01:INFO:VAL-(cmcm) >>
2025-02-18 18:05:01:INFO:M: >>  Mult_acc_2: 0.7713  F1_score: 0.7731  Mult_acc_2_weak: 0.7216  MAE: 0.4019  Corr: 0.5245  Mult_acc_3: 0.6491  Mult_acc_5: 0.4250  R_squre: 0.0984 
2025-02-18 18:05:02:INFO:Saving checkpoint at epoch 4 to results/models/cmcm-simsv2-regression.pth.
2025-02-18 18:05:40:INFO:TRAIN-(cmcm) (1/5/2)>> loss: 0.4993
2025-02-18 18:05:48:INFO:VAL-(cmcm) >>
2025-02-18 18:05:48:INFO:M: >>  Mult_acc_2: 0.7682  F1_score: 0.7680  Mult_acc_2_weak: 0.7333  MAE: 0.3935  Corr: 0.5443  Mult_acc_3: 0.6012  Mult_acc_5: 0.3849  R_squre: 0.1692 
2025-02-18 18:05:49:INFO:Saving checkpoint at epoch 5 to results/models/cmcm-simsv2-regression.pth.
2025-02-18 18:06:28:INFO:TRAIN-(cmcm) (1/6/2)>> loss: 0.4769
2025-02-18 18:06:35:INFO:VAL-(cmcm) >>
2025-02-18 18:06:35:INFO:M: >>  Mult_acc_2: 0.7883  F1_score: 0.7812  Mult_acc_2_weak: 0.7569  MAE: 0.3879  Corr: 0.5574  Mult_acc_3: 0.7002  Mult_acc_5: 0.4420  R_squre: 0.1526 
2025-02-18 18:06:36:INFO:Saving checkpoint at epoch 6 to results/models/cmcm-simsv2-regression.pth.
2025-02-18 18:07:15:INFO:TRAIN-(cmcm) (1/7/2)>> loss: 0.4621
2025-02-18 18:07:22:INFO:VAL-(cmcm) >>
2025-02-18 18:07:22:INFO:M: >>  Mult_acc_2: 0.7913  F1_score: 0.7903  Mult_acc_2_weak: 0.7529  MAE: 0.3753  Corr: 0.5720  Mult_acc_3: 0.7094  Mult_acc_5: 0.4529  R_squre: 0.1996 
2025-02-18 18:07:23:INFO:Saving checkpoint at epoch 7 to results/models/cmcm-simsv2-regression.pth.
2025-02-18 18:08:01:INFO:TRAIN-(cmcm) (1/8/2)>> loss: 0.4503
2025-02-18 18:08:08:INFO:VAL-(cmcm) >>
2025-02-18 18:08:08:INFO:M: >>  Mult_acc_2: 0.7635  F1_score: 0.7660  Mult_acc_2_weak: 0.6902  MAE: 0.4124  Corr: 0.5618  Mult_acc_3: 0.6893  Mult_acc_5: 0.3787  R_squre: 0.0441 
2025-02-18 18:08:46:INFO:TRAIN-(cmcm) (2/9/2)>> loss: 0.4408
2025-02-18 18:08:53:INFO:VAL-(cmcm) >>
2025-02-18 18:08:53:INFO:M: >>  Mult_acc_2: 0.7975  F1_score: 0.7919  Mult_acc_2_weak: 0.7529  MAE: 0.3394  Corr: 0.6306  Mult_acc_3: 0.6692  Mult_acc_5: 0.4374  R_squre: 0.3670 
2025-02-18 18:08:55:INFO:Saving checkpoint at epoch 9 to results/models/cmcm-simsv2-regression.pth.
2025-02-18 18:09:33:INFO:TRAIN-(cmcm) (1/10/2)>> loss: 0.4227
2025-02-18 18:09:41:INFO:VAL-(cmcm) >>
2025-02-18 18:09:41:INFO:M: >>  Mult_acc_2: 0.8037  F1_score: 0.8016  Mult_acc_2_weak: 0.7490  MAE: 0.3515  Corr: 0.6089  Mult_acc_3: 0.7326  Mult_acc_5: 0.4838  R_squre: 0.2697 
2025-02-18 18:10:19:INFO:TRAIN-(cmcm) (2/11/2)>> loss: 0.4110
2025-02-18 18:10:26:INFO:VAL-(cmcm) >>
2025-02-18 18:10:26:INFO:M: >>  Mult_acc_2: 0.7898  F1_score: 0.7872  Mult_acc_2_weak: 0.7412  MAE: 0.3536  Corr: 0.6112  Mult_acc_3: 0.6739  Mult_acc_5: 0.4683  R_squre: 0.2835 
2025-02-18 18:11:04:INFO:TRAIN-(cmcm) (3/12/2)>> loss: 0.4015
2025-02-18 18:11:11:INFO:VAL-(cmcm) >>
2025-02-18 18:11:11:INFO:M: >>  Mult_acc_2: 0.7944  F1_score: 0.7901  Mult_acc_2_weak: 0.7294  MAE: 0.3558  Corr: 0.6125  Mult_acc_3: 0.7172  Mult_acc_5: 0.4946  R_squre: 0.2293 
2025-02-18 18:11:49:INFO:TRAIN-(cmcm) (4/13/2)>> loss: 0.3907
2025-02-18 18:11:57:INFO:VAL-(cmcm) >>
2025-02-18 18:11:57:INFO:M: >>  Mult_acc_2: 0.7713  F1_score: 0.7741  Mult_acc_2_weak: 0.6863  MAE: 0.3660  Corr: 0.6140  Mult_acc_3: 0.7156  Mult_acc_5: 0.4869  R_squre: 0.1969 
2025-02-18 18:12:35:INFO:TRAIN-(cmcm) (5/14/2)>> loss: 0.3835
2025-02-18 18:12:43:INFO:VAL-(cmcm) >>
2025-02-18 18:12:43:INFO:M: >>  Mult_acc_2: 0.7944  F1_score: 0.7953  Mult_acc_2_weak: 0.7176  MAE: 0.3431  Corr: 0.6290  Mult_acc_3: 0.7187  Mult_acc_5: 0.5100  R_squre: 0.2967 
2025-02-18 18:13:20:INFO:TRAIN-(cmcm) (6/15/2)>> loss: 0.3755
2025-02-18 18:13:28:INFO:VAL-(cmcm) >>
2025-02-18 18:13:28:INFO:M: >>  Mult_acc_2: 0.8022  F1_score: 0.8038  Mult_acc_2_weak: 0.7176  MAE: 0.3348  Corr: 0.6367  Mult_acc_3: 0.7280  Mult_acc_5: 0.4992  R_squre: 0.3166 
2025-02-18 18:13:29:INFO:Saving checkpoint at epoch 15 to results/models/cmcm-simsv2-regression.pth.
2025-02-18 18:14:07:INFO:TRAIN-(cmcm) (1/16/2)>> loss: 0.3594
2025-02-18 18:14:15:INFO:VAL-(cmcm) >>
2025-02-18 18:14:15:INFO:M: >>  Mult_acc_2: 0.7960  F1_score: 0.7967  Mult_acc_2_weak: 0.7373  MAE: 0.3512  Corr: 0.6170  Mult_acc_3: 0.7187  Mult_acc_5: 0.5100  R_squre: 0.2882 
2025-02-18 18:14:53:INFO:TRAIN-(cmcm) (2/17/2)>> loss: 0.3434
2025-02-18 18:15:00:INFO:VAL-(cmcm) >>
2025-02-18 18:15:00:INFO:M: >>  Mult_acc_2: 0.7960  F1_score: 0.7945  Mult_acc_2_weak: 0.7412  MAE: 0.3382  Corr: 0.6288  Mult_acc_3: 0.6986  Mult_acc_5: 0.5008  R_squre: 0.3133 
2025-02-18 18:15:38:INFO:TRAIN-(cmcm) (3/18/2)>> loss: 0.3350
2025-02-18 18:15:46:INFO:VAL-(cmcm) >>
2025-02-18 18:15:46:INFO:M: >>  Mult_acc_2: 0.7883  F1_score: 0.7848  Mult_acc_2_weak: 0.7255  MAE: 0.3450  Corr: 0.6176  Mult_acc_3: 0.7017  Mult_acc_5: 0.4745  R_squre: 0.2967 
2025-02-18 18:16:24:INFO:TRAIN-(cmcm) (4/19/2)>> loss: 0.3215
2025-02-18 18:16:31:INFO:VAL-(cmcm) >>
2025-02-18 18:16:31:INFO:M: >>  Mult_acc_2: 0.7975  F1_score: 0.7953  Mult_acc_2_weak: 0.7333  MAE: 0.3332  Corr: 0.6422  Mult_acc_3: 0.7141  Mult_acc_5: 0.5054  R_squre: 0.3259 
2025-02-18 18:16:33:INFO:Saving checkpoint at epoch 19 to results/models/cmcm-simsv2-regression.pth.
2025-02-18 18:17:11:INFO:TRAIN-(cmcm) (1/20/2)>> loss: 0.3096
2025-02-18 18:17:18:INFO:VAL-(cmcm) >>
2025-02-18 18:17:18:INFO:M: >>  Mult_acc_2: 0.7821  F1_score: 0.7825  Mult_acc_2_weak: 0.7059  MAE: 0.3447  Corr: 0.6236  Mult_acc_3: 0.7017  Mult_acc_5: 0.5147  R_squre: 0.2633 
2025-02-18 18:17:56:INFO:TRAIN-(cmcm) (2/21/2)>> loss: 0.2980
2025-02-18 18:18:04:INFO:VAL-(cmcm) >>
2025-02-18 18:18:04:INFO:M: >>  Mult_acc_2: 0.7821  F1_score: 0.7823  Mult_acc_2_weak: 0.7059  MAE: 0.3499  Corr: 0.6227  Mult_acc_3: 0.7032  Mult_acc_5: 0.4977  R_squre: 0.2570 
2025-02-18 18:18:42:INFO:TRAIN-(cmcm) (3/22/2)>> loss: 0.2850
2025-02-18 18:18:50:INFO:VAL-(cmcm) >>
2025-02-18 18:18:50:INFO:M: >>  Mult_acc_2: 0.7867  F1_score: 0.7851  Mult_acc_2_weak: 0.7137  MAE: 0.3431  Corr: 0.6328  Mult_acc_3: 0.7017  Mult_acc_5: 0.5008  R_squre: 0.2943 
2025-02-18 18:19:27:INFO:TRAIN-(cmcm) (4/23/2)>> loss: 0.2720
2025-02-18 18:19:35:INFO:VAL-(cmcm) >>
2025-02-18 18:19:35:INFO:M: >>  Mult_acc_2: 0.7867  F1_score: 0.7870  Mult_acc_2_weak: 0.7020  MAE: 0.3505  Corr: 0.6278  Mult_acc_3: 0.7125  Mult_acc_5: 0.5070  R_squre: 0.2668 
2025-02-18 18:20:13:INFO:TRAIN-(cmcm) (5/24/2)>> loss: 0.2600
2025-02-18 18:20:21:INFO:VAL-(cmcm) >>
2025-02-18 18:20:21:INFO:M: >>  Mult_acc_2: 0.7913  F1_score: 0.7904  Mult_acc_2_weak: 0.7176  MAE: 0.3493  Corr: 0.6196  Mult_acc_3: 0.7110  Mult_acc_5: 0.5039  R_squre: 0.2801 
2025-02-18 18:20:59:INFO:TRAIN-(cmcm) (6/25/2)>> loss: 0.2517
2025-02-18 18:21:06:INFO:VAL-(cmcm) >>
2025-02-18 18:21:06:INFO:M: >>  Mult_acc_2: 0.7836  F1_score: 0.7841  Mult_acc_2_weak: 0.6980  MAE: 0.3530  Corr: 0.6146  Mult_acc_3: 0.7063  Mult_acc_5: 0.4977  R_squre: 0.2580 
2025-02-18 18:21:44:INFO:TRAIN-(cmcm) (7/26/2)>> loss: 0.2437
2025-02-18 18:21:52:INFO:VAL-(cmcm) >>
2025-02-18 18:21:52:INFO:M: >>  Mult_acc_2: 0.7774  F1_score: 0.7780  Mult_acc_2_weak: 0.6902  MAE: 0.3573  Corr: 0.6100  Mult_acc_3: 0.6971  Mult_acc_5: 0.4884  R_squre: 0.2492 
2025-02-18 18:22:30:INFO:TRAIN-(cmcm) (8/27/2)>> loss: 0.2367
2025-02-18 18:22:37:INFO:VAL-(cmcm) >>
2025-02-18 18:22:37:INFO:M: >>  Mult_acc_2: 0.7836  F1_score: 0.7838  Mult_acc_2_weak: 0.6902  MAE: 0.3539  Corr: 0.6170  Mult_acc_3: 0.7094  Mult_acc_5: 0.4946  R_squre: 0.2633 
2025-02-18 18:23:15:INFO:TRAIN-(cmcm) (9/28/2)>> loss: 0.2343
2025-02-18 18:23:23:INFO:VAL-(cmcm) >>
2025-02-18 18:23:23:INFO:M: >>  Mult_acc_2: 0.7805  F1_score: 0.7813  Mult_acc_2_weak: 0.6902  MAE: 0.3570  Corr: 0.6112  Mult_acc_3: 0.7017  Mult_acc_5: 0.4915  R_squre: 0.2500 
2025-02-18 18:24:01:INFO:TRAIN-(cmcm) (10/29/2)>> loss: 0.2297
2025-02-18 18:24:08:INFO:VAL-(cmcm) >>
2025-02-18 18:24:08:INFO:M: >>  Mult_acc_2: 0.7836  F1_score: 0.7842  Mult_acc_2_weak: 0.6941  MAE: 0.3515  Corr: 0.6205  Mult_acc_3: 0.7032  Mult_acc_5: 0.4930  R_squre: 0.2728 
2025-02-18 18:24:20:INFO:TEST-(cmcm) >>
2025-02-18 18:24:20:INFO:M: >>  Mult_acc_2: 0.8124  F1_score: 0.8110  Mult_acc_2_weak: 0.7495  MAE: 0.3017  Corr: 0.6944  Mult_acc_3: 0.7495  Mult_acc_5: 0.5638  R_squre: 0.3892 
2025-02-18 18:24:21:INFO:Results are added to results/results/simsv2-regression-30.csv...
2025-02-18 18:24:21:INFO:Start running cmcm...
2025-02-18 18:24:21:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'simsv2', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'pretrain_LM': '/data/huggingface_model/Qwen/Qwen-1_8B/', 'gpu_ids': [2], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/SIMS_V2/ch-simsv2s.pkl', 'seq_lens': (50, 925, 232), 'feature_dims': (2048, 25, 177), 'train_samples': 2722, 'num_classes': 3, 'language': 'cn', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'max_new_tokens': 4, 'pseudo_tokens': 4, 'task_specific_prompt': '[-1.0, +1.0]: ', 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 64, 'v_lstm_hidden_size': 64, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'update_epochs': 1, 'early_stop': 10, 'gamma': 1, 'H': 1.0, 'seed': 3333}>
2025-02-18 18:24:21:INFO:Let's use the GPU 2 !
2025-02-18 18:24:23:INFO:train samples: (2722,)
2025-02-18 18:24:25:INFO:valid samples: (647,)
2025-02-18 18:24:27:INFO:test samples: (1034,)
2025-02-18 18:24:28:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2025-02-18 18:24:28:WARNING:Try importing flash-attention for faster inference...
2025-02-18 18:24:28:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2025-02-18 18:24:28:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2025-02-18 18:24:28:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2025-02-18 18:24:29:INFO:trainable params: 1400268 || all params: 1838228940 || trainable%: 0.0761748425090076
2025-02-18 18:24:29:INFO:Init labels...
2025-02-18 18:24:29:INFO:Start training...
2025-02-18 18:25:07:INFO:TRAIN-(cmcm) (1/1/3)>> loss: 1.4701
2025-02-18 18:25:15:INFO:VAL-(cmcm) >>
2025-02-18 18:25:15:INFO:M: >>  Mult_acc_2: 0.5147  F1_score: 0.5208  Mult_acc_2_weak: 0.4863  MAE: 0.6096  Corr: 0.0651  Mult_acc_3: 0.3493  Mult_acc_5: 0.2427  R_squre: -0.5540 
2025-02-18 18:25:16:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-simsv2-regression.pth.
2025-02-18 18:25:54:INFO:TRAIN-(cmcm) (1/2/3)>> loss: 0.5960
2025-02-18 18:26:02:INFO:VAL-(cmcm) >>
2025-02-18 18:26:02:INFO:M: >>  Mult_acc_2: 0.4219  F1_score: 0.3723  Mult_acc_2_weak: 0.3765  MAE: 0.7094  Corr: -0.0114  Mult_acc_3: 0.3431  Mult_acc_5: 0.2427  R_squre: -1.0890 
2025-02-18 18:26:40:INFO:TRAIN-(cmcm) (2/3/3)>> loss: 0.5712
2025-02-18 18:26:48:INFO:VAL-(cmcm) >>
2025-02-18 18:26:48:INFO:M: >>  Mult_acc_2: 0.6847  F1_score: 0.6887  Mult_acc_2_weak: 0.6235  MAE: 0.4810  Corr: 0.3925  Mult_acc_3: 0.6352  Mult_acc_5: 0.4096  R_squre: -0.2269 
2025-02-18 18:26:49:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-simsv2-regression.pth.
2025-02-18 18:27:27:INFO:TRAIN-(cmcm) (1/4/3)>> loss: 0.5378
2025-02-18 18:27:35:INFO:VAL-(cmcm) >>
2025-02-18 18:27:35:INFO:M: >>  Mult_acc_2: 0.7388  F1_score: 0.7387  Mult_acc_2_weak: 0.7059  MAE: 0.4386  Corr: 0.4557  Mult_acc_3: 0.6615  Mult_acc_5: 0.4250  R_squre: -0.0366 
2025-02-18 18:27:36:INFO:Saving checkpoint at epoch 4 to results/models/cmcm-simsv2-regression.pth.
2025-02-18 18:28:14:INFO:TRAIN-(cmcm) (1/5/3)>> loss: 0.5118
2025-02-18 18:28:22:INFO:VAL-(cmcm) >>
2025-02-18 18:28:22:INFO:M: >>  Mult_acc_2: 0.7697  F1_score: 0.7718  Mult_acc_2_weak: 0.7333  MAE: 0.3963  Corr: 0.5356  Mult_acc_3: 0.6723  Mult_acc_5: 0.4312  R_squre: 0.1055 
2025-02-18 18:28:23:INFO:Saving checkpoint at epoch 5 to results/models/cmcm-simsv2-regression.pth.
2025-02-18 18:29:01:INFO:TRAIN-(cmcm) (1/6/3)>> loss: 0.4830
2025-02-18 18:29:09:INFO:VAL-(cmcm) >>
2025-02-18 18:29:09:INFO:M: >>  Mult_acc_2: 0.7929  F1_score: 0.7909  Mult_acc_2_weak: 0.7451  MAE: 0.3716  Corr: 0.5788  Mult_acc_3: 0.7187  Mult_acc_5: 0.4590  R_squre: 0.2189 
2025-02-18 18:29:10:INFO:Saving checkpoint at epoch 6 to results/models/cmcm-simsv2-regression.pth.
2025-02-18 18:29:49:INFO:TRAIN-(cmcm) (1/7/3)>> loss: 0.4669
2025-02-18 18:29:56:INFO:VAL-(cmcm) >>
2025-02-18 18:29:56:INFO:M: >>  Mult_acc_2: 0.7774  F1_score: 0.7792  Mult_acc_2_weak: 0.7098  MAE: 0.3781  Corr: 0.5742  Mult_acc_3: 0.7110  Mult_acc_5: 0.4699  R_squre: 0.1692 
2025-02-18 18:30:34:INFO:TRAIN-(cmcm) (2/8/3)>> loss: 0.4541
2025-02-18 18:30:42:INFO:VAL-(cmcm) >>
2025-02-18 18:30:42:INFO:M: >>  Mult_acc_2: 0.7774  F1_score: 0.7688  Mult_acc_2_weak: 0.7373  MAE: 0.3577  Corr: 0.5904  Mult_acc_3: 0.6801  Mult_acc_5: 0.4436  R_squre: 0.2969 
2025-02-18 18:30:43:INFO:Saving checkpoint at epoch 8 to results/models/cmcm-simsv2-regression.pth.
2025-02-18 18:31:21:INFO:TRAIN-(cmcm) (1/9/3)>> loss: 0.4516
2025-02-18 18:31:29:INFO:VAL-(cmcm) >>
2025-02-18 18:31:29:INFO:M: >>  Mult_acc_2: 0.7944  F1_score: 0.7954  Mult_acc_2_weak: 0.7098  MAE: 0.3462  Corr: 0.6292  Mult_acc_3: 0.7311  Mult_acc_5: 0.4884  R_squre: 0.2774 
2025-02-18 18:31:30:INFO:Saving checkpoint at epoch 9 to results/models/cmcm-simsv2-regression.pth.
2025-02-18 18:32:08:INFO:TRAIN-(cmcm) (1/10/3)>> loss: 0.4300
2025-02-18 18:32:16:INFO:VAL-(cmcm) >>
2025-02-18 18:32:16:INFO:M: >>  Mult_acc_2: 0.7836  F1_score: 0.7851  Mult_acc_2_weak: 0.7137  MAE: 0.3518  Corr: 0.6114  Mult_acc_3: 0.7063  Mult_acc_5: 0.4575  R_squre: 0.2875 
2025-02-18 18:32:54:INFO:TRAIN-(cmcm) (2/11/3)>> loss: 0.4221
2025-02-18 18:33:01:INFO:VAL-(cmcm) >>
2025-02-18 18:33:01:INFO:M: >>  Mult_acc_2: 0.7805  F1_score: 0.7800  Mult_acc_2_weak: 0.7216  MAE: 0.3629  Corr: 0.5850  Mult_acc_3: 0.7017  Mult_acc_5: 0.4745  R_squre: 0.2030 
2025-02-18 18:33:39:INFO:TRAIN-(cmcm) (3/12/3)>> loss: 0.4066
2025-02-18 18:33:47:INFO:VAL-(cmcm) >>
2025-02-18 18:33:47:INFO:M: >>  Mult_acc_2: 0.7852  F1_score: 0.7860  Mult_acc_2_weak: 0.7098  MAE: 0.3456  Corr: 0.6241  Mult_acc_3: 0.6862  Mult_acc_5: 0.4869  R_squre: 0.2729 
2025-02-18 18:33:48:INFO:Saving checkpoint at epoch 12 to results/models/cmcm-simsv2-regression.pth.
2025-02-18 18:34:24:INFO:TRAIN-(cmcm) (1/13/3)>> loss: 0.3992
2025-02-18 18:34:32:INFO:VAL-(cmcm) >>
2025-02-18 18:34:32:INFO:M: >>  Mult_acc_2: 0.7929  F1_score: 0.7894  Mult_acc_2_weak: 0.7373  MAE: 0.3527  Corr: 0.5938  Mult_acc_3: 0.7125  Mult_acc_5: 0.4900  R_squre: 0.2548 
2025-02-18 18:35:07:INFO:TRAIN-(cmcm) (2/14/3)>> loss: 0.3832
2025-02-18 18:35:15:INFO:VAL-(cmcm) >>
2025-02-18 18:35:15:INFO:M: >>  Mult_acc_2: 0.7883  F1_score: 0.7895  Mult_acc_2_weak: 0.7255  MAE: 0.3468  Corr: 0.6136  Mult_acc_3: 0.7110  Mult_acc_5: 0.5131  R_squre: 0.2465 
2025-02-18 18:35:50:INFO:TRAIN-(cmcm) (3/15/3)>> loss: 0.3727
2025-02-18 18:35:58:INFO:VAL-(cmcm) >>
2025-02-18 18:35:58:INFO:M: >>  Mult_acc_2: 0.7929  F1_score: 0.7881  Mult_acc_2_weak: 0.7490  MAE: 0.3354  Corr: 0.6192  Mult_acc_3: 0.7002  Mult_acc_5: 0.5039  R_squre: 0.3088 
2025-02-18 18:35:59:INFO:Saving checkpoint at epoch 15 to results/models/cmcm-simsv2-regression.pth.
2025-02-18 18:36:35:INFO:TRAIN-(cmcm) (1/16/3)>> loss: 0.3570
2025-02-18 18:36:42:INFO:VAL-(cmcm) >>
2025-02-18 18:36:42:INFO:M: >>  Mult_acc_2: 0.7805  F1_score: 0.7782  Mult_acc_2_weak: 0.7294  MAE: 0.3595  Corr: 0.5944  Mult_acc_3: 0.6924  Mult_acc_5: 0.4853  R_squre: 0.2086 
2025-02-18 18:37:20:INFO:TRAIN-(cmcm) (2/17/3)>> loss: 0.3515
2025-02-18 18:37:28:INFO:VAL-(cmcm) >>
2025-02-18 18:37:28:INFO:M: >>  Mult_acc_2: 0.7944  F1_score: 0.7915  Mult_acc_2_weak: 0.7569  MAE: 0.3502  Corr: 0.5986  Mult_acc_3: 0.6785  Mult_acc_5: 0.4838  R_squre: 0.2521 
2025-02-18 18:38:06:INFO:TRAIN-(cmcm) (3/18/3)>> loss: 0.3328
2025-02-18 18:38:13:INFO:VAL-(cmcm) >>
2025-02-18 18:38:13:INFO:M: >>  Mult_acc_2: 0.8006  F1_score: 0.7992  Mult_acc_2_weak: 0.7569  MAE: 0.3388  Corr: 0.6079  Mult_acc_3: 0.7141  Mult_acc_5: 0.5162  R_squre: 0.2709 
2025-02-18 18:38:51:INFO:TRAIN-(cmcm) (4/19/3)>> loss: 0.3194
2025-02-18 18:38:59:INFO:VAL-(cmcm) >>
2025-02-18 18:38:59:INFO:M: >>  Mult_acc_2: 0.8037  F1_score: 0.8023  Mult_acc_2_weak: 0.7569  MAE: 0.3406  Corr: 0.6197  Mult_acc_3: 0.7125  Mult_acc_5: 0.5039  R_squre: 0.3195 
2025-02-18 18:39:37:INFO:TRAIN-(cmcm) (5/20/3)>> loss: 0.3067
2025-02-18 18:39:44:INFO:VAL-(cmcm) >>
2025-02-18 18:39:44:INFO:M: >>  Mult_acc_2: 0.7836  F1_score: 0.7857  Mult_acc_2_weak: 0.7255  MAE: 0.3493  Corr: 0.6170  Mult_acc_3: 0.7094  Mult_acc_5: 0.5116  R_squre: 0.2573 
2025-02-18 18:40:22:INFO:TRAIN-(cmcm) (6/21/3)>> loss: 0.2921
2025-02-18 18:40:30:INFO:VAL-(cmcm) >>
2025-02-18 18:40:30:INFO:M: >>  Mult_acc_2: 0.7929  F1_score: 0.7935  Mult_acc_2_weak: 0.7255  MAE: 0.3481  Corr: 0.6036  Mult_acc_3: 0.7079  Mult_acc_5: 0.5054  R_squre: 0.2444 
2025-02-18 18:41:08:INFO:TRAIN-(cmcm) (7/22/3)>> loss: 0.2796
2025-02-18 18:41:16:INFO:VAL-(cmcm) >>
2025-02-18 18:41:16:INFO:M: >>  Mult_acc_2: 0.7929  F1_score: 0.7935  Mult_acc_2_weak: 0.7412  MAE: 0.3518  Corr: 0.6010  Mult_acc_3: 0.7156  Mult_acc_5: 0.5116  R_squre: 0.2366 
2025-02-18 18:41:52:INFO:TRAIN-(cmcm) (8/23/3)>> loss: 0.2678
2025-02-18 18:42:00:INFO:VAL-(cmcm) >>
2025-02-18 18:42:00:INFO:M: >>  Mult_acc_2: 0.7883  F1_score: 0.7894  Mult_acc_2_weak: 0.7255  MAE: 0.3499  Corr: 0.6117  Mult_acc_3: 0.7079  Mult_acc_5: 0.4992  R_squre: 0.2570 
2025-02-18 18:42:36:INFO:TRAIN-(cmcm) (9/24/3)>> loss: 0.2538
2025-02-18 18:42:43:INFO:VAL-(cmcm) >>
2025-02-18 18:42:43:INFO:M: >>  Mult_acc_2: 0.7975  F1_score: 0.7971  Mult_acc_2_weak: 0.7333  MAE: 0.3428  Corr: 0.6195  Mult_acc_3: 0.7125  Mult_acc_5: 0.5008  R_squre: 0.2816 
2025-02-18 18:43:20:INFO:TRAIN-(cmcm) (10/25/3)>> loss: 0.2441
2025-02-18 18:43:27:INFO:VAL-(cmcm) >>
2025-02-18 18:43:27:INFO:M: >>  Mult_acc_2: 0.8006  F1_score: 0.8005  Mult_acc_2_weak: 0.7333  MAE: 0.3394  Corr: 0.6209  Mult_acc_3: 0.7141  Mult_acc_5: 0.5070  R_squre: 0.2661 
2025-02-18 18:43:39:INFO:TEST-(cmcm) >>
2025-02-18 18:43:39:INFO:M: >>  Mult_acc_2: 0.7969  F1_score: 0.7932  Mult_acc_2_weak: 0.7143  MAE: 0.3043  Corr: 0.6836  Mult_acc_3: 0.7147  Mult_acc_5: 0.5426  R_squre: 0.3847 
2025-02-18 18:43:39:INFO:Results are added to results/results/simsv2-regression-30.csv...
2025-02-18 18:43:39:INFO:Start running cmcm...
2025-02-18 18:43:39:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'simsv2', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'pretrain_LM': '/data/huggingface_model/Qwen/Qwen-1_8B/', 'gpu_ids': [2], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/SIMS_V2/ch-simsv2s.pkl', 'seq_lens': (50, 925, 232), 'feature_dims': (2048, 25, 177), 'train_samples': 2722, 'num_classes': 3, 'language': 'cn', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'max_new_tokens': 4, 'pseudo_tokens': 4, 'task_specific_prompt': '[-1.0, +1.0]: ', 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 64, 'v_lstm_hidden_size': 64, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'update_epochs': 1, 'early_stop': 10, 'gamma': 1, 'H': 1.0, 'seed': 4444}>
2025-02-18 18:43:39:INFO:Let's use the GPU 2 !
2025-02-18 18:43:42:INFO:train samples: (2722,)
2025-02-18 18:43:44:INFO:valid samples: (647,)
2025-02-18 18:43:45:INFO:test samples: (1034,)
2025-02-18 18:43:46:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2025-02-18 18:43:46:WARNING:Try importing flash-attention for faster inference...
2025-02-18 18:43:46:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2025-02-18 18:43:46:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2025-02-18 18:43:46:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2025-02-18 18:43:47:INFO:trainable params: 1400268 || all params: 1838228940 || trainable%: 0.0761748425090076
2025-02-18 18:43:47:INFO:Init labels...
2025-02-18 18:43:47:INFO:Start training...
2025-02-18 18:44:25:INFO:TRAIN-(cmcm) (1/1/4)>> loss: 1.3083
2025-02-18 18:44:32:INFO:VAL-(cmcm) >>
2025-02-18 18:44:32:INFO:M: >>  Mult_acc_2: 0.5904  F1_score: 0.5678  Mult_acc_2_weak: 0.6000  MAE: 0.5657  Corr: 0.0966  Mult_acc_3: 0.2334  Mult_acc_5: 0.1793  R_squre: -0.2979 
2025-02-18 18:44:34:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-simsv2-regression.pth.
2025-02-18 18:45:12:INFO:TRAIN-(cmcm) (1/2/4)>> loss: 0.6356
2025-02-18 18:45:20:INFO:VAL-(cmcm) >>
2025-02-18 18:45:20:INFO:M: >>  Mult_acc_2: 0.5966  F1_score: 0.5171  Mult_acc_2_weak: 0.6392  MAE: 0.5611  Corr: 0.0742  Mult_acc_3: 0.2504  Mult_acc_5: 0.1886  R_squre: -0.2583 
2025-02-18 18:45:21:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-simsv2-regression.pth.
2025-02-18 18:45:59:INFO:TRAIN-(cmcm) (1/3/4)>> loss: 0.5885
2025-02-18 18:46:07:INFO:VAL-(cmcm) >>
2025-02-18 18:46:07:INFO:M: >>  Mult_acc_2: 0.7450  F1_score: 0.7332  Mult_acc_2_weak: 0.6980  MAE: 0.4417  Corr: 0.4578  Mult_acc_3: 0.6739  Mult_acc_5: 0.4359  R_squre: -0.0614 
2025-02-18 18:46:08:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-simsv2-regression.pth.
2025-02-18 18:46:46:INFO:TRAIN-(cmcm) (1/4/4)>> loss: 0.5446
2025-02-18 18:46:54:INFO:VAL-(cmcm) >>
2025-02-18 18:46:54:INFO:M: >>  Mult_acc_2: 0.7419  F1_score: 0.7217  Mult_acc_2_weak: 0.7098  MAE: 0.4155  Corr: 0.5077  Mult_acc_3: 0.4869  Mult_acc_5: 0.3215  R_squre: 0.2132 
2025-02-18 18:46:55:INFO:Saving checkpoint at epoch 4 to results/models/cmcm-simsv2-regression.pth.
2025-02-18 18:47:33:INFO:TRAIN-(cmcm) (1/5/4)>> loss: 0.5233
2025-02-18 18:47:41:INFO:VAL-(cmcm) >>
2025-02-18 18:47:41:INFO:M: >>  Mult_acc_2: 0.7651  F1_score: 0.7570  Mult_acc_2_weak: 0.7098  MAE: 0.4223  Corr: 0.5158  Mult_acc_3: 0.6893  Mult_acc_5: 0.4297  R_squre: 0.0325 
2025-02-18 18:48:18:INFO:TRAIN-(cmcm) (2/6/4)>> loss: 0.5059
2025-02-18 18:48:25:INFO:VAL-(cmcm) >>
2025-02-18 18:48:25:INFO:M: >>  Mult_acc_2: 0.7063  F1_score: 0.7090  Mult_acc_2_weak: 0.6196  MAE: 0.4507  Corr: 0.4764  Mult_acc_3: 0.6569  Mult_acc_5: 0.4189  R_squre: -0.0986 
2025-02-18 18:49:03:INFO:TRAIN-(cmcm) (3/7/4)>> loss: 0.4908
2025-02-18 18:49:11:INFO:VAL-(cmcm) >>
2025-02-18 18:49:11:INFO:M: >>  Mult_acc_2: 0.7682  F1_score: 0.7686  Mult_acc_2_weak: 0.6941  MAE: 0.3777  Corr: 0.5661  Mult_acc_3: 0.6754  Mult_acc_5: 0.4420  R_squre: 0.2281 
2025-02-18 18:49:12:INFO:Saving checkpoint at epoch 7 to results/models/cmcm-simsv2-regression.pth.
2025-02-18 18:49:50:INFO:TRAIN-(cmcm) (1/8/4)>> loss: 0.4686
2025-02-18 18:49:58:INFO:VAL-(cmcm) >>
2025-02-18 18:49:58:INFO:M: >>  Mult_acc_2: 0.7852  F1_score: 0.7814  Mult_acc_2_weak: 0.7294  MAE: 0.3679  Corr: 0.5886  Mult_acc_3: 0.6832  Mult_acc_5: 0.4467  R_squre: 0.2458 
2025-02-18 18:49:59:INFO:Saving checkpoint at epoch 8 to results/models/cmcm-simsv2-regression.pth.
2025-02-18 18:50:37:INFO:TRAIN-(cmcm) (1/9/4)>> loss: 0.4550
2025-02-18 18:50:45:INFO:VAL-(cmcm) >>
2025-02-18 18:50:45:INFO:M: >>  Mult_acc_2: 0.8037  F1_score: 0.8032  Mult_acc_2_weak: 0.7451  MAE: 0.3638  Corr: 0.5779  Mult_acc_3: 0.7357  Mult_acc_5: 0.4915  R_squre: 0.2405 
2025-02-18 18:50:46:INFO:Saving checkpoint at epoch 9 to results/models/cmcm-simsv2-regression.pth.
2025-02-18 18:51:24:INFO:TRAIN-(cmcm) (1/10/4)>> loss: 0.4433
2025-02-18 18:51:32:INFO:VAL-(cmcm) >>
2025-02-18 18:51:32:INFO:M: >>  Mult_acc_2: 0.7790  F1_score: 0.7795  Mult_acc_2_weak: 0.7176  MAE: 0.3694  Corr: 0.5794  Mult_acc_3: 0.6940  Mult_acc_5: 0.4637  R_squre: 0.2351 
2025-02-18 18:52:10:INFO:TRAIN-(cmcm) (2/11/4)>> loss: 0.4302
2025-02-18 18:52:17:INFO:VAL-(cmcm) >>
2025-02-18 18:52:17:INFO:M: >>  Mult_acc_2: 0.7836  F1_score: 0.7756  Mult_acc_2_weak: 0.7294  MAE: 0.3703  Corr: 0.5666  Mult_acc_3: 0.7017  Mult_acc_5: 0.4699  R_squre: 0.2434 
2025-02-18 18:52:55:INFO:TRAIN-(cmcm) (3/12/4)>> loss: 0.4204
2025-02-18 18:53:03:INFO:VAL-(cmcm) >>
2025-02-18 18:53:03:INFO:M: >>  Mult_acc_2: 0.7651  F1_score: 0.7475  Mult_acc_2_weak: 0.7176  MAE: 0.3700  Corr: 0.5835  Mult_acc_3: 0.6754  Mult_acc_5: 0.4637  R_squre: 0.2110 
2025-02-18 18:53:41:INFO:TRAIN-(cmcm) (4/13/4)>> loss: 0.4130
2025-02-18 18:53:48:INFO:VAL-(cmcm) >>
2025-02-18 18:53:48:INFO:M: >>  Mult_acc_2: 0.7821  F1_score: 0.7727  Mult_acc_2_weak: 0.7412  MAE: 0.3700  Corr: 0.5901  Mult_acc_3: 0.7063  Mult_acc_5: 0.4652  R_squre: 0.2408 
2025-02-18 18:54:26:INFO:TRAIN-(cmcm) (5/14/4)>> loss: 0.3955
2025-02-18 18:54:34:INFO:VAL-(cmcm) >>
2025-02-18 18:54:34:INFO:M: >>  Mult_acc_2: 0.7821  F1_score: 0.7811  Mult_acc_2_weak: 0.7098  MAE: 0.3635  Corr: 0.5905  Mult_acc_3: 0.7048  Mult_acc_5: 0.4869  R_squre: 0.2200 
2025-02-18 18:54:35:INFO:Saving checkpoint at epoch 14 to results/models/cmcm-simsv2-regression.pth.
2025-02-18 18:55:13:INFO:TRAIN-(cmcm) (1/15/4)>> loss: 0.3877
2025-02-18 18:55:21:INFO:VAL-(cmcm) >>
2025-02-18 18:55:21:INFO:M: >>  Mult_acc_2: 0.7944  F1_score: 0.7934  Mult_acc_2_weak: 0.7412  MAE: 0.3521  Corr: 0.6038  Mult_acc_3: 0.7032  Mult_acc_5: 0.4946  R_squre: 0.2843 
2025-02-18 18:55:21:INFO:Saving checkpoint at epoch 15 to results/models/cmcm-simsv2-regression.pth.
2025-02-18 18:55:58:INFO:TRAIN-(cmcm) (1/16/4)>> loss: 0.3695
2025-02-18 18:56:05:INFO:VAL-(cmcm) >>
2025-02-18 18:56:05:INFO:M: >>  Mult_acc_2: 0.7913  F1_score: 0.7904  Mult_acc_2_weak: 0.7137  MAE: 0.3530  Corr: 0.6052  Mult_acc_3: 0.7125  Mult_acc_5: 0.4853  R_squre: 0.2746 
2025-02-18 18:56:43:INFO:TRAIN-(cmcm) (2/17/4)>> loss: 0.3724
2025-02-18 18:56:51:INFO:VAL-(cmcm) >>
2025-02-18 18:56:51:INFO:M: >>  Mult_acc_2: 0.7805  F1_score: 0.7720  Mult_acc_2_weak: 0.7373  MAE: 0.3632  Corr: 0.5754  Mult_acc_3: 0.6971  Mult_acc_5: 0.4884  R_squre: 0.2065 
2025-02-18 18:57:29:INFO:TRAIN-(cmcm) (3/18/4)>> loss: 0.3500
2025-02-18 18:57:36:INFO:VAL-(cmcm) >>
2025-02-18 18:57:36:INFO:M: >>  Mult_acc_2: 0.7898  F1_score: 0.7896  Mult_acc_2_weak: 0.7294  MAE: 0.3672  Corr: 0.5784  Mult_acc_3: 0.7002  Mult_acc_5: 0.4760  R_squre: 0.2006 
2025-02-18 18:58:14:INFO:TRAIN-(cmcm) (4/19/4)>> loss: 0.3322
2025-02-18 18:58:22:INFO:VAL-(cmcm) >>
2025-02-18 18:58:22:INFO:M: >>  Mult_acc_2: 0.7883  F1_score: 0.7897  Mult_acc_2_weak: 0.7255  MAE: 0.3651  Corr: 0.6001  Mult_acc_3: 0.7141  Mult_acc_5: 0.4946  R_squre: 0.2290 
2025-02-18 18:59:00:INFO:TRAIN-(cmcm) (5/20/4)>> loss: 0.3206
2025-02-18 18:59:08:INFO:VAL-(cmcm) >>
2025-02-18 18:59:08:INFO:M: >>  Mult_acc_2: 0.7836  F1_score: 0.7828  Mult_acc_2_weak: 0.7137  MAE: 0.3620  Corr: 0.6006  Mult_acc_3: 0.7048  Mult_acc_5: 0.4961  R_squre: 0.2262 
2025-02-18 18:59:46:INFO:TRAIN-(cmcm) (6/21/4)>> loss: 0.3076
2025-02-18 18:59:53:INFO:VAL-(cmcm) >>
2025-02-18 18:59:53:INFO:M: >>  Mult_acc_2: 0.7805  F1_score: 0.7800  Mult_acc_2_weak: 0.7098  MAE: 0.3734  Corr: 0.5871  Mult_acc_3: 0.6862  Mult_acc_5: 0.4714  R_squre: 0.2125 
2025-02-18 19:00:31:INFO:TRAIN-(cmcm) (7/22/4)>> loss: 0.2895
2025-02-18 19:00:39:INFO:VAL-(cmcm) >>
2025-02-18 19:00:39:INFO:M: >>  Mult_acc_2: 0.7836  F1_score: 0.7814  Mult_acc_2_weak: 0.7020  MAE: 0.3654  Corr: 0.6122  Mult_acc_3: 0.6955  Mult_acc_5: 0.4699  R_squre: 0.2607 
2025-02-18 19:01:17:INFO:TRAIN-(cmcm) (8/23/4)>> loss: 0.2772
2025-02-18 19:01:25:INFO:VAL-(cmcm) >>
2025-02-18 19:01:25:INFO:M: >>  Mult_acc_2: 0.7960  F1_score: 0.7963  Mult_acc_2_weak: 0.7373  MAE: 0.3629  Corr: 0.6121  Mult_acc_3: 0.7141  Mult_acc_5: 0.4853  R_squre: 0.2648 
2025-02-18 19:02:03:INFO:TRAIN-(cmcm) (9/24/4)>> loss: 0.2652
2025-02-18 19:02:10:INFO:VAL-(cmcm) >>
2025-02-18 19:02:10:INFO:M: >>  Mult_acc_2: 0.7913  F1_score: 0.7909  Mult_acc_2_weak: 0.7216  MAE: 0.3632  Corr: 0.6153  Mult_acc_3: 0.7187  Mult_acc_5: 0.4961  R_squre: 0.2633 
2025-02-18 19:02:48:INFO:TRAIN-(cmcm) (10/25/4)>> loss: 0.2554
2025-02-18 19:02:56:INFO:VAL-(cmcm) >>
2025-02-18 19:02:56:INFO:M: >>  Mult_acc_2: 0.7898  F1_score: 0.7895  Mult_acc_2_weak: 0.7333  MAE: 0.3672  Corr: 0.6097  Mult_acc_3: 0.7002  Mult_acc_5: 0.4699  R_squre: 0.2644 
2025-02-18 19:03:08:INFO:TEST-(cmcm) >>
2025-02-18 19:03:08:INFO:M: >>  Mult_acc_2: 0.8085  F1_score: 0.8073  Mult_acc_2_weak: 0.7350  MAE: 0.3211  Corr: 0.6580  Mult_acc_3: 0.7350  Mult_acc_5: 0.5455  R_squre: 0.3253 
2025-02-18 19:03:08:INFO:Results are added to results/results/simsv2-regression-30.csv...
2025-02-18 19:03:08:INFO:Start running cmcm...
2025-02-18 19:03:08:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'simsv2', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'pretrain_LM': '/data/huggingface_model/Qwen/Qwen-1_8B/', 'gpu_ids': [2], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/SIMS_V2/ch-simsv2s.pkl', 'seq_lens': (50, 925, 232), 'feature_dims': (2048, 25, 177), 'train_samples': 2722, 'num_classes': 3, 'language': 'cn', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'max_new_tokens': 4, 'pseudo_tokens': 4, 'task_specific_prompt': '[-1.0, +1.0]: ', 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 64, 'v_lstm_hidden_size': 64, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'update_epochs': 1, 'early_stop': 10, 'gamma': 1, 'H': 1.0, 'seed': 5555}>
2025-02-18 19:03:08:INFO:Let's use the GPU 2 !
2025-02-18 19:03:10:INFO:train samples: (2722,)
2025-02-18 19:03:12:INFO:valid samples: (647,)
2025-02-18 19:03:14:INFO:test samples: (1034,)
2025-02-18 19:03:14:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2025-02-18 19:03:14:WARNING:Try importing flash-attention for faster inference...
2025-02-18 19:03:14:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2025-02-18 19:03:14:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2025-02-18 19:03:14:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2025-02-18 19:03:15:INFO:trainable params: 1400268 || all params: 1838228940 || trainable%: 0.0761748425090076
2025-02-18 19:03:15:INFO:Init labels...
2025-02-18 19:03:15:INFO:Start training...
2025-02-18 19:03:53:INFO:TRAIN-(cmcm) (1/1/5)>> loss: 1.4199
2025-02-18 19:04:01:INFO:VAL-(cmcm) >>
2025-02-18 19:04:01:INFO:M: >>  Mult_acc_2: 0.5100  F1_score: 0.5155  Mult_acc_2_weak: 0.4902  MAE: 0.6927  Corr: 0.0863  Mult_acc_3: 0.2998  Mult_acc_5: 0.1607  R_squre: -0.9498 
2025-02-18 19:04:02:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-simsv2-regression.pth.
2025-02-18 19:04:40:INFO:TRAIN-(cmcm) (1/2/5)>> loss: 0.5799
2025-02-18 19:04:48:INFO:VAL-(cmcm) >>
2025-02-18 19:04:48:INFO:M: >>  Mult_acc_2: 0.6337  F1_score: 0.5336  Mult_acc_2_weak: 0.6745  MAE: 0.4794  Corr: 0.4186  Mult_acc_3: 0.4977  Mult_acc_5: 0.3277  R_squre: -0.0549 
2025-02-18 19:04:49:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-simsv2-regression.pth.
2025-02-18 19:05:27:INFO:TRAIN-(cmcm) (1/3/5)>> loss: 0.5432
2025-02-18 19:05:35:INFO:VAL-(cmcm) >>
2025-02-18 19:05:35:INFO:M: >>  Mult_acc_2: 0.7527  F1_score: 0.7523  Mult_acc_2_weak: 0.7020  MAE: 0.4250  Corr: 0.4899  Mult_acc_3: 0.6940  Mult_acc_5: 0.4451  R_squre: -0.0043 
2025-02-18 19:05:35:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-simsv2-regression.pth.
2025-02-18 19:06:14:INFO:TRAIN-(cmcm) (1/4/5)>> loss: 0.5190
2025-02-18 19:06:21:INFO:VAL-(cmcm) >>
2025-02-18 19:06:21:INFO:M: >>  Mult_acc_2: 0.7852  F1_score: 0.7814  Mult_acc_2_weak: 0.7255  MAE: 0.3648  Corr: 0.5831  Mult_acc_3: 0.6692  Mult_acc_5: 0.4374  R_squre: 0.2607 
2025-02-18 19:06:22:INFO:Saving checkpoint at epoch 4 to results/models/cmcm-simsv2-regression.pth.
2025-02-18 19:07:01:INFO:TRAIN-(cmcm) (1/5/5)>> loss: 0.4837
2025-02-18 19:07:08:INFO:VAL-(cmcm) >>
2025-02-18 19:07:08:INFO:M: >>  Mult_acc_2: 0.7883  F1_score: 0.7840  Mult_acc_2_weak: 0.7373  MAE: 0.3703  Corr: 0.5974  Mult_acc_3: 0.7063  Mult_acc_5: 0.4467  R_squre: 0.2329 
2025-02-18 19:07:46:INFO:TRAIN-(cmcm) (2/6/5)>> loss: 0.4649
2025-02-18 19:07:54:INFO:VAL-(cmcm) >>
2025-02-18 19:07:54:INFO:M: >>  Mult_acc_2: 0.8053  F1_score: 0.8024  Mult_acc_2_weak: 0.7608  MAE: 0.3781  Corr: 0.6337  Mult_acc_3: 0.7141  Mult_acc_5: 0.4158  R_squre: 0.1960 
2025-02-18 19:08:32:INFO:TRAIN-(cmcm) (3/7/5)>> loss: 0.4470
2025-02-18 19:08:40:INFO:VAL-(cmcm) >>
2025-02-18 19:08:40:INFO:M: >>  Mult_acc_2: 0.7975  F1_score: 0.7977  Mult_acc_2_weak: 0.7216  MAE: 0.3543  Corr: 0.6164  Mult_acc_3: 0.6971  Mult_acc_5: 0.4575  R_squre: 0.2549 
2025-02-18 19:08:41:INFO:Saving checkpoint at epoch 7 to results/models/cmcm-simsv2-regression.pth.
2025-02-18 19:09:19:INFO:TRAIN-(cmcm) (1/8/5)>> loss: 0.4354
2025-02-18 19:09:27:INFO:VAL-(cmcm) >>
2025-02-18 19:09:27:INFO:M: >>  Mult_acc_2: 0.7883  F1_score: 0.7894  Mult_acc_2_weak: 0.7255  MAE: 0.3515  Corr: 0.6128  Mult_acc_3: 0.6569  Mult_acc_5: 0.4544  R_squre: 0.2775 
2025-02-18 19:09:27:INFO:Saving checkpoint at epoch 8 to results/models/cmcm-simsv2-regression.pth.
2025-02-18 19:10:06:INFO:TRAIN-(cmcm) (1/9/5)>> loss: 0.4169
2025-02-18 19:10:13:INFO:VAL-(cmcm) >>
2025-02-18 19:10:13:INFO:M: >>  Mult_acc_2: 0.8006  F1_score: 0.7951  Mult_acc_2_weak: 0.7451  MAE: 0.3360  Corr: 0.6507  Mult_acc_3: 0.7048  Mult_acc_5: 0.4637  R_squre: 0.3560 
2025-02-18 19:10:14:INFO:Saving checkpoint at epoch 9 to results/models/cmcm-simsv2-regression.pth.
2025-02-18 19:10:52:INFO:TRAIN-(cmcm) (1/10/5)>> loss: 0.4029
2025-02-18 19:11:00:INFO:VAL-(cmcm) >>
2025-02-18 19:11:00:INFO:M: >>  Mult_acc_2: 0.8253  F1_score: 0.8234  Mult_acc_2_weak: 0.7725  MAE: 0.3215  Corr: 0.6719  Mult_acc_3: 0.7017  Mult_acc_5: 0.4915  R_squre: 0.3915 
2025-02-18 19:11:01:INFO:Saving checkpoint at epoch 10 to results/models/cmcm-simsv2-regression.pth.
2025-02-18 19:11:39:INFO:TRAIN-(cmcm) (1/11/5)>> loss: 0.3939
2025-02-18 19:11:47:INFO:VAL-(cmcm) >>
2025-02-18 19:11:47:INFO:M: >>  Mult_acc_2: 0.7805  F1_score: 0.7830  Mult_acc_2_weak: 0.6863  MAE: 0.3468  Corr: 0.6261  Mult_acc_3: 0.7156  Mult_acc_5: 0.4822  R_squre: 0.2824 
2025-02-18 19:12:25:INFO:TRAIN-(cmcm) (2/12/5)>> loss: 0.3820
2025-02-18 19:12:33:INFO:VAL-(cmcm) >>
2025-02-18 19:12:33:INFO:M: >>  Mult_acc_2: 0.8130  F1_score: 0.8126  Mult_acc_2_weak: 0.7451  MAE: 0.3240  Corr: 0.6556  Mult_acc_3: 0.7264  Mult_acc_5: 0.5085  R_squre: 0.3453 
2025-02-18 19:13:11:INFO:TRAIN-(cmcm) (3/13/5)>> loss: 0.3722
2025-02-18 19:13:18:INFO:VAL-(cmcm) >>
2025-02-18 19:13:18:INFO:M: >>  Mult_acc_2: 0.8130  F1_score: 0.8143  Mult_acc_2_weak: 0.7294  MAE: 0.3221  Corr: 0.6733  Mult_acc_3: 0.7512  Mult_acc_5: 0.5100  R_squre: 0.3704 
2025-02-18 19:13:56:INFO:TRAIN-(cmcm) (4/14/5)>> loss: 0.3608
2025-02-18 19:14:04:INFO:VAL-(cmcm) >>
2025-02-18 19:14:04:INFO:M: >>  Mult_acc_2: 0.8099  F1_score: 0.8072  Mult_acc_2_weak: 0.7294  MAE: 0.3097  Corr: 0.6786  Mult_acc_3: 0.7125  Mult_acc_5: 0.5070  R_squre: 0.4173 
2025-02-18 19:14:05:INFO:Saving checkpoint at epoch 14 to results/models/cmcm-simsv2-regression.pth.
2025-02-18 19:14:43:INFO:TRAIN-(cmcm) (1/15/5)>> loss: 0.3458
2025-02-18 19:14:51:INFO:VAL-(cmcm) >>
2025-02-18 19:14:51:INFO:M: >>  Mult_acc_2: 0.8161  F1_score: 0.8166  Mult_acc_2_weak: 0.7451  MAE: 0.3165  Corr: 0.6638  Mult_acc_3: 0.7388  Mult_acc_5: 0.5178  R_squre: 0.3541 
2025-02-18 19:15:29:INFO:TRAIN-(cmcm) (2/16/5)>> loss: 0.3290
2025-02-18 19:15:37:INFO:VAL-(cmcm) >>
2025-02-18 19:15:37:INFO:M: >>  Mult_acc_2: 0.7852  F1_score: 0.7868  Mult_acc_2_weak: 0.7255  MAE: 0.3546  Corr: 0.6165  Mult_acc_3: 0.6816  Mult_acc_5: 0.4652  R_squre: 0.2510 
2025-02-18 19:16:15:INFO:TRAIN-(cmcm) (3/17/5)>> loss: 0.3180
2025-02-18 19:16:22:INFO:VAL-(cmcm) >>
2025-02-18 19:16:22:INFO:M: >>  Mult_acc_2: 0.8099  F1_score: 0.8070  Mult_acc_2_weak: 0.7451  MAE: 0.3258  Corr: 0.6532  Mult_acc_3: 0.7218  Mult_acc_5: 0.5023  R_squre: 0.3263 
2025-02-18 19:17:00:INFO:TRAIN-(cmcm) (4/18/5)>> loss: 0.3031
2025-02-18 19:17:08:INFO:VAL-(cmcm) >>
2025-02-18 19:17:08:INFO:M: >>  Mult_acc_2: 0.8022  F1_score: 0.8020  Mult_acc_2_weak: 0.7255  MAE: 0.3255  Corr: 0.6632  Mult_acc_3: 0.7156  Mult_acc_5: 0.5039  R_squre: 0.3400 
2025-02-18 19:17:46:INFO:TRAIN-(cmcm) (5/19/5)>> loss: 0.2907
2025-02-18 19:17:53:INFO:VAL-(cmcm) >>
2025-02-18 19:17:53:INFO:M: >>  Mult_acc_2: 0.7836  F1_score: 0.7811  Mult_acc_2_weak: 0.7098  MAE: 0.3301  Corr: 0.6440  Mult_acc_3: 0.7079  Mult_acc_5: 0.4961  R_squre: 0.3269 
2025-02-18 19:18:32:INFO:TRAIN-(cmcm) (6/20/5)>> loss: 0.2713
2025-02-18 19:18:40:INFO:VAL-(cmcm) >>
2025-02-18 19:18:40:INFO:M: >>  Mult_acc_2: 0.8006  F1_score: 0.8002  Mult_acc_2_weak: 0.7333  MAE: 0.3202  Corr: 0.6602  Mult_acc_3: 0.7218  Mult_acc_5: 0.5147  R_squre: 0.3602 
2025-02-18 19:19:18:INFO:TRAIN-(cmcm) (7/21/5)>> loss: 0.2557
2025-02-18 19:19:26:INFO:VAL-(cmcm) >>
2025-02-18 19:19:26:INFO:M: >>  Mult_acc_2: 0.7651  F1_score: 0.7675  Mult_acc_2_weak: 0.6863  MAE: 0.3478  Corr: 0.6258  Mult_acc_3: 0.6723  Mult_acc_5: 0.4714  R_squre: 0.2446 
2025-02-18 19:20:04:INFO:TRAIN-(cmcm) (8/22/5)>> loss: 0.2415
2025-02-18 19:20:11:INFO:VAL-(cmcm) >>
2025-02-18 19:20:11:INFO:M: >>  Mult_acc_2: 0.7867  F1_score: 0.7864  Mult_acc_2_weak: 0.7137  MAE: 0.3243  Corr: 0.6489  Mult_acc_3: 0.7125  Mult_acc_5: 0.5131  R_squre: 0.3274 
2025-02-18 19:20:49:INFO:TRAIN-(cmcm) (9/23/5)>> loss: 0.2289
2025-02-18 19:20:57:INFO:VAL-(cmcm) >>
2025-02-18 19:20:57:INFO:M: >>  Mult_acc_2: 0.7821  F1_score: 0.7827  Mult_acc_2_weak: 0.7020  MAE: 0.3317  Corr: 0.6408  Mult_acc_3: 0.7187  Mult_acc_5: 0.5070  R_squre: 0.3071 
2025-02-18 19:21:35:INFO:TRAIN-(cmcm) (10/24/5)>> loss: 0.2134
2025-02-18 19:21:43:INFO:VAL-(cmcm) >>
2025-02-18 19:21:43:INFO:M: >>  Mult_acc_2: 0.7898  F1_score: 0.7900  Mult_acc_2_weak: 0.7176  MAE: 0.3246  Corr: 0.6545  Mult_acc_3: 0.7218  Mult_acc_5: 0.5100  R_squre: 0.3378 
2025-02-18 19:21:55:INFO:TEST-(cmcm) >>
2025-02-18 19:21:55:INFO:M: >>  Mult_acc_2: 0.8104  F1_score: 0.8074  Mult_acc_2_weak: 0.7350  MAE: 0.2832  Corr: 0.7174  Mult_acc_3: 0.7321  Mult_acc_5: 0.5706  R_squre: 0.4563 
2025-02-18 19:21:55:INFO:Results are added to results/results/simsv2-regression-30.csv...
2025-02-18 19:21:55:INFO:Start running cmcm...
2025-02-18 19:21:55:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosei', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'pretrain_LM': '/data/huggingface_model/Qwen/Qwen-1_8B/', 'gpu_ids': [2], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSEI/Processed/unaligned_50.pkl', 'seq_lens': (50, 500, 375), 'feature_dims': (2048, 74, 35), 'train_samples': 16326, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 64, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 1111}>
2025-02-18 19:21:55:INFO:Let's use the GPU 2 !
2025-02-18 19:22:18:INFO:train samples: (16326,)
2025-02-18 19:22:26:INFO:valid samples: (1871,)
2025-02-18 19:22:33:INFO:test samples: (4659,)
2025-02-18 19:22:34:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2025-02-18 19:22:34:WARNING:Try importing flash-attention for faster inference...
2025-02-18 19:22:34:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2025-02-18 19:22:34:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2025-02-18 19:22:34:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2025-02-18 19:22:36:INFO:trainable params: 1351244 || all params: 1838179916 || trainable%: 0.073509888136543
2025-02-18 19:22:36:INFO:Init labels...
2025-02-18 19:22:36:INFO:Start training...
2025-02-18 19:26:12:INFO:TRAIN-(cmcm) (1/1/1)>> loss: 1.0262
2025-02-18 19:26:33:INFO:VAL-(cmcm) >>
2025-02-18 19:26:33:INFO:M: >>  Has0_acc_2: 0.7402  Has0_F1_score: 0.6416  Non0_acc_2: 0.6328  Non0_F1_score: 0.5773  Mult_acc_5: 0.4409  Mult_acc_7: 0.4399  MAE: 0.7691  Corr: 0.1657 
2025-02-18 19:26:34:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosei-regression.pth.
2025-02-18 19:30:11:INFO:TRAIN-(cmcm) (1/2/1)>> loss: 0.6101
2025-02-18 19:30:32:INFO:VAL-(cmcm) >>
2025-02-18 19:30:32:INFO:M: >>  Has0_acc_2: 0.7974  Has0_F1_score: 0.7961  Non0_acc_2: 0.4506  Non0_F1_score: 0.3773  Mult_acc_5: 0.4666  Mult_acc_7: 0.4570  MAE: 0.7275  Corr: 0.5406 
2025-02-18 19:30:33:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosei-regression.pth.
2025-02-18 19:34:10:INFO:TRAIN-(cmcm) (1/3/1)>> loss: 0.5884
2025-02-18 19:34:31:INFO:VAL-(cmcm) >>
2025-02-18 19:34:31:INFO:M: >>  Has0_acc_2: 0.8065  Has0_F1_score: 0.7898  Non0_acc_2: 0.7003  Non0_F1_score: 0.7070  Mult_acc_5: 0.4714  Mult_acc_7: 0.4596  MAE: 0.6414  Corr: 0.5713 
2025-02-18 19:34:32:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-mosei-regression.pth.
2025-02-18 19:38:09:INFO:TRAIN-(cmcm) (1/4/1)>> loss: 0.5757
2025-02-18 19:38:30:INFO:VAL-(cmcm) >>
2025-02-18 19:38:30:INFO:M: >>  Has0_acc_2: 0.8161  Has0_F1_score: 0.7989  Non0_acc_2: 0.6606  Non0_F1_score: 0.6623  Mult_acc_5: 0.5056  Mult_acc_7: 0.4933  MAE: 0.6182  Corr: 0.5920 
2025-02-18 19:38:31:INFO:Saving checkpoint at epoch 4 to results/models/cmcm-mosei-regression.pth.
2025-02-18 19:42:08:INFO:TRAIN-(cmcm) (1/5/1)>> loss: 0.5598
2025-02-18 19:42:29:INFO:VAL-(cmcm) >>
2025-02-18 19:42:29:INFO:M: >>  Has0_acc_2: 0.8311  Has0_F1_score: 0.8269  Non0_acc_2: 0.5445  Non0_F1_score: 0.5154  Mult_acc_5: 0.4949  Mult_acc_7: 0.4864  MAE: 0.6211  Corr: 0.6327 
2025-02-18 19:46:10:INFO:TRAIN-(cmcm) (2/6/1)>> loss: 0.5471
2025-02-18 19:46:32:INFO:VAL-(cmcm) >>
2025-02-18 19:46:32:INFO:M: >>  Has0_acc_2: 0.8231  Has0_F1_score: 0.8050  Non0_acc_2: 0.6252  Non0_F1_score: 0.6186  Mult_acc_5: 0.5398  Mult_acc_7: 0.5286  MAE: 0.5744  Corr: 0.6486 
2025-02-18 19:46:33:INFO:Saving checkpoint at epoch 6 to results/models/cmcm-mosei-regression.pth.
2025-02-18 19:50:14:INFO:TRAIN-(cmcm) (1/7/1)>> loss: 0.5378
2025-02-18 19:50:36:INFO:VAL-(cmcm) >>
2025-02-18 19:50:36:INFO:M: >>  Has0_acc_2: 0.8429  Has0_F1_score: 0.8342  Non0_acc_2: 0.6530  Non0_F1_score: 0.6535  Mult_acc_5: 0.5409  Mult_acc_7: 0.5259  MAE: 0.5617  Corr: 0.6764 
2025-02-18 19:50:38:INFO:Saving checkpoint at epoch 7 to results/models/cmcm-mosei-regression.pth.
2025-02-18 19:54:07:INFO:TRAIN-(cmcm) (1/8/1)>> loss: 0.5301
2025-02-18 19:54:29:INFO:VAL-(cmcm) >>
2025-02-18 19:54:29:INFO:M: >>  Has0_acc_2: 0.8434  Has0_F1_score: 0.8321  Non0_acc_2: 0.6300  Non0_F1_score: 0.6236  Mult_acc_5: 0.5371  Mult_acc_7: 0.5227  MAE: 0.5692  Corr: 0.6571 
2025-02-18 19:57:58:INFO:TRAIN-(cmcm) (2/9/1)>> loss: 0.5246
2025-02-18 19:58:20:INFO:VAL-(cmcm) >>
2025-02-18 19:58:20:INFO:M: >>  Has0_acc_2: 0.8589  Has0_F1_score: 0.8574  Non0_acc_2: 0.5869  Non0_F1_score: 0.5701  Mult_acc_5: 0.5334  Mult_acc_7: 0.5206  MAE: 0.5686  Corr: 0.7054 
2025-02-18 20:01:48:INFO:TRAIN-(cmcm) (3/10/1)>> loss: 0.5195
2025-02-18 20:02:10:INFO:VAL-(cmcm) >>
2025-02-18 20:02:10:INFO:M: >>  Has0_acc_2: 0.8589  Has0_F1_score: 0.8592  Non0_acc_2: 0.7392  Non0_F1_score: 0.7444  Mult_acc_5: 0.5601  Mult_acc_7: 0.5404  MAE: 0.5500  Corr: 0.7286 
2025-02-18 20:02:11:INFO:Saving checkpoint at epoch 10 to results/models/cmcm-mosei-regression.pth.
2025-02-18 20:05:40:INFO:TRAIN-(cmcm) (1/11/1)>> loss: 0.5145
2025-02-18 20:06:02:INFO:VAL-(cmcm) >>
2025-02-18 20:06:02:INFO:M: >>  Has0_acc_2: 0.8509  Has0_F1_score: 0.8436  Non0_acc_2: 0.6613  Non0_F1_score: 0.6608  Mult_acc_5: 0.5719  Mult_acc_7: 0.5537  MAE: 0.5422  Corr: 0.7146 
2025-02-18 20:06:03:INFO:Saving checkpoint at epoch 11 to results/models/cmcm-mosei-regression.pth.
2025-02-18 20:09:31:INFO:TRAIN-(cmcm) (1/12/1)>> loss: 0.5107
2025-02-18 20:09:53:INFO:VAL-(cmcm) >>
2025-02-18 20:09:53:INFO:M: >>  Has0_acc_2: 0.8546  Has0_F1_score: 0.8468  Non0_acc_2: 0.7886  Non0_F1_score: 0.7932  Mult_acc_5: 0.5639  Mult_acc_7: 0.5484  MAE: 0.5193  Corr: 0.7301 
2025-02-18 20:09:54:INFO:Saving checkpoint at epoch 12 to results/models/cmcm-mosei-regression.pth.
2025-02-18 20:13:22:INFO:TRAIN-(cmcm) (1/13/1)>> loss: 0.5083
2025-02-18 20:13:44:INFO:VAL-(cmcm) >>
2025-02-18 20:13:44:INFO:M: >>  Has0_acc_2: 0.8546  Has0_F1_score: 0.8462  Non0_acc_2: 0.6613  Non0_F1_score: 0.6600  Mult_acc_5: 0.5623  Mult_acc_7: 0.5500  MAE: 0.5356  Corr: 0.7069 
2025-02-18 20:17:15:INFO:TRAIN-(cmcm) (2/14/1)>> loss: 0.5036
2025-02-18 20:17:37:INFO:VAL-(cmcm) >>
2025-02-18 20:17:37:INFO:M: >>  Has0_acc_2: 0.8552  Has0_F1_score: 0.8473  Non0_acc_2: 0.7079  Non0_F1_score: 0.7115  Mult_acc_5: 0.5596  Mult_acc_7: 0.5436  MAE: 0.5295  Corr: 0.7177 
2025-02-18 20:21:07:INFO:TRAIN-(cmcm) (3/15/1)>> loss: 0.5006
2025-02-18 20:21:28:INFO:VAL-(cmcm) >>
2025-02-18 20:21:28:INFO:M: >>  Has0_acc_2: 0.8316  Has0_F1_score: 0.8107  Non0_acc_2: 0.7211  Non0_F1_score: 0.7262  Mult_acc_5: 0.5617  Mult_acc_7: 0.5473  MAE: 0.5350  Corr: 0.7037 
2025-02-18 20:24:56:INFO:TRAIN-(cmcm) (4/16/1)>> loss: 0.4977
2025-02-18 20:25:18:INFO:VAL-(cmcm) >>
2025-02-18 20:25:18:INFO:M: >>  Has0_acc_2: 0.8584  Has0_F1_score: 0.8559  Non0_acc_2: 0.6453  Non0_F1_score: 0.6423  Mult_acc_5: 0.5601  Mult_acc_7: 0.5420  MAE: 0.5456  Corr: 0.7074 
2025-02-18 20:28:59:INFO:TRAIN-(cmcm) (5/17/1)>> loss: 0.4936
2025-02-18 20:29:20:INFO:VAL-(cmcm) >>
2025-02-18 20:29:20:INFO:M: >>  Has0_acc_2: 0.8616  Has0_F1_score: 0.8585  Non0_acc_2: 0.7184  Non0_F1_score: 0.7230  Mult_acc_5: 0.5601  Mult_acc_7: 0.5457  MAE: 0.5215  Corr: 0.7304 
2025-02-18 20:32:51:INFO:TRAIN-(cmcm) (6/18/1)>> loss: 0.4899
2025-02-18 20:33:13:INFO:VAL-(cmcm) >>
2025-02-18 20:33:13:INFO:M: >>  Has0_acc_2: 0.8530  Has0_F1_score: 0.8489  Non0_acc_2: 0.6947  Non0_F1_score: 0.6980  Mult_acc_5: 0.5591  Mult_acc_7: 0.5420  MAE: 0.5415  Corr: 0.7114 
2025-02-18 20:36:50:INFO:TRAIN-(cmcm) (7/19/1)>> loss: 0.4857
2025-02-18 20:37:11:INFO:VAL-(cmcm) >>
2025-02-18 20:37:11:INFO:M: >>  Has0_acc_2: 0.8642  Has0_F1_score: 0.8612  Non0_acc_2: 0.6829  Non0_F1_score: 0.6849  Mult_acc_5: 0.5676  Mult_acc_7: 0.5532  MAE: 0.5279  Corr: 0.7182 
2025-02-18 20:40:46:INFO:TRAIN-(cmcm) (8/20/1)>> loss: 0.4818
2025-02-18 20:41:07:INFO:VAL-(cmcm) >>
2025-02-18 20:41:07:INFO:M: >>  Has0_acc_2: 0.8530  Has0_F1_score: 0.8470  Non0_acc_2: 0.7079  Non0_F1_score: 0.7121  Mult_acc_5: 0.5548  Mult_acc_7: 0.5409  MAE: 0.5328  Corr: 0.7134 
2025-02-18 20:44:36:INFO:TRAIN-(cmcm) (9/21/1)>> loss: 0.4774
2025-02-18 20:44:57:INFO:VAL-(cmcm) >>
2025-02-18 20:44:57:INFO:M: >>  Has0_acc_2: 0.8487  Has0_F1_score: 0.8413  Non0_acc_2: 0.7267  Non0_F1_score: 0.7320  Mult_acc_5: 0.5494  Mult_acc_7: 0.5329  MAE: 0.5388  Corr: 0.7128 
2025-02-18 20:48:36:INFO:TRAIN-(cmcm) (10/22/1)>> loss: 0.4721
2025-02-18 20:48:58:INFO:VAL-(cmcm) >>
2025-02-18 20:48:58:INFO:M: >>  Has0_acc_2: 0.8562  Has0_F1_score: 0.8496  Non0_acc_2: 0.6996  Non0_F1_score: 0.7036  Mult_acc_5: 0.5468  Mult_acc_7: 0.5329  MAE: 0.5495  Corr: 0.6999 
2025-02-18 20:49:52:INFO:TEST-(cmcm) >>
2025-02-18 20:49:52:INFO:M: >>  Has0_acc_2: 0.8478  Has0_F1_score: 0.8411  Non0_acc_2: 0.8010  Non0_F1_score: 0.8043  Mult_acc_5: 0.5484  Mult_acc_7: 0.5329  MAE: 0.5383  Corr: 0.7479 
2025-02-18 20:49:53:INFO:Results are added to results/results/mosei-regression-30.csv...
2025-02-18 20:49:53:INFO:Start running cmcm...
2025-02-18 20:49:53:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosei', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'pretrain_LM': '/data/huggingface_model/Qwen/Qwen-1_8B/', 'gpu_ids': [2], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSEI/Processed/unaligned_50.pkl', 'seq_lens': (50, 500, 375), 'feature_dims': (2048, 74, 35), 'train_samples': 16326, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 64, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 2222}>
2025-02-18 20:49:53:INFO:Let's use the GPU 2 !
2025-02-18 20:50:06:INFO:train samples: (16326,)
2025-02-18 20:50:14:INFO:valid samples: (1871,)
2025-02-18 20:50:22:INFO:test samples: (4659,)
2025-02-18 20:50:23:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2025-02-18 20:50:23:WARNING:Try importing flash-attention for faster inference...
2025-02-18 20:50:23:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2025-02-18 20:50:23:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2025-02-18 20:50:23:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2025-02-18 20:50:24:INFO:trainable params: 1351244 || all params: 1838179916 || trainable%: 0.073509888136543
2025-02-18 20:50:24:INFO:Init labels...
2025-02-18 20:50:24:INFO:Start training...
2025-02-18 20:54:03:INFO:TRAIN-(cmcm) (1/1/2)>> loss: 0.8850
2025-02-18 20:54:25:INFO:VAL-(cmcm) >>
2025-02-18 20:54:25:INFO:M: >>  Has0_acc_2: 0.7846  Has0_F1_score: 0.7575  Non0_acc_2: 0.4687  Non0_F1_score: 0.4255  Mult_acc_5: 0.4596  Mult_acc_7: 0.4570  MAE: 0.7143  Corr: 0.4099 
2025-02-18 20:54:26:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosei-regression.pth.
2025-02-18 20:57:57:INFO:TRAIN-(cmcm) (1/2/2)>> loss: 0.6159
2025-02-18 20:58:19:INFO:VAL-(cmcm) >>
2025-02-18 20:58:19:INFO:M: >>  Has0_acc_2: 0.7905  Has0_F1_score: 0.7560  Non0_acc_2: 0.6203  Non0_F1_score: 0.6193  Mult_acc_5: 0.5045  Mult_acc_7: 0.4933  MAE: 0.6326  Corr: 0.5722 
2025-02-18 20:58:20:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosei-regression.pth.
2025-02-18 21:01:51:INFO:TRAIN-(cmcm) (1/3/2)>> loss: 0.5918
2025-02-18 21:02:13:INFO:VAL-(cmcm) >>
2025-02-18 21:02:13:INFO:M: >>  Has0_acc_2: 0.8145  Has0_F1_score: 0.8115  Non0_acc_2: 0.6419  Non0_F1_score: 0.6437  Mult_acc_5: 0.4997  Mult_acc_7: 0.4858  MAE: 0.6557  Corr: 0.6171 
2025-02-18 21:05:54:INFO:TRAIN-(cmcm) (2/4/2)>> loss: 0.5738
2025-02-18 21:06:16:INFO:VAL-(cmcm) >>
2025-02-18 21:06:16:INFO:M: >>  Has0_acc_2: 0.8188  Has0_F1_score: 0.8138  Non0_acc_2: 0.5508  Non0_F1_score: 0.5241  Mult_acc_5: 0.5211  Mult_acc_7: 0.5067  MAE: 0.6150  Corr: 0.6398 
2025-02-18 21:06:17:INFO:Saving checkpoint at epoch 4 to results/models/cmcm-mosei-regression.pth.
2025-02-18 21:09:59:INFO:TRAIN-(cmcm) (1/5/2)>> loss: 0.5652
2025-02-18 21:10:21:INFO:VAL-(cmcm) >>
2025-02-18 21:10:21:INFO:M: >>  Has0_acc_2: 0.8252  Has0_F1_score: 0.8155  Non0_acc_2: 0.7253  Non0_F1_score: 0.7309  Mult_acc_5: 0.4901  Mult_acc_7: 0.4762  MAE: 0.6216  Corr: 0.6471 
2025-02-18 21:13:51:INFO:TRAIN-(cmcm) (2/6/2)>> loss: 0.5578
2025-02-18 21:14:12:INFO:VAL-(cmcm) >>
2025-02-18 21:14:13:INFO:M: >>  Has0_acc_2: 0.8268  Has0_F1_score: 0.8251  Non0_acc_2: 0.5883  Non0_F1_score: 0.5735  Mult_acc_5: 0.5131  Mult_acc_7: 0.4981  MAE: 0.6222  Corr: 0.6544 
2025-02-18 21:17:45:INFO:TRAIN-(cmcm) (3/7/2)>> loss: 0.5503
2025-02-18 21:18:07:INFO:VAL-(cmcm) >>
2025-02-18 21:18:07:INFO:M: >>  Has0_acc_2: 0.8327  Has0_F1_score: 0.8219  Non0_acc_2: 0.7010  Non0_F1_score: 0.7061  Mult_acc_5: 0.5029  Mult_acc_7: 0.4832  MAE: 0.6043  Corr: 0.6793 
2025-02-18 21:18:07:INFO:Saving checkpoint at epoch 7 to results/models/cmcm-mosei-regression.pth.
2025-02-18 21:21:39:INFO:TRAIN-(cmcm) (1/8/2)>> loss: 0.5449
2025-02-18 21:22:01:INFO:VAL-(cmcm) >>
2025-02-18 21:22:01:INFO:M: >>  Has0_acc_2: 0.8359  Has0_F1_score: 0.8311  Non0_acc_2: 0.6586  Non0_F1_score: 0.6581  Mult_acc_5: 0.5323  Mult_acc_7: 0.5168  MAE: 0.5792  Corr: 0.6779 
2025-02-18 21:22:02:INFO:Saving checkpoint at epoch 8 to results/models/cmcm-mosei-regression.pth.
2025-02-18 21:25:37:INFO:TRAIN-(cmcm) (1/9/2)>> loss: 0.5409
2025-02-18 21:25:59:INFO:VAL-(cmcm) >>
2025-02-18 21:25:59:INFO:M: >>  Has0_acc_2: 0.8316  Has0_F1_score: 0.8155  Non0_acc_2: 0.7928  Non0_F1_score: 0.7942  Mult_acc_5: 0.5142  Mult_acc_7: 0.5019  MAE: 0.5891  Corr: 0.6595 
2025-02-18 21:29:28:INFO:TRAIN-(cmcm) (2/10/2)>> loss: 0.5353
2025-02-18 21:29:50:INFO:VAL-(cmcm) >>
2025-02-18 21:29:50:INFO:M: >>  Has0_acc_2: 0.8413  Has0_F1_score: 0.8325  Non0_acc_2: 0.6245  Non0_F1_score: 0.6175  Mult_acc_5: 0.5297  Mult_acc_7: 0.5168  MAE: 0.5773  Corr: 0.6821 
2025-02-18 21:29:51:INFO:Saving checkpoint at epoch 10 to results/models/cmcm-mosei-regression.pth.
2025-02-18 21:33:22:INFO:TRAIN-(cmcm) (1/11/2)>> loss: 0.5304
2025-02-18 21:33:44:INFO:VAL-(cmcm) >>
2025-02-18 21:33:44:INFO:M: >>  Has0_acc_2: 0.8247  Has0_F1_score: 0.8043  Non0_acc_2: 0.6857  Non0_F1_score: 0.6901  Mult_acc_5: 0.5334  Mult_acc_7: 0.5195  MAE: 0.5733  Corr: 0.6650 
2025-02-18 21:33:44:INFO:Saving checkpoint at epoch 11 to results/models/cmcm-mosei-regression.pth.
2025-02-18 21:37:18:INFO:TRAIN-(cmcm) (1/12/2)>> loss: 0.5264
2025-02-18 21:37:40:INFO:VAL-(cmcm) >>
2025-02-18 21:37:40:INFO:M: >>  Has0_acc_2: 0.8477  Has0_F1_score: 0.8429  Non0_acc_2: 0.6982  Non0_F1_score: 0.7027  Mult_acc_5: 0.5516  Mult_acc_7: 0.5377  MAE: 0.5475  Corr: 0.6906 
2025-02-18 21:37:41:INFO:Saving checkpoint at epoch 12 to results/models/cmcm-mosei-regression.pth.
2025-02-18 21:41:10:INFO:TRAIN-(cmcm) (1/13/2)>> loss: 0.5232
2025-02-18 21:41:32:INFO:VAL-(cmcm) >>
2025-02-18 21:41:32:INFO:M: >>  Has0_acc_2: 0.8493  Has0_F1_score: 0.8464  Non0_acc_2: 0.6523  Non0_F1_score: 0.6505  Mult_acc_5: 0.5420  Mult_acc_7: 0.5265  MAE: 0.5566  Corr: 0.6906 
2025-02-18 21:45:09:INFO:TRAIN-(cmcm) (2/14/2)>> loss: 0.5185
2025-02-18 21:45:31:INFO:VAL-(cmcm) >>
2025-02-18 21:45:31:INFO:M: >>  Has0_acc_2: 0.8348  Has0_F1_score: 0.8243  Non0_acc_2: 0.6641  Non0_F1_score: 0.6650  Mult_acc_5: 0.5345  Mult_acc_7: 0.5200  MAE: 0.5570  Corr: 0.6841 
2025-02-18 21:49:07:INFO:TRAIN-(cmcm) (3/15/2)>> loss: 0.5153
2025-02-18 21:49:28:INFO:VAL-(cmcm) >>
2025-02-18 21:49:28:INFO:M: >>  Has0_acc_2: 0.8461  Has0_F1_score: 0.8378  Non0_acc_2: 0.7427  Non0_F1_score: 0.7482  Mult_acc_5: 0.5318  Mult_acc_7: 0.5195  MAE: 0.5464  Corr: 0.6993 
2025-02-18 21:49:29:INFO:Saving checkpoint at epoch 15 to results/models/cmcm-mosei-regression.pth.
2025-02-18 21:53:11:INFO:TRAIN-(cmcm) (1/16/2)>> loss: 0.5119
2025-02-18 21:53:33:INFO:VAL-(cmcm) >>
2025-02-18 21:53:33:INFO:M: >>  Has0_acc_2: 0.8450  Has0_F1_score: 0.8438  Non0_acc_2: 0.7204  Non0_F1_score: 0.7255  Mult_acc_5: 0.5222  Mult_acc_7: 0.5024  MAE: 0.5872  Corr: 0.6776 
2025-02-18 21:57:09:INFO:TRAIN-(cmcm) (2/17/2)>> loss: 0.5065
2025-02-18 21:57:31:INFO:VAL-(cmcm) >>
2025-02-18 21:57:31:INFO:M: >>  Has0_acc_2: 0.8316  Has0_F1_score: 0.8331  Non0_acc_2: 0.7691  Non0_F1_score: 0.7743  Mult_acc_5: 0.4901  Mult_acc_7: 0.4714  MAE: 0.6092  Corr: 0.6835 
2025-02-18 22:01:01:INFO:TRAIN-(cmcm) (3/18/2)>> loss: 0.5029
2025-02-18 22:01:23:INFO:VAL-(cmcm) >>
2025-02-18 22:01:23:INFO:M: >>  Has0_acc_2: 0.8418  Has0_F1_score: 0.8313  Non0_acc_2: 0.7218  Non0_F1_score: 0.7274  Mult_acc_5: 0.5302  Mult_acc_7: 0.5158  MAE: 0.5610  Corr: 0.6975 
2025-02-18 22:04:55:INFO:TRAIN-(cmcm) (4/19/2)>> loss: 0.4984
2025-02-18 22:05:17:INFO:VAL-(cmcm) >>
2025-02-18 22:05:17:INFO:M: >>  Has0_acc_2: 0.8493  Has0_F1_score: 0.8413  Non0_acc_2: 0.6919  Non0_F1_score: 0.6953  Mult_acc_5: 0.5313  Mult_acc_7: 0.5179  MAE: 0.5523  Corr: 0.6912 
2025-02-18 22:08:59:INFO:TRAIN-(cmcm) (5/20/2)>> loss: 0.4938
2025-02-18 22:09:21:INFO:VAL-(cmcm) >>
2025-02-18 22:09:21:INFO:M: >>  Has0_acc_2: 0.8471  Has0_F1_score: 0.8430  Non0_acc_2: 0.6780  Non0_F1_score: 0.6812  Mult_acc_5: 0.5323  Mult_acc_7: 0.5184  MAE: 0.5693  Corr: 0.6937 
2025-02-18 22:13:00:INFO:TRAIN-(cmcm) (6/21/2)>> loss: 0.4896
2025-02-18 22:13:22:INFO:VAL-(cmcm) >>
2025-02-18 22:13:22:INFO:M: >>  Has0_acc_2: 0.8445  Has0_F1_score: 0.8382  Non0_acc_2: 0.7420  Non0_F1_score: 0.7476  Mult_acc_5: 0.5377  Mult_acc_7: 0.5206  MAE: 0.5519  Corr: 0.7088 
2025-02-18 22:16:53:INFO:TRAIN-(cmcm) (7/22/2)>> loss: 0.4840
2025-02-18 22:17:15:INFO:VAL-(cmcm) >>
2025-02-18 22:17:15:INFO:M: >>  Has0_acc_2: 0.8439  Has0_F1_score: 0.8363  Non0_acc_2: 0.7448  Non0_F1_score: 0.7504  Mult_acc_5: 0.5387  Mult_acc_7: 0.5227  MAE: 0.5562  Corr: 0.6940 
2025-02-18 22:20:53:INFO:TRAIN-(cmcm) (8/23/2)>> loss: 0.4794
2025-02-18 22:21:15:INFO:VAL-(cmcm) >>
2025-02-18 22:21:15:INFO:M: >>  Has0_acc_2: 0.8493  Has0_F1_score: 0.8459  Non0_acc_2: 0.7121  Non0_F1_score: 0.7169  Mult_acc_5: 0.5355  Mult_acc_7: 0.5206  MAE: 0.5606  Corr: 0.6905 
2025-02-18 22:24:56:INFO:TRAIN-(cmcm) (9/24/2)>> loss: 0.4744
2025-02-18 22:25:17:INFO:VAL-(cmcm) >>
2025-02-18 22:25:17:INFO:M: >>  Has0_acc_2: 0.8466  Has0_F1_score: 0.8416  Non0_acc_2: 0.7274  Non0_F1_score: 0.7329  Mult_acc_5: 0.5377  Mult_acc_7: 0.5232  MAE: 0.5583  Corr: 0.7019 
2025-02-18 22:28:48:INFO:TRAIN-(cmcm) (10/25/2)>> loss: 0.4695
2025-02-18 22:29:09:INFO:VAL-(cmcm) >>
2025-02-18 22:29:09:INFO:M: >>  Has0_acc_2: 0.8434  Has0_F1_score: 0.8381  Non0_acc_2: 0.7302  Non0_F1_score: 0.7357  Mult_acc_5: 0.5318  Mult_acc_7: 0.5142  MAE: 0.5689  Corr: 0.6974 
2025-02-18 22:30:04:INFO:TEST-(cmcm) >>
2025-02-18 22:30:04:INFO:M: >>  Has0_acc_2: 0.8435  Has0_F1_score: 0.8370  Non0_acc_2: 0.7672  Non0_F1_score: 0.7710  Mult_acc_5: 0.5364  Mult_acc_7: 0.5192  MAE: 0.5595  Corr: 0.7219 
2025-02-18 22:30:04:INFO:Results are added to results/results/mosei-regression-30.csv...
2025-02-18 22:30:04:INFO:Start running cmcm...
2025-02-18 22:30:04:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosei', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'pretrain_LM': '/data/huggingface_model/Qwen/Qwen-1_8B/', 'gpu_ids': [2], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSEI/Processed/unaligned_50.pkl', 'seq_lens': (50, 500, 375), 'feature_dims': (2048, 74, 35), 'train_samples': 16326, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 64, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 3333}>
2025-02-18 22:30:04:INFO:Let's use the GPU 2 !
2025-02-18 22:30:15:INFO:train samples: (16326,)
2025-02-18 22:30:23:INFO:valid samples: (1871,)
2025-02-18 22:30:30:INFO:test samples: (4659,)
2025-02-18 22:30:31:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2025-02-18 22:30:31:WARNING:Try importing flash-attention for faster inference...
2025-02-18 22:30:31:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2025-02-18 22:30:31:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2025-02-18 22:30:31:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2025-02-18 22:30:32:INFO:trainable params: 1351244 || all params: 1838179916 || trainable%: 0.073509888136543
2025-02-18 22:30:32:INFO:Init labels...
2025-02-18 22:30:32:INFO:Start training...
2025-02-18 22:34:12:INFO:TRAIN-(cmcm) (1/1/3)>> loss: 1.0689
2025-02-18 22:34:33:INFO:VAL-(cmcm) >>
2025-02-18 22:34:33:INFO:M: >>  Has0_acc_2: 0.7851  Has0_F1_score: 0.7709  Non0_acc_2: 0.4868  Non0_F1_score: 0.4593  Mult_acc_5: 0.4484  Mult_acc_7: 0.4484  MAE: 0.7346  Corr: 0.3628 
2025-02-18 22:34:34:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosei-regression.pth.
2025-02-18 22:38:16:INFO:TRAIN-(cmcm) (1/2/3)>> loss: 0.6209
2025-02-18 22:38:37:INFO:VAL-(cmcm) >>
2025-02-18 22:38:37:INFO:M: >>  Has0_acc_2: 0.7926  Has0_F1_score: 0.7904  Non0_acc_2: 0.6349  Non0_F1_score: 0.6384  Mult_acc_5: 0.4746  Mult_acc_7: 0.4698  MAE: 0.6907  Corr: 0.5053 
2025-02-18 22:38:38:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosei-regression.pth.
2025-02-18 22:42:17:INFO:TRAIN-(cmcm) (1/3/3)>> loss: 0.5946
2025-02-18 22:42:39:INFO:VAL-(cmcm) >>
2025-02-18 22:42:39:INFO:M: >>  Has0_acc_2: 0.8022  Has0_F1_score: 0.7881  Non0_acc_2: 0.7267  Non0_F1_score: 0.7320  Mult_acc_5: 0.4404  Mult_acc_7: 0.4281  MAE: 0.6778  Corr: 0.5385 
2025-02-18 22:42:39:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-mosei-regression.pth.
2025-02-18 22:46:13:INFO:TRAIN-(cmcm) (1/4/3)>> loss: 0.5779
2025-02-18 22:46:35:INFO:VAL-(cmcm) >>
2025-02-18 22:46:35:INFO:M: >>  Has0_acc_2: 0.8028  Has0_F1_score: 0.7797  Non0_acc_2: 0.4604  Non0_F1_score: 0.3890  Mult_acc_5: 0.4939  Mult_acc_7: 0.4832  MAE: 0.6646  Corr: 0.5524 
2025-02-18 22:46:36:INFO:Saving checkpoint at epoch 4 to results/models/cmcm-mosei-regression.pth.
2025-02-18 22:50:18:INFO:TRAIN-(cmcm) (1/5/3)>> loss: 0.5687
2025-02-18 22:50:40:INFO:VAL-(cmcm) >>
2025-02-18 22:50:40:INFO:M: >>  Has0_acc_2: 0.8049  Has0_F1_score: 0.7921  Non0_acc_2: 0.6968  Non0_F1_score: 0.7023  Mult_acc_5: 0.5029  Mult_acc_7: 0.4853  MAE: 0.6434  Corr: 0.6053 
2025-02-18 22:50:41:INFO:Saving checkpoint at epoch 5 to results/models/cmcm-mosei-regression.pth.
2025-02-18 22:54:09:INFO:TRAIN-(cmcm) (1/6/3)>> loss: 0.5626
2025-02-18 22:54:31:INFO:VAL-(cmcm) >>
2025-02-18 22:54:31:INFO:M: >>  Has0_acc_2: 0.7996  Has0_F1_score: 0.7726  Non0_acc_2: 0.5911  Non0_F1_score: 0.5835  Mult_acc_5: 0.5088  Mult_acc_7: 0.4976  MAE: 0.6215  Corr: 0.5771 
2025-02-18 22:54:32:INFO:Saving checkpoint at epoch 6 to results/models/cmcm-mosei-regression.pth.
2025-02-18 22:58:07:INFO:TRAIN-(cmcm) (1/7/3)>> loss: 0.5577
2025-02-18 22:58:29:INFO:VAL-(cmcm) >>
2025-02-18 22:58:29:INFO:M: >>  Has0_acc_2: 0.8183  Has0_F1_score: 0.8101  Non0_acc_2: 0.6968  Non0_F1_score: 0.7008  Mult_acc_5: 0.4810  Mult_acc_7: 0.4687  MAE: 0.6076  Corr: 0.6290 
2025-02-18 22:58:30:INFO:Saving checkpoint at epoch 7 to results/models/cmcm-mosei-regression.pth.
2025-02-18 23:02:02:INFO:TRAIN-(cmcm) (1/8/3)>> loss: 0.5523
2025-02-18 23:02:24:INFO:VAL-(cmcm) >>
2025-02-18 23:02:24:INFO:M: >>  Has0_acc_2: 0.8124  Has0_F1_score: 0.8027  Non0_acc_2: 0.5640  Non0_F1_score: 0.5431  Mult_acc_5: 0.5110  Mult_acc_7: 0.4971  MAE: 0.6271  Corr: 0.6109 
2025-02-18 23:05:55:INFO:TRAIN-(cmcm) (2/9/3)>> loss: 0.5476
2025-02-18 23:06:17:INFO:VAL-(cmcm) >>
2025-02-18 23:06:17:INFO:M: >>  Has0_acc_2: 0.8183  Has0_F1_score: 0.8081  Non0_acc_2: 0.5675  Non0_F1_score: 0.5466  Mult_acc_5: 0.5174  Mult_acc_7: 0.5008  MAE: 0.6186  Corr: 0.6156 
2025-02-18 23:09:58:INFO:TRAIN-(cmcm) (3/10/3)>> loss: 0.5436
2025-02-18 23:10:19:INFO:VAL-(cmcm) >>
2025-02-18 23:10:19:INFO:M: >>  Has0_acc_2: 0.8124  Has0_F1_score: 0.7917  Non0_acc_2: 0.6523  Non0_F1_score: 0.6534  Mult_acc_5: 0.5077  Mult_acc_7: 0.4939  MAE: 0.6088  Corr: 0.6190 
2025-02-18 23:14:00:INFO:TRAIN-(cmcm) (4/11/3)>> loss: 0.5399
2025-02-18 23:14:21:INFO:VAL-(cmcm) >>
2025-02-18 23:14:21:INFO:M: >>  Has0_acc_2: 0.8172  Has0_F1_score: 0.8111  Non0_acc_2: 0.7024  Non0_F1_score: 0.7073  Mult_acc_5: 0.5136  Mult_acc_7: 0.4992  MAE: 0.5998  Corr: 0.6275 
2025-02-18 23:14:22:INFO:Saving checkpoint at epoch 11 to results/models/cmcm-mosei-regression.pth.
2025-02-18 23:18:00:INFO:TRAIN-(cmcm) (1/12/3)>> loss: 0.5367
2025-02-18 23:18:22:INFO:VAL-(cmcm) >>
2025-02-18 23:18:22:INFO:M: >>  Has0_acc_2: 0.8087  Has0_F1_score: 0.8105  Non0_acc_2: 0.6530  Non0_F1_score: 0.6517  Mult_acc_5: 0.4976  Mult_acc_7: 0.4869  MAE: 0.6021  Corr: 0.6456 
2025-02-18 23:22:02:INFO:TRAIN-(cmcm) (2/13/3)>> loss: 0.5330
2025-02-18 23:22:24:INFO:VAL-(cmcm) >>
2025-02-18 23:22:24:INFO:M: >>  Has0_acc_2: 0.8001  Has0_F1_score: 0.8041  Non0_acc_2: 0.6217  Non0_F1_score: 0.6153  Mult_acc_5: 0.4912  Mult_acc_7: 0.4768  MAE: 0.6415  Corr: 0.6329 
2025-02-18 23:26:01:INFO:TRAIN-(cmcm) (3/14/3)>> loss: 0.5298
2025-02-18 23:26:23:INFO:VAL-(cmcm) >>
2025-02-18 23:26:23:INFO:M: >>  Has0_acc_2: 0.8156  Has0_F1_score: 0.8063  Non0_acc_2: 0.6057  Non0_F1_score: 0.5965  Mult_acc_5: 0.5179  Mult_acc_7: 0.5035  MAE: 0.5992  Corr: 0.6221 
2025-02-18 23:26:24:INFO:Saving checkpoint at epoch 14 to results/models/cmcm-mosei-regression.pth.
2025-02-18 23:30:05:INFO:TRAIN-(cmcm) (1/15/3)>> loss: 0.5260
2025-02-18 23:30:27:INFO:VAL-(cmcm) >>
2025-02-18 23:30:27:INFO:M: >>  Has0_acc_2: 0.8140  Has0_F1_score: 0.7979  Non0_acc_2: 0.6412  Non0_F1_score: 0.6385  Mult_acc_5: 0.5275  Mult_acc_7: 0.5136  MAE: 0.5886  Corr: 0.6363 
2025-02-18 23:30:27:INFO:Saving checkpoint at epoch 15 to results/models/cmcm-mosei-regression.pth.
2025-02-18 23:34:04:INFO:TRAIN-(cmcm) (1/16/3)>> loss: 0.5220
2025-02-18 23:34:25:INFO:VAL-(cmcm) >>
2025-02-18 23:34:25:INFO:M: >>  Has0_acc_2: 0.8204  Has0_F1_score: 0.8109  Non0_acc_2: 0.6064  Non0_F1_score: 0.5963  Mult_acc_5: 0.5120  Mult_acc_7: 0.5019  MAE: 0.6139  Corr: 0.6219 
2025-02-18 23:38:04:INFO:TRAIN-(cmcm) (2/17/3)>> loss: 0.5185
2025-02-18 23:38:26:INFO:VAL-(cmcm) >>
2025-02-18 23:38:26:INFO:M: >>  Has0_acc_2: 0.8204  Has0_F1_score: 0.8145  Non0_acc_2: 0.6801  Non0_F1_score: 0.6824  Mult_acc_5: 0.5243  Mult_acc_7: 0.5126  MAE: 0.5881  Corr: 0.6452 
2025-02-18 23:38:27:INFO:Saving checkpoint at epoch 17 to results/models/cmcm-mosei-regression.pth.
2025-02-18 23:42:00:INFO:TRAIN-(cmcm) (1/18/3)>> loss: 0.5141
2025-02-18 23:42:22:INFO:VAL-(cmcm) >>
2025-02-18 23:42:22:INFO:M: >>  Has0_acc_2: 0.8151  Has0_F1_score: 0.7997  Non0_acc_2: 0.6551  Non0_F1_score: 0.6562  Mult_acc_5: 0.5206  Mult_acc_7: 0.5077  MAE: 0.6040  Corr: 0.6256 
2025-02-18 23:45:58:INFO:TRAIN-(cmcm) (2/19/3)>> loss: 0.5101
2025-02-18 23:46:20:INFO:VAL-(cmcm) >>
2025-02-18 23:46:20:INFO:M: >>  Has0_acc_2: 0.8220  Has0_F1_score: 0.8105  Non0_acc_2: 0.6857  Non0_F1_score: 0.6907  Mult_acc_5: 0.5099  Mult_acc_7: 0.4965  MAE: 0.6123  Corr: 0.6207 
2025-02-18 23:49:54:INFO:TRAIN-(cmcm) (3/20/3)>> loss: 0.5066
2025-02-18 23:50:16:INFO:VAL-(cmcm) >>
2025-02-18 23:50:16:INFO:M: >>  Has0_acc_2: 0.8183  Has0_F1_score: 0.8061  Non0_acc_2: 0.6613  Non0_F1_score: 0.6627  Mult_acc_5: 0.5232  Mult_acc_7: 0.5120  MAE: 0.6000  Corr: 0.6261 
2025-02-18 23:53:46:INFO:TRAIN-(cmcm) (4/21/3)>> loss: 0.5016
2025-02-18 23:54:08:INFO:VAL-(cmcm) >>
2025-02-18 23:54:08:INFO:M: >>  Has0_acc_2: 0.8210  Has0_F1_score: 0.8094  Non0_acc_2: 0.6787  Non0_F1_score: 0.6827  Mult_acc_5: 0.5195  Mult_acc_7: 0.5067  MAE: 0.6009  Corr: 0.6258 
2025-02-18 23:57:49:INFO:TRAIN-(cmcm) (5/22/3)>> loss: 0.4964
2025-02-18 23:58:11:INFO:VAL-(cmcm) >>
2025-02-18 23:58:11:INFO:M: >>  Has0_acc_2: 0.8151  Has0_F1_score: 0.7984  Non0_acc_2: 0.6732  Non0_F1_score: 0.6775  Mult_acc_5: 0.5200  Mult_acc_7: 0.5067  MAE: 0.6075  Corr: 0.6164 
2025-02-19 00:01:47:INFO:TRAIN-(cmcm) (6/23/3)>> loss: 0.4914
2025-02-19 00:02:09:INFO:VAL-(cmcm) >>
2025-02-19 00:02:09:INFO:M: >>  Has0_acc_2: 0.8220  Has0_F1_score: 0.8135  Non0_acc_2: 0.6732  Non0_F1_score: 0.6771  Mult_acc_5: 0.5136  Mult_acc_7: 0.5019  MAE: 0.6116  Corr: 0.6257 
2025-02-19 00:05:46:INFO:TRAIN-(cmcm) (7/24/3)>> loss: 0.4870
2025-02-19 00:06:08:INFO:VAL-(cmcm) >>
2025-02-19 00:06:08:INFO:M: >>  Has0_acc_2: 0.8204  Has0_F1_score: 0.8106  Non0_acc_2: 0.6892  Non0_F1_score: 0.6940  Mult_acc_5: 0.5297  Mult_acc_7: 0.5174  MAE: 0.5871  Corr: 0.6346 
2025-02-19 00:06:09:INFO:Saving checkpoint at epoch 24 to results/models/cmcm-mosei-regression.pth.
2025-02-19 00:09:48:INFO:TRAIN-(cmcm) (1/25/3)>> loss: 0.4821
2025-02-19 00:10:10:INFO:VAL-(cmcm) >>
2025-02-19 00:10:10:INFO:M: >>  Has0_acc_2: 0.8220  Has0_F1_score: 0.8114  Non0_acc_2: 0.6801  Non0_F1_score: 0.6849  Mult_acc_5: 0.5222  Mult_acc_7: 0.5083  MAE: 0.5947  Corr: 0.6262 
2025-02-19 00:13:45:INFO:TRAIN-(cmcm) (2/26/3)>> loss: 0.4772
2025-02-19 00:14:07:INFO:VAL-(cmcm) >>
2025-02-19 00:14:07:INFO:M: >>  Has0_acc_2: 0.8188  Has0_F1_score: 0.8110  Non0_acc_2: 0.7093  Non0_F1_score: 0.7151  Mult_acc_5: 0.5158  Mult_acc_7: 0.5013  MAE: 0.6042  Corr: 0.6256 
2025-02-19 00:17:38:INFO:TRAIN-(cmcm) (3/27/3)>> loss: 0.4738
2025-02-19 00:18:00:INFO:VAL-(cmcm) >>
2025-02-19 00:18:00:INFO:M: >>  Has0_acc_2: 0.8183  Has0_F1_score: 0.8107  Non0_acc_2: 0.6773  Non0_F1_score: 0.6817  Mult_acc_5: 0.5110  Mult_acc_7: 0.4976  MAE: 0.6102  Corr: 0.6280 
2025-02-19 00:21:29:INFO:TRAIN-(cmcm) (4/28/3)>> loss: 0.4709
2025-02-19 00:21:51:INFO:VAL-(cmcm) >>
2025-02-19 00:21:51:INFO:M: >>  Has0_acc_2: 0.8145  Has0_F1_score: 0.8087  Non0_acc_2: 0.6905  Non0_F1_score: 0.6959  Mult_acc_5: 0.5158  Mult_acc_7: 0.5024  MAE: 0.6152  Corr: 0.6173 
2025-02-19 00:25:32:INFO:TRAIN-(cmcm) (5/29/3)>> loss: 0.4687
2025-02-19 00:25:54:INFO:VAL-(cmcm) >>
2025-02-19 00:25:54:INFO:M: >>  Has0_acc_2: 0.8156  Has0_F1_score: 0.8092  Non0_acc_2: 0.6780  Non0_F1_score: 0.6828  Mult_acc_5: 0.5110  Mult_acc_7: 0.4981  MAE: 0.6140  Corr: 0.6192 
2025-02-19 00:29:35:INFO:TRAIN-(cmcm) (6/30/3)>> loss: 0.4679
2025-02-19 00:29:56:INFO:VAL-(cmcm) >>
2025-02-19 00:29:56:INFO:M: >>  Has0_acc_2: 0.8161  Has0_F1_score: 0.8095  Non0_acc_2: 0.6808  Non0_F1_score: 0.6858  Mult_acc_5: 0.5104  Mult_acc_7: 0.4976  MAE: 0.6146  Corr: 0.6193 
2025-02-19 00:33:30:INFO:TRAIN-(cmcm) (7/31/3)>> loss: 0.4673
2025-02-19 00:33:52:INFO:VAL-(cmcm) >>
2025-02-19 00:33:52:INFO:M: >>  Has0_acc_2: 0.8151  Has0_F1_score: 0.8085  Non0_acc_2: 0.6836  Non0_F1_score: 0.6888  Mult_acc_5: 0.5094  Mult_acc_7: 0.4960  MAE: 0.6150  Corr: 0.6184 
2025-02-19 00:37:25:INFO:TRAIN-(cmcm) (8/32/3)>> loss: 0.4680
2025-02-19 00:37:47:INFO:VAL-(cmcm) >>
2025-02-19 00:37:47:INFO:M: >>  Has0_acc_2: 0.8145  Has0_F1_score: 0.8082  Non0_acc_2: 0.6780  Non0_F1_score: 0.6829  Mult_acc_5: 0.5120  Mult_acc_7: 0.4992  MAE: 0.6128  Corr: 0.6200 
2025-02-19 00:41:19:INFO:TRAIN-(cmcm) (9/33/3)>> loss: 0.4690
2025-02-19 00:41:40:INFO:VAL-(cmcm) >>
2025-02-19 00:41:40:INFO:M: >>  Has0_acc_2: 0.8177  Has0_F1_score: 0.8112  Non0_acc_2: 0.6725  Non0_F1_score: 0.6766  Mult_acc_5: 0.5163  Mult_acc_7: 0.5029  MAE: 0.6089  Corr: 0.6251 
2025-02-19 00:45:21:INFO:TRAIN-(cmcm) (10/34/3)>> loss: 0.4703
2025-02-19 00:45:43:INFO:VAL-(cmcm) >>
2025-02-19 00:45:43:INFO:M: >>  Has0_acc_2: 0.8177  Has0_F1_score: 0.8112  Non0_acc_2: 0.6718  Non0_F1_score: 0.6763  Mult_acc_5: 0.5163  Mult_acc_7: 0.5024  MAE: 0.6113  Corr: 0.6192 
2025-02-19 00:46:37:INFO:TEST-(cmcm) >>
2025-02-19 00:46:37:INFO:M: >>  Has0_acc_2: 0.8191  Has0_F1_score: 0.8115  Non0_acc_2: 0.7111  Non0_F1_score: 0.7140  Mult_acc_5: 0.5078  Mult_acc_7: 0.4922  MAE: 0.6174  Corr: 0.6578 
2025-02-19 00:46:37:INFO:Results are added to results/results/mosei-regression-30.csv...
2025-02-19 00:46:37:INFO:Start running cmcm...
2025-02-19 00:46:37:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosei', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'pretrain_LM': '/data/huggingface_model/Qwen/Qwen-1_8B/', 'gpu_ids': [2], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSEI/Processed/unaligned_50.pkl', 'seq_lens': (50, 500, 375), 'feature_dims': (2048, 74, 35), 'train_samples': 16326, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 64, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 4444}>
2025-02-19 00:46:37:INFO:Let's use the GPU 2 !
2025-02-19 00:46:49:INFO:train samples: (16326,)
2025-02-19 00:46:56:INFO:valid samples: (1871,)
2025-02-19 00:47:04:INFO:test samples: (4659,)
2025-02-19 00:47:05:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2025-02-19 00:47:05:WARNING:Try importing flash-attention for faster inference...
2025-02-19 00:47:05:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2025-02-19 00:47:05:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2025-02-19 00:47:05:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2025-02-19 00:47:06:INFO:trainable params: 1351244 || all params: 1838179916 || trainable%: 0.073509888136543
2025-02-19 00:47:06:INFO:Init labels...
2025-02-19 00:47:06:INFO:Start training...
2025-02-19 00:50:44:INFO:TRAIN-(cmcm) (1/1/4)>> loss: 0.8208
2025-02-19 00:51:06:INFO:VAL-(cmcm) >>
2025-02-19 00:51:06:INFO:M: >>  Has0_acc_2: 0.7787  Has0_F1_score: 0.7419  Non0_acc_2: 0.4924  Non0_F1_score: 0.4491  Mult_acc_5: 0.4944  Mult_acc_7: 0.4832  MAE: 0.6853  Corr: 0.4885 
2025-02-19 00:51:07:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosei-regression.pth.
2025-02-19 00:54:46:INFO:TRAIN-(cmcm) (1/2/4)>> loss: 0.5848
2025-02-19 00:55:08:INFO:VAL-(cmcm) >>
2025-02-19 00:55:08:INFO:M: >>  Has0_acc_2: 0.8188  Has0_F1_score: 0.8034  Non0_acc_2: 0.6391  Non0_F1_score: 0.6416  Mult_acc_5: 0.5174  Mult_acc_7: 0.5088  MAE: 0.6250  Corr: 0.6056 
2025-02-19 00:55:08:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosei-regression.pth.
2025-02-19 00:58:38:INFO:TRAIN-(cmcm) (1/3/4)>> loss: 0.5637
2025-02-19 00:59:00:INFO:VAL-(cmcm) >>
2025-02-19 00:59:00:INFO:M: >>  Has0_acc_2: 0.8316  Has0_F1_score: 0.8211  Non0_acc_2: 0.6634  Non0_F1_score: 0.6614  Mult_acc_5: 0.5227  Mult_acc_7: 0.5104  MAE: 0.5803  Corr: 0.6630 
2025-02-19 00:59:00:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-mosei-regression.pth.
2025-02-19 01:02:37:INFO:TRAIN-(cmcm) (1/4/4)>> loss: 0.5446
2025-02-19 01:02:58:INFO:VAL-(cmcm) >>
2025-02-19 01:02:58:INFO:M: >>  Has0_acc_2: 0.8466  Has0_F1_score: 0.8384  Non0_acc_2: 0.6690  Non0_F1_score: 0.6693  Mult_acc_5: 0.5500  Mult_acc_7: 0.5387  MAE: 0.5488  Corr: 0.6908 
2025-02-19 01:02:59:INFO:Saving checkpoint at epoch 4 to results/models/cmcm-mosei-regression.pth.
2025-02-19 01:06:38:INFO:TRAIN-(cmcm) (1/5/4)>> loss: 0.5330
2025-02-19 01:07:00:INFO:VAL-(cmcm) >>
2025-02-19 01:07:00:INFO:M: >>  Has0_acc_2: 0.8418  Has0_F1_score: 0.8342  Non0_acc_2: 0.5396  Non0_F1_score: 0.5060  Mult_acc_5: 0.5216  Mult_acc_7: 0.5072  MAE: 0.6000  Corr: 0.6306 
2025-02-19 01:10:35:INFO:TRAIN-(cmcm) (2/6/4)>> loss: 0.5274
2025-02-19 01:10:57:INFO:VAL-(cmcm) >>
2025-02-19 01:10:57:INFO:M: >>  Has0_acc_2: 0.8370  Has0_F1_score: 0.8197  Non0_acc_2: 0.6210  Non0_F1_score: 0.6130  Mult_acc_5: 0.5238  Mult_acc_7: 0.5158  MAE: 0.5708  Corr: 0.6718 
2025-02-19 01:14:31:INFO:TRAIN-(cmcm) (3/7/4)>> loss: 0.5236
2025-02-19 01:14:53:INFO:VAL-(cmcm) >>
2025-02-19 01:14:53:INFO:M: >>  Has0_acc_2: 0.8514  Has0_F1_score: 0.8440  Non0_acc_2: 0.6745  Non0_F1_score: 0.6748  Mult_acc_5: 0.5430  Mult_acc_7: 0.5297  MAE: 0.5597  Corr: 0.7035 
2025-02-19 01:18:30:INFO:TRAIN-(cmcm) (4/8/4)>> loss: 0.5195
2025-02-19 01:18:52:INFO:VAL-(cmcm) >>
2025-02-19 01:18:52:INFO:M: >>  Has0_acc_2: 0.8295  Has0_F1_score: 0.8105  Non0_acc_2: 0.7184  Non0_F1_score: 0.7224  Mult_acc_5: 0.5510  Mult_acc_7: 0.5297  MAE: 0.5542  Corr: 0.6986 
2025-02-19 01:22:22:INFO:TRAIN-(cmcm) (5/9/4)>> loss: 0.5145
2025-02-19 01:22:43:INFO:VAL-(cmcm) >>
2025-02-19 01:22:43:INFO:M: >>  Has0_acc_2: 0.8552  Has0_F1_score: 0.8476  Non0_acc_2: 0.7865  Non0_F1_score: 0.7913  Mult_acc_5: 0.5452  Mult_acc_7: 0.5345  MAE: 0.5231  Corr: 0.7215 
2025-02-19 01:22:44:INFO:Saving checkpoint at epoch 9 to results/models/cmcm-mosei-regression.pth.
2025-02-19 01:26:25:INFO:TRAIN-(cmcm) (1/10/4)>> loss: 0.5132
2025-02-19 01:26:47:INFO:VAL-(cmcm) >>
2025-02-19 01:26:47:INFO:M: >>  Has0_acc_2: 0.8530  Has0_F1_score: 0.8464  Non0_acc_2: 0.6892  Non0_F1_score: 0.6914  Mult_acc_5: 0.5425  Mult_acc_7: 0.5270  MAE: 0.5484  Corr: 0.7030 
2025-02-19 01:30:18:INFO:TRAIN-(cmcm) (2/11/4)>> loss: 0.5078
2025-02-19 01:30:40:INFO:VAL-(cmcm) >>
2025-02-19 01:30:40:INFO:M: >>  Has0_acc_2: 0.8557  Has0_F1_score: 0.8528  Non0_acc_2: 0.6822  Non0_F1_score: 0.6831  Mult_acc_5: 0.5510  Mult_acc_7: 0.5318  MAE: 0.5625  Corr: 0.7152 
2025-02-19 01:34:17:INFO:TRAIN-(cmcm) (3/12/4)>> loss: 0.5053
2025-02-19 01:34:39:INFO:VAL-(cmcm) >>
2025-02-19 01:34:39:INFO:M: >>  Has0_acc_2: 0.8498  Has0_F1_score: 0.8452  Non0_acc_2: 0.6745  Non0_F1_score: 0.6743  Mult_acc_5: 0.5553  Mult_acc_7: 0.5366  MAE: 0.5434  Corr: 0.7168 
2025-02-19 01:38:18:INFO:TRAIN-(cmcm) (4/13/4)>> loss: 0.5025
2025-02-19 01:38:40:INFO:VAL-(cmcm) >>
2025-02-19 01:38:40:INFO:M: >>  Has0_acc_2: 0.8503  Has0_F1_score: 0.8418  Non0_acc_2: 0.6676  Non0_F1_score: 0.6686  Mult_acc_5: 0.5430  Mult_acc_7: 0.5259  MAE: 0.5656  Corr: 0.6794 
2025-02-19 01:42:18:INFO:TRAIN-(cmcm) (5/14/4)>> loss: 0.4990
2025-02-19 01:42:40:INFO:VAL-(cmcm) >>
2025-02-19 01:42:40:INFO:M: >>  Has0_acc_2: 0.8477  Has0_F1_score: 0.8380  Non0_acc_2: 0.6641  Non0_F1_score: 0.6626  Mult_acc_5: 0.5537  Mult_acc_7: 0.5361  MAE: 0.5437  Corr: 0.7042 
2025-02-19 01:46:19:INFO:TRAIN-(cmcm) (6/15/4)>> loss: 0.4952
2025-02-19 01:46:40:INFO:VAL-(cmcm) >>
2025-02-19 01:46:40:INFO:M: >>  Has0_acc_2: 0.8536  Has0_F1_score: 0.8490  Non0_acc_2: 0.6773  Non0_F1_score: 0.6776  Mult_acc_5: 0.5623  Mult_acc_7: 0.5468  MAE: 0.5344  Corr: 0.7226 
2025-02-19 01:50:19:INFO:TRAIN-(cmcm) (7/16/4)>> loss: 0.4913
2025-02-19 01:50:41:INFO:VAL-(cmcm) >>
2025-02-19 01:50:41:INFO:M: >>  Has0_acc_2: 0.8557  Has0_F1_score: 0.8496  Non0_acc_2: 0.6759  Non0_F1_score: 0.6761  Mult_acc_5: 0.5596  Mult_acc_7: 0.5446  MAE: 0.5396  Corr: 0.7076 
2025-02-19 01:54:22:INFO:TRAIN-(cmcm) (8/17/4)>> loss: 0.4879
2025-02-19 01:54:44:INFO:VAL-(cmcm) >>
2025-02-19 01:54:44:INFO:M: >>  Has0_acc_2: 0.8482  Has0_F1_score: 0.8465  Non0_acc_2: 0.6446  Non0_F1_score: 0.6419  Mult_acc_5: 0.5478  Mult_acc_7: 0.5318  MAE: 0.5564  Corr: 0.6959 
2025-02-19 01:58:13:INFO:TRAIN-(cmcm) (9/18/4)>> loss: 0.4838
2025-02-19 01:58:35:INFO:VAL-(cmcm) >>
2025-02-19 01:58:35:INFO:M: >>  Has0_acc_2: 0.8503  Has0_F1_score: 0.8461  Non0_acc_2: 0.6801  Non0_F1_score: 0.6804  Mult_acc_5: 0.5649  Mult_acc_7: 0.5484  MAE: 0.5349  Corr: 0.7094 
2025-02-19 02:02:12:INFO:TRAIN-(cmcm) (10/19/4)>> loss: 0.4793
2025-02-19 02:02:34:INFO:VAL-(cmcm) >>
2025-02-19 02:02:34:INFO:M: >>  Has0_acc_2: 0.8514  Has0_F1_score: 0.8454  Non0_acc_2: 0.7267  Non0_F1_score: 0.7314  Mult_acc_5: 0.5596  Mult_acc_7: 0.5457  MAE: 0.5306  Corr: 0.7157 
2025-02-19 02:03:28:INFO:TEST-(cmcm) >>
2025-02-19 02:03:28:INFO:M: >>  Has0_acc_2: 0.8489  Has0_F1_score: 0.8418  Non0_acc_2: 0.7997  Non0_F1_score: 0.8030  Mult_acc_5: 0.5467  Mult_acc_7: 0.5340  MAE: 0.5319  Corr: 0.7539 
2025-02-19 02:03:29:INFO:Results are added to results/results/mosei-regression-30.csv...
2025-02-19 02:03:29:INFO:Start running cmcm...
2025-02-19 02:03:29:INFO:<Storage{'is_tune': False, 'train_mode': 'regression', 'modelName': 'cmcm', 'datasetName': 'mosei', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'pretrain_LM': '/data/huggingface_model/Qwen/Qwen-1_8B/', 'gpu_ids': [2], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MOSEI/Processed/unaligned_50.pkl', 'seq_lens': (50, 500, 375), 'feature_dims': (2048, 74, 35), 'train_samples': 16326, 'num_classes': 3, 'language': 'en', 'KeyEval': 'MAE', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'task_specific_prompt': 'Please predict the sentiment intensity of the above multimodal content in the range [-3.0, +3.0]. Assistant: The sentiment is', 'max_new_tokens': 4, 'pseudo_tokens': 4, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 64, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 10, 'H': 3.0, 'seed': 5555}>
2025-02-19 02:03:29:INFO:Let's use the GPU 2 !
2025-02-19 02:03:39:INFO:train samples: (16326,)
2025-02-19 02:03:47:INFO:valid samples: (1871,)
2025-02-19 02:03:55:INFO:test samples: (4659,)
2025-02-19 02:03:55:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2025-02-19 02:03:55:WARNING:Try importing flash-attention for faster inference...
2025-02-19 02:03:55:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2025-02-19 02:03:55:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2025-02-19 02:03:55:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2025-02-19 02:03:57:INFO:trainable params: 1351244 || all params: 1838179916 || trainable%: 0.073509888136543
2025-02-19 02:03:57:INFO:Init labels...
2025-02-19 02:03:57:INFO:Start training...
2025-02-19 02:07:35:INFO:TRAIN-(cmcm) (1/1/5)>> loss: 0.9684
2025-02-19 02:07:57:INFO:VAL-(cmcm) >>
2025-02-19 02:07:57:INFO:M: >>  Has0_acc_2: 0.7472  Has0_F1_score: 0.7284  Non0_acc_2: 0.4659  Non0_F1_score: 0.4225  Mult_acc_5: 0.4340  Mult_acc_7: 0.4244  MAE: 0.8319  Corr: 0.3137 
2025-02-19 02:07:58:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-mosei-regression.pth.
2025-02-19 02:11:38:INFO:TRAIN-(cmcm) (1/2/5)>> loss: 0.6068
2025-02-19 02:12:00:INFO:VAL-(cmcm) >>
2025-02-19 02:12:00:INFO:M: >>  Has0_acc_2: 0.7990  Has0_F1_score: 0.8035  Non0_acc_2: 0.5967  Non0_F1_score: 0.5876  Mult_acc_5: 0.4607  Mult_acc_7: 0.4329  MAE: 0.6966  Corr: 0.5784 
2025-02-19 02:12:01:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-mosei-regression.pth.
2025-02-19 02:15:31:INFO:TRAIN-(cmcm) (1/3/5)>> loss: 0.5696
2025-02-19 02:15:52:INFO:VAL-(cmcm) >>
2025-02-19 02:15:52:INFO:M: >>  Has0_acc_2: 0.8311  Has0_F1_score: 0.8268  Non0_acc_2: 0.5014  Non0_F1_score: 0.4542  Mult_acc_5: 0.5211  Mult_acc_7: 0.5083  MAE: 0.6164  Corr: 0.6205 
2025-02-19 02:15:53:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-mosei-regression.pth.
2025-02-19 02:19:34:INFO:TRAIN-(cmcm) (1/4/5)>> loss: 0.5516
2025-02-19 02:19:56:INFO:VAL-(cmcm) >>
2025-02-19 02:19:56:INFO:M: >>  Has0_acc_2: 0.8327  Has0_F1_score: 0.8278  Non0_acc_2: 0.6085  Non0_F1_score: 0.5984  Mult_acc_5: 0.5291  Mult_acc_7: 0.5168  MAE: 0.6092  Corr: 0.6654 
2025-02-19 02:19:57:INFO:Saving checkpoint at epoch 4 to results/models/cmcm-mosei-regression.pth.
2025-02-19 02:23:36:INFO:TRAIN-(cmcm) (1/5/5)>> loss: 0.5401
2025-02-19 02:23:58:INFO:VAL-(cmcm) >>
2025-02-19 02:23:58:INFO:M: >>  Has0_acc_2: 0.8434  Has0_F1_score: 0.8435  Non0_acc_2: 0.5633  Non0_F1_score: 0.5409  Mult_acc_5: 0.5120  Mult_acc_7: 0.4981  MAE: 0.6172  Corr: 0.6705 
2025-02-19 02:27:34:INFO:TRAIN-(cmcm) (2/6/5)>> loss: 0.5347
2025-02-19 02:27:56:INFO:VAL-(cmcm) >>
2025-02-19 02:27:56:INFO:M: >>  Has0_acc_2: 0.8322  Has0_F1_score: 0.8129  Non0_acc_2: 0.6801  Non0_F1_score: 0.6823  Mult_acc_5: 0.5398  Mult_acc_7: 0.5243  MAE: 0.5658  Corr: 0.6614 
2025-02-19 02:27:57:INFO:Saving checkpoint at epoch 6 to results/models/cmcm-mosei-regression.pth.
2025-02-19 02:31:33:INFO:TRAIN-(cmcm) (1/7/5)>> loss: 0.5300
2025-02-19 02:31:54:INFO:VAL-(cmcm) >>
2025-02-19 02:31:54:INFO:M: >>  Has0_acc_2: 0.8461  Has0_F1_score: 0.8465  Non0_acc_2: 0.5306  Non0_F1_score: 0.4974  Mult_acc_5: 0.5291  Mult_acc_7: 0.5136  MAE: 0.6026  Corr: 0.6697 
2025-02-19 02:35:32:INFO:TRAIN-(cmcm) (2/8/5)>> loss: 0.5260
2025-02-19 02:35:54:INFO:VAL-(cmcm) >>
2025-02-19 02:35:54:INFO:M: >>  Has0_acc_2: 0.8450  Has0_F1_score: 0.8436  Non0_acc_2: 0.7177  Non0_F1_score: 0.7222  Mult_acc_5: 0.5291  Mult_acc_7: 0.5110  MAE: 0.5721  Corr: 0.6912 
2025-02-19 02:39:35:INFO:TRAIN-(cmcm) (3/9/5)>> loss: 0.5232
2025-02-19 02:39:57:INFO:VAL-(cmcm) >>
2025-02-19 02:39:57:INFO:M: >>  Has0_acc_2: 0.8477  Has0_F1_score: 0.8423  Non0_acc_2: 0.7024  Non0_F1_score: 0.7068  Mult_acc_5: 0.5350  Mult_acc_7: 0.5227  MAE: 0.5596  Corr: 0.6966 
2025-02-19 02:39:58:INFO:Saving checkpoint at epoch 9 to results/models/cmcm-mosei-regression.pth.
2025-02-19 02:43:30:INFO:TRAIN-(cmcm) (1/10/5)>> loss: 0.5191
2025-02-19 02:43:52:INFO:VAL-(cmcm) >>
2025-02-19 02:43:52:INFO:M: >>  Has0_acc_2: 0.8493  Has0_F1_score: 0.8413  Non0_acc_2: 0.6572  Non0_F1_score: 0.6559  Mult_acc_5: 0.5436  Mult_acc_7: 0.5302  MAE: 0.5562  Corr: 0.6766 
2025-02-19 02:43:52:INFO:Saving checkpoint at epoch 10 to results/models/cmcm-mosei-regression.pth.
2025-02-19 02:47:26:INFO:TRAIN-(cmcm) (1/11/5)>> loss: 0.5154
2025-02-19 02:47:48:INFO:VAL-(cmcm) >>
2025-02-19 02:47:48:INFO:M: >>  Has0_acc_2: 0.8509  Has0_F1_score: 0.8468  Non0_acc_2: 0.6467  Non0_F1_score: 0.6428  Mult_acc_5: 0.5537  Mult_acc_7: 0.5404  MAE: 0.5509  Corr: 0.6935 
2025-02-19 02:47:49:INFO:Saving checkpoint at epoch 11 to results/models/cmcm-mosei-regression.pth.
2025-02-19 02:51:29:INFO:TRAIN-(cmcm) (1/12/5)>> loss: 0.5118
2025-02-19 02:51:51:INFO:VAL-(cmcm) >>
2025-02-19 02:51:51:INFO:M: >>  Has0_acc_2: 0.8509  Has0_F1_score: 0.8513  Non0_acc_2: 0.6161  Non0_F1_score: 0.6077  Mult_acc_5: 0.5350  Mult_acc_7: 0.5174  MAE: 0.5708  Corr: 0.6999 
2025-02-19 02:55:27:INFO:TRAIN-(cmcm) (2/13/5)>> loss: 0.5080
2025-02-19 02:55:49:INFO:VAL-(cmcm) >>
2025-02-19 02:55:49:INFO:M: >>  Has0_acc_2: 0.8509  Has0_F1_score: 0.8480  Non0_acc_2: 0.7601  Non0_F1_score: 0.7653  Mult_acc_5: 0.5387  Mult_acc_7: 0.5206  MAE: 0.5527  Corr: 0.7108 
2025-02-19 02:59:30:INFO:TRAIN-(cmcm) (3/14/5)>> loss: 0.5051
2025-02-19 02:59:52:INFO:VAL-(cmcm) >>
2025-02-19 02:59:52:INFO:M: >>  Has0_acc_2: 0.8461  Has0_F1_score: 0.8409  Non0_acc_2: 0.7225  Non0_F1_score: 0.7266  Mult_acc_5: 0.5457  Mult_acc_7: 0.5297  MAE: 0.5442  Corr: 0.7099 
2025-02-19 02:59:53:INFO:Saving checkpoint at epoch 14 to results/models/cmcm-mosei-regression.pth.
2025-02-19 03:03:35:INFO:TRAIN-(cmcm) (1/15/5)>> loss: 0.5016
2025-02-19 03:03:56:INFO:VAL-(cmcm) >>
2025-02-19 03:03:56:INFO:M: >>  Has0_acc_2: 0.8477  Has0_F1_score: 0.8451  Non0_acc_2: 0.7399  Non0_F1_score: 0.7449  Mult_acc_5: 0.5494  Mult_acc_7: 0.5334  MAE: 0.5490  Corr: 0.7123 
2025-02-19 03:07:36:INFO:TRAIN-(cmcm) (2/16/5)>> loss: 0.4983
2025-02-19 03:07:58:INFO:VAL-(cmcm) >>
2025-02-19 03:07:58:INFO:M: >>  Has0_acc_2: 0.8461  Has0_F1_score: 0.8443  Non0_acc_2: 0.6905  Non0_F1_score: 0.6922  Mult_acc_5: 0.5575  Mult_acc_7: 0.5420  MAE: 0.5361  Corr: 0.7114 
2025-02-19 03:07:59:INFO:Saving checkpoint at epoch 16 to results/models/cmcm-mosei-regression.pth.
2025-02-19 03:11:40:INFO:TRAIN-(cmcm) (1/17/5)>> loss: 0.4945
2025-02-19 03:12:04:INFO:VAL-(cmcm) >>
2025-02-19 03:12:04:INFO:M: >>  Has0_acc_2: 0.8546  Has0_F1_score: 0.8527  Non0_acc_2: 0.6850  Non0_F1_score: 0.6860  Mult_acc_5: 0.5548  Mult_acc_7: 0.5366  MAE: 0.5449  Corr: 0.7048 
2025-02-19 03:15:44:INFO:TRAIN-(cmcm) (2/18/5)>> loss: 0.4911
2025-02-19 03:16:05:INFO:VAL-(cmcm) >>
2025-02-19 03:16:05:INFO:M: >>  Has0_acc_2: 0.8455  Has0_F1_score: 0.8365  Non0_acc_2: 0.6975  Non0_F1_score: 0.6996  Mult_acc_5: 0.5585  Mult_acc_7: 0.5404  MAE: 0.5396  Corr: 0.7046 
2025-02-19 03:19:45:INFO:TRAIN-(cmcm) (3/19/5)>> loss: 0.4872
2025-02-19 03:20:07:INFO:VAL-(cmcm) >>
2025-02-19 03:20:07:INFO:M: >>  Has0_acc_2: 0.8498  Has0_F1_score: 0.8435  Non0_acc_2: 0.6961  Non0_F1_score: 0.6991  Mult_acc_5: 0.5457  Mult_acc_7: 0.5334  MAE: 0.5464  Corr: 0.7074 
2025-02-19 03:23:47:INFO:TRAIN-(cmcm) (4/20/5)>> loss: 0.4823
2025-02-19 03:24:09:INFO:VAL-(cmcm) >>
2025-02-19 03:24:09:INFO:M: >>  Has0_acc_2: 0.8541  Has0_F1_score: 0.8508  Non0_acc_2: 0.7191  Non0_F1_score: 0.7234  Mult_acc_5: 0.5532  Mult_acc_7: 0.5355  MAE: 0.5442  Corr: 0.7142 
2025-02-19 03:27:49:INFO:TRAIN-(cmcm) (5/21/5)>> loss: 0.4775
2025-02-19 03:28:10:INFO:VAL-(cmcm) >>
2025-02-19 03:28:10:INFO:M: >>  Has0_acc_2: 0.8471  Has0_F1_score: 0.8391  Non0_acc_2: 0.7740  Non0_F1_score: 0.7791  Mult_acc_5: 0.5468  Mult_acc_7: 0.5307  MAE: 0.5318  Corr: 0.7165 
2025-02-19 03:28:11:INFO:Saving checkpoint at epoch 21 to results/models/cmcm-mosei-regression.pth.
2025-02-19 03:31:51:INFO:TRAIN-(cmcm) (1/22/5)>> loss: 0.4723
2025-02-19 03:32:13:INFO:VAL-(cmcm) >>
2025-02-19 03:32:13:INFO:M: >>  Has0_acc_2: 0.8552  Has0_F1_score: 0.8505  Non0_acc_2: 0.6655  Non0_F1_score: 0.6652  Mult_acc_5: 0.5500  Mult_acc_7: 0.5350  MAE: 0.5482  Corr: 0.7019 
2025-02-19 03:35:53:INFO:TRAIN-(cmcm) (2/23/5)>> loss: 0.4678
2025-02-19 03:36:14:INFO:VAL-(cmcm) >>
2025-02-19 03:36:14:INFO:M: >>  Has0_acc_2: 0.8530  Has0_F1_score: 0.8474  Non0_acc_2: 0.7288  Non0_F1_score: 0.7338  Mult_acc_5: 0.5473  Mult_acc_7: 0.5307  MAE: 0.5376  Corr: 0.7110 
2025-02-19 03:39:54:INFO:TRAIN-(cmcm) (3/24/5)>> loss: 0.4629
2025-02-19 03:40:15:INFO:VAL-(cmcm) >>
2025-02-19 03:40:15:INFO:M: >>  Has0_acc_2: 0.8493  Has0_F1_score: 0.8417  Non0_acc_2: 0.7531  Non0_F1_score: 0.7585  Mult_acc_5: 0.5420  Mult_acc_7: 0.5238  MAE: 0.5455  Corr: 0.7107 
2025-02-19 03:43:45:INFO:TRAIN-(cmcm) (4/25/5)>> loss: 0.4580
2025-02-19 03:44:07:INFO:VAL-(cmcm) >>
2025-02-19 03:44:07:INFO:M: >>  Has0_acc_2: 0.8503  Has0_F1_score: 0.8443  Non0_acc_2: 0.7559  Non0_F1_score: 0.7613  Mult_acc_5: 0.5366  Mult_acc_7: 0.5184  MAE: 0.5530  Corr: 0.7088 
2025-02-19 03:47:47:INFO:TRAIN-(cmcm) (5/26/5)>> loss: 0.4533
2025-02-19 03:48:09:INFO:VAL-(cmcm) >>
2025-02-19 03:48:09:INFO:M: >>  Has0_acc_2: 0.8471  Has0_F1_score: 0.8426  Non0_acc_2: 0.7427  Non0_F1_score: 0.7478  Mult_acc_5: 0.5468  Mult_acc_7: 0.5297  MAE: 0.5464  Corr: 0.7122 
2025-02-19 03:51:50:INFO:TRAIN-(cmcm) (6/27/5)>> loss: 0.4496
2025-02-19 03:52:12:INFO:VAL-(cmcm) >>
2025-02-19 03:52:12:INFO:M: >>  Has0_acc_2: 0.8546  Has0_F1_score: 0.8513  Non0_acc_2: 0.7295  Non0_F1_score: 0.7345  Mult_acc_5: 0.5489  Mult_acc_7: 0.5302  MAE: 0.5480  Corr: 0.7129 
2025-02-19 03:55:52:INFO:TRAIN-(cmcm) (7/28/5)>> loss: 0.4462
2025-02-19 03:56:14:INFO:VAL-(cmcm) >>
2025-02-19 03:56:14:INFO:M: >>  Has0_acc_2: 0.8541  Has0_F1_score: 0.8504  Non0_acc_2: 0.7490  Non0_F1_score: 0.7542  Mult_acc_5: 0.5430  Mult_acc_7: 0.5249  MAE: 0.5477  Corr: 0.7158 
2025-02-19 03:59:54:INFO:TRAIN-(cmcm) (8/29/5)>> loss: 0.4439
2025-02-19 04:00:16:INFO:VAL-(cmcm) >>
2025-02-19 04:00:16:INFO:M: >>  Has0_acc_2: 0.8503  Has0_F1_score: 0.8458  Non0_acc_2: 0.7476  Non0_F1_score: 0.7528  Mult_acc_5: 0.5430  Mult_acc_7: 0.5249  MAE: 0.5502  Corr: 0.7139 
2025-02-19 04:03:51:INFO:TRAIN-(cmcm) (9/30/5)>> loss: 0.4426
2025-02-19 04:04:13:INFO:VAL-(cmcm) >>
2025-02-19 04:04:13:INFO:M: >>  Has0_acc_2: 0.8503  Has0_F1_score: 0.8458  Non0_acc_2: 0.7462  Non0_F1_score: 0.7514  Mult_acc_5: 0.5446  Mult_acc_7: 0.5270  MAE: 0.5491  Corr: 0.7134 
2025-02-19 04:07:47:INFO:TRAIN-(cmcm) (10/31/5)>> loss: 0.4425
2025-02-19 04:08:09:INFO:VAL-(cmcm) >>
2025-02-19 04:08:09:INFO:M: >>  Has0_acc_2: 0.8509  Has0_F1_score: 0.8462  Non0_acc_2: 0.7510  Non0_F1_score: 0.7563  Mult_acc_5: 0.5430  Mult_acc_7: 0.5254  MAE: 0.5494  Corr: 0.7130 
2025-02-19 04:09:03:INFO:TEST-(cmcm) >>
2025-02-19 04:09:03:INFO:M: >>  Has0_acc_2: 0.8467  Has0_F1_score: 0.8409  Non0_acc_2: 0.7840  Non0_F1_score: 0.7876  Mult_acc_5: 0.5417  Mult_acc_7: 0.5229  MAE: 0.5420  Corr: 0.7440 
2025-02-19 04:09:03:INFO:Results are added to results/results/mosei-regression-30.csv...
2025-02-19 04:09:03:INFO:Start running cmcm...
2025-02-19 04:09:03:INFO:<Storage{'is_tune': False, 'train_mode': 'classification', 'modelName': 'cmcm', 'datasetName': 'meld', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'pretrain_LM': '/data/huggingface_model/Qwen/Qwen-1_8B/', 'gpu_ids': [2], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MELD', 'seq_lens': (65, 157, 32), 'feature_dims': (2048, 64, 64), 'train_samples': 9992, 'num_classes': 3, 'language': 'en', 'KeyEval': 'weight_F1', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'task_specific_prompt': 'Please recognize the emotion of the above multimodal content from the                                             target set <neutral:0, surprise:1, fear:2, sadness:3, joy:4, disgust:5, anger:6>. Assistant: The emotion is', 'max_new_tokens': 1, 'pseudo_tokens': 2, 'label_index_mapping': {'neutral': 0, 'surprise': 1, 'fear': 2, 'sadness': 3, 'joy': 4, 'disgust': 5, 'anger': 6}, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 64, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 8, 'H': 3.0, 'seed': 1111}>
2025-02-19 04:09:03:INFO:Let's use the GPU 2 !
2025-02-19 04:09:08:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2025-02-19 04:09:08:WARNING:Try importing flash-attention for faster inference...
2025-02-19 04:09:08:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2025-02-19 04:09:08:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2025-02-19 04:09:08:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2025-02-19 04:09:09:INFO:trainable params: 1352392 || all params: 1838181064 || trainable%: 0.07357229526982005
2025-02-19 04:09:09:INFO:Init labels...
2025-02-19 04:09:09:INFO:Start training...
2025-02-19 04:11:16:INFO:TRAIN-(cmcm) (1/1/1)>> loss: 4.5800
2025-02-19 04:11:22:INFO:VAL-(cmcm) >>
2025-02-19 04:11:22:INFO:M: >>  acc: 0.4238  weight_F1: 0.2523 
2025-02-19 04:11:23:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-meld-classification.pth.
2025-02-19 04:13:30:INFO:TRAIN-(cmcm) (1/2/1)>> loss: 1.5708
2025-02-19 04:13:36:INFO:VAL-(cmcm) >>
2025-02-19 04:13:36:INFO:M: >>  acc: 0.4229  weight_F1: 0.2521 
2025-02-19 04:15:43:INFO:TRAIN-(cmcm) (2/3/1)>> loss: 1.5560
2025-02-19 04:15:49:INFO:VAL-(cmcm) >>
2025-02-19 04:15:49:INFO:M: >>  acc: 0.4238  weight_F1: 0.2523 
2025-02-19 04:17:56:INFO:TRAIN-(cmcm) (3/4/1)>> loss: 1.5489
2025-02-19 04:18:02:INFO:VAL-(cmcm) >>
2025-02-19 04:18:02:INFO:M: >>  acc: 0.4238  weight_F1: 0.2523 
2025-02-19 04:20:09:INFO:TRAIN-(cmcm) (4/5/1)>> loss: 1.5420
2025-02-19 04:20:15:INFO:VAL-(cmcm) >>
2025-02-19 04:20:15:INFO:M: >>  acc: 0.4238  weight_F1: 0.2523 
2025-02-19 04:22:21:INFO:TRAIN-(cmcm) (5/6/1)>> loss: 1.5158
2025-02-19 04:22:28:INFO:VAL-(cmcm) >>
2025-02-19 04:22:28:INFO:M: >>  acc: 0.4265  weight_F1: 0.2622 
2025-02-19 04:22:29:INFO:Saving checkpoint at epoch 6 to results/models/cmcm-meld-classification.pth.
2025-02-19 04:24:36:INFO:TRAIN-(cmcm) (1/7/1)>> loss: 1.4675
2025-02-19 04:24:42:INFO:VAL-(cmcm) >>
2025-02-19 04:24:42:INFO:M: >>  acc: 0.4716  weight_F1: 0.4009 
2025-02-19 04:24:43:INFO:Saving checkpoint at epoch 7 to results/models/cmcm-meld-classification.pth.
2025-02-19 04:26:50:INFO:TRAIN-(cmcm) (1/8/1)>> loss: 1.3820
2025-02-19 04:26:56:INFO:VAL-(cmcm) >>
2025-02-19 04:26:56:INFO:M: >>  acc: 0.4869  weight_F1: 0.3916 
2025-02-19 04:29:03:INFO:TRAIN-(cmcm) (2/9/1)>> loss: 1.2945
2025-02-19 04:29:09:INFO:VAL-(cmcm) >>
2025-02-19 04:29:09:INFO:M: >>  acc: 0.5401  weight_F1: 0.4787 
2025-02-19 04:29:10:INFO:Saving checkpoint at epoch 9 to results/models/cmcm-meld-classification.pth.
2025-02-19 04:31:17:INFO:TRAIN-(cmcm) (1/10/1)>> loss: 1.2324
2025-02-19 04:31:23:INFO:VAL-(cmcm) >>
2025-02-19 04:31:23:INFO:M: >>  acc: 0.5645  weight_F1: 0.5153 
2025-02-19 04:31:24:INFO:Saving checkpoint at epoch 10 to results/models/cmcm-meld-classification.pth.
2025-02-19 04:33:31:INFO:TRAIN-(cmcm) (1/11/1)>> loss: 1.1689
2025-02-19 04:33:37:INFO:VAL-(cmcm) >>
2025-02-19 04:33:37:INFO:M: >>  acc: 0.5609  weight_F1: 0.4947 
2025-02-19 04:35:44:INFO:TRAIN-(cmcm) (2/12/1)>> loss: 1.1216
2025-02-19 04:35:50:INFO:VAL-(cmcm) >>
2025-02-19 04:35:50:INFO:M: >>  acc: 0.5996  weight_F1: 0.5726 
2025-02-19 04:35:51:INFO:Saving checkpoint at epoch 12 to results/models/cmcm-meld-classification.pth.
2025-02-19 04:37:58:INFO:TRAIN-(cmcm) (1/13/1)>> loss: 1.0949
2025-02-19 04:38:04:INFO:VAL-(cmcm) >>
2025-02-19 04:38:04:INFO:M: >>  acc: 0.6087  weight_F1: 0.5816 
2025-02-19 04:38:05:INFO:Saving checkpoint at epoch 13 to results/models/cmcm-meld-classification.pth.
2025-02-19 04:40:12:INFO:TRAIN-(cmcm) (1/14/1)>> loss: 1.0727
2025-02-19 04:40:18:INFO:VAL-(cmcm) >>
2025-02-19 04:40:18:INFO:M: >>  acc: 0.6050  weight_F1: 0.5616 
2025-02-19 04:42:25:INFO:TRAIN-(cmcm) (2/15/1)>> loss: 1.0475
2025-02-19 04:42:31:INFO:VAL-(cmcm) >>
2025-02-19 04:42:31:INFO:M: >>  acc: 0.6159  weight_F1: 0.5836 
2025-02-19 04:42:32:INFO:Saving checkpoint at epoch 15 to results/models/cmcm-meld-classification.pth.
2025-02-19 04:44:39:INFO:TRAIN-(cmcm) (1/16/1)>> loss: 1.0307
2025-02-19 04:44:45:INFO:VAL-(cmcm) >>
2025-02-19 04:44:45:INFO:M: >>  acc: 0.6168  weight_F1: 0.5764 
2025-02-19 04:46:53:INFO:TRAIN-(cmcm) (2/17/1)>> loss: 1.0113
2025-02-19 04:46:59:INFO:VAL-(cmcm) >>
2025-02-19 04:46:59:INFO:M: >>  acc: 0.6069  weight_F1: 0.5746 
2025-02-19 04:49:06:INFO:TRAIN-(cmcm) (3/18/1)>> loss: 0.9903
2025-02-19 04:49:12:INFO:VAL-(cmcm) >>
2025-02-19 04:49:12:INFO:M: >>  acc: 0.6123  weight_F1: 0.5799 
2025-02-19 04:51:19:INFO:TRAIN-(cmcm) (4/19/1)>> loss: 0.9714
2025-02-19 04:51:25:INFO:VAL-(cmcm) >>
2025-02-19 04:51:25:INFO:M: >>  acc: 0.6096  weight_F1: 0.5750 
2025-02-19 04:53:32:INFO:TRAIN-(cmcm) (5/20/1)>> loss: 0.9476
2025-02-19 04:53:38:INFO:VAL-(cmcm) >>
2025-02-19 04:53:38:INFO:M: >>  acc: 0.6014  weight_F1: 0.5724 
2025-02-19 04:55:45:INFO:TRAIN-(cmcm) (6/21/1)>> loss: 0.9276
2025-02-19 04:55:52:INFO:VAL-(cmcm) >>
2025-02-19 04:55:52:INFO:M: >>  acc: 0.5978  weight_F1: 0.5790 
2025-02-19 04:57:59:INFO:TRAIN-(cmcm) (7/22/1)>> loss: 0.9046
2025-02-19 04:58:05:INFO:VAL-(cmcm) >>
2025-02-19 04:58:05:INFO:M: >>  acc: 0.5969  weight_F1: 0.5823 
2025-02-19 05:00:12:INFO:TRAIN-(cmcm) (8/23/1)>> loss: 0.8838
2025-02-19 05:00:18:INFO:VAL-(cmcm) >>
2025-02-19 05:00:18:INFO:M: >>  acc: 0.5996  weight_F1: 0.5771 
2025-02-19 05:00:32:INFO:TEST-(cmcm) >>
2025-02-19 05:00:32:INFO:M: >>  acc: 0.6433  weight_F1: 0.6097 
2025-02-19 05:00:33:INFO:Results are added to results/results/meld-classification-30.csv...
2025-02-19 05:00:33:INFO:Start running cmcm...
2025-02-19 05:00:33:INFO:<Storage{'is_tune': False, 'train_mode': 'classification', 'modelName': 'cmcm', 'datasetName': 'meld', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'pretrain_LM': '/data/huggingface_model/Qwen/Qwen-1_8B/', 'gpu_ids': [2], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MELD', 'seq_lens': (65, 157, 32), 'feature_dims': (2048, 64, 64), 'train_samples': 9992, 'num_classes': 3, 'language': 'en', 'KeyEval': 'weight_F1', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'task_specific_prompt': 'Please recognize the emotion of the above multimodal content from the                                             target set <neutral:0, surprise:1, fear:2, sadness:3, joy:4, disgust:5, anger:6>. Assistant: The emotion is', 'max_new_tokens': 1, 'pseudo_tokens': 2, 'label_index_mapping': {'neutral': 0, 'surprise': 1, 'fear': 2, 'sadness': 3, 'joy': 4, 'disgust': 5, 'anger': 6}, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 64, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 8, 'H': 3.0, 'seed': 2222}>
2025-02-19 05:00:33:INFO:Let's use the GPU 2 !
2025-02-19 05:00:37:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2025-02-19 05:00:37:WARNING:Try importing flash-attention for faster inference...
2025-02-19 05:00:37:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2025-02-19 05:00:37:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2025-02-19 05:00:37:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2025-02-19 05:00:39:INFO:trainable params: 1352392 || all params: 1838181064 || trainable%: 0.07357229526982005
2025-02-19 05:00:39:INFO:Init labels...
2025-02-19 05:00:39:INFO:Start training...
2025-02-19 05:02:45:INFO:TRAIN-(cmcm) (1/1/2)>> loss: 3.3484
2025-02-19 05:02:51:INFO:VAL-(cmcm) >>
2025-02-19 05:02:51:INFO:M: >>  acc: 0.4211  weight_F1: 0.2513 
2025-02-19 05:02:52:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-meld-classification.pth.
2025-02-19 05:04:59:INFO:TRAIN-(cmcm) (1/2/2)>> loss: 1.5709
2025-02-19 05:05:05:INFO:VAL-(cmcm) >>
2025-02-19 05:05:05:INFO:M: >>  acc: 0.4238  weight_F1: 0.2523 
2025-02-19 05:05:06:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-meld-classification.pth.
2025-02-19 05:07:13:INFO:TRAIN-(cmcm) (1/3/2)>> loss: 1.5561
2025-02-19 05:07:19:INFO:VAL-(cmcm) >>
2025-02-19 05:07:19:INFO:M: >>  acc: 0.4238  weight_F1: 0.2523 
2025-02-19 05:09:26:INFO:TRAIN-(cmcm) (2/4/2)>> loss: 1.5442
2025-02-19 05:09:32:INFO:VAL-(cmcm) >>
2025-02-19 05:09:32:INFO:M: >>  acc: 0.4238  weight_F1: 0.2523 
2025-02-19 05:11:39:INFO:TRAIN-(cmcm) (3/5/2)>> loss: 1.5167
2025-02-19 05:11:45:INFO:VAL-(cmcm) >>
2025-02-19 05:11:45:INFO:M: >>  acc: 0.4427  weight_F1: 0.3044 
2025-02-19 05:11:46:INFO:Saving checkpoint at epoch 5 to results/models/cmcm-meld-classification.pth.
2025-02-19 05:13:53:INFO:TRAIN-(cmcm) (1/6/2)>> loss: 1.4542
2025-02-19 05:13:59:INFO:VAL-(cmcm) >>
2025-02-19 05:13:59:INFO:M: >>  acc: 0.4761  weight_F1: 0.3901 
2025-02-19 05:14:00:INFO:Saving checkpoint at epoch 6 to results/models/cmcm-meld-classification.pth.
2025-02-19 05:16:07:INFO:TRAIN-(cmcm) (1/7/2)>> loss: 1.2836
2025-02-19 05:16:13:INFO:VAL-(cmcm) >>
2025-02-19 05:16:13:INFO:M: >>  acc: 0.5473  weight_F1: 0.4830 
2025-02-19 05:16:14:INFO:Saving checkpoint at epoch 7 to results/models/cmcm-meld-classification.pth.
2025-02-19 05:18:21:INFO:TRAIN-(cmcm) (1/8/2)>> loss: 1.1648
2025-02-19 05:18:27:INFO:VAL-(cmcm) >>
2025-02-19 05:18:27:INFO:M: >>  acc: 0.5518  weight_F1: 0.4999 
2025-02-19 05:18:28:INFO:Saving checkpoint at epoch 8 to results/models/cmcm-meld-classification.pth.
2025-02-19 05:20:35:INFO:TRAIN-(cmcm) (1/9/2)>> loss: 1.1192
2025-02-19 05:20:41:INFO:VAL-(cmcm) >>
2025-02-19 05:20:41:INFO:M: >>  acc: 0.5969  weight_F1: 0.5797 
2025-02-19 05:20:42:INFO:Saving checkpoint at epoch 9 to results/models/cmcm-meld-classification.pth.
2025-02-19 05:22:49:INFO:TRAIN-(cmcm) (1/10/2)>> loss: 1.0921
2025-02-19 05:22:55:INFO:VAL-(cmcm) >>
2025-02-19 05:22:55:INFO:M: >>  acc: 0.5915  weight_F1: 0.5574 
2025-02-19 05:25:02:INFO:TRAIN-(cmcm) (2/11/2)>> loss: 1.0676
2025-02-19 05:25:08:INFO:VAL-(cmcm) >>
2025-02-19 05:25:08:INFO:M: >>  acc: 0.6041  weight_F1: 0.5654 
2025-02-19 05:27:15:INFO:TRAIN-(cmcm) (3/12/2)>> loss: 1.0477
2025-02-19 05:27:21:INFO:VAL-(cmcm) >>
2025-02-19 05:27:21:INFO:M: >>  acc: 0.5987  weight_F1: 0.5761 
2025-02-19 05:29:28:INFO:TRAIN-(cmcm) (4/13/2)>> loss: 1.0344
2025-02-19 05:29:34:INFO:VAL-(cmcm) >>
2025-02-19 05:29:34:INFO:M: >>  acc: 0.5996  weight_F1: 0.5602 
2025-02-19 05:31:41:INFO:TRAIN-(cmcm) (5/14/2)>> loss: 1.0185
2025-02-19 05:31:47:INFO:VAL-(cmcm) >>
2025-02-19 05:31:47:INFO:M: >>  acc: 0.6105  weight_F1: 0.5712 
2025-02-19 05:33:54:INFO:TRAIN-(cmcm) (6/15/2)>> loss: 0.9981
2025-02-19 05:34:00:INFO:VAL-(cmcm) >>
2025-02-19 05:34:00:INFO:M: >>  acc: 0.6177  weight_F1: 0.5838 
2025-02-19 05:34:01:INFO:Saving checkpoint at epoch 15 to results/models/cmcm-meld-classification.pth.
2025-02-19 05:36:08:INFO:TRAIN-(cmcm) (1/16/2)>> loss: 0.9822
2025-02-19 05:36:14:INFO:VAL-(cmcm) >>
2025-02-19 05:36:14:INFO:M: >>  acc: 0.6132  weight_F1: 0.5878 
2025-02-19 05:36:15:INFO:Saving checkpoint at epoch 16 to results/models/cmcm-meld-classification.pth.
2025-02-19 05:38:22:INFO:TRAIN-(cmcm) (1/17/2)>> loss: 0.9647
2025-02-19 05:38:28:INFO:VAL-(cmcm) >>
2025-02-19 05:38:28:INFO:M: >>  acc: 0.6213  weight_F1: 0.5907 
2025-02-19 05:38:29:INFO:Saving checkpoint at epoch 17 to results/models/cmcm-meld-classification.pth.
2025-02-19 05:40:36:INFO:TRAIN-(cmcm) (1/18/2)>> loss: 0.9425
2025-02-19 05:40:42:INFO:VAL-(cmcm) >>
2025-02-19 05:40:42:INFO:M: >>  acc: 0.6150  weight_F1: 0.5849 
2025-02-19 05:42:49:INFO:TRAIN-(cmcm) (2/19/2)>> loss: 0.9190
2025-02-19 05:42:55:INFO:VAL-(cmcm) >>
2025-02-19 05:42:55:INFO:M: >>  acc: 0.6114  weight_F1: 0.5882 
2025-02-19 05:45:02:INFO:TRAIN-(cmcm) (3/20/2)>> loss: 0.8965
2025-02-19 05:45:09:INFO:VAL-(cmcm) >>
2025-02-19 05:45:09:INFO:M: >>  acc: 0.6186  weight_F1: 0.5918 
2025-02-19 05:45:09:INFO:Saving checkpoint at epoch 20 to results/models/cmcm-meld-classification.pth.
2025-02-19 05:47:17:INFO:TRAIN-(cmcm) (1/21/2)>> loss: 0.8739
2025-02-19 05:47:23:INFO:VAL-(cmcm) >>
2025-02-19 05:47:23:INFO:M: >>  acc: 0.6114  weight_F1: 0.5922 
2025-02-19 05:47:23:INFO:Saving checkpoint at epoch 21 to results/models/cmcm-meld-classification.pth.
2025-02-19 05:49:31:INFO:TRAIN-(cmcm) (1/22/2)>> loss: 0.8487
2025-02-19 05:49:37:INFO:VAL-(cmcm) >>
2025-02-19 05:49:37:INFO:M: >>  acc: 0.6123  weight_F1: 0.5972 
2025-02-19 05:49:37:INFO:Saving checkpoint at epoch 22 to results/models/cmcm-meld-classification.pth.
2025-02-19 05:51:45:INFO:TRAIN-(cmcm) (1/23/2)>> loss: 0.8240
2025-02-19 05:51:51:INFO:VAL-(cmcm) >>
2025-02-19 05:51:51:INFO:M: >>  acc: 0.6078  weight_F1: 0.5882 
2025-02-19 05:53:58:INFO:TRAIN-(cmcm) (2/24/2)>> loss: 0.8036
2025-02-19 05:54:04:INFO:VAL-(cmcm) >>
2025-02-19 05:54:04:INFO:M: >>  acc: 0.6078  weight_F1: 0.5875 
2025-02-19 05:56:11:INFO:TRAIN-(cmcm) (3/25/2)>> loss: 0.7796
2025-02-19 05:56:17:INFO:VAL-(cmcm) >>
2025-02-19 05:56:17:INFO:M: >>  acc: 0.6032  weight_F1: 0.5816 
2025-02-19 05:58:24:INFO:TRAIN-(cmcm) (4/26/2)>> loss: 0.7628
2025-02-19 05:58:30:INFO:VAL-(cmcm) >>
2025-02-19 05:58:30:INFO:M: >>  acc: 0.6050  weight_F1: 0.5891 
2025-02-19 06:00:37:INFO:TRAIN-(cmcm) (5/27/2)>> loss: 0.7466
2025-02-19 06:00:43:INFO:VAL-(cmcm) >>
2025-02-19 06:00:43:INFO:M: >>  acc: 0.6032  weight_F1: 0.5854 
2025-02-19 06:02:50:INFO:TRAIN-(cmcm) (6/28/2)>> loss: 0.7360
2025-02-19 06:02:56:INFO:VAL-(cmcm) >>
2025-02-19 06:02:56:INFO:M: >>  acc: 0.6014  weight_F1: 0.5836 
2025-02-19 06:05:03:INFO:TRAIN-(cmcm) (7/29/2)>> loss: 0.7298
2025-02-19 06:05:09:INFO:VAL-(cmcm) >>
2025-02-19 06:05:09:INFO:M: >>  acc: 0.6005  weight_F1: 0.5831 
2025-02-19 06:07:16:INFO:TRAIN-(cmcm) (8/30/2)>> loss: 0.7252
2025-02-19 06:07:22:INFO:VAL-(cmcm) >>
2025-02-19 06:07:22:INFO:M: >>  acc: 0.5978  weight_F1: 0.5805 
2025-02-19 06:07:36:INFO:TEST-(cmcm) >>
2025-02-19 06:07:36:INFO:M: >>  acc: 0.6261  weight_F1: 0.6071 
2025-02-19 06:07:37:INFO:Results are added to results/results/meld-classification-30.csv...
2025-02-19 06:07:37:INFO:Start running cmcm...
2025-02-19 06:07:37:INFO:<Storage{'is_tune': False, 'train_mode': 'classification', 'modelName': 'cmcm', 'datasetName': 'meld', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'pretrain_LM': '/data/huggingface_model/Qwen/Qwen-1_8B/', 'gpu_ids': [2], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MELD', 'seq_lens': (65, 157, 32), 'feature_dims': (2048, 64, 64), 'train_samples': 9992, 'num_classes': 3, 'language': 'en', 'KeyEval': 'weight_F1', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'task_specific_prompt': 'Please recognize the emotion of the above multimodal content from the                                             target set <neutral:0, surprise:1, fear:2, sadness:3, joy:4, disgust:5, anger:6>. Assistant: The emotion is', 'max_new_tokens': 1, 'pseudo_tokens': 2, 'label_index_mapping': {'neutral': 0, 'surprise': 1, 'fear': 2, 'sadness': 3, 'joy': 4, 'disgust': 5, 'anger': 6}, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 64, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 8, 'H': 3.0, 'seed': 3333}>
2025-02-19 06:07:37:INFO:Let's use the GPU 2 !
2025-02-19 06:07:42:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2025-02-19 06:07:42:WARNING:Try importing flash-attention for faster inference...
2025-02-19 06:07:42:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2025-02-19 06:07:42:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2025-02-19 06:07:42:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2025-02-19 06:07:43:INFO:trainable params: 1352392 || all params: 1838181064 || trainable%: 0.07357229526982005
2025-02-19 06:07:43:INFO:Init labels...
2025-02-19 06:07:43:INFO:Start training...
2025-02-19 06:09:50:INFO:TRAIN-(cmcm) (1/1/3)>> loss: 4.9644
2025-02-19 06:09:56:INFO:VAL-(cmcm) >>
2025-02-19 06:09:56:INFO:M: >>  acc: 0.4238  weight_F1: 0.2542 
2025-02-19 06:09:56:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-meld-classification.pth.
2025-02-19 06:12:04:INFO:TRAIN-(cmcm) (1/2/3)>> loss: 1.5463
2025-02-19 06:12:10:INFO:VAL-(cmcm) >>
2025-02-19 06:12:10:INFO:M: >>  acc: 0.4238  weight_F1: 0.2523 
2025-02-19 06:14:17:INFO:TRAIN-(cmcm) (2/3/3)>> loss: 1.5016
2025-02-19 06:14:23:INFO:VAL-(cmcm) >>
2025-02-19 06:14:23:INFO:M: >>  acc: 0.4319  weight_F1: 0.2815 
2025-02-19 06:14:24:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-meld-classification.pth.
2025-02-19 06:16:31:INFO:TRAIN-(cmcm) (1/4/3)>> loss: 1.4038
2025-02-19 06:16:37:INFO:VAL-(cmcm) >>
2025-02-19 06:16:37:INFO:M: >>  acc: 0.4824  weight_F1: 0.3798 
2025-02-19 06:16:38:INFO:Saving checkpoint at epoch 4 to results/models/cmcm-meld-classification.pth.
2025-02-19 06:18:45:INFO:TRAIN-(cmcm) (1/5/3)>> loss: 1.2958
2025-02-19 06:18:51:INFO:VAL-(cmcm) >>
2025-02-19 06:18:51:INFO:M: >>  acc: 0.5230  weight_F1: 0.4590 
2025-02-19 06:18:52:INFO:Saving checkpoint at epoch 5 to results/models/cmcm-meld-classification.pth.
2025-02-19 06:20:59:INFO:TRAIN-(cmcm) (1/6/3)>> loss: 1.2144
2025-02-19 06:21:05:INFO:VAL-(cmcm) >>
2025-02-19 06:21:05:INFO:M: >>  acc: 0.5392  weight_F1: 0.5101 
2025-02-19 06:21:06:INFO:Saving checkpoint at epoch 6 to results/models/cmcm-meld-classification.pth.
2025-02-19 06:23:13:INFO:TRAIN-(cmcm) (1/7/3)>> loss: 1.1551
2025-02-19 06:23:19:INFO:VAL-(cmcm) >>
2025-02-19 06:23:19:INFO:M: >>  acc: 0.5708  weight_F1: 0.5263 
2025-02-19 06:23:20:INFO:Saving checkpoint at epoch 7 to results/models/cmcm-meld-classification.pth.
2025-02-19 06:25:27:INFO:TRAIN-(cmcm) (1/8/3)>> loss: 1.1238
2025-02-19 06:25:33:INFO:VAL-(cmcm) >>
2025-02-19 06:25:33:INFO:M: >>  acc: 0.5852  weight_F1: 0.5348 
2025-02-19 06:25:34:INFO:Saving checkpoint at epoch 8 to results/models/cmcm-meld-classification.pth.
2025-02-19 06:27:41:INFO:TRAIN-(cmcm) (1/9/3)>> loss: 1.0985
2025-02-19 06:27:48:INFO:VAL-(cmcm) >>
2025-02-19 06:27:48:INFO:M: >>  acc: 0.5843  weight_F1: 0.5348 
2025-02-19 06:27:49:INFO:Saving checkpoint at epoch 9 to results/models/cmcm-meld-classification.pth.
2025-02-19 06:29:57:INFO:TRAIN-(cmcm) (1/10/3)>> loss: 1.0841
2025-02-19 06:30:03:INFO:VAL-(cmcm) >>
2025-02-19 06:30:03:INFO:M: >>  acc: 0.5888  weight_F1: 0.5479 
2025-02-19 06:30:04:INFO:Saving checkpoint at epoch 10 to results/models/cmcm-meld-classification.pth.
2025-02-19 06:32:12:INFO:TRAIN-(cmcm) (1/11/3)>> loss: 1.0649
2025-02-19 06:32:18:INFO:VAL-(cmcm) >>
2025-02-19 06:32:18:INFO:M: >>  acc: 0.6023  weight_F1: 0.5721 
2025-02-19 06:32:19:INFO:Saving checkpoint at epoch 11 to results/models/cmcm-meld-classification.pth.
2025-02-19 06:34:29:INFO:TRAIN-(cmcm) (1/12/3)>> loss: 1.0537
2025-02-19 06:34:35:INFO:VAL-(cmcm) >>
2025-02-19 06:34:35:INFO:M: >>  acc: 0.6023  weight_F1: 0.5607 
2025-02-19 06:36:43:INFO:TRAIN-(cmcm) (2/13/3)>> loss: 1.0385
2025-02-19 06:36:49:INFO:VAL-(cmcm) >>
2025-02-19 06:36:49:INFO:M: >>  acc: 0.5951  weight_F1: 0.5595 
2025-02-19 06:38:56:INFO:TRAIN-(cmcm) (3/14/3)>> loss: 1.0247
2025-02-19 06:39:02:INFO:VAL-(cmcm) >>
2025-02-19 06:39:02:INFO:M: >>  acc: 0.5924  weight_F1: 0.5459 
2025-02-19 06:41:10:INFO:TRAIN-(cmcm) (4/15/3)>> loss: 1.0053
2025-02-19 06:41:16:INFO:VAL-(cmcm) >>
2025-02-19 06:41:16:INFO:M: >>  acc: 0.6087  weight_F1: 0.5707 
2025-02-19 06:43:23:INFO:TRAIN-(cmcm) (5/16/3)>> loss: 0.9893
2025-02-19 06:43:29:INFO:VAL-(cmcm) >>
2025-02-19 06:43:29:INFO:M: >>  acc: 0.6096  weight_F1: 0.5901 
2025-02-19 06:43:30:INFO:Saving checkpoint at epoch 16 to results/models/cmcm-meld-classification.pth.
2025-02-19 06:45:38:INFO:TRAIN-(cmcm) (1/17/3)>> loss: 0.9761
2025-02-19 06:45:44:INFO:VAL-(cmcm) >>
2025-02-19 06:45:44:INFO:M: >>  acc: 0.6087  weight_F1: 0.5768 
2025-02-19 06:47:51:INFO:TRAIN-(cmcm) (2/18/3)>> loss: 0.9569
2025-02-19 06:47:57:INFO:VAL-(cmcm) >>
2025-02-19 06:47:57:INFO:M: >>  acc: 0.6105  weight_F1: 0.5749 
2025-02-19 06:50:04:INFO:TRAIN-(cmcm) (3/19/3)>> loss: 0.9368
2025-02-19 06:50:11:INFO:VAL-(cmcm) >>
2025-02-19 06:50:11:INFO:M: >>  acc: 0.6195  weight_F1: 0.5985 
2025-02-19 06:50:11:INFO:Saving checkpoint at epoch 19 to results/models/cmcm-meld-classification.pth.
2025-02-19 06:52:19:INFO:TRAIN-(cmcm) (1/20/3)>> loss: 0.9186
2025-02-19 06:52:25:INFO:VAL-(cmcm) >>
2025-02-19 06:52:25:INFO:M: >>  acc: 0.6050  weight_F1: 0.5770 
2025-02-19 06:54:33:INFO:TRAIN-(cmcm) (2/21/3)>> loss: 0.8943
2025-02-19 06:54:39:INFO:VAL-(cmcm) >>
2025-02-19 06:54:39:INFO:M: >>  acc: 0.6096  weight_F1: 0.5804 
2025-02-19 06:56:47:INFO:TRAIN-(cmcm) (3/22/3)>> loss: 0.8742
2025-02-19 06:56:53:INFO:VAL-(cmcm) >>
2025-02-19 06:56:53:INFO:M: >>  acc: 0.6114  weight_F1: 0.5908 
2025-02-19 06:59:01:INFO:TRAIN-(cmcm) (4/23/3)>> loss: 0.8539
2025-02-19 06:59:08:INFO:VAL-(cmcm) >>
2025-02-19 06:59:08:INFO:M: >>  acc: 0.6060  weight_F1: 0.5796 
2025-02-19 07:01:15:INFO:TRAIN-(cmcm) (5/24/3)>> loss: 0.8321
2025-02-19 07:01:22:INFO:VAL-(cmcm) >>
2025-02-19 07:01:22:INFO:M: >>  acc: 0.6050  weight_F1: 0.5827 
2025-02-19 07:03:29:INFO:TRAIN-(cmcm) (6/25/3)>> loss: 0.8141
2025-02-19 07:03:36:INFO:VAL-(cmcm) >>
2025-02-19 07:03:36:INFO:M: >>  acc: 0.6069  weight_F1: 0.5838 
2025-02-19 07:05:43:INFO:TRAIN-(cmcm) (7/26/3)>> loss: 0.7972
2025-02-19 07:05:49:INFO:VAL-(cmcm) >>
2025-02-19 07:05:49:INFO:M: >>  acc: 0.6014  weight_F1: 0.5828 
2025-02-19 07:07:57:INFO:TRAIN-(cmcm) (8/27/3)>> loss: 0.7839
2025-02-19 07:08:03:INFO:VAL-(cmcm) >>
2025-02-19 07:08:03:INFO:M: >>  acc: 0.6023  weight_F1: 0.5811 
2025-02-19 07:08:18:INFO:TEST-(cmcm) >>
2025-02-19 07:08:18:INFO:M: >>  acc: 0.6211  weight_F1: 0.5997 
2025-02-19 07:08:18:INFO:Results are added to results/results/meld-classification-30.csv...
2025-02-19 07:08:18:INFO:Start running cmcm...
2025-02-19 07:08:18:INFO:<Storage{'is_tune': False, 'train_mode': 'classification', 'modelName': 'cmcm', 'datasetName': 'meld', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'pretrain_LM': '/data/huggingface_model/Qwen/Qwen-1_8B/', 'gpu_ids': [2], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MELD', 'seq_lens': (65, 157, 32), 'feature_dims': (2048, 64, 64), 'train_samples': 9992, 'num_classes': 3, 'language': 'en', 'KeyEval': 'weight_F1', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'task_specific_prompt': 'Please recognize the emotion of the above multimodal content from the                                             target set <neutral:0, surprise:1, fear:2, sadness:3, joy:4, disgust:5, anger:6>. Assistant: The emotion is', 'max_new_tokens': 1, 'pseudo_tokens': 2, 'label_index_mapping': {'neutral': 0, 'surprise': 1, 'fear': 2, 'sadness': 3, 'joy': 4, 'disgust': 5, 'anger': 6}, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 64, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 8, 'H': 3.0, 'seed': 4444}>
2025-02-19 07:08:18:INFO:Let's use the GPU 2 !
2025-02-19 07:08:32:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2025-02-19 07:08:32:WARNING:Try importing flash-attention for faster inference...
2025-02-19 07:08:32:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2025-02-19 07:08:32:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2025-02-19 07:08:32:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2025-02-19 07:08:34:INFO:trainable params: 1352392 || all params: 1838181064 || trainable%: 0.07357229526982005
2025-02-19 07:08:34:INFO:Init labels...
2025-02-19 07:08:34:INFO:Start training...
2025-02-19 07:10:41:INFO:TRAIN-(cmcm) (1/1/4)>> loss: 7.1167
2025-02-19 07:10:47:INFO:VAL-(cmcm) >>
2025-02-19 07:10:47:INFO:M: >>  acc: 0.4220  weight_F1: 0.2663 
2025-02-19 07:10:48:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-meld-classification.pth.
2025-02-19 07:12:56:INFO:TRAIN-(cmcm) (1/2/4)>> loss: 1.5730
2025-02-19 07:13:02:INFO:VAL-(cmcm) >>
2025-02-19 07:13:02:INFO:M: >>  acc: 0.4256  weight_F1: 0.2574 
2025-02-19 07:15:10:INFO:TRAIN-(cmcm) (2/3/4)>> loss: 1.5317
2025-02-19 07:15:16:INFO:VAL-(cmcm) >>
2025-02-19 07:15:16:INFO:M: >>  acc: 0.4220  weight_F1: 0.2980 
2025-02-19 07:15:16:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-meld-classification.pth.
2025-02-19 07:17:24:INFO:TRAIN-(cmcm) (1/4/4)>> loss: 1.4936
2025-02-19 07:17:30:INFO:VAL-(cmcm) >>
2025-02-19 07:17:30:INFO:M: >>  acc: 0.4436  weight_F1: 0.2949 
2025-02-19 07:19:38:INFO:TRAIN-(cmcm) (2/5/4)>> loss: 1.4737
2025-02-19 07:19:44:INFO:VAL-(cmcm) >>
2025-02-19 07:19:44:INFO:M: >>  acc: 0.4427  weight_F1: 0.3457 
2025-02-19 07:19:45:INFO:Saving checkpoint at epoch 5 to results/models/cmcm-meld-classification.pth.
2025-02-19 07:21:52:INFO:TRAIN-(cmcm) (1/6/4)>> loss: 1.4599
2025-02-19 07:21:59:INFO:VAL-(cmcm) >>
2025-02-19 07:21:59:INFO:M: >>  acc: 0.4545  weight_F1: 0.3243 
2025-02-19 07:24:06:INFO:TRAIN-(cmcm) (2/7/4)>> loss: 1.4487
2025-02-19 07:24:12:INFO:VAL-(cmcm) >>
2025-02-19 07:24:12:INFO:M: >>  acc: 0.4292  weight_F1: 0.3055 
2025-02-19 07:26:20:INFO:TRAIN-(cmcm) (3/8/4)>> loss: 1.4412
2025-02-19 07:26:26:INFO:VAL-(cmcm) >>
2025-02-19 07:26:26:INFO:M: >>  acc: 0.4409  weight_F1: 0.3069 
2025-02-19 07:28:34:INFO:TRAIN-(cmcm) (4/9/4)>> loss: 1.4370
2025-02-19 07:28:40:INFO:VAL-(cmcm) >>
2025-02-19 07:28:40:INFO:M: >>  acc: 0.4418  weight_F1: 0.3020 
2025-02-19 07:30:47:INFO:TRAIN-(cmcm) (5/10/4)>> loss: 1.4254
2025-02-19 07:30:53:INFO:VAL-(cmcm) >>
2025-02-19 07:30:53:INFO:M: >>  acc: 0.4418  weight_F1: 0.3336 
2025-02-19 07:33:01:INFO:TRAIN-(cmcm) (6/11/4)>> loss: 1.4101
2025-02-19 07:33:07:INFO:VAL-(cmcm) >>
2025-02-19 07:33:07:INFO:M: >>  acc: 0.4527  weight_F1: 0.3448 
2025-02-19 07:35:14:INFO:TRAIN-(cmcm) (7/12/4)>> loss: 1.4008
2025-02-19 07:35:21:INFO:VAL-(cmcm) >>
2025-02-19 07:35:21:INFO:M: >>  acc: 0.4572  weight_F1: 0.3259 
2025-02-19 07:37:28:INFO:TRAIN-(cmcm) (8/13/4)>> loss: 1.3886
2025-02-19 07:37:34:INFO:VAL-(cmcm) >>
2025-02-19 07:37:34:INFO:M: >>  acc: 0.4563  weight_F1: 0.3568 
2025-02-19 07:37:35:INFO:Saving checkpoint at epoch 13 to results/models/cmcm-meld-classification.pth.
2025-02-19 07:39:43:INFO:TRAIN-(cmcm) (1/14/4)>> loss: 1.3722
2025-02-19 07:39:49:INFO:VAL-(cmcm) >>
2025-02-19 07:39:49:INFO:M: >>  acc: 0.4518  weight_F1: 0.3552 
2025-02-19 07:41:56:INFO:TRAIN-(cmcm) (2/15/4)>> loss: 1.3472
2025-02-19 07:42:02:INFO:VAL-(cmcm) >>
2025-02-19 07:42:02:INFO:M: >>  acc: 0.4500  weight_F1: 0.3724 
2025-02-19 07:42:03:INFO:Saving checkpoint at epoch 15 to results/models/cmcm-meld-classification.pth.
2025-02-19 07:44:11:INFO:TRAIN-(cmcm) (1/16/4)>> loss: 1.3267
2025-02-19 07:44:17:INFO:VAL-(cmcm) >>
2025-02-19 07:44:17:INFO:M: >>  acc: 0.4626  weight_F1: 0.3606 
2025-02-19 07:46:25:INFO:TRAIN-(cmcm) (2/17/4)>> loss: 1.3005
2025-02-19 07:46:31:INFO:VAL-(cmcm) >>
2025-02-19 07:46:31:INFO:M: >>  acc: 0.4319  weight_F1: 0.3525 
2025-02-19 07:48:38:INFO:TRAIN-(cmcm) (3/18/4)>> loss: 1.2771
2025-02-19 07:48:44:INFO:VAL-(cmcm) >>
2025-02-19 07:48:44:INFO:M: >>  acc: 0.4445  weight_F1: 0.3673 
2025-02-19 07:50:52:INFO:TRAIN-(cmcm) (4/19/4)>> loss: 1.2500
2025-02-19 07:50:58:INFO:VAL-(cmcm) >>
2025-02-19 07:50:58:INFO:M: >>  acc: 0.4427  weight_F1: 0.3648 
2025-02-19 07:53:06:INFO:TRAIN-(cmcm) (5/20/4)>> loss: 1.2261
2025-02-19 07:53:12:INFO:VAL-(cmcm) >>
2025-02-19 07:53:12:INFO:M: >>  acc: 0.4202  weight_F1: 0.3583 
2025-02-19 07:55:19:INFO:TRAIN-(cmcm) (6/21/4)>> loss: 1.1975
2025-02-19 07:55:25:INFO:VAL-(cmcm) >>
2025-02-19 07:55:25:INFO:M: >>  acc: 0.4482  weight_F1: 0.3647 
2025-02-19 07:57:33:INFO:TRAIN-(cmcm) (7/22/4)>> loss: 1.1725
2025-02-19 07:57:39:INFO:VAL-(cmcm) >>
2025-02-19 07:57:39:INFO:M: >>  acc: 0.4382  weight_F1: 0.3762 
2025-02-19 07:57:40:INFO:Saving checkpoint at epoch 22 to results/models/cmcm-meld-classification.pth.
2025-02-19 07:59:47:INFO:TRAIN-(cmcm) (1/23/4)>> loss: 1.1427
2025-02-19 07:59:54:INFO:VAL-(cmcm) >>
2025-02-19 07:59:54:INFO:M: >>  acc: 0.4301  weight_F1: 0.3750 
2025-02-19 08:02:01:INFO:TRAIN-(cmcm) (2/24/4)>> loss: 1.1209
2025-02-19 08:02:07:INFO:VAL-(cmcm) >>
2025-02-19 08:02:07:INFO:M: >>  acc: 0.4373  weight_F1: 0.3900 
2025-02-19 08:02:08:INFO:Saving checkpoint at epoch 24 to results/models/cmcm-meld-classification.pth.
2025-02-19 08:04:16:INFO:TRAIN-(cmcm) (1/25/4)>> loss: 1.0966
2025-02-19 08:04:22:INFO:VAL-(cmcm) >>
2025-02-19 08:04:22:INFO:M: >>  acc: 0.4310  weight_F1: 0.3802 
2025-02-19 08:06:30:INFO:TRAIN-(cmcm) (2/26/4)>> loss: 1.0802
2025-02-19 08:06:36:INFO:VAL-(cmcm) >>
2025-02-19 08:06:36:INFO:M: >>  acc: 0.4229  weight_F1: 0.3787 
2025-02-19 08:08:44:INFO:TRAIN-(cmcm) (3/27/4)>> loss: 1.0660
2025-02-19 08:08:50:INFO:VAL-(cmcm) >>
2025-02-19 08:08:50:INFO:M: >>  acc: 0.4310  weight_F1: 0.3810 
2025-02-19 08:10:57:INFO:TRAIN-(cmcm) (4/28/4)>> loss: 1.0549
2025-02-19 08:11:03:INFO:VAL-(cmcm) >>
2025-02-19 08:11:03:INFO:M: >>  acc: 0.4265  weight_F1: 0.3815 
2025-02-19 08:13:11:INFO:TRAIN-(cmcm) (5/29/4)>> loss: 1.0490
2025-02-19 08:13:17:INFO:VAL-(cmcm) >>
2025-02-19 08:13:17:INFO:M: >>  acc: 0.4247  weight_F1: 0.3774 
2025-02-19 08:15:24:INFO:TRAIN-(cmcm) (6/30/4)>> loss: 1.0465
2025-02-19 08:15:30:INFO:VAL-(cmcm) >>
2025-02-19 08:15:30:INFO:M: >>  acc: 0.4229  weight_F1: 0.3759 
2025-02-19 08:17:38:INFO:TRAIN-(cmcm) (7/31/4)>> loss: 1.0457
2025-02-19 08:17:44:INFO:VAL-(cmcm) >>
2025-02-19 08:17:44:INFO:M: >>  acc: 0.4211  weight_F1: 0.3743 
2025-02-19 08:19:51:INFO:TRAIN-(cmcm) (8/32/4)>> loss: 1.0466
2025-02-19 08:19:58:INFO:VAL-(cmcm) >>
2025-02-19 08:19:58:INFO:M: >>  acc: 0.4238  weight_F1: 0.3780 
2025-02-19 08:20:12:INFO:TEST-(cmcm) >>
2025-02-19 08:20:12:INFO:M: >>  acc: 0.4579  weight_F1: 0.4155 
2025-02-19 08:20:12:INFO:Results are added to results/results/meld-classification-30.csv...
2025-02-19 08:20:12:INFO:Start running cmcm...
2025-02-19 08:20:12:INFO:<Storage{'is_tune': False, 'train_mode': 'classification', 'modelName': 'cmcm', 'datasetName': 'meld', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'pretrain_LM': '/data/huggingface_model/Qwen/Qwen-1_8B/', 'gpu_ids': [2], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MELD', 'seq_lens': (65, 157, 32), 'feature_dims': (2048, 64, 64), 'train_samples': 9992, 'num_classes': 3, 'language': 'en', 'KeyEval': 'weight_F1', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'task_specific_prompt': 'Please recognize the emotion of the above multimodal content from the                                             target set <neutral:0, surprise:1, fear:2, sadness:3, joy:4, disgust:5, anger:6>. Assistant: The emotion is', 'max_new_tokens': 1, 'pseudo_tokens': 2, 'label_index_mapping': {'neutral': 0, 'surprise': 1, 'fear': 2, 'sadness': 3, 'joy': 4, 'disgust': 5, 'anger': 6}, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 64, 'v_lstm_hidden_size': 32, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'gamma': 1, 'update_epochs': 1, 'early_stop': 8, 'H': 3.0, 'seed': 5555}>
2025-02-19 08:20:12:INFO:Let's use the GPU 2 !
2025-02-19 08:20:20:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2025-02-19 08:20:20:WARNING:Try importing flash-attention for faster inference...
2025-02-19 08:20:20:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2025-02-19 08:20:20:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2025-02-19 08:20:20:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2025-02-19 08:20:22:INFO:trainable params: 1352392 || all params: 1838181064 || trainable%: 0.07357229526982005
2025-02-19 08:20:22:INFO:Init labels...
2025-02-19 08:20:22:INFO:Start training...
2025-02-19 08:22:32:INFO:TRAIN-(cmcm) (1/1/5)>> loss: 4.6097
2025-02-19 08:22:38:INFO:VAL-(cmcm) >>
2025-02-19 08:22:38:INFO:M: >>  acc: 0.4238  weight_F1: 0.2523 
2025-02-19 08:22:39:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-meld-classification.pth.
2025-02-19 08:24:48:INFO:TRAIN-(cmcm) (1/2/5)>> loss: 1.5597
2025-02-19 08:24:54:INFO:VAL-(cmcm) >>
2025-02-19 08:24:54:INFO:M: >>  acc: 0.4238  weight_F1: 0.2523 
2025-02-19 08:27:03:INFO:TRAIN-(cmcm) (2/3/5)>> loss: 1.5442
2025-02-19 08:27:09:INFO:VAL-(cmcm) >>
2025-02-19 08:27:09:INFO:M: >>  acc: 0.4211  weight_F1: 0.2515 
2025-02-19 08:29:17:INFO:TRAIN-(cmcm) (3/4/5)>> loss: 1.5309
2025-02-19 08:29:23:INFO:VAL-(cmcm) >>
2025-02-19 08:29:23:INFO:M: >>  acc: 0.4220  weight_F1: 0.2766 
2025-02-19 08:29:24:INFO:Saving checkpoint at epoch 4 to results/models/cmcm-meld-classification.pth.
2025-02-19 08:31:32:INFO:TRAIN-(cmcm) (1/5/5)>> loss: 1.4698
2025-02-19 08:31:38:INFO:VAL-(cmcm) >>
2025-02-19 08:31:38:INFO:M: >>  acc: 0.4545  weight_F1: 0.3952 
2025-02-19 08:31:39:INFO:Saving checkpoint at epoch 5 to results/models/cmcm-meld-classification.pth.
2025-02-19 08:33:47:INFO:TRAIN-(cmcm) (1/6/5)>> loss: 1.3700
2025-02-19 08:33:53:INFO:VAL-(cmcm) >>
2025-02-19 08:33:53:INFO:M: >>  acc: 0.5041  weight_F1: 0.4607 
2025-02-19 08:33:54:INFO:Saving checkpoint at epoch 6 to results/models/cmcm-meld-classification.pth.
2025-02-19 08:36:03:INFO:TRAIN-(cmcm) (1/7/5)>> loss: 1.2697
2025-02-19 08:36:09:INFO:VAL-(cmcm) >>
2025-02-19 08:36:09:INFO:M: >>  acc: 0.5329  weight_F1: 0.4532 
2025-02-19 08:38:17:INFO:TRAIN-(cmcm) (2/8/5)>> loss: 1.1646
2025-02-19 08:38:24:INFO:VAL-(cmcm) >>
2025-02-19 08:38:24:INFO:M: >>  acc: 0.5942  weight_F1: 0.5625 
2025-02-19 08:38:25:INFO:Saving checkpoint at epoch 8 to results/models/cmcm-meld-classification.pth.
2025-02-19 08:40:33:INFO:TRAIN-(cmcm) (1/9/5)>> loss: 1.1128
2025-02-19 08:40:40:INFO:VAL-(cmcm) >>
2025-02-19 08:40:40:INFO:M: >>  acc: 0.6060  weight_F1: 0.5818 
2025-02-19 08:40:41:INFO:Saving checkpoint at epoch 9 to results/models/cmcm-meld-classification.pth.
2025-02-19 08:42:49:INFO:TRAIN-(cmcm) (1/10/5)>> loss: 1.0792
2025-02-19 08:42:55:INFO:VAL-(cmcm) >>
2025-02-19 08:42:55:INFO:M: >>  acc: 0.6069  weight_F1: 0.5779 
2025-02-19 08:45:03:INFO:TRAIN-(cmcm) (2/11/5)>> loss: 1.0579
2025-02-19 08:45:09:INFO:VAL-(cmcm) >>
2025-02-19 08:45:09:INFO:M: >>  acc: 0.6132  weight_F1: 0.5834 
2025-02-19 08:45:10:INFO:Saving checkpoint at epoch 11 to results/models/cmcm-meld-classification.pth.
2025-02-19 08:47:18:INFO:TRAIN-(cmcm) (1/12/5)>> loss: 1.0409
2025-02-19 08:47:25:INFO:VAL-(cmcm) >>
2025-02-19 08:47:25:INFO:M: >>  acc: 0.6005  weight_F1: 0.5723 
2025-02-19 08:49:32:INFO:TRAIN-(cmcm) (2/13/5)>> loss: 1.0281
2025-02-19 08:49:38:INFO:VAL-(cmcm) >>
2025-02-19 08:49:38:INFO:M: >>  acc: 0.6231  weight_F1: 0.5892 
2025-02-19 08:49:39:INFO:Saving checkpoint at epoch 13 to results/models/cmcm-meld-classification.pth.
2025-02-19 08:51:47:INFO:TRAIN-(cmcm) (1/14/5)>> loss: 1.0149
2025-02-19 08:51:54:INFO:VAL-(cmcm) >>
2025-02-19 08:51:54:INFO:M: >>  acc: 0.6204  weight_F1: 0.5873 
2025-02-19 08:54:01:INFO:TRAIN-(cmcm) (2/15/5)>> loss: 1.0036
2025-02-19 08:54:07:INFO:VAL-(cmcm) >>
2025-02-19 08:54:07:INFO:M: >>  acc: 0.6069  weight_F1: 0.5715 
2025-02-19 08:56:15:INFO:TRAIN-(cmcm) (3/16/5)>> loss: 0.9886
2025-02-19 08:56:21:INFO:VAL-(cmcm) >>
2025-02-19 08:56:21:INFO:M: >>  acc: 0.6123  weight_F1: 0.5800 
2025-02-19 08:58:29:INFO:TRAIN-(cmcm) (4/17/5)>> loss: 0.9769
2025-02-19 08:58:36:INFO:VAL-(cmcm) >>
2025-02-19 08:58:36:INFO:M: >>  acc: 0.6123  weight_F1: 0.5813 
2025-02-19 09:00:44:INFO:TRAIN-(cmcm) (5/18/5)>> loss: 0.9586
2025-02-19 09:00:50:INFO:VAL-(cmcm) >>
2025-02-19 09:00:50:INFO:M: >>  acc: 0.6060  weight_F1: 0.5790 
2025-02-19 09:02:58:INFO:TRAIN-(cmcm) (6/19/5)>> loss: 0.9472
2025-02-19 09:03:04:INFO:VAL-(cmcm) >>
2025-02-19 09:03:04:INFO:M: >>  acc: 0.6069  weight_F1: 0.5769 
2025-02-19 09:05:12:INFO:TRAIN-(cmcm) (7/20/5)>> loss: 0.9305
2025-02-19 09:05:18:INFO:VAL-(cmcm) >>
2025-02-19 09:05:18:INFO:M: >>  acc: 0.6114  weight_F1: 0.5842 
2025-02-19 09:07:26:INFO:TRAIN-(cmcm) (8/21/5)>> loss: 0.9180
2025-02-19 09:07:32:INFO:VAL-(cmcm) >>
2025-02-19 09:07:32:INFO:M: >>  acc: 0.5978  weight_F1: 0.5708 
2025-02-19 09:07:47:INFO:TEST-(cmcm) >>
2025-02-19 09:07:47:INFO:M: >>  acc: 0.6349  weight_F1: 0.6028 
2025-02-19 09:07:47:INFO:Results are added to results/results/meld-classification-30.csv...
2025-02-19 09:07:47:INFO:Start running cmcm...
2025-02-19 09:07:47:INFO:<Storage{'is_tune': False, 'train_mode': 'classification', 'modelName': 'cmcm', 'datasetName': 'cherma', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'pretrain_LM': '/data/huggingface_model/Qwen/Qwen-1_8B/', 'gpu_ids': [2], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/CHERMA0723', 'seq_lens': (78, 543, 16), 'feature_dims': (2048, 1024, 2048), 'train_samples': 16326, 'num_classes': 3, 'language': 'cn', 'KeyEval': 'weight_F1', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'task_specific_prompt': '<:0, :1, :2, :3, :4, :5, :6>: ', 'max_new_tokens': 1, 'pseudo_tokens': 4, 'label_index_mapping': {'': 0, '': 1, '': 2, '': 3, '': 4, '': 5, '': 6}, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 16, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'update_epochs': 1, 'early_stop': 8, 'gamma': 0, 'H': 1.0, 'seed': 1111}>
2025-02-19 09:07:47:INFO:Let's use the GPU 2 !
2025-02-19 09:18:29:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2025-02-19 09:18:29:WARNING:Try importing flash-attention for faster inference...
2025-02-19 09:18:29:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2025-02-19 09:18:29:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2025-02-19 09:18:29:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2025-02-19 09:18:32:INFO:trainable params: 1561932 || all params: 1838390604 || trainable%: 0.08496192248815475
2025-02-19 09:18:32:INFO:Init labels...
2025-02-19 09:18:32:INFO:Start training...
2025-02-19 09:23:31:INFO:TRAIN-(cmcm) (1/1/1)>> loss: 1.5273
2025-02-19 09:24:13:INFO:VAL-(cmcm) >>
2025-02-19 09:24:13:INFO:M: >>  acc: 0.6681  weight_F1: 0.6766 
2025-02-19 09:24:14:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-cherma-classification.pth.
2025-02-19 09:29:10:INFO:TRAIN-(cmcm) (1/2/1)>> loss: 0.8087
2025-02-19 09:29:51:INFO:VAL-(cmcm) >>
2025-02-19 09:29:51:INFO:M: >>  acc: 0.6981  weight_F1: 0.6904 
2025-02-19 09:29:52:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-cherma-classification.pth.
2025-02-19 09:34:48:INFO:TRAIN-(cmcm) (1/3/1)>> loss: 0.7553
2025-02-19 09:35:30:INFO:VAL-(cmcm) >>
2025-02-19 09:35:30:INFO:M: >>  acc: 0.7214  weight_F1: 0.7217 
2025-02-19 09:35:31:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-cherma-classification.pth.
2025-02-19 09:40:30:INFO:TRAIN-(cmcm) (1/4/1)>> loss: 0.7299
2025-02-19 09:41:11:INFO:VAL-(cmcm) >>
2025-02-19 09:41:11:INFO:M: >>  acc: 0.7042  weight_F1: 0.6948 
2025-02-19 09:46:15:INFO:TRAIN-(cmcm) (2/5/1)>> loss: 0.7023
2025-02-19 09:46:57:INFO:VAL-(cmcm) >>
2025-02-19 09:46:57:INFO:M: >>  acc: 0.7212  weight_F1: 0.7152 
2025-02-19 09:52:03:INFO:TRAIN-(cmcm) (3/6/1)>> loss: 0.6839
2025-02-19 09:52:44:INFO:VAL-(cmcm) >>
2025-02-19 09:52:44:INFO:M: >>  acc: 0.7134  weight_F1: 0.7109 
2025-02-19 09:57:48:INFO:TRAIN-(cmcm) (4/7/1)>> loss: 0.6738
2025-02-19 09:58:30:INFO:VAL-(cmcm) >>
2025-02-19 09:58:30:INFO:M: >>  acc: 0.7186  weight_F1: 0.7180 
2025-02-19 10:03:18:INFO:TRAIN-(cmcm) (5/8/1)>> loss: 0.6532
2025-02-19 10:03:58:INFO:VAL-(cmcm) >>
2025-02-19 10:03:58:INFO:M: >>  acc: 0.7219  weight_F1: 0.7228 
2025-02-19 10:04:00:INFO:Saving checkpoint at epoch 8 to results/models/cmcm-cherma-classification.pth.
2025-02-19 10:08:58:INFO:TRAIN-(cmcm) (1/9/1)>> loss: 0.6344
2025-02-19 10:09:41:INFO:VAL-(cmcm) >>
2025-02-19 10:09:41:INFO:M: >>  acc: 0.7237  weight_F1: 0.7272 
2025-02-19 10:09:42:INFO:Saving checkpoint at epoch 9 to results/models/cmcm-cherma-classification.pth.
2025-02-19 10:14:47:INFO:TRAIN-(cmcm) (1/10/1)>> loss: 0.6205
2025-02-19 10:15:29:INFO:VAL-(cmcm) >>
2025-02-19 10:15:29:INFO:M: >>  acc: 0.7261  weight_F1: 0.7235 
2025-02-19 10:20:29:INFO:TRAIN-(cmcm) (2/11/1)>> loss: 0.6022
2025-02-19 10:21:12:INFO:VAL-(cmcm) >>
2025-02-19 10:21:12:INFO:M: >>  acc: 0.7207  weight_F1: 0.7126 
2025-02-19 10:26:22:INFO:TRAIN-(cmcm) (3/12/1)>> loss: 0.5857
2025-02-19 10:27:03:INFO:VAL-(cmcm) >>
2025-02-19 10:27:03:INFO:M: >>  acc: 0.7284  weight_F1: 0.7275 
2025-02-19 10:27:04:INFO:Saving checkpoint at epoch 12 to results/models/cmcm-cherma-classification.pth.
2025-02-19 10:32:02:INFO:TRAIN-(cmcm) (1/13/1)>> loss: 0.5705
2025-02-19 10:32:44:INFO:VAL-(cmcm) >>
2025-02-19 10:32:44:INFO:M: >>  acc: 0.7289  weight_F1: 0.7260 
2025-02-19 10:37:41:INFO:TRAIN-(cmcm) (2/14/1)>> loss: 0.5477
2025-02-19 10:38:22:INFO:VAL-(cmcm) >>
2025-02-19 10:38:22:INFO:M: >>  acc: 0.7151  weight_F1: 0.7154 
2025-02-19 10:43:13:INFO:TRAIN-(cmcm) (3/15/1)>> loss: 0.5329
2025-02-19 10:43:55:INFO:VAL-(cmcm) >>
2025-02-19 10:43:55:INFO:M: >>  acc: 0.7235  weight_F1: 0.7202 
2025-02-19 10:48:46:INFO:TRAIN-(cmcm) (4/16/1)>> loss: 0.5165
2025-02-19 10:49:27:INFO:VAL-(cmcm) >>
2025-02-19 10:49:27:INFO:M: >>  acc: 0.7303  weight_F1: 0.7286 
2025-02-19 10:49:28:INFO:Saving checkpoint at epoch 16 to results/models/cmcm-cherma-classification.pth.
2025-02-19 10:54:36:INFO:TRAIN-(cmcm) (1/17/1)>> loss: 0.4899
2025-02-19 10:55:16:INFO:VAL-(cmcm) >>
2025-02-19 10:55:16:INFO:M: >>  acc: 0.7252  weight_F1: 0.7217 
2025-02-19 11:00:22:INFO:TRAIN-(cmcm) (2/18/1)>> loss: 0.4675
2025-02-19 11:01:07:INFO:VAL-(cmcm) >>
2025-02-19 11:01:07:INFO:M: >>  acc: 0.7221  weight_F1: 0.7209 
2025-02-19 11:06:08:INFO:TRAIN-(cmcm) (3/19/1)>> loss: 0.4469
2025-02-19 11:06:49:INFO:VAL-(cmcm) >>
2025-02-19 11:06:49:INFO:M: >>  acc: 0.7235  weight_F1: 0.7247 
2025-02-19 11:11:48:INFO:TRAIN-(cmcm) (4/20/1)>> loss: 0.4203
2025-02-19 11:12:29:INFO:VAL-(cmcm) >>
2025-02-19 11:12:29:INFO:M: >>  acc: 0.7146  weight_F1: 0.7101 
2025-02-19 11:17:35:INFO:TRAIN-(cmcm) (5/21/1)>> loss: 0.3957
2025-02-19 11:18:16:INFO:VAL-(cmcm) >>
2025-02-19 11:18:16:INFO:M: >>  acc: 0.7270  weight_F1: 0.7262 
2025-02-19 11:23:17:INFO:TRAIN-(cmcm) (6/22/1)>> loss: 0.3684
2025-02-19 11:23:58:INFO:VAL-(cmcm) >>
2025-02-19 11:23:58:INFO:M: >>  acc: 0.7212  weight_F1: 0.7202 
2025-02-19 11:29:07:INFO:TRAIN-(cmcm) (7/23/1)>> loss: 0.3421
2025-02-19 11:29:55:INFO:VAL-(cmcm) >>
2025-02-19 11:29:55:INFO:M: >>  acc: 0.7144  weight_F1: 0.7173 
2025-02-19 11:34:52:INFO:TRAIN-(cmcm) (8/24/1)>> loss: 0.3145
2025-02-19 11:35:34:INFO:VAL-(cmcm) >>
2025-02-19 11:35:34:INFO:M: >>  acc: 0.7118  weight_F1: 0.7134 
2025-02-19 11:36:20:INFO:TEST-(cmcm) >>
2025-02-19 11:36:20:INFO:M: >>  acc: 0.7237  weight_F1: 0.7222 
2025-02-19 11:36:22:INFO:Results are added to results/results/cherma-classification-30.csv...
2025-02-19 11:36:22:INFO:Start running cmcm...
2025-02-19 11:36:22:INFO:<Storage{'is_tune': False, 'train_mode': 'classification', 'modelName': 'cmcm', 'datasetName': 'cherma', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'pretrain_LM': '/data/huggingface_model/Qwen/Qwen-1_8B/', 'gpu_ids': [2], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/CHERMA0723', 'seq_lens': (78, 543, 16), 'feature_dims': (2048, 1024, 2048), 'train_samples': 16326, 'num_classes': 3, 'language': 'cn', 'KeyEval': 'weight_F1', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'task_specific_prompt': '<:0, :1, :2, :3, :4, :5, :6>: ', 'max_new_tokens': 1, 'pseudo_tokens': 4, 'label_index_mapping': {'': 0, '': 1, '': 2, '': 3, '': 4, '': 5, '': 6}, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 16, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'update_epochs': 1, 'early_stop': 8, 'gamma': 0, 'H': 1.0, 'seed': 2222}>
2025-02-19 11:36:22:INFO:Let's use the GPU 2 !
2025-02-19 11:51:11:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2025-02-19 11:51:11:WARNING:Try importing flash-attention for faster inference...
2025-02-19 11:51:11:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2025-02-19 11:51:11:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2025-02-19 11:51:11:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2025-02-19 11:51:13:INFO:trainable params: 1561932 || all params: 1838390604 || trainable%: 0.08496192248815475
2025-02-19 11:51:13:INFO:Init labels...
2025-02-19 11:51:13:INFO:Start training...
2025-02-19 11:56:09:INFO:TRAIN-(cmcm) (1/1/2)>> loss: 1.5347
2025-02-19 11:56:54:INFO:VAL-(cmcm) >>
2025-02-19 11:56:54:INFO:M: >>  acc: 0.6714  weight_F1: 0.6715 
2025-02-19 11:56:54:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-cherma-classification.pth.
2025-02-19 12:01:52:INFO:TRAIN-(cmcm) (1/2/2)>> loss: 0.8405
2025-02-19 12:02:33:INFO:VAL-(cmcm) >>
2025-02-19 12:02:33:INFO:M: >>  acc: 0.6918  weight_F1: 0.6953 
2025-02-19 12:02:34:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-cherma-classification.pth.
2025-02-19 12:07:25:INFO:TRAIN-(cmcm) (1/3/2)>> loss: 0.8045
2025-02-19 12:08:07:INFO:VAL-(cmcm) >>
2025-02-19 12:08:07:INFO:M: >>  acc: 0.6909  weight_F1: 0.6905 
2025-02-19 12:13:01:INFO:TRAIN-(cmcm) (2/4/2)>> loss: 0.7591
2025-02-19 12:13:45:INFO:VAL-(cmcm) >>
2025-02-19 12:13:45:INFO:M: >>  acc: 0.7183  weight_F1: 0.7178 
2025-02-19 12:13:47:INFO:Saving checkpoint at epoch 4 to results/models/cmcm-cherma-classification.pth.
2025-02-19 12:18:47:INFO:TRAIN-(cmcm) (1/5/2)>> loss: 0.7117
2025-02-19 12:19:29:INFO:VAL-(cmcm) >>
2025-02-19 12:19:29:INFO:M: >>  acc: 0.7190  weight_F1: 0.7179 
2025-02-19 12:19:30:INFO:Saving checkpoint at epoch 5 to results/models/cmcm-cherma-classification.pth.
2025-02-19 12:24:20:INFO:TRAIN-(cmcm) (1/6/2)>> loss: 0.6970
2025-02-19 12:25:03:INFO:VAL-(cmcm) >>
2025-02-19 12:25:03:INFO:M: >>  acc: 0.7151  weight_F1: 0.7139 
2025-02-19 12:30:02:INFO:TRAIN-(cmcm) (2/7/2)>> loss: 0.6759
2025-02-19 12:30:45:INFO:VAL-(cmcm) >>
2025-02-19 12:30:45:INFO:M: >>  acc: 0.7132  weight_F1: 0.7091 
2025-02-19 12:35:45:INFO:TRAIN-(cmcm) (3/8/2)>> loss: 0.6601
2025-02-19 12:36:26:INFO:VAL-(cmcm) >>
2025-02-19 12:36:26:INFO:M: >>  acc: 0.7217  weight_F1: 0.7136 
2025-02-19 12:41:22:INFO:TRAIN-(cmcm) (4/9/2)>> loss: 0.6424
2025-02-19 12:42:03:INFO:VAL-(cmcm) >>
2025-02-19 12:42:03:INFO:M: >>  acc: 0.7261  weight_F1: 0.7260 
2025-02-19 12:42:04:INFO:Saving checkpoint at epoch 9 to results/models/cmcm-cherma-classification.pth.
2025-02-19 12:46:59:INFO:TRAIN-(cmcm) (1/10/2)>> loss: 0.6257
2025-02-19 12:47:41:INFO:VAL-(cmcm) >>
2025-02-19 12:47:41:INFO:M: >>  acc: 0.7299  weight_F1: 0.7251 
2025-02-19 12:52:32:INFO:TRAIN-(cmcm) (2/11/2)>> loss: 0.6074
2025-02-19 12:53:13:INFO:VAL-(cmcm) >>
2025-02-19 12:53:13:INFO:M: >>  acc: 0.7181  weight_F1: 0.7184 
2025-02-19 12:58:09:INFO:TRAIN-(cmcm) (3/12/2)>> loss: 0.5954
2025-02-19 12:58:51:INFO:VAL-(cmcm) >>
2025-02-19 12:58:51:INFO:M: >>  acc: 0.7256  weight_F1: 0.7153 
2025-02-19 13:03:48:INFO:TRAIN-(cmcm) (4/13/2)>> loss: 0.5744
2025-02-19 13:04:31:INFO:VAL-(cmcm) >>
2025-02-19 13:04:31:INFO:M: >>  acc: 0.7183  weight_F1: 0.7194 
2025-02-19 13:09:29:INFO:TRAIN-(cmcm) (5/14/2)>> loss: 0.5623
2025-02-19 13:10:10:INFO:VAL-(cmcm) >>
2025-02-19 13:10:10:INFO:M: >>  acc: 0.7223  weight_F1: 0.7164 
2025-02-19 13:15:04:INFO:TRAIN-(cmcm) (6/15/2)>> loss: 0.5429
2025-02-19 13:15:46:INFO:VAL-(cmcm) >>
2025-02-19 13:15:46:INFO:M: >>  acc: 0.7231  weight_F1: 0.7200 
2025-02-19 13:20:42:INFO:TRAIN-(cmcm) (7/16/2)>> loss: 0.5284
2025-02-19 13:21:24:INFO:VAL-(cmcm) >>
2025-02-19 13:21:24:INFO:M: >>  acc: 0.7284  weight_F1: 0.7236 
2025-02-19 13:26:21:INFO:TRAIN-(cmcm) (8/17/2)>> loss: 0.5087
2025-02-19 13:27:04:INFO:VAL-(cmcm) >>
2025-02-19 13:27:04:INFO:M: >>  acc: 0.7270  weight_F1: 0.7216 
2025-02-19 13:27:46:INFO:TEST-(cmcm) >>
2025-02-19 13:27:46:INFO:M: >>  acc: 0.7282  weight_F1: 0.7280 
2025-02-19 13:27:47:INFO:Results are added to results/results/cherma-classification-30.csv...
2025-02-19 13:27:47:INFO:Start running cmcm...
2025-02-19 13:27:47:INFO:<Storage{'is_tune': False, 'train_mode': 'classification', 'modelName': 'cmcm', 'datasetName': 'cherma', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'pretrain_LM': '/data/huggingface_model/Qwen/Qwen-1_8B/', 'gpu_ids': [2], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/CHERMA0723', 'seq_lens': (78, 543, 16), 'feature_dims': (2048, 1024, 2048), 'train_samples': 16326, 'num_classes': 3, 'language': 'cn', 'KeyEval': 'weight_F1', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'task_specific_prompt': '<:0, :1, :2, :3, :4, :5, :6>: ', 'max_new_tokens': 1, 'pseudo_tokens': 4, 'label_index_mapping': {'': 0, '': 1, '': 2, '': 3, '': 4, '': 5, '': 6}, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 16, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'update_epochs': 1, 'early_stop': 8, 'gamma': 0, 'H': 1.0, 'seed': 3333}>
2025-02-19 13:27:47:INFO:Let's use the GPU 2 !
2025-02-19 13:29:35:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2025-02-19 13:29:35:WARNING:Try importing flash-attention for faster inference...
2025-02-19 13:29:35:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2025-02-19 13:29:35:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2025-02-19 13:29:35:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2025-02-19 13:29:36:INFO:trainable params: 1561932 || all params: 1838390604 || trainable%: 0.08496192248815475
2025-02-19 13:29:36:INFO:Init labels...
2025-02-19 13:29:36:INFO:Start training...
2025-02-19 13:34:33:INFO:TRAIN-(cmcm) (1/1/3)>> loss: 1.4990
2025-02-19 13:35:14:INFO:VAL-(cmcm) >>
2025-02-19 13:35:14:INFO:M: >>  acc: 0.6756  weight_F1: 0.6834 
2025-02-19 13:35:15:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-cherma-classification.pth.
2025-02-19 13:40:12:INFO:TRAIN-(cmcm) (1/2/3)>> loss: 0.8358
2025-02-19 13:40:54:INFO:VAL-(cmcm) >>
2025-02-19 13:40:54:INFO:M: >>  acc: 0.6711  weight_F1: 0.6732 
2025-02-19 13:45:42:INFO:TRAIN-(cmcm) (2/3/3)>> loss: 0.8147
2025-02-19 13:46:24:INFO:VAL-(cmcm) >>
2025-02-19 13:46:24:INFO:M: >>  acc: 0.6688  weight_F1: 0.6574 
2025-02-19 13:51:21:INFO:TRAIN-(cmcm) (3/4/3)>> loss: 0.7986
2025-02-19 13:52:02:INFO:VAL-(cmcm) >>
2025-02-19 13:52:02:INFO:M: >>  acc: 0.6996  weight_F1: 0.7008 
2025-02-19 13:52:03:INFO:Saving checkpoint at epoch 4 to results/models/cmcm-cherma-classification.pth.
2025-02-19 13:56:59:INFO:TRAIN-(cmcm) (1/5/3)>> loss: 0.7626
2025-02-19 13:57:40:INFO:VAL-(cmcm) >>
2025-02-19 13:57:40:INFO:M: >>  acc: 0.6948  weight_F1: 0.6933 
2025-02-19 14:02:36:INFO:TRAIN-(cmcm) (2/6/3)>> loss: 0.7420
2025-02-19 14:03:18:INFO:VAL-(cmcm) >>
2025-02-19 14:03:18:INFO:M: >>  acc: 0.7026  weight_F1: 0.6958 
2025-02-19 14:08:14:INFO:TRAIN-(cmcm) (3/7/3)>> loss: 0.7333
2025-02-19 14:08:56:INFO:VAL-(cmcm) >>
2025-02-19 14:08:56:INFO:M: >>  acc: 0.6958  weight_F1: 0.6958 
2025-02-19 14:13:52:INFO:TRAIN-(cmcm) (4/8/3)>> loss: 0.7170
2025-02-19 14:14:34:INFO:VAL-(cmcm) >>
2025-02-19 14:14:34:INFO:M: >>  acc: 0.6951  weight_F1: 0.6826 
2025-02-19 14:19:30:INFO:TRAIN-(cmcm) (5/9/3)>> loss: 0.7114
2025-02-19 14:20:13:INFO:VAL-(cmcm) >>
2025-02-19 14:20:13:INFO:M: >>  acc: 0.7096  weight_F1: 0.7050 
2025-02-19 14:20:14:INFO:Saving checkpoint at epoch 9 to results/models/cmcm-cherma-classification.pth.
2025-02-19 14:25:11:INFO:TRAIN-(cmcm) (1/10/3)>> loss: 0.6831
2025-02-19 14:25:53:INFO:VAL-(cmcm) >>
2025-02-19 14:25:53:INFO:M: >>  acc: 0.7082  weight_F1: 0.7040 
2025-02-19 14:30:52:INFO:TRAIN-(cmcm) (2/11/3)>> loss: 0.6606
2025-02-19 14:31:34:INFO:VAL-(cmcm) >>
2025-02-19 14:31:34:INFO:M: >>  acc: 0.7137  weight_F1: 0.7140 
2025-02-19 14:31:34:INFO:Saving checkpoint at epoch 11 to results/models/cmcm-cherma-classification.pth.
2025-02-19 14:36:29:INFO:TRAIN-(cmcm) (1/12/3)>> loss: 0.6364
2025-02-19 14:37:12:INFO:VAL-(cmcm) >>
2025-02-19 14:37:12:INFO:M: >>  acc: 0.7169  weight_F1: 0.7146 
2025-02-19 14:37:12:INFO:Saving checkpoint at epoch 12 to results/models/cmcm-cherma-classification.pth.
2025-02-19 14:42:14:INFO:TRAIN-(cmcm) (1/13/3)>> loss: 0.6199
2025-02-19 14:42:56:INFO:VAL-(cmcm) >>
2025-02-19 14:42:56:INFO:M: >>  acc: 0.7118  weight_F1: 0.7126 
2025-02-19 14:47:54:INFO:TRAIN-(cmcm) (2/14/3)>> loss: 0.6017
2025-02-19 14:48:35:INFO:VAL-(cmcm) >>
2025-02-19 14:48:35:INFO:M: >>  acc: 0.7144  weight_F1: 0.7157 
2025-02-19 14:48:35:INFO:Saving checkpoint at epoch 14 to results/models/cmcm-cherma-classification.pth.
2025-02-19 14:53:30:INFO:TRAIN-(cmcm) (1/15/3)>> loss: 0.5789
2025-02-19 14:54:13:INFO:VAL-(cmcm) >>
2025-02-19 14:54:13:INFO:M: >>  acc: 0.7202  weight_F1: 0.7159 
2025-02-19 14:54:13:INFO:Saving checkpoint at epoch 15 to results/models/cmcm-cherma-classification.pth.
2025-02-19 14:59:09:INFO:TRAIN-(cmcm) (1/16/3)>> loss: 0.5591
2025-02-19 14:59:52:INFO:VAL-(cmcm) >>
2025-02-19 14:59:52:INFO:M: >>  acc: 0.7184  weight_F1: 0.7174 
2025-02-19 14:59:52:INFO:Saving checkpoint at epoch 16 to results/models/cmcm-cherma-classification.pth.
2025-02-19 15:04:49:INFO:TRAIN-(cmcm) (1/17/3)>> loss: 0.5348
2025-02-19 15:05:30:INFO:VAL-(cmcm) >>
2025-02-19 15:05:30:INFO:M: >>  acc: 0.7200  weight_F1: 0.7150 
2025-02-19 15:10:26:INFO:TRAIN-(cmcm) (2/18/3)>> loss: 0.5122
2025-02-19 15:11:09:INFO:VAL-(cmcm) >>
2025-02-19 15:11:09:INFO:M: >>  acc: 0.7181  weight_F1: 0.7143 
2025-02-19 15:16:07:INFO:TRAIN-(cmcm) (3/19/3)>> loss: 0.4939
2025-02-19 15:16:49:INFO:VAL-(cmcm) >>
2025-02-19 15:16:49:INFO:M: >>  acc: 0.7181  weight_F1: 0.7186 
2025-02-19 15:16:50:INFO:Saving checkpoint at epoch 19 to results/models/cmcm-cherma-classification.pth.
2025-02-19 15:21:48:INFO:TRAIN-(cmcm) (1/20/3)>> loss: 0.4717
2025-02-19 15:22:30:INFO:VAL-(cmcm) >>
2025-02-19 15:22:30:INFO:M: >>  acc: 0.7134  weight_F1: 0.7078 
2025-02-19 15:27:31:INFO:TRAIN-(cmcm) (2/21/3)>> loss: 0.4481
2025-02-19 15:28:15:INFO:VAL-(cmcm) >>
2025-02-19 15:28:15:INFO:M: >>  acc: 0.7165  weight_F1: 0.7160 
2025-02-19 15:33:14:INFO:TRAIN-(cmcm) (3/22/3)>> loss: 0.4261
2025-02-19 15:33:58:INFO:VAL-(cmcm) >>
2025-02-19 15:33:58:INFO:M: >>  acc: 0.7207  weight_F1: 0.7187 
2025-02-19 15:33:59:INFO:Saving checkpoint at epoch 22 to results/models/cmcm-cherma-classification.pth.
2025-02-19 15:38:59:INFO:TRAIN-(cmcm) (1/23/3)>> loss: 0.4027
2025-02-19 15:39:42:INFO:VAL-(cmcm) >>
2025-02-19 15:39:42:INFO:M: >>  acc: 0.7113  weight_F1: 0.7077 
2025-02-19 15:44:42:INFO:TRAIN-(cmcm) (2/24/3)>> loss: 0.3802
2025-02-19 15:45:24:INFO:VAL-(cmcm) >>
2025-02-19 15:45:24:INFO:M: >>  acc: 0.7153  weight_F1: 0.7148 
2025-02-19 15:50:29:INFO:TRAIN-(cmcm) (3/25/3)>> loss: 0.3559
2025-02-19 15:51:11:INFO:VAL-(cmcm) >>
2025-02-19 15:51:11:INFO:M: >>  acc: 0.7130  weight_F1: 0.7111 
2025-02-19 15:56:08:INFO:TRAIN-(cmcm) (4/26/3)>> loss: 0.3355
2025-02-19 15:56:50:INFO:VAL-(cmcm) >>
2025-02-19 15:56:50:INFO:M: >>  acc: 0.7096  weight_F1: 0.7079 
2025-02-19 16:01:50:INFO:TRAIN-(cmcm) (5/27/3)>> loss: 0.3177
2025-02-19 16:02:33:INFO:VAL-(cmcm) >>
2025-02-19 16:02:33:INFO:M: >>  acc: 0.7130  weight_F1: 0.7109 
2025-02-19 16:07:28:INFO:TRAIN-(cmcm) (6/28/3)>> loss: 0.3041
2025-02-19 16:08:11:INFO:VAL-(cmcm) >>
2025-02-19 16:08:11:INFO:M: >>  acc: 0.7101  weight_F1: 0.7089 
2025-02-19 16:13:08:INFO:TRAIN-(cmcm) (7/29/3)>> loss: 0.2947
2025-02-19 16:13:49:INFO:VAL-(cmcm) >>
2025-02-19 16:13:49:INFO:M: >>  acc: 0.7108  weight_F1: 0.7102 
2025-02-19 16:18:51:INFO:TRAIN-(cmcm) (8/30/3)>> loss: 0.2901
2025-02-19 16:20:08:INFO:VAL-(cmcm) >>
2025-02-19 16:20:08:INFO:M: >>  acc: 0.7115  weight_F1: 0.7103 
2025-02-19 16:21:36:INFO:TEST-(cmcm) >>
2025-02-19 16:21:36:INFO:M: >>  acc: 0.7023  weight_F1: 0.7002 
2025-02-19 16:21:36:INFO:Results are added to results/results/cherma-classification-30.csv...
2025-02-19 16:21:36:INFO:Start running cmcm...
2025-02-19 16:21:36:INFO:<Storage{'is_tune': False, 'train_mode': 'classification', 'modelName': 'cmcm', 'datasetName': 'cherma', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'pretrain_LM': '/data/huggingface_model/Qwen/Qwen-1_8B/', 'gpu_ids': [2], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/CHERMA0723', 'seq_lens': (78, 543, 16), 'feature_dims': (2048, 1024, 2048), 'train_samples': 16326, 'num_classes': 3, 'language': 'cn', 'KeyEval': 'weight_F1', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'task_specific_prompt': '<:0, :1, :2, :3, :4, :5, :6>: ', 'max_new_tokens': 1, 'pseudo_tokens': 4, 'label_index_mapping': {'': 0, '': 1, '': 2, '': 3, '': 4, '': 5, '': 6}, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 16, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'update_epochs': 1, 'early_stop': 8, 'gamma': 0, 'H': 1.0, 'seed': 4444}>
2025-02-19 16:21:36:INFO:Let's use the GPU 2 !
2025-02-19 16:25:56:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2025-02-19 16:25:56:WARNING:Try importing flash-attention for faster inference...
2025-02-19 16:25:56:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2025-02-19 16:25:56:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2025-02-19 16:25:56:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2025-02-19 16:25:58:INFO:trainable params: 1561932 || all params: 1838390604 || trainable%: 0.08496192248815475
2025-02-19 16:25:58:INFO:Init labels...
2025-02-19 16:25:58:INFO:Start training...
2025-02-19 16:33:45:INFO:TRAIN-(cmcm) (1/1/4)>> loss: 1.5430
2025-02-19 16:35:13:INFO:VAL-(cmcm) >>
2025-02-19 16:35:13:INFO:M: >>  acc: 0.6758  weight_F1: 0.6659 
2025-02-19 16:35:14:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-cherma-classification.pth.
2025-02-19 16:40:41:INFO:TRAIN-(cmcm) (1/2/4)>> loss: 0.8549
2025-02-19 16:41:24:INFO:VAL-(cmcm) >>
2025-02-19 16:41:24:INFO:M: >>  acc: 0.6935  weight_F1: 0.6947 
2025-02-19 16:41:25:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-cherma-classification.pth.
2025-02-19 16:46:28:INFO:TRAIN-(cmcm) (1/3/4)>> loss: 0.7849
2025-02-19 16:47:12:INFO:VAL-(cmcm) >>
2025-02-19 16:47:12:INFO:M: >>  acc: 0.7254  weight_F1: 0.7228 
2025-02-19 16:47:12:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-cherma-classification.pth.
2025-02-19 16:52:09:INFO:TRAIN-(cmcm) (1/4/4)>> loss: 0.7525
2025-02-19 16:52:51:INFO:VAL-(cmcm) >>
2025-02-19 16:52:51:INFO:M: >>  acc: 0.7141  weight_F1: 0.7114 
2025-02-19 16:57:52:INFO:TRAIN-(cmcm) (2/5/4)>> loss: 0.7229
2025-02-19 16:58:35:INFO:VAL-(cmcm) >>
2025-02-19 16:58:35:INFO:M: >>  acc: 0.7127  weight_F1: 0.7122 
2025-02-19 17:03:35:INFO:TRAIN-(cmcm) (3/6/4)>> loss: 0.7035
2025-02-19 17:04:18:INFO:VAL-(cmcm) >>
2025-02-19 17:04:18:INFO:M: >>  acc: 0.7174  weight_F1: 0.7201 
2025-02-19 17:09:17:INFO:TRAIN-(cmcm) (4/7/4)>> loss: 0.6809
2025-02-19 17:10:01:INFO:VAL-(cmcm) >>
2025-02-19 17:10:01:INFO:M: >>  acc: 0.7214  weight_F1: 0.7172 
2025-02-19 17:15:01:INFO:TRAIN-(cmcm) (5/8/4)>> loss: 0.6653
2025-02-19 17:15:42:INFO:VAL-(cmcm) >>
2025-02-19 17:15:42:INFO:M: >>  acc: 0.7228  weight_F1: 0.7250 
2025-02-19 17:15:43:INFO:Saving checkpoint at epoch 8 to results/models/cmcm-cherma-classification.pth.
2025-02-19 17:20:48:INFO:TRAIN-(cmcm) (1/9/4)>> loss: 0.6506
2025-02-19 17:21:32:INFO:VAL-(cmcm) >>
2025-02-19 17:21:32:INFO:M: >>  acc: 0.7242  weight_F1: 0.7262 
2025-02-19 17:21:32:INFO:Saving checkpoint at epoch 9 to results/models/cmcm-cherma-classification.pth.
2025-02-19 17:26:34:INFO:TRAIN-(cmcm) (1/10/4)>> loss: 0.6325
2025-02-19 17:27:16:INFO:VAL-(cmcm) >>
2025-02-19 17:27:16:INFO:M: >>  acc: 0.7212  weight_F1: 0.7183 
2025-02-19 17:32:15:INFO:TRAIN-(cmcm) (2/11/4)>> loss: 0.6159
2025-02-19 17:32:58:INFO:VAL-(cmcm) >>
2025-02-19 17:32:58:INFO:M: >>  acc: 0.7244  weight_F1: 0.7168 
2025-02-19 17:38:02:INFO:TRAIN-(cmcm) (3/12/4)>> loss: 0.6028
2025-02-19 17:38:45:INFO:VAL-(cmcm) >>
2025-02-19 17:38:45:INFO:M: >>  acc: 0.7299  weight_F1: 0.7293 
2025-02-19 17:38:45:INFO:Saving checkpoint at epoch 12 to results/models/cmcm-cherma-classification.pth.
2025-02-19 17:43:46:INFO:TRAIN-(cmcm) (1/13/4)>> loss: 0.5773
2025-02-19 17:44:28:INFO:VAL-(cmcm) >>
2025-02-19 17:44:28:INFO:M: >>  acc: 0.7313  weight_F1: 0.7270 
2025-02-19 17:49:28:INFO:TRAIN-(cmcm) (2/14/4)>> loss: 0.5609
2025-02-19 17:50:10:INFO:VAL-(cmcm) >>
2025-02-19 17:50:10:INFO:M: >>  acc: 0.7181  weight_F1: 0.7179 
2025-02-19 17:55:05:INFO:TRAIN-(cmcm) (3/15/4)>> loss: 0.5373
2025-02-19 17:55:46:INFO:VAL-(cmcm) >>
2025-02-19 17:55:46:INFO:M: >>  acc: 0.7249  weight_F1: 0.7247 
2025-02-19 18:00:43:INFO:TRAIN-(cmcm) (4/16/4)>> loss: 0.5213
2025-02-19 18:01:24:INFO:VAL-(cmcm) >>
2025-02-19 18:01:24:INFO:M: >>  acc: 0.7252  weight_F1: 0.7246 
2025-02-19 18:06:22:INFO:TRAIN-(cmcm) (5/17/4)>> loss: 0.4974
2025-02-19 18:07:03:INFO:VAL-(cmcm) >>
2025-02-19 18:07:03:INFO:M: >>  acc: 0.7258  weight_F1: 0.7246 
2025-02-19 18:11:56:INFO:TRAIN-(cmcm) (6/18/4)>> loss: 0.4706
2025-02-19 18:12:39:INFO:VAL-(cmcm) >>
2025-02-19 18:12:39:INFO:M: >>  acc: 0.7204  weight_F1: 0.7222 
2025-02-19 18:17:37:INFO:TRAIN-(cmcm) (7/19/4)>> loss: 0.4484
2025-02-19 18:18:19:INFO:VAL-(cmcm) >>
2025-02-19 18:18:19:INFO:M: >>  acc: 0.7271  weight_F1: 0.7246 
2025-02-19 18:23:15:INFO:TRAIN-(cmcm) (8/20/4)>> loss: 0.4228
2025-02-19 18:23:59:INFO:VAL-(cmcm) >>
2025-02-19 18:23:59:INFO:M: >>  acc: 0.7249  weight_F1: 0.7265 
2025-02-19 18:24:41:INFO:TEST-(cmcm) >>
2025-02-19 18:24:41:INFO:M: >>  acc: 0.7225  weight_F1: 0.7218 
2025-02-19 18:24:42:INFO:Results are added to results/results/cherma-classification-30.csv...
2025-02-19 18:24:42:INFO:Start running cmcm...
2025-02-19 18:24:42:INFO:<Storage{'is_tune': False, 'train_mode': 'classification', 'modelName': 'cmcm', 'datasetName': 'cherma', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'pretrain_LM': '/data/huggingface_model/Qwen/Qwen-1_8B/', 'gpu_ids': [2], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/CHERMA0723', 'seq_lens': (78, 543, 16), 'feature_dims': (2048, 1024, 2048), 'train_samples': 16326, 'num_classes': 3, 'language': 'cn', 'KeyEval': 'weight_F1', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'task_specific_prompt': '<:0, :1, :2, :3, :4, :5, :6>: ', 'max_new_tokens': 1, 'pseudo_tokens': 4, 'label_index_mapping': {'': 0, '': 1, '': 2, '': 3, '': 4, '': 5, '': 6}, 'batch_size': 16, 'learning_rate': 0.005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 16, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 30, 'update_epochs': 1, 'early_stop': 8, 'gamma': 0, 'H': 1.0, 'seed': 5555}>
2025-02-19 18:24:42:INFO:Let's use the GPU 2 !
2025-02-19 18:26:40:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2025-02-19 18:26:40:WARNING:Try importing flash-attention for faster inference...
2025-02-19 18:26:40:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2025-02-19 18:26:40:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2025-02-19 18:26:40:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2025-02-19 18:26:42:INFO:trainable params: 1561932 || all params: 1838390604 || trainable%: 0.08496192248815475
2025-02-19 18:26:42:INFO:Init labels...
2025-02-19 18:26:42:INFO:Start training...
2025-02-19 18:31:38:INFO:TRAIN-(cmcm) (1/1/5)>> loss: 1.4653
2025-02-19 18:32:20:INFO:VAL-(cmcm) >>
2025-02-19 18:32:20:INFO:M: >>  acc: 0.6826  weight_F1: 0.6867 
2025-02-19 18:32:21:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-cherma-classification.pth.
2025-02-19 18:37:22:INFO:TRAIN-(cmcm) (1/2/5)>> loss: 0.7877
2025-02-19 18:38:04:INFO:VAL-(cmcm) >>
2025-02-19 18:38:04:INFO:M: >>  acc: 0.7148  weight_F1: 0.7162 
2025-02-19 18:38:05:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-cherma-classification.pth.
2025-02-19 18:43:06:INFO:TRAIN-(cmcm) (1/3/5)>> loss: 0.7520
2025-02-19 18:43:49:INFO:VAL-(cmcm) >>
2025-02-19 18:43:49:INFO:M: >>  acc: 0.7111  weight_F1: 0.7030 
2025-02-19 18:48:51:INFO:TRAIN-(cmcm) (2/4/5)>> loss: 0.7291
2025-02-19 18:49:35:INFO:VAL-(cmcm) >>
2025-02-19 18:49:35:INFO:M: >>  acc: 0.7076  weight_F1: 0.7063 
2025-02-19 18:54:36:INFO:TRAIN-(cmcm) (3/5/5)>> loss: 0.7093
2025-02-19 18:55:18:INFO:VAL-(cmcm) >>
2025-02-19 18:55:18:INFO:M: >>  acc: 0.7195  weight_F1: 0.7188 
2025-02-19 18:55:19:INFO:Saving checkpoint at epoch 5 to results/models/cmcm-cherma-classification.pth.
2025-02-19 19:00:17:INFO:TRAIN-(cmcm) (1/6/5)>> loss: 0.6962
2025-02-19 19:00:59:INFO:VAL-(cmcm) >>
2025-02-19 19:00:59:INFO:M: >>  acc: 0.7230  weight_F1: 0.7213 
2025-02-19 19:01:00:INFO:Saving checkpoint at epoch 6 to results/models/cmcm-cherma-classification.pth.
2025-02-19 19:06:01:INFO:TRAIN-(cmcm) (1/7/5)>> loss: 0.6831
2025-02-19 19:06:42:INFO:VAL-(cmcm) >>
2025-02-19 19:06:42:INFO:M: >>  acc: 0.7087  weight_F1: 0.7104 
2025-02-19 19:11:37:INFO:TRAIN-(cmcm) (2/8/5)>> loss: 0.6681
2025-02-19 19:12:19:INFO:VAL-(cmcm) >>
2025-02-19 19:12:19:INFO:M: >>  acc: 0.7256  weight_F1: 0.7154 
2025-02-19 19:17:22:INFO:TRAIN-(cmcm) (3/9/5)>> loss: 0.6471
2025-02-19 19:18:04:INFO:VAL-(cmcm) >>
2025-02-19 19:18:04:INFO:M: >>  acc: 0.7271  weight_F1: 0.7243 
2025-02-19 19:18:05:INFO:Saving checkpoint at epoch 9 to results/models/cmcm-cherma-classification.pth.
2025-02-19 19:23:03:INFO:TRAIN-(cmcm) (1/10/5)>> loss: 0.6293
2025-02-19 19:23:46:INFO:VAL-(cmcm) >>
2025-02-19 19:23:46:INFO:M: >>  acc: 0.7231  weight_F1: 0.7238 
2025-02-19 19:28:45:INFO:TRAIN-(cmcm) (2/11/5)>> loss: 0.6137
2025-02-19 19:29:29:INFO:VAL-(cmcm) >>
2025-02-19 19:29:29:INFO:M: >>  acc: 0.7291  weight_F1: 0.7248 
2025-02-19 19:29:29:INFO:Saving checkpoint at epoch 11 to results/models/cmcm-cherma-classification.pth.
2025-02-19 19:34:25:INFO:TRAIN-(cmcm) (1/12/5)>> loss: 0.5920
2025-02-19 19:35:06:INFO:VAL-(cmcm) >>
2025-02-19 19:35:06:INFO:M: >>  acc: 0.7261  weight_F1: 0.7285 
2025-02-19 19:35:07:INFO:Saving checkpoint at epoch 12 to results/models/cmcm-cherma-classification.pth.
2025-02-19 19:40:02:INFO:TRAIN-(cmcm) (1/13/5)>> loss: 0.5766
2025-02-19 19:40:47:INFO:VAL-(cmcm) >>
2025-02-19 19:40:47:INFO:M: >>  acc: 0.7364  weight_F1: 0.7363 
2025-02-19 19:40:47:INFO:Saving checkpoint at epoch 13 to results/models/cmcm-cherma-classification.pth.
2025-02-19 19:45:44:INFO:TRAIN-(cmcm) (1/14/5)>> loss: 0.5525
2025-02-19 19:46:26:INFO:VAL-(cmcm) >>
2025-02-19 19:46:26:INFO:M: >>  acc: 0.7365  weight_F1: 0.7365 
2025-02-19 19:46:27:INFO:Saving checkpoint at epoch 14 to results/models/cmcm-cherma-classification.pth.
2025-02-19 19:51:25:INFO:TRAIN-(cmcm) (1/15/5)>> loss: 0.5335
2025-02-19 19:52:08:INFO:VAL-(cmcm) >>
2025-02-19 19:52:08:INFO:M: >>  acc: 0.7296  weight_F1: 0.7276 
2025-02-19 19:57:05:INFO:TRAIN-(cmcm) (2/16/5)>> loss: 0.5183
2025-02-19 19:57:49:INFO:VAL-(cmcm) >>
2025-02-19 19:57:49:INFO:M: >>  acc: 0.7247  weight_F1: 0.7286 
2025-02-19 20:02:48:INFO:TRAIN-(cmcm) (3/17/5)>> loss: 0.4905
2025-02-19 20:03:31:INFO:VAL-(cmcm) >>
2025-02-19 20:03:31:INFO:M: >>  acc: 0.7322  weight_F1: 0.7323 
2025-02-19 20:08:33:INFO:TRAIN-(cmcm) (4/18/5)>> loss: 0.4735
2025-02-19 20:09:15:INFO:VAL-(cmcm) >>
2025-02-19 20:09:15:INFO:M: >>  acc: 0.7334  weight_F1: 0.7305 
2025-02-19 20:14:13:INFO:TRAIN-(cmcm) (5/19/5)>> loss: 0.4472
2025-02-19 20:14:57:INFO:VAL-(cmcm) >>
2025-02-19 20:14:57:INFO:M: >>  acc: 0.7322  weight_F1: 0.7325 
2025-02-19 20:19:56:INFO:TRAIN-(cmcm) (6/20/5)>> loss: 0.4229
2025-02-19 20:20:37:INFO:VAL-(cmcm) >>
2025-02-19 20:20:37:INFO:M: >>  acc: 0.7364  weight_F1: 0.7365 
2025-02-19 20:25:37:INFO:TRAIN-(cmcm) (7/21/5)>> loss: 0.3940
2025-02-19 20:26:20:INFO:VAL-(cmcm) >>
2025-02-19 20:26:20:INFO:M: >>  acc: 0.7343  weight_F1: 0.7317 
2025-02-19 20:31:15:INFO:TRAIN-(cmcm) (8/22/5)>> loss: 0.3678
2025-02-19 20:31:57:INFO:VAL-(cmcm) >>
2025-02-19 20:31:57:INFO:M: >>  acc: 0.7317  weight_F1: 0.7305 
2025-02-19 20:32:43:INFO:TEST-(cmcm) >>
2025-02-19 20:32:43:INFO:M: >>  acc: 0.7293  weight_F1: 0.7285 
2025-02-19 20:32:44:INFO:Results are added to results/results/cherma-classification-30.csv...
2025-02-19 20:36:10:INFO:Start running cmcm...
2025-02-19 20:36:10:INFO:<Storage{'is_tune': False, 'train_mode': 'classification', 'modelName': 'cmcm', 'datasetName': 'meld', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'pretrain_LM': '/data/huggingface_model/Qwen/Qwen-1_8B/', 'gpu_ids': [], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MELD', 'seq_lens': (65, 157, 32), 'feature_dims': (2048, 64, 64), 'train_samples': 9992, 'num_classes': 3, 'language': 'en', 'KeyEval': 'weight_F1', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'task_specific_prompt': 'Please recognize the emotion of the above multimodal content from the                                             target set <neutral:0, surprise:1, fear:2, sadness:3, joy:4, disgust:5, anger:6>. Assistant: The emotion is', 'max_new_tokens': 1, 'pseudo_tokens': 2, 'label_index_mapping': {'neutral': 0, 'surprise': 1, 'fear': 2, 'sadness': 3, 'joy': 4, 'disgust': 5, 'anger': 6}, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 16, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 50, 'gamma': 1, 'update_epochs': 1, 'early_stop': 8, 'H': 3.0, 'seed': 1111}>
2025-02-19 20:36:10:INFO:Find gpu: 2, with memory: 385613824 left!
2025-02-19 20:36:10:INFO:Let's use the GPU 2 !
2025-02-19 20:36:21:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2025-02-19 20:36:21:WARNING:Try importing flash-attention for faster inference...
2025-02-19 20:36:21:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2025-02-19 20:36:21:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2025-02-19 20:36:21:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2025-02-19 20:36:24:INFO:trainable params: 1312072 || all params: 1838140744 || trainable%: 0.07138038826911504
2025-02-19 20:36:24:INFO:Init labels...
2025-02-19 20:36:24:INFO:Start training...
2025-02-19 20:38:31:INFO:TRAIN-(cmcm) (1/1/1)>> loss: 4.5658
2025-02-19 20:38:37:INFO:VAL-(cmcm) >>
2025-02-19 20:38:37:INFO:M: >>  acc: 0.4238  weight_F1: 0.2525 
2025-02-19 20:38:38:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-meld-classification.pth.
2025-02-19 20:40:43:INFO:TRAIN-(cmcm) (1/2/1)>> loss: 1.5618
2025-02-19 20:40:49:INFO:VAL-(cmcm) >>
2025-02-19 20:40:49:INFO:M: >>  acc: 0.4238  weight_F1: 0.2523 
2025-02-19 20:42:54:INFO:TRAIN-(cmcm) (2/3/1)>> loss: 1.5406
2025-02-19 20:43:00:INFO:VAL-(cmcm) >>
2025-02-19 20:43:00:INFO:M: >>  acc: 0.4220  weight_F1: 0.2823 
2025-02-19 20:43:01:INFO:Saving checkpoint at epoch 3 to results/models/cmcm-meld-classification.pth.
2025-02-19 20:45:07:INFO:TRAIN-(cmcm) (1/4/1)>> loss: 1.4919
2025-02-19 20:45:13:INFO:VAL-(cmcm) >>
2025-02-19 20:45:13:INFO:M: >>  acc: 0.4391  weight_F1: 0.2978 
2025-02-19 20:45:14:INFO:Saving checkpoint at epoch 4 to results/models/cmcm-meld-classification.pth.
2025-02-19 20:47:19:INFO:TRAIN-(cmcm) (1/5/1)>> loss: 1.3439
2025-02-19 20:47:25:INFO:VAL-(cmcm) >>
2025-02-19 20:47:25:INFO:M: >>  acc: 0.5555  weight_F1: 0.5106 
2025-02-19 20:47:26:INFO:Saving checkpoint at epoch 5 to results/models/cmcm-meld-classification.pth.
2025-02-19 20:49:31:INFO:TRAIN-(cmcm) (1/6/1)>> loss: 1.1947
2025-02-19 20:49:37:INFO:VAL-(cmcm) >>
2025-02-19 20:49:37:INFO:M: >>  acc: 0.5726  weight_F1: 0.5251 
2025-02-19 20:49:38:INFO:Saving checkpoint at epoch 6 to results/models/cmcm-meld-classification.pth.
2025-02-19 20:51:44:INFO:TRAIN-(cmcm) (1/7/1)>> loss: 1.1317
2025-02-19 20:51:50:INFO:VAL-(cmcm) >>
2025-02-19 20:51:50:INFO:M: >>  acc: 0.5726  weight_F1: 0.5072 
2025-02-19 20:53:54:INFO:TRAIN-(cmcm) (2/8/1)>> loss: 1.1020
2025-02-19 20:54:00:INFO:VAL-(cmcm) >>
2025-02-19 20:54:00:INFO:M: >>  acc: 0.5996  weight_F1: 0.5772 
2025-02-19 20:54:01:INFO:Saving checkpoint at epoch 8 to results/models/cmcm-meld-classification.pth.
2025-02-19 20:56:07:INFO:TRAIN-(cmcm) (1/9/1)>> loss: 1.0779
2025-02-19 20:56:13:INFO:VAL-(cmcm) >>
2025-02-19 20:56:13:INFO:M: >>  acc: 0.6168  weight_F1: 0.5814 
2025-02-19 20:56:14:INFO:Saving checkpoint at epoch 9 to results/models/cmcm-meld-classification.pth.
2025-02-19 20:58:19:INFO:TRAIN-(cmcm) (1/10/1)>> loss: 1.0562
2025-02-19 20:58:25:INFO:VAL-(cmcm) >>
2025-02-19 20:58:25:INFO:M: >>  acc: 0.6150  weight_F1: 0.5929 
2025-02-19 20:58:26:INFO:Saving checkpoint at epoch 10 to results/models/cmcm-meld-classification.pth.
2025-02-19 21:00:31:INFO:TRAIN-(cmcm) (1/11/1)>> loss: 1.0435
2025-02-19 21:00:37:INFO:VAL-(cmcm) >>
2025-02-19 21:00:37:INFO:M: >>  acc: 0.6069  weight_F1: 0.5667 
2025-02-19 21:02:42:INFO:TRAIN-(cmcm) (2/12/1)>> loss: 1.0310
2025-02-19 21:02:48:INFO:VAL-(cmcm) >>
2025-02-19 21:02:48:INFO:M: >>  acc: 0.6060  weight_F1: 0.5549 
2025-02-19 21:04:53:INFO:TRAIN-(cmcm) (3/13/1)>> loss: 1.0180
2025-02-19 21:04:59:INFO:VAL-(cmcm) >>
2025-02-19 21:04:59:INFO:M: >>  acc: 0.6231  weight_F1: 0.5881 
2025-02-19 21:07:03:INFO:TRAIN-(cmcm) (4/14/1)>> loss: 1.0043
2025-02-19 21:07:09:INFO:VAL-(cmcm) >>
2025-02-19 21:07:09:INFO:M: >>  acc: 0.6276  weight_F1: 0.6010 
2025-02-19 21:07:11:INFO:Saving checkpoint at epoch 14 to results/models/cmcm-meld-classification.pth.
2025-02-19 21:09:16:INFO:TRAIN-(cmcm) (1/15/1)>> loss: 0.9894
2025-02-19 21:09:22:INFO:VAL-(cmcm) >>
2025-02-19 21:09:22:INFO:M: >>  acc: 0.6213  weight_F1: 0.5892 
2025-02-19 21:11:27:INFO:TRAIN-(cmcm) (2/16/1)>> loss: 0.9749
2025-02-19 21:11:33:INFO:VAL-(cmcm) >>
2025-02-19 21:11:33:INFO:M: >>  acc: 0.6195  weight_F1: 0.5943 
2025-02-19 21:13:37:INFO:TRAIN-(cmcm) (3/17/1)>> loss: 0.9633
2025-02-19 21:13:43:INFO:VAL-(cmcm) >>
2025-02-19 21:13:43:INFO:M: >>  acc: 0.6258  weight_F1: 0.6088 
2025-02-19 21:13:45:INFO:Saving checkpoint at epoch 17 to results/models/cmcm-meld-classification.pth.
2025-02-19 21:15:50:INFO:TRAIN-(cmcm) (1/18/1)>> loss: 0.9481
2025-02-19 21:15:56:INFO:VAL-(cmcm) >>
2025-02-19 21:15:56:INFO:M: >>  acc: 0.6186  weight_F1: 0.5828 
2025-02-19 21:18:01:INFO:TRAIN-(cmcm) (2/19/1)>> loss: 0.9308
2025-02-19 21:18:07:INFO:VAL-(cmcm) >>
2025-02-19 21:18:07:INFO:M: >>  acc: 0.6195  weight_F1: 0.6019 
2025-02-19 21:20:11:INFO:TRAIN-(cmcm) (3/20/1)>> loss: 0.9080
2025-02-19 21:20:17:INFO:VAL-(cmcm) >>
2025-02-19 21:20:17:INFO:M: >>  acc: 0.6258  weight_F1: 0.5884 
2025-02-19 21:22:22:INFO:TRAIN-(cmcm) (4/21/1)>> loss: 0.8857
2025-02-19 21:22:29:INFO:VAL-(cmcm) >>
2025-02-19 21:22:29:INFO:M: >>  acc: 0.5996  weight_F1: 0.5635 
2025-02-19 21:24:34:INFO:TRAIN-(cmcm) (5/22/1)>> loss: 0.8615
2025-02-19 21:24:40:INFO:VAL-(cmcm) >>
2025-02-19 21:24:40:INFO:M: >>  acc: 0.6195  weight_F1: 0.5929 
2025-02-19 21:26:45:INFO:TRAIN-(cmcm) (6/23/1)>> loss: 0.8371
2025-02-19 21:26:51:INFO:VAL-(cmcm) >>
2025-02-19 21:26:51:INFO:M: >>  acc: 0.6186  weight_F1: 0.5932 
2025-02-19 21:28:56:INFO:TRAIN-(cmcm) (7/24/1)>> loss: 0.8084
2025-02-19 21:29:02:INFO:VAL-(cmcm) >>
2025-02-19 21:29:02:INFO:M: >>  acc: 0.6222  weight_F1: 0.6003 
2025-02-19 21:31:07:INFO:TRAIN-(cmcm) (8/25/1)>> loss: 0.7849
2025-02-19 21:31:13:INFO:VAL-(cmcm) >>
2025-02-19 21:31:13:INFO:M: >>  acc: 0.6177  weight_F1: 0.5863 
2025-02-19 21:31:27:INFO:TEST-(cmcm) >>
2025-02-19 21:31:27:INFO:M: >>  acc: 0.6414  weight_F1: 0.6255 
2025-02-19 21:31:28:INFO:Results are added to results/results/meld-classification-50.csv...
2025-02-19 21:31:28:INFO:Start running cmcm...
2025-02-19 21:31:28:INFO:<Storage{'is_tune': False, 'train_mode': 'classification', 'modelName': 'cmcm', 'datasetName': 'meld', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'pretrain_LM': '/data/huggingface_model/Qwen/Qwen-1_8B/', 'gpu_ids': [2], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MELD', 'seq_lens': (65, 157, 32), 'feature_dims': (2048, 64, 64), 'train_samples': 9992, 'num_classes': 3, 'language': 'en', 'KeyEval': 'weight_F1', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'task_specific_prompt': 'Please recognize the emotion of the above multimodal content from the                                             target set <neutral:0, surprise:1, fear:2, sadness:3, joy:4, disgust:5, anger:6>. Assistant: The emotion is', 'max_new_tokens': 1, 'pseudo_tokens': 2, 'label_index_mapping': {'neutral': 0, 'surprise': 1, 'fear': 2, 'sadness': 3, 'joy': 4, 'disgust': 5, 'anger': 6}, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 16, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 50, 'gamma': 1, 'update_epochs': 1, 'early_stop': 8, 'H': 3.0, 'seed': 2222}>
2025-02-19 21:31:28:INFO:Let's use the GPU 2 !
2025-02-19 21:31:33:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2025-02-19 21:31:33:WARNING:Try importing flash-attention for faster inference...
2025-02-19 21:31:33:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2025-02-19 21:31:33:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2025-02-19 21:31:33:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2025-02-19 21:31:35:INFO:trainable params: 1312072 || all params: 1838140744 || trainable%: 0.07138038826911504
2025-02-19 21:31:35:INFO:Init labels...
2025-02-19 21:31:35:INFO:Start training...
2025-02-19 21:33:39:INFO:TRAIN-(cmcm) (1/1/2)>> loss: 5.5875
2025-02-19 21:33:45:INFO:VAL-(cmcm) >>
2025-02-19 21:33:45:INFO:M: >>  acc: 0.4238  weight_F1: 0.2523 
2025-02-19 21:33:47:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-meld-classification.pth.
2025-02-19 21:35:52:INFO:TRAIN-(cmcm) (1/2/2)>> loss: 1.5533
2025-02-19 21:35:58:INFO:VAL-(cmcm) >>
2025-02-19 21:35:58:INFO:M: >>  acc: 0.4238  weight_F1: 0.2523 
2025-02-19 21:38:03:INFO:TRAIN-(cmcm) (2/3/2)>> loss: 1.5439
2025-02-19 21:38:09:INFO:VAL-(cmcm) >>
2025-02-19 21:38:09:INFO:M: >>  acc: 0.4238  weight_F1: 0.2523 
2025-02-19 21:40:14:INFO:TRAIN-(cmcm) (3/4/2)>> loss: 1.5434
2025-02-19 21:40:20:INFO:VAL-(cmcm) >>
2025-02-19 21:40:20:INFO:M: >>  acc: 0.4238  weight_F1: 0.2523 
2025-02-19 21:42:25:INFO:TRAIN-(cmcm) (4/5/2)>> loss: 1.5361
2025-02-19 21:42:31:INFO:VAL-(cmcm) >>
2025-02-19 21:42:31:INFO:M: >>  acc: 0.4238  weight_F1: 0.2523 
2025-02-19 21:44:36:INFO:TRAIN-(cmcm) (5/6/2)>> loss: 1.4837
2025-02-19 21:44:42:INFO:VAL-(cmcm) >>
2025-02-19 21:44:42:INFO:M: >>  acc: 0.4590  weight_F1: 0.3630 
2025-02-19 21:44:43:INFO:Saving checkpoint at epoch 6 to results/models/cmcm-meld-classification.pth.
2025-02-19 21:46:48:INFO:TRAIN-(cmcm) (1/7/2)>> loss: 1.3608
2025-02-19 21:46:54:INFO:VAL-(cmcm) >>
2025-02-19 21:46:54:INFO:M: >>  acc: 0.5221  weight_F1: 0.4342 
2025-02-19 21:46:55:INFO:Saving checkpoint at epoch 7 to results/models/cmcm-meld-classification.pth.
2025-02-19 21:49:00:INFO:TRAIN-(cmcm) (1/8/2)>> loss: 1.2444
2025-02-19 21:49:06:INFO:VAL-(cmcm) >>
2025-02-19 21:49:06:INFO:M: >>  acc: 0.5564  weight_F1: 0.4760 
2025-02-19 21:49:07:INFO:Saving checkpoint at epoch 8 to results/models/cmcm-meld-classification.pth.
2025-02-19 21:51:12:INFO:TRAIN-(cmcm) (1/9/2)>> loss: 1.1678
2025-02-19 21:51:18:INFO:VAL-(cmcm) >>
2025-02-19 21:51:18:INFO:M: >>  acc: 0.5852  weight_F1: 0.5584 
2025-02-19 21:51:19:INFO:Saving checkpoint at epoch 9 to results/models/cmcm-meld-classification.pth.
2025-02-19 21:53:24:INFO:TRAIN-(cmcm) (1/10/2)>> loss: 1.1391
2025-02-19 21:53:30:INFO:VAL-(cmcm) >>
2025-02-19 21:53:30:INFO:M: >>  acc: 0.5789  weight_F1: 0.5609 
2025-02-19 21:53:32:INFO:Saving checkpoint at epoch 10 to results/models/cmcm-meld-classification.pth.
2025-02-19 21:55:37:INFO:TRAIN-(cmcm) (1/11/2)>> loss: 1.1131
2025-02-19 21:55:43:INFO:VAL-(cmcm) >>
2025-02-19 21:55:43:INFO:M: >>  acc: 0.5996  weight_F1: 0.5561 
2025-02-19 21:57:48:INFO:TRAIN-(cmcm) (2/12/2)>> loss: 1.0905
2025-02-19 21:57:54:INFO:VAL-(cmcm) >>
2025-02-19 21:57:54:INFO:M: >>  acc: 0.5942  weight_F1: 0.5394 
2025-02-19 21:59:59:INFO:TRAIN-(cmcm) (3/13/2)>> loss: 1.0748
2025-02-19 22:00:05:INFO:VAL-(cmcm) >>
2025-02-19 22:00:05:INFO:M: >>  acc: 0.6087  weight_F1: 0.5711 
2025-02-19 22:00:06:INFO:Saving checkpoint at epoch 13 to results/models/cmcm-meld-classification.pth.
2025-02-19 22:02:12:INFO:TRAIN-(cmcm) (1/14/2)>> loss: 1.0585
2025-02-19 22:02:18:INFO:VAL-(cmcm) >>
2025-02-19 22:02:18:INFO:M: >>  acc: 0.6096  weight_F1: 0.5746 
2025-02-19 22:02:18:INFO:Saving checkpoint at epoch 14 to results/models/cmcm-meld-classification.pth.
2025-02-19 22:04:24:INFO:TRAIN-(cmcm) (1/15/2)>> loss: 1.0423
2025-02-19 22:04:30:INFO:VAL-(cmcm) >>
2025-02-19 22:04:30:INFO:M: >>  acc: 0.6023  weight_F1: 0.5521 
2025-02-19 22:06:35:INFO:TRAIN-(cmcm) (2/16/2)>> loss: 1.0325
2025-02-19 22:06:41:INFO:VAL-(cmcm) >>
2025-02-19 22:06:41:INFO:M: >>  acc: 0.6177  weight_F1: 0.5910 
2025-02-19 22:06:42:INFO:Saving checkpoint at epoch 16 to results/models/cmcm-meld-classification.pth.
2025-02-19 22:08:47:INFO:TRAIN-(cmcm) (1/17/2)>> loss: 1.0205
2025-02-19 22:08:53:INFO:VAL-(cmcm) >>
2025-02-19 22:08:53:INFO:M: >>  acc: 0.6023  weight_F1: 0.5776 
2025-02-19 22:10:58:INFO:TRAIN-(cmcm) (2/18/2)>> loss: 1.0090
2025-02-19 22:11:04:INFO:VAL-(cmcm) >>
2025-02-19 22:11:04:INFO:M: >>  acc: 0.6195  weight_F1: 0.5833 
2025-02-19 22:13:09:INFO:TRAIN-(cmcm) (3/19/2)>> loss: 0.9940
2025-02-19 22:13:15:INFO:VAL-(cmcm) >>
2025-02-19 22:13:15:INFO:M: >>  acc: 0.6195  weight_F1: 0.5915 
2025-02-19 22:13:16:INFO:Saving checkpoint at epoch 19 to results/models/cmcm-meld-classification.pth.
2025-02-19 22:15:21:INFO:TRAIN-(cmcm) (1/20/2)>> loss: 0.9856
2025-02-19 22:15:27:INFO:VAL-(cmcm) >>
2025-02-19 22:15:27:INFO:M: >>  acc: 0.6168  weight_F1: 0.5957 
2025-02-19 22:15:28:INFO:Saving checkpoint at epoch 20 to results/models/cmcm-meld-classification.pth.
2025-02-19 22:17:33:INFO:TRAIN-(cmcm) (1/21/2)>> loss: 0.9707
2025-02-19 22:17:39:INFO:VAL-(cmcm) >>
2025-02-19 22:17:39:INFO:M: >>  acc: 0.6132  weight_F1: 0.5850 
2025-02-19 22:19:44:INFO:TRAIN-(cmcm) (2/22/2)>> loss: 0.9592
2025-02-19 22:19:50:INFO:VAL-(cmcm) >>
2025-02-19 22:19:50:INFO:M: >>  acc: 0.5978  weight_F1: 0.5586 
2025-02-19 22:21:55:INFO:TRAIN-(cmcm) (3/23/2)>> loss: 0.9493
2025-02-19 22:22:01:INFO:VAL-(cmcm) >>
2025-02-19 22:22:01:INFO:M: >>  acc: 0.5996  weight_F1: 0.5671 
2025-02-19 22:24:07:INFO:TRAIN-(cmcm) (4/24/2)>> loss: 0.9331
2025-02-19 22:24:13:INFO:VAL-(cmcm) >>
2025-02-19 22:24:13:INFO:M: >>  acc: 0.6222  weight_F1: 0.5959 
2025-02-19 22:24:14:INFO:Saving checkpoint at epoch 24 to results/models/cmcm-meld-classification.pth.
2025-02-19 22:26:19:INFO:TRAIN-(cmcm) (1/25/2)>> loss: 0.9166
2025-02-19 22:26:25:INFO:VAL-(cmcm) >>
2025-02-19 22:26:25:INFO:M: >>  acc: 0.5861  weight_F1: 0.5560 
2025-02-19 22:28:31:INFO:TRAIN-(cmcm) (2/26/2)>> loss: 0.9042
2025-02-19 22:28:37:INFO:VAL-(cmcm) >>
2025-02-19 22:28:37:INFO:M: >>  acc: 0.6005  weight_F1: 0.5784 
2025-02-19 22:30:42:INFO:TRAIN-(cmcm) (3/27/2)>> loss: 0.8893
2025-02-19 22:30:48:INFO:VAL-(cmcm) >>
2025-02-19 22:30:48:INFO:M: >>  acc: 0.5978  weight_F1: 0.5592 
2025-02-19 22:32:54:INFO:TRAIN-(cmcm) (4/28/2)>> loss: 0.8716
2025-02-19 22:33:00:INFO:VAL-(cmcm) >>
2025-02-19 22:33:00:INFO:M: >>  acc: 0.6005  weight_F1: 0.5744 
2025-02-19 22:35:05:INFO:TRAIN-(cmcm) (5/29/2)>> loss: 0.8592
2025-02-19 22:35:11:INFO:VAL-(cmcm) >>
2025-02-19 22:35:11:INFO:M: >>  acc: 0.5861  weight_F1: 0.5609 
2025-02-19 22:37:16:INFO:TRAIN-(cmcm) (6/30/2)>> loss: 0.8409
2025-02-19 22:37:23:INFO:VAL-(cmcm) >>
2025-02-19 22:37:23:INFO:M: >>  acc: 0.5861  weight_F1: 0.5556 
2025-02-19 22:39:28:INFO:TRAIN-(cmcm) (7/31/2)>> loss: 0.8216
2025-02-19 22:39:34:INFO:VAL-(cmcm) >>
2025-02-19 22:39:34:INFO:M: >>  acc: 0.5996  weight_F1: 0.5750 
2025-02-19 22:41:39:INFO:TRAIN-(cmcm) (8/32/2)>> loss: 0.8054
2025-02-19 22:41:45:INFO:VAL-(cmcm) >>
2025-02-19 22:41:45:INFO:M: >>  acc: 0.5825  weight_F1: 0.5559 
2025-02-19 22:41:59:INFO:TEST-(cmcm) >>
2025-02-19 22:41:59:INFO:M: >>  acc: 0.6280  weight_F1: 0.6024 
2025-02-19 22:42:00:INFO:Results are added to results/results/meld-classification-50.csv...
2025-02-19 22:42:00:INFO:Start running cmcm...
2025-02-19 22:42:00:INFO:<Storage{'is_tune': False, 'train_mode': 'classification', 'modelName': 'cmcm', 'datasetName': 'meld', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'pretrain_LM': '/data/huggingface_model/Qwen/Qwen-1_8B/', 'gpu_ids': [2], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MELD', 'seq_lens': (65, 157, 32), 'feature_dims': (2048, 64, 64), 'train_samples': 9992, 'num_classes': 3, 'language': 'en', 'KeyEval': 'weight_F1', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'task_specific_prompt': 'Please recognize the emotion of the above multimodal content from the                                             target set <neutral:0, surprise:1, fear:2, sadness:3, joy:4, disgust:5, anger:6>. Assistant: The emotion is', 'max_new_tokens': 1, 'pseudo_tokens': 2, 'label_index_mapping': {'neutral': 0, 'surprise': 1, 'fear': 2, 'sadness': 3, 'joy': 4, 'disgust': 5, 'anger': 6}, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 16, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 50, 'gamma': 1, 'update_epochs': 1, 'early_stop': 8, 'H': 3.0, 'seed': 3333}>
2025-02-19 22:42:00:INFO:Let's use the GPU 2 !
2025-02-19 22:42:05:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2025-02-19 22:42:05:WARNING:Try importing flash-attention for faster inference...
2025-02-19 22:42:05:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2025-02-19 22:42:05:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2025-02-19 22:42:05:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2025-02-19 22:42:06:INFO:trainable params: 1312072 || all params: 1838140744 || trainable%: 0.07138038826911504
2025-02-19 22:42:06:INFO:Init labels...
2025-02-19 22:42:06:INFO:Start training...
2025-02-19 22:44:11:INFO:TRAIN-(cmcm) (1/1/3)>> loss: 3.6878
2025-02-19 22:44:17:INFO:VAL-(cmcm) >>
2025-02-19 22:44:17:INFO:M: >>  acc: 0.4238  weight_F1: 0.2523 
2025-02-19 22:44:18:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-meld-classification.pth.
2025-02-19 22:46:24:INFO:TRAIN-(cmcm) (1/2/3)>> loss: 1.5777
2025-02-19 22:46:30:INFO:VAL-(cmcm) >>
2025-02-19 22:46:30:INFO:M: >>  acc: 0.4238  weight_F1: 0.2523 
2025-02-19 22:48:36:INFO:TRAIN-(cmcm) (2/3/3)>> loss: 1.5627
2025-02-19 22:48:42:INFO:VAL-(cmcm) >>
2025-02-19 22:48:42:INFO:M: >>  acc: 0.4238  weight_F1: 0.2523 
2025-02-19 22:50:47:INFO:TRAIN-(cmcm) (3/4/3)>> loss: 1.5494
2025-02-19 22:50:53:INFO:VAL-(cmcm) >>
2025-02-19 22:50:53:INFO:M: >>  acc: 0.4247  weight_F1: 0.2548 
2025-02-19 22:50:54:INFO:Saving checkpoint at epoch 4 to results/models/cmcm-meld-classification.pth.
2025-02-19 22:53:00:INFO:TRAIN-(cmcm) (1/5/3)>> loss: 1.5279
2025-02-19 22:53:06:INFO:VAL-(cmcm) >>
2025-02-19 22:53:06:INFO:M: >>  acc: 0.4409  weight_F1: 0.2941 
2025-02-19 22:53:07:INFO:Saving checkpoint at epoch 5 to results/models/cmcm-meld-classification.pth.
2025-02-19 22:55:13:INFO:TRAIN-(cmcm) (1/6/3)>> loss: 1.5152
2025-02-19 22:55:19:INFO:VAL-(cmcm) >>
2025-02-19 22:55:19:INFO:M: >>  acc: 0.4418  weight_F1: 0.3200 
2025-02-19 22:55:20:INFO:Saving checkpoint at epoch 6 to results/models/cmcm-meld-classification.pth.
2025-02-19 22:57:26:INFO:TRAIN-(cmcm) (1/7/3)>> loss: 1.4871
2025-02-19 22:57:32:INFO:VAL-(cmcm) >>
2025-02-19 22:57:32:INFO:M: >>  acc: 0.4536  weight_F1: 0.3190 
2025-02-19 22:59:37:INFO:TRAIN-(cmcm) (2/8/3)>> loss: 1.4524
2025-02-19 22:59:43:INFO:VAL-(cmcm) >>
2025-02-19 22:59:43:INFO:M: >>  acc: 0.4482  weight_F1: 0.3099 
2025-02-19 23:01:49:INFO:TRAIN-(cmcm) (3/9/3)>> loss: 1.4332
2025-02-19 23:01:55:INFO:VAL-(cmcm) >>
2025-02-19 23:01:55:INFO:M: >>  acc: 0.4662  weight_F1: 0.3795 
2025-02-19 23:01:56:INFO:Saving checkpoint at epoch 9 to results/models/cmcm-meld-classification.pth.
2025-02-19 23:04:02:INFO:TRAIN-(cmcm) (1/10/3)>> loss: 1.3829
2025-02-19 23:04:08:INFO:VAL-(cmcm) >>
2025-02-19 23:04:08:INFO:M: >>  acc: 0.4707  weight_F1: 0.3888 
2025-02-19 23:04:09:INFO:Saving checkpoint at epoch 10 to results/models/cmcm-meld-classification.pth.
2025-02-19 23:06:15:INFO:TRAIN-(cmcm) (1/11/3)>> loss: 1.3371
2025-02-19 23:06:21:INFO:VAL-(cmcm) >>
2025-02-19 23:06:21:INFO:M: >>  acc: 0.4887  weight_F1: 0.4228 
2025-02-19 23:06:22:INFO:Saving checkpoint at epoch 11 to results/models/cmcm-meld-classification.pth.
2025-02-19 23:08:28:INFO:TRAIN-(cmcm) (1/12/3)>> loss: 1.2860
2025-02-19 23:08:34:INFO:VAL-(cmcm) >>
2025-02-19 23:08:34:INFO:M: >>  acc: 0.5392  weight_F1: 0.4937 
2025-02-19 23:08:35:INFO:Saving checkpoint at epoch 12 to results/models/cmcm-meld-classification.pth.
2025-02-19 23:10:41:INFO:TRAIN-(cmcm) (1/13/3)>> loss: 1.2139
2025-02-19 23:10:47:INFO:VAL-(cmcm) >>
2025-02-19 23:10:47:INFO:M: >>  acc: 0.5627  weight_F1: 0.5332 
2025-02-19 23:10:48:INFO:Saving checkpoint at epoch 13 to results/models/cmcm-meld-classification.pth.
2025-02-19 23:12:53:INFO:TRAIN-(cmcm) (1/14/3)>> loss: 1.1490
2025-02-19 23:12:59:INFO:VAL-(cmcm) >>
2025-02-19 23:12:59:INFO:M: >>  acc: 0.5789  weight_F1: 0.5569 
2025-02-19 23:13:00:INFO:Saving checkpoint at epoch 14 to results/models/cmcm-meld-classification.pth.
2025-02-19 23:15:06:INFO:TRAIN-(cmcm) (1/15/3)>> loss: 1.1076
2025-02-19 23:15:12:INFO:VAL-(cmcm) >>
2025-02-19 23:15:12:INFO:M: >>  acc: 0.5843  weight_F1: 0.5462 
2025-02-19 23:17:18:INFO:TRAIN-(cmcm) (2/16/3)>> loss: 1.0697
2025-02-19 23:17:24:INFO:VAL-(cmcm) >>
2025-02-19 23:17:24:INFO:M: >>  acc: 0.6005  weight_F1: 0.5615 
2025-02-19 23:17:25:INFO:Saving checkpoint at epoch 16 to results/models/cmcm-meld-classification.pth.
2025-02-19 23:19:31:INFO:TRAIN-(cmcm) (1/17/3)>> loss: 1.0412
2025-02-19 23:19:37:INFO:VAL-(cmcm) >>
2025-02-19 23:19:37:INFO:M: >>  acc: 0.6032  weight_F1: 0.5790 
2025-02-19 23:19:38:INFO:Saving checkpoint at epoch 17 to results/models/cmcm-meld-classification.pth.
2025-02-19 23:21:43:INFO:TRAIN-(cmcm) (1/18/3)>> loss: 1.0150
2025-02-19 23:21:49:INFO:VAL-(cmcm) >>
2025-02-19 23:21:49:INFO:M: >>  acc: 0.6023  weight_F1: 0.5644 
2025-02-19 23:23:55:INFO:TRAIN-(cmcm) (2/19/3)>> loss: 0.9945
2025-02-19 23:24:01:INFO:VAL-(cmcm) >>
2025-02-19 23:24:01:INFO:M: >>  acc: 0.5861  weight_F1: 0.5573 
2025-02-19 23:26:06:INFO:TRAIN-(cmcm) (3/20/3)>> loss: 0.9674
2025-02-19 23:26:12:INFO:VAL-(cmcm) >>
2025-02-19 23:26:12:INFO:M: >>  acc: 0.5897  weight_F1: 0.5601 
2025-02-19 23:28:18:INFO:TRAIN-(cmcm) (4/21/3)>> loss: 0.9364
2025-02-19 23:28:24:INFO:VAL-(cmcm) >>
2025-02-19 23:28:24:INFO:M: >>  acc: 0.6105  weight_F1: 0.5916 
2025-02-19 23:28:25:INFO:Saving checkpoint at epoch 21 to results/models/cmcm-meld-classification.pth.
2025-02-19 23:30:30:INFO:TRAIN-(cmcm) (1/22/3)>> loss: 0.9144
2025-02-19 23:30:36:INFO:VAL-(cmcm) >>
2025-02-19 23:30:36:INFO:M: >>  acc: 0.6060  weight_F1: 0.5862 
2025-02-19 23:32:41:INFO:TRAIN-(cmcm) (2/23/3)>> loss: 0.8881
2025-02-19 23:32:48:INFO:VAL-(cmcm) >>
2025-02-19 23:32:48:INFO:M: >>  acc: 0.5987  weight_F1: 0.5677 
2025-02-19 23:34:53:INFO:TRAIN-(cmcm) (3/24/3)>> loss: 0.8660
2025-02-19 23:34:59:INFO:VAL-(cmcm) >>
2025-02-19 23:34:59:INFO:M: >>  acc: 0.5807  weight_F1: 0.5581 
2025-02-19 23:37:04:INFO:TRAIN-(cmcm) (4/25/3)>> loss: 0.8349
2025-02-19 23:37:10:INFO:VAL-(cmcm) >>
2025-02-19 23:37:10:INFO:M: >>  acc: 0.5996  weight_F1: 0.5836 
2025-02-19 23:39:15:INFO:TRAIN-(cmcm) (5/26/3)>> loss: 0.8073
2025-02-19 23:39:21:INFO:VAL-(cmcm) >>
2025-02-19 23:39:21:INFO:M: >>  acc: 0.5933  weight_F1: 0.5767 
2025-02-19 23:41:27:INFO:TRAIN-(cmcm) (6/27/3)>> loss: 0.7834
2025-02-19 23:41:33:INFO:VAL-(cmcm) >>
2025-02-19 23:41:33:INFO:M: >>  acc: 0.5951  weight_F1: 0.5791 
2025-02-19 23:43:38:INFO:TRAIN-(cmcm) (7/28/3)>> loss: 0.7522
2025-02-19 23:43:44:INFO:VAL-(cmcm) >>
2025-02-19 23:43:44:INFO:M: >>  acc: 0.5717  weight_F1: 0.5501 
2025-02-19 23:45:49:INFO:TRAIN-(cmcm) (8/29/3)>> loss: 0.7244
2025-02-19 23:45:55:INFO:VAL-(cmcm) >>
2025-02-19 23:45:55:INFO:M: >>  acc: 0.5861  weight_F1: 0.5658 
2025-02-19 23:46:09:INFO:TEST-(cmcm) >>
2025-02-19 23:46:09:INFO:M: >>  acc: 0.6134  weight_F1: 0.5920 
2025-02-19 23:46:10:INFO:Results are added to results/results/meld-classification-50.csv...
2025-02-19 23:46:10:INFO:Start running cmcm...
2025-02-19 23:46:10:INFO:<Storage{'is_tune': False, 'train_mode': 'classification', 'modelName': 'cmcm', 'datasetName': 'meld', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'pretrain_LM': '/data/huggingface_model/Qwen/Qwen-1_8B/', 'gpu_ids': [2], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MELD', 'seq_lens': (65, 157, 32), 'feature_dims': (2048, 64, 64), 'train_samples': 9992, 'num_classes': 3, 'language': 'en', 'KeyEval': 'weight_F1', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'task_specific_prompt': 'Please recognize the emotion of the above multimodal content from the                                             target set <neutral:0, surprise:1, fear:2, sadness:3, joy:4, disgust:5, anger:6>. Assistant: The emotion is', 'max_new_tokens': 1, 'pseudo_tokens': 2, 'label_index_mapping': {'neutral': 0, 'surprise': 1, 'fear': 2, 'sadness': 3, 'joy': 4, 'disgust': 5, 'anger': 6}, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 16, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 50, 'gamma': 1, 'update_epochs': 1, 'early_stop': 8, 'H': 3.0, 'seed': 4444}>
2025-02-19 23:46:10:INFO:Let's use the GPU 2 !
2025-02-19 23:46:15:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2025-02-19 23:46:15:WARNING:Try importing flash-attention for faster inference...
2025-02-19 23:46:15:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2025-02-19 23:46:15:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2025-02-19 23:46:15:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2025-02-19 23:46:16:INFO:trainable params: 1312072 || all params: 1838140744 || trainable%: 0.07138038826911504
2025-02-19 23:46:16:INFO:Init labels...
2025-02-19 23:46:16:INFO:Start training...
2025-02-19 23:48:21:INFO:TRAIN-(cmcm) (1/1/4)>> loss: 3.8651
2025-02-19 23:48:27:INFO:VAL-(cmcm) >>
2025-02-19 23:48:27:INFO:M: >>  acc: 0.4238  weight_F1: 0.2523 
2025-02-19 23:48:28:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-meld-classification.pth.
2025-02-19 23:50:34:INFO:TRAIN-(cmcm) (1/2/4)>> loss: 1.5619
2025-02-19 23:50:40:INFO:VAL-(cmcm) >>
2025-02-19 23:50:40:INFO:M: >>  acc: 0.4238  weight_F1: 0.2523 
2025-02-19 23:52:45:INFO:TRAIN-(cmcm) (2/3/4)>> loss: 1.5516
2025-02-19 23:52:51:INFO:VAL-(cmcm) >>
2025-02-19 23:52:51:INFO:M: >>  acc: 0.4238  weight_F1: 0.2523 
2025-02-19 23:54:56:INFO:TRAIN-(cmcm) (3/4/4)>> loss: 1.5509
2025-02-19 23:55:02:INFO:VAL-(cmcm) >>
2025-02-19 23:55:02:INFO:M: >>  acc: 0.4238  weight_F1: 0.2523 
2025-02-19 23:57:07:INFO:TRAIN-(cmcm) (4/5/4)>> loss: 1.5426
2025-02-19 23:57:13:INFO:VAL-(cmcm) >>
2025-02-19 23:57:13:INFO:M: >>  acc: 0.4238  weight_F1: 0.2523 
2025-02-19 23:59:19:INFO:TRAIN-(cmcm) (5/6/4)>> loss: 1.5163
2025-02-19 23:59:25:INFO:VAL-(cmcm) >>
2025-02-19 23:59:25:INFO:M: >>  acc: 0.4238  weight_F1: 0.2526 
2025-02-19 23:59:26:INFO:Saving checkpoint at epoch 6 to results/models/cmcm-meld-classification.pth.
2025-02-20 00:01:31:INFO:TRAIN-(cmcm) (1/7/4)>> loss: 1.4396
2025-02-20 00:01:37:INFO:VAL-(cmcm) >>
2025-02-20 00:01:37:INFO:M: >>  acc: 0.4761  weight_F1: 0.4007 
2025-02-20 00:01:38:INFO:Saving checkpoint at epoch 7 to results/models/cmcm-meld-classification.pth.
2025-02-20 00:03:43:INFO:TRAIN-(cmcm) (1/8/4)>> loss: 1.3356
2025-02-20 00:03:50:INFO:VAL-(cmcm) >>
2025-02-20 00:03:50:INFO:M: >>  acc: 0.5077  weight_F1: 0.4232 
2025-02-20 00:03:50:INFO:Saving checkpoint at epoch 8 to results/models/cmcm-meld-classification.pth.
2025-02-20 00:05:56:INFO:TRAIN-(cmcm) (1/9/4)>> loss: 1.2569
2025-02-20 00:06:02:INFO:VAL-(cmcm) >>
2025-02-20 00:06:02:INFO:M: >>  acc: 0.5392  weight_F1: 0.4706 
2025-02-20 00:06:03:INFO:Saving checkpoint at epoch 9 to results/models/cmcm-meld-classification.pth.
2025-02-20 00:08:08:INFO:TRAIN-(cmcm) (1/10/4)>> loss: 1.2133
2025-02-20 00:08:14:INFO:VAL-(cmcm) >>
2025-02-20 00:08:14:INFO:M: >>  acc: 0.5537  weight_F1: 0.5192 
2025-02-20 00:08:15:INFO:Saving checkpoint at epoch 10 to results/models/cmcm-meld-classification.pth.
2025-02-20 00:10:21:INFO:TRAIN-(cmcm) (1/11/4)>> loss: 1.1898
2025-02-20 00:10:27:INFO:VAL-(cmcm) >>
2025-02-20 00:10:27:INFO:M: >>  acc: 0.5897  weight_F1: 0.5593 
2025-02-20 00:10:28:INFO:Saving checkpoint at epoch 11 to results/models/cmcm-meld-classification.pth.
2025-02-20 00:12:33:INFO:TRAIN-(cmcm) (1/12/4)>> loss: 1.1586
2025-02-20 00:12:39:INFO:VAL-(cmcm) >>
2025-02-20 00:12:39:INFO:M: >>  acc: 0.5906  weight_F1: 0.5463 
2025-02-20 00:14:44:INFO:TRAIN-(cmcm) (2/13/4)>> loss: 1.1370
2025-02-20 00:14:51:INFO:VAL-(cmcm) >>
2025-02-20 00:14:51:INFO:M: >>  acc: 0.5825  weight_F1: 0.5464 
2025-02-20 00:16:56:INFO:TRAIN-(cmcm) (3/14/4)>> loss: 1.1273
2025-02-20 00:17:02:INFO:VAL-(cmcm) >>
2025-02-20 00:17:02:INFO:M: >>  acc: 0.5951  weight_F1: 0.5541 
2025-02-20 00:19:07:INFO:TRAIN-(cmcm) (4/15/4)>> loss: 1.1054
2025-02-20 00:19:13:INFO:VAL-(cmcm) >>
2025-02-20 00:19:13:INFO:M: >>  acc: 0.6050  weight_F1: 0.5720 
2025-02-20 00:19:14:INFO:Saving checkpoint at epoch 15 to results/models/cmcm-meld-classification.pth.
2025-02-20 00:21:19:INFO:TRAIN-(cmcm) (1/16/4)>> loss: 1.0937
2025-02-20 00:21:25:INFO:VAL-(cmcm) >>
2025-02-20 00:21:25:INFO:M: >>  acc: 0.5933  weight_F1: 0.5659 
2025-02-20 00:23:30:INFO:TRAIN-(cmcm) (2/17/4)>> loss: 1.0815
2025-02-20 00:23:36:INFO:VAL-(cmcm) >>
2025-02-20 00:23:36:INFO:M: >>  acc: 0.5951  weight_F1: 0.5662 
2025-02-20 00:25:41:INFO:TRAIN-(cmcm) (3/18/4)>> loss: 1.0673
2025-02-20 00:25:47:INFO:VAL-(cmcm) >>
2025-02-20 00:25:47:INFO:M: >>  acc: 0.5906  weight_F1: 0.5396 
2025-02-20 00:27:51:INFO:TRAIN-(cmcm) (4/19/4)>> loss: 1.0479
2025-02-20 00:27:57:INFO:VAL-(cmcm) >>
2025-02-20 00:27:57:INFO:M: >>  acc: 0.5825  weight_F1: 0.5456 
2025-02-20 00:30:02:INFO:TRAIN-(cmcm) (5/20/4)>> loss: 1.0317
2025-02-20 00:30:08:INFO:VAL-(cmcm) >>
2025-02-20 00:30:08:INFO:M: >>  acc: 0.5789  weight_F1: 0.5305 
2025-02-20 00:32:13:INFO:TRAIN-(cmcm) (6/21/4)>> loss: 1.0191
2025-02-20 00:32:19:INFO:VAL-(cmcm) >>
2025-02-20 00:32:19:INFO:M: >>  acc: 0.5897  weight_F1: 0.5708 
2025-02-20 00:34:24:INFO:TRAIN-(cmcm) (7/22/4)>> loss: 0.9964
2025-02-20 00:34:30:INFO:VAL-(cmcm) >>
2025-02-20 00:34:30:INFO:M: >>  acc: 0.5960  weight_F1: 0.5566 
2025-02-20 00:36:35:INFO:TRAIN-(cmcm) (8/23/4)>> loss: 0.9718
2025-02-20 00:36:41:INFO:VAL-(cmcm) >>
2025-02-20 00:36:41:INFO:M: >>  acc: 0.5861  weight_F1: 0.5462 
2025-02-20 00:36:55:INFO:TEST-(cmcm) >>
2025-02-20 00:36:55:INFO:M: >>  acc: 0.6180  weight_F1: 0.5873 
2025-02-20 00:36:55:INFO:Results are added to results/results/meld-classification-50.csv...
2025-02-20 00:36:55:INFO:Start running cmcm...
2025-02-20 00:36:55:INFO:<Storage{'is_tune': False, 'train_mode': 'classification', 'modelName': 'cmcm', 'datasetName': 'meld', 'num_workers': 0, 'model_save_dir': 'results/models', 'res_save_dir': 'results/results', 'pretrain_LM': '/data/huggingface_model/Qwen/Qwen-1_8B/', 'gpu_ids': [2], 'seeds': [1111, 2222, 3333, 4444, 5555], 'dataPath': '/home/young/DL/multimodal_dataset/MELD', 'seq_lens': (65, 157, 32), 'feature_dims': (2048, 64, 64), 'train_samples': 9992, 'num_classes': 3, 'language': 'en', 'KeyEval': 'weight_F1', 'need_data_aligned': False, 'need_model_aligned': False, 'need_label_prefix': True, 'need_normalized': False, 'use_PLM': True, 'save_labels': False, 'task_specific_prompt': 'Please recognize the emotion of the above multimodal content from the                                             target set <neutral:0, surprise:1, fear:2, sadness:3, joy:4, disgust:5, anger:6>. Assistant: The emotion is', 'max_new_tokens': 1, 'pseudo_tokens': 2, 'label_index_mapping': {'neutral': 0, 'surprise': 1, 'fear': 2, 'sadness': 3, 'joy': 4, 'disgust': 5, 'anger': 6}, 'batch_size': 16, 'learning_rate': 0.0005, 'a_lstm_hidden_size': 32, 'v_lstm_hidden_size': 16, 'a_lstm_layers': 1, 'v_lstm_layers': 1, 'a_lstm_dropout': 0.0, 'v_lstm_dropout': 0.0, 'warm_up_epochs': 50, 'gamma': 1, 'update_epochs': 1, 'early_stop': 8, 'H': 3.0, 'seed': 5555}>
2025-02-20 00:36:55:INFO:Let's use the GPU 2 !
2025-02-20 00:37:00:WARNING:The model is automatically converting to bf16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
2025-02-20 00:37:00:WARNING:Try importing flash-attention for faster inference...
2025-02-20 00:37:00:WARNING:Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
2025-02-20 00:37:00:WARNING:Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
2025-02-20 00:37:00:WARNING:Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
2025-02-20 00:37:01:INFO:trainable params: 1312072 || all params: 1838140744 || trainable%: 0.07138038826911504
2025-02-20 00:37:01:INFO:Init labels...
2025-02-20 00:37:01:INFO:Start training...
2025-02-20 00:39:06:INFO:TRAIN-(cmcm) (1/1/5)>> loss: 4.2147
2025-02-20 00:39:12:INFO:VAL-(cmcm) >>
2025-02-20 00:39:12:INFO:M: >>  acc: 0.4220  weight_F1: 0.2517 
2025-02-20 00:39:13:INFO:Saving checkpoint at epoch 1 to results/models/cmcm-meld-classification.pth.
2025-02-20 00:41:18:INFO:TRAIN-(cmcm) (1/2/5)>> loss: 1.5653
2025-02-20 00:41:24:INFO:VAL-(cmcm) >>
2025-02-20 00:41:24:INFO:M: >>  acc: 0.4238  weight_F1: 0.2525 
2025-02-20 00:41:25:INFO:Saving checkpoint at epoch 2 to results/models/cmcm-meld-classification.pth.
2025-02-20 00:43:30:INFO:TRAIN-(cmcm) (1/3/5)>> loss: 1.5557
2025-02-20 00:43:36:INFO:VAL-(cmcm) >>
2025-02-20 00:43:36:INFO:M: >>  acc: 0.4238  weight_F1: 0.2523 
2025-02-20 00:45:41:INFO:TRAIN-(cmcm) (2/4/5)>> loss: 1.5519
2025-02-20 00:45:47:INFO:VAL-(cmcm) >>
2025-02-20 00:45:47:INFO:M: >>  acc: 0.4211  weight_F1: 0.2516 
2025-02-20 00:47:51:INFO:TRAIN-(cmcm) (3/5/5)>> loss: 1.5495
2025-02-20 00:47:57:INFO:VAL-(cmcm) >>
2025-02-20 00:47:57:INFO:M: >>  acc: 0.4238  weight_F1: 0.2523 
2025-02-20 00:50:02:INFO:TRAIN-(cmcm) (4/6/5)>> loss: 1.5430
2025-02-20 00:50:08:INFO:VAL-(cmcm) >>
2025-02-20 00:50:08:INFO:M: >>  acc: 0.4238  weight_F1: 0.2523 
2025-02-20 00:52:13:INFO:TRAIN-(cmcm) (5/7/5)>> loss: 1.5335
2025-02-20 00:52:19:INFO:VAL-(cmcm) >>
2025-02-20 00:52:19:INFO:M: >>  acc: 0.4283  weight_F1: 0.2622 
2025-02-20 00:52:20:INFO:Saving checkpoint at epoch 7 to results/models/cmcm-meld-classification.pth.
2025-02-20 00:54:25:INFO:TRAIN-(cmcm) (1/8/5)>> loss: 1.4944
2025-02-20 00:54:31:INFO:VAL-(cmcm) >>
2025-02-20 00:54:31:INFO:M: >>  acc: 0.4328  weight_F1: 0.2753 
2025-02-20 00:54:32:INFO:Saving checkpoint at epoch 8 to results/models/cmcm-meld-classification.pth.
2025-02-20 00:56:37:INFO:TRAIN-(cmcm) (1/9/5)>> loss: 1.4082
2025-02-20 00:56:43:INFO:VAL-(cmcm) >>
2025-02-20 00:56:43:INFO:M: >>  acc: 0.4698  weight_F1: 0.3895 
2025-02-20 00:56:44:INFO:Saving checkpoint at epoch 9 to results/models/cmcm-meld-classification.pth.
2025-02-20 00:58:49:INFO:TRAIN-(cmcm) (1/10/5)>> loss: 1.2924
2025-02-20 00:58:55:INFO:VAL-(cmcm) >>
2025-02-20 00:58:55:INFO:M: >>  acc: 0.5266  weight_F1: 0.4554 
2025-02-20 00:58:55:INFO:Saving checkpoint at epoch 10 to results/models/cmcm-meld-classification.pth.
2025-02-20 01:01:01:INFO:TRAIN-(cmcm) (1/11/5)>> loss: 1.2116
2025-02-20 01:01:07:INFO:VAL-(cmcm) >>
2025-02-20 01:01:07:INFO:M: >>  acc: 0.5690  weight_F1: 0.5164 
2025-02-20 01:01:07:INFO:Saving checkpoint at epoch 11 to results/models/cmcm-meld-classification.pth.
2025-02-20 01:03:13:INFO:TRAIN-(cmcm) (1/12/5)>> loss: 1.1528
2025-02-20 01:03:19:INFO:VAL-(cmcm) >>
2025-02-20 01:03:19:INFO:M: >>  acc: 0.5969  weight_F1: 0.5623 
2025-02-20 01:03:19:INFO:Saving checkpoint at epoch 12 to results/models/cmcm-meld-classification.pth.
2025-02-20 01:05:25:INFO:TRAIN-(cmcm) (1/13/5)>> loss: 1.1189
2025-02-20 01:05:31:INFO:VAL-(cmcm) >>
2025-02-20 01:05:31:INFO:M: >>  acc: 0.5915  weight_F1: 0.5527 
2025-02-20 01:07:36:INFO:TRAIN-(cmcm) (2/14/5)>> loss: 1.0947
2025-02-20 01:07:42:INFO:VAL-(cmcm) >>
2025-02-20 01:07:42:INFO:M: >>  acc: 0.5924  weight_F1: 0.5483 
2025-02-20 01:09:46:INFO:TRAIN-(cmcm) (3/15/5)>> loss: 1.0778
2025-02-20 01:09:52:INFO:VAL-(cmcm) >>
2025-02-20 01:09:52:INFO:M: >>  acc: 0.5690  weight_F1: 0.5167 
2025-02-20 01:11:57:INFO:TRAIN-(cmcm) (4/16/5)>> loss: 1.0589
2025-02-20 01:12:03:INFO:VAL-(cmcm) >>
2025-02-20 01:12:03:INFO:M: >>  acc: 0.5825  weight_F1: 0.5482 
2025-02-20 01:14:08:INFO:TRAIN-(cmcm) (5/17/5)>> loss: 1.0469
2025-02-20 01:14:14:INFO:VAL-(cmcm) >>
2025-02-20 01:14:14:INFO:M: >>  acc: 0.5942  weight_F1: 0.5458 
2025-02-20 01:16:19:INFO:TRAIN-(cmcm) (6/18/5)>> loss: 1.0304
2025-02-20 01:16:25:INFO:VAL-(cmcm) >>
2025-02-20 01:16:25:INFO:M: >>  acc: 0.5951  weight_F1: 0.5554 
2025-02-20 01:18:30:INFO:TRAIN-(cmcm) (7/19/5)>> loss: 1.0166
2025-02-20 01:18:36:INFO:VAL-(cmcm) >>
2025-02-20 01:18:36:INFO:M: >>  acc: 0.5978  weight_F1: 0.5683 
2025-02-20 01:18:37:INFO:Saving checkpoint at epoch 19 to results/models/cmcm-meld-classification.pth.
2025-02-20 01:20:42:INFO:TRAIN-(cmcm) (1/20/5)>> loss: 1.0008
2025-02-20 01:20:48:INFO:VAL-(cmcm) >>
2025-02-20 01:20:48:INFO:M: >>  acc: 0.5978  weight_F1: 0.5575 
2025-02-20 01:22:54:INFO:TRAIN-(cmcm) (2/21/5)>> loss: 0.9876
2025-02-20 01:23:00:INFO:VAL-(cmcm) >>
2025-02-20 01:23:00:INFO:M: >>  acc: 0.6060  weight_F1: 0.5830 
2025-02-20 01:23:01:INFO:Saving checkpoint at epoch 21 to results/models/cmcm-meld-classification.pth.
2025-02-20 01:25:06:INFO:TRAIN-(cmcm) (1/22/5)>> loss: 0.9686
2025-02-20 01:25:12:INFO:VAL-(cmcm) >>
2025-02-20 01:25:12:INFO:M: >>  acc: 0.6078  weight_F1: 0.5705 
2025-02-20 01:27:17:INFO:TRAIN-(cmcm) (2/23/5)>> loss: 0.9546
2025-02-20 01:27:23:INFO:VAL-(cmcm) >>
2025-02-20 01:27:23:INFO:M: >>  acc: 0.6023  weight_F1: 0.5692 
2025-02-20 01:29:29:INFO:TRAIN-(cmcm) (3/24/5)>> loss: 0.9386
2025-02-20 01:29:35:INFO:VAL-(cmcm) >>
2025-02-20 01:29:35:INFO:M: >>  acc: 0.5996  weight_F1: 0.5628 
2025-02-20 01:31:40:INFO:TRAIN-(cmcm) (4/25/5)>> loss: 0.9213
2025-02-20 01:31:46:INFO:VAL-(cmcm) >>
2025-02-20 01:31:46:INFO:M: >>  acc: 0.6023  weight_F1: 0.5722 
2025-02-20 01:33:51:INFO:TRAIN-(cmcm) (5/26/5)>> loss: 0.8969
2025-02-20 01:33:57:INFO:VAL-(cmcm) >>
2025-02-20 01:33:57:INFO:M: >>  acc: 0.6023  weight_F1: 0.5721 
2025-02-20 01:36:03:INFO:TRAIN-(cmcm) (6/27/5)>> loss: 0.8764
2025-02-20 01:36:09:INFO:VAL-(cmcm) >>
2025-02-20 01:36:09:INFO:M: >>  acc: 0.5924  weight_F1: 0.5663 
2025-02-20 01:38:14:INFO:TRAIN-(cmcm) (7/28/5)>> loss: 0.8602
2025-02-20 01:38:20:INFO:VAL-(cmcm) >>
2025-02-20 01:38:20:INFO:M: >>  acc: 0.6014  weight_F1: 0.5776 
2025-02-20 01:40:25:INFO:TRAIN-(cmcm) (8/29/5)>> loss: 0.8370
2025-02-20 01:40:31:INFO:VAL-(cmcm) >>
2025-02-20 01:40:31:INFO:M: >>  acc: 0.6060  weight_F1: 0.5843 
2025-02-20 01:40:32:INFO:Saving checkpoint at epoch 29 to results/models/cmcm-meld-classification.pth.
2025-02-20 01:42:38:INFO:TRAIN-(cmcm) (1/30/5)>> loss: 0.8176
2025-02-20 01:42:44:INFO:VAL-(cmcm) >>
2025-02-20 01:42:44:INFO:M: >>  acc: 0.6005  weight_F1: 0.5766 
2025-02-20 01:44:49:INFO:TRAIN-(cmcm) (2/31/5)>> loss: 0.7962
2025-02-20 01:44:55:INFO:VAL-(cmcm) >>
2025-02-20 01:44:55:INFO:M: >>  acc: 0.5969  weight_F1: 0.5725 
2025-02-20 01:47:00:INFO:TRAIN-(cmcm) (3/32/5)>> loss: 0.7763
2025-02-20 01:47:06:INFO:VAL-(cmcm) >>
2025-02-20 01:47:06:INFO:M: >>  acc: 0.5951  weight_F1: 0.5699 
2025-02-20 01:49:12:INFO:TRAIN-(cmcm) (4/33/5)>> loss: 0.7563
2025-02-20 01:49:18:INFO:VAL-(cmcm) >>
2025-02-20 01:49:18:INFO:M: >>  acc: 0.5942  weight_F1: 0.5729 
2025-02-20 01:51:23:INFO:TRAIN-(cmcm) (5/34/5)>> loss: 0.7369
2025-02-20 01:51:29:INFO:VAL-(cmcm) >>
2025-02-20 01:51:29:INFO:M: >>  acc: 0.5915  weight_F1: 0.5684 
2025-02-20 01:53:34:INFO:TRAIN-(cmcm) (6/35/5)>> loss: 0.7137
2025-02-20 01:53:40:INFO:VAL-(cmcm) >>
2025-02-20 01:53:40:INFO:M: >>  acc: 0.5852  weight_F1: 0.5598 
2025-02-20 01:55:46:INFO:TRAIN-(cmcm) (7/36/5)>> loss: 0.6953
2025-02-20 01:55:52:INFO:VAL-(cmcm) >>
2025-02-20 01:55:52:INFO:M: >>  acc: 0.5843  weight_F1: 0.5611 
2025-02-20 01:57:57:INFO:TRAIN-(cmcm) (8/37/5)>> loss: 0.6755
2025-02-20 01:58:03:INFO:VAL-(cmcm) >>
2025-02-20 01:58:03:INFO:M: >>  acc: 0.5888  weight_F1: 0.5641 
2025-02-20 01:58:17:INFO:TEST-(cmcm) >>
2025-02-20 01:58:17:INFO:M: >>  acc: 0.6080  weight_F1: 0.5861 
2025-02-20 01:58:18:INFO:Results are added to results/results/meld-classification-50.csv...
